{
  "version": 3,
  "sources": [
    "../lib/jquery-3.0.0.min.js",
    "init.js",
    "config/system_effect.js",
    "config/signature_type.js",
    "../lib/bootstrap.min.js",
    "../lib/bootbox.min.js",
    "../lib/localforage.min.js",
    "../lib/velocity.min.js",
    "../lib/velocity.ui.min.js",
    "../lib/jquery.mousewheel.min.js",
    "../lib/jquery.mCustomScrollbar.min.js",
    "../lib/validator.min.js",
    "../lib/bootstrap-editable.min.js",
    "../lib/jquery.easypiechart.min.js",
    "../lib/jquery.hoverIntent.minified.js",
    "../lib/bootstrap-confirmation.js",
    "../lib/bootstrap2-toggle.min.js",
    "util.js",
    "../lib/mustache.min.js",
    "render.js",
    "logging.js",
    "../lib/requirejs/text.js",
    "text!img/logo.svg!strip",
    "../../../templates/modules/header.html!text",
    "../../../templates/modules/footer.html!text",
    "ui/dialog/notification.js",
    "ui/dialog/stats.js",
    "map/util.js",
    "ui/dialog/map_info.js",
    "ui/dialog/account_settings.js",
    "ui/dialog/manual.js",
    "ui/dialog/map_settings.js",
    "ui/dialog/system_effects.js",
    "ui/dialog/jump_info.js",
    "ui/dialog/delete_account.js",
    "../lib/jquery.lazylinepainter-1.5.1.min.js",
    "ui/logo.js",
    "ui/dialog/credit.js",
    "../lib/slidebars.js",
    "map/system.js",
    "../lib/dom.jsPlumb-1.7.6.js",
    "../lib/farahey-0.5.js",
    "map/magnetizing.js",
    "map/scrollbar.js",
    "../lib/jquery.dragToSelect.js",
    "../lib/select2.min.js",
    "map/contextmenu.js",
    "map/overlay.js",
    "map/map.js",
    "counter.js",
    "ui/system_info.js",
    "../lib/raphael-min.js",
    "../lib/morris.min.js",
    "ui/system_graph.js",
    "ui/system_signature.js",
    "ui/system_route.js",
    "ui/system_killboard.js",
    "../lib/datatables/DataTables-1.10.12/js/jquery.dataTables.min.js",
    "../lib/datatables/Buttons-1.2.1/js/dataTables.buttons.min.js",
    "../lib/datatables/Buttons-1.2.1/js/buttons.html5.min.js",
    "../lib/datatables/Responsive-2.1.0/js/dataTables.responsive.min.js",
    "../lib/datatables/Select-1.2.0/js/dataTables.select.min.js",
    "module_map.js",
    "page.js",
    "ui/form_element.js",
    "mappage.js"
  ],
  "names": [],
  "mappings": "AAAA;AACA;AACA;AACA;AACA;AACA,ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC7tBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACraA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACTA;AACA;AACA;AACA;AACA;AACA;AACA,ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACPA;AACA;AACA;AACA;AACA;AACA,ACLA;AACA;AACA,ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACRA;AACA;AACA;AACA;AACA;AACA,ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACz1DA;AACA,ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvYA;AACA,ACDA;AACA,ACDA;AACA,ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtlBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC1zBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC5KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC57YA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3XA;AACA;AACA;AACA,ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACtZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACveA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AClPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACxgEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/eA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3vBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9jCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACzRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "app/mappage.js",
  "sourcesContent": [
    "/*! jQuery v3.0.0 | (c) jQuery Foundation | jquery.org/license */\r\n!function(a,b){\"use strict\";\"object\"==typeof module&&\"object\"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error(\"jQuery requires a window with a document\");return b(a)}:b(a)}(\"undefined\"!=typeof window?window:this,function(a,b){\"use strict\";var c=[],d=a.document,e=Object.getPrototypeOf,f=c.slice,g=c.concat,h=c.push,i=c.indexOf,j={},k=j.toString,l=j.hasOwnProperty,m=l.toString,n=m.call(Object),o={};function p(a,b){b=b||d;var c=b.createElement(\"script\");c.text=a,b.head.appendChild(c).parentNode.removeChild(c)}var q=\"3.0.0\",r=function(a,b){return new r.fn.init(a,b)},s=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,t=/^-ms-/,u=/-([a-z])/g,v=function(a,b){return b.toUpperCase()};r.fn=r.prototype={jquery:q,constructor:r,length:0,toArray:function(){return f.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:f.call(this)},pushStack:function(a){var b=r.merge(this.constructor(),a);return b.prevObject=this,b},each:function(a){return r.each(this,a)},map:function(a){return this.pushStack(r.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:c.sort,splice:c.splice},r.extend=r.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for(\"boolean\"==typeof g&&(j=g,g=arguments[h]||{},h++),\"object\"==typeof g||r.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(r.isPlainObject(d)||(e=r.isArray(d)))?(e?(e=!1,f=c&&r.isArray(c)?c:[]):f=c&&r.isPlainObject(c)?c:{},g[b]=r.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},r.extend({expando:\"jQuery\"+(q+Math.random()).replace(/\\D/g,\"\"),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return\"function\"===r.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=r.type(a);return(\"number\"===b||\"string\"===b)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var b,c;return a&&\"[object Object]\"===k.call(a)?(b=e(a))?(c=l.call(b,\"constructor\")&&b.constructor,\"function\"==typeof c&&m.call(c)===n):!0:!1},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+\"\":\"object\"==typeof a||\"function\"==typeof a?j[k.call(a)]||\"object\":typeof a},globalEval:function(a){p(a)},camelCase:function(a){return a.replace(t,\"ms-\").replace(u,v)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(w(a)){for(c=a.length;c>d;d++)if(b.call(a[d],d,a[d])===!1)break}else for(d in a)if(b.call(a[d],d,a[d])===!1)break;return a},trim:function(a){return null==a?\"\":(a+\"\").replace(s,\"\")},makeArray:function(a,b){var c=b||[];return null!=a&&(w(Object(a))?r.merge(c,\"string\"==typeof a?[a]:a):h.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:i.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,f=0,h=[];if(w(a))for(d=a.length;d>f;f++)e=b(a[f],f,c),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&h.push(e);return g.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;return\"string\"==typeof b&&(c=a[b],b=a,a=c),r.isFunction(a)?(d=f.call(arguments,2),e=function(){return a.apply(b||this,d.concat(f.call(arguments)))},e.guid=a.guid=a.guid||r.guid++,e):void 0},now:Date.now,support:o}),\"function\"==typeof Symbol&&(r.fn[Symbol.iterator]=c[Symbol.iterator]),r.each(\"Boolean Number String Function Array Date RegExp Object Error Symbol\".split(\" \"),function(a,b){j[\"[object \"+b+\"]\"]=b.toLowerCase()});function w(a){var b=!!a&&\"length\"in a&&a.length,c=r.type(a);return\"function\"===c||r.isWindow(a)?!1:\"array\"===c||0===b||\"number\"==typeof b&&b>0&&b-1 in a}var x=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=\"sizzle\"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},J=\"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",K=\"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",L=\"(?:\\\\\\\\.|[\\\\w-]|[^\\x00-\\\\xa0])+\",M=\"\\\\[\"+K+\"*(\"+L+\")(?:\"+K+\"*([*^$|!~]?=)\"+K+\"*(?:'((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\"|(\"+L+\"))|)\"+K+\"*\\\\]\",N=\":(\"+L+\")(?:\\\\((('((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\")|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\"+M+\")*)|.*)\\\\)|)\",O=new RegExp(K+\"+\",\"g\"),P=new RegExp(\"^\"+K+\"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\"+K+\"+$\",\"g\"),Q=new RegExp(\"^\"+K+\"*,\"+K+\"*\"),R=new RegExp(\"^\"+K+\"*([>+~]|\"+K+\")\"+K+\"*\"),S=new RegExp(\"=\"+K+\"*([^\\\\]'\\\"]*?)\"+K+\"*\\\\]\",\"g\"),T=new RegExp(N),U=new RegExp(\"^\"+L+\"$\"),V={ID:new RegExp(\"^#(\"+L+\")\"),CLASS:new RegExp(\"^\\\\.(\"+L+\")\"),TAG:new RegExp(\"^(\"+L+\"|[*])\"),ATTR:new RegExp(\"^\"+M),PSEUDO:new RegExp(\"^\"+N),CHILD:new RegExp(\"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\"+K+\"*(even|odd|(([+-]|)(\\\\d*)n|)\"+K+\"*(?:([+-]|)\"+K+\"*(\\\\d+)|))\"+K+\"*\\\\)|)\",\"i\"),bool:new RegExp(\"^(?:\"+J+\")$\",\"i\"),needsContext:new RegExp(\"^\"+K+\"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\"+K+\"*((?:-\\\\d)?\\\\d*)\"+K+\"*\\\\)|)(?=[^-]|$)\",\"i\")},W=/^(?:input|select|textarea|button)$/i,X=/^h\\d$/i,Y=/^[^{]+\\{\\s*\\[native \\w/,Z=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,$=/[+~]/,_=new RegExp(\"\\\\\\\\([\\\\da-f]{1,6}\"+K+\"?|(\"+K+\")|.)\",\"ig\"),aa=function(a,b,c){var d=\"0x\"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ba=/([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\x80-\\uFFFF\\w-]/g,ca=function(a,b){return b?\"\\x00\"===a?\"\\ufffd\":a.slice(0,-1)+\"\\\\\"+a.charCodeAt(a.length-1).toString(16)+\" \":\"\\\\\"+a},da=function(){m()},ea=ta(function(a){return a.disabled===!0},{dir:\"parentNode\",next:\"legend\"});try{G.apply(D=H.call(v.childNodes),v.childNodes),D[v.childNodes.length].nodeType}catch(fa){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s=b&&b.ownerDocument,w=b?b.nodeType:9;if(d=d||[],\"string\"!=typeof a||!a||1!==w&&9!==w&&11!==w)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==w&&(l=Z.exec(a)))if(f=l[1]){if(9===w){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(s&&(j=s.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(l[2])return G.apply(d,b.getElementsByTagName(a)),d;if((f=l[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+\" \"]&&(!q||!q.test(a))){if(1!==w)s=b,r=a;else if(\"object\"!==b.nodeName.toLowerCase()){(k=b.getAttribute(\"id\"))?k=k.replace(ba,ca):b.setAttribute(\"id\",k=u),o=g(a),h=o.length;while(h--)o[h]=\"#\"+k+\" \"+sa(o[h]);r=o.join(\",\"),s=$.test(a)&&qa(b.parentNode)||b}if(r)try{return G.apply(d,s.querySelectorAll(r)),d}catch(x){}finally{k===u&&b.removeAttribute(\"id\")}}}return i(a.replace(P,\"$1\"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+\" \")>d.cacheLength&&delete b[a.shift()],b[c+\" \"]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement(\"fieldset\");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split(\"|\"),e=c.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return\"input\"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return(\"input\"===c||\"button\"===c)&&b.type===a}}function oa(a){return function(b){return\"label\"in b&&b.disabled===a||\"form\"in b&&b.disabled===a||\"form\"in b&&b.disabled===!1&&(b.isDisabled===a||b.isDisabled!==!a&&(\"label\"in b||!ea(b))!==a)}}function pa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function qa(a){return a&&\"undefined\"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?\"HTML\"!==b.nodeName:!1},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),v!==n&&(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener(\"unload\",da,!1):e.attachEvent&&e.attachEvent(\"onunload\",da)),c.attributes=ja(function(a){return a.className=\"i\",!a.getAttribute(\"className\")}),c.getElementsByTagName=ja(function(a){return a.appendChild(n.createComment(\"\")),!a.getElementsByTagName(\"*\").length}),c.getElementsByClassName=Y.test(n.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(\"undefined\"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}},d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){return a.getAttribute(\"id\")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){var c=\"undefined\"!=typeof a.getAttributeNode&&a.getAttributeNode(\"id\");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return\"undefined\"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if(\"*\"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return\"undefined\"!=typeof b.getElementsByClassName&&p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=Y.test(n.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML=\"<a id='\"+u+\"'></a><select id='\"+u+\"-\\r\\\\' msallowcapture=''><option selected=''></option></select>\",a.querySelectorAll(\"[msallowcapture^='']\").length&&q.push(\"[*^$]=\"+K+\"*(?:''|\\\"\\\")\"),a.querySelectorAll(\"[selected]\").length||q.push(\"\\\\[\"+K+\"*(?:value|\"+J+\")\"),a.querySelectorAll(\"[id~=\"+u+\"-]\").length||q.push(\"~=\"),a.querySelectorAll(\":checked\").length||q.push(\":checked\"),a.querySelectorAll(\"a#\"+u+\"+*\").length||q.push(\".#.+[+~]\")}),ja(function(a){a.innerHTML=\"<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>\";var b=n.createElement(\"input\");b.setAttribute(\"type\",\"hidden\"),a.appendChild(b).setAttribute(\"name\",\"D\"),a.querySelectorAll(\"[name=d]\").length&&q.push(\"name\"+K+\"*[*^$|!~]?=\"),2!==a.querySelectorAll(\":enabled\").length&&q.push(\":enabled\",\":disabled\"),o.appendChild(a).disabled=!0,2!==a.querySelectorAll(\":disabled\").length&&q.push(\":enabled\",\":disabled\"),a.querySelectorAll(\"*,:x\"),q.push(\",.*:\")})),(c.matchesSelector=Y.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,\"*\"),s.call(a,\"[s!='']:x\"),r.push(\"!=\",N)}),q=q.length&&new RegExp(q.join(\"|\")),r=r.length&&new RegExp(r.join(\"|\")),b=Y.test(o.compareDocumentPosition),t=b||Y.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?I(k,a)-I(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?I(k,a)-I(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)g.unshift(c);c=b;while(c=c.parentNode)h.unshift(c);while(g[d]===h[d])d++;return d?la(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(S,\"='$1']\"),c.matchesSelector&&p&&!A[b+\" \"]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.escape=function(a){return(a+\"\").replace(ba,ca)},ga.error=function(a){throw new Error(\"Syntax error, unrecognized expression: \"+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c=\"\",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if(\"string\"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:V,attrHandle:{},find:{},relative:{\">\":{dir:\"parentNode\",first:!0},\" \":{dir:\"parentNode\"},\"+\":{dir:\"previousSibling\",first:!0},\"~\":{dir:\"previousSibling\"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(_,aa),a[3]=(a[3]||a[4]||a[5]||\"\").replace(_,aa),\"~=\"===a[2]&&(a[3]=\" \"+a[3]+\" \"),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),\"nth\"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*(\"even\"===a[3]||\"odd\"===a[3])),a[5]=+(a[7]+a[8]||\"odd\"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return V.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||\"\":c&&T.test(c)&&(b=g(c,!0))&&(b=c.indexOf(\")\",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(_,aa).toLowerCase();return\"*\"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+\" \"];return b||(b=new RegExp(\"(^|\"+K+\")\"+a+\"(\"+K+\"|$)\"))&&y(a,function(a){return b.test(\"string\"==typeof a.className&&a.className||\"undefined\"!=typeof a.getAttribute&&a.getAttribute(\"class\")||\"\")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?\"!=\"===b:b?(e+=\"\",\"=\"===b?e===c:\"!=\"===b?e!==c:\"^=\"===b?c&&0===e.indexOf(c):\"*=\"===b?c&&e.indexOf(c)>-1:\"$=\"===b?c&&e.slice(-c.length)===c:\"~=\"===b?(\" \"+e.replace(O,\" \")+\" \").indexOf(c)>-1:\"|=\"===b?e===c||e.slice(0,c.length+1)===c+\"-\":!1):!0}},CHILD:function(a,b,c,d,e){var f=\"nth\"!==a.slice(0,3),g=\"last\"!==a.slice(-4),h=\"of-type\"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?\"nextSibling\":\"previousSibling\",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){while(p){m=b;while(m=m[p])if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p=\"only\"===a&&!o&&\"nextSibling\"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),t===!1)while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if((h?m.nodeName.toLowerCase()===r:1===m.nodeType)&&++t&&(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m===b))break;return t-=e,t===d||t%d===0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error(\"unsupported pseudo: \"+a);return e[u]?e(b):e.length>1?(c=[a,a,\"\",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(P,\"$1\"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(_,aa),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return U.test(a||\"\")||ga.error(\"unsupported lang: \"+a),a=a.replace(_,aa).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute(\"xml:lang\")||b.getAttribute(\"lang\"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+\"-\");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:oa(!1),disabled:oa(!0),checked:function(a){var b=a.nodeName.toLowerCase();return\"input\"===b&&!!a.checked||\"option\"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return\"input\"===b&&\"button\"===a.type||\"button\"===b},text:function(a){var b;return\"input\"===a.nodeName.toLowerCase()&&\"text\"===a.type&&(null==(b=a.getAttribute(\"type\"))||\"text\"===b.toLowerCase())},first:pa(function(){return[0]}),last:pa(function(a,b){return[b-1]}),eq:pa(function(a,b,c){return[0>c?c+b:c]}),even:pa(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:pa(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:pa(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:pa(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function ra(){}ra.prototype=d.filters=d.pseudos,d.setFilters=new ra,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+\" \"];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){c&&!(e=Q.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P,\" \")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function sa(a){for(var b=0,c=a.length,d=\"\";c>b;b++)d+=a[b].value;return d}function ta(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&\"parentNode\"===f,h=x++;return b.first?function(b,c,e){while(b=b[d])if(1===b.nodeType||g)return a(b,c,e)}:function(b,c,i){var j,k,l,m=[w,h];if(i){while(b=b[d])if((1===b.nodeType||g)&&a(b,c,i))return!0}else while(b=b[d])if(1===b.nodeType||g)if(l=b[u]||(b[u]={}),k=l[b.uniqueID]||(l[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((j=k[f])&&j[0]===w&&j[1]===h)return m[2]=j[2];if(k[f]=m,m[2]=a(b,c,i))return!0}}}function ua(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function va(a,b,c){for(var d=0,e=b.length;e>d;d++)ga(a,b[d],c);return c}function wa(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function xa(a,b,c,d,e,f){return d&&!d[u]&&(d=xa(d)),e&&!e[u]&&(e=xa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||va(b||\"*\",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:wa(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=wa(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=wa(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ya(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[\" \"],i=g?1:0,k=ta(function(a){return a===b},h,!0),l=ta(function(a){return I(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[ta(ua(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return xa(i>1&&ua(m),i>1&&sa(a.slice(0,i-1).concat({value:\" \"===a[i-2].type?\"*\":\"\"})).replace(P,\"$1\"),c,e>i&&ya(a.slice(i,e)),f>e&&ya(a=a.slice(e)),f>e&&sa(a))}m.push(c)}return ua(m)}function za(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s=\"0\",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG(\"*\",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){o=0,g||l.ownerDocument===n||(m(l),h=!p);while(q=a[o++])if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){o=0;while(q=b[o++])q(t,u,g,h);if(f){if(r>0)while(s--)t[s]||u[s]||(u[s]=E.call(i));u=wa(u)}G.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&ga.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+\" \"];if(!f){b||(b=g(a)),c=b.length;while(c--)f=ya(b[c]),f[u]?d.push(f):e.push(f);f=A(a,za(e,d)),f.selector=a}return f},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n=\"function\"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&\"ID\"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(_,aa),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=V.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(_,aa),$.test(j[0].type)&&qa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&sa(j),!a)return G.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,!b||$.test(a)&&qa(b.parentNode)||b),e},c.sortStable=u.split(\"\").sort(B).join(\"\")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement(\"fieldset\"))}),ja(function(a){return a.innerHTML=\"<a href='#'></a>\",\"#\"===a.firstChild.getAttribute(\"href\")})||ka(\"type|href|height|width\",function(a,b,c){return c?void 0:a.getAttribute(b,\"type\"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML=\"<input/>\",a.firstChild.setAttribute(\"value\",\"\"),\"\"===a.firstChild.getAttribute(\"value\")})||ka(\"value\",function(a,b,c){return c||\"input\"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ja(function(a){return null==a.getAttribute(\"disabled\")})||ka(J,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);r.find=x,r.expr=x.selectors,r.expr[\":\"]=r.expr.pseudos,r.uniqueSort=r.unique=x.uniqueSort,r.text=x.getText,r.isXMLDoc=x.isXML,r.contains=x.contains,r.escapeSelector=x.escape;var y=function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&r(a).is(c))break;d.push(a)}return d},z=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},A=r.expr.match.needsContext,B=/^<([a-z][^\\/\\0>:\\x20\\t\\r\\n\\f]*)[\\x20\\t\\r\\n\\f]*\\/?>(?:<\\/\\1>|)$/i,C=/^.[^:#\\[\\.,]*$/;function D(a,b,c){if(r.isFunction(b))return r.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return r.grep(a,function(a){return a===b!==c});if(\"string\"==typeof b){if(C.test(b))return r.filter(b,a,c);b=r.filter(b,a)}return r.grep(a,function(a){return i.call(b,a)>-1!==c&&1===a.nodeType})}r.filter=function(a,b,c){var d=b[0];return c&&(a=\":not(\"+a+\")\"),1===b.length&&1===d.nodeType?r.find.matchesSelector(d,a)?[d]:[]:r.find.matches(a,r.grep(b,function(a){return 1===a.nodeType}))},r.fn.extend({find:function(a){var b,c,d=this.length,e=this;if(\"string\"!=typeof a)return this.pushStack(r(a).filter(function(){for(b=0;d>b;b++)if(r.contains(e[b],this))return!0}));for(c=this.pushStack([]),b=0;d>b;b++)r.find(a,e[b],c);return d>1?r.uniqueSort(c):c},filter:function(a){return this.pushStack(D(this,a||[],!1))},not:function(a){return this.pushStack(D(this,a||[],!0))},is:function(a){return!!D(this,\"string\"==typeof a&&A.test(a)?r(a):a||[],!1).length}});var E,F=/^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]+))$/,G=r.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||E,\"string\"==typeof a){if(e=\"<\"===a[0]&&\">\"===a[a.length-1]&&a.length>=3?[null,a,null]:F.exec(a),!e||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof r?b[0]:b,r.merge(this,r.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),B.test(e[1])&&r.isPlainObject(b))for(e in b)r.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&(this[0]=f,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):r.isFunction(a)?void 0!==c.ready?c.ready(a):a(r):r.makeArray(a,this)};G.prototype=r.fn,E=r(d);var H=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({has:function(a){var b=r(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(r.contains(this,b[a]))return!0})},closest:function(a,b){var c,d=0,e=this.length,f=[],g=\"string\"!=typeof a&&r(a);if(!A.test(a))for(;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&r.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?r.uniqueSort(f):f)},index:function(a){return a?\"string\"==typeof a?i.call(r(a),this[0]):i.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(r.uniqueSort(r.merge(this.get(),r(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function J(a,b){while((a=a[b])&&1!==a.nodeType);return a}r.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return y(a,\"parentNode\")},parentsUntil:function(a,b,c){return y(a,\"parentNode\",c)},next:function(a){return J(a,\"nextSibling\")},prev:function(a){return J(a,\"previousSibling\")},nextAll:function(a){return y(a,\"nextSibling\")},prevAll:function(a){return y(a,\"previousSibling\")},nextUntil:function(a,b,c){return y(a,\"nextSibling\",c)},prevUntil:function(a,b,c){return y(a,\"previousSibling\",c)},siblings:function(a){return z((a.parentNode||{}).firstChild,a)},children:function(a){return z(a.firstChild)},contents:function(a){return a.contentDocument||r.merge([],a.childNodes)}},function(a,b){r.fn[a]=function(c,d){var e=r.map(this,b,c);return\"Until\"!==a.slice(-5)&&(d=c),d&&\"string\"==typeof d&&(e=r.filter(d,e)),this.length>1&&(I[a]||r.uniqueSort(e),H.test(a)&&e.reverse()),this.pushStack(e)}});var K=/\\S+/g;function L(a){var b={};return r.each(a.match(K)||[],function(a,c){b[c]=!0}),b}r.Callbacks=function(a){a=\"string\"==typeof a?L(a):r.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=a.once,d=b=!0;g.length;h=-1){c=g.shift();while(++h<f.length)f[h].apply(c[0],c[1])===!1&&a.stopOnFalse&&(h=f.length,c=!1)}a.memory||(c=!1),b=!1,e&&(f=c?[]:\"\")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){r.each(b,function(b,c){r.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&\"string\"!==r.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return r.each(arguments,function(a,b){var c;while((c=r.inArray(b,f,c))>-1)f.splice(c,1),h>=c&&h--}),this},has:function(a){return a?r.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c=\"\",this},disabled:function(){return!f},lock:function(){return e=g=[],c||b||(f=c=\"\"),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j};function M(a){return a}function N(a){throw a}function O(a,b,c){var d;try{a&&r.isFunction(d=a.promise)?d.call(a).done(b).fail(c):a&&r.isFunction(d=a.then)?d.call(a,b,c):b.call(void 0,a)}catch(a){c.call(void 0,a)}}r.extend({Deferred:function(b){var c=[[\"notify\",\"progress\",r.Callbacks(\"memory\"),r.Callbacks(\"memory\"),2],[\"resolve\",\"done\",r.Callbacks(\"once memory\"),r.Callbacks(\"once memory\"),0,\"resolved\"],[\"reject\",\"fail\",r.Callbacks(\"once memory\"),r.Callbacks(\"once memory\"),1,\"rejected\"]],d=\"pending\",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},\"catch\":function(a){return e.then(null,a)},pipe:function(){var a=arguments;return r.Deferred(function(b){r.each(c,function(c,d){var e=r.isFunction(a[d[4]])&&a[d[4]];f[d[1]](function(){var a=e&&e.apply(this,arguments);a&&r.isFunction(a.promise)?a.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+\"With\"](this,e?[a]:arguments)})}),a=null}).promise()},then:function(b,d,e){var f=0;function g(b,c,d,e){return function(){var h=this,i=arguments,j=function(){var a,j;if(!(f>b)){if(a=d.apply(h,i),a===c.promise())throw new TypeError(\"Thenable self-resolution\");j=a&&(\"object\"==typeof a||\"function\"==typeof a)&&a.then,r.isFunction(j)?e?j.call(a,g(f,c,M,e),g(f,c,N,e)):(f++,j.call(a,g(f,c,M,e),g(f,c,N,e),g(f,c,M,c.notifyWith))):(d!==M&&(h=void 0,i=[a]),(e||c.resolveWith)(h,i))}},k=e?j:function(){try{j()}catch(a){r.Deferred.exceptionHook&&r.Deferred.exceptionHook(a,k.stackTrace),b+1>=f&&(d!==N&&(h=void 0,i=[a]),c.rejectWith(h,i))}};b?k():(r.Deferred.getStackHook&&(k.stackTrace=r.Deferred.getStackHook()),a.setTimeout(k))}}return r.Deferred(function(a){c[0][3].add(g(0,a,r.isFunction(e)?e:M,a.notifyWith)),c[1][3].add(g(0,a,r.isFunction(b)?b:M)),c[2][3].add(g(0,a,r.isFunction(d)?d:N))}).promise()},promise:function(a){return null!=a?r.extend(a,e):e}},f={};return r.each(c,function(a,b){var g=b[2],h=b[5];e[b[1]]=g.add,h&&g.add(function(){d=h},c[3-a][2].disable,c[0][2].lock),g.add(b[3].fire),f[b[0]]=function(){return f[b[0]+\"With\"](this===f?void 0:this,arguments),this},f[b[0]+\"With\"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(a){var b=arguments.length,c=b,d=Array(c),e=f.call(arguments),g=r.Deferred(),h=function(a){return function(c){d[a]=this,e[a]=arguments.length>1?f.call(arguments):c,--b||g.resolveWith(d,e)}};if(1>=b&&(O(a,g.done(h(c)).resolve,g.reject),\"pending\"===g.state()||r.isFunction(e[c]&&e[c].then)))return g.then();while(c--)O(e[c],h(c),g.reject);return g.promise()}});var P=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;r.Deferred.exceptionHook=function(b,c){a.console&&a.console.warn&&b&&P.test(b.name)&&a.console.warn(\"jQuery.Deferred exception: \"+b.message,b.stack,c)};var Q=r.Deferred();r.fn.ready=function(a){return Q.then(a),this},r.extend({isReady:!1,readyWait:1,holdReady:function(a){a?r.readyWait++:r.ready(!0)},ready:function(a){(a===!0?--r.readyWait:r.isReady)||(r.isReady=!0,a!==!0&&--r.readyWait>0||Q.resolveWith(d,[r]))}}),r.ready.then=Q.then;function R(){d.removeEventListener(\"DOMContentLoaded\",R),a.removeEventListener(\"load\",R),r.ready()}\"complete\"===d.readyState||\"loading\"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(r.ready):(d.addEventListener(\"DOMContentLoaded\",R),a.addEventListener(\"load\",R));var S=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if(\"object\"===r.type(c)){e=!0;for(h in c)S(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,r.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){\r\nreturn j.call(r(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},T=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function U(){this.expando=r.expando+U.uid++}U.uid=1,U.prototype={cache:function(a){var b=a[this.expando];return b||(b={},T(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if(\"string\"==typeof b)e[r.camelCase(b)]=c;else for(d in b)e[r.camelCase(d)]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][r.camelCase(b)]},access:function(a,b,c){return void 0===b||b&&\"string\"==typeof b&&void 0===c?this.get(a,b):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d=a[this.expando];if(void 0!==d){if(void 0!==b){r.isArray(b)?b=b.map(r.camelCase):(b=r.camelCase(b),b=b in d?[b]:b.match(K)||[]),c=b.length;while(c--)delete d[b[c]]}(void 0===b||r.isEmptyObject(d))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!r.isEmptyObject(b)}};var V=new U,W=new U,X=/^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,Y=/[A-Z]/g;function Z(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d=\"data-\"+b.replace(Y,\"-$&\").toLowerCase(),c=a.getAttribute(d),\"string\"==typeof c){try{c=\"true\"===c?!0:\"false\"===c?!1:\"null\"===c?null:+c+\"\"===c?+c:X.test(c)?JSON.parse(c):c}catch(e){}W.set(a,b,c)}else c=void 0;return c}r.extend({hasData:function(a){return W.hasData(a)||V.hasData(a)},data:function(a,b,c){return W.access(a,b,c)},removeData:function(a,b){W.remove(a,b)},_data:function(a,b,c){return V.access(a,b,c)},_removeData:function(a,b){V.remove(a,b)}}),r.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=W.get(f),1===f.nodeType&&!V.get(f,\"hasDataAttrs\"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf(\"data-\")&&(d=r.camelCase(d.slice(5)),Z(f,d,e[d])));V.set(f,\"hasDataAttrs\",!0)}return e}return\"object\"==typeof a?this.each(function(){W.set(this,a)}):S(this,function(b){var c;if(f&&void 0===b){if(c=W.get(f,a),void 0!==c)return c;if(c=Z(f,a),void 0!==c)return c}else this.each(function(){W.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){W.remove(this,a)})}}),r.extend({queue:function(a,b,c){var d;return a?(b=(b||\"fx\")+\"queue\",d=V.get(a,b),c&&(!d||r.isArray(c)?d=V.access(a,b,r.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||\"fx\";var c=r.queue(a,b),d=c.length,e=c.shift(),f=r._queueHooks(a,b),g=function(){r.dequeue(a,b)};\"inprogress\"===e&&(e=c.shift(),d--),e&&(\"fx\"===b&&c.unshift(\"inprogress\"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+\"queueHooks\";return V.get(a,c)||V.access(a,c,{empty:r.Callbacks(\"once memory\").add(function(){V.remove(a,[b+\"queue\",c])})})}}),r.fn.extend({queue:function(a,b){var c=2;return\"string\"!=typeof a&&(b=a,a=\"fx\",c--),arguments.length<c?r.queue(this[0],a):void 0===b?this:this.each(function(){var c=r.queue(this,a,b);r._queueHooks(this,a),\"fx\"===a&&\"inprogress\"!==c[0]&&r.dequeue(this,a)})},dequeue:function(a){return this.each(function(){r.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||\"fx\",[])},promise:function(a,b){var c,d=1,e=r.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};\"string\"!=typeof a&&(b=a,a=void 0),a=a||\"fx\";while(g--)c=V.get(f[g],a+\"queueHooks\"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var $=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,_=new RegExp(\"^(?:([+-])=|)(\"+$+\")([a-z%]*)$\",\"i\"),aa=[\"Top\",\"Right\",\"Bottom\",\"Left\"],ba=function(a,b){return a=b||a,\"none\"===a.style.display||\"\"===a.style.display&&r.contains(a.ownerDocument,a)&&\"none\"===r.css(a,\"display\")},ca=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};function da(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return r.css(a,b,\"\")},i=h(),j=c&&c[3]||(r.cssNumber[b]?\"\":\"px\"),k=(r.cssNumber[b]||\"px\"!==j&&+i)&&_.exec(r.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do f=f||\".5\",k/=f,r.style(a,b,k+j);while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var ea={};function fa(a){var b,c=a.ownerDocument,d=a.nodeName,e=ea[d];return e?e:(b=c.body.appendChild(c.createElement(d)),e=r.css(b,\"display\"),b.parentNode.removeChild(b),\"none\"===e&&(e=\"block\"),ea[d]=e,e)}function ga(a,b){for(var c,d,e=[],f=0,g=a.length;g>f;f++)d=a[f],d.style&&(c=d.style.display,b?(\"none\"===c&&(e[f]=V.get(d,\"display\")||null,e[f]||(d.style.display=\"\")),\"\"===d.style.display&&ba(d)&&(e[f]=fa(d))):\"none\"!==c&&(e[f]=\"none\",V.set(d,\"display\",c)));for(f=0;g>f;f++)null!=e[f]&&(a[f].style.display=e[f]);return a}r.fn.extend({show:function(){return ga(this,!0)},hide:function(){return ga(this)},toggle:function(a){return\"boolean\"==typeof a?a?this.show():this.hide():this.each(function(){ba(this)?r(this).show():r(this).hide()})}});var ha=/^(?:checkbox|radio)$/i,ia=/<([a-z][^\\/\\0>\\x20\\t\\r\\n\\f]+)/i,ja=/^$|\\/(?:java|ecma)script/i,ka={option:[1,\"<select multiple='multiple'>\",\"</select>\"],thead:[1,\"<table>\",\"</table>\"],col:[2,\"<table><colgroup>\",\"</colgroup></table>\"],tr:[2,\"<table><tbody>\",\"</tbody></table>\"],td:[3,\"<table><tbody><tr>\",\"</tr></tbody></table>\"],_default:[0,\"\",\"\"]};ka.optgroup=ka.option,ka.tbody=ka.tfoot=ka.colgroup=ka.caption=ka.thead,ka.th=ka.td;function la(a,b){var c=\"undefined\"!=typeof a.getElementsByTagName?a.getElementsByTagName(b||\"*\"):\"undefined\"!=typeof a.querySelectorAll?a.querySelectorAll(b||\"*\"):[];return void 0===b||b&&r.nodeName(a,b)?r.merge([a],c):c}function ma(a,b){for(var c=0,d=a.length;d>c;c++)V.set(a[c],\"globalEval\",!b||V.get(b[c],\"globalEval\"))}var na=/<|&#?\\w+;/;function oa(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],n=0,o=a.length;o>n;n++)if(f=a[n],f||0===f)if(\"object\"===r.type(f))r.merge(m,f.nodeType?[f]:f);else if(na.test(f)){g=g||l.appendChild(b.createElement(\"div\")),h=(ia.exec(f)||[\"\",\"\"])[1].toLowerCase(),i=ka[h]||ka._default,g.innerHTML=i[1]+r.htmlPrefilter(f)+i[2],k=i[0];while(k--)g=g.lastChild;r.merge(m,g.childNodes),g=l.firstChild,g.textContent=\"\"}else m.push(b.createTextNode(f));l.textContent=\"\",n=0;while(f=m[n++])if(d&&r.inArray(f,d)>-1)e&&e.push(f);else if(j=r.contains(f.ownerDocument,f),g=la(l.appendChild(f),\"script\"),j&&ma(g),c){k=0;while(f=g[k++])ja.test(f.type||\"\")&&c.push(f)}return l}!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement(\"div\")),c=d.createElement(\"input\");c.setAttribute(\"type\",\"radio\"),c.setAttribute(\"checked\",\"checked\"),c.setAttribute(\"name\",\"t\"),b.appendChild(c),o.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML=\"<textarea>x</textarea>\",o.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var pa=d.documentElement,qa=/^key/,ra=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,sa=/^([^.]*)(?:\\.(.+)|)/;function ta(){return!0}function ua(){return!1}function va(){try{return d.activeElement}catch(a){}}function wa(a,b,c,d,e,f){var g,h;if(\"object\"==typeof b){\"string\"!=typeof c&&(d=d||c,c=void 0);for(h in b)wa(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&(\"string\"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),e===!1)e=ua;else if(!e)return a;return 1===f&&(g=e,e=function(a){return r().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=r.guid++)),a.each(function(){r.event.add(this,b,e,d,c)})}r.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.get(a);if(q){c.handler&&(f=c,c=f.handler,e=f.selector),e&&r.find.matchesSelector(pa,e),c.guid||(c.guid=r.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return\"undefined\"!=typeof r&&r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0}),b=(b||\"\").match(K)||[\"\"],j=b.length;while(j--)h=sa.exec(b[j])||[],n=p=h[1],o=(h[2]||\"\").split(\".\").sort(),n&&(l=r.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=r.event.special[n]||{},k=r.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&r.expr.match.needsContext.test(e),namespace:o.join(\".\")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),r.event.global[n]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.hasData(a)&&V.get(a);if(q&&(i=q.events)){b=(b||\"\").match(K)||[\"\"],j=b.length;while(j--)if(h=sa.exec(b[j])||[],n=p=h[1],o=(h[2]||\"\").split(\".\").sort(),n){l=r.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp(\"(^|\\\\.)\"+o.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"),g=f=m.length;while(f--)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&(\"**\"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||r.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)r.event.remove(a,n+b[j],c,d,!0);r.isEmptyObject(i)&&V.remove(a,\"handle events\")}},dispatch:function(a){var b=r.event.fix(a),c,d,e,f,g,h,i=new Array(arguments.length),j=(V.get(this,\"events\")||{})[b.type]||[],k=r.event.special[b.type]||{};for(i[0]=b,c=1;c<arguments.length;c++)i[c]=arguments[c];if(b.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,b)!==!1){h=r.event.handlers.call(this,b,j),c=0;while((f=h[c++])&&!b.isPropagationStopped()){b.currentTarget=f.elem,d=0;while((g=f.handlers[d++])&&!b.isImmediatePropagationStopped())b.rnamespace&&!b.rnamespace.test(g.namespace)||(b.handleObj=g,b.data=g.data,e=((r.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(b.result=e)===!1&&(b.preventDefault(),b.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,b),b.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(\"click\"!==a.type||isNaN(a.button)||a.button<1))for(;i!==this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||\"click\"!==a.type)){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+\" \",void 0===d[e]&&(d[e]=f.needsContext?r(e,this).index(i)>-1:r.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},addProp:function(a,b){Object.defineProperty(r.Event.prototype,a,{enumerable:!0,configurable:!0,get:r.isFunction(b)?function(){return this.originalEvent?b(this.originalEvent):void 0}:function(){return this.originalEvent?this.originalEvent[a]:void 0},set:function(b){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(a){return a[r.expando]?a:new r.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==va()&&this.focus?(this.focus(),!1):void 0},delegateType:\"focusin\"},blur:{trigger:function(){return this===va()&&this.blur?(this.blur(),!1):void 0},delegateType:\"focusout\"},click:{trigger:function(){return\"checkbox\"===this.type&&this.click&&r.nodeName(this,\"input\")?(this.click(),!1):void 0},_default:function(a){return r.nodeName(a.target,\"a\")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},r.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},r.Event=function(a,b){return this instanceof r.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?ta:ua,this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,b&&r.extend(this,b),this.timeStamp=a&&a.timeStamp||r.now(),void(this[r.expando]=!0)):new r.Event(a,b)},r.Event.prototype={constructor:r.Event,isDefaultPrevented:ua,isPropagationStopped:ua,isImmediatePropagationStopped:ua,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ta,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ta,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ta,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},r.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,\"char\":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var b=a.button;return null==a.which&&qa.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==b&&ra.test(a.type)?1&b?1:2&b?3:4&b?2:0:a.which}},r.event.addProp),r.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\",pointerenter:\"pointerover\",pointerleave:\"pointerout\"},function(a,b){r.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||r.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),r.fn.extend({on:function(a,b,c,d){return wa(this,a,b,c,d)},one:function(a,b,c,d){return wa(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,r(a.delegateTarget).off(d.namespace?d.origType+\".\"+d.namespace:d.origType,d.selector,d.handler),this;if(\"object\"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&\"function\"!=typeof b||(c=b,b=void 0),c===!1&&(c=ua),this.each(function(){r.event.remove(this,a,c,b)})}});var xa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\\/\\0>\\x20\\t\\r\\n\\f]*)[^>]*)\\/>/gi,ya=/<script|<style|<link/i,za=/checked\\s*(?:[^=]|=\\s*.checked.)/i,Aa=/^true\\/(.*)/,Ba=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g;function Ca(a,b){return r.nodeName(a,\"table\")&&r.nodeName(11!==b.nodeType?b:b.firstChild,\"tr\")?a.getElementsByTagName(\"tbody\")[0]||a:a}function Da(a){return a.type=(null!==a.getAttribute(\"type\"))+\"/\"+a.type,a}function Ea(a){var b=Aa.exec(a.type);return b?a.type=b[1]:a.removeAttribute(\"type\"),a}function Fa(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(V.hasData(a)&&(f=V.access(a),g=V.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)r.event.add(b,e,j[e][c])}W.hasData(a)&&(h=W.access(a),i=r.extend({},h),W.set(b,i))}}function Ga(a,b){var c=b.nodeName.toLowerCase();\"input\"===c&&ha.test(a.type)?b.checked=a.checked:\"input\"!==c&&\"textarea\"!==c||(b.defaultValue=a.defaultValue)}function Ha(a,b,c,d){b=g.apply([],b);var e,f,h,i,j,k,l=0,m=a.length,n=m-1,q=b[0],s=r.isFunction(q);if(s||m>1&&\"string\"==typeof q&&!o.checkClone&&za.test(q))return a.each(function(e){var f=a.eq(e);s&&(b[0]=q.call(this,e,f.html())),Ha(f,b,c,d)});if(m&&(e=oa(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(h=r.map(la(e,\"script\"),Da),i=h.length;m>l;l++)j=e,l!==n&&(j=r.clone(j,!0,!0),i&&r.merge(h,la(j,\"script\"))),c.call(a[l],j,l);if(i)for(k=h[h.length-1].ownerDocument,r.map(h,Ea),l=0;i>l;l++)j=h[l],ja.test(j.type||\"\")&&!V.access(j,\"globalEval\")&&r.contains(k,j)&&(j.src?r._evalUrl&&r._evalUrl(j.src):p(j.textContent.replace(Ba,\"\"),k))}return a}function Ia(a,b,c){for(var d,e=b?r.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||r.cleanData(la(d)),d.parentNode&&(c&&r.contains(d.ownerDocument,d)&&ma(la(d,\"script\")),d.parentNode.removeChild(d));return a}r.extend({htmlPrefilter:function(a){return a.replace(xa,\"<$1></$2>\")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=r.contains(a.ownerDocument,a);if(!(o.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||r.isXMLDoc(a)))for(g=la(h),f=la(a),d=0,e=f.length;e>d;d++)Ga(f[d],g[d]);if(b)if(c)for(f=f||la(a),g=g||la(h),d=0,e=f.length;e>d;d++)Fa(f[d],g[d]);else Fa(a,h);return g=la(h,\"script\"),g.length>0&&ma(g,!i&&la(a,\"script\")),h},cleanData:function(a){for(var b,c,d,e=r.event.special,f=0;void 0!==(c=a[f]);f++)if(T(c)){if(b=c[V.expando]){if(b.events)for(d in b.events)e[d]?r.event.remove(c,d):r.removeEvent(c,d,b.handle);c[V.expando]=void 0}c[W.expando]&&(c[W.expando]=void 0)}}}),r.fn.extend({detach:function(a){return Ia(this,a,!0)},remove:function(a){return Ia(this,a)},text:function(a){return S(this,function(a){return void 0===a?r.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return Ha(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Ca(this,a);b.appendChild(a)}})},prepend:function(){return Ha(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Ca(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return Ha(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return Ha(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(r.cleanData(la(a,!1)),a.textContent=\"\");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return r.clone(this,a,b)})},html:function(a){return S(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if(\"string\"==typeof a&&!ya.test(a)&&!ka[(ia.exec(a)||[\"\",\"\"])[1].toLowerCase()]){a=r.htmlPrefilter(a);try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(r.cleanData(la(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return Ha(this,arguments,function(b){var c=this.parentNode;r.inArray(this,a)<0&&(r.cleanData(la(this)),c&&c.replaceChild(b,this))},a)}}),r.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(a,b){r.fn[a]=function(a){for(var c,d=[],e=r(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),r(e[g])[b](c),h.apply(d,c.get());return this.pushStack(d)}});var Ja=/^margin/,Ka=new RegExp(\"^(\"+$+\")(?!px)[a-z%]+$\",\"i\"),La=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)};!function(){function b(){if(i){i.style.cssText=\"box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%\",i.innerHTML=\"\",pa.appendChild(h);var b=a.getComputedStyle(i);c=\"1%\"!==b.top,g=\"2px\"===b.marginLeft,e=\"4px\"===b.width,i.style.marginRight=\"50%\",f=\"4px\"===b.marginRight,pa.removeChild(h),i=null}}var c,e,f,g,h=d.createElement(\"div\"),i=d.createElement(\"div\");i.style&&(i.style.backgroundClip=\"content-box\",i.cloneNode(!0).style.backgroundClip=\"\",o.clearCloneStyle=\"content-box\"===i.style.backgroundClip,h.style.cssText=\"border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute\",h.appendChild(i),r.extend(o,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return b(),e},pixelMarginRight:function(){return b(),f},reliableMarginLeft:function(){return b(),g}}))}();function Ma(a,b,c){var d,e,f,g,h=a.style;return c=c||La(a),c&&(g=c.getPropertyValue(b)||c[b],\"\"!==g||r.contains(a.ownerDocument,a)||(g=r.style(a,b)),!o.pixelMarginRight()&&Ka.test(g)&&Ja.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+\"\":g}function Na(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}var Oa=/^(none|table(?!-c[ea]).+)/,Pa={position:\"absolute\",visibility:\"hidden\",display:\"block\"},Qa={letterSpacing:\"0\",fontWeight:\"400\"},Ra=[\"Webkit\",\"Moz\",\"ms\"],Sa=d.createElement(\"div\").style;function Ta(a){if(a in Sa)return a;var b=a[0].toUpperCase()+a.slice(1),c=Ra.length;while(c--)if(a=Ra[c]+b,a in Sa)return a}function Ua(a,b,c){var d=_.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||\"px\"):b}function Va(a,b,c,d,e){for(var f=c===(d?\"border\":\"content\")?4:\"width\"===b?1:0,g=0;4>f;f+=2)\"margin\"===c&&(g+=r.css(a,c+aa[f],!0,e)),d?(\"content\"===c&&(g-=r.css(a,\"padding\"+aa[f],!0,e)),\"margin\"!==c&&(g-=r.css(a,\"border\"+aa[f]+\"Width\",!0,e))):(g+=r.css(a,\"padding\"+aa[f],!0,e),\"padding\"!==c&&(g+=r.css(a,\"border\"+aa[f]+\"Width\",!0,e)));return g}function Wa(a,b,c){var d,e=!0,f=La(a),g=\"border-box\"===r.css(a,\"boxSizing\",!1,f);if(a.getClientRects().length&&(d=a.getBoundingClientRect()[b]),0>=d||null==d){if(d=Ma(a,b,f),(0>d||null==d)&&(d=a.style[b]),Ka.test(d))return d;e=g&&(o.boxSizingReliable()||d===a.style[b]),d=parseFloat(d)||0}return d+Va(a,b,c||(g?\"border\":\"content\"),e,f)+\"px\"}r.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Ma(a,\"opacity\");return\"\"===c?\"1\":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{\"float\":\"cssFloat\"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=r.camelCase(b),i=a.style;return b=r.cssProps[h]||(r.cssProps[h]=Ta(h)||h),g=r.cssHooks[b]||r.cssHooks[h],void 0===c?g&&\"get\"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,\"string\"===f&&(e=_.exec(c))&&e[1]&&(c=da(a,b,e),f=\"number\"),null!=c&&c===c&&(\"number\"===f&&(c+=e&&e[3]||(r.cssNumber[h]?\"\":\"px\")),o.clearCloneStyle||\"\"!==c||0!==b.indexOf(\"background\")||(i[b]=\"inherit\"),g&&\"set\"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=r.camelCase(b);return b=r.cssProps[h]||(r.cssProps[h]=Ta(h)||h),g=r.cssHooks[b]||r.cssHooks[h],g&&\"get\"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Ma(a,b,d)),\"normal\"===e&&b in Qa&&(e=Qa[b]),\"\"===c||c?(f=parseFloat(e),c===!0||isFinite(f)?f||0:e):e}}),r.each([\"height\",\"width\"],function(a,b){r.cssHooks[b]={get:function(a,c,d){return c?!Oa.test(r.css(a,\"display\"))||a.getClientRects().length&&a.getBoundingClientRect().width?Wa(a,b,d):ca(a,Pa,function(){return Wa(a,b,d)}):void 0},set:function(a,c,d){var e,f=d&&La(a),g=d&&Va(a,b,d,\"border-box\"===r.css(a,\"boxSizing\",!1,f),f);return g&&(e=_.exec(c))&&\"px\"!==(e[3]||\"px\")&&(a.style[b]=c,c=r.css(a,b)),Ua(a,c,g)}}}),r.cssHooks.marginLeft=Na(o.reliableMarginLeft,function(a,b){return b?(parseFloat(Ma(a,\"marginLeft\"))||a.getBoundingClientRect().left-ca(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+\"px\":void 0}),r.each({margin:\"\",padding:\"\",border:\"Width\"},function(a,b){r.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f=\"string\"==typeof c?c.split(\" \"):[c];4>d;d++)e[a+aa[d]+b]=f[d]||f[d-2]||f[0];return e}},Ja.test(a)||(r.cssHooks[a+b].set=Ua)}),r.fn.extend({css:function(a,b){return S(this,function(a,b,c){var d,e,f={},g=0;if(r.isArray(b)){for(d=La(a),e=b.length;e>g;g++)f[b[g]]=r.css(a,b[g],!1,d);return f}return void 0!==c?r.style(a,b,c):r.css(a,b)},a,b,arguments.length>1)}});function Xa(a,b,c,d,e){return new Xa.prototype.init(a,b,c,d,e)}r.Tween=Xa,Xa.prototype={constructor:Xa,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||r.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(r.cssNumber[c]?\"\":\"px\")},cur:function(){var a=Xa.propHooks[this.prop];return a&&a.get?a.get(this):Xa.propHooks._default.get(this)},run:function(a){var b,c=Xa.propHooks[this.prop];return this.options.duration?this.pos=b=r.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Xa.propHooks._default.set(this),this}},Xa.prototype.init.prototype=Xa.prototype,Xa.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=r.css(a.elem,a.prop,\"\"),b&&\"auto\"!==b?b:0)},set:function(a){r.fx.step[a.prop]?r.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[r.cssProps[a.prop]]&&!r.cssHooks[a.prop]?a.elem[a.prop]=a.now:r.style(a.elem,a.prop,a.now+a.unit)}}},Xa.propHooks.scrollTop=Xa.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},r.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:\"swing\"},r.fx=Xa.prototype.init,r.fx.step={};var Ya,Za,$a=/^(?:toggle|show|hide)$/,_a=/queueHooks$/;function ab(){Za&&(a.requestAnimationFrame(ab),r.fx.tick())}function bb(){return a.setTimeout(function(){Ya=void 0}),Ya=r.now()}function cb(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=aa[d],e[\"margin\"+c]=e[\"padding\"+c]=a;return b&&(e.opacity=e.width=a),e}function db(a,b,c){for(var d,e=(gb.tweeners[b]||[]).concat(gb.tweeners[\"*\"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function eb(a,b,c){var d,e,f,g,h,i,j,k,l=\"width\"in b||\"height\"in b,m=this,n={},o=a.style,p=a.nodeType&&ba(a),q=V.get(a,\"fxshow\");c.queue||(g=r._queueHooks(a,\"fx\"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--,r.queue(a,\"fx\").length||g.empty.fire()})}));for(d in b)if(e=b[d],$a.test(e)){if(delete b[d],f=f||\"toggle\"===e,e===(p?\"hide\":\"show\")){if(\"show\"!==e||!q||void 0===q[d])continue;p=!0}n[d]=q&&q[d]||r.style(a,d)}if(i=!r.isEmptyObject(b),i||!r.isEmptyObject(n)){l&&1===a.nodeType&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=q&&q.display,null==j&&(j=V.get(a,\"display\")),k=r.css(a,\"display\"),\"none\"===k&&(j?k=j:(ga([a],!0),j=a.style.display||j,k=r.css(a,\"display\"),ga([a]))),(\"inline\"===k||\"inline-block\"===k&&null!=j)&&\"none\"===r.css(a,\"float\")&&(i||(m.done(function(){o.display=j}),null==j&&(k=o.display,j=\"none\"===k?\"\":k)),o.display=\"inline-block\")),c.overflow&&(o.overflow=\"hidden\",m.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),i=!1;for(d in n)i||(q?\"hidden\"in q&&(p=q.hidden):q=V.access(a,\"fxshow\",{display:j}),f&&(q.hidden=!p),p&&ga([a],!0),m.done(function(){p||ga([a]),V.remove(a,\"fxshow\");for(d in n)r.style(a,d,n[d])})),i=db(p?q[d]:0,d,m),d in q||(q[d]=i.start,p&&(i.end=i.start,i.start=0))}}function fb(a,b){var c,d,e,f,g;for(c in a)if(d=r.camelCase(c),e=b[d],f=a[c],r.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=r.cssHooks[d],g&&\"expand\"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function gb(a,b,c){var d,e,f=0,g=gb.prefilters.length,h=r.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Ya||bb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:r.extend({},b),opts:r.extend(!0,{specialEasing:{},easing:r.easing._default},c),originalProperties:b,originalOptions:c,startTime:Ya||bb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=r.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(fb(k,j.opts.specialEasing);g>f;f++)if(d=gb.prefilters[f].call(j,a,k,j.opts))return r.isFunction(d.stop)&&(r._queueHooks(j.elem,j.opts.queue).stop=r.proxy(d.stop,d)),d;return r.map(k,db,j),r.isFunction(j.opts.start)&&j.opts.start.call(a,j),r.fx.timer(r.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}r.Animation=r.extend(gb,{tweeners:{\"*\":[function(a,b){var c=this.createTween(a,b);return da(c.elem,a,_.exec(b),c),c}]},tweener:function(a,b){r.isFunction(a)?(b=a,a=[\"*\"]):a=a.match(K);for(var c,d=0,e=a.length;e>d;d++)c=a[d],gb.tweeners[c]=gb.tweeners[c]||[],gb.tweeners[c].unshift(b)},prefilters:[eb],prefilter:function(a,b){b?gb.prefilters.unshift(a):gb.prefilters.push(a)}}),r.speed=function(a,b,c){var e=a&&\"object\"==typeof a?r.extend({},a):{complete:c||!c&&b||r.isFunction(a)&&a,duration:a,easing:c&&b||b&&!r.isFunction(b)&&b};return r.fx.off||d.hidden?e.duration=0:e.duration=\"number\"==typeof e.duration?e.duration:e.duration in r.fx.speeds?r.fx.speeds[e.duration]:r.fx.speeds._default,null!=e.queue&&e.queue!==!0||(e.queue=\"fx\"),e.old=e.complete,e.complete=function(){r.isFunction(e.old)&&e.old.call(this),e.queue&&r.dequeue(this,e.queue)},e},r.fn.extend({fadeTo:function(a,b,c,d){return this.filter(ba).css(\"opacity\",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=r.isEmptyObject(a),f=r.speed(b,c,d),g=function(){var b=gb(this,r.extend({},a),f);(e||V.get(this,\"finish\"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return\"string\"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||\"fx\",[]),this.each(function(){var b=!0,e=null!=a&&a+\"queueHooks\",f=r.timers,g=V.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&_a.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||r.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||\"fx\"),this.each(function(){var b,c=V.get(this),d=c[a+\"queue\"],e=c[a+\"queueHooks\"],f=r.timers,g=d?d.length:0;for(c.finish=!0,r.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),r.each([\"toggle\",\"show\",\"hide\"],function(a,b){var c=r.fn[b];r.fn[b]=function(a,d,e){return null==a||\"boolean\"==typeof a?c.apply(this,arguments):this.animate(cb(b,!0),a,d,e)}}),r.each({slideDown:cb(\"show\"),slideUp:cb(\"hide\"),slideToggle:cb(\"toggle\"),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(a,b){r.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),r.timers=[],r.fx.tick=function(){var a,b=0,c=r.timers;for(Ya=r.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||r.fx.stop(),Ya=void 0},r.fx.timer=function(a){r.timers.push(a),a()?r.fx.start():r.timers.pop()},r.fx.interval=13,r.fx.start=function(){Za||(Za=a.requestAnimationFrame?a.requestAnimationFrame(ab):a.setInterval(r.fx.tick,r.fx.interval))},r.fx.stop=function(){a.cancelAnimationFrame?a.cancelAnimationFrame(Za):a.clearInterval(Za),Za=null},r.fx.speeds={slow:600,fast:200,_default:400},r.fn.delay=function(b,c){return b=r.fx?r.fx.speeds[b]||b:b,c=c||\"fx\",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement(\"input\"),b=d.createElement(\"select\"),c=b.appendChild(d.createElement(\"option\"));a.type=\"checkbox\",o.checkOn=\"\"!==a.value,o.optSelected=c.selected,a=d.createElement(\"input\"),a.value=\"t\",a.type=\"radio\",o.radioValue=\"t\"===a.value}();var hb,ib=r.expr.attrHandle;r.fn.extend({attr:function(a,b){return S(this,r.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){r.removeAttr(this,a)})}}),r.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return\"undefined\"==typeof a.getAttribute?r.prop(a,b,c):(1===f&&r.isXMLDoc(a)||(e=r.attrHooks[b.toLowerCase()]||(r.expr.match.bool.test(b)?hb:void 0)),void 0!==c?null===c?void r.removeAttr(a,b):e&&\"set\"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+\"\"),c):e&&\"get\"in e&&null!==(d=e.get(a,b))?d:(d=r.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!o.radioValue&&\"radio\"===b&&r.nodeName(a,\"input\")){var c=a.value;return a.setAttribute(\"type\",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d=0,e=b&&b.match(K);if(e&&1===a.nodeType)while(c=e[d++])a.removeAttribute(c);\r\n}}),hb={set:function(a,b,c){return b===!1?r.removeAttr(a,c):a.setAttribute(c,c),c}},r.each(r.expr.match.bool.source.match(/\\w+/g),function(a,b){var c=ib[b]||r.find.attr;ib[b]=function(a,b,d){var e,f,g=b.toLowerCase();return d||(f=ib[g],ib[g]=e,e=null!=c(a,b,d)?g:null,ib[g]=f),e}});var jb=/^(?:input|select|textarea|button)$/i,kb=/^(?:a|area)$/i;r.fn.extend({prop:function(a,b){return S(this,r.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[r.propFix[a]||a]})}}),r.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&r.isXMLDoc(a)||(b=r.propFix[b]||b,e=r.propHooks[b]),void 0!==c?e&&\"set\"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&\"get\"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=r.find.attr(a,\"tabindex\");return b?parseInt(b,10):jb.test(a.nodeName)||kb.test(a.nodeName)&&a.href?0:-1}}},propFix:{\"for\":\"htmlFor\",\"class\":\"className\"}}),o.optSelected||(r.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),r.each([\"tabIndex\",\"readOnly\",\"maxLength\",\"cellSpacing\",\"cellPadding\",\"rowSpan\",\"colSpan\",\"useMap\",\"frameBorder\",\"contentEditable\"],function(){r.propFix[this.toLowerCase()]=this});var lb=/[\\t\\r\\n\\f]/g;function mb(a){return a.getAttribute&&a.getAttribute(\"class\")||\"\"}r.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).addClass(a.call(this,b,mb(this)))});if(\"string\"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=mb(c),d=1===c.nodeType&&(\" \"+e+\" \").replace(lb,\" \")){g=0;while(f=b[g++])d.indexOf(\" \"+f+\" \")<0&&(d+=f+\" \");h=r.trim(d),e!==h&&c.setAttribute(\"class\",h)}}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).removeClass(a.call(this,b,mb(this)))});if(!arguments.length)return this.attr(\"class\",\"\");if(\"string\"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=mb(c),d=1===c.nodeType&&(\" \"+e+\" \").replace(lb,\" \")){g=0;while(f=b[g++])while(d.indexOf(\" \"+f+\" \")>-1)d=d.replace(\" \"+f+\" \",\" \");h=r.trim(d),e!==h&&c.setAttribute(\"class\",h)}}return this},toggleClass:function(a,b){var c=typeof a;return\"boolean\"==typeof b&&\"string\"===c?b?this.addClass(a):this.removeClass(a):r.isFunction(a)?this.each(function(c){r(this).toggleClass(a.call(this,c,mb(this),b),b)}):this.each(function(){var b,d,e,f;if(\"string\"===c){d=0,e=r(this),f=a.match(K)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==a&&\"boolean\"!==c||(b=mb(this),b&&V.set(this,\"__className__\",b),this.setAttribute&&this.setAttribute(\"class\",b||a===!1?\"\":V.get(this,\"__className__\")||\"\"))})},hasClass:function(a){var b,c,d=0;b=\" \"+a+\" \";while(c=this[d++])if(1===c.nodeType&&(\" \"+mb(c)+\" \").replace(lb,\" \").indexOf(b)>-1)return!0;return!1}});var nb=/\\r/g,ob=/[\\x20\\t\\r\\n\\f]+/g;r.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=r.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,r(this).val()):a,null==e?e=\"\":\"number\"==typeof e?e+=\"\":r.isArray(e)&&(e=r.map(e,function(a){return null==a?\"\":a+\"\"})),b=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],b&&\"set\"in b&&void 0!==b.set(this,e,\"value\")||(this.value=e))});if(e)return b=r.valHooks[e.type]||r.valHooks[e.nodeName.toLowerCase()],b&&\"get\"in b&&void 0!==(c=b.get(e,\"value\"))?c:(c=e.value,\"string\"==typeof c?c.replace(nb,\"\"):null==c?\"\":c)}}}),r.extend({valHooks:{option:{get:function(a){var b=r.find.attr(a,\"value\");return null!=b?b:r.trim(r.text(a)).replace(ob,\" \")}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f=\"select-one\"===a.type,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],(c.selected||i===e)&&!c.disabled&&(!c.parentNode.disabled||!r.nodeName(c.parentNode,\"optgroup\"))){if(b=r(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=r.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=r.inArray(r.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),r.each([\"radio\",\"checkbox\"],function(){r.valHooks[this]={set:function(a,b){return r.isArray(b)?a.checked=r.inArray(r(a).val(),b)>-1:void 0}},o.checkOn||(r.valHooks[this].get=function(a){return null===a.getAttribute(\"value\")?\"on\":a.value})});var pb=/^(?:focusinfocus|focusoutblur)$/;r.extend(r.event,{trigger:function(b,c,e,f){var g,h,i,j,k,m,n,o=[e||d],p=l.call(b,\"type\")?b.type:b,q=l.call(b,\"namespace\")?b.namespace.split(\".\"):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!pb.test(p+r.event.triggered)&&(p.indexOf(\".\")>-1&&(q=p.split(\".\"),p=q.shift(),q.sort()),k=p.indexOf(\":\")<0&&\"on\"+p,b=b[r.expando]?b:new r.Event(p,\"object\"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=q.join(\".\"),b.rnamespace=b.namespace?new RegExp(\"(^|\\\\.)\"+q.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:r.makeArray(c,[b]),n=r.event.special[p]||{},f||!n.trigger||n.trigger.apply(e,c)!==!1)){if(!f&&!n.noBubble&&!r.isWindow(e)){for(j=n.delegateType||p,pb.test(j+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),i=h;i===(e.ownerDocument||d)&&o.push(i.defaultView||i.parentWindow||a)}g=0;while((h=o[g++])&&!b.isPropagationStopped())b.type=g>1?j:n.bindType||p,m=(V.get(h,\"events\")||{})[b.type]&&V.get(h,\"handle\"),m&&m.apply(h,c),m=k&&h[k],m&&m.apply&&T(h)&&(b.result=m.apply(h,c),b.result===!1&&b.preventDefault());return b.type=p,f||b.isDefaultPrevented()||n._default&&n._default.apply(o.pop(),c)!==!1||!T(e)||k&&r.isFunction(e[p])&&!r.isWindow(e)&&(i=e[k],i&&(e[k]=null),r.event.triggered=p,e[p](),r.event.triggered=void 0,i&&(e[k]=i)),b.result}},simulate:function(a,b,c){var d=r.extend(new r.Event,c,{type:a,isSimulated:!0});r.event.trigger(d,null,b)}}),r.fn.extend({trigger:function(a,b){return this.each(function(){r.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?r.event.trigger(a,b,c,!0):void 0}}),r.each(\"blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu\".split(\" \"),function(a,b){r.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),r.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),o.focusin=\"onfocusin\"in a,o.focusin||r.each({focus:\"focusin\",blur:\"focusout\"},function(a,b){var c=function(a){r.event.simulate(b,a.target,r.event.fix(a))};r.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=V.access(d,b);e||d.addEventListener(a,c,!0),V.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=V.access(d,b)-1;e?V.access(d,b,e):(d.removeEventListener(a,c,!0),V.remove(d,b))}}});var qb=a.location,rb=r.now(),sb=/\\?/;r.parseXML=function(b){var c;if(!b||\"string\"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,\"text/xml\")}catch(d){c=void 0}return c&&!c.getElementsByTagName(\"parsererror\").length||r.error(\"Invalid XML: \"+b),c};var tb=/\\[\\]$/,ub=/\\r?\\n/g,vb=/^(?:submit|button|image|reset|file)$/i,wb=/^(?:input|select|textarea|keygen)/i;function xb(a,b,c,d){var e;if(r.isArray(b))r.each(b,function(b,e){c||tb.test(a)?d(a,e):xb(a+\"[\"+(\"object\"==typeof e&&null!=e?b:\"\")+\"]\",e,c,d)});else if(c||\"object\"!==r.type(b))d(a,b);else for(e in b)xb(a+\"[\"+e+\"]\",b[e],c,d)}r.param=function(a,b){var c,d=[],e=function(a,b){var c=r.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+\"=\"+encodeURIComponent(null==c?\"\":c)};if(r.isArray(a)||a.jquery&&!r.isPlainObject(a))r.each(a,function(){e(this.name,this.value)});else for(c in a)xb(c,a[c],b,e);return d.join(\"&\")},r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=r.prop(this,\"elements\");return a?r.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!r(this).is(\":disabled\")&&wb.test(this.nodeName)&&!vb.test(a)&&(this.checked||!ha.test(a))}).map(function(a,b){var c=r(this).val();return null==c?null:r.isArray(c)?r.map(c,function(a){return{name:b.name,value:a.replace(ub,\"\\r\\n\")}}):{name:b.name,value:c.replace(ub,\"\\r\\n\")}}).get()}});var yb=/%20/g,zb=/#.*$/,Ab=/([?&])_=[^&]*/,Bb=/^(.*?):[ \\t]*([^\\r\\n]*)$/gm,Cb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Db=/^(?:GET|HEAD)$/,Eb=/^\\/\\//,Fb={},Gb={},Hb=\"*/\".concat(\"*\"),Ib=d.createElement(\"a\");Ib.href=qb.href;function Jb(a){return function(b,c){\"string\"!=typeof b&&(c=b,b=\"*\");var d,e=0,f=b.toLowerCase().match(K)||[];if(r.isFunction(c))while(d=f[e++])\"+\"===d[0]?(d=d.slice(1)||\"*\",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Kb(a,b,c,d){var e={},f=a===Gb;function g(h){var i;return e[h]=!0,r.each(a[h]||[],function(a,h){var j=h(b,c,d);return\"string\"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e[\"*\"]&&g(\"*\")}function Lb(a,b){var c,d,e=r.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&r.extend(!0,a,d),a}function Mb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while(\"*\"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader(\"Content-Type\"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+\" \"+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Nb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if(\"*\"===f)f=i;else if(\"*\"!==i&&i!==f){if(g=j[i+\" \"+f]||j[\"* \"+f],!g)for(e in j)if(h=e.split(\" \"),h[1]===f&&(g=j[i+\" \"+h[0]]||j[\"* \"+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a[\"throws\"])b=g(b);else try{b=g(b)}catch(l){return{state:\"parsererror\",error:g?l:\"No conversion from \"+i+\" to \"+f}}}return{state:\"success\",data:b}}r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qb.href,type:\"GET\",isLocal:Cb.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",accepts:{\"*\":Hb,text:\"text/plain\",html:\"text/html\",xml:\"application/xml, text/xml\",json:\"application/json, text/javascript\"},contents:{xml:/\\bxml\\b/,html:/\\bhtml/,json:/\\bjson\\b/},responseFields:{xml:\"responseXML\",text:\"responseText\",json:\"responseJSON\"},converters:{\"* text\":String,\"text html\":!0,\"text json\":JSON.parse,\"text xml\":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Lb(Lb(a,r.ajaxSettings),b):Lb(r.ajaxSettings,a)},ajaxPrefilter:Jb(Fb),ajaxTransport:Jb(Gb),ajax:function(b,c){\"object\"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m,n,o=r.ajaxSetup({},c),p=o.context||o,q=o.context&&(p.nodeType||p.jquery)?r(p):r.event,s=r.Deferred(),t=r.Callbacks(\"once memory\"),u=o.statusCode||{},v={},w={},x=\"canceled\",y={readyState:0,getResponseHeader:function(a){var b;if(k){if(!h){h={};while(b=Bb.exec(g))h[b[1].toLowerCase()]=b[2]}b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(a,b){return null==k&&(a=w[a.toLowerCase()]=w[a.toLowerCase()]||a,v[a]=b),this},overrideMimeType:function(a){return null==k&&(o.mimeType=a),this},statusCode:function(a){var b;if(a)if(k)y.always(a[y.status]);else for(b in a)u[b]=[u[b],a[b]];return this},abort:function(a){var b=a||x;return e&&e.abort(b),A(0,b),this}};if(s.promise(y),o.url=((b||o.url||qb.href)+\"\").replace(Eb,qb.protocol+\"//\"),o.type=c.method||c.type||o.method||o.type,o.dataTypes=(o.dataType||\"*\").toLowerCase().match(K)||[\"\"],null==o.crossDomain){j=d.createElement(\"a\");try{j.href=o.url,j.href=j.href,o.crossDomain=Ib.protocol+\"//\"+Ib.host!=j.protocol+\"//\"+j.host}catch(z){o.crossDomain=!0}}if(o.data&&o.processData&&\"string\"!=typeof o.data&&(o.data=r.param(o.data,o.traditional)),Kb(Fb,o,c,y),k)return y;l=r.event&&o.global,l&&0===r.active++&&r.event.trigger(\"ajaxStart\"),o.type=o.type.toUpperCase(),o.hasContent=!Db.test(o.type),f=o.url.replace(zb,\"\"),o.hasContent?o.data&&o.processData&&0===(o.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&(o.data=o.data.replace(yb,\"+\")):(n=o.url.slice(f.length),o.data&&(f+=(sb.test(f)?\"&\":\"?\")+o.data,delete o.data),o.cache===!1&&(f=f.replace(Ab,\"\"),n=(sb.test(f)?\"&\":\"?\")+\"_=\"+rb++ +n),o.url=f+n),o.ifModified&&(r.lastModified[f]&&y.setRequestHeader(\"If-Modified-Since\",r.lastModified[f]),r.etag[f]&&y.setRequestHeader(\"If-None-Match\",r.etag[f])),(o.data&&o.hasContent&&o.contentType!==!1||c.contentType)&&y.setRequestHeader(\"Content-Type\",o.contentType),y.setRequestHeader(\"Accept\",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+(\"*\"!==o.dataTypes[0]?\", \"+Hb+\"; q=0.01\":\"\"):o.accepts[\"*\"]);for(m in o.headers)y.setRequestHeader(m,o.headers[m]);if(o.beforeSend&&(o.beforeSend.call(p,y,o)===!1||k))return y.abort();if(x=\"abort\",t.add(o.complete),y.done(o.success),y.fail(o.error),e=Kb(Gb,o,c,y)){if(y.readyState=1,l&&q.trigger(\"ajaxSend\",[y,o]),k)return y;o.async&&o.timeout>0&&(i=a.setTimeout(function(){y.abort(\"timeout\")},o.timeout));try{k=!1,e.send(v,A)}catch(z){if(k)throw z;A(-1,z)}}else A(-1,\"No Transport\");function A(b,c,d,h){var j,m,n,v,w,x=c;k||(k=!0,i&&a.clearTimeout(i),e=void 0,g=h||\"\",y.readyState=b>0?4:0,j=b>=200&&300>b||304===b,d&&(v=Mb(o,y,d)),v=Nb(o,v,y,j),j?(o.ifModified&&(w=y.getResponseHeader(\"Last-Modified\"),w&&(r.lastModified[f]=w),w=y.getResponseHeader(\"etag\"),w&&(r.etag[f]=w)),204===b||\"HEAD\"===o.type?x=\"nocontent\":304===b?x=\"notmodified\":(x=v.state,m=v.data,n=v.error,j=!n)):(n=x,!b&&x||(x=\"error\",0>b&&(b=0))),y.status=b,y.statusText=(c||x)+\"\",j?s.resolveWith(p,[m,x,y]):s.rejectWith(p,[y,x,n]),y.statusCode(u),u=void 0,l&&q.trigger(j?\"ajaxSuccess\":\"ajaxError\",[y,o,j?m:n]),t.fireWith(p,[y,x]),l&&(q.trigger(\"ajaxComplete\",[y,o]),--r.active||r.event.trigger(\"ajaxStop\")))}return y},getJSON:function(a,b,c){return r.get(a,b,c,\"json\")},getScript:function(a,b){return r.get(a,void 0,b,\"script\")}}),r.each([\"get\",\"post\"],function(a,b){r[b]=function(a,c,d,e){return r.isFunction(c)&&(e=e||d,d=c,c=void 0),r.ajax(r.extend({url:a,type:b,dataType:e,data:c,success:d},r.isPlainObject(a)&&a))}}),r._evalUrl=function(a){return r.ajax({url:a,type:\"GET\",dataType:\"script\",cache:!0,async:!1,global:!1,\"throws\":!0})},r.fn.extend({wrapAll:function(a){var b;return this[0]&&(r.isFunction(a)&&(a=a.call(this[0])),b=r(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return r.isFunction(a)?this.each(function(b){r(this).wrapInner(a.call(this,b))}):this.each(function(){var b=r(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=r.isFunction(a);return this.each(function(c){r(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(a){return this.parent(a).not(\"body\").each(function(){r(this).replaceWith(this.childNodes)}),this}}),r.expr.pseudos.hidden=function(a){return!r.expr.pseudos.visible(a)},r.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},r.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Ob={0:200,1223:204},Pb=r.ajaxSettings.xhr();o.cors=!!Pb&&\"withCredentials\"in Pb,o.ajax=Pb=!!Pb,r.ajaxTransport(function(b){var c,d;return o.cors||Pb&&!b.crossDomain?{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e[\"X-Requested-With\"]||(e[\"X-Requested-With\"]=\"XMLHttpRequest\");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,\"abort\"===a?h.abort():\"error\"===a?\"number\"!=typeof h.status?f(0,\"error\"):f(h.status,h.statusText):f(Ob[h.status]||h.status,h.statusText,\"text\"!==(h.responseType||\"text\")||\"string\"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c(\"error\"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c(\"abort\");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}:void 0}),r.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),r.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/\\b(?:java|ecma)script\\b/},converters:{\"text script\":function(a){return r.globalEval(a),a}}}),r.ajaxPrefilter(\"script\",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type=\"GET\")}),r.ajaxTransport(\"script\",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=r(\"<script>\").prop({charset:a.scriptCharset,src:a.url}).on(\"load error\",c=function(a){b.remove(),c=null,a&&f(\"error\"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Qb=[],Rb=/(=)\\?(?=&|$)|\\?\\?/;r.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){var a=Qb.pop()||r.expando+\"_\"+rb++;return this[a]=!0,a}}),r.ajaxPrefilter(\"json jsonp\",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Rb.test(b.url)?\"url\":\"string\"==typeof b.data&&0===(b.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&Rb.test(b.data)&&\"data\");return h||\"jsonp\"===b.dataTypes[0]?(e=b.jsonpCallback=r.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Rb,\"$1\"+e):b.jsonp!==!1&&(b.url+=(sb.test(b.url)?\"&\":\"?\")+b.jsonp+\"=\"+e),b.converters[\"script json\"]=function(){return g||r.error(e+\" was not called\"),g[0]},b.dataTypes[0]=\"json\",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?r(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Qb.push(e)),g&&r.isFunction(f)&&f(g[0]),g=f=void 0}),\"script\"):void 0}),o.createHTMLDocument=function(){var a=d.implementation.createHTMLDocument(\"\").body;return a.innerHTML=\"<form></form><form></form>\",2===a.childNodes.length}(),r.parseHTML=function(a,b,c){if(\"string\"!=typeof a)return[];\"boolean\"==typeof b&&(c=b,b=!1);var e,f,g;return b||(o.createHTMLDocument?(b=d.implementation.createHTMLDocument(\"\"),e=b.createElement(\"base\"),e.href=d.location.href,b.head.appendChild(e)):b=d),f=B.exec(a),g=!c&&[],f?[b.createElement(f[1])]:(f=oa([a],b,g),g&&g.length&&r(g).remove(),r.merge([],f.childNodes))},r.fn.load=function(a,b,c){var d,e,f,g=this,h=a.indexOf(\" \");return h>-1&&(d=r.trim(a.slice(h)),a=a.slice(0,h)),r.isFunction(b)?(c=b,b=void 0):b&&\"object\"==typeof b&&(e=\"POST\"),g.length>0&&r.ajax({url:a,type:e||\"GET\",dataType:\"html\",data:b}).done(function(a){f=arguments,g.html(d?r(\"<div>\").append(r.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},r.each([\"ajaxStart\",\"ajaxStop\",\"ajaxComplete\",\"ajaxError\",\"ajaxSuccess\",\"ajaxSend\"],function(a,b){r.fn[b]=function(a){return this.on(b,a)}}),r.expr.pseudos.animated=function(a){return r.grep(r.timers,function(b){return a===b.elem}).length};function Sb(a){return r.isWindow(a)?a:9===a.nodeType&&a.defaultView}r.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=r.css(a,\"position\"),l=r(a),m={};\"static\"===k&&(a.style.position=\"relative\"),h=l.offset(),f=r.css(a,\"top\"),i=r.css(a,\"left\"),j=(\"absolute\"===k||\"fixed\"===k)&&(f+i).indexOf(\"auto\")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),r.isFunction(b)&&(b=b.call(a,c,r.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),\"using\"in b?b.using.call(a,m):l.css(m)}},r.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){r.offset.setOffset(this,a,b)});var b,c,d,e,f=this[0];if(f)return f.getClientRects().length?(d=f.getBoundingClientRect(),d.width||d.height?(e=f.ownerDocument,c=Sb(e),b=e.documentElement,{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}):d):{top:0,left:0}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return\"fixed\"===r.css(c,\"position\")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),r.nodeName(a[0],\"html\")||(d=a.offset()),d={top:d.top+r.css(a[0],\"borderTopWidth\",!0),left:d.left+r.css(a[0],\"borderLeftWidth\",!0)}),{top:b.top-d.top-r.css(c,\"marginTop\",!0),left:b.left-d.left-r.css(c,\"marginLeft\",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent;while(a&&\"static\"===r.css(a,\"position\"))a=a.offsetParent;return a||pa})}}),r.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(a,b){var c=\"pageYOffset\"===b;r.fn[a]=function(d){return S(this,function(a,d,e){var f=Sb(a);return void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),r.each([\"top\",\"left\"],function(a,b){r.cssHooks[b]=Na(o.pixelPosition,function(a,c){return c?(c=Ma(a,b),Ka.test(c)?r(a).position()[b]+\"px\":c):void 0})}),r.each({Height:\"height\",Width:\"width\"},function(a,b){r.each({padding:\"inner\"+a,content:b,\"\":\"outer\"+a},function(c,d){r.fn[d]=function(e,f){var g=arguments.length&&(c||\"boolean\"!=typeof e),h=c||(e===!0||f===!0?\"margin\":\"border\");return S(this,function(b,c,e){var f;return r.isWindow(b)?0===d.indexOf(\"outer\")?b[\"inner\"+a]:b.document.documentElement[\"client\"+a]:9===b.nodeType?(f=b.documentElement,Math.max(b.body[\"scroll\"+a],f[\"scroll\"+a],b.body[\"offset\"+a],f[\"offset\"+a],f[\"client\"+a])):void 0===e?r.css(b,c,h):r.style(b,c,e,h)},b,g?e:void 0,g)}})}),r.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,\"**\"):this.off(b,a||\"**\",c)}}),r.parseJSON=JSON.parse,\"function\"==typeof define&&define.amd&&define(\"jquery\",[],function(){return r});var Tb=a.jQuery,Ub=a.$;return r.noConflict=function(b){return a.$===r&&(a.$=Ub),b&&a.jQuery===r&&(a.jQuery=Tb),r},b||(a.jQuery=a.$=r),r});\r\n\n",
    "/**\r\n *  Init\r\n */\r\n\r\ndefine('app/init',['jquery'], function($) {\r\n\r\n    'use strict';\r\n\r\n    var Config = {\r\n        path: {\r\n            img: 'public/img/',                                     // path for images\r\n            // user API\r\n            getCaptcha: 'api/user/getCaptcha',                      // ajax URL - get captcha image\r\n            getServerStatus: 'api/user/getEveServerStatus',         // ajax URL - get EVE-Online server status\r\n            getCookieCharacterData: 'api/user/getCookieCharacter',  // ajax URL - get character data from cookie\r\n            logIn: 'api/user/logIn',                                // ajax URL - login\r\n            logout: 'api/user/logout',                              // ajax URL - logout\r\n            deleteLog: 'api/user/deleteLog',                        // ajax URL - delete character log\r\n            saveUserConfig: 'api/user/saveAccount',                 // ajax URL - saves/update user account\r\n            deleteAccount: 'api/user/deleteAccount',                // ajax URL - delete Account data\r\n            // access API\r\n            searchAccess: 'api/access/search',                      // ajax URL - search user/corporation/ally by name\r\n            // main config/map ping API\r\n            initMap: 'api/map/init',                                // ajax URL - get static data\r\n            updateMapData: 'api/map/updateData',                    // ajax URL - main map update trigger\r\n            updateUserData: 'api/map/updateUserData',               // ajax URL - main map user data trigger\r\n            // map API\r\n            saveMap: 'api/map/save',                                // ajax URL - save/update map\r\n            deleteMap: 'api/map/delete',                            // ajax URL - delete map\r\n            importMap: 'api/map/import',                            // ajax URL - import map\r\n            // system API\r\n            searchSystem: 'api/system/search',                      // ajax URL - search system by name\r\n            saveSystem: 'api/system/save',                          // ajax URL - saves system to map\r\n            deleteSystem: 'api/system/delete',                      // ajax URL - delete system from map\r\n            getSystemGraphData: 'api/system/graphData',             // ajax URL - get all system graph data\r\n            getConstellationData: 'api/system/constellationData',   // ajax URL - get system constellation data\r\n            setDestination: 'api/system/setDestination',            // ajax URL - set destination\r\n            // connection API\r\n            saveConnection: 'api/connection/save',                  // ajax URL - save new connection to map\r\n            deleteConnection: 'api/connection/delete',              // ajax URL - delete connection from map\r\n            // signature API\r\n            getSignatures: 'api/signature/getAll',                  // ajax URL - get all signature data for system\r\n            saveSignatureData: 'api/signature/save',                // ajax URL - save signature data for system\r\n            deleteSignatureData: 'api/signature/delete',            // ajax URL - delete signature data for system\r\n            // route API\r\n            searchRoute: 'api/route/search',                        // ajax URL - search system routes\r\n            // stats API\r\n            getStatisticsData: 'api/statistic/getData',             // ajax URL - get statistics data (activity log)\r\n            // GitHub API\r\n            gitHubReleases: 'api/github/releases'                   // ajax URL - get release info from GitHub\r\n        },\r\n        url: {\r\n            ccpImageServer: 'https://image.eveonline.com/',         // CCP image Server\r\n            zKillboard: 'https://zkillboard.com/api/'               // killboard api\r\n        },\r\n        breakpoints: [\r\n            { name: 'desktop', width: Infinity },\r\n            { name: 'tablet',  width: 1200 },\r\n            { name: 'fablet',  width: 780 },\r\n            { name: 'phone',   width: 480 }\r\n        ],\r\n        animationSpeed: {\r\n            splashOverlay: 300,                                     // \"splash\" loading overlay\r\n            headerLink: 100,                                        // links in head bar\r\n            mapOverlay: 200,                                        // show/hide duration for map overlays\r\n            mapMoveSystem: 300,                                     // system position has changed animation\r\n            mapDeleteSystem: 200,                                   // remove system from map\r\n            mapModule: 200,                                         // show/hide of an map module\r\n            dialogEvents: 180                                       // dialog events /slide/show/...\r\n        },\r\n        mapIcons: [                                                 // map tab-icons\r\n            {\r\n                class: 'fa-desktop',\r\n                label: 'desktop',\r\n                unicode: '&#xf108;'\r\n            },{\r\n                class: 'fa-bookmark',\r\n                label: 'bookmark',\r\n                unicode: '&#xf02e;'\r\n            },{\r\n                class: 'fa-cube',\r\n                label: 'cube',\r\n                unicode: '&#xf1b2;'\r\n            },{\r\n                class: 'fa-plane',\r\n                label: 'plane',\r\n                unicode: '&#xf072;'\r\n            },{\r\n                class: 'fa-globe',\r\n                label: 'globe',\r\n                unicode: '&#xf0ac;'\r\n            },{\r\n                class: 'fa-rocket',\r\n                label: 'rocket',\r\n                unicode: '&#xf135;'\r\n            },{\r\n                class: 'fa-life-ring',\r\n                label: 'life ring',\r\n                unicode: '&#xf1cd;'\r\n            },{\r\n                class: 'fa-heart',\r\n                label: 'heart',\r\n                unicode: '&#xf004;'\r\n            }\r\n        ],\r\n\r\n        classes: {\r\n            // log types\r\n            logTypes: {\r\n                info: {\r\n                    class: 'pf-log-info',\r\n                    label: 'info'\r\n                },\r\n                warning: {\r\n                    class: 'pf-log-warning',\r\n                    label: 'warning'\r\n                },\r\n                error: {\r\n                    class: 'pf-log-error',\r\n                    label: 'error'\r\n                }\r\n            },\r\n            // system effects\r\n            systemEffects: {\r\n\r\n                effect: {\r\n                    class: 'pf-system-effect',\r\n                    name: 'no effect'\r\n                },\r\n                magnetar: {\r\n                    class: 'pf-system-effect-magnetar',\r\n                    name: 'magnetar'\r\n                },\r\n                redGiant: {\r\n                    class: 'pf-system-effect-redgiant',\r\n                    name: 'red giant'\r\n                },\r\n                pulsar: {\r\n                    class: 'pf-system-effect-pulsar',\r\n                    name: 'pulsar'\r\n                },\r\n                wolfRayet: {\r\n                    class: 'pf-system-effect-wolfrayet',\r\n                    name: 'wolf rayet'\r\n                },\r\n                cataclysmic: {\r\n                    class: 'pf-system-effect-cataclysmic',\r\n                    name: 'cataclysmic'\r\n                },\r\n                blackHole: {\r\n                    class: 'pf-system-effect-blackhole',\r\n                    name: 'black hole'\r\n                }\r\n            },\r\n            // system security\r\n            systemSecurity: {\r\n                security: {\r\n                    class: 'pf-system-sec'\r\n                },\r\n                'SH': {\r\n                    class: 'pf-system-sec-unknown'\r\n                },\r\n                'H': {\r\n                     class: 'pf-system-sec-highSec'\r\n                },\r\n                'L': {\r\n                    class: 'pf-system-sec-lowSec'\r\n                },\r\n                '0.0': {\r\n                    class: 'pf-system-sec-nullSec'\r\n                },\r\n                'C6': {\r\n                    class: 'pf-system-sec-high'\r\n                },\r\n                'C5': {\r\n                    class: 'pf-system-sec-high'\r\n                },\r\n                'C4': {\r\n                    class: 'pf-system-sec-mid'\r\n                },\r\n                'C3': {\r\n                    class: 'pf-system-sec-mid'\r\n                },\r\n                'C2': {\r\n                    class: 'pf-system-sec-low'\r\n                },\r\n                'C1': {\r\n                    class: 'pf-system-sec-low'\r\n                }\r\n            },\r\n            // true sec\r\n            trueSec: {\r\n                '0.0': {\r\n                    class: 'pf-system-security-0-0'\r\n                },\r\n                '0.1': {\r\n                    class: 'pf-system-security-0-1'\r\n                },\r\n                '0.2': {\r\n                    class: 'pf-system-security-0-2'\r\n                },\r\n                '0.3': {\r\n                    class: 'pf-system-security-0-3'\r\n                },\r\n                '0.4': {\r\n                    class: 'pf-system-security-0-4'\r\n                },\r\n                '0.5': {\r\n                    class: 'pf-system-security-0-5'\r\n                },\r\n                '0.6': {\r\n                    class: 'pf-system-security-0-6'\r\n                },\r\n                '0.7': {\r\n                    class: 'pf-system-security-0-7'\r\n                },\r\n                '0.8': {\r\n                    class: 'pf-system-security-0-8'\r\n                },\r\n                '0.9': {\r\n                    class: 'pf-system-security-0-9'\r\n                },\r\n                '1.0': {\r\n                    class: 'pf-system-security-1-0'\r\n                }\r\n            },\r\n            // system info\r\n            systemInfo: {\r\n                rally: {\r\n                    class: 'pf-system-info-rally',\r\n                    label: 'rally point'\r\n                }\r\n            },\r\n            // easy-pie-charts\r\n            pieChart: {\r\n                class: 'pf-pie-chart',                              // class for all pie charts\r\n                pieChartMapCounterClass: 'pf-pie-chart-map-timer'   // class for timer chart\r\n            }\r\n        },\r\n        // map scopes\r\n        defaultMapScope: 'wh',                                      // default scope for connection\r\n        // map connection types\r\n        connectionTypes: {\r\n            jumpbridge: {\r\n                cssClass: 'pf-map-connection-jumpbridge',\r\n                paintStyle: {\r\n                    dashstyle: '4 2 1 2'\r\n                }\r\n            },\r\n            stargate: {\r\n                cssClass: 'pf-map-connection-stargate',\r\n                paintStyle: {\r\n                    dashstyle: '0' // solid line\r\n                }\r\n            },\r\n            wh_eol: {\r\n                cssClass: 'pf-map-connection-wh-eol',\r\n                paintStyle: {\r\n                    dashstyle: '0' // solid line\r\n                }\r\n            },\r\n            wh_fresh: {\r\n                cssClass: 'pf-map-connection-wh-fresh',\r\n                paintStyle: {\r\n                    dashstyle: '0' // solid line\r\n                }\r\n            },\r\n            wh_reduced: {\r\n                cssClass: 'pf-map-connection-wh-reduced',\r\n                paintStyle: {\r\n                    dashstyle: '0' // solid line\r\n                }\r\n            },\r\n            wh_critical: {\r\n                cssClass: 'pf-map-connection-wh-critical',\r\n                paintStyle: {\r\n                    dashstyle: '0' // solid line\r\n                }\r\n            },\r\n            frigate: {\r\n                cssClass: 'pf-map-connection-frig',\r\n                paintStyle: {\r\n                    dashstyle: '0.99'\r\n                },\r\n                overlays:[\r\n                    ['Label',\r\n                        {\r\n                            label: 'frig',\r\n                            cssClass: ['pf-map-connection-overlay', 'frig'].join(' '),\r\n                            location: 0.6\r\n                        }]\r\n                ]\r\n            },\r\n            preserve_mass: {\r\n                cssClass: 'pf-map-connection-preserve-mass',\r\n                overlays:[\r\n                    ['Label',\r\n                        {\r\n                            label: '<i class=\"fa fa-fw fa-warning\"></i>&nbsp;save mass',\r\n                            cssClass: ['pf-map-connection-overlay', 'mass'].join(' '),\r\n                            location: 0.6\r\n                        }]\r\n                ]\r\n            }\r\n        },\r\n        // signature groups\r\n        signatureGroups: {\r\n            1: {\r\n                name: 'combat site', //*\r\n                label: 'Combat'\r\n            },\r\n            2: {\r\n                name: 'relic site', //*\r\n                label: 'Relic'\r\n            },\r\n            3: {\r\n                name: 'data site',\r\n                label: 'Data'\r\n            },\r\n            4: {\r\n                name: 'gas site',\r\n                label: 'Gas'\r\n            },\r\n            5: {\r\n                name: 'wormhole',\r\n                label: 'Wormhole'\r\n            },\r\n            6: {\r\n                name: 'ore site',\r\n                label: 'Ore'\r\n            },\r\n            7: {\r\n                name: 'ghost',\r\n                label: 'Ghost'\r\n            }\r\n        },\r\n        // frigate wormholes\r\n        frigateWormholes: {\r\n            1: {    // C1\r\n                1: 'E004 - C1',\r\n                2: 'L005 - C2',\r\n                3: 'Z006 - C3',\r\n                4: 'M001 - C4',\r\n                5: 'C008 - C5',\r\n                6: 'G008 - C6',\r\n                7: 'Q003 - 0.0',\r\n                8: 'A009 - (shattered)'\r\n            },\r\n            2: {    // C2\r\n                1: 'E004 - C1',\r\n                2: 'L005 - C2',\r\n                3: 'Z006 - C3',\r\n                4: 'M001 - C4',\r\n                5: 'C008 - C5',\r\n                6: 'G008 - C6',\r\n                7: 'Q003 - 0.0',\r\n                8: 'A009 - (shattered)'\r\n            },\r\n            3: {    // C3\r\n                1: 'E004 - C1',\r\n                2: 'L005 - C2',\r\n                3: 'Z006 - C3',\r\n                4: 'M001 - C4',\r\n                5: 'C008 - C5',\r\n                6: 'G008 - C6',\r\n                7: 'Q003 - 0.0',\r\n                8: 'A009 - (shattered)'\r\n            },\r\n            4: {    // C4\r\n                1: 'E004 - C1',\r\n                2: 'L005 - C2',\r\n                3: 'Z006 - C3',\r\n                4: 'M001 - C4',\r\n                5: 'C008 - C5',\r\n                6: 'G008 - C6',\r\n                7: 'Q003 - 0.0',\r\n                8: 'A009 - (shattered)'\r\n\t    },\r\n            5: {    // C5\r\n                1: 'E004 - C1',\r\n                2: 'L005 - C2',\r\n                3: 'Z006 - C3',\r\n                4: 'M001 - C4',\r\n                5: 'C008 - C5',\r\n                6: 'G008 - C6',\r\n                7: 'Q003 - 0.0',\r\n                8: 'A009 - (shattered)'\r\n            },\r\n            6: {    // C6\r\n                1: 'E004 - C1',\r\n                2: 'L005 - C2',\r\n                3: 'Z006 - C3',\r\n                4: 'M001 - C4',\r\n                5: 'C008 - C5',\r\n                6: 'G008 - C6',\r\n                7: 'Q003 - 0.0',\r\n                8: 'A009 - (shattered)'\r\n            },\r\n            13: {   // Shattered Wormholes (some of them are static)\r\n                1: 'E004 - C1',\r\n                2: 'L005 - C2',\r\n                3: 'Z006 - C3',\r\n                4: 'M001 - C4',\r\n                5: 'C008 - C5',\r\n                6: 'G008 - C6',\r\n                7: 'Q003 - 0.0',\r\n                8: 'A009 - (shattered)'\r\n            }\r\n        },\r\n        // incoming wormholes\r\n        incomingWormholes: {\r\n            1: 'K162 - C1/2/3 (unknown)',\r\n            2: 'K162 - C4/5 (dangerous)',\r\n            3: 'K162 - C6 (deadly)',\r\n            4: 'K162 - HS',\r\n            5: 'K162 - LS',\r\n            6: 'K162 - 0.0',\r\n            7: 'K162 - Thera'\r\n        }\r\n\r\n    };\r\n\r\n    return Config;\r\n});\r\n\n",
    "/**\r\n * Created by exodus4d on 06.07.2015.\r\n * static system effects\r\n */\r\n\r\n\r\ndefine('config/system_effect',[], function() {\r\n\r\n    'use strict';\r\n\r\n    // system effects\r\n    var systemEffects = {\r\n            wh: {\r\n                magnetar: {\r\n                    1: [\r\n                        {\r\n                            effect: 'Damage',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Missile explosion radius',\r\n                            value: '+15%'\r\n                        },{\r\n                            effect: 'Drone Tracking',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Targeting Range',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Tracking Speed',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Target Painter Strength',\r\n                            value: '-15%'\r\n                        }\r\n                    ],\r\n                        2: [\r\n                        {\r\n                            effect: 'Damage',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Missile explosion radius',\r\n                            value: '+22%'\r\n                        },{\r\n                            effect: 'Drone Tracking',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Targeting Range',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Tracking Speed',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Target Painter Strength',\r\n                            value: '-22%'\r\n                        }\r\n                    ],\r\n                        3: [\r\n                        {\r\n                            effect: 'Damage',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Missile explosion radius',\r\n                            value: '+29%'\r\n                        },{\r\n                            effect: 'Drone Tracking',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Targeting Range',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Tracking Speed',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Target Painter Strength',\r\n                            value: '-29%'\r\n                        }\r\n                    ],\r\n                        4: [\r\n                        {\r\n                            effect: 'Damage',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Missile explosion radius',\r\n                            value: '+36%'\r\n                        },{\r\n                            effect: 'Drone Tracking',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Targeting Range',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Tracking Speed',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Target Painter Strength',\r\n                            value: '-36%'\r\n                        }\r\n                    ],\r\n                        5: [\r\n                        {\r\n                            effect: 'Damage',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Missile explosion radius',\r\n                            value: '+43%'\r\n                        },{\r\n                            effect: 'Drone Tracking',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Targeting Range',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Tracking Speed',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Target Painter Strength',\r\n                            value: '-43%'\r\n                        }\r\n                    ],\r\n                        6: [\r\n                        {\r\n                            effect: 'Damage',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Missile explosion radius',\r\n                            value: '+50%'\r\n                        },{\r\n                            effect: 'Drone Tracking',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Targeting Range',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Tracking Speed',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Target Painter Strength',\r\n                            value: '-50%'\r\n                        }\r\n                    ]\r\n                },\r\n                redGiant: {\r\n                    1: [\r\n                        {\r\n                            effect: 'Heat Damage',\r\n                            value: '+15%'\r\n                        },{\r\n                            effect: 'Overload Bonus',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Smart Bomb Range',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Smart Bomb Damage',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Bomb Damage',\r\n                            value: '+30%'\r\n                        }\r\n                    ],\r\n                        2: [\r\n                        {\r\n                            effect: 'Heat Damage',\r\n                            value: '+22%'\r\n                        },{\r\n                            effect: 'Overload Bonus',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Smart Bomb Range',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Smart Bomb Damage',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Bomb Damage',\r\n                            value: '+44%'\r\n                        }\r\n                    ],\r\n                        3: [\r\n                        {\r\n                            effect: 'Heat Damage',\r\n                            value: '+29%'\r\n                        },{\r\n                            effect: 'Overload Bonus',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Smart Bomb Range',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Smart Bomb Damage',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Bomb Damage',\r\n                            value: '+58%'\r\n                        }\r\n                    ],\r\n                        4: [\r\n                        {\r\n                            effect: 'Heat Damage',\r\n                            value: '+36%'\r\n                        },{\r\n                            effect: 'Overload Bonus',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Smart Bomb Range',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Smart Bomb Damage',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Bomb Damage',\r\n                            value: '+72%'\r\n                        }\r\n                    ],\r\n                        5: [\r\n                        {\r\n                            effect: 'Heat Damage',\r\n                            value: '+43%'\r\n                        },{\r\n                            effect: 'Overload Bonus',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Smart Bomb Range',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Smart Bomb Damage',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Bomb Damage',\r\n                            value: '+86%'\r\n                        }\r\n                    ],\r\n                        6: [\r\n                        {\r\n                            effect: 'Heat Damage',\r\n                            value: '+50%'\r\n                        },{\r\n                            effect: 'Overload Bonus',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Smart Bomb Range',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Smart Bomb Damage',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Bomb Damage',\r\n                            value: '+100%'\r\n                        }\r\n                    ]\r\n                },\r\n                pulsar: {\r\n                    1: [\r\n                        {\r\n                            effect: 'Shield HP',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Armor Resists',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Capacitor recharge',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Signature',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'NOS / Neut Drain Amount',\r\n                            value: '+30%'\r\n                        }\r\n                    ],\r\n                        2: [\r\n                        {\r\n                            effect: 'Shield HP',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Armor Resists',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Capacitor recharge',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Signature',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'NOS / Neut Drain Amount',\r\n                            value: '+44%'\r\n                        }\r\n                    ],\r\n                        3: [\r\n                        {\r\n                            effect: 'Shield HP',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Armor Resists',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Capacitor recharge',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Signature',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'NOS / Neut Drain Amount',\r\n                            value: '+58%'\r\n                        }\r\n                    ],\r\n                        4: [\r\n                        {\r\n                            effect: 'Shield HP',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Armor Resists',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Capacitor recharge',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Signature',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'NOS / Neut Drain Amount',\r\n                            value: '+72%'\r\n                        }\r\n                    ],\r\n                        5: [\r\n                        {\r\n                            effect: 'Shield HP',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Armor Resists',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Capacitor recharge',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Signature',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'NOS / Neut Drain Amount',\r\n                            value: '+86%'\r\n                        }\r\n                    ],\r\n                        6: [\r\n                        {\r\n                            effect: 'Shield HP',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Armor Resists',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Capacitor recharge',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Signature',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'NOS / Neut Drain Amount',\r\n                            value: '+100%'\r\n                        }\r\n                    ]\r\n                },\r\n                wolfRayet: {\r\n                    1: [\r\n                        {\r\n                            effect: 'Armor HP',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Shield Resist',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Small Weapon Damage',\r\n                            value: '+60%'\r\n                        },{\r\n                            effect: 'Signature Size',\r\n                            value: '-15%'\r\n                        }\r\n                    ],\r\n                        2: [\r\n                        {\r\n                            effect: 'Armor HP',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Shield Resist',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Small Weapon Damage',\r\n                            value: '+88%'\r\n                        },{\r\n                            effect: 'Signature Size',\r\n                            value: '-22%'\r\n                        }\r\n                    ],\r\n                        3: [\r\n                        {\r\n                            effect: 'Armor HP',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Shield Resist',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Small Weapon Damage',\r\n                            value: '+116%'\r\n                        },{\r\n                            effect: 'Signature Size',\r\n                            value: '-29%'\r\n                        }\r\n                    ],\r\n                        4: [\r\n                        {\r\n                            effect: 'Armor HP',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Shield Resist',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Small Weapon Damage',\r\n                            value: '+144%'\r\n                        },{\r\n                            effect: 'Signature Size',\r\n                            value: '-36%'\r\n                        }\r\n                    ],\r\n                        5: [\r\n                        {\r\n                            effect: 'Armor HP',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Shield Resist',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Small Weapon Damage',\r\n                            value: '+172%'\r\n                        },{\r\n                            effect: 'Signature Size',\r\n                            value: '-43%'\r\n                        }\r\n                    ],\r\n                        6: [\r\n                        {\r\n                            effect: 'Armor HP',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Shield Resist',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Small Weapon Damage',\r\n                            value: '+200%'\r\n                        },{\r\n                            effect: 'Signature Size',\r\n                            value: '-50%'\r\n                        }\r\n                    ]\r\n                },\r\n                cataclysmic: {\r\n                    1: [\r\n                        {\r\n                            effect: 'Local armor repair amount',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Local shield boost amount',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Shield transfer amount',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Remote repair amount',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Capacitor capacity',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Capacitor recharge time',\r\n                            value: '+15%'\r\n                        },{\r\n                            effect: 'Remote Capacitor Transmitter amount',\r\n                            value: '-15%'\r\n                        }\r\n                    ],\r\n                        2: [\r\n                        {\r\n                            effect: 'Local armor repair amount',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Local shield boost amount',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Shield transfer amount',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Remote repair amount',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Capacitor capacity',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Capacitor recharge time',\r\n                            value: '+22%'\r\n                        },{\r\n                            effect: 'Remote Capacitor Transmitter amount',\r\n                            value: '-22%'\r\n                        }\r\n                    ],\r\n                        3: [\r\n                        {\r\n                            effect: 'Local armor repair amount',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Local shield boost amount',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Shield transfer amount',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Remote repair amount',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Capacitor capacity',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Capacitor recharge time',\r\n                            value: '+29%'\r\n                        },{\r\n                            effect: 'Remote Capacitor Transmitter amount',\r\n                            value: '-29%'\r\n                        }\r\n                    ],\r\n                        4: [\r\n                        {\r\n                            effect: 'Local armor repair amount',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Local shield boost amount',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Shield transfer amount',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Remote repair amount',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Capacitor capacity',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Capacitor recharge time',\r\n                            value: '+36%'\r\n                        },{\r\n                            effect: 'Remote Capacitor Transmitter amount',\r\n                            value: '-36%'\r\n                        }\r\n                    ],\r\n                        5: [\r\n                        {\r\n                            effect: 'Local armor repair amount',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Local shield boost amount',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Shield transfer amount',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Remote repair amount',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Capacitor capacity',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Capacitor recharge time',\r\n                            value: '+43%'\r\n                        },{\r\n                            effect: 'Remote Capacitor Transmitter amount',\r\n                            value: '-43%'\r\n                        }\r\n                    ],\r\n                        6: [\r\n                        {\r\n                            effect: 'Local armor repair amount',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Local shield boost amount',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Shield transfer amount',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Remote repair amount',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Capacitor capacity',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Capacitor recharge time',\r\n                            value: '+50%'\r\n                        },{\r\n                            effect: 'Remote Capacitor Transmitter amount',\r\n                            value: '-50%'\r\n                        }\r\n                    ]\r\n                },\r\n                blackHole: {\r\n                    1: [\r\n                        {\r\n                            effect: 'Missile velocity',\r\n                            value: '+15%'\r\n                        },{\r\n                            effect: 'Missile Explosion Velocity',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Ship velocity',\r\n                            value: '+30%'\r\n                        },{\r\n                            effect: 'Stasis Webifier Strength',\r\n                            value: '-15%'\r\n                        },{\r\n                            effect: 'Inertia',\r\n                            value: '+15%'\r\n                        },{\r\n                            effect: 'Targeting range',\r\n                            value: '+30%'\r\n                        }\r\n                    ],\r\n                        2: [\r\n                        {\r\n                            effect: 'Missile velocity',\r\n                            value: '+22%'\r\n                        },{\r\n                            effect: 'Missile Explosion Velocity',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Ship velocity',\r\n                            value: '+44%'\r\n                        },{\r\n                            effect: 'Stasis Webifier Strength',\r\n                            value: '-22%'\r\n                        },{\r\n                            effect: 'Inertia',\r\n                            value: '+22%'\r\n                        },{\r\n                            effect: 'Targeting range',\r\n                            value: '+44%'\r\n                        }\r\n                    ],\r\n                        3: [\r\n                        {\r\n                            effect: 'Missile velocity',\r\n                            value: '+29%'\r\n                        },{\r\n                            effect: 'Missile Explosion Velocity',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Ship velocity',\r\n                            value: '+58%'\r\n                        },{\r\n                            effect: 'Stasis Webifier Strength',\r\n                            value: '-29%'\r\n                        },{\r\n                            effect: 'Inertia',\r\n                            value: '+29%'\r\n                        },{\r\n                            effect: 'Targeting range',\r\n                            value: '+58%'\r\n                        }\r\n                    ],\r\n                        4: [\r\n                        {\r\n                            effect: 'Missile velocity',\r\n                            value: '+36%'\r\n                        },{\r\n                            effect: 'Missile Explosion Velocity',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Ship velocity',\r\n                            value: '+72%'\r\n                        },{\r\n                            effect: 'Stasis Webifier Strength',\r\n                            value: '-36%'\r\n                        },{\r\n                            effect: 'Inertia',\r\n                            value: '+36%'\r\n                        },{\r\n                            effect: 'Targeting range',\r\n                            value: '+72%'\r\n                        }\r\n                    ],\r\n                        5: [\r\n                        {\r\n                            effect: 'Missile velocity',\r\n                            value: '+43%'\r\n                        },{\r\n                            effect: 'Missile Explosion Velocity',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Ship velocity',\r\n                            value: '+86%'\r\n                        },{\r\n                            effect: 'Stasis Webifier Strength',\r\n                            value: '-43%'\r\n                        },{\r\n                            effect: 'Inertia',\r\n                            value: '+43%'\r\n                        },{\r\n                            effect: 'Targeting range',\r\n                            value: '+86%'\r\n                        }\r\n                    ],\r\n                        6: [\r\n                        {\r\n                            effect: 'Missile velocity',\r\n                            value: '+50%'\r\n                        },{\r\n                            effect: 'Missile Explosion Velocity',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Ship velocity',\r\n                            value: '+100%'\r\n                        },{\r\n                            effect: 'Stasis Webifier Strength',\r\n                            value: '-50%'\r\n                        },{\r\n                            effect: 'Inertia',\r\n                            value: '+50%'\r\n                        },{\r\n                            effect: 'Targeting range',\r\n                            value: '+100%'\r\n                        }\r\n                    ]\r\n                }\r\n            }\r\n        };\r\n\r\n\r\n    return systemEffects;\r\n});\n",
    "/**\r\n * Created by exodus4d on 06.07.2015.\r\n * static signature types\r\n *\r\n * (*) marked fields are in-game verified and\r\n * proofed, signature names (copy & paste from scanning window)\r\n */\r\n\r\ndefine('config/signature_type',['jquery'], function($) {\r\n\r\n    'use strict';\r\n\r\n    // signature sources\r\n    // http://de.sistersprobe.wikia.com/wiki/EVE_Sister_Core_Scanner_Probe_Wiki\r\n\r\n\r\n    // NullSec Relic sites, which can also spawn in C1, C2, C3 wormholes\r\n    var nullSecRelicSites = {\r\n        10: 'Ruined Angel Crystal Quarry',\r\n        11: 'Ruined Angel Monument Site',\r\n        12: 'Ruined Angel Science Outpost',\r\n        13: 'Ruined Angel Temple Site',\r\n        14: 'Ruined Blood Raider Crystal Quarry',\r\n        15: 'Ruined Blood Raider Monument Site',\r\n        16: 'Ruined Blood Raider Science Outpost',\r\n        17: 'Ruined Blood Raider Temple Site',\r\n        18: 'Ruined Guristas Crystal Quarry',\r\n        19: 'Ruined Guristas Monument Site',\r\n        20: 'Ruined Guristas Science Outpost',\r\n        21: 'Ruined Guristas Temple Site',\r\n        22: 'Ruined Sansha Crystal Quarry',\r\n        23: 'Ruined Sansha Monument Site',\r\n        24: 'Ruined Sansha Science Outpost',\r\n        25: 'Ruined Sansha Temple Site',\r\n        26: 'Ruined Serpentis Crystal Quarry',\r\n        27: 'Ruined Serpentis Monument Site',\r\n        28: 'Ruined Serpentis Science Outpost',\r\n        29: 'Ruined Serpentis Temple Site'\r\n    };\r\n\r\n    // NulSec Data sites, which can also spawn in C1, C2, C3 wormholes\r\n    var nullSecDataSites = {\r\n        10: 'Abandoned Research Complex DA005',\r\n        11: 'Abandoned Research Complex DA015',\r\n        12: 'Abandoned Research Complex DC007',\r\n        13: 'Abandoned Research Complex DC021',\r\n        14: 'Abandoned Research Complex DC035',\r\n        15: 'Abandoned Research Complex DG003',\r\n        16: 'Central Angel Command Center',\r\n        17: 'Central Angel Data Mining Site',\r\n        18: 'Central Angel Sparking Transmitter',\r\n        19: 'Central Angel Survey Site',\r\n        20: 'Central Blood Raider Command Center',\r\n        21: 'Central Blood Raider Data Mining Site',\r\n        22: 'Central Blood Raider Sparking Transmitter',\r\n        23: 'Central Blood Raider Survey Site',\r\n        24: 'Central Guristas Command Center',\r\n        25: 'Central Guristas Data Mining Center',\r\n        26: 'Central Guristas Sparking Transmitter',\r\n        27: 'Central Guristas Survey Site',\r\n        28: 'Central Sansha Command Center',\r\n        29: 'Central Sansha Data Mining Site',\r\n        30: 'Central Sansha Sparking Transmitter',\r\n        31: 'Central Sansha Survey Site',\r\n        32: 'Central Serpentis Command Center',\r\n        33: 'Central Serpentis Data Mining Site',\r\n        34: 'Central Serpentis Sparking Transmitter',\r\n        35: 'Central Serpentis Survey Site'\r\n    };\r\n\r\n\r\n    // signature types\r\n    var signatureTypes = {\r\n        1: { // system type (wh)\r\n            1: {    // C1 (area id)\r\n                1: {    // Combat\r\n                    1: 'Perimeter Ambush Point',\r\n                    2: 'Perimeter Camp',\r\n                    3: 'Phase Catalyst Node',\r\n                    4: 'The Line'\r\n                },\r\n                2: $.extend({}, nullSecRelicSites, {    // Relic\r\n                    1: 'Forgotten Perimeter Coronation Platform', //*\r\n                    2: 'Forgotten Perimeter Power Array' //*\r\n                }),\r\n                3: $.extend({}, nullSecDataSites, {    // Data\r\n                    1: 'Unsecured Perimeter Amplifier', //*\r\n                    2: 'Unsecured Perimeter Information Center' //*\r\n                }),\r\n                4: {    // Gas\r\n                    1: 'Barren Perimeter Reservoir', //*\r\n                    2: 'Token Perimeter Reservoir', //*\r\n                    3: 'Minor Perimeter Reservoir', //*\r\n                    4: 'Sizeable Perimeter Reservoir', //*\r\n                    5: 'Ordinary Perimeter Reservoir' //*\r\n                },\r\n                5: {    // Wormhole\r\n                    1: 'H121 - C1',\r\n                    2: 'C125 - C2',\r\n                    3: 'O883 - C3',\r\n                    4: 'M609 - C4',\r\n                    5: 'L614 - C5',\r\n                    6: 'S804 - C6',\r\n                    7: 'F135 - Thera'\r\n                },\r\n                6: {    // ORE\r\n                    1: 'Ordinary Perimeter Deposit', //*\r\n                    2: 'Common Perimeter Deposit', //*\r\n                    3: 'Unexceptional Frontier Deposit', //*\r\n                    4: 'Average Frontier Deposit', //*\r\n                    5: 'Isolated Core Deposit', //*\r\n                    6: 'Uncommon Core Deposit' //*\r\n                },\r\n                7: {    // Ghost\r\n\r\n                }\r\n            },\r\n            2: {    // C2\r\n                1: {    // Combat\r\n                    1: 'Perimeter Checkpoint',\r\n                    2: 'Perimeter Hangar',\r\n                    3: 'The Ruins of Enclave Cohort 27',\r\n                    4: 'Sleeper Data Sanctuary'\r\n                },\r\n                2: $.extend({}, nullSecRelicSites, {    // Relic\r\n                    1: 'Forgotten Perimeter Gateway', //*\r\n                    2: 'Forgotten Perimeter Habitation Coils' //*\r\n                }),\r\n                3: $.extend({}, nullSecDataSites, {    // Data\r\n                    1: 'Unsecured Perimeter Comms Relay', //*\r\n                    2: 'Unsecured Perimeter Transponder Farm' //*\r\n                }),\r\n                4: {    // Gas\r\n                    1: 'Barren Perimeter Reservoir', //*\r\n                    2: 'Token Perimeter Reservoir', //*\r\n                    3: 'Minor Perimeter Reservoir', //*\r\n                    4: 'Sizeable Perimeter Reservoir', //*\r\n                    5: 'Ordinary Perimeter Reservoir' //*\r\n                },\r\n                5: {    // Wormhole\r\n                    1: 'Z647 - C1',\r\n                    2: 'D382 - C2',\r\n                    3: 'O477 - C3',\r\n                    4: 'Y683 - C4',\r\n                    5: 'N062 - C5',\r\n                    6: 'R474 - C6',\r\n                    7: 'F135 - Thera'\r\n                },\r\n                6: {    // ORE\r\n                    1: 'Ordinary Perimeter Deposit', //*\r\n                    2: 'Common Perimeter Deposit', //*\r\n                    3: 'Unexceptional Frontier Deposit', //*\r\n                    4: 'Average Frontier Deposit', //*\r\n                    5: 'Isolated Core Deposit', //*\r\n                    6: 'Uncommon Core Deposit' //*\r\n                },\r\n                7: {    // Ghost\r\n\r\n                }\r\n            },\r\n            3: {    // C3\r\n                1: {    // Combat\r\n                    1: 'Fortification Frontier Stronghold',\r\n                    2: 'Outpost Frontier Stronghold',\r\n                    3: 'Solar Cell',\r\n                    4: 'The Oruze Construct'\r\n                },\r\n                2: $.extend({}, nullSecRelicSites, {    // Relic\r\n                    1: 'Forgotten Frontier Quarantine Outpost', //*\r\n                    2: 'Forgotten Frontier Recursive Depot' //*\r\n                }),\r\n                3: $.extend({}, nullSecDataSites, {    // Data\r\n                    1: 'Unsecured Frontier Database', //*\r\n                    2: 'Unsecured Frontier Receiver' //*\r\n                }),\r\n                4: {    // Gas\r\n                    1: 'Barren Perimeter Reservoir', //*\r\n                    2: 'Token Perimeter Reservoir', //*\r\n                    3: 'Minor Perimeter Reservoir', //*\r\n                    4: 'Sizeable Perimeter Reservoir', //*\r\n                    5: 'Ordinary Perimeter Reservoir', //*\r\n                    6: 'Bountiful Frontier Reservoir', //*\r\n                    7: 'Vast Frontier Reservoir' //*\r\n                },\r\n                5: {    // Wormhole\r\n                    1: 'V301 - C1',\r\n                    2: 'I182 - C2',\r\n                    3: 'N968 - C3',\r\n                    4: 'T405 - C4',\r\n                    5: 'N770 - C5',\r\n                    6: 'A982 - C6',\r\n                    7: 'F135 - Thera'\r\n                },\r\n                6: {    // ORE\r\n                    1: 'Ordinary Perimeter Deposit', //*\r\n                    2: 'Common Perimeter Deposit', //*\r\n                    3: 'Unexceptional Frontier Deposit', //*\r\n                    4: 'Average Frontier Deposit', //*\r\n                    5: 'Infrequent Core Deposit', //*\r\n                    6: 'Unusual Core Deposit' //*\r\n                },\r\n                7: {    // Ghost\r\n\r\n                }\r\n            },\r\n            4: {    // C4\r\n                1: {    // Combat\r\n                    1: 'Frontier Barracks',\r\n                    2: 'Frontier Command Post',\r\n                    3: 'Integrated Terminus',\r\n                    4: 'Sleeper Information Sanctum'\r\n                },\r\n                2: {    // Relic\r\n                    1: 'Forgotten Frontier Conversion Module',\r\n                    2: 'Forgotten Frontier Evacuation Center'\r\n                },\r\n                3: {    // Data\r\n                    1: 'Unsecured Frontier Digital Nexus',\r\n                    2: 'Unsecured Frontier Trinary Hub'\r\n                },\r\n                4: {    // Gas\r\n                    1: 'Barren Perimeter Reservoir', //*\r\n                    2: 'Token Perimeter Reservoir', //*\r\n                    3: 'Minor Perimeter Reservoir', //*\r\n                    4: 'Sizeable Perimeter Reservoir', //*\r\n                    5: 'Ordinary Perimeter Reservoir', //*\r\n                    6: 'Vast Frontier Reservoir', //*\r\n                    7: 'Bountiful Frontier Reservoir' //*\r\n                },\r\n                5: {    // Wormhole\r\n                    // no *wandering* w-space -> k-space wormholes\r\n                    // all holes are statics or K162\r\n                },\r\n                6: {    // ORE\r\n                    1: 'Ordinary Perimeter Deposit', //*\r\n                    2: 'Common Perimeter Deposit', //*\r\n                    3: 'Unexceptional Frontier Deposit', //*\r\n                    4: 'Average Frontier Deposit', //*\r\n                    5: 'Unusual Core Deposit', //*\r\n                    6: 'Infrequent Core Deposit' //*\r\n                },\r\n                7: {    // Ghost\r\n\r\n                }\r\n            },\r\n            5: {    // C5\r\n                1: {    // Combat\r\n                    1: 'Core Garrison', //*\r\n                    2: 'Core Stronghold', //*\r\n                    3: 'Oruze Osobnyk', //*\r\n                    4: 'Quarantine Area'\r\n                },\r\n                2: {    // Relic\r\n                    1: 'Forgotten Core Data Field',\r\n                    2: 'Forgotten Core Information Pen'\r\n                },\r\n                3: {    // Data\r\n                    1: 'Unsecured Frontier Enclave Relay',\r\n                    2: 'Unsecured Frontier Server Bank'\r\n                },\r\n                4: {    // Gas\r\n                    1: 'Barren Perimeter Reservoir', //*\r\n                    2: 'Minor Perimeter Reservoir', //*\r\n                    3: 'Ordinary Perimeter Reservoir', //*\r\n                    4: 'Sizeable Perimeter Reservoir', //*\r\n                    5: 'Token Perimeter Reservoir', //*\r\n                    6: 'Bountiful Frontier Reservoir', //*\r\n                    7: 'Vast Frontier Reservoir', //*\r\n                    8: 'Instrumental Core Reservoir', //*\r\n                    9: 'Vital Core Reservoir' //*\r\n                },\r\n                5: {    // Wormhole\r\n                    1: 'D792 - HS',\r\n                    2: 'C140 - LS',\r\n                    3: 'Z142 - 0.0',\r\n                    4: 'F135 - Thera'\r\n                },\r\n                6: {    // ORE\r\n                    1: 'Average Frontier Deposit', //*\r\n                    2: 'Unexceptional Frontier Deposit', //*\r\n                    3: 'Uncommon Core Deposit', //*\r\n                    4: 'Ordinary Perimeter Deposit', //*\r\n                    5: 'Common Perimeter Deposit', //*\r\n                    6: 'Exceptional Core Deposit', //*\r\n                    7: 'Infrequent Core Deposit', //*\r\n                    8: 'Unusual Core Deposit', //*\r\n                    9: 'Rarified Core Deposit', //*\r\n                    10: 'Isolated Core Deposit' //*\r\n                },\r\n                7: {    // Ghost\r\n\r\n                }\r\n            },\r\n            6: {    // C6\r\n                1: {    // Combat\r\n                    1: 'Core Citadel', //*\r\n                    2: 'Core Bastion', //*\r\n                    3: 'Strange Energy Readings', //*\r\n                    4: 'The Mirror' //*\r\n                },\r\n                2: {    // Relic\r\n                    1: 'Forgotten Core Assembly Hall', //*\r\n                    2: 'Forgotten Core Circuitry Disassembler' //*\r\n                },\r\n                3: {    // Data\r\n                    1: 'Unsecured Core Backup Array', //*\r\n                    2: 'Unsecured Core Emergence' //*\r\n                },\r\n                4: {    // Gas\r\n                    1: 'Barren Perimeter Reservoir', //*\r\n                    2: 'Minor Perimeter Reservoir', //*\r\n                    3: 'Ordinary Perimeter Reservoir', //*\r\n                    4: 'Sizeable Perimeter Reservoir', //*\r\n                    5: 'Token Perimeter Reservoir', //*\r\n                    6: 'Bountiful Frontier Reservoir', //*\r\n                    7: 'Vast Frontier Reservoir', //*\r\n                    8: 'Instrumental Core Reservoir', //*\r\n                    9: 'Vital Core Reservoir' //*\r\n                },\r\n                5: {    // Wormhole\r\n                    1: 'D792 - HS',\r\n                    2: 'C391 - LS',\r\n                    3: 'Z142 - 0.0',\r\n                    4: 'F135 - Thera'\r\n                },\r\n                6: {    // ORE\r\n                    1: 'Ordinary Perimeter Deposit', //*\r\n                    2: 'Common Perimeter Deposit', //*\r\n                    3: 'Unexceptional Frontier Deposit', //*\r\n                    4: 'Average Frontier Deposit', //*\r\n                    5: 'Rarified Core Deposit' //*\r\n                },\r\n                7: {    // Ghost\r\n                    1: 'Superior Blood Raider Covert Research Facility' //*\r\n                }\r\n            },\r\n            13: {   // Shattered Wormholes\r\n                5: {    // Wormhole (some of them are static)\r\n                    1: 'P060 - C1',\r\n                    2: 'Z647 - C1',\r\n                    3: 'D382 - C2',\r\n                    4: 'L005 - C2',\r\n                    5: 'N766 - C2',\r\n                    6: 'C247 - C3',\r\n                    7: 'K346 - C3',\r\n                    8: 'M267 - C3',\r\n                    9: 'O477 - C3',\r\n                    10: 'X877 - C4',\r\n                    11: 'Y683 - C4',\r\n                    12: 'H296 - C5',\r\n                    13: 'H900 - C5',\r\n                    14: 'H296 - C5',\r\n                    15: 'N062 - C5',\r\n                    16: 'V911 - C5',\r\n                    17: 'U574 - C6',\r\n                    18: 'V753 - C6',\r\n                    19: 'W237 - C6',\r\n                    20: 'B274 - HS',\r\n                    21: 'D792 - HS',\r\n                    22: 'D845 - HS',\r\n                    23: 'N110 - HS',\r\n                    24: 'A239 - LS',\r\n                    25: 'C391 - LS',\r\n                    26: 'J244 - LS',\r\n                    27: 'U201 - LS',\r\n                    28: 'U210 - LS',\r\n                    29: 'C248 - 0.0',\r\n                    30: 'E545 - 0.0',\r\n                    31: 'K346 - 0.0',\r\n                    32: 'Z060 - 0.0'\r\n                }\r\n            }\r\n        }, // system type (k-space)\r\n        2:  {\r\n            10: {   // High Sec\r\n                5:  {   // Wormhole\r\n                    1: 'Z971 - C1',\r\n                    2: 'R943 - C2',\r\n                    3: 'X702 - C3',\r\n                    // no C4\r\n                    4: 'M555 - C5',\r\n                    5: 'B041 - C6',\r\n                    6: 'A641 - HS',\r\n                    7: 'R051 - LS',\r\n                    8: 'V283 - 0.0',\r\n                    9: 'T458 - Thera'\r\n                }\r\n            },\r\n            11: {   // Low Sec\r\n                5:  {   // Wormhole\r\n                    1: 'Z971 - C1',\r\n                    2: 'R943 - C2',\r\n                    3: 'X702 - C3',\r\n                    // no C4\r\n                    4: 'N432 - C5',\r\n                    5: 'U319 - C6',\r\n                    6: 'B449 - HS',\r\n                    7: 'N944 - LS',\r\n                    8: 'S199 - 0.0',\r\n                    9: 'M164 - Thera'\r\n                }\r\n            },\r\n            12: {   // 0.0\r\n                5:  {   // Wormhole\r\n                    1: 'Z971 - C1',\r\n                    2: 'R943 - C2',\r\n                    3: 'X702 - C3',\r\n                    // no C4\r\n                    4: 'N432 - C5',\r\n                    5: 'U319 - C6',\r\n                    6: 'B449 - HS',\r\n                    7: 'N944 - LS',\r\n                    8: 'S199 - 0.0',\r\n                    9: 'L031 - Thera'\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    return signatureTypes;\r\n});\n",
    "/*!\r\n * Bootstrap v3.3.5 (http://getbootstrap.com)\r\n * Copyright 2011-2015 Twitter, Inc.\r\n * Licensed under the MIT license\r\n */\r\nif(\"undefined\"==typeof jQuery)throw new Error(\"Bootstrap's JavaScript requires jQuery\");+function(a){\"use strict\";var b=a.fn.jquery.split(\" \")[0].split(\".\");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1)throw new Error(\"Bootstrap's JavaScript requires jQuery version 1.9.1 or higher\")}(jQuery),+function(a){\"use strict\";function b(){var a=document.createElement(\"bootstrap\"),b={WebkitTransition:\"webkitTransitionEnd\",MozTransition:\"transitionend\",OTransition:\"oTransitionEnd otransitionend\",transition:\"transitionend\"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one(\"bsTransitionEnd\",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var c=a(this),e=c.data(\"bs.alert\");e||c.data(\"bs.alert\",e=new d(this)),\"string\"==typeof b&&e[b].call(c)})}var c='[data-dismiss=\"alert\"]',d=function(b){a(b).on(\"click\",c,this.close)};d.VERSION=\"3.3.5\",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger(\"closed.bs.alert\").remove()}var e=a(this),f=e.attr(\"data-target\");f||(f=e.attr(\"href\"),f=f&&f.replace(/.*(?=#[^\\s]*$)/,\"\"));var g=a(f);b&&b.preventDefault(),g.length||(g=e.closest(\".alert\")),g.trigger(b=a.Event(\"close.bs.alert\")),b.isDefaultPrevented()||(g.removeClass(\"in\"),a.support.transition&&g.hasClass(\"fade\")?g.one(\"bsTransitionEnd\",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on(\"click.bs.alert.data-api\",c,d.prototype.close)}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.button\"),f=\"object\"==typeof b&&b;e||d.data(\"bs.button\",e=new c(this,f)),\"toggle\"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION=\"3.3.5\",c.DEFAULTS={loadingText:\"loading...\"},c.prototype.setState=function(b){var c=\"disabled\",d=this.$element,e=d.is(\"input\")?\"val\":\"html\",f=d.data();b+=\"Text\",null==f.resetText&&d.data(\"resetText\",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),\"loadingText\"==b?(this.isLoading=!0,d.addClass(c).attr(c,c)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle=\"buttons\"]');if(b.length){var c=this.$element.find(\"input\");\"radio\"==c.prop(\"type\")?(c.prop(\"checked\")&&(a=!1),b.find(\".active\").removeClass(\"active\"),this.$element.addClass(\"active\")):\"checkbox\"==c.prop(\"type\")&&(c.prop(\"checked\")!==this.$element.hasClass(\"active\")&&(a=!1),this.$element.toggleClass(\"active\")),c.prop(\"checked\",this.$element.hasClass(\"active\")),a&&c.trigger(\"change\")}else this.$element.attr(\"aria-pressed\",!this.$element.hasClass(\"active\")),this.$element.toggleClass(\"active\")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on(\"click.bs.button.data-api\",'[data-toggle^=\"button\"]',function(c){var d=a(c.target);d.hasClass(\"btn\")||(d=d.closest(\".btn\")),b.call(d,\"toggle\"),a(c.target).is('input[type=\"radio\"]')||a(c.target).is('input[type=\"checkbox\"]')||c.preventDefault()}).on(\"focus.bs.button.data-api blur.bs.button.data-api\",'[data-toggle^=\"button\"]',function(b){a(b.target).closest(\".btn\").toggleClass(\"focus\",/^focus(in)?$/.test(b.type))})}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.carousel\"),f=a.extend({},c.DEFAULTS,d.data(),\"object\"==typeof b&&b),g=\"string\"==typeof b?b:f.slide;e||d.data(\"bs.carousel\",e=new c(this,f)),\"number\"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(\".carousel-indicators\"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on(\"keydown.bs.carousel\",a.proxy(this.keydown,this)),\"hover\"==this.options.pause&&!(\"ontouchstart\"in document.documentElement)&&this.$element.on(\"mouseenter.bs.carousel\",a.proxy(this.pause,this)).on(\"mouseleave.bs.carousel\",a.proxy(this.cycle,this))};c.VERSION=\"3.3.5\",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:\"hover\",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(\".item\"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d=\"prev\"==a&&0===c||\"next\"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e=\"prev\"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(\".item.active\"));return a>this.$items.length-1||0>a?void 0:this.sliding?this.$element.one(\"slid.bs.carousel\",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?\"next\":\"prev\",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(\".next, .prev\").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){return this.sliding?void 0:this.slide(\"next\")},c.prototype.prev=function(){return this.sliding?void 0:this.slide(\"prev\")},c.prototype.slide=function(b,d){var e=this.$element.find(\".item.active\"),f=d||this.getItemForDirection(b,e),g=this.interval,h=\"next\"==b?\"left\":\"right\",i=this;if(f.hasClass(\"active\"))return this.sliding=!1;var j=f[0],k=a.Event(\"slide.bs.carousel\",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(\".active\").removeClass(\"active\");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass(\"active\")}var m=a.Event(\"slid.bs.carousel\",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass(\"slide\")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one(\"bsTransitionEnd\",function(){f.removeClass([b,h].join(\" \")).addClass(\"active\"),e.removeClass([\"active\",h].join(\" \")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass(\"active\"),f.addClass(\"active\"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr(\"data-target\")||(d=e.attr(\"href\"))&&d.replace(/.*(?=#[^\\s]+$)/,\"\"));if(f.hasClass(\"carousel\")){var g=a.extend({},f.data(),e.data()),h=e.attr(\"data-slide-to\");h&&(g.interval=!1),b.call(f,g),h&&f.data(\"bs.carousel\").to(h),c.preventDefault()}};a(document).on(\"click.bs.carousel.data-api\",\"[data-slide]\",e).on(\"click.bs.carousel.data-api\",\"[data-slide-to]\",e),a(window).on(\"load\",function(){a('[data-ride=\"carousel\"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),+function(a){\"use strict\";function b(b){var c,d=b.attr(\"data-target\")||(c=b.attr(\"href\"))&&c.replace(/.*(?=#[^\\s]+$)/,\"\");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data(\"bs.collapse\"),f=a.extend({},d.DEFAULTS,c.data(),\"object\"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data(\"bs.collapse\",e=new d(this,f)),\"string\"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle=\"collapse\"][href=\"#'+b.id+'\"],[data-toggle=\"collapse\"][data-target=\"#'+b.id+'\"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION=\"3.3.5\",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){var a=this.$element.hasClass(\"width\");return a?\"width\":\"height\"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass(\"in\")){var b,e=this.$parent&&this.$parent.children(\".panel\").children(\".in, .collapsing\");if(!(e&&e.length&&(b=e.data(\"bs.collapse\"),b&&b.transitioning))){var f=a.Event(\"show.bs.collapse\");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,\"hide\"),b||e.data(\"bs.collapse\",null));var g=this.dimension();this.$element.removeClass(\"collapse\").addClass(\"collapsing\")[g](0).attr(\"aria-expanded\",!0),this.$trigger.removeClass(\"collapsed\").attr(\"aria-expanded\",!0),this.transitioning=1;var h=function(){this.$element.removeClass(\"collapsing\").addClass(\"collapse in\")[g](\"\"),this.transitioning=0,this.$element.trigger(\"shown.bs.collapse\")};if(!a.support.transition)return h.call(this);var i=a.camelCase([\"scroll\",g].join(\"-\"));this.$element.one(\"bsTransitionEnd\",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass(\"in\")){var b=a.Event(\"hide.bs.collapse\");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass(\"collapsing\").removeClass(\"collapse in\").attr(\"aria-expanded\",!1),this.$trigger.addClass(\"collapsed\").attr(\"aria-expanded\",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass(\"collapsing\").addClass(\"collapse\").trigger(\"hidden.bs.collapse\")};return a.support.transition?void this.$element[c](0).one(\"bsTransitionEnd\",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass(\"in\")?\"hide\":\"show\"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle=\"collapse\"][data-parent=\"'+this.options.parent+'\"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass(\"in\");a.attr(\"aria-expanded\",c),b.toggleClass(\"collapsed\",!c).attr(\"aria-expanded\",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on(\"click.bs.collapse.data-api\",'[data-toggle=\"collapse\"]',function(d){var e=a(this);e.attr(\"data-target\")||d.preventDefault();var f=b(e),g=f.data(\"bs.collapse\"),h=g?\"toggle\":e.data();c.call(f,h)})}(jQuery),+function(a){\"use strict\";function b(b){var c=b.attr(\"data-target\");c||(c=b.attr(\"href\"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\\s]*$)/,\"\"));var d=c&&a(c);return d&&d.length?d:b.parent()}function c(c){c&&3===c.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=b(d),f={relatedTarget:this};e.hasClass(\"open\")&&(c&&\"click\"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(e[0],c.target)||(e.trigger(c=a.Event(\"hide.bs.dropdown\",f)),c.isDefaultPrevented()||(d.attr(\"aria-expanded\",\"false\"),e.removeClass(\"open\").trigger(\"hidden.bs.dropdown\",f))))}))}function d(b){return this.each(function(){var c=a(this),d=c.data(\"bs.dropdown\");d||c.data(\"bs.dropdown\",d=new g(this)),\"string\"==typeof b&&d[b].call(c)})}var e=\".dropdown-backdrop\",f='[data-toggle=\"dropdown\"]',g=function(b){a(b).on(\"click.bs.dropdown\",this.toggle)};g.VERSION=\"3.3.5\",g.prototype.toggle=function(d){var e=a(this);if(!e.is(\".disabled, :disabled\")){var f=b(e),g=f.hasClass(\"open\");if(c(),!g){\"ontouchstart\"in document.documentElement&&!f.closest(\".navbar-nav\").length&&a(document.createElement(\"div\")).addClass(\"dropdown-backdrop\").insertAfter(a(this)).on(\"click\",c);var h={relatedTarget:this};if(f.trigger(d=a.Event(\"show.bs.dropdown\",h)),d.isDefaultPrevented())return;e.trigger(\"focus\").attr(\"aria-expanded\",\"true\"),f.toggleClass(\"open\").trigger(\"shown.bs.dropdown\",h)}return!1}},g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);if(c.preventDefault(),c.stopPropagation(),!d.is(\".disabled, :disabled\")){var e=b(d),g=e.hasClass(\"open\");if(!g&&27!=c.which||g&&27==c.which)return 27==c.which&&e.find(f).trigger(\"focus\"),d.trigger(\"click\");var h=\" li:not(.disabled):visible a\",i=e.find(\".dropdown-menu\"+h);if(i.length){var j=i.index(c.target);38==c.which&&j>0&&j--,40==c.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger(\"focus\")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on(\"click.bs.dropdown.data-api\",c).on(\"click.bs.dropdown.data-api\",\".dropdown form\",function(a){a.stopPropagation()}).on(\"click.bs.dropdown.data-api\",f,g.prototype.toggle).on(\"keydown.bs.dropdown.data-api\",f,g.prototype.keydown).on(\"keydown.bs.dropdown.data-api\",\".dropdown-menu\",g.prototype.keydown)}(jQuery),+function(a){\"use strict\";function b(b,d){return this.each(function(){var e=a(this),f=e.data(\"bs.modal\"),g=a.extend({},c.DEFAULTS,e.data(),\"object\"==typeof b&&b);f||e.data(\"bs.modal\",f=new c(this,g)),\"string\"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(\".modal-dialog\"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(\".modal-content\").load(this.options.remote,a.proxy(function(){this.$element.trigger(\"loaded.bs.modal\")},this))};c.VERSION=\"3.3.5\",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event(\"show.bs.modal\",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass(\"modal-open\"),this.escape(),this.resize(),this.$element.on(\"click.dismiss.bs.modal\",'[data-dismiss=\"modal\"]',a.proxy(this.hide,this)),this.$dialog.on(\"mousedown.dismiss.bs.modal\",function(){d.$element.one(\"mouseup.dismiss.bs.modal\",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass(\"fade\");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass(\"in\"),d.enforceFocus();var f=a.Event(\"shown.bs.modal\",{relatedTarget:b});e?d.$dialog.one(\"bsTransitionEnd\",function(){d.$element.trigger(\"focus\").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger(\"focus\").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event(\"hide.bs.modal\"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off(\"focusin.bs.modal\"),this.$element.removeClass(\"in\").off(\"click.dismiss.bs.modal\").off(\"mouseup.dismiss.bs.modal\"),this.$dialog.off(\"mousedown.dismiss.bs.modal\"),a.support.transition&&this.$element.hasClass(\"fade\")?this.$element.one(\"bsTransitionEnd\",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off(\"focusin.bs.modal\").on(\"focusin.bs.modal\",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger(\"focus\")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on(\"keydown.dismiss.bs.modal\",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off(\"keydown.dismiss.bs.modal\")},c.prototype.resize=function(){this.isShown?a(window).on(\"resize.bs.modal\",a.proxy(this.handleUpdate,this)):a(window).off(\"resize.bs.modal\")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass(\"modal-open\"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger(\"hidden.bs.modal\")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass(\"fade\")?\"fade\":\"\";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement(\"div\")).addClass(\"modal-backdrop \"+e).appendTo(this.$body),this.$element.on(\"click.dismiss.bs.modal\",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&(\"static\"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass(\"in\"),!b)return;f?this.$backdrop.one(\"bsTransitionEnd\",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass(\"in\");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass(\"fade\")?this.$backdrop.one(\"bsTransitionEnd\",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:\"\",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:\"\"})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:\"\",paddingRight:\"\"})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css(\"padding-right\")||0,10);this.originalBodyPad=document.body.style.paddingRight||\"\",this.bodyIsOverflowing&&this.$body.css(\"padding-right\",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css(\"padding-right\",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement(\"div\");a.className=\"modal-scrollbar-measure\",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on(\"click.bs.modal.data-api\",'[data-toggle=\"modal\"]',function(c){var d=a(this),e=d.attr(\"href\"),f=a(d.attr(\"data-target\")||e&&e.replace(/.*(?=#[^\\s]+$)/,\"\")),g=f.data(\"bs.modal\")?\"toggle\":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is(\"a\")&&c.preventDefault(),f.one(\"show.bs.modal\",function(a){a.isDefaultPrevented()||f.one(\"hidden.bs.modal\",function(){d.is(\":visible\")&&d.trigger(\"focus\")})}),b.call(f,g,this)})}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.tooltip\"),f=\"object\"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data(\"bs.tooltip\",e=new c(this,f)),\"string\"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init(\"tooltip\",a,b)};c.VERSION=\"3.3.5\",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:\"top\",selector:!1,template:'<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',trigger:\"hover focus\",title:\"\",delay:0,html:!1,container:!1,viewport:{selector:\"body\",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error(\"`selector` option must be specified when initializing \"+this.type+\" on the window.document object!\");for(var e=this.options.trigger.split(\" \"),f=e.length;f--;){var g=e[f];if(\"click\"==g)this.$element.on(\"click.\"+this.type,this.options.selector,a.proxy(this.toggle,this));else if(\"manual\"!=g){var h=\"hover\"==g?\"mouseenter\":\"focusin\",i=\"hover\"==g?\"mouseleave\":\"focusout\";this.$element.on(h+\".\"+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+\".\"+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:\"manual\",selector:\"\"}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&\"number\"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data(\"bs.\"+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(\"bs.\"+this.type,c)),b instanceof a.Event&&(c.inState[\"focusin\"==b.type?\"focus\":\"hover\"]=!0),c.tip().hasClass(\"in\")||\"in\"==c.hoverState?void(c.hoverState=\"in\"):(clearTimeout(c.timeout),c.hoverState=\"in\",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){\"in\"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data(\"bs.\"+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(\"bs.\"+this.type,c)),b instanceof a.Event&&(c.inState[\"focusout\"==b.type?\"focus\":\"hover\"]=!1),c.isInStateTrue()?void 0:(clearTimeout(c.timeout),c.hoverState=\"out\",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){\"out\"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide())},c.prototype.show=function(){var b=a.Event(\"show.bs.\"+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr(\"id\",g),this.$element.attr(\"aria-describedby\",g),this.options.animation&&f.addClass(\"fade\");var h=\"function\"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\\s?auto?\\s?/i,j=i.test(h);j&&(h=h.replace(i,\"\")||\"top\"),f.detach().css({top:0,left:0,display:\"block\"}).addClass(h).data(\"bs.\"+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger(\"inserted.bs.\"+this.type);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.getPosition(this.$viewport);h=\"bottom\"==h&&k.bottom+m>o.bottom?\"top\":\"top\"==h&&k.top-m<o.top?\"bottom\":\"right\"==h&&k.right+l>o.width?\"left\":\"left\"==h&&k.left-l<o.left?\"right\":h,f.removeClass(n).addClass(h)}var p=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(p,h);var q=function(){var a=e.hoverState;e.$element.trigger(\"shown.bs.\"+e.type),e.hoverState=null,\"out\"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass(\"fade\")?f.one(\"bsTransitionEnd\",q).emulateTransitionEnd(c.TRANSITION_DURATION):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css(\"margin-top\"),10),h=parseInt(d.css(\"margin-left\"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass(\"in\");var i=d[0].offsetWidth,j=d[0].offsetHeight;\"top\"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?\"offsetWidth\":\"offsetHeight\";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?\"left\":\"top\",50*(1-a/b)+\"%\").css(c?\"top\":\"left\",\"\")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(\".tooltip-inner\")[this.options.html?\"html\":\"text\"](b),a.removeClass(\"fade in top bottom left right\")},c.prototype.hide=function(b){function d(){\"in\"!=e.hoverState&&f.detach(),e.$element.removeAttr(\"aria-describedby\").trigger(\"hidden.bs.\"+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event(\"hide.bs.\"+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(f.removeClass(\"in\"),a.support.transition&&f.hasClass(\"fade\")?f.one(\"bsTransitionEnd\",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr(\"title\")||\"string\"!=typeof a.attr(\"data-original-title\"))&&a.attr(\"data-original-title\",a.attr(\"title\")||\"\").attr(\"title\",\"\")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d=\"BODY\"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},c.prototype.getCalculatedOffset=function(a,b,c,d){return\"bottom\"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:\"top\"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:\"left\"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr(\"data-original-title\")||(\"function\"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+\" `template` option must consist of exactly 1 top-level element!\");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(\".tooltip-arrow\")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data(\"bs.\"+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(\"bs.\"+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass(\"in\")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off(\".\"+a.type).removeData(\"bs.\"+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.popover\"),f=\"object\"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data(\"bs.popover\",e=new c(this,f)),\"string\"==typeof b&&e[b]())})}var c=function(a,b){this.init(\"popover\",a,b)};if(!a.fn.tooltip)throw new Error(\"Popover requires tooltip.js\");c.VERSION=\"3.3.5\",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:\"right\",trigger:\"click\",content:\"\",template:'<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(\".popover-title\")[this.options.html?\"html\":\"text\"](b),a.find(\".popover-content\").children().detach().end()[this.options.html?\"string\"==typeof c?\"html\":\"append\":\"text\"](c),a.removeClass(\"fade top bottom left right in\"),a.find(\".popover-title\").html()||a.find(\".popover-title\").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr(\"data-content\")||(\"function\"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(\".arrow\")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),+function(a){\"use strict\";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||\"\")+\" .nav li > a\",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on(\"scroll.bs.scrollspy\",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data(\"bs.scrollspy\"),f=\"object\"==typeof c&&c;e||d.data(\"bs.scrollspy\",e=new b(this,f)),\"string\"==typeof c&&e[c]()})}b.VERSION=\"3.3.5\",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c=\"offset\",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c=\"position\",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data(\"target\")||b.attr(\"href\"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(\":visible\")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target=\"'+b+'\"],'+this.selector+'[href=\"'+b+'\"]',d=a(c).parents(\"li\").addClass(\"active\");d.parent(\".dropdown-menu\").length&&(d=d.closest(\"li.dropdown\").addClass(\"active\")),\r\n    d.trigger(\"activate.bs.scrollspy\")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,\".active\").removeClass(\"active\")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on(\"load.bs.scrollspy.data-api\",function(){a('[data-spy=\"scroll\"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.tab\");e||d.data(\"bs.tab\",e=new c(this)),\"string\"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION=\"3.3.5\",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest(\"ul:not(.dropdown-menu)\"),d=b.data(\"target\");if(d||(d=b.attr(\"href\"),d=d&&d.replace(/.*(?=#[^\\s]*$)/,\"\")),!b.parent(\"li\").hasClass(\"active\")){var e=c.find(\".active:last a\"),f=a.Event(\"hide.bs.tab\",{relatedTarget:b[0]}),g=a.Event(\"show.bs.tab\",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest(\"li\"),c),this.activate(h,h.parent(),function(){e.trigger({type:\"hidden.bs.tab\",relatedTarget:b[0]}),b.trigger({type:\"shown.bs.tab\",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass(\"active\").find(\"> .dropdown-menu > .active\").removeClass(\"active\").end().find('[data-toggle=\"tab\"]').attr(\"aria-expanded\",!1),b.addClass(\"active\").find('[data-toggle=\"tab\"]').attr(\"aria-expanded\",!0),h?(b[0].offsetWidth,b.addClass(\"in\")):b.removeClass(\"fade\"),b.parent(\".dropdown-menu\").length&&b.closest(\"li.dropdown\").addClass(\"active\").end().find('[data-toggle=\"tab\"]').attr(\"aria-expanded\",!0),e&&e()}var g=d.find(\"> .active\"),h=e&&a.support.transition&&(g.length&&g.hasClass(\"fade\")||!!d.find(\"> .fade\").length);g.length&&h?g.one(\"bsTransitionEnd\",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass(\"in\")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),\"show\")};a(document).on(\"click.bs.tab.data-api\",'[data-toggle=\"tab\"]',e).on(\"click.bs.tab.data-api\",'[data-toggle=\"pill\"]',e)}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.affix\"),f=\"object\"==typeof b&&b;e||d.data(\"bs.affix\",e=new c(this,f)),\"string\"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on(\"scroll.bs.affix.data-api\",a.proxy(this.checkPosition,this)).on(\"click.bs.affix.data-api\",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION=\"3.3.5\",c.RESET=\"affix affix-top affix-bottom\",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&\"top\"==this.affixed)return c>e?\"top\":!1;if(\"bottom\"==this.affixed)return null!=c?e+this.unpin<=f.top?!1:\"bottom\":a-d>=e+g?!1:\"bottom\";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&c>=e?\"top\":null!=d&&i+j>=a-d?\"bottom\":!1},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass(\"affix\");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(\":visible\")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=Math.max(a(document).height(),a(document.body).height());\"object\"!=typeof d&&(f=e=d),\"function\"==typeof e&&(e=d.top(this.$element)),\"function\"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css(\"top\",\"\");var i=\"affix\"+(h?\"-\"+h:\"\"),j=a.Event(i+\".bs.affix\");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin=\"bottom\"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace(\"affix\",\"affixed\")+\".bs.affix\")}\"bottom\"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on(\"load\",function(){a('[data-spy=\"affix\"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery);\ndefine(\"bootstrap\", [\"jquery\"], function(){});\n\n",
    "/**\r\n * bootbox.js v4.4.0\r\n *\r\n * http://bootboxjs.com/license.txt\r\n */\r\n!function(a,b){\"use strict\";\"function\"==typeof define&&define.amd?define('bootbox',[\"jquery\"],b):\"object\"==typeof exports?module.exports=b(require(\"jquery\")):a.bootbox=b(a.jQuery)}(this,function a(b,c){\"use strict\";function d(a){var b=q[o.locale];return b?b[a]:q.en[a]}function e(a,c,d){a.stopPropagation(),a.preventDefault();var e=b.isFunction(d)&&d.call(c,a)===!1;e||c.modal(\"hide\")}function f(a){var b,c=0;for(b in a)c++;return c}function g(a,c){var d=0;b.each(a,function(a,b){c(a,b,d++)})}function h(a){var c,d;if(\"object\"!=typeof a)throw new Error(\"Please supply an object of options\");if(!a.message)throw new Error(\"Please specify a message\");return a=b.extend({},o,a),a.buttons||(a.buttons={}),c=a.buttons,d=f(c),g(c,function(a,e,f){if(b.isFunction(e)&&(e=c[a]={callback:e}),\"object\"!==b.type(e))throw new Error(\"button with key \"+a+\" must be an object\");e.label||(e.label=a),e.className||(e.className=2>=d&&f===d-1?\"btn-primary\":\"btn-default\")}),a}function i(a,b){var c=a.length,d={};if(1>c||c>2)throw new Error(\"Invalid argument length\");return 2===c||\"string\"==typeof a[0]?(d[b[0]]=a[0],d[b[1]]=a[1]):d=a[0],d}function j(a,c,d){return b.extend(!0,{},a,i(c,d))}function k(a,b,c,d){var e={className:\"bootbox-\"+a,buttons:l.apply(null,b)};return m(j(e,d,c),b)}function l(){for(var a={},b=0,c=arguments.length;c>b;b++){var e=arguments[b],f=e.toLowerCase(),g=e.toUpperCase();a[f]={label:d(g)}}return a}function m(a,b){var d={};return g(b,function(a,b){d[b]=!0}),g(a.buttons,function(a){if(d[a]===c)throw new Error(\"button key \"+a+\" is not allowed (options are \"+b.join(\"\\n\")+\")\")}),a}var n={dialog:\"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>\",header:\"<div class='modal-header'><h4 class='modal-title'></h4></div>\",footer:\"<div class='modal-footer'></div>\",closeButton:\"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>\",form:\"<form class='bootbox-form'></form>\",inputs:{text:\"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />\",textarea:\"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>\",email:\"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />\",select:\"<select class='bootbox-input bootbox-input-select form-control'></select>\",checkbox:\"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>\",date:\"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />\",time:\"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />\",number:\"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />\",password:\"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />\"}},o={locale:\"en\",backdrop:\"static\",animate:!0,className:null,closeButton:!0,show:!0,container:\"body\"},p={};p.alert=function(){var a;if(a=k(\"alert\",[\"ok\"],[\"message\",\"callback\"],arguments),a.callback&&!b.isFunction(a.callback))throw new Error(\"alert requires callback property to be a function when provided\");return a.buttons.ok.callback=a.onEscape=function(){return b.isFunction(a.callback)?a.callback.call(this):!0},p.dialog(a)},p.confirm=function(){var a;if(a=k(\"confirm\",[\"cancel\",\"confirm\"],[\"message\",\"callback\"],arguments),a.buttons.cancel.callback=a.onEscape=function(){return a.callback.call(this,!1)},a.buttons.confirm.callback=function(){return a.callback.call(this,!0)},!b.isFunction(a.callback))throw new Error(\"confirm requires a callback\");return p.dialog(a)},p.prompt=function(){var a,d,e,f,h,i,k;if(f=b(n.form),d={className:\"bootbox-prompt\",buttons:l(\"cancel\",\"confirm\"),value:\"\",inputType:\"text\"},a=m(j(d,arguments,[\"title\",\"callback\"]),[\"cancel\",\"confirm\"]),i=a.show===c?!0:a.show,a.message=f,a.buttons.cancel.callback=a.onEscape=function(){return a.callback.call(this,null)},a.buttons.confirm.callback=function(){var c;switch(a.inputType){case\"text\":case\"textarea\":case\"email\":case\"select\":case\"date\":case\"time\":case\"number\":case\"password\":c=h.val();break;case\"checkbox\":var d=h.find(\"input:checked\");c=[],g(d,function(a,d){c.push(b(d).val())})}return a.callback.call(this,c)},a.show=!1,!a.title)throw new Error(\"prompt requires a title\");if(!b.isFunction(a.callback))throw new Error(\"prompt requires a callback\");if(!n.inputs[a.inputType])throw new Error(\"invalid prompt type\");switch(h=b(n.inputs[a.inputType]),a.inputType){case\"text\":case\"textarea\":case\"email\":case\"date\":case\"time\":case\"number\":case\"password\":h.val(a.value);break;case\"select\":var o={};if(k=a.inputOptions||[],!b.isArray(k))throw new Error(\"Please pass an array of input options\");if(!k.length)throw new Error(\"prompt with select requires options\");g(k,function(a,d){var e=h;if(d.value===c||d.text===c)throw new Error(\"given options in wrong format\");d.group&&(o[d.group]||(o[d.group]=b(\"<optgroup/>\").attr(\"label\",d.group)),e=o[d.group]),e.append(\"<option value='\"+d.value+\"'>\"+d.text+\"</option>\")}),g(o,function(a,b){h.append(b)}),h.val(a.value);break;case\"checkbox\":var q=b.isArray(a.value)?a.value:[a.value];if(k=a.inputOptions||[],!k.length)throw new Error(\"prompt with checkbox requires options\");if(!k[0].value||!k[0].text)throw new Error(\"given options in wrong format\");h=b(\"<div/>\"),g(k,function(c,d){var e=b(n.inputs[a.inputType]);e.find(\"input\").attr(\"value\",d.value),e.find(\"label\").append(d.text),g(q,function(a,b){b===d.value&&e.find(\"input\").prop(\"checked\",!0)}),h.append(e)})}return a.placeholder&&h.attr(\"placeholder\",a.placeholder),a.pattern&&h.attr(\"pattern\",a.pattern),a.maxlength&&h.attr(\"maxlength\",a.maxlength),f.append(h),f.on(\"submit\",function(a){a.preventDefault(),a.stopPropagation(),e.find(\".btn-primary\").click()}),e=p.dialog(a),e.off(\"shown.bs.modal\"),e.on(\"shown.bs.modal\",function(){h.focus()}),i===!0&&e.modal(\"show\"),e},p.dialog=function(a){a=h(a);var d=b(n.dialog),f=d.find(\".modal-dialog\"),i=d.find(\".modal-body\"),j=a.buttons,k=\"\",l={onEscape:a.onEscape};if(b.fn.modal===c)throw new Error(\"$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details.\");if(g(j,function(a,b){k+=\"<button data-bb-handler='\"+a+\"' type='button' class='btn \"+b.className+\"'>\"+b.label+\"</button>\",l[a]=b.callback}),i.find(\".bootbox-body\").html(a.message),a.animate===!0&&d.addClass(\"fade\"),a.className&&d.addClass(a.className),\"large\"===a.size?f.addClass(\"modal-lg\"):\"small\"===a.size&&f.addClass(\"modal-sm\"),a.title&&i.before(n.header),a.closeButton){var m=b(n.closeButton);a.title?d.find(\".modal-header\").prepend(m):m.css(\"margin-top\",\"-10px\").prependTo(i)}return a.title&&d.find(\".modal-title\").html(a.title),k.length&&(i.after(n.footer),d.find(\".modal-footer\").html(k)),d.on(\"hidden.bs.modal\",function(a){a.target===this&&d.remove()}),d.on(\"shown.bs.modal\",function(){d.find(\".btn-primary:first\").focus()}),\"static\"!==a.backdrop&&d.on(\"click.dismiss.bs.modal\",function(a){d.children(\".modal-backdrop\").length&&(a.currentTarget=d.children(\".modal-backdrop\").get(0)),a.target===a.currentTarget&&d.trigger(\"escape.close.bb\")}),d.on(\"escape.close.bb\",function(a){l.onEscape&&e(a,d,l.onEscape)}),d.on(\"click\",\".modal-footer button\",function(a){var c=b(this).data(\"bb-handler\");e(a,d,l[c])}),d.on(\"click\",\".bootbox-close-button\",function(a){e(a,d,l.onEscape)}),d.on(\"keyup\",function(a){27===a.which&&d.trigger(\"escape.close.bb\")}),b(a.container).append(d),d.modal({backdrop:a.backdrop?\"static\":!1,keyboard:!1,show:!1}),a.show&&d.modal(\"show\"),d},p.setDefaults=function(){var a={};2===arguments.length?a[arguments[0]]=arguments[1]:a=arguments[0],b.extend(o,a)},p.hideAll=function(){return b(\".bootbox\").modal(\"hide\"),p};var q={bg_BG:{OK:\"Ок\",CANCEL:\"Отказ\",CONFIRM:\"Потвърждавам\"},br:{OK:\"OK\",CANCEL:\"Cancelar\",CONFIRM:\"Sim\"},cs:{OK:\"OK\",CANCEL:\"Zrušit\",CONFIRM:\"Potvrdit\"},da:{OK:\"OK\",CANCEL:\"Annuller\",CONFIRM:\"Accepter\"},de:{OK:\"OK\",CANCEL:\"Abbrechen\",CONFIRM:\"Akzeptieren\"},el:{OK:\"Εντάξει\",CANCEL:\"Ακύρωση\",CONFIRM:\"Επιβεβαίωση\"},en:{OK:\"OK\",CANCEL:\"Cancel\",CONFIRM:\"OK\"},es:{OK:\"OK\",CANCEL:\"Cancelar\",CONFIRM:\"Aceptar\"},et:{OK:\"OK\",CANCEL:\"Katkesta\",CONFIRM:\"OK\"},fa:{OK:\"قبول\",CANCEL:\"لغو\",CONFIRM:\"تایید\"},fi:{OK:\"OK\",CANCEL:\"Peruuta\",CONFIRM:\"OK\"},fr:{OK:\"OK\",CANCEL:\"Annuler\",CONFIRM:\"D'accord\"},he:{OK:\"אישור\",CANCEL:\"ביטול\",CONFIRM:\"אישור\"},hu:{OK:\"OK\",CANCEL:\"Mégsem\",CONFIRM:\"Megerősít\"},hr:{OK:\"OK\",CANCEL:\"Odustani\",CONFIRM:\"Potvrdi\"},id:{OK:\"OK\",CANCEL:\"Batal\",CONFIRM:\"OK\"},it:{OK:\"OK\",CANCEL:\"Annulla\",CONFIRM:\"Conferma\"},ja:{OK:\"OK\",CANCEL:\"キャンセル\",CONFIRM:\"確認\"},lt:{OK:\"Gerai\",CANCEL:\"Atšaukti\",CONFIRM:\"Patvirtinti\"},lv:{OK:\"Labi\",CANCEL:\"Atcelt\",CONFIRM:\"Apstiprināt\"},nl:{OK:\"OK\",CANCEL:\"Annuleren\",CONFIRM:\"Accepteren\"},no:{OK:\"OK\",CANCEL:\"Avbryt\",CONFIRM:\"OK\"},pl:{OK:\"OK\",CANCEL:\"Anuluj\",CONFIRM:\"Potwierdź\"},pt:{OK:\"OK\",CANCEL:\"Cancelar\",CONFIRM:\"Confirmar\"},ru:{OK:\"OK\",CANCEL:\"Отмена\",CONFIRM:\"Применить\"},sq:{OK:\"OK\",CANCEL:\"Anulo\",CONFIRM:\"Prano\"},sv:{OK:\"OK\",CANCEL:\"Avbryt\",CONFIRM:\"OK\"},th:{OK:\"ตกลง\",CANCEL:\"ยกเลิก\",CONFIRM:\"ยืนยัน\"},tr:{OK:\"Tamam\",CANCEL:\"İptal\",CONFIRM:\"Onayla\"},zh_CN:{OK:\"OK\",CANCEL:\"取消\",CONFIRM:\"确认\"},zh_TW:{OK:\"OK\",CANCEL:\"取消\",CONFIRM:\"確認\"}};return p.addLocale=function(a,c){return b.each([\"OK\",\"CANCEL\",\"CONFIRM\"],function(a,b){if(!c[b])throw new Error(\"Please supply a translation for '\"+b+\"'\")}),q[a]={OK:c.OK,CANCEL:c.CANCEL,CONFIRM:c.CONFIRM},p},p.removeLocale=function(a){return delete q[a],p},p.setLocale=function(a){return p.setDefaults(\"locale\",a)},p.init=function(c){return a(c||b)},p});\n",
    "/*!\r\n    localForage -- Offline Storage, Improved\r\n    Version 1.4.2\r\n    https://mozilla.github.io/localForage\r\n    (c) 2013-2015 Mozilla, Apache License 2.0\r\n*/\r\n!function(a){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=a();else if(\"function\"==typeof define&&define.amd)define('localForage',[],a);else{var b;b=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,b.localforage=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i=\"function\"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error(\"Cannot find module '\"+g+\"'\");throw j.code=\"MODULE_NOT_FOUND\",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f=\"function\"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(a){\"use strict\";function c(){k=!0;for(var a,b,c=l.length;c;){for(b=l,l=[],a=-1;++a<c;)b[a]();c=l.length}k=!1}function d(a){1!==l.push(a)||k||e()}var e,f=a.MutationObserver||a.WebKitMutationObserver;if(f){var g=0,h=new f(c),i=a.document.createTextNode(\"\");h.observe(i,{characterData:!0}),e=function(){i.data=g=++g%2}}else if(a.setImmediate||\"undefined\"==typeof a.MessageChannel)e=\"document\"in a&&\"onreadystatechange\"in a.document.createElement(\"script\")?function(){var b=a.document.createElement(\"script\");b.onreadystatechange=function(){c(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:function(){setTimeout(c,0)};else{var j=new a.MessageChannel;j.port1.onmessage=c,e=function(){j.port2.postMessage(0)}}var k,l=[];b.exports=d}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],2:[function(a,b,c){\"use strict\";function d(){}function e(a){if(\"function\"!=typeof a)throw new TypeError(\"resolver must be a function\");this.state=s,this.queue=[],this.outcome=void 0,a!==d&&i(this,a)}function f(a,b,c){this.promise=a,\"function\"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),\"function\"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}function g(a,b,c){o(function(){var d;try{d=b(c)}catch(e){return p.reject(a,e)}d===a?p.reject(a,new TypeError(\"Cannot resolve promise with itself\")):p.resolve(a,d)})}function h(a){var b=a&&a.then;return a&&\"object\"==typeof a&&\"function\"==typeof b?function(){b.apply(a,arguments)}:void 0}function i(a,b){function c(b){f||(f=!0,p.reject(a,b))}function d(b){f||(f=!0,p.resolve(a,b))}function e(){b(d,c)}var f=!1,g=j(e);\"error\"===g.status&&c(g.value)}function j(a,b){var c={};try{c.value=a(b),c.status=\"success\"}catch(d){c.status=\"error\",c.value=d}return c}function k(a){return a instanceof this?a:p.resolve(new this(d),a)}function l(a){var b=new this(d);return p.reject(b,a)}function m(a){function b(a,b){function d(a){g[b]=a,++h!==e||f||(f=!0,p.resolve(j,g))}c.resolve(a).then(d,function(a){f||(f=!0,p.reject(j,a))})}var c=this;if(\"[object Array]\"!==Object.prototype.toString.call(a))return this.reject(new TypeError(\"must be an array\"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=new Array(e),h=0,i=-1,j=new this(d);++i<e;)b(a[i],i);return j}function n(a){function b(a){c.resolve(a).then(function(a){f||(f=!0,p.resolve(h,a))},function(a){f||(f=!0,p.reject(h,a))})}var c=this;if(\"[object Array]\"!==Object.prototype.toString.call(a))return this.reject(new TypeError(\"must be an array\"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=-1,h=new this(d);++g<e;)b(a[g]);return h}var o=a(1),p={},q=[\"REJECTED\"],r=[\"FULFILLED\"],s=[\"PENDING\"];b.exports=c=e,e.prototype[\"catch\"]=function(a){return this.then(null,a)},e.prototype.then=function(a,b){if(\"function\"!=typeof a&&this.state===r||\"function\"!=typeof b&&this.state===q)return this;var c=new this.constructor(d);if(this.state!==s){var e=this.state===r?a:b;g(c,e,this.outcome)}else this.queue.push(new f(c,a,b));return c},f.prototype.callFulfilled=function(a){p.resolve(this.promise,a)},f.prototype.otherCallFulfilled=function(a){g(this.promise,this.onFulfilled,a)},f.prototype.callRejected=function(a){p.reject(this.promise,a)},f.prototype.otherCallRejected=function(a){g(this.promise,this.onRejected,a)},p.resolve=function(a,b){var c=j(h,b);if(\"error\"===c.status)return p.reject(a,c.value);var d=c.value;if(d)i(a,d);else{a.state=r,a.outcome=b;for(var e=-1,f=a.queue.length;++e<f;)a.queue[e].callFulfilled(b)}return a},p.reject=function(a,b){a.state=q,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a},c.resolve=k,c.reject=l,c.all=m,c.race=n},{1:1}],3:[function(a,b,c){(function(b){\"use strict\";\"function\"!=typeof b.Promise&&(b.Promise=a(2))}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{2:2}],4:[function(a,b,c){\"use strict\";function d(a,b){if(!(a instanceof b))throw new TypeError(\"Cannot call a class as a function\")}function e(){return\"undefined\"!=typeof indexedDB?indexedDB:\"undefined\"!=typeof webkitIndexedDB?webkitIndexedDB:\"undefined\"!=typeof mozIndexedDB?mozIndexedDB:\"undefined\"!=typeof OIndexedDB?OIndexedDB:\"undefined\"!=typeof msIndexedDB?msIndexedDB:void 0}function f(){try{return fa?\"undefined\"!=typeof openDatabase&&\"undefined\"!=typeof navigator&&navigator.userAgent&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)?!1:fa&&\"function\"==typeof fa.open&&\"undefined\"!=typeof IDBKeyRange:!1}catch(a){return!1}}function g(){return\"function\"==typeof openDatabase}function h(){try{return\"undefined\"!=typeof localStorage&&\"setItem\"in localStorage&&localStorage.setItem}catch(a){return!1}}function i(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(c){if(\"TypeError\"!==c.name)throw c;for(var d=\"undefined\"!=typeof BlobBuilder?BlobBuilder:\"undefined\"!=typeof MSBlobBuilder?MSBlobBuilder:\"undefined\"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,e=new d,f=0;f<a.length;f+=1)e.append(a[f]);return e.getBlob(b.type)}}function j(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}function k(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;b>e;e++)d[e]=a.charCodeAt(e);return c}function l(a){return new ia(function(b){var c=i([\"\"]);a.objectStore(ja).put(c,\"key\"),a.onabort=function(a){a.preventDefault(),a.stopPropagation(),b(!1)},a.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\\/(\\d+)/),c=navigator.userAgent.match(/Edge\\//);b(c||!a||parseInt(a[1],10)>=43)}})[\"catch\"](function(){return!1})}function m(a){return\"boolean\"==typeof ga?ia.resolve(ga):l(a).then(function(a){return ga=a})}function n(a){var b=ha[a.name],c={};c.promise=new ia(function(a){c.resolve=a}),b.deferredOperations.push(c),b.dbReady?b.dbReady=b.dbReady.then(function(){return c.promise}):b.dbReady=c.promise}function o(a){var b=ha[a.name],c=b.deferredOperations.pop();c&&c.resolve()}function p(a,b){return new ia(function(c,d){if(a.db){if(!b)return c(a.db);n(a),a.db.close()}var e=[a.name];b&&e.push(a.version);var f=fa.open.apply(fa,e);b&&(f.onupgradeneeded=function(b){var c=f.result;try{c.createObjectStore(a.storeName),b.oldVersion<=1&&c.createObjectStore(ja)}catch(d){if(\"ConstraintError\"!==d.name)throw d;console.warn('The database \"'+a.name+'\" has been upgraded from version '+b.oldVersion+\" to version \"+b.newVersion+', but the storage \"'+a.storeName+'\" already exists.')}}),f.onerror=function(){d(f.error)},f.onsuccess=function(){c(f.result),o(a)}})}function q(a){return p(a,!1)}function r(a){return p(a,!0)}function s(a,b){if(!a.db)return!0;var c=!a.db.objectStoreNames.contains(a.storeName),d=a.version<a.db.version,e=a.version>a.db.version;if(d&&(a.version!==b&&console.warn('The database \"'+a.name+\"\\\" can't be downgraded from version \"+a.db.version+\" to version \"+a.version+\".\"),a.version=a.db.version),e||c){if(c){var f=a.db.version+1;f>a.version&&(a.version=f)}return!0}return!1}function t(a){return new ia(function(b,c){var d=new FileReader;d.onerror=c,d.onloadend=function(c){var d=btoa(c.target.result||\"\");b({__local_forage_encoded_blob:!0,data:d,type:a.type})},d.readAsBinaryString(a)})}function u(a){var b=k(atob(a.data));return i([b],{type:a.type})}function v(a){return a&&a.__local_forage_encoded_blob}function w(a){var b=this,c=b._initReady().then(function(){var a=ha[b._dbInfo.name];return a&&a.dbReady?a.dbReady:void 0});return c.then(a,a),c}function x(a){function b(){return ia.resolve()}var c=this,d={db:null};if(a)for(var e in a)d[e]=a[e];ha||(ha={});var f=ha[d.name];f||(f={forages:[],db:null,dbReady:null,deferredOperations:[]},ha[d.name]=f),f.forages.push(c),c._initReady||(c._initReady=c.ready,c.ready=w);for(var g=[],h=0;h<f.forages.length;h++){var i=f.forages[h];i!==c&&g.push(i._initReady()[\"catch\"](b))}var j=f.forages.slice(0);return ia.all(g).then(function(){return d.db=f.db,q(d)}).then(function(a){return d.db=a,s(d,c._defaultConfig.version)?r(d):a}).then(function(a){d.db=f.db=a,c._dbInfo=d;for(var b=0;b<j.length;b++){var e=j[b];e!==c&&(e._dbInfo.db=d.db,e._dbInfo.version=d.version)}})}function y(a,b){var c=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var d=new ia(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,\"readonly\").objectStore(e.storeName),g=f.get(a);g.onsuccess=function(){var a=g.result;void 0===a&&(a=null),v(a)&&(a=u(a)),b(a)},g.onerror=function(){d(g.error)}})[\"catch\"](d)});return j(d,b),d}function z(a,b){var c=this,d=new ia(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,\"readonly\").objectStore(e.storeName),g=f.openCursor(),h=1;g.onsuccess=function(){var c=g.result;if(c){var d=c.value;v(d)&&(d=u(d));var e=a(d,c.key,h++);void 0!==e?b(e):c[\"continue\"]()}else b()},g.onerror=function(){d(g.error)}})[\"catch\"](d)});return j(d,b),d}function A(a,b,c){var d=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var e=new ia(function(c,e){var f;d.ready().then(function(){return f=d._dbInfo,b instanceof Blob?m(f.db).then(function(a){return a?b:t(b)}):b}).then(function(b){var d=f.db.transaction(f.storeName,\"readwrite\"),g=d.objectStore(f.storeName);null===b&&(b=void 0),d.oncomplete=function(){void 0===b&&(b=null),c(b)},d.onabort=d.onerror=function(){var a=h.error?h.error:h.transaction.error;e(a)};var h=g.put(b,a)})[\"catch\"](e)});return j(e,c),e}function B(a,b){var c=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var d=new ia(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,\"readwrite\"),g=f.objectStore(e.storeName),h=g[\"delete\"](a);f.oncomplete=function(){b()},f.onerror=function(){d(h.error)},f.onabort=function(){var a=h.error?h.error:h.transaction.error;d(a)}})[\"catch\"](d)});return j(d,b),d}function C(a){var b=this,c=new ia(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,\"readwrite\"),f=e.objectStore(d.storeName),g=f.clear();e.oncomplete=function(){a()},e.onabort=e.onerror=function(){var a=g.error?g.error:g.transaction.error;c(a)}})[\"catch\"](c)});return j(c,a),c}function D(a){var b=this,c=new ia(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,\"readonly\").objectStore(d.storeName),f=e.count();f.onsuccess=function(){a(f.result)},f.onerror=function(){c(f.error)}})[\"catch\"](c)});return j(c,a),c}function E(a,b){var c=this,d=new ia(function(b,d){return 0>a?void b(null):void c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,\"readonly\").objectStore(e.storeName),g=!1,h=f.openCursor();h.onsuccess=function(){var c=h.result;return c?void(0===a?b(c.key):g?b(c.key):(g=!0,c.advance(a))):void b(null)},h.onerror=function(){d(h.error)}})[\"catch\"](d)});return j(d,b),d}function F(a){var b=this,c=new ia(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,\"readonly\").objectStore(d.storeName),f=e.openCursor(),g=[];f.onsuccess=function(){var b=f.result;return b?(g.push(b.key),void b[\"continue\"]()):void a(g)},f.onerror=function(){c(f.error)}})[\"catch\"](c)});return j(c,a),c}function G(a){var b,c,d,e,f,g=.75*a.length,h=a.length,i=0;\"=\"===a[a.length-1]&&(g--,\"=\"===a[a.length-2]&&g--);var j=new ArrayBuffer(g),k=new Uint8Array(j);for(b=0;h>b;b+=4)c=la.indexOf(a[b]),d=la.indexOf(a[b+1]),e=la.indexOf(a[b+2]),f=la.indexOf(a[b+3]),k[i++]=c<<2|d>>4,k[i++]=(15&d)<<4|e>>2,k[i++]=(3&e)<<6|63&f;return j}function H(a){var b,c=new Uint8Array(a),d=\"\";for(b=0;b<c.length;b+=3)d+=la[c[b]>>2],d+=la[(3&c[b])<<4|c[b+1]>>4],d+=la[(15&c[b+1])<<2|c[b+2]>>6],d+=la[63&c[b+2]];return c.length%3===2?d=d.substring(0,d.length-1)+\"=\":c.length%3===1&&(d=d.substring(0,d.length-2)+\"==\"),d}function I(a,b){var c=\"\";if(a&&(c=a.toString()),a&&(\"[object ArrayBuffer]\"===a.toString()||a.buffer&&\"[object ArrayBuffer]\"===a.buffer.toString())){var d,e=oa;a instanceof ArrayBuffer?(d=a,e+=qa):(d=a.buffer,\"[object Int8Array]\"===c?e+=sa:\"[object Uint8Array]\"===c?e+=ta:\"[object Uint8ClampedArray]\"===c?e+=ua:\"[object Int16Array]\"===c?e+=va:\"[object Uint16Array]\"===c?e+=xa:\"[object Int32Array]\"===c?e+=wa:\"[object Uint32Array]\"===c?e+=ya:\"[object Float32Array]\"===c?e+=za:\"[object Float64Array]\"===c?e+=Aa:b(new Error(\"Failed to get type for BinaryArray\"))),b(e+H(d))}else if(\"[object Blob]\"===c){var f=new FileReader;f.onload=function(){var c=ma+a.type+\"~\"+H(this.result);b(oa+ra+c)},f.readAsArrayBuffer(a)}else try{b(JSON.stringify(a))}catch(g){console.error(\"Couldn't convert value into a JSON string: \",a),b(null,g)}}function J(a){if(a.substring(0,pa)!==oa)return JSON.parse(a);var b,c=a.substring(Ba),d=a.substring(pa,Ba);if(d===ra&&na.test(c)){var e=c.match(na);b=e[1],c=c.substring(e[0].length)}var f=G(c);switch(d){case qa:return f;case ra:return i([f],{type:b});case sa:return new Int8Array(f);case ta:return new Uint8Array(f);case ua:return new Uint8ClampedArray(f);case va:return new Int16Array(f);case xa:return new Uint16Array(f);case wa:return new Int32Array(f);case ya:return new Uint32Array(f);case za:return new Float32Array(f);case Aa:return new Float64Array(f);default:throw new Error(\"Unkown type: \"+d)}}function K(a){var b=this,c={db:null};if(a)for(var d in a)c[d]=\"string\"!=typeof a[d]?a[d].toString():a[d];var e=new ia(function(a,d){try{c.db=openDatabase(c.name,String(c.version),c.description,c.size)}catch(e){return d(e)}c.db.transaction(function(e){e.executeSql(\"CREATE TABLE IF NOT EXISTS \"+c.storeName+\" (id INTEGER PRIMARY KEY, key unique, value)\",[],function(){b._dbInfo=c,a()},function(a,b){d(b)})})});return c.serializer=Ca,e}function L(a,b){var c=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var d=new ia(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql(\"SELECT * FROM \"+e.storeName+\" WHERE key = ? LIMIT 1\",[a],function(a,c){var d=c.rows.length?c.rows.item(0).value:null;d&&(d=e.serializer.deserialize(d)),b(d)},function(a,b){d(b)})})})[\"catch\"](d)});return j(d,b),d}function M(a,b){var c=this,d=new ia(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql(\"SELECT * FROM \"+e.storeName,[],function(c,d){for(var f=d.rows,g=f.length,h=0;g>h;h++){var i=f.item(h),j=i.value;if(j&&(j=e.serializer.deserialize(j)),j=a(j,i.key,h+1),void 0!==j)return void b(j)}b()},function(a,b){d(b)})})})[\"catch\"](d)});return j(d,b),d}function N(a,b,c){var d=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var e=new ia(function(c,e){d.ready().then(function(){void 0===b&&(b=null);var f=b,g=d._dbInfo;g.serializer.serialize(b,function(b,d){d?e(d):g.db.transaction(function(d){d.executeSql(\"INSERT OR REPLACE INTO \"+g.storeName+\" (key, value) VALUES (?, ?)\",[a,b],function(){c(f)},function(a,b){e(b)})},function(a){a.code===a.QUOTA_ERR&&e(a)})})})[\"catch\"](e)});return j(e,c),e}function O(a,b){var c=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var d=new ia(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql(\"DELETE FROM \"+e.storeName+\" WHERE key = ?\",[a],function(){b()},function(a,b){d(b)})})})[\"catch\"](d)});return j(d,b),d}function P(a){var b=this,c=new ia(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql(\"DELETE FROM \"+d.storeName,[],function(){a()},function(a,b){c(b)})})})[\"catch\"](c)});return j(c,a),c}function Q(a){var b=this,c=new ia(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql(\"SELECT COUNT(key) as c FROM \"+d.storeName,[],function(b,c){var d=c.rows.item(0).c;a(d)},function(a,b){c(b)})})})[\"catch\"](c)});return j(c,a),c}function R(a,b){var c=this,d=new ia(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql(\"SELECT key FROM \"+e.storeName+\" WHERE id = ? LIMIT 1\",[a+1],function(a,c){var d=c.rows.length?c.rows.item(0).key:null;b(d)},function(a,b){d(b)})})})[\"catch\"](d)});return j(d,b),d}function S(a){var b=this,c=new ia(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql(\"SELECT key FROM \"+d.storeName,[],function(b,c){for(var d=[],e=0;e<c.rows.length;e++)d.push(c.rows.item(e).key);a(d)},function(a,b){c(b)})})})[\"catch\"](c)});return j(c,a),c}function T(a){var b=this,c={};if(a)for(var d in a)c[d]=a[d];return c.keyPrefix=c.name+\"/\",c.storeName!==b._defaultConfig.storeName&&(c.keyPrefix+=c.storeName+\"/\"),b._dbInfo=c,c.serializer=Ca,ia.resolve()}function U(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var d=localStorage.key(c);0===d.indexOf(a)&&localStorage.removeItem(d)}});return j(c,a),c}function V(a,b){var c=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var d=c.ready().then(function(){var b=c._dbInfo,d=localStorage.getItem(b.keyPrefix+a);return d&&(d=b.serializer.deserialize(d)),d});return j(d,b),d}function W(a,b){var c=this,d=c.ready().then(function(){for(var b=c._dbInfo,d=b.keyPrefix,e=d.length,f=localStorage.length,g=1,h=0;f>h;h++){var i=localStorage.key(h);if(0===i.indexOf(d)){var j=localStorage.getItem(i);if(j&&(j=b.serializer.deserialize(j)),j=a(j,i.substring(e),g++),void 0!==j)return j}}});return j(d,b),d}function X(a,b){var c=this,d=c.ready().then(function(){var b,d=c._dbInfo;try{b=localStorage.key(a)}catch(e){b=null}return b&&(b=b.substring(d.keyPrefix.length)),b});return j(d,b),d}function Y(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo,c=localStorage.length,d=[],e=0;c>e;e++)0===localStorage.key(e).indexOf(a.keyPrefix)&&d.push(localStorage.key(e).substring(a.keyPrefix.length));return d});return j(c,a),c}function Z(a){var b=this,c=b.keys().then(function(a){return a.length});return j(c,a),c}function $(a,b){var c=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var d=c.ready().then(function(){var b=c._dbInfo;localStorage.removeItem(b.keyPrefix+a)});return j(d,b),d}function _(a,b,c){var d=this;\"string\"!=typeof a&&(console.warn(a+\" used as a key, but it is not a string.\"),a=String(a));var e=d.ready().then(function(){void 0===b&&(b=null);var c=b;return new ia(function(e,f){var g=d._dbInfo;g.serializer.serialize(b,function(b,d){if(d)f(d);else try{localStorage.setItem(g.keyPrefix+a,b),e(c)}catch(h){\"QuotaExceededError\"!==h.name&&\"NS_ERROR_DOM_QUOTA_REACHED\"!==h.name||f(h),f(h)}})})});return j(e,c),e}function aa(a,b,c){\"function\"==typeof b&&a.then(b),\"function\"==typeof c&&a[\"catch\"](c)}function ba(a,b){a[b]=function(){var c=arguments;return a.ready().then(function(){return a[b].apply(a,c)})}}function ca(){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var c in b)b.hasOwnProperty(c)&&(La(b[c])?arguments[0][c]=b[c].slice():arguments[0][c]=b[c])}return arguments[0]}function da(a){for(var b in Ga)if(Ga.hasOwnProperty(b)&&Ga[b]===a)return!0;return!1}var ea=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&\"function\"==typeof Symbol&&a.constructor===Symbol?\"symbol\":typeof a},fa=e();\"undefined\"==typeof Promise&&\"undefined\"!=typeof a&&a(3);var ga,ha,ia=Promise,ja=\"local-forage-detect-blob-support\",ka={_driver:\"asyncStorage\",_initStorage:x,iterate:z,getItem:y,setItem:A,removeItem:B,clear:C,length:D,key:E,keys:F},la=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",ma=\"~~local_forage_type~\",na=/^~~local_forage_type~([^~]+)~/,oa=\"__lfsc__:\",pa=oa.length,qa=\"arbf\",ra=\"blob\",sa=\"si08\",ta=\"ui08\",ua=\"uic8\",va=\"si16\",wa=\"si32\",xa=\"ur16\",ya=\"ui32\",za=\"fl32\",Aa=\"fl64\",Ba=pa+qa.length,Ca={serialize:I,deserialize:J,stringToBuffer:G,bufferToString:H},Da={_driver:\"webSQLStorage\",_initStorage:K,iterate:M,getItem:L,setItem:N,removeItem:O,clear:P,length:Q,key:R,keys:S},Ea={_driver:\"localStorageWrapper\",_initStorage:T,iterate:W,getItem:V,setItem:_,removeItem:$,clear:U,length:Z,key:X,keys:Y},Fa={},Ga={INDEXEDDB:\"asyncStorage\",LOCALSTORAGE:\"localStorageWrapper\",WEBSQL:\"webSQLStorage\"},Ha=[Ga.INDEXEDDB,Ga.WEBSQL,Ga.LOCALSTORAGE],Ia=[\"clear\",\"getItem\",\"iterate\",\"key\",\"keys\",\"length\",\"removeItem\",\"setItem\"],Ja={description:\"\",driver:Ha.slice(),name:\"localforage\",size:4980736,storeName:\"keyvaluepairs\",version:1},Ka={};Ka[Ga.INDEXEDDB]=f(),Ka[Ga.WEBSQL]=g(),Ka[Ga.LOCALSTORAGE]=h();var La=Array.isArray||function(a){return\"[object Array]\"===Object.prototype.toString.call(a)},Ma=function(){function a(b){d(this,a),this.INDEXEDDB=Ga.INDEXEDDB,this.LOCALSTORAGE=Ga.LOCALSTORAGE,this.WEBSQL=Ga.WEBSQL,this._defaultConfig=ca({},Ja),this._config=ca({},this._defaultConfig,b),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return a.prototype.config=function(a){if(\"object\"===(\"undefined\"==typeof a?\"undefined\":ea(a))){if(this._ready)return new Error(\"Can't call config() after localforage has been used.\");for(var b in a)\"storeName\"===b&&(a[b]=a[b].replace(/\\W/g,\"_\")),this._config[b]=a[b];return\"driver\"in a&&a.driver&&this.setDriver(this._config.driver),!0}return\"string\"==typeof a?this._config[a]:this._config},a.prototype.defineDriver=function(a,b,c){var d=new ia(function(b,c){try{var d=a._driver,e=new Error(\"Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver\"),f=new Error(\"Custom driver name already in use: \"+a._driver);if(!a._driver)return void c(e);if(da(a._driver))return void c(f);for(var g=Ia.concat(\"_initStorage\"),h=0;h<g.length;h++){var i=g[h];if(!i||!a[i]||\"function\"!=typeof a[i])return void c(e)}var j=ia.resolve(!0);\"_support\"in a&&(j=a._support&&\"function\"==typeof a._support?a._support():ia.resolve(!!a._support)),j.then(function(c){Ka[d]=c,Fa[d]=a,b()},c)}catch(k){c(k)}});return aa(d,b,c),d},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(a,b,c){var d=this,e=ia.resolve().then(function(){if(!da(a)){if(Fa[a])return Fa[a];throw new Error(\"Driver not found.\")}switch(a){case d.INDEXEDDB:return ka;case d.LOCALSTORAGE:return Ea;case d.WEBSQL:return Da}});return aa(e,b,c),e},a.prototype.getSerializer=function(a){var b=ia.resolve(Ca);return aa(b,a),b},a.prototype.ready=function(a){var b=this,c=b._driverSet.then(function(){return null===b._ready&&(b._ready=b._initDriver()),b._ready});return aa(c,a,a),c},a.prototype.setDriver=function(a,b,c){function d(){f._config.driver=f.driver()}function e(a){return function(){function b(){for(;c<a.length;){var e=a[c];return c++,f._dbInfo=null,f._ready=null,f.getDriver(e).then(function(a){return f._extend(a),d(),f._ready=f._initStorage(f._config),f._ready})[\"catch\"](b)}d();var g=new Error(\"No available storage method found.\");return f._driverSet=ia.reject(g),f._driverSet}var c=0;return b()}}var f=this;La(a)||(a=[a]);var g=this._getSupportedDrivers(a),h=null!==this._driverSet?this._driverSet[\"catch\"](function(){return ia.resolve()}):ia.resolve();return this._driverSet=h.then(function(){var a=g[0];return f._dbInfo=null,f._ready=null,f.getDriver(a).then(function(a){f._driver=a._driver,d(),f._wrapLibraryMethodsWithReady(),f._initDriver=e(g)})})[\"catch\"](function(){d();var a=new Error(\"No available storage method found.\");return f._driverSet=ia.reject(a),f._driverSet}),aa(this._driverSet,b,c),this._driverSet},a.prototype.supports=function(a){return!!Ka[a]},a.prototype._extend=function(a){ca(this,a)},a.prototype._getSupportedDrivers=function(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];this.supports(e)&&b.push(e)}return b},a.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0;a<Ia.length;a++)ba(this,Ia[a])},a.prototype.createInstance=function(b){return new a(b)},a}(),Na=new Ma;b.exports=Na},{3:3}]},{},[4])(4)});\n",
    "/*! VelocityJS.org (1.2.3). (C) 2014 Julian Shapiro. MIT @license: en.wikipedia.org/wiki/MIT_License */\r\n/*! VelocityJS.org jQuery Shim (1.0.1). (C) 2014 The jQuery Foundation. MIT @license: en.wikipedia.org/wiki/MIT_License. */\r\n!function(a){function b(a){var b=a.length,d=c.type(a);return\"function\"===d||c.isWindow(a)?!1:1===a.nodeType&&b?!0:\"array\"===d||0===b||\"number\"==typeof b&&b>0&&b-1 in a}if(!a.jQuery){var c=function(a,b){return new c.fn.init(a,b)};c.isWindow=function(a){return null!=a&&a==a.window},c.type=function(a){return null==a?a+\"\":\"object\"==typeof a||\"function\"==typeof a?e[g.call(a)]||\"object\":typeof a},c.isArray=Array.isArray||function(a){return\"array\"===c.type(a)},c.isPlainObject=function(a){var b;if(!a||\"object\"!==c.type(a)||a.nodeType||c.isWindow(a))return!1;try{if(a.constructor&&!f.call(a,\"constructor\")&&!f.call(a.constructor.prototype,\"isPrototypeOf\"))return!1}catch(d){return!1}for(b in a);return void 0===b||f.call(a,b)},c.each=function(a,c,d){var e,f=0,g=a.length,h=b(a);if(d){if(h)for(;g>f&&(e=c.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=c.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=c.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=c.call(a[f],f,a[f]),e===!1)break;return a},c.data=function(a,b,e){if(void 0===e){var f=a[c.expando],g=f&&d[f];if(void 0===b)return g;if(g&&b in g)return g[b]}else if(void 0!==b){var f=a[c.expando]||(a[c.expando]=++c.uuid);return d[f]=d[f]||{},d[f][b]=e,e}},c.removeData=function(a,b){var e=a[c.expando],f=e&&d[e];f&&c.each(b,function(a,b){delete f[b]})},c.extend=function(){var a,b,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for(\"boolean\"==typeof h&&(k=h,h=arguments[i]||{},i++),\"object\"!=typeof h&&\"function\"!==c.type(h)&&(h={}),i===j&&(h=this,i--);j>i;i++)if(null!=(f=arguments[i]))for(e in f)a=h[e],d=f[e],h!==d&&(k&&d&&(c.isPlainObject(d)||(b=c.isArray(d)))?(b?(b=!1,g=a&&c.isArray(a)?a:[]):g=a&&c.isPlainObject(a)?a:{},h[e]=c.extend(k,g,d)):void 0!==d&&(h[e]=d));return h},c.queue=function(a,d,e){function f(a,c){var d=c||[];return null!=a&&(b(Object(a))?!function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a}(d,\"string\"==typeof a?[a]:a):[].push.call(d,a)),d}if(a){d=(d||\"fx\")+\"queue\";var g=c.data(a,d);return e?(!g||c.isArray(e)?g=c.data(a,d,f(e)):g.push(e),g):g||[]}},c.dequeue=function(a,b){c.each(a.nodeType?[a]:a,function(a,d){b=b||\"fx\";var e=c.queue(d,b),f=e.shift();\"inprogress\"===f&&(f=e.shift()),f&&(\"fx\"===b&&e.unshift(\"inprogress\"),f.call(d,function(){c.dequeue(d,b)}))})},c.fn=c.prototype={init:function(a){if(a.nodeType)return this[0]=a,this;throw new Error(\"Not a DOM node.\")},offset:function(){var b=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:b.top+(a.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:b.left+(a.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function a(){for(var a=this.offsetParent||document;a&&\"html\"===!a.nodeType.toLowerCase&&\"static\"===a.style.position;)a=a.offsetParent;return a||document}var b=this[0],a=a.apply(b),d=this.offset(),e=/^(?:body|html)$/i.test(a.nodeName)?{top:0,left:0}:c(a).offset();return d.top-=parseFloat(b.style.marginTop)||0,d.left-=parseFloat(b.style.marginLeft)||0,a.style&&(e.top+=parseFloat(a.style.borderTopWidth)||0,e.left+=parseFloat(a.style.borderLeftWidth)||0),{top:d.top-e.top,left:d.left-e.left}}};var d={};c.expando=\"velocity\"+(new Date).getTime(),c.uuid=0;for(var e={},f=e.hasOwnProperty,g=e.toString,h=\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"),i=0;i<h.length;i++)e[\"[object \"+h[i]+\"]\"]=h[i].toLowerCase();c.fn.init.prototype=c.fn,a.Velocity={Utilities:c}}}(window),function(a){\"object\"==typeof module&&\"object\"==typeof module.exports?module.exports=a():\"function\"==typeof define&&define.amd?define('velocity',a):a()}(function(){return function(a,b,c,d){function e(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d}function f(a){return p.isWrapped(a)?a=[].slice.call(a):p.isNode(a)&&(a=[a]),a}function g(a){var b=m.data(a,\"velocity\");return null===b?d:b}function h(a){return function(b){return Math.round(b*a)*(1/a)}}function i(a,c,d,e){function f(a,b){return 1-3*b+3*a}function g(a,b){return 3*b-6*a}function h(a){return 3*a}function i(a,b,c){return((f(b,c)*a+g(b,c))*a+h(b))*a}function j(a,b,c){return 3*f(b,c)*a*a+2*g(b,c)*a+h(b)}function k(b,c){for(var e=0;p>e;++e){var f=j(c,a,d);if(0===f)return c;var g=i(c,a,d)-b;c-=g/f}return c}function l(){for(var b=0;t>b;++b)x[b]=i(b*u,a,d)}function m(b,c,e){var f,g,h=0;do g=c+(e-c)/2,f=i(g,a,d)-b,f>0?e=g:c=g;while(Math.abs(f)>r&&++h<s);return g}function n(b){for(var c=0,e=1,f=t-1;e!=f&&x[e]<=b;++e)c+=u;--e;var g=(b-x[e])/(x[e+1]-x[e]),h=c+g*u,i=j(h,a,d);return i>=q?k(b,h):0==i?h:m(b,c,c+u)}function o(){y=!0,(a!=c||d!=e)&&l()}var p=4,q=.001,r=1e-7,s=10,t=11,u=1/(t-1),v=\"Float32Array\"in b;if(4!==arguments.length)return!1;for(var w=0;4>w;++w)if(\"number\"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;a=Math.min(a,1),d=Math.min(d,1),a=Math.max(a,0),d=Math.max(d,0);var x=v?new Float32Array(t):new Array(t),y=!1,z=function(b){return y||o(),a===c&&d===e?b:0===b?0:1===b?1:i(n(b),c,e)};z.getControlPoints=function(){return[{x:a,y:c},{x:d,y:e}]};var A=\"generateBezier(\"+[a,c,d,e]+\")\";return z.toString=function(){return A},z}function j(a,b){var c=a;return p.isString(a)?t.Easings[a]||(c=!1):c=p.isArray(a)&&1===a.length?h.apply(null,a):p.isArray(a)&&2===a.length?u.apply(null,a.concat([b])):p.isArray(a)&&4===a.length?i.apply(null,a):!1,c===!1&&(c=t.Easings[t.defaults.easing]?t.defaults.easing:s),c}function k(a){if(a){var b=(new Date).getTime(),c=t.State.calls.length;c>1e4&&(t.State.calls=e(t.State.calls));for(var f=0;c>f;f++)if(t.State.calls[f]){var h=t.State.calls[f],i=h[0],j=h[2],n=h[3],o=!!n,q=null;n||(n=t.State.calls[f][3]=b-16);for(var r=Math.min((b-n)/j.duration,1),s=0,u=i.length;u>s;s++){var w=i[s],y=w.element;if(g(y)){var z=!1;if(j.display!==d&&null!==j.display&&\"none\"!==j.display){if(\"flex\"===j.display){var A=[\"-webkit-box\",\"-moz-box\",\"-ms-flexbox\",\"-webkit-flex\"];m.each(A,function(a,b){v.setPropertyValue(y,\"display\",b)})}v.setPropertyValue(y,\"display\",j.display)}j.visibility!==d&&\"hidden\"!==j.visibility&&v.setPropertyValue(y,\"visibility\",j.visibility);for(var B in w)if(\"element\"!==B){var C,D=w[B],E=p.isString(D.easing)?t.Easings[D.easing]:D.easing;if(1===r)C=D.endValue;else{var F=D.endValue-D.startValue;if(C=D.startValue+F*E(r,j,F),!o&&C===D.currentValue)continue}if(D.currentValue=C,\"tween\"===B)q=C;else{if(v.Hooks.registered[B]){var G=v.Hooks.getRoot(B),H=g(y).rootPropertyValueCache[G];H&&(D.rootPropertyValue=H)}var I=v.setPropertyValue(y,B,D.currentValue+(0===parseFloat(C)?\"\":D.unitType),D.rootPropertyValue,D.scrollData);v.Hooks.registered[B]&&(g(y).rootPropertyValueCache[G]=v.Normalizations.registered[G]?v.Normalizations.registered[G](\"extract\",null,I[1]):I[1]),\"transform\"===I[0]&&(z=!0)}}j.mobileHA&&g(y).transformCache.translate3d===d&&(g(y).transformCache.translate3d=\"(0px, 0px, 0px)\",z=!0),z&&v.flushTransformCache(y)}}j.display!==d&&\"none\"!==j.display&&(t.State.calls[f][2].display=!1),j.visibility!==d&&\"hidden\"!==j.visibility&&(t.State.calls[f][2].visibility=!1),j.progress&&j.progress.call(h[1],h[1],r,Math.max(0,n+j.duration-b),n,q),1===r&&l(f)}}t.State.isTicking&&x(k)}function l(a,b){if(!t.State.calls[a])return!1;for(var c=t.State.calls[a][0],e=t.State.calls[a][1],f=t.State.calls[a][2],h=t.State.calls[a][4],i=!1,j=0,k=c.length;k>j;j++){var l=c[j].element;if(b||f.loop||(\"none\"===f.display&&v.setPropertyValue(l,\"display\",f.display),\"hidden\"===f.visibility&&v.setPropertyValue(l,\"visibility\",f.visibility)),f.loop!==!0&&(m.queue(l)[1]===d||!/\\.velocityQueueEntryFlag/i.test(m.queue(l)[1]))&&g(l)){g(l).isAnimating=!1,g(l).rootPropertyValueCache={};var n=!1;m.each(v.Lists.transforms3D,function(a,b){var c=/^scale/.test(b)?1:0,e=g(l).transformCache[b];g(l).transformCache[b]!==d&&new RegExp(\"^\\\\(\"+c+\"[^.]\").test(e)&&(n=!0,delete g(l).transformCache[b])}),f.mobileHA&&(n=!0,delete g(l).transformCache.translate3d),n&&v.flushTransformCache(l),v.Values.removeClass(l,\"velocity-animating\")}if(!b&&f.complete&&!f.loop&&j===k-1)try{f.complete.call(e,e)}catch(o){setTimeout(function(){throw o},1)}h&&f.loop!==!0&&h(e),g(l)&&f.loop===!0&&!b&&(m.each(g(l).tweensContainer,function(a,b){/^rotate/.test(a)&&360===parseFloat(b.endValue)&&(b.endValue=0,b.startValue=360),/^backgroundPosition/.test(a)&&100===parseFloat(b.endValue)&&\"%\"===b.unitType&&(b.endValue=0,b.startValue=100)}),t(l,\"reverse\",{loop:!0,delay:f.delay})),f.queue!==!1&&m.dequeue(l,f.queue)}t.State.calls[a]=!1;for(var p=0,q=t.State.calls.length;q>p;p++)if(t.State.calls[p]!==!1){i=!0;break}i===!1&&(t.State.isTicking=!1,delete t.State.calls,t.State.calls=[])}var m,n=function(){if(c.documentMode)return c.documentMode;for(var a=7;a>4;a--){var b=c.createElement(\"div\");if(b.innerHTML=\"<!--[if IE \"+a+\"]><span></span><![endif]-->\",b.getElementsByTagName(\"span\").length)return b=null,a}return d}(),o=function(){var a=0;return b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||function(b){var c,d=(new Date).getTime();return c=Math.max(0,16-(d-a)),a=d+c,setTimeout(function(){b(d+c)},c)}}(),p={isString:function(a){return\"string\"==typeof a},isArray:Array.isArray||function(a){return\"[object Array]\"===Object.prototype.toString.call(a)},isFunction:function(a){return\"[object Function]\"===Object.prototype.toString.call(a)},isNode:function(a){return a&&a.nodeType},isNodeList:function(a){return\"object\"==typeof a&&/^\\[object (HTMLCollection|NodeList|Object)\\]$/.test(Object.prototype.toString.call(a))&&a.length!==d&&(0===a.length||\"object\"==typeof a[0]&&a[0].nodeType>0)},isWrapped:function(a){return a&&(a.jquery||b.Zepto&&b.Zepto.zepto.isZ(a))},isSVG:function(a){return b.SVGElement&&a instanceof b.SVGElement},isEmptyObject:function(a){for(var b in a)return!1;return!0}},q=!1;if(a.fn&&a.fn.jquery?(m=a,q=!0):m=b.Velocity.Utilities,8>=n&&!q)throw new Error(\"Velocity: IE8 and below require jQuery to be loaded before Velocity.\");if(7>=n)return void(jQuery.fn.velocity=jQuery.fn.animate);var r=400,s=\"swing\",t={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\\.3\\.[3-7]/i.test(navigator.userAgent),isChrome:b.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:c.createElement(\"div\"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:m,Redirects:{},Easings:{},Promise:b.Promise,defaults:{queue:\"\",duration:r,easing:s,begin:d,complete:d,progress:d,display:d,visibility:d,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(a){m.data(a,\"velocity\",{isSVG:p.isSVG(a),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};b.pageYOffset!==d?(t.State.scrollAnchor=b,t.State.scrollPropertyLeft=\"pageXOffset\",t.State.scrollPropertyTop=\"pageYOffset\"):(t.State.scrollAnchor=c.documentElement||c.body.parentNode||c.body,t.State.scrollPropertyLeft=\"scrollLeft\",t.State.scrollPropertyTop=\"scrollTop\");var u=function(){function a(a){return-a.tension*a.x-a.friction*a.v}function b(b,c,d){var e={x:b.x+d.dx*c,v:b.v+d.dv*c,tension:b.tension,friction:b.friction};return{dx:e.v,dv:a(e)}}function c(c,d){var e={dx:c.v,dv:a(c)},f=b(c,.5*d,e),g=b(c,.5*d,f),h=b(c,d,g),i=1/6*(e.dx+2*(f.dx+g.dx)+h.dx),j=1/6*(e.dv+2*(f.dv+g.dv)+h.dv);return c.x=c.x+i*d,c.v=c.v+j*d,c}return function d(a,b,e){var f,g,h,i={x:-1,v:0,tension:null,friction:null},j=[0],k=0,l=1e-4,m=.016;for(a=parseFloat(a)||500,b=parseFloat(b)||20,e=e||null,i.tension=a,i.friction=b,f=null!==e,f?(k=d(a,b),g=k/e*m):g=m;;)if(h=c(h||i,g),j.push(1+h.x),k+=16,!(Math.abs(h.x)>l&&Math.abs(h.v)>l))break;return f?function(a){return j[a*(j.length-1)|0]}:k}}();t.Easings={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)}},m.each([[\"ease\",[.25,.1,.25,1]],[\"ease-in\",[.42,0,1,1]],[\"ease-out\",[0,0,.58,1]],[\"ease-in-out\",[.42,0,.58,1]],[\"easeInSine\",[.47,0,.745,.715]],[\"easeOutSine\",[.39,.575,.565,1]],[\"easeInOutSine\",[.445,.05,.55,.95]],[\"easeInQuad\",[.55,.085,.68,.53]],[\"easeOutQuad\",[.25,.46,.45,.94]],[\"easeInOutQuad\",[.455,.03,.515,.955]],[\"easeInCubic\",[.55,.055,.675,.19]],[\"easeOutCubic\",[.215,.61,.355,1]],[\"easeInOutCubic\",[.645,.045,.355,1]],[\"easeInQuart\",[.895,.03,.685,.22]],[\"easeOutQuart\",[.165,.84,.44,1]],[\"easeInOutQuart\",[.77,0,.175,1]],[\"easeInQuint\",[.755,.05,.855,.06]],[\"easeOutQuint\",[.23,1,.32,1]],[\"easeInOutQuint\",[.86,0,.07,1]],[\"easeInExpo\",[.95,.05,.795,.035]],[\"easeOutExpo\",[.19,1,.22,1]],[\"easeInOutExpo\",[1,0,0,1]],[\"easeInCirc\",[.6,.04,.98,.335]],[\"easeOutCirc\",[.075,.82,.165,1]],[\"easeInOutCirc\",[.785,.135,.15,.86]]],function(a,b){t.Easings[b[0]]=i.apply(null,b[1])});var v=t.CSS={RegEx:{isHex:/^#([A-f\\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\\((.*)\\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\\(.+\\))|(([A-z0-9#-.]+?)(?=\\s|$))/gi},Lists:{colors:[\"fill\",\"stroke\",\"stopColor\",\"color\",\"backgroundColor\",\"borderColor\",\"borderTopColor\",\"borderRightColor\",\"borderBottomColor\",\"borderLeftColor\",\"outlineColor\"],transformsBase:[\"translateX\",\"translateY\",\"scale\",\"scaleX\",\"scaleY\",\"skewX\",\"skewY\",\"rotateZ\"],transforms3D:[\"transformPerspective\",\"translateZ\",\"scaleZ\",\"rotateX\",\"rotateY\"]},Hooks:{templates:{textShadow:[\"Color X Y Blur\",\"black 0px 0px 0px\"],boxShadow:[\"Color X Y Blur Spread\",\"black 0px 0px 0px 0px\"],clip:[\"Top Right Bottom Left\",\"0px 0px 0px 0px\"],backgroundPosition:[\"X Y\",\"0% 0%\"],transformOrigin:[\"X Y Z\",\"50% 50% 0px\"],perspectiveOrigin:[\"X Y\",\"50% 50%\"]},registered:{},register:function(){for(var a=0;a<v.Lists.colors.length;a++){var b=\"color\"===v.Lists.colors[a]?\"0 0 0 1\":\"255 255 255 1\";v.Hooks.templates[v.Lists.colors[a]]=[\"Red Green Blue Alpha\",b]}var c,d,e;if(n)for(c in v.Hooks.templates){d=v.Hooks.templates[c],e=d[0].split(\" \");var f=d[1].match(v.RegEx.valueSplit);\"Color\"===e[0]&&(e.push(e.shift()),f.push(f.shift()),v.Hooks.templates[c]=[e.join(\" \"),f.join(\" \")])}for(c in v.Hooks.templates){d=v.Hooks.templates[c],e=d[0].split(\" \");for(var a in e){var g=c+e[a],h=a;v.Hooks.registered[g]=[c,h]}}},getRoot:function(a){var b=v.Hooks.registered[a];return b?b[0]:a},cleanRootPropertyValue:function(a,b){return v.RegEx.valueUnwrap.test(b)&&(b=b.match(v.RegEx.valueUnwrap)[1]),v.Values.isCSSNullValue(b)&&(b=v.Hooks.templates[a][1]),b},extractValue:function(a,b){var c=v.Hooks.registered[a];if(c){var d=c[0],e=c[1];return b=v.Hooks.cleanRootPropertyValue(d,b),b.toString().match(v.RegEx.valueSplit)[e]}return b},injectValue:function(a,b,c){var d=v.Hooks.registered[a];if(d){var e,f,g=d[0],h=d[1];return c=v.Hooks.cleanRootPropertyValue(g,c),e=c.toString().match(v.RegEx.valueSplit),e[h]=b,f=e.join(\" \")}return c}},Normalizations:{registered:{clip:function(a,b,c){switch(a){case\"name\":return\"clip\";case\"extract\":var d;return v.RegEx.wrappedValueAlreadyExtracted.test(c)?d=c:(d=c.toString().match(v.RegEx.valueUnwrap),d=d?d[1].replace(/,(\\s+)?/g,\" \"):c),d;case\"inject\":return\"rect(\"+c+\")\"}},blur:function(a,b,c){switch(a){case\"name\":return t.State.isFirefox?\"filter\":\"-webkit-filter\";case\"extract\":var d=parseFloat(c);if(!d&&0!==d){var e=c.toString().match(/blur\\(([0-9]+[A-z]+)\\)/i);d=e?e[1]:0}return d;case\"inject\":return parseFloat(c)?\"blur(\"+c+\")\":\"none\"}},opacity:function(a,b,c){if(8>=n)switch(a){case\"name\":return\"filter\";case\"extract\":var d=c.toString().match(/alpha\\(opacity=(.*)\\)/i);return c=d?d[1]/100:1;case\"inject\":return b.style.zoom=1,parseFloat(c)>=1?\"\":\"alpha(opacity=\"+parseInt(100*parseFloat(c),10)+\")\"}else switch(a){case\"name\":return\"opacity\";case\"extract\":return c;case\"inject\":return c}}},register:function(){9>=n||t.State.isGingerbread||(v.Lists.transformsBase=v.Lists.transformsBase.concat(v.Lists.transforms3D));for(var a=0;a<v.Lists.transformsBase.length;a++)!function(){var b=v.Lists.transformsBase[a];v.Normalizations.registered[b]=function(a,c,e){switch(a){case\"name\":return\"transform\";case\"extract\":return g(c)===d||g(c).transformCache[b]===d?/^scale/i.test(b)?1:0:g(c).transformCache[b].replace(/[()]/g,\"\");case\"inject\":var f=!1;switch(b.substr(0,b.length-1)){case\"translate\":f=!/(%|px|em|rem|vw|vh|\\d)$/i.test(e);break;case\"scal\":case\"scale\":t.State.isAndroid&&g(c).transformCache[b]===d&&1>e&&(e=1),f=!/(\\d)$/i.test(e);break;case\"skew\":f=!/(deg|\\d)$/i.test(e);break;case\"rotate\":f=!/(deg|\\d)$/i.test(e)}return f||(g(c).transformCache[b]=\"(\"+e+\")\"),g(c).transformCache[b]}}}();for(var a=0;a<v.Lists.colors.length;a++)!function(){var b=v.Lists.colors[a];v.Normalizations.registered[b]=function(a,c,e){switch(a){case\"name\":return b;case\"extract\":var f;if(v.RegEx.wrappedValueAlreadyExtracted.test(e))f=e;else{var g,h={black:\"rgb(0, 0, 0)\",blue:\"rgb(0, 0, 255)\",gray:\"rgb(128, 128, 128)\",green:\"rgb(0, 128, 0)\",red:\"rgb(255, 0, 0)\",white:\"rgb(255, 255, 255)\"};/^[A-z]+$/i.test(e)?g=h[e]!==d?h[e]:h.black:v.RegEx.isHex.test(e)?g=\"rgb(\"+v.Values.hexToRgb(e).join(\" \")+\")\":/^rgba?\\(/i.test(e)||(g=h.black),f=(g||e).toString().match(v.RegEx.valueUnwrap)[1].replace(/,(\\s+)?/g,\" \")}return 8>=n||3!==f.split(\" \").length||(f+=\" 1\"),f;case\"inject\":return 8>=n?4===e.split(\" \").length&&(e=e.split(/\\s+/).slice(0,3).join(\" \")):3===e.split(\" \").length&&(e+=\" 1\"),(8>=n?\"rgb\":\"rgba\")+\"(\"+e.replace(/\\s+/g,\",\").replace(/\\.(\\d)+(?=,)/g,\"\")+\")\"}}}()}},Names:{camelCase:function(a){return a.replace(/-(\\w)/g,function(a,b){return b.toUpperCase()})},SVGAttribute:function(a){var b=\"width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2\";return(n||t.State.isAndroid&&!t.State.isChrome)&&(b+=\"|transform\"),new RegExp(\"^(\"+b+\")$\",\"i\").test(a)},prefixCheck:function(a){if(t.State.prefixMatches[a])return[t.State.prefixMatches[a],!0];for(var b=[\"\",\"Webkit\",\"Moz\",\"ms\",\"O\"],c=0,d=b.length;d>c;c++){var e;if(e=0===c?a:b[c]+a.replace(/^\\w/,function(a){return a.toUpperCase()}),p.isString(t.State.prefixElement.style[e]))return t.State.prefixMatches[a]=e,[e,!0]}return[a,!1]}},Values:{hexToRgb:function(a){var b,c=/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i,d=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;return a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d}),b=d.exec(a),b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:[0,0,0]},isCSSNullValue:function(a){return 0==a||/^(none|auto|transparent|(rgba\\(0, ?0, ?0, ?0\\)))$/i.test(a)},getUnitType:function(a){return/^(rotate|skew)/i.test(a)?\"deg\":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(a)?\"\":\"px\"},getDisplayType:function(a){var b=a&&a.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(b)?\"inline\":/^(li)$/i.test(b)?\"list-item\":/^(tr)$/i.test(b)?\"table-row\":/^(table)$/i.test(b)?\"table\":/^(tbody)$/i.test(b)?\"table-row-group\":\"block\"},addClass:function(a,b){a.classList?a.classList.add(b):a.className+=(a.className.length?\" \":\"\")+b},removeClass:function(a,b){a.classList?a.classList.remove(b):a.className=a.className.toString().replace(new RegExp(\"(^|\\\\s)\"+b.split(\" \").join(\"|\")+\"(\\\\s|$)\",\"gi\"),\" \")}},getPropertyValue:function(a,c,e,f){function h(a,c){function e(){j&&v.setPropertyValue(a,\"display\",\"none\")}var i=0;if(8>=n)i=m.css(a,c);else{var j=!1;if(/^(width|height)$/.test(c)&&0===v.getPropertyValue(a,\"display\")&&(j=!0,v.setPropertyValue(a,\"display\",v.Values.getDisplayType(a))),!f){if(\"height\"===c&&\"border-box\"!==v.getPropertyValue(a,\"boxSizing\").toString().toLowerCase()){var k=a.offsetHeight-(parseFloat(v.getPropertyValue(a,\"borderTopWidth\"))||0)-(parseFloat(v.getPropertyValue(a,\"borderBottomWidth\"))||0)-(parseFloat(v.getPropertyValue(a,\"paddingTop\"))||0)-(parseFloat(v.getPropertyValue(a,\"paddingBottom\"))||0);return e(),k}if(\"width\"===c&&\"border-box\"!==v.getPropertyValue(a,\"boxSizing\").toString().toLowerCase()){var l=a.offsetWidth-(parseFloat(v.getPropertyValue(a,\"borderLeftWidth\"))||0)-(parseFloat(v.getPropertyValue(a,\"borderRightWidth\"))||0)-(parseFloat(v.getPropertyValue(a,\"paddingLeft\"))||0)-(parseFloat(v.getPropertyValue(a,\"paddingRight\"))||0);return e(),l}}var o;o=g(a)===d?b.getComputedStyle(a,null):g(a).computedStyle?g(a).computedStyle:g(a).computedStyle=b.getComputedStyle(a,null),\"borderColor\"===c&&(c=\"borderTopColor\"),i=9===n&&\"filter\"===c?o.getPropertyValue(c):o[c],(\"\"===i||null===i)&&(i=a.style[c]),e()}if(\"auto\"===i&&/^(top|right|bottom|left)$/i.test(c)){var p=h(a,\"position\");(\"fixed\"===p||\"absolute\"===p&&/top|left/i.test(c))&&(i=m(a).position()[c]+\"px\")}return i}var i;if(v.Hooks.registered[c]){var j=c,k=v.Hooks.getRoot(j);e===d&&(e=v.getPropertyValue(a,v.Names.prefixCheck(k)[0])),v.Normalizations.registered[k]&&(e=v.Normalizations.registered[k](\"extract\",a,e)),i=v.Hooks.extractValue(j,e)}else if(v.Normalizations.registered[c]){var l,o;l=v.Normalizations.registered[c](\"name\",a),\"transform\"!==l&&(o=h(a,v.Names.prefixCheck(l)[0]),v.Values.isCSSNullValue(o)&&v.Hooks.templates[c]&&(o=v.Hooks.templates[c][1])),i=v.Normalizations.registered[c](\"extract\",a,o)}if(!/^[\\d-]/.test(i))if(g(a)&&g(a).isSVG&&v.Names.SVGAttribute(c))if(/^(height|width)$/i.test(c))try{i=a.getBBox()[c]}catch(p){i=0}else i=a.getAttribute(c);else i=h(a,v.Names.prefixCheck(c)[0]);return v.Values.isCSSNullValue(i)&&(i=0),t.debug>=2&&console.log(\"Get \"+c+\": \"+i),i},setPropertyValue:function(a,c,d,e,f){var h=c;if(\"scroll\"===c)f.container?f.container[\"scroll\"+f.direction]=d:\"Left\"===f.direction?b.scrollTo(d,f.alternateValue):b.scrollTo(f.alternateValue,d);else if(v.Normalizations.registered[c]&&\"transform\"===v.Normalizations.registered[c](\"name\",a))v.Normalizations.registered[c](\"inject\",a,d),h=\"transform\",d=g(a).transformCache[c];else{if(v.Hooks.registered[c]){var i=c,j=v.Hooks.getRoot(c);e=e||v.getPropertyValue(a,j),d=v.Hooks.injectValue(i,d,e),c=j}if(v.Normalizations.registered[c]&&(d=v.Normalizations.registered[c](\"inject\",a,d),c=v.Normalizations.registered[c](\"name\",a)),h=v.Names.prefixCheck(c)[0],8>=n)try{a.style[h]=d}catch(k){t.debug&&console.log(\"Browser does not support [\"+d+\"] for [\"+h+\"]\")}else g(a)&&g(a).isSVG&&v.Names.SVGAttribute(c)?a.setAttribute(c,d):a.style[h]=d;t.debug>=2&&console.log(\"Set \"+c+\" (\"+h+\"): \"+d)}return[h,d]},flushTransformCache:function(a){function b(b){return parseFloat(v.getPropertyValue(a,b))}var c=\"\";if((n||t.State.isAndroid&&!t.State.isChrome)&&g(a).isSVG){var d={translate:[b(\"translateX\"),b(\"translateY\")],skewX:[b(\"skewX\")],skewY:[b(\"skewY\")],scale:1!==b(\"scale\")?[b(\"scale\"),b(\"scale\")]:[b(\"scaleX\"),b(\"scaleY\")],rotate:[b(\"rotateZ\"),0,0]};m.each(g(a).transformCache,function(a){/^translate/i.test(a)?a=\"translate\":/^scale/i.test(a)?a=\"scale\":/^rotate/i.test(a)&&(a=\"rotate\"),d[a]&&(c+=a+\"(\"+d[a].join(\" \")+\") \",delete d[a])})}else{var e,f;m.each(g(a).transformCache,function(b){return e=g(a).transformCache[b],\"transformPerspective\"===b?(f=e,!0):(9===n&&\"rotateZ\"===b&&(b=\"rotate\"),void(c+=b+e+\" \"))}),f&&(c=\"perspective\"+f+\" \"+c)}v.setPropertyValue(a,\"transform\",c)}};v.Hooks.register(),v.Normalizations.register(),t.hook=function(a,b,c){var e=d;return a=f(a),m.each(a,function(a,f){if(g(f)===d&&t.init(f),c===d)e===d&&(e=t.CSS.getPropertyValue(f,b));else{var h=t.CSS.setPropertyValue(f,b,c);\"transform\"===h[0]&&t.CSS.flushTransformCache(f),e=h}}),e};var w=function(){function a(){return h?B.promise||null:i}function e(){function a(){function a(a,b){var c=d,e=d,g=d;return p.isArray(a)?(c=a[0],!p.isArray(a[1])&&/^[\\d-]/.test(a[1])||p.isFunction(a[1])||v.RegEx.isHex.test(a[1])?g=a[1]:(p.isString(a[1])&&!v.RegEx.isHex.test(a[1])||p.isArray(a[1]))&&(e=b?a[1]:j(a[1],h.duration),a[2]!==d&&(g=a[2]))):c=a,b||(e=e||h.easing),p.isFunction(c)&&(c=c.call(f,y,x)),p.isFunction(g)&&(g=g.call(f,y,x)),[c||0,e,g]}function l(a,b){var c,d;return d=(b||\"0\").toString().toLowerCase().replace(/[%A-z]+$/,function(a){return c=a,\"\"}),c||(c=v.Values.getUnitType(a)),[d,c]}function n(){var a={myParent:f.parentNode||c.body,position:v.getPropertyValue(f,\"position\"),fontSize:v.getPropertyValue(f,\"fontSize\")},d=a.position===I.lastPosition&&a.myParent===I.lastParent,e=a.fontSize===I.lastFontSize;I.lastParent=a.myParent,I.lastPosition=a.position,I.lastFontSize=a.fontSize;var h=100,i={};if(e&&d)i.emToPx=I.lastEmToPx,i.percentToPxWidth=I.lastPercentToPxWidth,i.percentToPxHeight=I.lastPercentToPxHeight;else{var j=g(f).isSVG?c.createElementNS(\"http://www.w3.org/2000/svg\",\"rect\"):c.createElement(\"div\");t.init(j),a.myParent.appendChild(j),m.each([\"overflow\",\"overflowX\",\"overflowY\"],function(a,b){t.CSS.setPropertyValue(j,b,\"hidden\")}),t.CSS.setPropertyValue(j,\"position\",a.position),t.CSS.setPropertyValue(j,\"fontSize\",a.fontSize),t.CSS.setPropertyValue(j,\"boxSizing\",\"content-box\"),m.each([\"minWidth\",\"maxWidth\",\"width\",\"minHeight\",\"maxHeight\",\"height\"],function(a,b){t.CSS.setPropertyValue(j,b,h+\"%\")}),t.CSS.setPropertyValue(j,\"paddingLeft\",h+\"em\"),i.percentToPxWidth=I.lastPercentToPxWidth=(parseFloat(v.getPropertyValue(j,\"width\",null,!0))||1)/h,i.percentToPxHeight=I.lastPercentToPxHeight=(parseFloat(v.getPropertyValue(j,\"height\",null,!0))||1)/h,i.emToPx=I.lastEmToPx=(parseFloat(v.getPropertyValue(j,\"paddingLeft\"))||1)/h,a.myParent.removeChild(j)}return null===I.remToPx&&(I.remToPx=parseFloat(v.getPropertyValue(c.body,\"fontSize\"))||16),null===I.vwToPx&&(I.vwToPx=parseFloat(b.innerWidth)/100,I.vhToPx=parseFloat(b.innerHeight)/100),i.remToPx=I.remToPx,i.vwToPx=I.vwToPx,i.vhToPx=I.vhToPx,t.debug>=1&&console.log(\"Unit ratios: \"+JSON.stringify(i),f),i}if(h.begin&&0===y)try{h.begin.call(o,o)}catch(r){setTimeout(function(){throw r},1)}if(\"scroll\"===C){var u,w,z,A=/^x$/i.test(h.axis)?\"Left\":\"Top\",D=parseFloat(h.offset)||0;h.container?p.isWrapped(h.container)||p.isNode(h.container)?(h.container=h.container[0]||h.container,u=h.container[\"scroll\"+A],z=u+m(f).position()[A.toLowerCase()]+D):h.container=null:(u=t.State.scrollAnchor[t.State[\"scrollProperty\"+A]],w=t.State.scrollAnchor[t.State[\"scrollProperty\"+(\"Left\"===A?\"Top\":\"Left\")]],z=m(f).offset()[A.toLowerCase()]+D),i={scroll:{rootPropertyValue:!1,startValue:u,currentValue:u,endValue:z,unitType:\"\",easing:h.easing,scrollData:{container:h.container,direction:A,alternateValue:w}},element:f},t.debug&&console.log(\"tweensContainer (scroll): \",i.scroll,f)}else if(\"reverse\"===C){if(!g(f).tweensContainer)return void m.dequeue(f,h.queue);\"none\"===g(f).opts.display&&(g(f).opts.display=\"auto\"),\"hidden\"===g(f).opts.visibility&&(g(f).opts.visibility=\"visible\"),g(f).opts.loop=!1,g(f).opts.begin=null,g(f).opts.complete=null,s.easing||delete h.easing,s.duration||delete h.duration,h=m.extend({},g(f).opts,h);var E=m.extend(!0,{},g(f).tweensContainer);for(var F in E)if(\"element\"!==F){var G=E[F].startValue;E[F].startValue=E[F].currentValue=E[F].endValue,E[F].endValue=G,p.isEmptyObject(s)||(E[F].easing=h.easing),t.debug&&console.log(\"reverse tweensContainer (\"+F+\"): \"+JSON.stringify(E[F]),f)}i=E}else if(\"start\"===C){var E;g(f).tweensContainer&&g(f).isAnimating===!0&&(E=g(f).tweensContainer),m.each(q,function(b,c){if(RegExp(\"^\"+v.Lists.colors.join(\"$|^\")+\"$\").test(b)){var e=a(c,!0),f=e[0],g=e[1],h=e[2];if(v.RegEx.isHex.test(f)){for(var i=[\"Red\",\"Green\",\"Blue\"],j=v.Values.hexToRgb(f),k=h?v.Values.hexToRgb(h):d,l=0;l<i.length;l++){var m=[j[l]];g&&m.push(g),k!==d&&m.push(k[l]),q[b+i[l]]=m}delete q[b]}}});for(var H in q){var K=a(q[H]),L=K[0],M=K[1],N=K[2];H=v.Names.camelCase(H);var O=v.Hooks.getRoot(H),P=!1;if(g(f).isSVG||\"tween\"===O||v.Names.prefixCheck(O)[1]!==!1||v.Normalizations.registered[O]!==d){(h.display!==d&&null!==h.display&&\"none\"!==h.display||h.visibility!==d&&\"hidden\"!==h.visibility)&&/opacity|filter/.test(H)&&!N&&0!==L&&(N=0),h._cacheValues&&E&&E[H]?(N===d&&(N=E[H].endValue+E[H].unitType),P=g(f).rootPropertyValueCache[O]):v.Hooks.registered[H]?N===d?(P=v.getPropertyValue(f,O),N=v.getPropertyValue(f,H,P)):P=v.Hooks.templates[O][1]:N===d&&(N=v.getPropertyValue(f,H));var Q,R,S,T=!1;if(Q=l(H,N),N=Q[0],S=Q[1],Q=l(H,L),L=Q[0].replace(/^([+-\\/*])=/,function(a,b){return T=b,\"\"}),R=Q[1],N=parseFloat(N)||0,L=parseFloat(L)||0,\"%\"===R&&(/^(fontSize|lineHeight)$/.test(H)?(L/=100,R=\"em\"):/^scale/.test(H)?(L/=100,R=\"\"):/(Red|Green|Blue)$/i.test(H)&&(L=L/100*255,R=\"\")),/[\\/*]/.test(T))R=S;else if(S!==R&&0!==N)if(0===L)R=S;else{e=e||n();var U=/margin|padding|left|right|width|text|word|letter/i.test(H)||/X$/.test(H)||\"x\"===H?\"x\":\"y\";switch(S){case\"%\":N*=\"x\"===U?e.percentToPxWidth:e.percentToPxHeight;break;case\"px\":break;default:N*=e[S+\"ToPx\"]}switch(R){case\"%\":N*=1/(\"x\"===U?e.percentToPxWidth:e.percentToPxHeight);break;case\"px\":break;default:N*=1/e[R+\"ToPx\"]}}switch(T){case\"+\":L=N+L;break;case\"-\":L=N-L;break;case\"*\":L=N*L;break;case\"/\":L=N/L}i[H]={rootPropertyValue:P,startValue:N,currentValue:N,endValue:L,unitType:R,easing:M},t.debug&&console.log(\"tweensContainer (\"+H+\"): \"+JSON.stringify(i[H]),f)}else t.debug&&console.log(\"Skipping [\"+O+\"] due to a lack of browser support.\")}i.element=f}i.element&&(v.Values.addClass(f,\"velocity-animating\"),J.push(i),\"\"===h.queue&&(g(f).tweensContainer=i,g(f).opts=h),g(f).isAnimating=!0,y===x-1?(t.State.calls.push([J,o,h,null,B.resolver]),t.State.isTicking===!1&&(t.State.isTicking=!0,k())):y++)}var e,f=this,h=m.extend({},t.defaults,s),i={};switch(g(f)===d&&t.init(f),parseFloat(h.delay)&&h.queue!==!1&&m.queue(f,h.queue,function(a){t.velocityQueueEntryFlag=!0,g(f).delayTimer={setTimeout:setTimeout(a,parseFloat(h.delay)),next:a}}),h.duration.toString().toLowerCase()){case\"fast\":h.duration=200;break;case\"normal\":h.duration=r;break;case\"slow\":h.duration=600;break;default:h.duration=parseFloat(h.duration)||1}t.mock!==!1&&(t.mock===!0?h.duration=h.delay=1:(h.duration*=parseFloat(t.mock)||1,h.delay*=parseFloat(t.mock)||1)),h.easing=j(h.easing,h.duration),h.begin&&!p.isFunction(h.begin)&&(h.begin=null),h.progress&&!p.isFunction(h.progress)&&(h.progress=null),h.complete&&!p.isFunction(h.complete)&&(h.complete=null),h.display!==d&&null!==h.display&&(h.display=h.display.toString().toLowerCase(),\"auto\"===h.display&&(h.display=t.CSS.Values.getDisplayType(f))),h.visibility!==d&&null!==h.visibility&&(h.visibility=h.visibility.toString().toLowerCase()),h.mobileHA=h.mobileHA&&t.State.isMobile&&!t.State.isGingerbread,h.queue===!1?h.delay?setTimeout(a,h.delay):a():m.queue(f,h.queue,function(b,c){return c===!0?(B.promise&&B.resolver(o),!0):(t.velocityQueueEntryFlag=!0,void a(b))}),\"\"!==h.queue&&\"fx\"!==h.queue||\"inprogress\"===m.queue(f)[0]||m.dequeue(f)}var h,i,n,o,q,s,u=arguments[0]&&(arguments[0].p||m.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||p.isString(arguments[0].properties));if(p.isWrapped(this)?(h=!1,n=0,o=this,i=this):(h=!0,n=1,o=u?arguments[0].elements||arguments[0].e:arguments[0]),o=f(o)){u?(q=arguments[0].properties||arguments[0].p,s=arguments[0].options||arguments[0].o):(q=arguments[n],s=arguments[n+1]);var x=o.length,y=0;if(!/^(stop|finish|finishAll)$/i.test(q)&&!m.isPlainObject(s)){var z=n+1;s={};for(var A=z;A<arguments.length;A++)p.isArray(arguments[A])||!/^(fast|normal|slow)$/i.test(arguments[A])&&!/^\\d/.test(arguments[A])?p.isString(arguments[A])||p.isArray(arguments[A])?s.easing=arguments[A]:p.isFunction(arguments[A])&&(s.complete=arguments[A]):s.duration=arguments[A]}var B={promise:null,resolver:null,rejecter:null};h&&t.Promise&&(B.promise=new t.Promise(function(a,b){B.resolver=a,B.rejecter=b}));var C;switch(q){case\"scroll\":C=\"scroll\";break;case\"reverse\":C=\"reverse\";break;case\"finish\":case\"finishAll\":case\"stop\":m.each(o,function(a,b){g(b)&&g(b).delayTimer&&(clearTimeout(g(b).delayTimer.setTimeout),g(b).delayTimer.next&&g(b).delayTimer.next(),delete g(b).delayTimer),\"finishAll\"!==q||s!==!0&&!p.isString(s)||(m.each(m.queue(b,p.isString(s)?s:\"\"),function(a,b){p.isFunction(b)&&b()}),m.queue(b,p.isString(s)?s:\"\",[]))});var D=[];return m.each(t.State.calls,function(a,b){b&&m.each(b[1],function(c,e){var f=s===d?\"\":s;return f===!0||b[2].queue===f||s===d&&b[2].queue===!1?void m.each(o,function(c,d){d===e&&((s===!0||p.isString(s))&&(m.each(m.queue(d,p.isString(s)?s:\"\"),function(a,b){p.isFunction(b)&&b(null,!0)\r\n}),m.queue(d,p.isString(s)?s:\"\",[])),\"stop\"===q?(g(d)&&g(d).tweensContainer&&f!==!1&&m.each(g(d).tweensContainer,function(a,b){b.endValue=b.currentValue}),D.push(a)):(\"finish\"===q||\"finishAll\"===q)&&(b[2].duration=1))}):!0})}),\"stop\"===q&&(m.each(D,function(a,b){l(b,!0)}),B.promise&&B.resolver(o)),a();default:if(!m.isPlainObject(q)||p.isEmptyObject(q)){if(p.isString(q)&&t.Redirects[q]){var E=m.extend({},s),F=E.duration,G=E.delay||0;return E.backwards===!0&&(o=m.extend(!0,[],o).reverse()),m.each(o,function(a,b){parseFloat(E.stagger)?E.delay=G+parseFloat(E.stagger)*a:p.isFunction(E.stagger)&&(E.delay=G+E.stagger.call(b,a,x)),E.drag&&(E.duration=parseFloat(F)||(/^(callout|transition)/.test(q)?1e3:r),E.duration=Math.max(E.duration*(E.backwards?1-a/x:(a+1)/x),.75*E.duration,200)),t.Redirects[q].call(b,b,E||{},a,x,o,B.promise?B:d)}),a()}var H=\"Velocity: First argument (\"+q+\") was not a property map, a known action, or a registered redirect. Aborting.\";return B.promise?B.rejecter(new Error(H)):console.log(H),a()}C=\"start\"}var I={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},J=[];m.each(o,function(a,b){p.isNode(b)&&e.call(b)});var K,E=m.extend({},t.defaults,s);if(E.loop=parseInt(E.loop),K=2*E.loop-1,E.loop)for(var L=0;K>L;L++){var M={delay:E.delay,progress:E.progress};L===K-1&&(M.display=E.display,M.visibility=E.visibility,M.complete=E.complete),w(o,\"reverse\",M)}return a()}};t=m.extend(w,t),t.animate=w;var x=b.requestAnimationFrame||o;return t.State.isMobile||c.hidden===d||c.addEventListener(\"visibilitychange\",function(){c.hidden?(x=function(a){return setTimeout(function(){a(!0)},16)},k()):x=b.requestAnimationFrame||o}),a.Velocity=t,a!==b&&(a.fn.velocity=w,a.fn.velocity.defaults=t.defaults),m.each([\"Down\",\"Up\"],function(a,b){t.Redirects[\"slide\"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j=i.begin,k=i.complete,l={height:\"\",marginTop:\"\",marginBottom:\"\",paddingTop:\"\",paddingBottom:\"\"},n={};i.display===d&&(i.display=\"Down\"===b?\"inline\"===t.CSS.Values.getDisplayType(a)?\"inline-block\":\"block\":\"none\"),i.begin=function(){j&&j.call(g,g);for(var c in l){n[c]=a.style[c];var d=t.CSS.getPropertyValue(a,c);l[c]=\"Down\"===b?[d,0]:[0,d]}n.overflow=a.style.overflow,a.style.overflow=\"hidden\"},i.complete=function(){for(var b in n)a.style[b]=n[b];k&&k.call(g,g),h&&h.resolver(g)},t(a,l,i)}}),m.each([\"In\",\"Out\"],function(a,b){t.Redirects[\"fade\"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j={opacity:\"In\"===b?1:0},k=i.complete;i.complete=e!==f-1?i.begin=null:function(){k&&k.call(g,g),h&&h.resolver(g)},i.display===d&&(i.display=\"In\"===b?\"auto\":\"none\"),t(this,j,i)}}),t}(window.jQuery||window.Zepto||window,window,document)});\r\n\n",
    "/* VelocityJS.org UI Pack (5.0.4). (C) 2014 Julian Shapiro. MIT @license: en.wikipedia.org/wiki/MIT_License. Portions copyright Daniel Eden, Christian Pucci. */\r\n!function(t){\"function\"==typeof require&&\"object\"==typeof exports?module.exports=t():\"function\"==typeof define&&define.amd?define('velocityUI',[\"velocity\"],t):t()}(function(){return function(t,a,e,r){function n(t,a){var e=[];return t&&a?($.each([t,a],function(t,a){var r=[];$.each(a,function(t,a){for(;a.toString().length<5;)a=\"0\"+a;r.push(a)}),e.push(r.join(\"\"))}),parseFloat(e[0])>parseFloat(e[1])):!1}if(!t.Velocity||!t.Velocity.Utilities)return void(a.console&&console.log(\"Velocity UI Pack: Velocity must be loaded first. Aborting.\"));var i=t.Velocity,$=i.Utilities,s=i.version,o={major:1,minor:1,patch:0};if(n(o,s)){var l=\"Velocity UI Pack: You need to update Velocity (jquery.velocity.js) to a newer version. Visit http://github.com/julianshapiro/velocity.\";throw alert(l),new Error(l)}i.RegisterEffect=i.RegisterUI=function(t,a){function e(t,a,e,r){var n=0,s;$.each(t.nodeType?[t]:t,function(t,a){r&&(e+=t*r),s=a.parentNode,$.each([\"height\",\"paddingTop\",\"paddingBottom\",\"marginTop\",\"marginBottom\"],function(t,e){n+=parseFloat(i.CSS.getPropertyValue(a,e))})}),i.animate(s,{height:(\"In\"===a?\"+\":\"-\")+\"=\"+n},{queue:!1,easing:\"ease-in-out\",duration:e*(\"In\"===a?.6:1)})}return i.Redirects[t]=function(n,s,o,l,c,u){function f(){s.display!==r&&\"none\"!==s.display||!/Out$/.test(t)||$.each(c.nodeType?[c]:c,function(t,a){i.CSS.setPropertyValue(a,\"display\",\"none\")}),s.complete&&s.complete.call(c,c),u&&u.resolver(c||n)}var p=o===l-1;a.defaultDuration=\"function\"==typeof a.defaultDuration?a.defaultDuration.call(c,c):parseFloat(a.defaultDuration);for(var d=0;d<a.calls.length;d++){var g=a.calls[d],y=g[0],m=s.duration||a.defaultDuration||1e3,X=g[1],Y=g[2]||{},O={};if(O.duration=m*(X||1),O.queue=s.queue||\"\",O.easing=Y.easing||\"ease\",O.delay=parseFloat(Y.delay)||0,O._cacheValues=Y._cacheValues||!0,0===d){if(O.delay+=parseFloat(s.delay)||0,0===o&&(O.begin=function(){s.begin&&s.begin.call(c,c);var a=t.match(/(In|Out)$/);a&&\"In\"===a[0]&&y.opacity!==r&&$.each(c.nodeType?[c]:c,function(t,a){i.CSS.setPropertyValue(a,\"opacity\",0)}),s.animateParentHeight&&a&&e(c,a[0],m+O.delay,s.stagger)}),null!==s.display)if(s.display!==r&&\"none\"!==s.display)O.display=s.display;else if(/In$/.test(t)){var v=i.CSS.Values.getDisplayType(n);O.display=\"inline\"===v?\"inline-block\":v}s.visibility&&\"hidden\"!==s.visibility&&(O.visibility=s.visibility)}d===a.calls.length-1&&(O.complete=function(){if(a.reset){for(var t in a.reset){var e=a.reset[t];i.CSS.Hooks.registered[t]!==r||\"string\"!=typeof e&&\"number\"!=typeof e||(a.reset[t]=[a.reset[t],a.reset[t]])}var s={duration:0,queue:!1};p&&(s.complete=f),i.animate(n,a.reset,s)}else p&&f()},\"hidden\"===s.visibility&&(O.visibility=s.visibility)),i.animate(n,y,O)}},i},i.RegisterEffect.packagedEffects={\"callout.bounce\":{defaultDuration:550,calls:[[{translateY:-30},.25],[{translateY:0},.125],[{translateY:-15},.125],[{translateY:0},.25]]},\"callout.shake\":{defaultDuration:800,calls:[[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:0},.125]]},\"callout.flash\":{defaultDuration:1100,calls:[[{opacity:[0,\"easeInOutQuad\",1]},.25],[{opacity:[1,\"easeInOutQuad\"]},.25],[{opacity:[0,\"easeInOutQuad\"]},.25],[{opacity:[1,\"easeInOutQuad\"]},.25]]},\"callout.pulse\":{defaultDuration:825,calls:[[{scaleX:1.1,scaleY:1.1},.5,{easing:\"easeInExpo\"}],[{scaleX:1,scaleY:1},.5]]},\"callout.swing\":{defaultDuration:950,calls:[[{rotateZ:15},.2],[{rotateZ:-10},.2],[{rotateZ:5},.2],[{rotateZ:-5},.2],[{rotateZ:0},.2]]},\"callout.tada\":{defaultDuration:1e3,calls:[[{scaleX:.9,scaleY:.9,rotateZ:-3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:-3},.1],[\"reverse\",.125],[\"reverse\",.125],[\"reverse\",.125],[\"reverse\",.125],[\"reverse\",.125],[{scaleX:1,scaleY:1,rotateZ:0},.2]]},\"transition.fadeIn\":{defaultDuration:500,calls:[[{opacity:[1,0]}]]},\"transition.fadeOut\":{defaultDuration:500,calls:[[{opacity:[0,1]}]]},\"transition.flipXIn\":{defaultDuration:700,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateY:[0,-55]}]],reset:{transformPerspective:0}},\"transition.flipXOut\":{defaultDuration:700,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateY:55}]],reset:{transformPerspective:0,rotateY:0}},\"transition.flipYIn\":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateX:[0,-45]}]],reset:{transformPerspective:0}},\"transition.flipYOut\":{defaultDuration:800,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateX:25}]],reset:{transformPerspective:0,rotateX:0}},\"transition.flipBounceXIn\":{defaultDuration:900,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateY:[-10,90]},.5],[{opacity:.8,rotateY:10},.25],[{opacity:1,rotateY:0},.25]],reset:{transformPerspective:0}},\"transition.flipBounceXOut\":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateY:-10},.5],[{opacity:0,rotateY:90},.5]],reset:{transformPerspective:0,rotateY:0}},\"transition.flipBounceYIn\":{defaultDuration:850,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateX:[-10,90]},.5],[{opacity:.8,rotateX:10},.25],[{opacity:1,rotateX:0},.25]],reset:{transformPerspective:0}},\"transition.flipBounceYOut\":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateX:-15},.5],[{opacity:0,rotateX:90},.5]],reset:{transformPerspective:0,rotateX:0}},\"transition.swoopIn\":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:[\"100%\",\"50%\"],transformOriginY:[\"100%\",\"100%\"],scaleX:[1,0],scaleY:[1,0],translateX:[0,-700],translateZ:0}]],reset:{transformOriginX:\"50%\",transformOriginY:\"50%\"}},\"transition.swoopOut\":{defaultDuration:850,calls:[[{opacity:[0,1],transformOriginX:[\"50%\",\"100%\"],transformOriginY:[\"100%\",\"100%\"],scaleX:0,scaleY:0,translateX:-700,translateZ:0}]],reset:{transformOriginX:\"50%\",transformOriginY:\"50%\",scaleX:1,scaleY:1,translateX:0}},\"transition.whirlIn\":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:[\"50%\",\"50%\"],transformOriginY:[\"50%\",\"50%\"],scaleX:[1,0],scaleY:[1,0],rotateY:[0,160]},1,{easing:\"easeInOutSine\"}]]},\"transition.whirlOut\":{defaultDuration:750,calls:[[{opacity:[0,\"easeInOutQuint\",1],transformOriginX:[\"50%\",\"50%\"],transformOriginY:[\"50%\",\"50%\"],scaleX:0,scaleY:0,rotateY:160},1,{easing:\"swing\"}]],reset:{scaleX:1,scaleY:1,rotateY:0}},\"transition.shrinkIn\":{defaultDuration:750,calls:[[{opacity:[1,0],transformOriginX:[\"50%\",\"50%\"],transformOriginY:[\"50%\",\"50%\"],scaleX:[1,1.5],scaleY:[1,1.5],translateZ:0}]]},\"transition.shrinkOut\":{defaultDuration:600,calls:[[{opacity:[0,1],transformOriginX:[\"50%\",\"50%\"],transformOriginY:[\"50%\",\"50%\"],scaleX:1.3,scaleY:1.3,translateZ:0}]],reset:{scaleX:1,scaleY:1}},\"transition.expandIn\":{defaultDuration:700,calls:[[{opacity:[1,0],transformOriginX:[\"50%\",\"50%\"],transformOriginY:[\"50%\",\"50%\"],scaleX:[1,.625],scaleY:[1,.625],translateZ:0}]]},\"transition.expandOut\":{defaultDuration:700,calls:[[{opacity:[0,1],transformOriginX:[\"50%\",\"50%\"],transformOriginY:[\"50%\",\"50%\"],scaleX:.5,scaleY:.5,translateZ:0}]],reset:{scaleX:1,scaleY:1}},\"transition.bounceIn\":{defaultDuration:800,calls:[[{opacity:[1,0],scaleX:[1.05,.3],scaleY:[1.05,.3]},.4],[{scaleX:.9,scaleY:.9,translateZ:0},.2],[{scaleX:1,scaleY:1},.5]]},\"transition.bounceOut\":{defaultDuration:800,calls:[[{scaleX:.95,scaleY:.95},.35],[{scaleX:1.1,scaleY:1.1,translateZ:0},.35],[{opacity:[0,1],scaleX:.3,scaleY:.3},.3]],reset:{scaleX:1,scaleY:1}},\"transition.bounceUpIn\":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[-30,1e3]},.6,{easing:\"easeOutCirc\"}],[{translateY:10},.2],[{translateY:0},.2]]},\"transition.bounceUpOut\":{defaultDuration:1e3,calls:[[{translateY:20},.2],[{opacity:[0,\"easeInCirc\",1],translateY:-1e3},.8]],reset:{translateY:0}},\"transition.bounceDownIn\":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[30,-1e3]},.6,{easing:\"easeOutCirc\"}],[{translateY:-10},.2],[{translateY:0},.2]]},\"transition.bounceDownOut\":{defaultDuration:1e3,calls:[[{translateY:-20},.2],[{opacity:[0,\"easeInCirc\",1],translateY:1e3},.8]],reset:{translateY:0}},\"transition.bounceLeftIn\":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[30,-1250]},.6,{easing:\"easeOutCirc\"}],[{translateX:-10},.2],[{translateX:0},.2]]},\"transition.bounceLeftOut\":{defaultDuration:750,calls:[[{translateX:30},.2],[{opacity:[0,\"easeInCirc\",1],translateX:-1250},.8]],reset:{translateX:0}},\"transition.bounceRightIn\":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[-30,1250]},.6,{easing:\"easeOutCirc\"}],[{translateX:10},.2],[{translateX:0},.2]]},\"transition.bounceRightOut\":{defaultDuration:750,calls:[[{translateX:-30},.2],[{opacity:[0,\"easeInCirc\",1],translateX:1250},.8]],reset:{translateX:0}},\"transition.slideUpIn\":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,20],translateZ:0}]]},\"transition.slideUpOut\":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:-20,translateZ:0}]],reset:{translateY:0}},\"transition.slideDownIn\":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,-20],translateZ:0}]]},\"transition.slideDownOut\":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:20,translateZ:0}]],reset:{translateY:0}},\"transition.slideLeftIn\":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,-20],translateZ:0}]]},\"transition.slideLeftOut\":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:-20,translateZ:0}]],reset:{translateX:0}},\"transition.slideRightIn\":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,20],translateZ:0}]]},\"transition.slideRightOut\":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:20,translateZ:0}]],reset:{translateX:0}},\"transition.slideUpBigIn\":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,75],translateZ:0}]]},\"transition.slideUpBigOut\":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:-75,translateZ:0}]],reset:{translateY:0}},\"transition.slideDownBigIn\":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,-75],translateZ:0}]]},\"transition.slideDownBigOut\":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:75,translateZ:0}]],reset:{translateY:0}},\"transition.slideLeftBigIn\":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,-75],translateZ:0}]]},\"transition.slideLeftBigOut\":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:-75,translateZ:0}]],reset:{translateX:0}},\"transition.slideRightBigIn\":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,75],translateZ:0}]]},\"transition.slideRightBigOut\":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:75,translateZ:0}]],reset:{translateX:0}},\"transition.perspectiveUpIn\":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[\"100%\",\"100%\"],rotateX:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:\"50%\",transformOriginY:\"50%\"}},\"transition.perspectiveUpOut\":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[\"100%\",\"100%\"],rotateX:-180}]],reset:{transformPerspective:0,transformOriginX:\"50%\",transformOriginY:\"50%\",rotateX:0}},\"transition.perspectiveDownIn\":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:[0,180]}]],reset:{transformPerspective:0,transformOriginX:\"50%\",transformOriginY:\"50%\"}},\"transition.perspectiveDownOut\":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:180}]],reset:{transformPerspective:0,transformOriginX:\"50%\",transformOriginY:\"50%\",rotateX:0}},\"transition.perspectiveLeftIn\":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:\"50%\",transformOriginY:\"50%\"}},\"transition.perspectiveLeftOut\":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:-180}]],reset:{transformPerspective:0,transformOriginX:\"50%\",transformOriginY:\"50%\",rotateY:0}},\"transition.perspectiveRightIn\":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:[\"100%\",\"100%\"],transformOriginY:[0,0],rotateY:[0,180]}]],reset:{transformPerspective:0,transformOriginX:\"50%\",transformOriginY:\"50%\"}},\"transition.perspectiveRightOut\":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:[\"100%\",\"100%\"],transformOriginY:[0,0],rotateY:180}]],reset:{transformPerspective:0,transformOriginX:\"50%\",transformOriginY:\"50%\",rotateY:0}}};for(var c in i.RegisterEffect.packagedEffects)i.RegisterEffect(c,i.RegisterEffect.packagedEffects[c]);i.RunSequence=function(t){var a=$.extend(!0,[],t);a.length>1&&($.each(a.reverse(),function(t,e){var r=a[t+1];if(r){var n=e.o||e.options,s=r.o||r.options,o=n&&n.sequenceQueue===!1?\"begin\":\"complete\",l=s&&s[o],c={};c[o]=function(){var t=r.e||r.elements,a=t.nodeType?[t]:t;l&&l.call(a,a),i(e)},r.o?r.o=$.extend({},s,c):r.options=$.extend({},s,c)}}),a.reverse()),i(a[0])}}(window.jQuery||window.Zepto||window,window,document)});\n",
    "/*!\r\n * jQuery Mousewheel 3.1.13\r\n *\r\n * Copyright 2015 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n!function(a){\"function\"==typeof define&&define.amd?define('mousewheel',[\"jquery\"],a):\"object\"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type=\"mousewheel\",\"detail\"in g&&(m=-1*g.detail),\"wheelDelta\"in g&&(m=g.wheelDelta),\"wheelDeltaY\"in g&&(m=g.wheelDeltaY),\"wheelDeltaX\"in g&&(l=-1*g.wheelDeltaX),\"axis\"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,\"deltaY\"in g&&(m=-1*g.deltaY,j=m),\"deltaX\"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,\"mousewheel-line-height\");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,\"mousewheel-page-height\");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?\"floor\":\"ceil\"](j/f),l=Math[l>=1?\"floor\":\"ceil\"](l/f),m=Math[m>=1?\"floor\":\"ceil\"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&\"mousewheel\"===a.type&&b%120===0}var e,f,g=[\"wheel\",\"mousewheel\",\"DOMMouseScroll\",\"MozMousePixelScroll\"],h=\"onwheel\"in document||document.documentMode>=9?[\"wheel\"]:[\"mousewheel\",\"DomMouseScroll\",\"MozMousePixelScroll\"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:\"3.1.12\",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,\"mousewheel-line-height\",k.getLineHeight(this)),a.data(this,\"mousewheel-page-height\",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,\"mousewheel-line-height\"),a.removeData(this,\"mousewheel-page-height\")},getLineHeight:function(b){var c=a(b),d=c[\"offsetParent\"in a.fn?\"offsetParent\":\"parent\"]();return d.length||(d=a(\"body\")),parseInt(d.css(\"fontSize\"),10)||parseInt(c.css(\"fontSize\"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind(\"mousewheel\",a):this.trigger(\"mousewheel\")},unmousewheel:function(a){return this.unbind(\"mousewheel\",a)}})});\n",
    "/* == malihu jquery custom scrollbar plugin == Version: 3.1.4, License: MIT License (MIT) */\r\n!function(e){\"undefined\"!=typeof module&&module.exports?module.exports=e:e(jQuery,window,document)}(function(e){!function(t){var o=\"function\"==typeof define&&define.amd,a=\"undefined\"!=typeof module&&module.exports,n=\"https:\"==document.location.protocol?\"https:\":\"http:\",i=\"cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js\";o||(a?require(\"jquery-mousewheel\")(e):e.event.special.mousewheel||e(\"head\").append(decodeURI(\"%3Cscript src=\"+n+\"//\"+i+\"%3E%3C/script%3E\"))),t()}(function(){var t,o=\"mCustomScrollbar\",a=\"mCS\",n=\".mCustomScrollbar\",i={setTop:0,setLeft:0,axis:\"y\",scrollbarPosition:\"inside\",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:\"auto\",axis:\"y\",deltaFactor:\"auto\",disableOver:[\"select\",\"option\",\"keygen\",\"datalist\",\"textarea\"]},scrollButtons:{scrollType:\"stepless\",scrollAmount:\"auto\"},keyboard:{enable:!0,scrollType:\"stepless\",scrollAmount:\"auto\"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:\"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']\",updateOnContentResize:!0,updateOnImageLoad:\"auto\",autoUpdateTimeout:60},theme:\"light\",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},r=0,l={},s=window.attachEvent&&!window.addEventListener?1:0,c=!1,d=[\"mCSB_dragger_onDrag\",\"mCSB_scrollTools_onDrag\",\"mCS_img_loaded\",\"mCS_disabled\",\"mCS_destroyed\",\"mCS_no_scrollbar\",\"mCS-autoHide\",\"mCS-dir-rtl\",\"mCS_no_scrollbar_y\",\"mCS_no_scrollbar_x\",\"mCS_y_hidden\",\"mCS_x_hidden\",\"mCSB_draggerContainer\",\"mCSB_buttonUp\",\"mCSB_buttonDown\",\"mCSB_buttonLeft\",\"mCSB_buttonRight\"],u={init:function(t){var t=e.extend(!0,{},i,t),o=f.call(this);if(t.live){var s=t.liveSelector||this.selector||n,c=e(s);if(\"off\"===t.live)return void m(s);l[s]=setTimeout(function(){c.mCustomScrollbar(t),\"once\"===t.live&&c.length&&m(s)},500)}else m(s);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?\"x\":p(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,\"object\"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:\"auto\",axis:\"y\",preventDefault:!1,deltaFactor:\"auto\",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=g(t.scrollButtons.scrollType),h(t),e(o).each(function(){var o=e(this);if(!o.data(a)){o.data(a,{idx:++r,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:o.css(\"direction\"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var n=o.data(a),i=n.opt,l=o.data(\"mcs-axis\"),s=o.data(\"mcs-scrollbar-position\"),c=o.data(\"mcs-theme\");l&&(i.axis=l),s&&(i.scrollbarPosition=s),c&&(i.theme=c,h(i)),v.call(this),n&&i.callbacks.onCreate&&\"function\"==typeof i.callbacks.onCreate&&i.callbacks.onCreate.call(this),e(\"#mCSB_\"+n.idx+\"_container img:not(.\"+d[2]+\")\").addClass(d[2]),u.update.call(null,o)}})},update:function(t,o){var n=t||f.call(this);return e(n).each(function(){var t=e(this);if(t.data(a)){var n=t.data(a),i=n.opt,r=e(\"#mCSB_\"+n.idx+\"_container\"),l=e(\"#mCSB_\"+n.idx),s=[e(\"#mCSB_\"+n.idx+\"_dragger_vertical\"),e(\"#mCSB_\"+n.idx+\"_dragger_horizontal\")];if(!r.length)return;n.tweenRunning&&V(t),o&&n&&i.callbacks.onBeforeUpdate&&\"function\"==typeof i.callbacks.onBeforeUpdate&&i.callbacks.onBeforeUpdate.call(this),t.hasClass(d[3])&&t.removeClass(d[3]),t.hasClass(d[4])&&t.removeClass(d[4]),l.css(\"max-height\",\"none\"),l.height()!==t.height()&&l.css(\"max-height\",t.height()),_.call(this),\"y\"===i.axis||i.advanced.autoExpandHorizontalScroll||r.css(\"width\",x(r)),n.overflowed=y.call(this),M.call(this),i.autoDraggerLength&&S.call(this),b.call(this),T.call(this);var c=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];\"x\"!==i.axis&&(n.overflowed[0]?s[0].height()>s[0].parent().height()?B.call(this):(Q(t,c[0].toString(),{dir:\"y\",dur:0,overwrite:\"none\"}),n.contentReset.y=null):(B.call(this),\"y\"===i.axis?k.call(this):\"yx\"===i.axis&&n.overflowed[1]&&Q(t,c[1].toString(),{dir:\"x\",dur:0,overwrite:\"none\"}))),\"y\"!==i.axis&&(n.overflowed[1]?s[1].width()>s[1].parent().width()?B.call(this):(Q(t,c[1].toString(),{dir:\"x\",dur:0,overwrite:\"none\"}),n.contentReset.x=null):(B.call(this),\"x\"===i.axis?k.call(this):\"yx\"===i.axis&&n.overflowed[0]&&Q(t,c[0].toString(),{dir:\"y\",dur:0,overwrite:\"none\"}))),o&&n&&(2===o&&i.callbacks.onImageLoad&&\"function\"==typeof i.callbacks.onImageLoad?i.callbacks.onImageLoad.call(this):3===o&&i.callbacks.onSelectorChange&&\"function\"==typeof i.callbacks.onSelectorChange?i.callbacks.onSelectorChange.call(this):i.callbacks.onUpdate&&\"function\"==typeof i.callbacks.onUpdate&&i.callbacks.onUpdate.call(this)),X.call(this)}})},scrollTo:function(t,o){if(\"undefined\"!=typeof t&&null!=t){var n=f.call(this);return e(n).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l={trigger:\"external\",scrollInertia:r.scrollInertia,scrollEasing:\"mcsEaseInOut\",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,o),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=j.call(this,c[0],\"y\"),c[1]=j.call(this,c[1],\"x\"),s.moveDragger&&(c[0]*=i.scrollRatio.y,c[1]*=i.scrollRatio.x),s.dur=ae()?0:d,setTimeout(function(){null!==c[0]&&\"undefined\"!=typeof c[0]&&\"x\"!==r.axis&&i.overflowed[0]&&(s.dir=\"y\",s.overwrite=\"all\",Q(n,c[0].toString(),s)),null!==c[1]&&\"undefined\"!=typeof c[1]&&\"y\"!==r.axis&&i.overflowed[1]&&(s.dir=\"x\",s.overwrite=\"none\",Q(n,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=f.call(this);return e(t).each(function(){var t=e(this);t.data(a)&&V(t)})},disable:function(t){var o=f.call(this);return e(o).each(function(){var o=e(this);if(o.data(a)){o.data(a);X.call(this,\"remove\"),k.call(this),t&&B.call(this),M.call(this,!0),o.addClass(d[3])}})},destroy:function(){var t=f.call(this);return e(t).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l=e(\"#mCSB_\"+i.idx),s=e(\"#mCSB_\"+i.idx+\"_container\"),c=e(\".mCSB_\"+i.idx+\"_scrollbar\");r.live&&m(r.liveSelector||e(t).selector),X.call(this,\"remove\"),k.call(this),B.call(this),n.removeData(a),Z(this,\"mcs\"),c.remove(),s.find(\"img.\"+d[2]).removeClass(d[2]),l.replaceWith(s.contents()),n.removeClass(o+\" _\"+a+\"_\"+i.idx+\" \"+d[6]+\" \"+d[7]+\" \"+d[5]+\" \"+d[3]).addClass(d[4])}})}},f=function(){return\"object\"!=typeof e(this)||e(this).length<1?n:this},h=function(t){var o=[\"rounded\",\"rounded-dark\",\"rounded-dots\",\"rounded-dots-dark\"],a=[\"rounded-dots\",\"rounded-dots-dark\",\"3d\",\"3d-dark\",\"3d-thick\",\"3d-thick-dark\",\"inset\",\"inset-dark\",\"inset-2\",\"inset-2-dark\",\"inset-3\",\"inset-3-dark\"],n=[\"minimal\",\"minimal-dark\"],i=[\"minimal\",\"minimal-dark\"],r=[\"minimal\",\"minimal-dark\"];t.autoDraggerLength=e.inArray(t.theme,o)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,a)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?\"outside\":t.scrollbarPosition},m=function(e){l[e]&&(clearTimeout(l[e]),Z(l,e))},p=function(e){return\"yx\"===e||\"xy\"===e||\"auto\"===e?\"yx\":\"x\"===e||\"horizontal\"===e?\"x\":\"y\"},g=function(e){return\"stepped\"===e||\"pixels\"===e||\"step\"===e||\"click\"===e?\"stepped\":\"stepless\"},v=function(){var t=e(this),n=t.data(a),i=n.opt,r=i.autoExpandScrollbar?\" \"+d[1]+\"_expand\":\"\",l=[\"<div id='mCSB_\"+n.idx+\"_scrollbar_vertical' class='mCSB_scrollTools mCSB_\"+n.idx+\"_scrollbar mCS-\"+i.theme+\" mCSB_scrollTools_vertical\"+r+\"'><div class='\"+d[12]+\"'><div id='mCSB_\"+n.idx+\"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>\",\"<div id='mCSB_\"+n.idx+\"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_\"+n.idx+\"_scrollbar mCS-\"+i.theme+\" mCSB_scrollTools_horizontal\"+r+\"'><div class='\"+d[12]+\"'><div id='mCSB_\"+n.idx+\"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>\"],s=\"yx\"===i.axis?\"mCSB_vertical_horizontal\":\"x\"===i.axis?\"mCSB_horizontal\":\"mCSB_vertical\",c=\"yx\"===i.axis?l[0]+l[1]:\"x\"===i.axis?l[1]:l[0],u=\"yx\"===i.axis?\"<div id='mCSB_\"+n.idx+\"_container_wrapper' class='mCSB_container_wrapper' />\":\"\",f=i.autoHideScrollbar?\" \"+d[6]:\"\",h=\"x\"!==i.axis&&\"rtl\"===n.langDir?\" \"+d[7]:\"\";i.setWidth&&t.css(\"width\",i.setWidth),i.setHeight&&t.css(\"height\",i.setHeight),i.setLeft=\"y\"!==i.axis&&\"rtl\"===n.langDir?\"989999px\":i.setLeft,t.addClass(o+\" _\"+a+\"_\"+n.idx+f+h).wrapInner(\"<div id='mCSB_\"+n.idx+\"' class='mCustomScrollBox mCS-\"+i.theme+\" \"+s+\"'><div id='mCSB_\"+n.idx+\"_container' class='mCSB_container' style='position:relative; top:\"+i.setTop+\"; left:\"+i.setLeft+\";' dir='\"+n.langDir+\"' /></div>\");var m=e(\"#mCSB_\"+n.idx),p=e(\"#mCSB_\"+n.idx+\"_container\");\"y\"===i.axis||i.advanced.autoExpandHorizontalScroll||p.css(\"width\",x(p)),\"outside\"===i.scrollbarPosition?(\"static\"===t.css(\"position\")&&t.css(\"position\",\"relative\"),t.css(\"overflow\",\"visible\"),m.addClass(\"mCSB_outside\").after(c)):(m.addClass(\"mCSB_inside\").append(c),p.wrap(u)),w.call(this);var g=[e(\"#mCSB_\"+n.idx+\"_dragger_vertical\"),e(\"#mCSB_\"+n.idx+\"_dragger_horizontal\")];g[0].css(\"min-height\",g[0].height()),g[1].css(\"min-width\",g[1].width())},x=function(t){var o=[t[0].scrollWidth,Math.max.apply(Math,t.children().map(function(){return e(this).outerWidth(!0)}).get())],a=t.parent().width();return o[0]>a?o[0]:o[1]>a?o[1]:\"100%\"},_=function(){var t=e(this),o=t.data(a),n=o.opt,i=e(\"#mCSB_\"+o.idx+\"_container\");if(n.advanced.autoExpandHorizontalScroll&&\"y\"!==n.axis){i.css({width:\"auto\",\"min-width\":0,\"overflow-x\":\"scroll\"});var r=Math.ceil(i[0].scrollWidth);3===n.advanced.autoExpandHorizontalScroll||2!==n.advanced.autoExpandHorizontalScroll&&r>i.parent().width()?i.css({width:r,\"min-width\":\"100%\",\"overflow-x\":\"inherit\"}):i.css({\"overflow-x\":\"inherit\",position:\"absolute\"}).wrap(\"<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />\").css({width:Math.ceil(i[0].getBoundingClientRect().right+.4)-Math.floor(i[0].getBoundingClientRect().left),\"min-width\":\"100%\",position:\"relative\"}).unwrap()}},w=function(){var t=e(this),o=t.data(a),n=o.opt,i=e(\".mCSB_\"+o.idx+\"_scrollbar:first\"),r=te(n.scrollButtons.tabindex)?\"tabindex='\"+n.scrollButtons.tabindex+\"'\":\"\",l=[\"<a href='#' class='\"+d[13]+\"' oncontextmenu='return false;' \"+r+\" />\",\"<a href='#' class='\"+d[14]+\"' oncontextmenu='return false;' \"+r+\" />\",\"<a href='#' class='\"+d[15]+\"' oncontextmenu='return false;' \"+r+\" />\",\"<a href='#' class='\"+d[16]+\"' oncontextmenu='return false;' \"+r+\" />\"],s=[\"x\"===n.axis?l[2]:l[0],\"x\"===n.axis?l[3]:l[1],l[2],l[3]];n.scrollButtons.enable&&i.prepend(s[0]).append(s[1]).next(\".mCSB_scrollTools\").prepend(s[2]).append(s[3])},S=function(){var t=e(this),o=t.data(a),n=e(\"#mCSB_\"+o.idx),i=e(\"#mCSB_\"+o.idx+\"_container\"),r=[e(\"#mCSB_\"+o.idx+\"_dragger_vertical\"),e(\"#mCSB_\"+o.idx+\"_dragger_horizontal\")],l=[n.height()/i.outerHeight(!1),n.width()/i.outerWidth(!1)],c=[parseInt(r[0].css(\"min-height\")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css(\"min-width\")),Math.round(l[1]*r[1].parent().width())],d=s&&c[1]<c[0]?c[0]:c[1],u=s&&c[3]<c[2]?c[2]:c[3];r[0].css({height:d,\"max-height\":r[0].parent().height()-10}).find(\".mCSB_dragger_bar\").css({\"line-height\":c[0]+\"px\"}),r[1].css({width:u,\"max-width\":r[1].parent().width()-10})},b=function(){var t=e(this),o=t.data(a),n=e(\"#mCSB_\"+o.idx),i=e(\"#mCSB_\"+o.idx+\"_container\"),r=[e(\"#mCSB_\"+o.idx+\"_dragger_vertical\"),e(\"#mCSB_\"+o.idx+\"_dragger_horizontal\")],l=[i.outerHeight(!1)-n.height(),i.outerWidth(!1)-n.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];o.scrollRatio={y:s[0],x:s[1]}},C=function(e,t,o){var a=o?d[0]+\"_expanded\":\"\",n=e.closest(\".mCSB_scrollTools\");\"active\"===t?(e.toggleClass(d[0]+\" \"+a),n.toggleClass(d[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||(\"hide\"===t?(e.removeClass(d[0]),n.removeClass(d[1])):(e.addClass(d[0]),n.addClass(d[1])))},y=function(){var t=e(this),o=t.data(a),n=e(\"#mCSB_\"+o.idx),i=e(\"#mCSB_\"+o.idx+\"_container\"),r=null==o.overflowed?i.height():i.outerHeight(!1),l=null==o.overflowed?i.width():i.outerWidth(!1),s=i[0].scrollHeight,c=i[0].scrollWidth;return s>r&&(r=s),c>l&&(l=c),[r>n.height(),l>n.width()]},B=function(){var t=e(this),o=t.data(a),n=o.opt,i=e(\"#mCSB_\"+o.idx),r=e(\"#mCSB_\"+o.idx+\"_container\"),l=[e(\"#mCSB_\"+o.idx+\"_dragger_vertical\"),e(\"#mCSB_\"+o.idx+\"_dragger_horizontal\")];if(V(t),(\"x\"!==n.axis&&!o.overflowed[0]||\"y\"===n.axis&&o.overflowed[0])&&(l[0].add(r).css(\"top\",0),Q(t,\"_resetY\")),\"y\"!==n.axis&&!o.overflowed[1]||\"x\"===n.axis&&o.overflowed[1]){var s=dx=0;\"rtl\"===o.langDir&&(s=i.width()-r.outerWidth(!1),dx=Math.abs(s/o.scrollRatio.x)),r.css(\"left\",s),l[1].css(\"left\",dx),Q(t,\"_resetX\")}},T=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),W.call(o[0])):t()},100)}var o=e(this),n=o.data(a),i=n.opt;if(!n.bindEvents){if(I.call(this),i.contentTouchScroll&&D.call(this),E.call(this),i.mouseWheel.enable){var r;t()}z.call(this),H.call(this),i.advanced.autoScrollOnFocus&&P.call(this),i.scrollButtons.enable&&U.call(this),i.keyboard.enable&&F.call(this),n.bindEvents=!0}},k=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+\"_\"+o.idx,r=\".mCSB_\"+o.idx+\"_scrollbar\",l=e(\"#mCSB_\"+o.idx+\",#mCSB_\"+o.idx+\"_container,#mCSB_\"+o.idx+\"_container_wrapper,\"+r+\" .\"+d[12]+\",#mCSB_\"+o.idx+\"_dragger_vertical,#mCSB_\"+o.idx+\"_dragger_horizontal,\"+r+\">a\"),s=e(\"#mCSB_\"+o.idx+\"_container\");n.advanced.releaseDraggableSelectors&&l.add(e(n.advanced.releaseDraggableSelectors)),n.advanced.extraDraggableSelectors&&l.add(e(n.advanced.extraDraggableSelectors)),o.bindEvents&&(e(document).add(e(!A()||top.document)).unbind(\".\"+i),l.each(function(){e(this).unbind(\".\"+i)}),clearTimeout(t[0]._focusTimeout),Z(t[0],\"_focusTimeout\"),clearTimeout(o.sequential.step),Z(o.sequential,\"step\"),clearTimeout(s[0].onCompleteTimeout),Z(s[0],\"onCompleteTimeout\"),o.bindEvents=!1)},M=function(t){var o=e(this),n=o.data(a),i=n.opt,r=e(\"#mCSB_\"+n.idx+\"_container_wrapper\"),l=r.length?r:e(\"#mCSB_\"+n.idx+\"_container\"),s=[e(\"#mCSB_\"+n.idx+\"_scrollbar_vertical\"),e(\"#mCSB_\"+n.idx+\"_scrollbar_horizontal\")],c=[s[0].find(\".mCSB_dragger\"),s[1].find(\".mCSB_dragger\")];\"x\"!==i.axis&&(n.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children(\"a\")).css(\"display\",\"block\"),l.removeClass(d[8]+\" \"+d[10])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[0].css(\"display\",\"none\"),l.removeClass(d[10])):(s[0].css(\"display\",\"none\"),l.addClass(d[10])),l.addClass(d[8]))),\"y\"!==i.axis&&(n.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children(\"a\")).css(\"display\",\"block\"),l.removeClass(d[9]+\" \"+d[11])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[1].css(\"display\",\"none\"),l.removeClass(d[11])):(s[1].css(\"display\",\"none\"),l.addClass(d[11])),l.addClass(d[9]))),n.overflowed[0]||n.overflowed[1]?o.removeClass(d[5]):o.addClass(d[5])},O=function(t){var o=t.type,a=t.target.ownerDocument!==document&&null!==frameElement?[e(frameElement).offset().top,e(frameElement).offset().left]:null,n=A()&&t.target.ownerDocument!==top.document&&null!==frameElement?[e(t.view.frameElement).offset().top,e(t.view.frameElement).offset().left]:[0,0];switch(o){case\"pointerdown\":case\"MSPointerDown\":case\"pointermove\":case\"MSPointerMove\":case\"pointerup\":case\"MSPointerUp\":return a?[t.originalEvent.pageY-a[0]+n[0],t.originalEvent.pageX-a[1]+n[1],!1]:[t.originalEvent.pageY,t.originalEvent.pageX,!1];case\"touchstart\":case\"touchmove\":case\"touchend\":var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],r=t.originalEvent.touches.length||t.originalEvent.changedTouches.length;return t.target.ownerDocument!==document?[i.screenY,i.screenX,r>1]:[i.pageY,i.pageX,r>1];default:return a?[t.pageY-a[0]+n[0],t.pageX-a[1]+n[1],!1]:[t.pageY,t.pageX,!1]}},I=function(){function t(e){var t=m.find(\"iframe\");if(t.length){var o=e?\"auto\":\"none\";t.css(\"pointer-events\",o)}}function o(e,t,o,a){if(m[0].idleTimer=u.scrollInertia<233?250:0,n.attr(\"id\")===h[1])var i=\"x\",r=(n[0].offsetLeft-t+a)*d.scrollRatio.x;else var i=\"y\",r=(n[0].offsetTop-e+o)*d.scrollRatio.y;Q(l,r.toString(),{dir:i,drag:!0})}var n,i,r,l=e(this),d=l.data(a),u=d.opt,f=a+\"_\"+d.idx,h=[\"mCSB_\"+d.idx+\"_dragger_vertical\",\"mCSB_\"+d.idx+\"_dragger_horizontal\"],m=e(\"#mCSB_\"+d.idx+\"_container\"),p=e(\"#\"+h[0]+\",#\"+h[1]),g=u.advanced.releaseDraggableSelectors?p.add(e(u.advanced.releaseDraggableSelectors)):p,v=u.advanced.extraDraggableSelectors?e(!A()||top.document).add(e(u.advanced.extraDraggableSelectors)):e(!A()||top.document);p.bind(\"mousedown.\"+f+\" touchstart.\"+f+\" pointerdown.\"+f+\" MSPointerDown.\"+f,function(o){if(o.stopImmediatePropagation(),o.preventDefault(),$(o)){c=!0,s&&(document.onselectstart=function(){return!1}),t(!1),V(l),n=e(this);var a=n.offset(),d=O(o)[0]-a.top,f=O(o)[1]-a.left,h=n.height()+a.top,m=n.width()+a.left;h>d&&d>0&&m>f&&f>0&&(i=d,r=f),C(n,\"active\",u.autoExpandScrollbar)}}).bind(\"touchmove.\"+f,function(e){e.stopImmediatePropagation(),e.preventDefault();var t=n.offset(),a=O(e)[0]-t.top,l=O(e)[1]-t.left;o(i,r,a,l)}),e(document).add(v).bind(\"mousemove.\"+f+\" pointermove.\"+f+\" MSPointerMove.\"+f,function(e){if(n){var t=n.offset(),a=O(e)[0]-t.top,l=O(e)[1]-t.left;if(i===a&&r===l)return;o(i,r,a,l)}}).add(g).bind(\"mouseup.\"+f+\" touchend.\"+f+\" pointerup.\"+f+\" MSPointerUp.\"+f,function(){n&&(C(n,\"active\",u.autoExpandScrollbar),n=null),c=!1,s&&(document.onselectstart=null),t(!0)})},D=function(){function o(e){if(!ee(e)||c||O(e)[2])return void(t=0);t=1,b=0,C=0,d=1,y.removeClass(\"mCS_touch_action\");var o=I.offset();u=O(e)[0]-o.top,f=O(e)[1]-o.left,z=[O(e)[0],O(e)[1]]}function n(e){if(ee(e)&&!c&&!O(e)[2]&&(T.documentTouchScroll||e.preventDefault(),e.stopImmediatePropagation(),(!C||b)&&d)){g=J();var t=M.offset(),o=O(e)[0]-t.top,a=O(e)[1]-t.left,n=\"mcsLinearOut\";if(E.push(o),W.push(a),z[2]=Math.abs(O(e)[0]-z[0]),z[3]=Math.abs(O(e)[1]-z[1]),B.overflowed[0])var i=D[0].parent().height()-D[0].height(),r=u-o>0&&o-u>-(i*B.scrollRatio.y)&&(2*z[3]<z[2]||\"yx\"===T.axis);if(B.overflowed[1])var l=D[1].parent().width()-D[1].width(),h=f-a>0&&a-f>-(l*B.scrollRatio.x)&&(2*z[2]<z[3]||\"yx\"===T.axis);r||h?(U||e.preventDefault(),b=1):(C=1,y.addClass(\"mCS_touch_action\")),U&&e.preventDefault(),w=\"yx\"===T.axis?[u-o,f-a]:\"x\"===T.axis?[null,f-a]:[u-o,null],I[0].idleTimer=250,B.overflowed[0]&&s(w[0],R,n,\"y\",\"all\",!0),B.overflowed[1]&&s(w[1],R,n,\"x\",L,!0)}}function i(e){if(!ee(e)||c||O(e)[2])return void(t=0);t=1,e.stopImmediatePropagation(),V(y),p=J();var o=M.offset();h=O(e)[0]-o.top,m=O(e)[1]-o.left,E=[],W=[]}function r(e){if(ee(e)&&!c&&!O(e)[2]){d=0,e.stopImmediatePropagation(),b=0,C=0,v=J();var t=M.offset(),o=O(e)[0]-t.top,a=O(e)[1]-t.left;if(!(v-g>30)){_=1e3/(v-p);var n=\"mcsEaseOut\",i=2.5>_,r=i?[E[E.length-2],W[W.length-2]]:[0,0];x=i?[o-r[0],a-r[1]]:[o-h,a-m];var u=[Math.abs(x[0]),Math.abs(x[1])];_=i?[Math.abs(x[0]/4),Math.abs(x[1]/4)]:[_,_];var f=[Math.abs(I[0].offsetTop)-x[0]*l(u[0]/_[0],_[0]),Math.abs(I[0].offsetLeft)-x[1]*l(u[1]/_[1],_[1])];w=\"yx\"===T.axis?[f[0],f[1]]:\"x\"===T.axis?[null,f[1]]:[f[0],null],S=[4*u[0]+T.scrollInertia,4*u[1]+T.scrollInertia];var y=parseInt(T.contentTouchScroll)||0;w[0]=u[0]>y?w[0]:0,w[1]=u[1]>y?w[1]:0,B.overflowed[0]&&s(w[0],S[0],n,\"y\",L,!1),B.overflowed[1]&&s(w[1],S[1],n,\"x\",L,!1)}}}function l(e,t){var o=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?o[0]:o[3]:e>60?t>3?o[3]:o[2]:e>30?t>8?o[1]:t>6?o[0]:t>4?t:o[2]:t>8?t:o[3]}function s(e,t,o,a,n,i){e&&Q(y,e.toString(),{dur:t,scrollEasing:o,dir:a,overwrite:n,drag:i})}var d,u,f,h,m,p,g,v,x,_,w,S,b,C,y=e(this),B=y.data(a),T=B.opt,k=a+\"_\"+B.idx,M=e(\"#mCSB_\"+B.idx),I=e(\"#mCSB_\"+B.idx+\"_container\"),D=[e(\"#mCSB_\"+B.idx+\"_dragger_vertical\"),e(\"#mCSB_\"+B.idx+\"_dragger_horizontal\")],E=[],W=[],R=0,L=\"yx\"===T.axis?\"none\":\"all\",z=[],P=I.find(\"iframe\"),H=[\"touchstart.\"+k+\" pointerdown.\"+k+\" MSPointerDown.\"+k,\"touchmove.\"+k+\" pointermove.\"+k+\" MSPointerMove.\"+k,\"touchend.\"+k+\" pointerup.\"+k+\" MSPointerUp.\"+k],U=void 0!==document.body.style.touchAction;I.bind(H[0],function(e){o(e)}).bind(H[1],function(e){n(e)}),M.bind(H[0],function(e){i(e)}).bind(H[2],function(e){r(e)}),P.length&&P.each(function(){e(this).bind(\"load\",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(H[0],function(e){o(e),i(e)}).bind(H[1],function(e){n(e)}).bind(H[2],function(e){r(e)})})})},E=function(){function o(){return window.getSelection?window.getSelection().toString():document.selection&&\"Control\"!=document.selection.type?document.selection.createRange().text:0}function n(e,t,o){d.type=o&&i?\"stepped\":\"stepless\",d.scrollAmount=10,q(r,e,t,\"mcsLinearOut\",o?60:null)}var i,r=e(this),l=r.data(a),s=l.opt,d=l.sequential,u=a+\"_\"+l.idx,f=e(\"#mCSB_\"+l.idx+\"_container\"),h=f.parent();f.bind(\"mousedown.\"+u,function(){t||i||(i=1,c=!0)}).add(document).bind(\"mousemove.\"+u,function(e){if(!t&&i&&o()){var a=f.offset(),r=O(e)[0]-a.top+f[0].offsetTop,c=O(e)[1]-a.left+f[0].offsetLeft;r>0&&r<h.height()&&c>0&&c<h.width()?d.step&&n(\"off\",null,\"stepped\"):(\"x\"!==s.axis&&l.overflowed[0]&&(0>r?n(\"on\",38):r>h.height()&&n(\"on\",40)),\"y\"!==s.axis&&l.overflowed[1]&&(0>c?n(\"on\",37):c>h.width()&&n(\"on\",39)))}}).bind(\"mouseup.\"+u+\" dragend.\"+u,function(){t||(i&&(i=0,n(\"off\",null)),c=!1)})},W=function(){function t(t,a){if(V(o),!L(o,t.target)){var r=\"auto\"!==i.mouseWheel.deltaFactor?parseInt(i.mouseWheel.deltaFactor):s&&t.deltaFactor<100?100:t.deltaFactor||100,d=i.scrollInertia;if(\"x\"===i.axis||\"x\"===i.mouseWheel.axis)var u=\"x\",f=[Math.round(r*n.scrollRatio.x),parseInt(i.mouseWheel.scrollAmount)],h=\"auto\"!==i.mouseWheel.scrollAmount?f[1]:f[0]>=l.width()?.9*l.width():f[0],m=Math.abs(e(\"#mCSB_\"+n.idx+\"_container\")[0].offsetLeft),p=c[1][0].offsetLeft,g=c[1].parent().width()-c[1].width(),v=\"y\"===i.mouseWheel.axis?t.deltaY||a:t.deltaX;else var u=\"y\",f=[Math.round(r*n.scrollRatio.y),parseInt(i.mouseWheel.scrollAmount)],h=\"auto\"!==i.mouseWheel.scrollAmount?f[1]:f[0]>=l.height()?.9*l.height():f[0],m=Math.abs(e(\"#mCSB_\"+n.idx+\"_container\")[0].offsetTop),p=c[0][0].offsetTop,g=c[0].parent().height()-c[0].height(),v=t.deltaY||a;\"y\"===u&&!n.overflowed[0]||\"x\"===u&&!n.overflowed[1]||((i.mouseWheel.invert||t.webkitDirectionInvertedFromDevice)&&(v=-v),i.mouseWheel.normalizeDelta&&(v=0>v?-1:1),(v>0&&0!==p||0>v&&p!==g||i.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),t.deltaFactor<5&&!i.mouseWheel.normalizeDelta&&(h=t.deltaFactor,d=17),Q(o,(m-v*h).toString(),{dir:u,dur:d}))}}if(e(this).data(a)){var o=e(this),n=o.data(a),i=n.opt,r=a+\"_\"+n.idx,l=e(\"#mCSB_\"+n.idx),c=[e(\"#mCSB_\"+n.idx+\"_dragger_vertical\"),e(\"#mCSB_\"+n.idx+\"_dragger_horizontal\")],d=e(\"#mCSB_\"+n.idx+\"_container\").find(\"iframe\");d.length&&d.each(function(){e(this).bind(\"load\",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(\"mousewheel.\"+r,function(e,o){t(e,o)})})}),l.bind(\"mousewheel.\"+r,function(e,o){t(e,o)})}},R=new Object,A=function(t){var o=!1,a=!1,n=null;if(void 0===t?a=\"#empty\":void 0!==e(t).attr(\"id\")&&(a=e(t).attr(\"id\")),a!==!1&&void 0!==R[a])return R[a];if(t){try{var i=t.contentDocument||t.contentWindow.document;n=i.body.innerHTML}catch(r){}o=null!==n}else{try{var i=top.document;n=i.body.innerHTML}catch(r){}o=null!==n}return a!==!1&&(R[a]=o),o},L=function(t,o){var n=o.nodeName.toLowerCase(),i=t.data(a).opt.mouseWheel.disableOver,r=[\"select\",\"textarea\"];return e.inArray(n,i)>-1&&!(e.inArray(n,r)>-1&&!e(o).is(\":focus\"))},z=function(){var t,o=e(this),n=o.data(a),i=a+\"_\"+n.idx,r=e(\"#mCSB_\"+n.idx+\"_container\"),l=r.parent(),s=e(\".mCSB_\"+n.idx+\"_scrollbar .\"+d[12]);s.bind(\"mousedown.\"+i+\" touchstart.\"+i+\" pointerdown.\"+i+\" MSPointerDown.\"+i,function(o){c=!0,e(o.target).hasClass(\"mCSB_dragger\")||(t=1)}).bind(\"touchend.\"+i+\" pointerup.\"+i+\" MSPointerUp.\"+i,function(){c=!1}).bind(\"click.\"+i,function(a){if(t&&(t=0,e(a.target).hasClass(d[12])||e(a.target).hasClass(\"mCSB_draggerRail\"))){V(o);var i=e(this),s=i.find(\".mCSB_dragger\");if(i.parent(\".mCSB_scrollTools_horizontal\").length>0){if(!n.overflowed[1])return;var c=\"x\",u=a.pageX>s.offset().left?-1:1,f=Math.abs(r[0].offsetLeft)-u*(.9*l.width())}else{if(!n.overflowed[0])return;var c=\"y\",u=a.pageY>s.offset().top?-1:1,f=Math.abs(r[0].offsetTop)-u*(.9*l.height())}Q(o,f.toString(),{dir:c,scrollEasing:\"mcsEaseInOut\"})}})},P=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+\"_\"+o.idx,r=e(\"#mCSB_\"+o.idx+\"_container\"),l=r.parent();r.bind(\"focusin.\"+i,function(){var o=e(document.activeElement),a=r.find(\".mCustomScrollBox\").length,i=0;o.is(n.advanced.autoScrollOnFocus)&&(V(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=a?(i+17)*a:0,t[0]._focusTimeout=setTimeout(function(){var e=[oe(o)[0],oe(o)[1]],a=[r[0].offsetTop,r[0].offsetLeft],s=[a[0]+e[0]>=0&&a[0]+e[0]<l.height()-o.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<l.width()-o.outerWidth(!1)],c=\"yx\"!==n.axis||s[0]||s[1]?\"all\":\"none\";\"x\"===n.axis||s[0]||Q(t,e[0].toString(),{dir:\"y\",scrollEasing:\"mcsEaseInOut\",overwrite:c,dur:i}),\"y\"===n.axis||s[1]||Q(t,e[1].toString(),{dir:\"x\",scrollEasing:\"mcsEaseInOut\",overwrite:c,dur:i})},t[0]._focusTimer))})},H=function(){var t=e(this),o=t.data(a),n=a+\"_\"+o.idx,i=e(\"#mCSB_\"+o.idx+\"_container\").parent();i.bind(\"scroll.\"+n,function(){0===i.scrollTop()&&0===i.scrollLeft()||e(\".mCSB_\"+o.idx+\"_scrollbar\").css(\"visibility\",\"hidden\")})},U=function(){var t=e(this),o=t.data(a),n=o.opt,i=o.sequential,r=a+\"_\"+o.idx,l=\".mCSB_\"+o.idx+\"_scrollbar\",s=e(l+\">a\");s.bind(\"mousedown.\"+r+\" touchstart.\"+r+\" pointerdown.\"+r+\" MSPointerDown.\"+r+\" mouseup.\"+r+\" touchend.\"+r+\" pointerup.\"+r+\" MSPointerUp.\"+r+\" mouseout.\"+r+\" pointerout.\"+r+\" MSPointerOut.\"+r+\" click.\"+r,function(a){function r(e,o){i.scrollAmount=n.scrollButtons.scrollAmount,q(t,e,o)}if(a.preventDefault(),$(a)){var l=e(this).attr(\"class\");switch(i.type=n.scrollButtons.scrollType,a.type){case\"mousedown\":case\"touchstart\":case\"pointerdown\":case\"MSPointerDown\":if(\"stepped\"===i.type)return;c=!0,o.tweenRunning=!1,r(\"on\",l);break;case\"mouseup\":case\"touchend\":case\"pointerup\":case\"MSPointerUp\":case\"mouseout\":case\"pointerout\":case\"MSPointerOut\":if(\"stepped\"===i.type)return;c=!1,i.dir&&r(\"off\",l);break;case\"click\":if(\"stepped\"!==i.type||o.tweenRunning)return;r(\"on\",l)}}})},F=function(){function t(t){function a(e,t){r.type=i.keyboard.scrollType,r.scrollAmount=i.keyboard.scrollAmount,\"stepped\"===r.type&&n.tweenRunning||q(o,e,t)}switch(t.type){case\"blur\":n.tweenRunning&&r.dir&&a(\"off\",null);break;case\"keydown\":case\"keyup\":var l=t.keyCode?t.keyCode:t.which,s=\"on\";if(\"x\"!==i.axis&&(38===l||40===l)||\"y\"!==i.axis&&(37===l||39===l)){if((38===l||40===l)&&!n.overflowed[0]||(37===l||39===l)&&!n.overflowed[1])return;\"keyup\"===t.type&&(s=\"off\"),e(document.activeElement).is(u)||(t.preventDefault(),t.stopImmediatePropagation(),a(s,l))}else if(33===l||34===l){if((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),\"keyup\"===t.type){V(o);var f=34===l?-1:1;if(\"x\"===i.axis||\"yx\"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h=\"x\",m=Math.abs(c[0].offsetLeft)-f*(.9*d.width());else var h=\"y\",m=Math.abs(c[0].offsetTop)-f*(.9*d.height());Q(o,m.toString(),{dir:h,scrollEasing:\"mcsEaseInOut\"})}}else if((35===l||36===l)&&!e(document.activeElement).is(u)&&((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),\"keyup\"===t.type)){if(\"x\"===i.axis||\"yx\"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h=\"x\",m=35===l?Math.abs(d.width()-c.outerWidth(!1)):0;else var h=\"y\",m=35===l?Math.abs(d.height()-c.outerHeight(!1)):0;Q(o,m.toString(),{dir:h,scrollEasing:\"mcsEaseInOut\"})}}}var o=e(this),n=o.data(a),i=n.opt,r=n.sequential,l=a+\"_\"+n.idx,s=e(\"#mCSB_\"+n.idx),c=e(\"#mCSB_\"+n.idx+\"_container\"),d=c.parent(),u=\"input,textarea,select,datalist,keygen,[contenteditable='true']\",f=c.find(\"iframe\"),h=[\"blur.\"+l+\" keydown.\"+l+\" keyup.\"+l];f.length&&f.each(function(){e(this).bind(\"load\",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(h[0],function(e){t(e)})})}),s.attr(\"tabindex\",\"0\").bind(h[0],function(e){t(e)})},q=function(t,o,n,i,r){function l(e){u.snapAmount&&(f.scrollAmount=u.snapAmount instanceof Array?\"x\"===f.dir[0]?u.snapAmount[1]:u.snapAmount[0]:u.snapAmount);var o=\"stepped\"!==f.type,a=r?r:e?o?p/1.5:g:1e3/60,n=e?o?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],m=\"x\"===f.dir[0]?s[1]+f.dir[1]*(d[1]*n):s[0]+f.dir[1]*(d[0]*n),v=\"x\"===f.dir[0]?s[1]+f.dir[1]*parseInt(f.scrollAmount):s[0]+f.dir[1]*parseInt(f.scrollAmount),x=\"auto\"!==f.scrollAmount?v:m,_=i?i:e?o?\"mcsLinearOut\":\"mcsEaseInOut\":\"mcsLinear\",w=!!e;return e&&17>a&&(x=\"x\"===f.dir[0]?s[1]:s[0]),Q(t,x.toString(),{dir:f.dir[0],scrollEasing:_,dur:a,onComplete:w}),e?void(f.dir=!1):(clearTimeout(f.step),void(f.step=setTimeout(function(){l()},a)))}function s(){clearTimeout(f.step),Z(f,\"step\"),V(t)}var c=t.data(a),u=c.opt,f=c.sequential,h=e(\"#mCSB_\"+c.idx+\"_container\"),m=\"stepped\"===f.type,p=u.scrollInertia<26?26:u.scrollInertia,g=u.scrollInertia<1?17:u.scrollInertia;switch(o){case\"on\":if(f.dir=[n===d[16]||n===d[15]||39===n||37===n?\"x\":\"y\",n===d[13]||n===d[15]||38===n||37===n?-1:1],V(t),te(n)&&\"stepped\"===f.type)return;l(m);break;case\"off\":s(),(m||c.tweenRunning&&f.dir)&&l(!0)}},Y=function(t){var o=e(this).data(a).opt,n=[];return\"function\"==typeof t&&(t=t()),t instanceof Array?n=t.length>1?[t[0],t[1]]:\"x\"===o.axis?[null,t[0]]:[t[0],null]:(n[0]=t.y?t.y:t.x||\"x\"===o.axis?null:t,n[1]=t.x?t.x:t.y||\"y\"===o.axis?null:t),\"function\"==typeof n[0]&&(n[0]=n[0]()),\"function\"==typeof n[1]&&(n[1]=n[1]()),n},j=function(t,o){if(null!=t&&\"undefined\"!=typeof t){var n=e(this),i=n.data(a),r=i.opt,l=e(\"#mCSB_\"+i.idx+\"_container\"),s=l.parent(),c=typeof t;o||(o=\"x\"===r.axis?\"x\":\"y\");var d=\"x\"===o?l.outerWidth(!1)-s.width():l.outerHeight(!1)-s.height(),f=\"x\"===o?l[0].offsetLeft:l[0].offsetTop,h=\"x\"===o?\"left\":\"top\";switch(c){case\"function\":return t();case\"object\":var m=t.jquery?t:e(t);if(!m.length)return;return\"x\"===o?oe(m)[1]:oe(m)[0];case\"string\":case\"number\":if(te(t))return Math.abs(t);if(-1!==t.indexOf(\"%\"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf(\"-=\"))return Math.abs(f-parseInt(t.split(\"-=\")[1]));if(-1!==t.indexOf(\"+=\")){var p=f+parseInt(t.split(\"+=\")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf(\"px\")&&te(t.split(\"px\")[0]))return Math.abs(t.split(\"px\")[0]);if(\"top\"===t||\"left\"===t)return 0;if(\"bottom\"===t)return Math.abs(s.height()-l.outerHeight(!1));if(\"right\"===t)return Math.abs(s.width()-l.outerWidth(!1));if(\"first\"===t||\"last\"===t){var m=l.find(\":\"+t);return\"x\"===o?oe(m)[1]:oe(m)[0]}return e(t).length?\"x\"===o?oe(e(t))[1]:oe(e(t))[0]:(l.css(h,t),void u.update.call(null,n[0]))}}},X=function(t){function o(){return clearTimeout(f[0].autoUpdate),0===l.parents(\"html\").length?void(l=null):void(f[0].autoUpdate=setTimeout(function(){return c.advanced.updateOnSelectorChange&&(s.poll.change.n=i(),s.poll.change.n!==s.poll.change.o)?(s.poll.change.o=s.poll.change.n,void r(3)):c.advanced.updateOnContentResize&&(s.poll.size.n=l[0].scrollHeight+l[0].scrollWidth+f[0].offsetHeight+l[0].offsetHeight+l[0].offsetWidth,s.poll.size.n!==s.poll.size.o)?(s.poll.size.o=s.poll.size.n,void r(1)):!c.advanced.updateOnImageLoad||\"auto\"===c.advanced.updateOnImageLoad&&\"y\"===c.axis||(s.poll.img.n=f.find(\"img\").length,s.poll.img.n===s.poll.img.o)?void((c.advanced.updateOnSelectorChange||c.advanced.updateOnContentResize||c.advanced.updateOnImageLoad)&&o()):(s.poll.img.o=s.poll.img.n,void f.find(\"img\").each(function(){n(this)}))},c.advanced.autoUpdateTimeout))}function n(t){function o(e,t){return function(){return t.apply(e,arguments)}}function a(){this.onload=null,\r\n    e(t).addClass(d[2]),r(2)}if(e(t).hasClass(d[2]))return void r();var n=new Image;n.onload=o(n,a),n.src=t.src}function i(){c.advanced.updateOnSelectorChange===!0&&(c.advanced.updateOnSelectorChange=\"*\");var e=0,t=f.find(c.advanced.updateOnSelectorChange);return c.advanced.updateOnSelectorChange&&t.length>0&&t.each(function(){e+=this.offsetHeight+this.offsetWidth}),e}function r(e){clearTimeout(f[0].autoUpdate),u.update.call(null,l[0],e)}var l=e(this),s=l.data(a),c=s.opt,f=e(\"#mCSB_\"+s.idx+\"_container\");return t?(clearTimeout(f[0].autoUpdate),void Z(f[0],\"autoUpdate\")):void o()},N=function(e,t,o){return Math.round(e/t)*t-o},V=function(t){var o=t.data(a),n=e(\"#mCSB_\"+o.idx+\"_container,#mCSB_\"+o.idx+\"_container_wrapper,#mCSB_\"+o.idx+\"_dragger_vertical,#mCSB_\"+o.idx+\"_dragger_horizontal\");n.each(function(){K.call(this)})},Q=function(t,o,n){function i(e){return s&&c.callbacks[e]&&\"function\"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||w>=S[0]+y,c.callbacks.alwaysTriggerOffsets||-B>=w]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],o=[x[0].offsetTop,x[0].offsetLeft],a=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:o[0],draggerLeft:o[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(a[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(a[1])-i[1])),direction:n.dir}}var s=t.data(a),c=s.opt,d={trigger:\"internal\",dir:\"y\",scrollEasing:\"mcsEaseOut\",drag:!1,dur:c.scrollInertia,overwrite:\"all\",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},n=e.extend(d,n),u=[n.dur,n.drag?0:n.dur],f=e(\"#mCSB_\"+s.idx),h=e(\"#mCSB_\"+s.idx+\"_container\"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];if(s.trigger=n.trigger,0===m.scrollTop()&&0===m.scrollLeft()||(e(\".mCSB_\"+s.idx+\"_scrollbar\").css(\"visibility\",\"visible\"),m.scrollTop(0).scrollLeft(0)),\"_resetY\"!==o||s.contentReset.y||(i(\"onOverflowYNone\")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),\"_resetX\"!==o||s.contentReset.x||(i(\"onOverflowXNone\")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),\"_resetY\"!==o&&\"_resetX\"!==o){if(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(i(\"onOverflowY\")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(i(\"onOverflowX\")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount){var v=c.snapAmount instanceof Array?\"x\"===n.dir?c.snapAmount[1]:c.snapAmount[0]:c.snapAmount;o=N(o,v,c.snapOffset)}switch(n.dir){case\"x\":var x=e(\"#mCSB_\"+s.idx+\"_dragger_horizontal\"),_=\"left\",w=h[0].offsetLeft,S=[f.width()-h.outerWidth(!1),x.parent().width()-x.width()],b=[o,0===o?0:o/s.scrollRatio.x],y=p[1],B=g[1],T=y>0?y/s.scrollRatio.x:0,k=B>0?B/s.scrollRatio.x:0;break;case\"y\":var x=e(\"#mCSB_\"+s.idx+\"_dragger_vertical\"),_=\"top\",w=h[0].offsetTop,S=[f.height()-h.outerHeight(!1),x.parent().height()-x.height()],b=[o,0===o?0:o/s.scrollRatio.y],y=p[0],B=g[0],T=y>0?y/s.scrollRatio.y:0,k=B>0?B/s.scrollRatio.y:0}b[1]<0||0===b[0]&&0===b[1]?b=[0,0]:b[1]>=S[1]?b=[S[0],S[1]]:b[0]=-b[0],t[0].mcs||(l(),i(\"onInit\")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),G(x[0],_,Math.round(b[1]),u[1],n.scrollEasing),!s.tweenRunning&&(0===w&&b[0]>=0||w===S[0]&&b[0]<=S[0])||G(h[0],_,Math.round(b[0]),u[0],n.scrollEasing,n.overwrite,{onStart:function(){n.callbacks&&n.onStart&&!s.tweenRunning&&(i(\"onScrollStart\")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,C(x),s.cbOffsets=r())},onUpdate:function(){n.callbacks&&n.onUpdate&&i(\"whileScrolling\")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(n.callbacks&&n.onComplete){\"yx\"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){i(\"onScroll\")&&(l(),c.callbacks.onScroll.call(t[0])),i(\"onTotalScroll\")&&b[1]>=S[1]-T&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),i(\"onTotalScrollBack\")&&b[1]<=k&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,C(x,\"hide\")},e)}}})}},G=function(e,t,o,a,n,i,r){function l(){S.stop||(x||m.call(),x=J()-v,s(),x>=S.time&&(S.time=x>S.time?x+f-(x-S.time):x+f-1,S.time<x+1&&(S.time=x+1)),S.time<a?S.id=h(l):g.call())}function s(){a>0?(S.currVal=u(S.time,_,b,a,n),w[t]=Math.round(S.currVal)+\"px\"):w[t]=o+\"px\",p.call()}function c(){f=1e3/60,S.time=x+f,h=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return s(),setTimeout(e,.01)},S.id=h(l)}function d(){null!=S.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(S.id):clearTimeout(S.id),S.id=null)}function u(e,t,o,a,n){switch(n){case\"linear\":case\"mcsLinear\":return o*e/a+t;case\"mcsLinearOut\":return e/=a,e--,o*Math.sqrt(1-e*e)+t;case\"easeInOutSmooth\":return e/=a/2,1>e?o/2*e*e+t:(e--,-o/2*(e*(e-2)-1)+t);case\"easeInOutStrong\":return e/=a/2,1>e?o/2*Math.pow(2,10*(e-1))+t:(e--,o/2*(-Math.pow(2,-10*e)+2)+t);case\"easeInOut\":case\"mcsEaseInOut\":return e/=a/2,1>e?o/2*e*e*e+t:(e-=2,o/2*(e*e*e+2)+t);case\"easeOutSmooth\":return e/=a,e--,-o*(e*e*e*e-1)+t;case\"easeOutStrong\":return o*(-Math.pow(2,-10*e/a)+1)+t;case\"easeOut\":case\"mcsEaseOut\":default:var i=(e/=a)*e,r=i*e;return t+o*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var f,h,r=r||{},m=r.onStart||function(){},p=r.onUpdate||function(){},g=r.onComplete||function(){},v=J(),x=0,_=e.offsetTop,w=e.style,S=e._mTween[t];\"left\"===t&&(_=e.offsetLeft);var b=o-_;S.stop=0,\"none\"!==i&&d(),c()},J=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},K=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var t=[\"top\",\"left\"],o=0;o<t.length;o++){var a=t[o];e._mTween[a].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._mTween[a].id):clearTimeout(e._mTween[a].id),e._mTween[a].id=null,e._mTween[a].stop=1)}},Z=function(e,t){try{delete e[t]}catch(o){e[t]=null}},$=function(e){return!(e.which&&1!==e.which)},ee=function(e){var t=e.originalEvent.pointerType;return!(t&&\"touch\"!==t&&2!==t)},te=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},oe=function(e){var t=e.parents(\".mCSB_container\");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]},ae=function(){function e(){var e=[\"webkit\",\"moz\",\"ms\",\"o\"];if(\"hidden\"in document)return\"hidden\";for(var t=0;t<e.length;t++)if(e[t]+\"Hidden\"in document)return e[t]+\"Hidden\";return null}var t=e();return t?document[t]:!1};e.fn[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):\"object\"!=typeof t&&t?void e.error(\"Method \"+t+\" does not exist\"):u.init.apply(this,arguments)},e[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):\"object\"!=typeof t&&t?void e.error(\"Method \"+t+\" does not exist\"):u.init.apply(this,arguments)},e[o].defaults=i,window[o]=!0,e(window).bind(\"load\",function(){e(n)[o](),e.extend(e.expr[\":\"],{mcsInView:e.expr[\":\"].mcsInView||function(t){var o,a,n=e(t),i=n.parents(\".mCSB_container\");if(i.length)return o=i.parent(),a=[i[0].offsetTop,i[0].offsetLeft],a[0]+oe(n)[0]>=0&&a[0]+oe(n)[0]<o.height()-n.outerHeight(!1)&&a[1]+oe(n)[1]>=0&&a[1]+oe(n)[1]<o.width()-n.outerWidth(!1)},mcsInSight:e.expr[\":\"].mcsInSight||function(t){var o,a,n,i,r=e(t),l=r.parents(\".mCSB_container\");if(l.length)return o=[r.outerHeight(!1),r.outerWidth(!1)],n=[l[0].offsetTop+oe(r)[0],l[0].offsetLeft+oe(r)[1]],a=[l.parent()[0].offsetHeight,l.parent()[0].offsetWidth],i=[o[0]<a[0]?[.9,.1]:[.6,.4],o[1]<a[1]?[.9,.1]:[.6,.4]],n[0]-a[0]*i[0][0]<0&&n[0]+o[0]-a[0]*i[0][1]>=0&&n[1]-a[1]*i[1][0]<0&&n[1]+o[1]-a[1]*i[1][1]>=0},mcsOverflow:e.expr[\":\"].mcsOverflow||function(t){var o=e(t).data(a);if(o)return o.overflowed[0]||o.overflowed[1]}})})})});\ndefine(\"customScrollbar\", [\"jquery\",\"mousewheel\"], function(){});\n\n",
    "/*!\r\n * Validator v0.10.1 for Bootstrap 3, by @1000hz\r\n * Copyright 2016 Cina Saffary\r\n * Licensed under http://opensource.org/licenses/MIT\r\n *\r\n * https://github.com/1000hz/bootstrap-validator\r\n */\r\n\r\n+function(a){\"use strict\";function b(b){return b.is('[type=\"checkbox\"]')?b.prop(\"checked\"):b.is('[type=\"radio\"]')?!!a('[name=\"'+b.attr(\"name\")+'\"]:checked').length:a.trim(b.val())}function c(b){return this.each(function(){var c=a(this),e=a.extend({},d.DEFAULTS,c.data(),\"object\"==typeof b&&b),f=c.data(\"bs.validator\");(f||\"destroy\"!=b)&&(f||c.data(\"bs.validator\",f=new d(this,e)),\"string\"==typeof b&&f[b]())})}var d=function(c,e){this.options=e,this.$element=a(c),this.$inputs=this.$element.find(d.INPUT_SELECTOR),this.$btn=a('button[type=\"submit\"], input[type=\"submit\"]').filter('[form=\"'+this.$element.attr(\"id\")+'\"]').add(this.$element.find('input[type=\"submit\"], button[type=\"submit\"]')),e.errors=a.extend({},d.DEFAULTS.errors,e.errors);for(var f in e.custom)if(!e.errors[f])throw new Error(\"Missing default error message for custom validator: \"+f);a.extend(d.VALIDATORS,e.custom),this.$element.attr(\"novalidate\",!0),this.toggleSubmit(),this.$element.on(\"input.bs.validator change.bs.validator focusout.bs.validator\",d.INPUT_SELECTOR,a.proxy(this.onInput,this)),this.$element.on(\"submit.bs.validator\",a.proxy(this.onSubmit,this)),this.$element.find(\"[data-match]\").each(function(){var c=a(this),d=c.data(\"match\");a(d).on(\"input.bs.validator\",function(){b(c)&&c.trigger(\"input.bs.validator\")})})};d.INPUT_SELECTOR=':input:not([type=\"submit\"], button):enabled:visible',d.FOCUS_OFFSET=20,d.DEFAULTS={delay:500,html:!1,disable:!0,focus:!0,custom:{},errors:{match:\"Does not match\",minlength:\"Not long enough\"},feedback:{success:\"glyphicon-ok\",error:\"glyphicon-remove\"}},d.VALIDATORS={\"native\":function(a){var b=a[0];return b.checkValidity?b.checkValidity():!0},match:function(b){var c=b.data(\"match\");return!b.val()||b.val()===a(c).val()},minlength:function(a){var b=a.data(\"minlength\");return!a.val()||a.val().length>=b}},d.prototype.onInput=function(b){var c=this,d=a(b.target),e=\"focusout\"!==b.type;this.validateInput(d,e).done(function(){c.toggleSubmit()})},d.prototype.validateInput=function(c,d){var e=b(c),f=c.data(\"bs.validator.previous\"),g=c.data(\"bs.validator.errors\");if(f===e)return a.Deferred().resolve();c.data(\"bs.validator.previous\",e),c.is('[type=\"radio\"]')&&(c=this.$element.find('input[name=\"'+c.attr(\"name\")+'\"]'));var h=a.Event(\"validate.bs.validator\",{relatedTarget:c[0]});if(this.$element.trigger(h),!h.isDefaultPrevented()){var i=this;return this.runValidators(c).done(function(b){c.data(\"bs.validator.errors\",b),b.length?d?i.defer(c,i.showErrors):i.showErrors(c):i.clearErrors(c),g&&b.toString()===g.toString()||(h=b.length?a.Event(\"invalid.bs.validator\",{relatedTarget:c[0],detail:b}):a.Event(\"valid.bs.validator\",{relatedTarget:c[0],detail:g}),i.$element.trigger(h)),i.toggleSubmit(),i.$element.trigger(a.Event(\"validated.bs.validator\",{relatedTarget:c[0]}))})}},d.prototype.runValidators=function(c){function e(a){return c.data(a+\"-error\")||c.data(\"error\")||\"native\"==a&&c[0].validationMessage||h.errors[a]}var f=[],g=a.Deferred(),h=this.options;return c.data(\"bs.validator.deferred\")&&c.data(\"bs.validator.deferred\").reject(),c.data(\"bs.validator.deferred\",g),a.each(d.VALIDATORS,a.proxy(function(a,d){if((b(c)||c.attr(\"required\"))&&(c.data(a)||\"native\"==a)&&!d.call(this,c)){var g=e(a);!~f.indexOf(g)&&f.push(g)}},this)),!f.length&&b(c)&&c.data(\"remote\")?this.defer(c,function(){var d={};d[c.attr(\"name\")]=b(c),a.get(c.data(\"remote\"),d).fail(function(a,b,c){f.push(e(\"remote\")||c)}).always(function(){g.resolve(f)})}):g.resolve(f),g.promise()},d.prototype.validate=function(){var b=this;return a.when(this.$inputs.map(function(){return b.validateInput(a(this),!1)})).then(function(){b.toggleSubmit(),b.$btn.hasClass(\"disabled\")&&b.focusError()}),this},d.prototype.focusError=function(){if(this.options.focus){var b=a(\".has-error:first :input\");a(document.body).animate({scrollTop:b.offset().top-d.FOCUS_OFFSET},250),b.focus()}},d.prototype.showErrors=function(b){var c=this.options.html?\"html\":\"text\",d=b.data(\"bs.validator.errors\"),e=b.closest(\".form-group\"),f=e.find(\".help-block.with-errors\"),g=e.find(\".form-control-feedback\");d.length&&(d=a(\"<ul/>\").addClass(\"list-unstyled\").append(a.map(d,function(b){return a(\"<li/>\")[c](b)})),void 0===f.data(\"bs.validator.originalContent\")&&f.data(\"bs.validator.originalContent\",f.html()),f.empty().append(d),e.addClass(\"has-error has-danger\"),e.hasClass(\"has-feedback\")&&g.removeClass(this.options.feedback.success)&&g.addClass(this.options.feedback.error)&&e.removeClass(\"has-success\"))},d.prototype.clearErrors=function(a){var c=a.closest(\".form-group\"),d=c.find(\".help-block.with-errors\"),e=c.find(\".form-control-feedback\");d.html(d.data(\"bs.validator.originalContent\")),c.removeClass(\"has-error has-danger\"),c.hasClass(\"has-feedback\")&&e.removeClass(this.options.feedback.error)&&b(a)&&e.addClass(this.options.feedback.success)&&c.addClass(\"has-success\")},d.prototype.hasErrors=function(){function b(){return!!(a(this).data(\"bs.validator.errors\")||[]).length}return!!this.$inputs.filter(b).length},d.prototype.isIncomplete=function(){function c(){return!b(a(this))}return!!this.$inputs.filter(\"[required]\").filter(c).length},d.prototype.onSubmit=function(a){this.validate(),this.$btn.hasClass(\"disabled\")&&a.preventDefault()},d.prototype.toggleSubmit=function(){this.options.disable&&this.$btn.toggleClass(\"disabled\",this.isIncomplete()||this.hasErrors())},d.prototype.defer=function(b,c){return c=a.proxy(c,this,b),this.options.delay?(window.clearTimeout(b.data(\"bs.validator.timeout\")),void b.data(\"bs.validator.timeout\",window.setTimeout(c,this.options.delay))):c()},d.prototype.destroy=function(){return this.$element.removeAttr(\"novalidate\").removeData(\"bs.validator\").off(\".bs.validator\").find(\".form-control-feedback\").removeClass([this.options.feedback.error,this.options.feedback.success].join(\" \")),this.$inputs.off(\".bs.validator\").removeData([\"bs.validator.errors\",\"bs.validator.deferred\",\"bs.validator.previous\"]).each(function(){var b=a(this),c=b.data(\"bs.validator.timeout\");window.clearTimeout(c)&&b.removeData(\"bs.validator.timeout\")}),this.$element.find(\".help-block.with-errors\").each(function(){var b=a(this),c=b.data(\"bs.validator.originalContent\");b.removeData(\"bs.validator.originalContent\").html(c)}),this.$element.find('input[type=\"submit\"], button[type=\"submit\"]').removeClass(\"disabled\"),this.$element.find(\".has-error, .has-danger\").removeClass(\"has-error has-danger\"),this};var e=a.fn.validator;a.fn.validator=c,a.fn.validator.Constructor=d,a.fn.validator.noConflict=function(){return a.fn.validator=e,this},a(window).on(\"load\",function(){a('form[data-toggle=\"validator\"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery);\ndefine(\"validator\", [\"jquery\",\"bootstrap\"], function(){});\n\n",
    "/*! X-editable - v1.5.1 \r\n* In-place editing with Twitter Bootstrap, jQuery UI or pure jQuery\r\n* http://github.com/vitalets/x-editable\r\n* Copyright (c) 2013 Vitaliy Potapov; Licensed MIT */\r\n!function(a){\"use strict\";var b=function(b,c){this.options=a.extend({},a.fn.editableform.defaults,c),this.$div=a(b),this.options.scope||(this.options.scope=this)};b.prototype={constructor:b,initInput:function(){this.input=this.options.input,this.value=this.input.str2value(this.options.value),this.input.prerender()},initTemplate:function(){this.$form=a(a.fn.editableform.template)},initButtons:function(){var b=this.$form.find(\".editable-buttons\");b.append(a.fn.editableform.buttons),\"bottom\"===this.options.showbuttons&&b.addClass(\"editable-buttons-bottom\")},render:function(){this.$loading=a(a.fn.editableform.loading),this.$div.empty().append(this.$loading),this.initTemplate(),this.options.showbuttons?this.initButtons():this.$form.find(\".editable-buttons\").remove(),this.showLoading(),this.isSaving=!1,this.$div.triggerHandler(\"rendering\"),this.initInput(),this.$form.find(\"div.editable-input\").append(this.input.$tpl),this.$div.append(this.$form),a.when(this.input.render()).then(a.proxy(function(){if(this.options.showbuttons||this.input.autosubmit(),this.$form.find(\".editable-cancel\").click(a.proxy(this.cancel,this)),this.input.error)this.error(this.input.error),this.$form.find(\".editable-submit\").attr(\"disabled\",!0),this.input.$input.attr(\"disabled\",!0),this.$form.submit(function(a){a.preventDefault()});else{this.error(!1),this.input.$input.removeAttr(\"disabled\"),this.$form.find(\".editable-submit\").removeAttr(\"disabled\");var b=null===this.value||void 0===this.value||\"\"===this.value?this.options.defaultValue:this.value;this.input.value2input(b),this.$form.submit(a.proxy(this.submit,this))}this.$div.triggerHandler(\"rendered\"),this.showForm(),this.input.postrender&&this.input.postrender()},this))},cancel:function(){this.$div.triggerHandler(\"cancel\")},showLoading:function(){var a,b;this.$form?(a=this.$form.outerWidth(),b=this.$form.outerHeight(),a&&this.$loading.width(a),b&&this.$loading.height(b),this.$form.hide()):(a=this.$loading.parent().width(),a&&this.$loading.width(a)),this.$loading.show()},showForm:function(a){this.$loading.hide(),this.$form.show(),a!==!1&&this.input.activate(),this.$div.triggerHandler(\"show\")},error:function(b){var c,d=this.$form.find(\".control-group\"),e=this.$form.find(\".editable-error-block\");if(b===!1)d.removeClass(a.fn.editableform.errorGroupClass),e.removeClass(a.fn.editableform.errorBlockClass).empty().hide();else{if(b){c=(\"\"+b).split(\"\\n\");for(var f=0;f<c.length;f++)c[f]=a(\"<div>\").text(c[f]).html();b=c.join(\"<br>\")}d.addClass(a.fn.editableform.errorGroupClass),e.addClass(a.fn.editableform.errorBlockClass).html(b).show()}},submit:function(b){b.stopPropagation(),b.preventDefault();var c=this.input.input2value(),d=this.validate(c);if(\"object\"===a.type(d)&&void 0!==d.newValue){if(c=d.newValue,this.input.value2input(c),\"string\"==typeof d.msg)return this.error(d.msg),this.showForm(),void 0}else if(d)return this.error(d),this.showForm(),void 0;if(!this.options.savenochange&&this.input.value2str(c)==this.input.value2str(this.value))return this.$div.triggerHandler(\"nochange\"),void 0;var e=this.input.value2submit(c);this.isSaving=!0,a.when(this.save(e)).done(a.proxy(function(a){this.isSaving=!1;var b=\"function\"==typeof this.options.success?this.options.success.call(this.options.scope,a,c):null;return b===!1?(this.error(!1),this.showForm(!1),void 0):\"string\"==typeof b?(this.error(b),this.showForm(),void 0):(b&&\"object\"==typeof b&&b.hasOwnProperty(\"newValue\")&&(c=b.newValue),this.error(!1),this.value=c,this.$div.triggerHandler(\"save\",{newValue:c,submitValue:e,response:a}),void 0)},this)).fail(a.proxy(function(a){this.isSaving=!1;var b;b=\"function\"==typeof this.options.error?this.options.error.call(this.options.scope,a,c):\"string\"==typeof a?a:a.responseText||a.statusText||\"Unknown error!\",this.error(b),this.showForm()},this))},save:function(b){this.options.pk=a.fn.editableutils.tryParseJson(this.options.pk,!0);var c,d=\"function\"==typeof this.options.pk?this.options.pk.call(this.options.scope):this.options.pk,e=!!(\"function\"==typeof this.options.url||this.options.url&&(\"always\"===this.options.send||\"auto\"===this.options.send&&null!==d&&void 0!==d));return e?(this.showLoading(),c={name:this.options.name||\"\",value:b,pk:d},\"function\"==typeof this.options.params?c=this.options.params.call(this.options.scope,c):(this.options.params=a.fn.editableutils.tryParseJson(this.options.params,!0),a.extend(c,this.options.params)),\"function\"==typeof this.options.url?this.options.url.call(this.options.scope,c):a.ajax(a.extend({url:this.options.url,data:c,type:\"POST\"},this.options.ajaxOptions))):void 0},validate:function(a){return void 0===a&&(a=this.value),\"function\"==typeof this.options.validate?this.options.validate.call(this.options.scope,a):void 0},option:function(a,b){a in this.options&&(this.options[a]=b),\"value\"===a&&this.setValue(b)},setValue:function(a,b){this.value=b?this.input.str2value(a):a,this.$form&&this.$form.is(\":visible\")&&this.input.value2input(this.value)}},a.fn.editableform=function(c){var d=arguments;return this.each(function(){var e=a(this),f=e.data(\"editableform\"),g=\"object\"==typeof c&&c;f||e.data(\"editableform\",f=new b(this,g)),\"string\"==typeof c&&f[c].apply(f,Array.prototype.slice.call(d,1))})},a.fn.editableform.Constructor=b,a.fn.editableform.defaults={type:\"text\",url:null,params:null,name:null,pk:null,value:null,defaultValue:null,send:\"auto\",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:!0,scope:null,savenochange:!1},a.fn.editableform.template='<form class=\"form-inline editableform\"><div class=\"control-group\"><div><div class=\"editable-input\"></div><div class=\"editable-buttons\"></div></div><div class=\"editable-error-block\"></div></div></form>',a.fn.editableform.loading='<div class=\"editableform-loading\"></div>',a.fn.editableform.buttons='<button type=\"submit\" class=\"editable-submit\">ok</button><button type=\"button\" class=\"editable-cancel\">cancel</button>',a.fn.editableform.errorGroupClass=null,a.fn.editableform.errorBlockClass=\"editable-error\",a.fn.editableform.engine=\"jquery\"}(window.jQuery),function(a){\"use strict\";a.fn.editableutils={inherit:function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype},setCursorPosition:function(a,b){if(a.setSelectionRange)a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd(\"character\",b),c.moveStart(\"character\",b),c.select()}},tryParseJson:function(a,b){if(\"string\"==typeof a&&a.length&&a.match(/^[\\{\\[].*[\\}\\]]$/))if(b)try{a=new Function(\"return \"+a)()}catch(c){}finally{return a}else a=new Function(\"return \"+a)();return a},sliceObj:function(b,c,d){var e,f,g={};if(!a.isArray(c)||!c.length)return g;for(var h=0;h<c.length;h++)e=c[h],b.hasOwnProperty(e)&&(g[e]=b[e]),d!==!0&&(f=e.toLowerCase(),b.hasOwnProperty(f)&&(g[e]=b[f]));return g},getConfigData:function(b){var c={};return a.each(b.data(),function(a,b){(\"object\"!=typeof b||b&&\"object\"==typeof b&&(b.constructor===Object||b.constructor===Array))&&(c[a]=b)}),c},objectKeys:function(a){if(Object.keys)return Object.keys(a);if(a!==Object(a))throw new TypeError(\"Object.keys called on a non-object\");var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c},escape:function(b){return a(\"<div>\").text(b).html()},itemsByValue:function(b,c,d){if(!c||null===b)return[];if(\"function\"!=typeof d){var e=d||\"value\";d=function(a){return a[e]}}var f=a.isArray(b),g=[],h=this;return a.each(c,function(c,e){if(e.children)g=g.concat(h.itemsByValue(b,e.children,d));else if(f)a.grep(b,function(a){return a==(e&&\"object\"==typeof e?d(e):e)}).length&&g.push(e);else{var i=e&&\"object\"==typeof e?d(e):e;b==i&&g.push(e)}}),g},createInput:function(b){var c,d,e,f=b.type;return\"date\"===f&&(\"inline\"===b.mode?a.fn.editabletypes.datefield?f=\"datefield\":a.fn.editabletypes.dateuifield&&(f=\"dateuifield\"):a.fn.editabletypes.date?f=\"date\":a.fn.editabletypes.dateui&&(f=\"dateui\"),\"date\"!==f||a.fn.editabletypes.date||(f=\"combodate\")),\"datetime\"===f&&\"inline\"===b.mode&&(f=\"datetimefield\"),\"wysihtml5\"!==f||a.fn.editabletypes[f]||(f=\"textarea\"),\"function\"==typeof a.fn.editabletypes[f]?(c=a.fn.editabletypes[f],d=this.sliceObj(b,this.objectKeys(c.defaults)),e=new c(d)):(a.error(\"Unknown type: \"+f),!1)},supportsTransitions:function(){var a=document.body||document.documentElement,b=a.style,c=\"transition\",d=[\"Moz\",\"Webkit\",\"Khtml\",\"O\",\"ms\"];if(\"string\"==typeof b[c])return!0;c=c.charAt(0).toUpperCase()+c.substr(1);for(var e=0;e<d.length;e++)if(\"string\"==typeof b[d[e]+c])return!0;return!1}}}(window.jQuery),function(a){\"use strict\";var b=function(a,b){this.init(a,b)},c=function(a,b){this.init(a,b)};b.prototype={containerName:null,containerDataName:null,innerCss:null,containerClass:\"editable-container editable-popup\",defaults:{},init:function(c,d){this.$element=a(c),this.options=a.extend({},a.fn.editableContainer.defaults,d),this.splitOptions(),this.formOptions.scope=this.$element[0],this.initContainer(),this.delayedHide=!1,this.$element.on(\"destroyed\",a.proxy(function(){this.destroy()},this)),a(document).data(\"editable-handlers-attached\")||(a(document).on(\"keyup.editable\",function(b){27===b.which&&a(\".editable-open\").editableContainer(\"hide\")}),a(document).on(\"click.editable\",function(c){var d,e=a(c.target),f=[\".editable-container\",\".ui-datepicker-header\",\".datepicker\",\".modal-backdrop\",\".bootstrap-wysihtml5-insert-image-modal\",\".bootstrap-wysihtml5-insert-link-modal\"];if(a.contains(document.documentElement,c.target)&&!e.is(document)){for(d=0;d<f.length;d++)if(e.is(f[d])||e.parents(f[d]).length)return;b.prototype.closeOthers(c.target)}}),a(document).data(\"editable-handlers-attached\",!0))},splitOptions:function(){if(this.containerOptions={},this.formOptions={},!a.fn[this.containerName])throw new Error(this.containerName+\" not found. Have you included corresponding js file?\");for(var b in this.options)b in this.defaults?this.containerOptions[b]=this.options[b]:this.formOptions[b]=this.options[b]},tip:function(){return this.container()?this.container().$tip:null},container:function(){var a;return this.containerDataName&&(a=this.$element.data(this.containerDataName))?a:a=this.$element.data(this.containerName)},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editableform(this.formOptions).on({save:a.proxy(this.save,this),nochange:a.proxy(function(){this.hide(\"nochange\")},this),cancel:a.proxy(function(){this.hide(\"cancel\")},this),show:a.proxy(function(){this.delayedHide?(this.hide(this.delayedHide.reason),this.delayedHide=!1):this.setPosition()},this),rendering:a.proxy(this.setPosition,this),resize:a.proxy(this.setPosition,this),rendered:a.proxy(function(){this.$element.triggerHandler(\"shown\",a(this.options.scope).data(\"editable\"))},this)}).editableform(\"render\")},show:function(b){this.$element.addClass(\"editable-open\"),b!==!1&&this.closeOthers(this.$element[0]),this.innerShow(),this.tip().addClass(this.containerClass),this.$form,this.$form=a(\"<div>\"),this.tip().is(this.innerCss)?this.tip().append(this.$form):this.tip().find(this.innerCss).append(this.$form),this.renderForm()},hide:function(a){if(this.tip()&&this.tip().is(\":visible\")&&this.$element.hasClass(\"editable-open\")){if(this.$form.data(\"editableform\").isSaving)return this.delayedHide={reason:a},void 0;this.delayedHide=!1,this.$element.removeClass(\"editable-open\"),this.innerHide(),this.$element.triggerHandler(\"hidden\",a||\"manual\")}},innerShow:function(){},innerHide:function(){},toggle:function(a){this.container()&&this.tip()&&this.tip().is(\":visible\")?this.hide():this.show(a)},setPosition:function(){},save:function(a,b){this.$element.triggerHandler(\"save\",b),this.hide(\"save\")},option:function(a,b){this.options[a]=b,a in this.containerOptions?(this.containerOptions[a]=b,this.setContainerOption(a,b)):(this.formOptions[a]=b,this.$form&&this.$form.editableform(\"option\",a,b))},setContainerOption:function(a,b){this.call(\"option\",a,b)},destroy:function(){this.hide(),this.innerDestroy(),this.$element.off(\"destroyed\"),this.$element.removeData(\"editableContainer\")},innerDestroy:function(){},closeOthers:function(b){a(\".editable-open\").each(function(c,d){if(d!==b&&!a(d).find(b).length){var e=a(d),f=e.data(\"editableContainer\");f&&(\"cancel\"===f.options.onblur?e.data(\"editableContainer\").hide(\"onblur\"):\"submit\"===f.options.onblur&&e.data(\"editableContainer\").tip().find(\"form\").submit())}})},activate:function(){this.tip&&this.tip().is(\":visible\")&&this.$form&&this.$form.data(\"editableform\").input.activate()}},a.fn.editableContainer=function(d){var e=arguments;return this.each(function(){var f=a(this),g=\"editableContainer\",h=f.data(g),i=\"object\"==typeof d&&d,j=\"inline\"===i.mode?c:b;h||f.data(g,h=new j(this,i)),\"string\"==typeof d&&h[d].apply(h,Array.prototype.slice.call(e,1))})},a.fn.editableContainer.Popup=b,a.fn.editableContainer.Inline=c,a.fn.editableContainer.defaults={value:null,placement:\"top\",autohide:!0,onblur:\"cancel\",anim:!1,mode:\"popup\"},jQuery.event.special.destroyed={remove:function(a){a.handler&&a.handler()}}}(window.jQuery),function(a){\"use strict\";a.extend(a.fn.editableContainer.Inline.prototype,a.fn.editableContainer.Popup.prototype,{containerName:\"editableform\",innerCss:\".editable-inline\",containerClass:\"editable-container editable-inline\",initContainer:function(){this.$tip=a(\"<span></span>\"),this.options.anim||(this.options.anim=0)},splitOptions:function(){this.containerOptions={},this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide(),this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,a.proxy(function(){this.$element.show(),this.innerDestroy()},this))},innerDestroy:function(){this.tip()&&this.tip().empty().remove()}})}(window.jQuery),function(a){\"use strict\";var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.editable.defaults,c,a.fn.editableutils.getConfigData(this.$element)),this.options.selector?this.initLive():this.init(),this.options.highlight&&!a.fn.editableutils.supportsTransitions()&&(this.options.highlight=!1)};b.prototype={constructor:b,init:function(){var b,c=!1;if(this.options.name=this.options.name||this.$element.attr(\"id\"),this.options.scope=this.$element[0],this.input=a.fn.editableutils.createInput(this.options),this.input){switch(void 0===this.options.value||null===this.options.value?(this.value=this.input.html2value(a.trim(this.$element.html())),c=!0):(this.options.value=a.fn.editableutils.tryParseJson(this.options.value,!0),this.value=\"string\"==typeof this.options.value?this.input.str2value(this.options.value):this.options.value),this.$element.addClass(\"editable\"),\"textarea\"===this.input.type&&this.$element.addClass(\"editable-pre-wrapped\"),\"manual\"!==this.options.toggle?(this.$element.addClass(\"editable-click\"),this.$element.on(this.options.toggle+\".editable\",a.proxy(function(a){if(this.options.disabled||a.preventDefault(),\"mouseenter\"===this.options.toggle)this.show();else{var b=\"click\"!==this.options.toggle;this.toggle(b)}},this))):this.$element.attr(\"tabindex\",-1),\"function\"==typeof this.options.display&&(this.options.autotext=\"always\"),this.options.autotext){case\"always\":b=!0;break;case\"auto\":b=!a.trim(this.$element.text()).length&&null!==this.value&&void 0!==this.value&&!c;break;default:b=!1}a.when(b?this.render():!0).then(a.proxy(function(){this.options.disabled?this.disable():this.enable(),this.$element.triggerHandler(\"init\",this)},this))}},initLive:function(){var b=this.options.selector;this.options.selector=!1,this.options.autotext=\"never\",this.$element.on(this.options.toggle+\".editable\",b,a.proxy(function(b){var c=a(b.target);c.data(\"editable\")||(c.hasClass(this.options.emptyclass)&&c.empty(),c.editable(this.options).trigger(b))},this))},render:function(a){return this.options.display!==!1?this.input.value2htmlFinal?this.input.value2html(this.value,this.$element[0],this.options.display,a):\"function\"==typeof this.options.display?this.options.display.call(this.$element[0],this.value,a):this.input.value2html(this.value,this.$element[0]):void 0},enable:function(){this.options.disabled=!1,this.$element.removeClass(\"editable-disabled\"),this.handleEmpty(this.isEmpty),\"manual\"!==this.options.toggle&&\"-1\"===this.$element.attr(\"tabindex\")&&this.$element.removeAttr(\"tabindex\")},disable:function(){this.options.disabled=!0,this.hide(),this.$element.addClass(\"editable-disabled\"),this.handleEmpty(this.isEmpty),this.$element.attr(\"tabindex\",-1)},toggleDisabled:function(){this.options.disabled?this.enable():this.disable()},option:function(b,c){return b&&\"object\"==typeof b?(a.each(b,a.proxy(function(b,c){this.option(a.trim(b),c)},this)),void 0):(this.options[b]=c,\"disabled\"===b?c?this.disable():this.enable():(\"value\"===b&&this.setValue(c),this.container&&this.container.option(b,c),this.input.option&&this.input.option(b,c),void 0))},handleEmpty:function(b){this.options.display!==!1&&(this.isEmpty=void 0!==b?b:\"function\"==typeof this.input.isEmpty?this.input.isEmpty(this.$element):\"\"===a.trim(this.$element.html()),this.options.disabled?this.isEmpty&&(this.$element.empty(),this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass)):this.isEmpty?(this.$element.html(this.options.emptytext),this.options.emptyclass&&this.$element.addClass(this.options.emptyclass)):this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass))},show:function(b){if(!this.options.disabled){if(this.container){if(this.container.tip().is(\":visible\"))return}else{var c=a.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(c),this.$element.on(\"save.internal\",a.proxy(this.save,this)),this.container=this.$element.data(\"editableContainer\")}this.container.show(b)}},hide:function(){this.container&&this.container.hide()},toggle:function(a){this.container&&this.container.tip().is(\":visible\")?this.hide():this.show(a)},save:function(a,b){if(this.options.unsavedclass){var c=!1;c=c||\"function\"==typeof this.options.url,c=c||this.options.display===!1,c=c||void 0!==b.response,c=c||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(b.newValue),c?this.$element.removeClass(this.options.unsavedclass):this.$element.addClass(this.options.unsavedclass)}if(this.options.highlight){var d=this.$element,e=d.css(\"background-color\");d.css(\"background-color\",this.options.highlight),setTimeout(function(){\"transparent\"===e&&(e=\"\"),d.css(\"background-color\",e),d.addClass(\"editable-bg-transition\"),setTimeout(function(){d.removeClass(\"editable-bg-transition\")},1700)},10)}this.setValue(b.newValue,!1,b.response)},validate:function(){return\"function\"==typeof this.options.validate?this.options.validate.call(this,this.value):void 0},setValue:function(b,c,d){this.value=c?this.input.str2value(b):b,this.container&&this.container.option(\"value\",this.value),a.when(this.render(d)).then(a.proxy(function(){this.handleEmpty()},this))},activate:function(){this.container&&this.container.activate()},destroy:function(){this.disable(),this.container&&this.container.destroy(),this.input.destroy(),\"manual\"!==this.options.toggle&&(this.$element.removeClass(\"editable-click\"),this.$element.off(this.options.toggle+\".editable\")),this.$element.off(\"save.internal\"),this.$element.removeClass(\"editable editable-open editable-disabled\"),this.$element.removeData(\"editable\")}},a.fn.editable=function(c){var d={},e=arguments,f=\"editable\";switch(c){case\"validate\":return this.each(function(){var b,c=a(this),e=c.data(f);e&&(b=e.validate())&&(d[e.options.name]=b)}),d;case\"getValue\":return 2===arguments.length&&arguments[1]===!0?d=this.eq(0).data(f).value:this.each(function(){var b=a(this),c=b.data(f);c&&void 0!==c.value&&null!==c.value&&(d[c.options.name]=c.input.value2submit(c.value))}),d;case\"submit\":var g=arguments[1]||{},h=this,i=this.editable(\"validate\");if(a.isEmptyObject(i)){var j={};if(1===h.length){var k=h.data(\"editable\"),l={name:k.options.name||\"\",value:k.input.value2submit(k.value),pk:\"function\"==typeof k.options.pk?k.options.pk.call(k.options.scope):k.options.pk};\"function\"==typeof k.options.params?l=k.options.params.call(k.options.scope,l):(k.options.params=a.fn.editableutils.tryParseJson(k.options.params,!0),a.extend(l,k.options.params)),j={url:k.options.url,data:l,type:\"POST\"},g.success=g.success||k.options.success,g.error=g.error||k.options.error}else{var m=this.editable(\"getValue\");j={url:g.url,data:m,type:\"POST\"}}j.success=\"function\"==typeof g.success?function(a){g.success.call(h,a,g)}:a.noop,j.error=\"function\"==typeof g.error?function(){g.error.apply(h,arguments)}:a.noop,g.ajaxOptions&&a.extend(j,g.ajaxOptions),g.data&&a.extend(j.data,g.data),a.ajax(j)}else\"function\"==typeof g.error&&g.error.call(h,i);return this}return this.each(function(){var d=a(this),g=d.data(f),h=\"object\"==typeof c&&c;return h&&h.selector?(g=new b(this,h),void 0):(g||d.data(f,g=new b(this,h)),\"string\"==typeof c&&g[c].apply(g,Array.prototype.slice.call(e,1)),void 0)})},a.fn.editable.defaults={type:\"text\",disabled:!1,toggle:\"click\",emptytext:\"Empty\",autotext:\"auto\",value:null,display:null,emptyclass:\"editable-empty\",unsavedclass:\"editable-unsaved\",selector:null,highlight:\"#FFFF80\"}}(window.jQuery),function(a){\"use strict\";a.fn.editabletypes={};var b=function(){};b.prototype={init:function(b,c,d){this.type=b,this.options=a.extend({},d,c)},prerender:function(){this.$tpl=a(this.options.tpl),this.$input=this.$tpl,this.$clear=null,this.error=null},render:function(){},value2html:function(b,c){a(c)[this.options.escape?\"text\":\"html\"](a.trim(b))},html2value:function(b){return a(\"<div>\").html(b).text()},value2str:function(a){return a},str2value:function(a){return a},value2submit:function(a){return a},value2input:function(a){this.$input.val(a)},input2value:function(){return this.$input.val()},activate:function(){this.$input.is(\":visible\")&&this.$input.focus()},clear:function(){this.$input.val(null)},escape:function(b){return a(\"<div>\").text(b).html()},autosubmit:function(){},destroy:function(){},setClass:function(){this.options.inputclass&&this.$input.addClass(this.options.inputclass)},setAttr:function(a){void 0!==this.options[a]&&null!==this.options[a]&&this.$input.attr(a,this.options[a])},option:function(a,b){this.options[a]=b}},b.defaults={tpl:\"\",inputclass:null,escape:!0,scope:null,showbuttons:!0},a.extend(a.fn.editabletypes,{abstractinput:b})}(window.jQuery),function(a){\"use strict\";var b=function(){};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){var b=a.Deferred();return this.error=null,this.onSourceReady(function(){this.renderList(),b.resolve()},function(){this.error=this.options.sourceError,b.resolve()}),b.promise()},html2value:function(){return null},value2html:function(b,c,d,e){var f=a.Deferred(),g=function(){\"function\"==typeof d?d.call(c,b,this.sourceData,e):this.value2htmlFinal(b,c),f.resolve()};return null===b?g.call(this):this.onSourceReady(g,function(){f.resolve()}),f.promise()},onSourceReady:function(b,c){var d;if(a.isFunction(this.options.source)?(d=this.options.source.call(this.options.scope),this.sourceData=null):d=this.options.source,this.options.sourceCache&&a.isArray(this.sourceData))return b.call(this),void 0;try{d=a.fn.editableutils.tryParseJson(d,!1)}catch(e){return c.call(this),void 0}if(\"string\"==typeof d){if(this.options.sourceCache){var f,g=d;if(a(document).data(g)||a(document).data(g,{}),f=a(document).data(g),f.loading===!1&&f.sourceData)return this.sourceData=f.sourceData,this.doPrepend(),b.call(this),void 0;if(f.loading===!0)return f.callbacks.push(a.proxy(function(){this.sourceData=f.sourceData,this.doPrepend(),b.call(this)},this)),f.err_callbacks.push(a.proxy(c,this)),void 0;f.loading=!0,f.callbacks=[],f.err_callbacks=[]}var h=a.extend({url:d,type:\"get\",cache:!1,dataType:\"json\",success:a.proxy(function(d){f&&(f.loading=!1),this.sourceData=this.makeArray(d),a.isArray(this.sourceData)?(f&&(f.sourceData=this.sourceData,a.each(f.callbacks,function(){this.call()})),this.doPrepend(),b.call(this)):(c.call(this),f&&a.each(f.err_callbacks,function(){this.call()}))},this),error:a.proxy(function(){c.call(this),f&&(f.loading=!1,a.each(f.err_callbacks,function(){this.call()}))},this)},this.options.sourceOptions);a.ajax(h)}else this.sourceData=this.makeArray(d),a.isArray(this.sourceData)?(this.doPrepend(),b.call(this)):c.call(this)},doPrepend:function(){null!==this.options.prepend&&void 0!==this.options.prepend&&(a.isArray(this.prependData)||(a.isFunction(this.options.prepend)&&(this.options.prepend=this.options.prepend.call(this.options.scope)),this.options.prepend=a.fn.editableutils.tryParseJson(this.options.prepend,!0),\"string\"==typeof this.options.prepend&&(this.options.prepend={\"\":this.options.prepend}),this.prependData=this.makeArray(this.options.prepend)),a.isArray(this.prependData)&&a.isArray(this.sourceData)&&(this.sourceData=this.prependData.concat(this.sourceData)))},renderList:function(){},value2htmlFinal:function(){},makeArray:function(b){var c,d,e,f,g=[];if(!b||\"string\"==typeof b)return null;if(a.isArray(b)){f=function(a,b){return d={value:a,text:b},c++>=2?!1:void 0};for(var h=0;h<b.length;h++)e=b[h],\"object\"==typeof e?(c=0,a.each(e,f),1===c?g.push(d):c>1&&(e.children&&(e.children=this.makeArray(e.children)),g.push(e))):g.push({value:e,text:e})}else a.each(b,function(a,b){g.push({value:a,text:b})});return g},option:function(a,b){this.options[a]=b,\"source\"===a&&(this.sourceData=null),\"prepend\"===a&&(this.prependData=null)}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{source:null,prepend:!1,sourceError:\"Error when loading list\",sourceCache:!0,sourceOptions:null}),a.fn.editabletypes.list=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"text\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.renderClear(),this.setClass(),this.setAttr(\"placeholder\")},activate:function(){this.$input.is(\":visible\")&&(this.$input.focus(),a.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.toggleClear&&this.toggleClear())},renderClear:function(){this.options.clear&&(this.$clear=a('<span class=\"editable-clear-x\"></span>'),this.$input.after(this.$clear).css(\"padding-right\",24).keyup(a.proxy(function(b){if(!~a.inArray(b.keyCode,[40,38,9,13,27])){clearTimeout(this.t);var c=this;this.t=setTimeout(function(){c.toggleClear(b)},100)}},this)).parent().css(\"position\",\"relative\"),this.$clear.click(a.proxy(this.clear,this)))},postrender:function(){},toggleClear:function(){if(this.$clear){var a=this.$input.val().length,b=this.$clear.is(\":visible\");a&&!b&&this.$clear.show(),!a&&b&&this.$clear.hide()}},clear:function(){this.$clear.hide(),this.$input.val(\"\").focus()}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<input type=\"text\">',placeholder:null,clear:!0}),a.fn.editabletypes.text=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"textarea\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.setClass(),this.setAttr(\"placeholder\"),this.setAttr(\"rows\"),this.$input.keydown(function(b){b.ctrlKey&&13===b.which&&a(this).closest(\"form\").submit()})},activate:function(){a.fn.editabletypes.text.prototype.activate.call(this)}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:\"<textarea></textarea>\",inputclass:\"input-large\",placeholder:null,rows:7}),a.fn.editabletypes.textarea=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"select\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.list),a.extend(b.prototype,{renderList:function(){this.$input.empty();var b=function(c,d){var e;if(a.isArray(d))for(var f=0;f<d.length;f++)e={},d[f].children?(e.label=d[f].text,c.append(b(a(\"<optgroup>\",e),d[f].children))):(e.value=d[f].value,d[f].disabled&&(e.disabled=!0),c.append(a(\"<option>\",e).text(d[f].text)));return c};b(this.$input,this.sourceData),this.setClass(),this.$input.on(\"keydown.editable\",function(b){13===b.which&&a(this).closest(\"form\").submit()})},value2htmlFinal:function(b,c){var d=\"\",e=a.fn.editableutils.itemsByValue(b,this.sourceData);e.length&&(d=e[0].text),a.fn.editabletypes.abstractinput.prototype.value2html.call(this,d,c)},autosubmit:function(){this.$input.off(\"keydown.editable\").on(\"change.editable\",function(){a(this).closest(\"form\").submit()})}}),b.defaults=a.extend({},a.fn.editabletypes.list.defaults,{tpl:\"<select></select>\"}),a.fn.editabletypes.select=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"checklist\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.list),a.extend(b.prototype,{renderList:function(){var b;if(this.$tpl.empty(),a.isArray(this.sourceData)){for(var c=0;c<this.sourceData.length;c++)b=a(\"<label>\").append(a(\"<input>\",{type:\"checkbox\",value:this.sourceData[c].value})).append(a(\"<span>\").text(\" \"+this.sourceData[c].text)),a(\"<div>\").append(b).appendTo(this.$tpl);this.$input=this.$tpl.find('input[type=\"checkbox\"]'),this.setClass()}},value2str:function(b){return a.isArray(b)?b.sort().join(a.trim(this.options.separator)):\"\"},str2value:function(b){var c,d=null;return\"string\"==typeof b&&b.length?(c=new RegExp(\"\\\\s*\"+a.trim(this.options.separator)+\"\\\\s*\"),d=b.split(c)):d=a.isArray(b)?b:[b],d},value2input:function(b){this.$input.prop(\"checked\",!1),a.isArray(b)&&b.length&&this.$input.each(function(c,d){var e=a(d);a.each(b,function(a,b){e.val()==b&&e.prop(\"checked\",!0)})})},input2value:function(){var b=[];return this.$input.filter(\":checked\").each(function(c,d){b.push(a(d).val())}),b},value2htmlFinal:function(b,c){var d=[],e=a.fn.editableutils.itemsByValue(b,this.sourceData),f=this.options.escape;e.length?(a.each(e,function(b,c){var e=f?a.fn.editableutils.escape(c.text):c.text;d.push(e)}),a(c).html(d.join(\"<br>\"))):a(c).empty()},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on(\"keydown\",function(b){13===b.which&&a(this).closest(\"form\").submit()})}}),b.defaults=a.extend({},a.fn.editabletypes.list.defaults,{tpl:'<div class=\"editable-checklist\"></div>',inputclass:null,separator:\",\"}),a.fn.editabletypes.checklist=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"password\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),a.extend(b.prototype,{value2html:function(b,c){b?a(c).text(\"[hidden]\"):a(c).empty()},html2value:function(){return null}}),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type=\"password\">'}),a.fn.editabletypes.password=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"email\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type=\"email\">'}),a.fn.editabletypes.email=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"url\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type=\"url\">'}),a.fn.editabletypes.url=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"tel\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type=\"tel\">'}),a.fn.editabletypes.tel=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"number\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),a.extend(b.prototype,{render:function(){b.superclass.render.call(this),this.setAttr(\"min\"),this.setAttr(\"max\"),this.setAttr(\"step\")},postrender:function(){this.$clear&&this.$clear.css({right:24})}}),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type=\"number\">',inputclass:\"input-mini\",min:null,max:null,step:null}),a.fn.editabletypes.number=b}(window.jQuery),function(a){\"use strict\";\r\nvar b=function(a){this.init(\"range\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.number),a.extend(b.prototype,{render:function(){this.$input=this.$tpl.filter(\"input\"),this.setClass(),this.setAttr(\"min\"),this.setAttr(\"max\"),this.setAttr(\"step\"),this.$input.on(\"input\",function(){a(this).siblings(\"output\").text(a(this).val())})},activate:function(){this.$input.focus()}}),b.defaults=a.extend({},a.fn.editabletypes.number.defaults,{tpl:'<input type=\"range\"><output style=\"width: 30px; display: inline-block\"></output>',inputclass:\"input-medium\"}),a.fn.editabletypes.range=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"time\",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.setClass()}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<input type=\"time\">'}),a.fn.editabletypes.time=b}(window.jQuery),function(a){\"use strict\";var b=function(c){if(this.init(\"select2\",c,b.defaults),c.select2=c.select2||{},this.sourceData=null,c.placeholder&&(c.select2.placeholder=c.placeholder),!c.select2.tags&&c.source){var d=c.source;a.isFunction(c.source)&&(d=c.source.call(c.scope)),\"string\"==typeof d?(c.select2.ajax=c.select2.ajax||{},c.select2.ajax.data||(c.select2.ajax.data=function(a){return{query:a}}),c.select2.ajax.results||(c.select2.ajax.results=function(a){return{results:a}}),c.select2.ajax.url=d):(this.sourceData=this.convertSource(d),c.select2.data=this.sourceData)}if(this.options.select2=a.extend({},b.defaults.select2,c.select2),this.isMultiple=this.options.select2.tags||this.options.select2.multiple,this.isRemote=\"ajax\"in this.options.select2,this.idFunc=this.options.select2.id,\"function\"!=typeof this.idFunc){var e=this.idFunc||\"id\";this.idFunc=function(a){return a[e]}}this.formatSelection=this.options.select2.formatSelection,\"function\"!=typeof this.formatSelection&&(this.formatSelection=function(a){return a.text})};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.setClass(),this.isRemote&&this.$input.on(\"select2-loaded\",a.proxy(function(a){this.sourceData=a.items.results},this)),this.isMultiple&&this.$input.on(\"change\",function(){a(this).closest(\"form\").parent().triggerHandler(\"resize\")})},value2html:function(c,d){var e,f=\"\",g=this;this.options.select2.tags?e=c:this.sourceData&&(e=a.fn.editableutils.itemsByValue(c,this.sourceData,this.idFunc)),a.isArray(e)?(f=[],a.each(e,function(a,b){f.push(b&&\"object\"==typeof b?g.formatSelection(b):b)})):e&&(f=g.formatSelection(e)),f=a.isArray(f)?f.join(this.options.viewseparator):f,b.superclass.value2html.call(this,f,d)},html2value:function(a){return this.options.select2.tags?this.str2value(a,this.options.viewseparator):null},value2input:function(b){if(a.isArray(b)&&(b=b.join(this.getSeparator())),this.$input.data(\"select2\")?this.$input.val(b).trigger(\"change\",!0):(this.$input.val(b),this.$input.select2(this.options.select2)),this.isRemote&&!this.isMultiple&&!this.options.select2.initSelection){var c=this.options.select2.id,d=this.options.select2.formatSelection;if(!c&&!d){var e=a(this.options.scope);if(!e.data(\"editable\").isEmpty){var f={id:b,text:e.text()};this.$input.select2(\"data\",f)}}}},input2value:function(){return this.$input.select2(\"val\")},str2value:function(b,c){if(\"string\"!=typeof b||!this.isMultiple)return b;c=c||this.getSeparator();var d,e,f;if(null===b||b.length<1)return null;for(d=b.split(c),e=0,f=d.length;f>e;e+=1)d[e]=a.trim(d[e]);return d},autosubmit:function(){this.$input.on(\"change\",function(b,c){c||a(this).closest(\"form\").submit()})},getSeparator:function(){return this.options.select2.separator||a.fn.select2.defaults.separator},convertSource:function(b){if(a.isArray(b)&&b.length&&void 0!==b[0].value)for(var c=0;c<b.length;c++)void 0!==b[c].value&&(b[c].id=b[c].value,delete b[c].value);return b},destroy:function(){this.$input.data(\"select2\")&&this.$input.select2(\"destroy\")}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<input type=\"hidden\">',select2:null,placeholder:null,source:null,viewseparator:\", \"}),a.fn.editabletypes.select2=b}(window.jQuery),function(a){var b=function(b,c){return this.$element=a(b),this.$element.is(\"input\")?(this.options=a.extend({},a.fn.combodate.defaults,c,this.$element.data()),this.init(),void 0):(a.error(\"Combodate should be applied to INPUT element\"),void 0)};b.prototype={constructor:b,init:function(){this.map={day:[\"D\",\"date\"],month:[\"M\",\"month\"],year:[\"Y\",\"year\"],hour:[\"[Hh]\",\"hours\"],minute:[\"m\",\"minutes\"],second:[\"s\",\"seconds\"],ampm:[\"[Aa]\",\"\"]},this.$widget=a('<span class=\"combodate\"></span>').html(this.getTemplate()),this.initCombos(),this.$widget.on(\"change\",\"select\",a.proxy(function(b){this.$element.val(this.getValue()).change(),this.options.smartDays&&(a(b.target).is(\".month\")||a(b.target).is(\".year\"))&&this.fillCombo(\"day\")},this)),this.$widget.find(\"select\").css(\"width\",\"auto\"),this.$element.hide().after(this.$widget),this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var b=this.options.template;return a.each(this.map,function(a,c){c=c[0];var d=new RegExp(c+\"+\"),e=c.length>1?c.substring(1,2):c;b=b.replace(d,\"{\"+e+\"}\")}),b=b.replace(/ /g,\"&nbsp;\"),a.each(this.map,function(a,c){c=c[0];var d=c.length>1?c.substring(1,2):c;b=b.replace(\"{\"+d+\"}\",'<select class=\"'+a+'\"></select>')}),b},initCombos:function(){for(var a in this.map){var b=this.$widget.find(\".\"+a);this[\"$\"+a]=b.length?b:null,this.fillCombo(a)}},fillCombo:function(a){var b=this[\"$\"+a];if(b){var c=\"fill\"+a.charAt(0).toUpperCase()+a.slice(1),d=this[c](),e=b.val();b.empty();for(var f=0;f<d.length;f++)b.append('<option value=\"'+d[f][0]+'\">'+d[f][1]+\"</option>\");b.val(e)}},fillCommon:function(a){var b,c=[];if(\"name\"===this.options.firstItem){b=moment.relativeTime||moment.langData()._relativeTime;var d=\"function\"==typeof b[a]?b[a](1,!0,a,!1):b[a];d=d.split(\" \").reverse()[0],c.push([\"\",d])}else\"empty\"===this.options.firstItem&&c.push([\"\",\"\"]);return c},fillDay:function(){var a,b,c=this.fillCommon(\"d\"),d=-1!==this.options.template.indexOf(\"DD\"),e=31;if(this.options.smartDays&&this.$month&&this.$year){var f=parseInt(this.$month.val(),10),g=parseInt(this.$year.val(),10);isNaN(f)||isNaN(g)||(e=moment([g,f]).daysInMonth())}for(b=1;e>=b;b++)a=d?this.leadZero(b):b,c.push([b,a]);return c},fillMonth:function(){var a,b,c=this.fillCommon(\"M\"),d=-1!==this.options.template.indexOf(\"MMMM\"),e=-1!==this.options.template.indexOf(\"MMM\"),f=-1!==this.options.template.indexOf(\"MM\");for(b=0;11>=b;b++)a=d?moment().date(1).month(b).format(\"MMMM\"):e?moment().date(1).month(b).format(\"MMM\"):f?this.leadZero(b+1):b+1,c.push([b,a]);return c},fillYear:function(){var a,b,c=[],d=-1!==this.options.template.indexOf(\"YYYY\");for(b=this.options.maxYear;b>=this.options.minYear;b--)a=d?b:(b+\"\").substring(2),c[this.options.yearDescending?\"push\":\"unshift\"]([b,a]);return c=this.fillCommon(\"y\").concat(c)},fillHour:function(){var a,b,c=this.fillCommon(\"h\"),d=-1!==this.options.template.indexOf(\"h\"),e=(-1!==this.options.template.indexOf(\"H\"),-1!==this.options.template.toLowerCase().indexOf(\"hh\")),f=d?1:0,g=d?12:23;for(b=f;g>=b;b++)a=e?this.leadZero(b):b,c.push([b,a]);return c},fillMinute:function(){var a,b,c=this.fillCommon(\"m\"),d=-1!==this.options.template.indexOf(\"mm\");for(b=0;59>=b;b+=this.options.minuteStep)a=d?this.leadZero(b):b,c.push([b,a]);return c},fillSecond:function(){var a,b,c=this.fillCommon(\"s\"),d=-1!==this.options.template.indexOf(\"ss\");for(b=0;59>=b;b+=this.options.secondStep)a=d?this.leadZero(b):b,c.push([b,a]);return c},fillAmpm:function(){var a=-1!==this.options.template.indexOf(\"a\"),b=(-1!==this.options.template.indexOf(\"A\"),[[\"am\",a?\"am\":\"AM\"],[\"pm\",a?\"pm\":\"PM\"]]);return b},getValue:function(b){var c,d={},e=this,f=!1;return a.each(this.map,function(a){if(\"ampm\"!==a){var b=\"day\"===a?1:0;return d[a]=e[\"$\"+a]?parseInt(e[\"$\"+a].val(),10):b,isNaN(d[a])?(f=!0,!1):void 0}}),f?\"\":(this.$ampm&&(d.hour=12===d.hour?\"am\"===this.$ampm.val()?0:12:\"am\"===this.$ampm.val()?d.hour:d.hour+12),c=moment([d.year,d.month,d.day,d.hour,d.minute,d.second]),this.highlight(c),b=void 0===b?this.options.format:b,null===b?c.isValid()?c:null:c.isValid()?c.format(b):\"\")},setValue:function(b){function c(b,c){var d={};return b.children(\"option\").each(function(b,e){var f,g=a(e).attr(\"value\");\"\"!==g&&(f=Math.abs(g-c),(\"undefined\"==typeof d.distance||f<d.distance)&&(d={value:g,distance:f}))}),d.value}if(b){var d=\"string\"==typeof b?moment(b,this.options.format):moment(b),e=this,f={};d.isValid()&&(a.each(this.map,function(a,b){\"ampm\"!==a&&(f[a]=d[b[1]]())}),this.$ampm&&(f.hour>=12?(f.ampm=\"pm\",f.hour>12&&(f.hour-=12)):(f.ampm=\"am\",0===f.hour&&(f.hour=12))),a.each(f,function(a,b){e[\"$\"+a]&&(\"minute\"===a&&e.options.minuteStep>1&&e.options.roundTime&&(b=c(e[\"$\"+a],b)),\"second\"===a&&e.options.secondStep>1&&e.options.roundTime&&(b=c(e[\"$\"+a],b)),e[\"$\"+a].val(b))}),this.options.smartDays&&this.fillCombo(\"day\"),this.$element.val(d.format(this.options.format)).change())}},highlight:function(a){a.isValid()?this.options.errorClass?this.$widget.removeClass(this.options.errorClass):this.$widget.find(\"select\").css(\"border-color\",this.borderColor):this.options.errorClass?this.$widget.addClass(this.options.errorClass):(this.borderColor||(this.borderColor=this.$widget.find(\"select\").css(\"border-color\")),this.$widget.find(\"select\").css(\"border-color\",\"red\"))},leadZero:function(a){return 9>=a?\"0\"+a:a},destroy:function(){this.$widget.remove(),this.$element.removeData(\"combodate\").show()}},a.fn.combodate=function(c){var d,e=Array.apply(null,arguments);return e.shift(),\"getValue\"===c&&this.length&&(d=this.eq(0).data(\"combodate\"))?d.getValue.apply(d,e):this.each(function(){var d=a(this),f=d.data(\"combodate\"),g=\"object\"==typeof c&&c;f||d.data(\"combodate\",f=new b(this,g)),\"string\"==typeof c&&\"function\"==typeof f[c]&&f[c].apply(f,e)})},a.fn.combodate.defaults={format:\"DD-MM-YYYY HH:mm\",template:\"D / MMM / YYYY   H : mm\",value:null,minYear:1970,maxYear:2015,yearDescending:!0,minuteStep:5,secondStep:1,firstItem:\"empty\",errorClass:null,roundTime:!0,smartDays:!1}}(window.jQuery),function(a){\"use strict\";var b=function(c){this.init(\"combodate\",c,b.defaults),this.options.viewformat||(this.options.viewformat=this.options.format),c.combodate=a.fn.editableutils.tryParseJson(c.combodate,!0),this.options.combodate=a.extend({},b.defaults.combodate,c.combodate,{format:this.options.format,template:this.options.template})};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.$input.combodate(this.options.combodate),\"bs3\"===a.fn.editableform.engine&&this.$input.siblings().find(\"select\").addClass(\"form-control\"),this.options.inputclass&&this.$input.siblings().find(\"select\").addClass(this.options.inputclass)},value2html:function(a,c){var d=a?a.format(this.options.viewformat):\"\";b.superclass.value2html.call(this,d,c)},html2value:function(a){return a?moment(a,this.options.viewformat):null},value2str:function(a){return a?a.format(this.options.format):\"\"},str2value:function(a){return a?moment(a,this.options.format):null},value2submit:function(a){return this.value2str(a)},value2input:function(a){this.$input.combodate(\"setValue\",a)},input2value:function(){return this.$input.combodate(\"getValue\",null)},activate:function(){this.$input.siblings(\".combodate\").find(\"select\").eq(0).focus()},autosubmit:function(){}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<input type=\"text\">',inputclass:null,format:\"YYYY-MM-DD\",viewformat:null,template:\"D / MMM / YYYY\",combodate:null}),a.fn.editabletypes.combodate=b}(window.jQuery),function(a){\"use strict\";var b=a.fn.editableform.Constructor.prototype.initInput;a.extend(a.fn.editableform.Constructor.prototype,{initTemplate:function(){this.$form=a(a.fn.editableform.template),this.$form.find(\".control-group\").addClass(\"form-group\"),this.$form.find(\".editable-error-block\").addClass(\"help-block\")},initInput:function(){b.apply(this);var c=null===this.input.options.inputclass||this.input.options.inputclass===!1,d=\"input-sm\",e=\"text,select,textarea,password,email,url,tel,number,range,time,typeaheadjs\".split(\",\");~a.inArray(this.input.type,e)&&(this.input.$input.addClass(\"form-control\"),c&&(this.input.options.inputclass=d,this.input.$input.addClass(d)));for(var f=this.$form.find(\".editable-buttons\"),g=c?[d]:this.input.options.inputclass.split(\" \"),h=0;h<g.length;h++)\"input-lg\"===g[h].toLowerCase()&&f.find(\"button\").removeClass(\"btn-sm\").addClass(\"btn-lg\")}}),a.fn.editableform.buttons='<button type=\"submit\" class=\"btn btn-primary btn-sm editable-submit\"><i class=\"glyphicon glyphicon-ok\"></i></button><button type=\"button\" class=\"btn btn-default btn-sm editable-cancel\"><i class=\"glyphicon glyphicon-remove\"></i></button>',a.fn.editableform.errorGroupClass=\"has-error\",a.fn.editableform.errorBlockClass=null,a.fn.editableform.engine=\"bs3\"}(window.jQuery),function(a){\"use strict\";a.extend(a.fn.editableContainer.Popup.prototype,{containerName:\"popover\",containerDataName:\"bs.popover\",innerCss:\".popover-content\",defaults:a.fn.popover.Constructor.DEFAULTS,initContainer:function(){a.extend(this.containerOptions,{trigger:\"manual\",selector:!1,content:\" \",template:this.defaults.template});var b;this.$element.data(\"template\")&&(b=this.$element.data(\"template\"),this.$element.removeData(\"template\")),this.call(this.containerOptions),b&&this.$element.data(\"template\",b)},innerShow:function(){this.call(\"show\")},innerHide:function(){this.call(\"hide\")},innerDestroy:function(){this.call(\"destroy\")},setContainerOption:function(a,b){this.container().options[a]=b},setPosition:function(){!function(){var a=this.tip(),b=\"function\"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,c=/\\s?auto?\\s?/i,d=c.test(b);d&&(b=b.replace(c,\"\")||\"top\");var e=this.getPosition(),f=a[0].offsetWidth,g=a[0].offsetHeight;if(d){var h=this.$element.parent(),i=b,j=document.documentElement.scrollTop||document.body.scrollTop,k=\"body\"==this.options.container?window.innerWidth:h.outerWidth(),l=\"body\"==this.options.container?window.innerHeight:h.outerHeight(),m=\"body\"==this.options.container?0:h.offset().left;b=\"bottom\"==b&&e.top+e.height+g-j>l?\"top\":\"top\"==b&&e.top-j-g<0?\"bottom\":\"right\"==b&&e.right+f>k?\"left\":\"left\"==b&&e.left-f<m?\"right\":b,a.removeClass(i).addClass(b)}var n=this.getCalculatedOffset(b,e,f,g);this.applyPlacement(n,b)}.call(this.container())}})}(window.jQuery),function(a){function b(){return new Date(Date.UTC.apply(Date,arguments))}function c(b,c){var d,e=a(b).data(),f={},g=new RegExp(\"^\"+c.toLowerCase()+\"([A-Z])\"),c=new RegExp(\"^\"+c.toLowerCase());for(var h in e)c.test(h)&&(d=h.replace(g,function(a,b){return b.toLowerCase()}),f[d]=e[h]);return f}function d(b){var c={};if(k[b]||(b=b.split(\"-\")[0],k[b])){var d=k[b];return a.each(j,function(a,b){b in d&&(c[b]=d[b])}),c}}var e=function(b,c){this._process_options(c),this.element=a(b),this.isInline=!1,this.isInput=this.element.is(\"input\"),this.component=this.element.is(\".date\")?this.element.find(\".add-on, .btn\"):!1,this.hasInput=this.component&&this.element.find(\"input\").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=a(l.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass(\"datepicker-inline\").appendTo(this.element):this.picker.addClass(\"datepicker-dropdown dropdown-menu\"),this.o.rtl&&(this.picker.addClass(\"datepicker-rtl\"),this.picker.find(\".prev i, .next i\").toggleClass(\"icon-arrow-left icon-arrow-right\")),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find(\"tfoot th.today\").attr(\"colspan\",function(a,b){return parseInt(b)+1}),this._allow_update=!1,this.setStartDate(this.o.startDate),this.setEndDate(this.o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};e.prototype={constructor:e,_process_options:function(b){this._o=a.extend({},this._o,b);var c=this.o=a.extend({},this._o),d=c.language;switch(k[d]||(d=d.split(\"-\")[0],k[d]||(d=i.language)),c.language=d,c.startView){case 2:case\"decade\":c.startView=2;break;case 1:case\"year\":c.startView=1;break;default:c.startView=0}switch(c.minViewMode){case 1:case\"months\":c.minViewMode=1;break;case 2:case\"years\":c.minViewMode=2;break;default:c.minViewMode=0}c.startView=Math.max(c.startView,c.minViewMode),c.weekStart%=7,c.weekEnd=(c.weekStart+6)%7;var e=l.parseFormat(c.format);c.startDate!==-1/0&&(c.startDate=l.parseDate(c.startDate,e,c.language)),1/0!==c.endDate&&(c.endDate=l.parseDate(c.endDate,e,c.language)),c.daysOfWeekDisabled=c.daysOfWeekDisabled||[],a.isArray(c.daysOfWeekDisabled)||(c.daysOfWeekDisabled=c.daysOfWeekDisabled.split(/[,\\s]*/)),c.daysOfWeekDisabled=a.map(c.daysOfWeekDisabled,function(a){return parseInt(a,10)})},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var b,c,d=0;d<a.length;d++)b=a[d][0],c=a[d][1],b.on(c)},_unapplyEvents:function(a){for(var b,c,d=0;d<a.length;d++)b=a[d][0],c=a[d][1],b.off(c)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this),keydown:a.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find(\"input\"),{focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this),keydown:a.proxy(this.keydown,this)}],[this.component,{click:a.proxy(this.show,this)}]]:this.element.is(\"div\")?this.isInline=!0:this._events=[[this.element,{click:a.proxy(this.show,this)}]],this._secondaryEvents=[[this.picker,{click:a.proxy(this.click,this)}],[a(window),{resize:a.proxy(this.place,this)}],[a(document),{mousedown:a.proxy(function(a){this.element.is(a.target)||this.element.find(a.target).size()||this.picker.is(a.target)||this.picker.find(a.target).size()||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(b,c){var d=c||this.date,e=new Date(d.getTime()+6e4*d.getTimezoneOffset());this.element.trigger({type:b,date:e,format:a.proxy(function(a){var b=a||this.o.format;return l.formatDate(d,b,this.o.language)},this)})},show:function(a){this.isInline||this.picker.appendTo(\"body\"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),a&&a.preventDefault(),this._trigger(\"show\")},hide:function(){this.isInline||this.picker.is(\":visible\")&&(this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find(\"input\").val())&&this.setValue(),this._trigger(\"hide\"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},getDate:function(){var a=this.getUTCDate();return new Date(a.getTime()+6e4*a.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(a){this.setUTCDate(new Date(a.getTime()-6e4*a.getTimezoneOffset()))},setUTCDate:function(a){this.date=a,this.setValue()},setValue:function(){var a=this.getFormattedDate();this.isInput?this.element.val(a):this.component&&this.element.find(\"input\").val(a)},getFormattedDate:function(a){return void 0===a&&(a=this.o.format),l.formatDate(this.date,a,this.o.language)},setStartDate:function(a){this._process_options({startDate:a}),this.update(),this.updateNavArrows()},setEndDate:function(a){this._process_options({endDate:a}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(a){this._process_options({daysOfWeekDisabled:a}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var b=parseInt(this.element.parents().filter(function(){return\"auto\"!=a(this).css(\"z-index\")}).first().css(\"z-index\"))+10,c=this.component?this.component.parent().offset():this.element.offset(),d=this.component?this.component.outerHeight(!0):this.element.outerHeight(!0);this.picker.css({top:c.top+d,left:c.left,zIndex:b})}},_allow_update:!0,update:function(){if(this._allow_update){var a,b=!1;arguments&&arguments.length&&(\"string\"==typeof arguments[0]||arguments[0]instanceof Date)?(a=arguments[0],b=!0):(a=this.isInput?this.element.val():this.element.data(\"date\")||this.element.find(\"input\").val(),delete this.element.data().date),this.date=l.parseDate(a,this.o.format,this.o.language),b&&this.setValue(),this.viewDate=this.date<this.o.startDate?new Date(this.o.startDate):this.date>this.o.endDate?new Date(this.o.endDate):new Date(this.date),this.fill()}},fillDow:function(){var a=this.o.weekStart,b=\"<tr>\";if(this.o.calendarWeeks){var c='<th class=\"cw\">&nbsp;</th>';b+=c,this.picker.find(\".datepicker-days thead tr:first-child\").prepend(c)}for(;a<this.o.weekStart+7;)b+='<th class=\"dow\">'+k[this.o.language].daysMin[a++%7]+\"</th>\";b+=\"</tr>\",this.picker.find(\".datepicker-days thead\").append(b)},fillMonths:function(){for(var a=\"\",b=0;12>b;)a+='<span class=\"month\">'+k[this.o.language].monthsShort[b++]+\"</span>\";this.picker.find(\".datepicker-months td\").html(a)},setRange:function(b){b&&b.length?this.range=a.map(b,function(a){return a.valueOf()}):delete this.range,this.fill()},getClassNames:function(b){var c=[],d=this.viewDate.getUTCFullYear(),e=this.viewDate.getUTCMonth(),f=this.date.valueOf(),g=new Date;return b.getUTCFullYear()<d||b.getUTCFullYear()==d&&b.getUTCMonth()<e?c.push(\"old\"):(b.getUTCFullYear()>d||b.getUTCFullYear()==d&&b.getUTCMonth()>e)&&c.push(\"new\"),this.o.todayHighlight&&b.getUTCFullYear()==g.getFullYear()&&b.getUTCMonth()==g.getMonth()&&b.getUTCDate()==g.getDate()&&c.push(\"today\"),f&&b.valueOf()==f&&c.push(\"active\"),(b.valueOf()<this.o.startDate||b.valueOf()>this.o.endDate||-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekDisabled))&&c.push(\"disabled\"),this.range&&(b>this.range[0]&&b<this.range[this.range.length-1]&&c.push(\"range\"),-1!=a.inArray(b.valueOf(),this.range)&&c.push(\"selected\")),c},fill:function(){var c,d=new Date(this.viewDate),e=d.getUTCFullYear(),f=d.getUTCMonth(),g=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,h=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,i=1/0!==this.o.endDate?this.o.endDate.getUTCFullYear():1/0,j=1/0!==this.o.endDate?this.o.endDate.getUTCMonth():1/0;this.date&&this.date.valueOf(),this.picker.find(\".datepicker-days thead th.datepicker-switch\").text(k[this.o.language].months[f]+\" \"+e),this.picker.find(\"tfoot th.today\").text(k[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find(\"tfoot th.clear\").text(k[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var m=b(e,f-1,28,0,0,0,0),n=l.getDaysInMonth(m.getUTCFullYear(),m.getUTCMonth());m.setUTCDate(n),m.setUTCDate(n-(m.getUTCDay()-this.o.weekStart+7)%7);var o=new Date(m);o.setUTCDate(o.getUTCDate()+42),o=o.valueOf();for(var p,q=[];m.valueOf()<o;){if(m.getUTCDay()==this.o.weekStart&&(q.push(\"<tr>\"),this.o.calendarWeeks)){var r=new Date(+m+864e5*((this.o.weekStart-m.getUTCDay()-7)%7)),s=new Date(+r+864e5*((11-r.getUTCDay())%7)),t=new Date(+(t=b(s.getUTCFullYear(),0,1))+864e5*((11-t.getUTCDay())%7)),u=(s-t)/864e5/7+1;q.push('<td class=\"cw\">'+u+\"</td>\")}p=this.getClassNames(m),p.push(\"day\");var v=this.o.beforeShowDay(m);void 0===v?v={}:\"boolean\"==typeof v?v={enabled:v}:\"string\"==typeof v&&(v={classes:v}),v.enabled===!1&&p.push(\"disabled\"),v.classes&&(p=p.concat(v.classes.split(/\\s+/))),v.tooltip&&(c=v.tooltip),p=a.unique(p),q.push('<td class=\"'+p.join(\" \")+'\"'+(c?' title=\"'+c+'\"':\"\")+\">\"+m.getUTCDate()+\"</td>\"),m.getUTCDay()==this.o.weekEnd&&q.push(\"</tr>\"),m.setUTCDate(m.getUTCDate()+1)}this.picker.find(\".datepicker-days tbody\").empty().append(q.join(\"\"));var w=this.date&&this.date.getUTCFullYear(),x=this.picker.find(\".datepicker-months\").find(\"th:eq(1)\").text(e).end().find(\"span\").removeClass(\"active\");w&&w==e&&x.eq(this.date.getUTCMonth()).addClass(\"active\"),(g>e||e>i)&&x.addClass(\"disabled\"),e==g&&x.slice(0,h).addClass(\"disabled\"),e==i&&x.slice(j+1).addClass(\"disabled\"),q=\"\",e=10*parseInt(e/10,10);var y=this.picker.find(\".datepicker-years\").find(\"th:eq(1)\").text(e+\"-\"+(e+9)).end().find(\"td\");e-=1;for(var z=-1;11>z;z++)q+='<span class=\"year'+(-1==z?\" old\":10==z?\" new\":\"\")+(w==e?\" active\":\"\")+(g>e||e>i?\" disabled\":\"\")+'\">'+e+\"</span>\",e+=1;y.html(q)},updateNavArrows:function(){if(this._allow_update){var a=new Date(this.viewDate),b=a.getUTCFullYear(),c=a.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-1/0&&b<=this.o.startDate.getUTCFullYear()&&c<=this.o.startDate.getUTCMonth()?this.picker.find(\".prev\").css({visibility:\"hidden\"}):this.picker.find(\".prev\").css({visibility:\"visible\"}),1/0!==this.o.endDate&&b>=this.o.endDate.getUTCFullYear()&&c>=this.o.endDate.getUTCMonth()?this.picker.find(\".next\").css({visibility:\"hidden\"}):this.picker.find(\".next\").css({visibility:\"visible\"});break;case 1:case 2:this.o.startDate!==-1/0&&b<=this.o.startDate.getUTCFullYear()?this.picker.find(\".prev\").css({visibility:\"hidden\"}):this.picker.find(\".prev\").css({visibility:\"visible\"}),1/0!==this.o.endDate&&b>=this.o.endDate.getUTCFullYear()?this.picker.find(\".next\").css({visibility:\"hidden\"}):this.picker.find(\".next\").css({visibility:\"visible\"})}}},click:function(c){c.preventDefault();var d=a(c.target).closest(\"span, td, th\");if(1==d.length)switch(d[0].nodeName.toLowerCase()){case\"th\":switch(d[0].className){case\"datepicker-switch\":this.showMode(1);break;case\"prev\":case\"next\":var e=l.modes[this.viewMode].navStep*(\"prev\"==d[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,e);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,e)}this.fill();break;case\"today\":var f=new Date;f=b(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0),this.showMode(-2);var g=\"linked\"==this.o.todayBtn?null:\"view\";this._setDate(f,g);break;case\"clear\":var h;this.isInput?h=this.element:this.component&&(h=this.element.find(\"input\")),h&&h.val(\"\").change(),this._trigger(\"changeDate\"),this.update(),this.o.autoclose&&this.hide()}break;case\"span\":if(!d.is(\".disabled\")){if(this.viewDate.setUTCDate(1),d.is(\".month\")){var i=1,j=d.parent().find(\"span\").index(d),k=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(j),this._trigger(\"changeMonth\",this.viewDate),1===this.o.minViewMode&&this._setDate(b(k,j,i,0,0,0,0))}else{var k=parseInt(d.text(),10)||0,i=1,j=0;this.viewDate.setUTCFullYear(k),this._trigger(\"changeYear\",this.viewDate),2===this.o.minViewMode&&this._setDate(b(k,j,i,0,0,0,0))}this.showMode(-1),this.fill()}break;case\"td\":if(d.is(\".day\")&&!d.is(\".disabled\")){var i=parseInt(d.text(),10)||1,k=this.viewDate.getUTCFullYear(),j=this.viewDate.getUTCMonth();d.is(\".old\")?0===j?(j=11,k-=1):j-=1:d.is(\".new\")&&(11==j?(j=0,k+=1):j+=1),this._setDate(b(k,j,i,0,0,0,0))}}},_setDate:function(a,b){b&&\"date\"!=b||(this.date=new Date(a)),b&&\"view\"!=b||(this.viewDate=new Date(a)),this.fill(),this.setValue(),this._trigger(\"changeDate\");var c;this.isInput?c=this.element:this.component&&(c=this.element.find(\"input\")),c&&(c.change(),!this.o.autoclose||b&&\"date\"!=b||this.hide())},moveMonth:function(a,b){if(!b)return a;var c,d,e=new Date(a.valueOf()),f=e.getUTCDate(),g=e.getUTCMonth(),h=Math.abs(b);if(b=b>0?1:-1,1==h)d=-1==b?function(){return e.getUTCMonth()==g}:function(){return e.getUTCMonth()!=c},c=g+b,e.setUTCMonth(c),(0>c||c>11)&&(c=(c+12)%12);else{for(var i=0;h>i;i++)e=this.moveMonth(e,b);c=e.getUTCMonth(),e.setUTCDate(f),d=function(){return c!=e.getUTCMonth()}}for(;d();)e.setUTCDate(--f),e.setUTCMonth(c);return e},moveYear:function(a,b){return this.moveMonth(a,12*b)},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(this.picker.is(\":not(:visible)\"))return 27==a.keyCode&&this.show(),void 0;var b,c,d,e=!1;switch(a.keyCode){case 27:this.hide(),a.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;b=37==a.keyCode?-1:1,a.ctrlKey?(c=this.moveYear(this.date,b),d=this.moveYear(this.viewDate,b)):a.shiftKey?(c=this.moveMonth(this.date,b),d=this.moveMonth(this.viewDate,b)):(c=new Date(this.date),c.setUTCDate(this.date.getUTCDate()+b),d=new Date(this.viewDate),d.setUTCDate(this.viewDate.getUTCDate()+b)),this.dateWithinRange(c)&&(this.date=c,this.viewDate=d,this.setValue(),this.update(),a.preventDefault(),e=!0);break;case 38:case 40:if(!this.o.keyboardNavigation)break;b=38==a.keyCode?-1:1,a.ctrlKey?(c=this.moveYear(this.date,b),d=this.moveYear(this.viewDate,b)):a.shiftKey?(c=this.moveMonth(this.date,b),d=this.moveMonth(this.viewDate,b)):(c=new Date(this.date),c.setUTCDate(this.date.getUTCDate()+7*b),d=new Date(this.viewDate),d.setUTCDate(this.viewDate.getUTCDate()+7*b)),this.dateWithinRange(c)&&(this.date=c,this.viewDate=d,this.setValue(),this.update(),a.preventDefault(),e=!0);break;case 13:this.hide(),a.preventDefault();break;case 9:this.hide()}if(e){this._trigger(\"changeDate\");var f;this.isInput?f=this.element:this.component&&(f=this.element.find(\"input\")),f&&f.change()}},showMode:function(a){a&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+a))),this.picker.find(\">div\").hide().filter(\".datepicker-\"+l.modes[this.viewMode].clsName).css(\"display\",\"block\"),this.updateNavArrows()}};var f=function(b,c){this.element=a(b),this.inputs=a.map(c.inputs,function(a){return a.jquery?a[0]:a}),delete c.inputs,a(this.inputs).datepicker(c).bind(\"changeDate\",a.proxy(this.dateUpdated,this)),this.pickers=a.map(this.inputs,function(b){return a(b).data(\"datepicker\")}),this.updateDates()};f.prototype={updateDates:function(){this.dates=a.map(this.pickers,function(a){return a.date}),this.updateRanges()},updateRanges:function(){var b=a.map(this.dates,function(a){return a.valueOf()});a.each(this.pickers,function(a,c){c.setRange(b)})},dateUpdated:function(b){var c=a(b.target).data(\"datepicker\"),d=c.getUTCDate(),e=a.inArray(b.target,this.inputs),f=this.inputs.length;if(-1!=e){if(d<this.dates[e])for(;e>=0&&d<this.dates[e];)this.pickers[e--].setUTCDate(d);else if(d>this.dates[e])for(;f>e&&d>this.dates[e];)this.pickers[e++].setUTCDate(d);this.updateDates()}},remove:function(){a.map(this.pickers,function(a){a.remove()}),delete this.element.data().datepicker}};var g=a.fn.datepicker,h=a.fn.datepicker=function(b){var g=Array.apply(null,arguments);g.shift();var h;return this.each(function(){var j=a(this),k=j.data(\"datepicker\"),l=\"object\"==typeof b&&b;if(!k){var m=c(this,\"date\"),n=a.extend({},i,m,l),o=d(n.language),p=a.extend({},i,o,m,l);if(j.is(\".input-daterange\")||p.inputs){var q={inputs:p.inputs||j.find(\"input\").toArray()};j.data(\"datepicker\",k=new f(this,a.extend(p,q)))}else j.data(\"datepicker\",k=new e(this,p))}return\"string\"==typeof b&&\"function\"==typeof k[b]&&(h=k[b].apply(k,g),void 0!==h)?!1:void 0}),void 0!==h?h:this},i=a.fn.datepicker.defaults={autoclose:!1,beforeShowDay:a.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:\"mm/dd/yyyy\",keyboardNavigation:!0,language:\"en\",minViewMode:0,rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},j=a.fn.datepicker.locale_opts=[\"format\",\"rtl\",\"weekStart\"];a.fn.datepicker.Constructor=e;var k=a.fn.datepicker.dates={en:{days:[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\",\"Sunday\"],daysShort:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"],daysMin:[\"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\",\"Su\"],months:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],monthsShort:[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],today:\"Today\",clear:\"Clear\"}},l={modes:[{clsName:\"days\",navFnc:\"Month\",navStep:1},{clsName:\"months\",navFnc:\"FullYear\",navStep:1},{clsName:\"years\",navFnc:\"FullYear\",navStep:10}],isLeapYear:function(a){return 0===a%4&&0!==a%100||0===a%400\r\n},getDaysInMonth:function(a,b){return[31,l.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\\/:-@\\[\\u3400-\\u9fff-`{-~\\t\\n\\r]+/g,parseFormat:function(a){var b=a.replace(this.validParts,\"\\0\").split(\"\\0\"),c=a.match(this.validParts);if(!b||!b.length||!c||0===c.length)throw new Error(\"Invalid date format.\");return{separators:b,parts:c}},parseDate:function(c,d,f){if(c instanceof Date)return c;if(\"string\"==typeof d&&(d=l.parseFormat(d)),/^[\\-+]\\d+[dmwy]([\\s,]+[\\-+]\\d+[dmwy])*$/.test(c)){var g,h,i=/([\\-+]\\d+)([dmwy])/,j=c.match(/([\\-+]\\d+)([dmwy])/g);c=new Date;for(var m=0;m<j.length;m++)switch(g=i.exec(j[m]),h=parseInt(g[1]),g[2]){case\"d\":c.setUTCDate(c.getUTCDate()+h);break;case\"m\":c=e.prototype.moveMonth.call(e.prototype,c,h);break;case\"w\":c.setUTCDate(c.getUTCDate()+7*h);break;case\"y\":c=e.prototype.moveYear.call(e.prototype,c,h)}return b(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),0,0,0)}var n,o,g,j=c&&c.match(this.nonpunctuation)||[],c=new Date,p={},q=[\"yyyy\",\"yy\",\"M\",\"MM\",\"m\",\"mm\",\"d\",\"dd\"],r={yyyy:function(a,b){return a.setUTCFullYear(b)},yy:function(a,b){return a.setUTCFullYear(2e3+b)},m:function(a,b){for(b-=1;0>b;)b+=12;for(b%=12,a.setUTCMonth(b);a.getUTCMonth()!=b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}};r.M=r.MM=r.mm=r.m,r.dd=r.d,c=b(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0);var s=d.parts.slice();if(j.length!=s.length&&(s=a(s).filter(function(b,c){return-1!==a.inArray(c,q)}).toArray()),j.length==s.length){for(var m=0,t=s.length;t>m;m++){if(n=parseInt(j[m],10),g=s[m],isNaN(n))switch(g){case\"MM\":o=a(k[f].months).filter(function(){var a=this.slice(0,j[m].length),b=j[m].slice(0,a.length);return a==b}),n=a.inArray(o[0],k[f].months)+1;break;case\"M\":o=a(k[f].monthsShort).filter(function(){var a=this.slice(0,j[m].length),b=j[m].slice(0,a.length);return a==b}),n=a.inArray(o[0],k[f].monthsShort)+1}p[g]=n}for(var u,m=0;m<q.length;m++)u=q[m],u in p&&!isNaN(p[u])&&r[u](c,p[u])}return c},formatDate:function(b,c,d){\"string\"==typeof c&&(c=l.parseFormat(c));var e={d:b.getUTCDate(),D:k[d].daysShort[b.getUTCDay()],DD:k[d].days[b.getUTCDay()],m:b.getUTCMonth()+1,M:k[d].monthsShort[b.getUTCMonth()],MM:k[d].months[b.getUTCMonth()],yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear()};e.dd=(e.d<10?\"0\":\"\")+e.d,e.mm=(e.m<10?\"0\":\"\")+e.m;for(var b=[],f=a.extend([],c.separators),g=0,h=c.parts.length;h>=g;g++)f.length&&b.push(f.shift()),b.push(e[c.parts[g]]);return b.join(\"\")},headTemplate:'<thead><tr><th class=\"prev\"><i class=\"icon-arrow-left\"/></th><th colspan=\"5\" class=\"datepicker-switch\"></th><th class=\"next\"><i class=\"icon-arrow-right\"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan=\"7\"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan=\"7\" class=\"today\"></th></tr><tr><th colspan=\"7\" class=\"clear\"></th></tr></tfoot>'};l.template='<div class=\"datepicker\"><div class=\"datepicker-days\"><table class=\" table-condensed\">'+l.headTemplate+\"<tbody></tbody>\"+l.footTemplate+\"</table>\"+\"</div>\"+'<div class=\"datepicker-months\">'+'<table class=\"table-condensed\">'+l.headTemplate+l.contTemplate+l.footTemplate+\"</table>\"+\"</div>\"+'<div class=\"datepicker-years\">'+'<table class=\"table-condensed\">'+l.headTemplate+l.contTemplate+l.footTemplate+\"</table>\"+\"</div>\"+\"</div>\",a.fn.datepicker.DPGlobal=l,a.fn.datepicker.noConflict=function(){return a.fn.datepicker=g,this},a(document).on(\"focus.datepicker.data-api click.datepicker.data-api\",'[data-provide=\"datepicker\"]',function(b){var c=a(this);c.data(\"datepicker\")||(b.preventDefault(),h.call(c,\"show\"))}),a(function(){h.call(a('[data-provide=\"datepicker-inline\"]'))})}(window.jQuery),function(a){\"use strict\";a.fn.bdatepicker=a.fn.datepicker.noConflict(),a.fn.datepicker||(a.fn.datepicker=a.fn.bdatepicker);var b=function(a){this.init(\"date\",a,b.defaults),this.initPicker(a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{initPicker:function(b,c){this.options.viewformat||(this.options.viewformat=this.options.format),b.datepicker=a.fn.editableutils.tryParseJson(b.datepicker,!0),this.options.datepicker=a.extend({},c.datepicker,b.datepicker,{format:this.options.viewformat}),this.options.datepicker.language=this.options.datepicker.language||\"en\",this.dpg=a.fn.bdatepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat)},render:function(){this.$input.bdatepicker(this.options.datepicker),this.options.clear&&(this.$clear=a('<a href=\"#\"></a>').html(this.options.clear).click(a.proxy(function(a){a.preventDefault(),a.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(a('<div class=\"editable-clear\">').append(this.$clear)))},value2html:function(a,c){var d=a?this.dpg.formatDate(a,this.parsedViewFormat,this.options.datepicker.language):\"\";b.superclass.value2html.call(this,d,c)},html2value:function(a){return this.parseDate(a,this.parsedViewFormat)},value2str:function(a){return a?this.dpg.formatDate(a,this.parsedFormat,this.options.datepicker.language):\"\"},str2value:function(a){return this.parseDate(a,this.parsedFormat)},value2submit:function(a){return this.value2str(a)},value2input:function(a){this.$input.bdatepicker(\"update\",a)},input2value:function(){return this.$input.data(\"datepicker\").date},activate:function(){},clear:function(){this.$input.data(\"datepicker\").date=null,this.$input.find(\".active\").removeClass(\"active\"),this.options.showbuttons||this.$input.closest(\"form\").submit()},autosubmit:function(){this.$input.on(\"mouseup\",\".day\",function(b){if(!a(b.currentTarget).is(\".old\")&&!a(b.currentTarget).is(\".new\")){var c=a(this).closest(\"form\");setTimeout(function(){c.submit()},200)}})},parseDate:function(a,b){var c,d=null;return a&&(d=this.dpg.parseDate(a,b,this.options.datepicker.language),\"string\"==typeof a&&(c=this.dpg.formatDate(d,b,this.options.datepicker.language),a!==c&&(d=null))),d}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<div class=\"editable-date well\"></div>',inputclass:null,format:\"yyyy-mm-dd\",viewformat:null,datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!1},clear:\"&times; clear\"}),a.fn.editabletypes.date=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"datefield\",a,b.defaults),this.initPicker(a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.date),a.extend(b.prototype,{render:function(){this.$input=this.$tpl.find(\"input\"),this.setClass(),this.setAttr(\"placeholder\"),this.$tpl.bdatepicker(this.options.datepicker),this.$input.off(\"focus keydown\"),this.$input.keyup(a.proxy(function(){this.$tpl.removeData(\"date\"),this.$tpl.bdatepicker(\"update\")},this))},value2input:function(a){this.$input.val(a?this.dpg.formatDate(a,this.parsedViewFormat,this.options.datepicker.language):\"\"),this.$tpl.bdatepicker(\"update\")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){a.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),b.defaults=a.extend({},a.fn.editabletypes.date.defaults,{tpl:'<div class=\"input-append date\"><input type=\"text\"/><span class=\"add-on\"><i class=\"icon-th\"></i></span></div>',inputclass:\"input-small\",datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!0}}),a.fn.editabletypes.datefield=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"datetime\",a,b.defaults),this.initPicker(a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{initPicker:function(b,c){this.options.viewformat||(this.options.viewformat=this.options.format),b.datetimepicker=a.fn.editableutils.tryParseJson(b.datetimepicker,!0),this.options.datetimepicker=a.extend({},c.datetimepicker,b.datetimepicker,{format:this.options.viewformat}),this.options.datetimepicker.language=this.options.datetimepicker.language||\"en\",this.dpg=a.fn.datetimepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format,this.options.formatType),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat,this.options.formatType)},render:function(){this.$input.datetimepicker(this.options.datetimepicker),this.$input.on(\"changeMode\",function(){var b=a(this).closest(\"form\").parent();setTimeout(function(){b.triggerHandler(\"resize\")},0)}),this.options.clear&&(this.$clear=a('<a href=\"#\"></a>').html(this.options.clear).click(a.proxy(function(a){a.preventDefault(),a.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(a('<div class=\"editable-clear\">').append(this.$clear)))},value2html:function(a,c){var d=a?this.dpg.formatDate(this.toUTC(a),this.parsedViewFormat,this.options.datetimepicker.language,this.options.formatType):\"\";return c?(b.superclass.value2html.call(this,d,c),void 0):d},html2value:function(a){var b=this.parseDate(a,this.parsedViewFormat);return b?this.fromUTC(b):null},value2str:function(a){return a?this.dpg.formatDate(this.toUTC(a),this.parsedFormat,this.options.datetimepicker.language,this.options.formatType):\"\"},str2value:function(a){var b=this.parseDate(a,this.parsedFormat);return b?this.fromUTC(b):null},value2submit:function(a){return this.value2str(a)},value2input:function(a){a&&this.$input.data(\"datetimepicker\").setDate(a)},input2value:function(){var a=this.$input.data(\"datetimepicker\");return a.date?a.getDate():null},activate:function(){},clear:function(){this.$input.data(\"datetimepicker\").date=null,this.$input.find(\".active\").removeClass(\"active\"),this.options.showbuttons||this.$input.closest(\"form\").submit()},autosubmit:function(){this.$input.on(\"mouseup\",\".minute\",function(){var b=a(this).closest(\"form\");setTimeout(function(){b.submit()},200)})},toUTC:function(a){return a?new Date(a.valueOf()-6e4*a.getTimezoneOffset()):a},fromUTC:function(a){return a?new Date(a.valueOf()+6e4*a.getTimezoneOffset()):a},parseDate:function(a,b){var c,d=null;return a&&(d=this.dpg.parseDate(a,b,this.options.datetimepicker.language,this.options.formatType),\"string\"==typeof a&&(c=this.dpg.formatDate(d,b,this.options.datetimepicker.language,this.options.formatType),a!==c&&(d=null))),d}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<div class=\"editable-date well\"></div>',inputclass:null,format:\"yyyy-mm-dd hh:ii\",formatType:\"standard\",viewformat:null,datetimepicker:{todayHighlight:!1,autoclose:!1},clear:\"&times; clear\"}),a.fn.editabletypes.datetime=b}(window.jQuery),function(a){\"use strict\";var b=function(a){this.init(\"datetimefield\",a,b.defaults),this.initPicker(a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.datetime),a.extend(b.prototype,{render:function(){this.$input=this.$tpl.find(\"input\"),this.setClass(),this.setAttr(\"placeholder\"),this.$tpl.datetimepicker(this.options.datetimepicker),this.$input.off(\"focus keydown\"),this.$input.keyup(a.proxy(function(){this.$tpl.removeData(\"date\"),this.$tpl.datetimepicker(\"update\")},this))},value2input:function(a){this.$input.val(this.value2html(a)),this.$tpl.datetimepicker(\"update\")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){a.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),b.defaults=a.extend({},a.fn.editabletypes.datetime.defaults,{tpl:'<div class=\"input-append date\"><input type=\"text\"/><span class=\"add-on\"><i class=\"icon-th\"></i></span></div>',inputclass:\"input-medium\",datetimepicker:{todayHighlight:!1,autoclose:!0}}),a.fn.editabletypes.datetimefield=b}(window.jQuery);\ndefine(\"xEditable\", [\"bootstrap\"], function(){});\n\n",
    "/**!\r\n * easyPieChart\r\n * Lightweight plugin to render simple, animated and retina optimized pie charts\r\n *\r\n * @license \r\n * @author Robert Fleischmann <rendro87@gmail.com> (http://robert-fleischmann.de)\r\n * @version 2.1.6\r\n **/\r\n!function(a,b){\"object\"==typeof exports?module.exports=b(require(\"jquery\")):\"function\"==typeof define&&define.amd?define('easyPieChart',[\"jquery\"],b):b(a.jQuery)}(this,function(a){var b=function(a,b){var c,d=document.createElement(\"canvas\");a.appendChild(d),\"undefined\"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(d);var e=d.getContext(\"2d\");d.width=d.height=b.size;var f=1;window.devicePixelRatio>1&&(f=window.devicePixelRatio,d.style.width=d.style.height=[b.size,\"px\"].join(\"\"),d.width=d.height=b.size*f,e.scale(f,f)),e.translate(b.size/2,b.size/2),e.rotate((-0.5+b.rotate/180)*Math.PI);var g=(b.size-b.lineWidth)/2;b.scaleColor&&b.scaleLength&&(g-=b.scaleLength+2),Date.now=Date.now||function(){return+new Date};var h=function(a,b,c){c=Math.min(Math.max(-1,c||0),1);var d=0>=c?!0:!1;e.beginPath(),e.arc(0,0,g,0,2*Math.PI*c,d),e.strokeStyle=a,e.lineWidth=b,e.stroke()},i=function(){var a,c;e.lineWidth=1,e.fillStyle=b.scaleColor,e.save();for(var d=24;d>0;--d)d%6===0?(c=b.scaleLength,a=0):(c=.6*b.scaleLength,a=b.scaleLength-c),e.fillRect(-b.size/2+a,0,c,1),e.rotate(Math.PI/12);e.restore()},j=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),k=function(){b.scaleColor&&i(),b.trackColor&&h(b.trackColor,b.trackWidth||b.lineWidth,1)};this.getCanvas=function(){return d},this.getCtx=function(){return e},this.clear=function(){e.clearRect(b.size/-2,b.size/-2,b.size,b.size)},this.draw=function(a){b.scaleColor||b.trackColor?e.getImageData&&e.putImageData?c?e.putImageData(c,0,0):(k(),c=e.getImageData(0,0,b.size*f,b.size*f)):(this.clear(),k()):this.clear(),e.lineCap=b.lineCap;var d;d=\"function\"==typeof b.barColor?b.barColor(a):b.barColor,h(d,b.lineWidth,a/100)}.bind(this),this.animate=function(a,c){var d=Date.now();b.onStart(a,c);var e=function(){var f=Math.min(Date.now()-d,b.animate.duration),g=b.easing(this,f,a,c-a,b.animate.duration);this.draw(g),b.onStep(a,c,g),f>=b.animate.duration?b.onStop(a,c):j(e)}.bind(this);j(e)}.bind(this)},c=function(a,c){var d={barColor:\"#ef1e25\",trackColor:\"#f9f9f9\",scaleColor:\"#dfe0e0\",scaleLength:5,lineCap:\"round\",lineWidth:3,trackWidth:void 0,size:110,rotate:0,animate:{duration:1e3,enabled:!0},easing:function(a,b,c,d,e){return b/=e/2,1>b?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},onStart:function(){},onStep:function(){},onStop:function(){}};if(\"undefined\"!=typeof b)d.renderer=b;else{if(\"undefined\"==typeof SVGRenderer)throw new Error(\"Please load either the SVG- or the CanvasRenderer\");d.renderer=SVGRenderer}var e={},f=0,g=function(){this.el=a,this.options=e;for(var b in d)d.hasOwnProperty(b)&&(e[b]=c&&\"undefined\"!=typeof c[b]?c[b]:d[b],\"function\"==typeof e[b]&&(e[b]=e[b].bind(this)));e.easing=\"string\"==typeof e.easing&&\"undefined\"!=typeof jQuery&&jQuery.isFunction(jQuery.easing[e.easing])?jQuery.easing[e.easing]:d.easing,\"number\"==typeof e.animate&&(e.animate={duration:e.animate,enabled:!0}),\"boolean\"!=typeof e.animate||e.animate||(e.animate={duration:1e3,enabled:e.animate}),this.renderer=new e.renderer(a,e),this.renderer.draw(f),a.dataset&&a.dataset.percent?this.update(parseFloat(a.dataset.percent)):a.getAttribute&&a.getAttribute(\"data-percent\")&&this.update(parseFloat(a.getAttribute(\"data-percent\")))}.bind(this);this.update=function(a){return a=parseFloat(a),e.animate.enabled?this.renderer.animate(f,a):this.renderer.draw(a),f=a,this}.bind(this),this.disableAnimation=function(){return e.animate.enabled=!1,this},this.enableAnimation=function(){return e.animate.enabled=!0,this},g()};a.fn.easyPieChart=function(b){return this.each(function(){var d;a.data(this,\"easyPieChart\")||(d=a.extend({},b,a(this).data()),a.data(this,\"easyPieChart\",new c(this,d)))})}});\n",
    "/*!\r\n * hoverIntent v1.8.0 // 2014.06.29 // jQuery v1.9.1+\r\n * http://cherne.net/brian/resources/jquery.hoverIntent.html\r\n *\r\n * You may use hoverIntent under the terms of the MIT license. Basically that\r\n * means you are free to use hoverIntent as long as this header is left intact.\r\n * Copyright 2007, 2014 Brian Cherne\r\n */\r\n(function($){$.fn.hoverIntent=function(handlerIn,handlerOut,selector){var cfg={interval:100,sensitivity:6,timeout:0};if(typeof handlerIn===\"object\"){cfg=$.extend(cfg,handlerIn)}else{if($.isFunction(handlerOut)){cfg=$.extend(cfg,{over:handlerIn,out:handlerOut,selector:selector})}else{cfg=$.extend(cfg,{over:handlerIn,out:handlerIn,selector:handlerOut})}}var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if(Math.sqrt((pX-cX)*(pX-cX)+(pY-cY)*(pY-cY))<cfg.sensitivity){$(ob).off(\"mousemove.hoverIntent\",track);ob.hoverIntent_s=true;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=false;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=$.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type===\"mouseenter\"){pX=ev.pageX;pY=ev.pageY;$(ob).on(\"mousemove.hoverIntent\",track);if(!ob.hoverIntent_s){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).off(\"mousemove.hoverIntent\",track);if(ob.hoverIntent_s){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.on({\"mouseenter.hoverIntent\":handleHover,\"mouseleave.hoverIntent\":handleHover},cfg.selector)}})(jQuery);\ndefine(\"hoverIntent\", [\"jquery\"], function(){});\n\n",
    "+function ($) {\r\n\t'use strict';\r\n\r\n\t//var for check event at body can have only one.\r\n\tvar event_body = false;\r\n\r\n\t// CONFIRMATION PUBLIC CLASS DEFINITION\r\n\t// ===============================\r\n\tvar Confirmation = function (element, options) {\r\n\t\tvar that = this;\r\n\r\n\t\tthis.init('confirmation', element, options);\r\n\r\n\r\n\t\t$(element).on('show.bs.confirmation', function(e) {\r\n\t\t\tthat.options.onShow(e, this);\r\n\r\n\t\t\t$(this).addClass('open');\r\n\r\n\t\t\tvar options = that.options;\r\n\t\t\tvar all = options.all_selector;\r\n\r\n\t\t\tif(options.singleton)\r\n\t\t\t{\r\n\t\t\t\t$(all).not(that.$element).each(function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif( $(this).hasClass('open') )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).confirmation('hide');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(element).on('hide.bs.confirmation', function(e) {\r\n\t\t\tthat.options.onHide(e, this);\r\n\r\n\t\t\t$(this).removeClass('open');\r\n\t\t});\r\n\r\n\t\t$(element).on('shown.bs.confirmation', function(e) {\r\n\t\t\tvar options = that.options;\r\n\t\t\tvar all = options.all_selector;\r\n\r\n\t\t\tthat.$element.on('click.dismiss.bs.confirmation', '[data-dismiss=\"confirmation\"]', $.proxy(that.hide, that));\r\n\r\n\t\t\tif(that.isPopout()) {\r\n\t\t\t\tif(!event_body) {\r\n\t\t\t\t\tevent_body = $('body').on('click', function (e) {\r\n\t\t\t\t\t\tif(that.$element.is(e.target)) return;\r\n\t\t\t\t\t\tif(that.$element.has(e.target).length) return;\r\n\t\t\t\t\t\tif($('.popover').has(e.target).length) return;\r\n\r\n\t\t\t\t\t\tthat.$element.confirmation('hide');\r\n\r\n\t\t\t\t\t\t$('body').unbind(e);\r\n\r\n\t\t\t\t\t\tevent_body = false;\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(element).on('click', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\t}\r\n\r\n\tif (!$.fn.popover || !$.fn.tooltip) throw new Error('Confirmation requires popover.js and tooltip.js');\r\n\r\n\tConfirmation.DEFAULTS = $.extend({}, $.fn.popover.Constructor.DEFAULTS, {\r\n\t\tplacement \t\t: 'right',\r\n\t\ttitle \t\t\t: 'Are you sure?',\r\n\t\tbtnOkClass \t\t: 'btn btn-sm btn-danger',\r\n\t\tbtnOkLabel \t\t: 'Delete',\r\n\t\tbtnOkIcon \t\t: 'glyphicon glyphicon-ok',\r\n\t\tbtnCancelClass \t: 'btn btn-sm btn-default',\r\n\t\tbtnCancelLabel \t: 'Cancel',\r\n\t\tbtnCancelIcon \t: 'glyphicon glyphicon-remove',\r\n\t\thref \t\t\t: '#',\r\n\t\ttarget \t\t\t: '_self',\r\n\t\tsingleton \t\t: true,\r\n\t\tpopout \t\t\t: true,\r\n\t\tonShow \t\t\t: function(event, element){},\r\n\t\tonHide \t\t\t: function(event, element){},\r\n\t\tonConfirm \t\t: function(event, element){},\r\n\t\tonCancel \t\t: function(event, element){},\r\n\t\ttemplate \t\t:   '<div class=\"popover\"><div class=\"arrow\"></div>'\r\n\t\t\t\t\t\t\t+ '<h3 class=\"popover-title\"></h3>'\r\n\t\t\t\t\t\t\t+ '<div class=\"popover-content\">'\r\n                            + '<div class=\"btn-group\">'\r\n                            + '<a data-dismiss=\"confirmation\">No</a>'\r\n\t\t\t\t\t\t\t+ '<a data-apply=\"confirmation\">Yes</a>'\r\n                            + '</div>'\r\n\t\t\t\t\t\t\t+ '</div>'\r\n\t\t\t\t\t\t\t+ '</div>'\r\n\t});\r\n\r\n\r\n\t// NOTE: CONFIRMATION EXTENDS popover.js\r\n\t// ================================\r\n\tConfirmation.prototype = $.extend({}, $.fn.popover.Constructor.prototype);\r\n\r\n\tConfirmation.prototype.constructor = Confirmation;\r\n\r\n\tConfirmation.prototype.getDefaults = function () {\r\n\t\treturn Confirmation.DEFAULTS;\r\n\t}\r\n\r\n\tConfirmation.prototype.setContent = function () {\r\n\t\tvar that = this;\r\n\t\tvar $tip    = this.tip();\r\n\t\tvar title   = this.getTitle();\r\n\t\tvar $btnOk\t    = $tip.find('[data-apply=\"confirmation\"]');\r\n\t\tvar $btnCancel  = $tip.find('[data-dismiss=\"confirmation\"]');\r\n\t\tvar options\t    = this.options\r\n\r\n\t\t$btnOk.addClass(this.getBtnOkClass())\r\n\t\t\t.html(this.getBtnOkLabel())\r\n\t\t\t.prepend($('<i></i>').addClass(this.getBtnOkIcon()), \" \")\r\n\t\t\t.attr('href', this.getHref())\r\n\t\t\t.attr('target', this.getTarget())\r\n\t\t\t.off('click').on('click', function(event) {\r\n                that.$element.confirmation('hide');\r\n\r\n\t\t\t\toptions.onConfirm(event, that.$element);\r\n\t\t\t});\r\n\r\n\t\t$btnCancel.addClass(this.getBtnCancelClass())\r\n\t\t\t.html(this.getBtnCancelLabel())\r\n\t\t\t.prepend($('<i></i>').addClass(this.getBtnCancelIcon()), \" \")\r\n\t\t\t.off('click').on('click', function(event){\r\n\t\t\t\toptions.onCancel(event, that.$element);\r\n\r\n\t\t\t\tthat.$element.confirmation('hide');\r\n\t\t\t});\r\n\r\n\t\t$tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title);\r\n\r\n\t\t$tip.removeClass('fade top bottom left right in');\r\n\r\n\t\t// IE8 doesn't accept hiding via the `:empty` pseudo selector, we have to do\r\n\t\t// this manually by checking the contents.\r\n\t\tif (!$tip.find('.popover-title').html()) $tip.find('.popover-title').hide();\r\n\t}\r\n\r\n\tConfirmation.prototype.getBtnOkClass = function () {\r\n\t\tvar $e = this.$element;\r\n\t\tvar o  = this.options;\r\n\r\n\t\treturn $e.attr('data-btnOkClass') || (typeof o.btnOkClass == 'function' ? o.btnOkClass.call($e[0]) : o.btnOkClass);\r\n\t}\r\n\r\n\tConfirmation.prototype.getBtnOkLabel = function () {\r\n\t\tvar $e = this.$element;\r\n\t\tvar o  = this.options;\r\n\r\n\t\treturn $e.attr('data-btnOkLabel') || (typeof o.btnOkLabel == 'function' ? o.btnOkLabel.call($e[0]) : o.btnOkLabel);\r\n\t}\r\n\r\n\tConfirmation.prototype.getBtnOkIcon = function () {\r\n\t\tvar $e = this.$element;\r\n\t\tvar o  = this.options;\r\n\r\n\t\treturn $e.attr('data-btnOkIcon') || (typeof o.btnOkIcon == 'function' ?  o.btnOkIcon.call($e[0]) : o.btnOkIcon);\r\n\t}\r\n\r\n\tConfirmation.prototype.getBtnCancelClass = function () {\r\n\t\tvar $e = this.$element;\r\n\t\tvar o  = this.options;\r\n\r\n\t\treturn $e.attr('data-btnCancelClass') || (typeof o.btnCancelClass == 'function' ? o.btnCancelClass.call($e[0]) : o.btnCancelClass);\r\n\t}\r\n\r\n\tConfirmation.prototype.getBtnCancelLabel = function () {\r\n\t\tvar $e = this.$element;\r\n\t\tvar o  = this.options;\r\n\r\n\t\treturn $e.attr('data-btnCancelLabel') || (typeof o.btnCancelLabel == 'function' ? o.btnCancelLabel.call($e[0]) : o.btnCancelLabel);\r\n\t}\r\n\r\n\tConfirmation.prototype.getBtnCancelIcon = function () {\r\n\t\tvar $e = this.$element;\r\n\t\tvar o  = this.options;\r\n\r\n\t\treturn $e.attr('data-btnCancelIcon') || (typeof o.btnCancelIcon == 'function' ? o.btnCancelIcon.call($e[0]) : o.btnCancelIcon);\r\n\t}\r\n\r\n\tConfirmation.prototype.getHref = function () {\r\n\t\tvar $e = this.$element;\r\n\t\tvar o  = this.options;\r\n\r\n\t\treturn $e.attr('data-href') || (typeof o.href == 'function' ? o.href.call($e[0]) : o.href);\r\n\t}\r\n\r\n\tConfirmation.prototype.getTarget = function () {\r\n\t\tvar $e = this.$element;\r\n\t\tvar o  = this.options;\r\n\r\n\t\treturn $e.attr('data-target') || (typeof o.target == 'function' ? o.target.call($e[0]) : o.target);\r\n\t}\r\n\r\n\tConfirmation.prototype.isPopout = function () {\r\n\t\tvar popout;\r\n\t\tvar $e = this.$element;\r\n\t\tvar o = this.options;\r\n\r\n\t\tpopout = $e.attr('data-popout') || (typeof o.popout == 'function' ? o.popout.call($e[0]) :\to.popout);\r\n\r\n\t\tif(popout == 'false') popout = false;\r\n\r\n\t\treturn popout\r\n\t}\r\n\r\n\r\n\t// CONFIRMATION PLUGIN DEFINITION\r\n\t// =========================\r\n\tvar old = $.fn.confirmation;\r\n\r\n\t$.fn.confirmation = function (option) {\r\n\t\tvar that = this;\r\n\r\n\t\treturn this.each(function () {\r\n\t\t\tvar $this   = $(this);\r\n\t\t\tvar data    = $this.data('bs.confirmation');\r\n\t\t\tvar options = typeof option == 'object' && option;\r\n\r\n\t\t\toptions = options || {};\r\n\t\t\toptions.all_selector = that.selector;\r\n\r\n\t\t\tif (!data && option == 'destroy') return;\r\n\t\t\tif (!data) $this.data('bs.confirmation', (data = new Confirmation(this, options)));\r\n\t\t\tif (typeof option == 'string') data[option]();\r\n\t\t});\r\n\t}\r\n\r\n\t$.fn.confirmation.Constructor = Confirmation\r\n\r\n\r\n\t// CONFIRMATION NO CONFLICT\r\n\t// ===================\r\n\t$.fn.confirmation.noConflict = function () {\r\n\t\t$.fn.confirmation = old;\r\n\r\n\t\treturn this;\r\n\t}\r\n}(jQuery);\ndefine(\"bootstrapConfirmation\", [\"bootstrap\"], function(){});\n\n",
    "/*! ========================================================================\r\n * Bootstrap Toggle: bootstrap2-toggle.js v2.2.0\r\n * http://www.bootstraptoggle.com\r\n * ========================================================================\r\n * Copyright 2014 Min Hur, The New York Times Company\r\n * Licensed under MIT\r\n * ======================================================================== */\r\n+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.toggle\"),f=\"object\"==typeof b&&b;e||d.data(\"bs.toggle\",e=new c(this,f)),\"string\"==typeof b&&e[b]&&e[b]()})}var c=function(b,c){this.$element=a(b),this.options=a.extend({},this.defaults(),c),this.render()};c.VERSION=\"2.2.0\",c.DEFAULTS={on:\"On\",off:\"Off\",onstyle:\"primary\",offstyle:\"default\",size:\"normal\",style:\"\",width:null,height:null},c.prototype.defaults=function(){return{on:this.$element.attr(\"data-on\")||c.DEFAULTS.on,off:this.$element.attr(\"data-off\")||c.DEFAULTS.off,onstyle:this.$element.attr(\"data-onstyle\")||c.DEFAULTS.onstyle,offstyle:this.$element.attr(\"data-offstyle\")||c.DEFAULTS.offstyle,size:this.$element.attr(\"data-size\")||c.DEFAULTS.size,style:this.$element.attr(\"data-style\")||c.DEFAULTS.style,width:this.$element.attr(\"data-width\")||c.DEFAULTS.width,height:this.$element.attr(\"data-height\")||c.DEFAULTS.height}},c.prototype.render=function(){this._onstyle=\"btn-\"+this.options.onstyle,this._offstyle=\"btn-\"+this.options.offstyle;var b=\"large\"===this.options.size?\"btn-large\":\"small\"===this.options.size?\"btn-small\":\"mini\"===this.options.size?\"btn-mini\":\"\",c=a('<label class=\"btn\">').html(this.options.on).addClass(this._onstyle+\" \"+b),d=a('<label class=\"btn\">').html(this.options.off).addClass(this._offstyle+\" \"+b+\" active\"),e=a('<span class=\"toggle-handle btn btn-default\">').addClass(b),f=a('<div class=\"toggle-group\">').append(c,d,e),g=a('<div class=\"toggle btn\" data-toggle=\"toggle\">').addClass(this.$element.prop(\"checked\")?this._onstyle:this._offstyle+\" off\").addClass(b).addClass(this.options.style);this.$element.wrap(g),a.extend(this,{$toggle:this.$element.parent(),$toggleOn:c,$toggleOff:d,$toggleGroup:f}),this.$toggle.append(f);var h=this.options.width||Math.max(c.width(),d.width())+e.outerWidth()/2,i=this.options.height||Math.max(c.height(),d.height());c.addClass(\"toggle-on\"),d.addClass(\"toggle-off\"),this.$toggle.css({width:h,height:i}),this.options.height&&(c.css(\"line-height\",c.height()+\"px\"),d.css(\"line-height\",d.height()+\"px\")),this.update(!0),this.trigger(!0)},c.prototype.toggle=function(){this.$element.prop(\"checked\")?this.off():this.on()},c.prototype.on=function(a){return this.$element.prop(\"disabled\")?!1:(this.$toggle.removeClass(this._offstyle+\" off\").addClass(this._onstyle),this.$element.prop(\"checked\",!0),void(a||this.trigger()))},c.prototype.off=function(a){return this.$element.prop(\"disabled\")?!1:(this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+\" off\"),this.$element.prop(\"checked\",!1),void(a||this.trigger()))},c.prototype.enable=function(){this.$toggle.removeAttr(\"disabled\"),this.$element.prop(\"disabled\",!1)},c.prototype.disable=function(){this.$toggle.attr(\"disabled\",\"disabled\"),this.$element.prop(\"disabled\",!0)},c.prototype.update=function(a){this.$element.prop(\"disabled\")?this.disable():this.enable(),this.$element.prop(\"checked\")?this.on(a):this.off(a)},c.prototype.trigger=function(b){this.$element.off(\"change.bs.toggle\"),b||this.$element.change(),this.$element.on(\"change.bs.toggle\",a.proxy(function(){this.update()},this))},c.prototype.destroy=function(){this.$element.off(\"change.bs.toggle\"),this.$toggleGroup.remove(),this.$element.removeData(\"bs.toggle\"),this.$element.unwrap()};var d=a.fn.bootstrapToggle;a.fn.bootstrapToggle=b,a.fn.bootstrapToggle.Constructor=c,a.fn.toggle.noConflict=function(){return a.fn.bootstrapToggle=d,this},a(function(){a(\"input[type=checkbox][data-toggle^=toggle]\").bootstrapToggle()}),a(document).on(\"click.bs.toggle\",\"div[data-toggle^=toggle]\",function(b){var c=a(this).find(\"input[type=checkbox]\");c.bootstrapToggle(\"toggle\"),b.preventDefault()})}(jQuery);\ndefine(\"bootstrapToggle\", [\"jquery\"], function(){});\n\n",
    "/**\r\n *  Util\r\n */\r\ndefine('app/util',[\r\n    'jquery',\r\n    'app/init',\r\n    'config/system_effect',\r\n    'config/signature_type',\r\n    'bootbox',\r\n    'localForage',\r\n    'velocity',\r\n    'velocityUI',\r\n    'customScrollbar',\r\n    'validator',\r\n    'xEditable',\r\n    'easyPieChart',\r\n    'hoverIntent',\r\n    'bootstrapConfirmation',\r\n    'bootstrapToggle'\r\n], function($, Init, SystemEffect, SignatureType, bootbox, localforage) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n        ajaxOverlayClass: 'pf-loading-overlay',\r\n        ajaxOverlayWrapperClass: 'pf-loading-overlay-wrapper',\r\n\r\n        // form\r\n        formEditableFieldClass: 'pf-editable',                                  // class for all xEditable fields\r\n        formErrorContainerClass: 'pf-dialog-error-container',                   // class for \"error\" containers in dialogs\r\n        formWarningContainerClass: 'pf-dialog-warning-container',               // class for \"warning\" containers in dialogs\r\n        formInfoContainerClass: 'pf-dialog-info-container',                     // class for \"info\" containers in dialogs\r\n\r\n        // head\r\n        headMapTrackingId: 'pf-head-map-tracking',                              // id for \"map tracking\" toggle (checkbox)\r\n        headCharacterSwitchId: 'pf-head-character-switch',                      // id for \"character switch\" popover\r\n\r\n        // menu\r\n        menuButtonFullScreenId: 'pf-menu-button-fullscreen',                    // id for menu button \"fullscreen\"\r\n        menuButtonMagnetizerId: 'pf-menu-button-magnetizer',                    // id for menu button \"magnetizer\"\r\n        menuButtonGridId: 'pf-menu-button-grid',                                // id for menu button \"grid snap\"\r\n\r\n\r\n        settingsMessageVelocityOptions: {\r\n            duration: 180\r\n        },\r\n\r\n        // dialogs\r\n        dialogClass: 'modal-dialog',                                            // class for all dialogs (bootstrap)\r\n\r\n        // map module\r\n        mapModuleId: 'pf-map-module',                                           // id for main map module\r\n        mapTabBarId: 'pf-map-tabs',                                             // id for map tab bar\r\n\r\n        // animation\r\n        animationPulseSuccessClass: 'pf-animation-pulse-success',               // animation class\r\n        animationPulseWarningClass: 'pf-animation-pulse-warning',               // animation class\r\n\r\n        // popover\r\n        popoverTriggerClass: 'pf-popover-trigger'                               // class for \"popover\" trigger elements\r\n\r\n    };\r\n\r\n    var stopTimerCache = {};                                                    // cache for stopwatch timer\r\n\r\n    var animationTimerCache = {};                                               // cache for table row animation timeout\r\n\r\n    var localStorage;                                                           // cache for \"localForage\" singleton\r\n\r\n    /*\r\n     *  ===========================================================================================================\r\n     *   Global jQuery plugins for some common and frequently used functions\r\n     *   ==========================================================================================================\r\n     */\r\n\r\n    /**\r\n     * displays a loading indicator on an element\r\n     */\r\n    $.fn.showLoadingAnimation = function(options){\r\n        var loadingElement = $(this);\r\n\r\n        var iconSize = 'fa-lg';\r\n\r\n        // disable all events\r\n        loadingElement.css('pointer-events', 'none');\r\n\r\n        if(options){\r\n            if(options.icon){\r\n                if(options.icon.size){\r\n                    iconSize = options.icon.size;\r\n                }\r\n            }\r\n        }\r\n\r\n        var overlay = $('<div>', {\r\n            class: config.ajaxOverlayClass\r\n        }).append(\r\n            $('<div>', {\r\n                class: [config.ajaxOverlayWrapperClass].join(' ')\r\n            }).append(\r\n                $('<i>', {\r\n                    class: ['fa', 'fa-fw', iconSize, 'fa-refresh', 'fa-spin'].join(' ')\r\n                })\r\n            )\r\n        );\r\n\r\n        loadingElement.append(overlay);\r\n\r\n        // fade in\r\n        $(overlay).velocity({\r\n            opacity: 0.6\r\n        },{\r\n            duration: 180\r\n        });\r\n    };\r\n\r\n    /**\r\n     * removes a loading indicator\r\n     */\r\n    $.fn.hideLoadingAnimation = function(){\r\n        var loadingElement = $(this);\r\n        var overlay = loadingElement.find('.' + config.ajaxOverlayClass );\r\n\r\n        // important: \"stop\" is required to stop \"show\" animation\r\n        // -> otherwise \"complete\" callback is not fired!\r\n        $(overlay).velocity('stop').velocity('reverse', {\r\n            complete: function(){\r\n                $(this).remove();\r\n                // enable all events\r\n                loadingElement.css('pointer-events', 'auto');\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * show \"splash\" loading overlay\r\n     * @param callback\r\n     */\r\n    $.fn.showSplashOverlay = function(callback){\r\n        var splashOverlay = $(this);\r\n\r\n        splashOverlay.velocity('fadeIn', {\r\n            duration: Init.animationSpeed.splashOverlay,\r\n            complete: function(){\r\n                // execute callback function if given\r\n                if(callback !== undefined){\r\n                    callback();\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * hide \"splash\" loading overlay\r\n     */\r\n    $.fn.hideSplashOverlay = function(){\r\n        var splashOverlay = $(this);\r\n\r\n        splashOverlay.velocity('fadeOut', {\r\n            duration: Init.animationSpeed.splashOverlay\r\n        });\r\n    };\r\n\r\n    /**\r\n     * show a unique generated captcha image\r\n     * @param reason\r\n     * @param callback\r\n     * @returns {*}\r\n     */\r\n    $.fn.showCaptchaImage = function(reason, callback){\r\n        return this.each(function(){\r\n            var captchaWrapper = $(this);\r\n            var captchaImage = captchaWrapper.find('img');\r\n\r\n            captchaWrapper.showLoadingAnimation(config.loadingOptions);\r\n            getCaptchaImage(reason, function(base64Image){\r\n\r\n                captchaImage.attr('src', base64Image).show();\r\n                captchaWrapper.hideLoadingAnimation({\r\n                    icon: {\r\n                        size: 'fa-2x'\r\n                    }\r\n                });\r\n\r\n                if(callback){\r\n                    callback();\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * request a captcha image\r\n     * @param callback\r\n     */\r\n    var getCaptchaImage = function(reason, callback){\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.getCaptcha,\r\n            data: {\r\n                reason: reason\r\n            },\r\n            dataType: 'json'\r\n        }).done(function(responseData){\r\n            if(responseData.error.length > 0){\r\n                showNotify({title: 'getCaptchaImage', text: 'Captcha image gneration failed', type: 'error'});\r\n            }else{\r\n                callback(responseData.img);\r\n            }\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            showNotify({title: jqXHR.status + ': getCaptchaImage', text: reason, type: 'error'});\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * reset/clear form fields\r\n     * @returns {*}\r\n     */\r\n    $.fn.resetFormFields = function(){\r\n        return this.each(function(){\r\n            var field = $(this);\r\n\r\n            if( !field.is('select') ){\r\n                // \"input\"\r\n                field.val('');\r\n            }\r\n\r\n            field.parents('.form-group').removeClass('has-error has-success');\r\n        });\r\n    };\r\n\r\n    /**\r\n     * show form messages\r\n     * check: showMessage() for en other way of showing messages\r\n     * @param errors\r\n     */\r\n    $.fn.showFormMessage = function(errors){\r\n\r\n        var formElement = $(this);\r\n\r\n        var errorMessage = [];\r\n        var warningMessage = [];\r\n        var infoMessage = [];\r\n        for(var i = 0; i < errors.length; i++){\r\n            if(errors[i].type === 'error'){\r\n                errorMessage.push( errors[i].message );\r\n\r\n                // mark form field as invalid in case of a validation error\r\n                if(\r\n                    errors[i].field &&\r\n                    errors[i].field.length > 0\r\n                ){\r\n                    var formField = formElement.find('[name=\"' + errors[i].field + '\"]');\r\n                    formField.parents('.form-group').removeClass('has-success').addClass('has-error');\r\n                }\r\n\r\n            }else if(errors[i].type === 'warning'){\r\n                warningMessage.push( errors[i].message );\r\n            }else if(errors[i].type === 'info'){\r\n                infoMessage.push( errors[i].message );\r\n            }\r\n        }\r\n\r\n        if(errorMessage.length > 0){\r\n            formElement.hideFormMessage('error', function(element){\r\n                $(element).find('small').html( errorMessage.join('<br>') );\r\n                $(element).velocity('transition.slideUpIn', config.settingsMessageVelocityOptions);\r\n            });\r\n        }\r\n\r\n        if(warningMessage.length > 0){\r\n            formElement.hideFormMessage('warning', function(element){\r\n                $(element).find('small').html( warningMessage.join('<br>') );\r\n                $(element).velocity('transition.slideUpIn', config.settingsMessageVelocityOptions);\r\n            });\r\n        }\r\n\r\n        if(infoMessage.length > 0){\r\n            formElement.hideFormMessage('info', function(element){\r\n                $(element).find('small').html( infoMessage.join('<br>') );\r\n                $(element).velocity('transition.slideUpIn', config.settingsMessageVelocityOptions);\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * hide all form messages\r\n     * @param type\r\n     * @param callback\r\n     */\r\n    $.fn.hideFormMessage = function(type, callback){\r\n\r\n        var formElement = $(this);\r\n\r\n        var settingsMessageVelocityOptions = $.extend({}, config.settingsMessageVelocityOptions);\r\n\r\n        // check if callback exists\r\n        if(callback !== undefined){\r\n            settingsMessageVelocityOptions.complete = callback;\r\n\r\n            // new error will be shown afterwards -> keep display\r\n            settingsMessageVelocityOptions.display = 'block';\r\n        }\r\n\r\n        var messageElement = null;\r\n\r\n        switch(type){\r\n            case 'error':\r\n                // find error container\r\n                messageElement = formElement.find('.' + config.formErrorContainerClass);\r\n                break;\r\n            case 'warning':\r\n                messageElement = formElement.find('.' + config.formWarningContainerClass);\r\n                break;\r\n            case 'info':\r\n                messageElement = formElement.find('.' + config.formInfoContainerClass);\r\n                break;\r\n            case 'all':\r\n                messageElement = formElement.find(\r\n                    '.' + config.formErrorContainerClass + ', ' +\r\n                    '.' + config.formWarningContainerClass + ', ' +\r\n                    '.' + config.formInfoContainerClass\r\n                );\r\n        }\r\n\r\n        if(messageElement){\r\n            if(messageElement.is(':visible')){\r\n                messageElement.velocity('transition.slideDownOut', settingsMessageVelocityOptions);\r\n            }else if(callback){\r\n                // skip hide animation\r\n                callback(messageElement);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * init form elements for validation (bootstrap3 validation)\r\n     * @param options\r\n     * @returns {*}\r\n     */\r\n    $.fn.initFormValidation = function(options){\r\n        options = (typeof options === 'undefined')? {} : options;\r\n\r\n        return this.each(function(){\r\n            var form = $(this);\r\n\r\n            // init form validation\r\n            form.validator(options);\r\n\r\n            // validation event listener\r\n            form.on('valid.bs.validator', function(validatorObj){\r\n                var inputGroup = $(validatorObj.relatedTarget).parents('.form-group');\r\n                if(inputGroup){\r\n                    inputGroup.removeClass('has-error').addClass('has-success');\r\n                }\r\n            });\r\n\r\n            form.on('invalid.bs.validator', function(validatorObj){\r\n                var field = $(validatorObj.relatedTarget);\r\n                var inputGroup = field.parents('.form-group');\r\n                if(inputGroup){\r\n                    inputGroup.removeClass('has-success').addClass('has-error');\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * checks whether a bootstrap form is valid or not\r\n     * validation plugin does not provide a proper function for this\r\n     * @returns {boolean}\r\n     */\r\n    $.fn.isValidForm = function(){\r\n        var form = $(this);\r\n        var valid = false;\r\n\r\n        var errorElements =  form.find('.has-error');\r\n\r\n        if(errorElements.length === 0){\r\n            valid = true;\r\n        }\r\n\r\n        return valid;\r\n    };\r\n\r\n    /**\r\n     * get all form Values as object\r\n     * this includes all xEditable fields\r\n     * @returns {{}}\r\n     */\r\n    $.fn.getFormValues = function(){\r\n        var form = $(this);\r\n\r\n        var formData = {};\r\n\r\n        $.each(form.serializeArray(), function(i, field) {\r\n            if(field.name.indexOf('[]') !== -1){\r\n                // array field\r\n                var key = field.name.replace('[]', '');\r\n                if(! $.isArray(formData[key]) ){\r\n                    formData[key] = [];\r\n                }\r\n\r\n                formData[key].push( field.value);\r\n            }else{\r\n                formData[field.name] = field.value;\r\n            }\r\n        });\r\n\r\n        // get xEditable values\r\n        var editableValues = form.find('.' + config.formEditableFieldClass).editable('getValue');\r\n\r\n        // merge values\r\n        formData = $.extend(formData, editableValues);\r\n\r\n        return formData;\r\n    };\r\n\r\n    /**\r\n     * check multiple element if they arecurrently visible in viewport\r\n     * @returns {Array}\r\n     */\r\n    $.fn.isInViewport = function(){\r\n\r\n        var visibleElement = [];\r\n\r\n        this.each(function(){\r\n            var element = $(this)[0];\r\n\r\n            var top = element.offsetTop;\r\n            var left = element.offsetLeft;\r\n            var width = element.offsetWidth;\r\n            var height = element.offsetHeight;\r\n\r\n            while(element.offsetParent) {\r\n                element = element.offsetParent;\r\n                top += element.offsetTop;\r\n                left += element.offsetLeft;\r\n            }\r\n\r\n            if(\r\n                top < (window.pageYOffset + window.innerHeight) &&\r\n                left < (window.pageXOffset + window.innerWidth) &&\r\n                (top + height) > window.pageYOffset &&\r\n                (left + width) > window.pageXOffset\r\n            ){\r\n                visibleElement.push( this );\r\n            }\r\n        });\r\n\r\n        return visibleElement;\r\n    };\r\n\r\n    /**\r\n     * init the map-update-counter as \"easy-pie-chart\"\r\n     */\r\n    $.fn.initMapUpdateCounter = function(){\r\n\r\n        var counterChart = $(this);\r\n\r\n        counterChart.easyPieChart({\r\n            barColor: function(percent){\r\n\r\n                var color = '#568a89';\r\n                if(percent <= 30){\r\n                    color = '#d9534f';\r\n                }else if(percent <= 50){\r\n                    color = '#f0ad4e';\r\n                }\r\n\r\n                return color;\r\n\r\n            },\r\n            trackColor: '#2b2b2b',\r\n            size: 30,\r\n            scaleColor: false,\r\n            lineWidth: 2,\r\n            animate: 1000\r\n        });\r\n    };\r\n\r\n    /**\r\n     * init tooltips on an element\r\n     * @param  {object} options\r\n     * @returns {*}\r\n     */\r\n    $.fn.initTooltips = function(options){\r\n\r\n        options = (typeof options === 'object') ? options : {};\r\n\r\n        var defaultOptions = {\r\n            container:  this,\r\n            delay: 100\r\n        };\r\n        options = $.extend(defaultOptions, options);\r\n\r\n        return this.each(function(){\r\n            var tooltipElements = $(this).find('[title]');\r\n            tooltipElements.tooltip('destroy').tooltip(options);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * adds a popup tooltip with character information (created/updated)\r\n     * @param tooltipData\r\n     */\r\n    $.fn.addCharacterInfoTooltip = function(tooltipData){\r\n        var element = $(this);\r\n\r\n        if(\r\n            tooltipData.created.character &&\r\n            tooltipData.updated.character\r\n        ){\r\n            var createdData = tooltipData.created;\r\n            var updatedData = tooltipData.updated;\r\n\r\n            // check if data has changed\r\n            if(\r\n                element.data('created') !== createdData.created ||\r\n                element.data('updated') !== updatedData.updated\r\n            ){\r\n                // data changed\r\n                // set new data for next check\r\n                element.data('created', createdData.created);\r\n                element.data('updated', updatedData.updated);\r\n\r\n                var statusCreatedClass = getStatusInfoForCharacter(createdData.character, 'class');\r\n                var statusUpdatedClass = getStatusInfoForCharacter(updatedData.character, 'class');\r\n\r\n                // convert timestamps\r\n                var dateCreated = new Date(createdData.created * 1000);\r\n                var dateUpdated = new Date(updatedData.updated * 1000);\r\n                var dateCreatedUTC = convertDateToUTC(dateCreated);\r\n                var dateUpdatedUTC = convertDateToUTC(dateUpdated);\r\n\r\n                var data = {\r\n                    created: createdData,\r\n                    updated: updatedData,\r\n                    createdTime: convertDateToString(dateCreatedUTC),\r\n                    updatedTime: convertDateToString(dateUpdatedUTC),\r\n                    createdStatusClass: statusCreatedClass,\r\n                    updatedStatusClass: statusUpdatedClass\r\n                };\r\n\r\n                requirejs(['text!templates/tooltip/character_info.html', 'mustache'], function(template, Mustache) {\r\n                    var content = Mustache.render(template, data);\r\n\r\n                    element.popover({\r\n                        placement: 'top',\r\n                        html: true,\r\n                        trigger: 'hover',\r\n                        content: '',\r\n                        container: 'body',\r\n                        title: 'Created / Updated',\r\n                        delay: {\r\n                            show: 250,\r\n                            hide: 0\r\n                        }\r\n                    });\r\n\r\n                    // set new popover content\r\n                    var popover = element.data('bs.popover');\r\n                    popover.options.content = content;\r\n                });\r\n\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * add character switch popover\r\n     * @param userData\r\n     */\r\n    $.fn.initCharacterSwitchPopover = function(userData){\r\n        var elements = $(this);\r\n        var eventNamespace = 'hideCharacterPopup';\r\n\r\n        requirejs(['text!templates/tooltip/character_switch.html', 'mustache'], function (template, Mustache) {\r\n\r\n            var data = {\r\n                id: config.headCharacterSwitchId,\r\n                routes:  Init.routes,\r\n                userData: userData,\r\n                otherCharacters: $.grep( userData.characters, function( character ) {\r\n                    // exclude current active character\r\n                    return character.id !== userData.character.id;\r\n                })\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            return elements.each(function() {\r\n                var element = $(this);\r\n\r\n                // check if tooltip already exists -> remove it\r\n                if(element.data('bs.popover') !== undefined){\r\n                    element.off('click').popover('destroy');\r\n                }\r\n\r\n                element.on('click', function(e) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n\r\n                    var easeEffect = $(this).attr('data-easein');\r\n                    var popoverData = $(this).data('bs.popover');\r\n                    var popoverElement = null;\r\n\r\n                    var velocityOptions = {\r\n                        duration: Init.animationSpeed.dialogEvents\r\n                    };\r\n\r\n                    if(popoverData === undefined){\r\n\r\n                        // init popover and add specific class to it (for styling)\r\n                        $(this).popover({\r\n                            html: true,\r\n                            title: 'select character',\r\n                            trigger: 'manual',\r\n                            placement: 'bottom',\r\n                            container: 'body',\r\n                            content: content,\r\n                            animation: false\r\n                        }).data('bs.popover').tip().addClass('pf-popover');\r\n\r\n                        $(this).popover('show');\r\n\r\n                        popoverElement = $(this).data('bs.popover').tip();\r\n                        popoverElement.velocity('transition.' + easeEffect, velocityOptions);\r\n                        popoverElement.initTooltips();\r\n                    }else{\r\n                        popoverElement = $(this).data('bs.popover').tip();\r\n                        if(popoverElement.is(':visible')){\r\n                            popoverElement.velocity('reverse');\r\n                        }else{\r\n                            $(this).popover('show');\r\n                            popoverElement.initTooltips();\r\n                            popoverElement.velocity('transition.' + easeEffect, velocityOptions);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // set popup \"close\" observer\r\n                elements.initPopoverClose(eventNamespace);\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * set \"popover\" close action on clicking \"somewhere\" on the <body>\r\n     * @param eventNamespace\r\n     * @returns {*}\r\n     */\r\n    $.fn.initPopoverClose = function(eventNamespace){\r\n        return this.each(function() {\r\n            $('body').off('click.' + eventNamespace).on('click.' + eventNamespace + ' contextmenu', function (e) {\r\n\r\n                $('.' + config.popoverTriggerClass).each(function () {\r\n                    var popoverElement = $(this);\r\n                    //the 'is' for buttons that trigger popups\r\n                    //the 'has' for icons within a button that triggers a popup\r\n                    if(\r\n                        !popoverElement.is(e.target) &&\r\n                        popoverElement.has(e.target).length === 0 &&\r\n                        $('.popover').has(e.target).length === 0\r\n                    ){\r\n                        var popover = popoverElement.data('bs.popover');\r\n\r\n                        if(\r\n                            popover !== undefined &&\r\n                            popover.tip().is(':visible')\r\n                        ){\r\n                            popoverElement.popover('hide');\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * add a wormhole tooltip with wh specific data to elements\r\n     * @param tooltipData\r\n     * @returns {*}\r\n     */\r\n    $.fn.addWormholeInfoTooltip = function(tooltipData){\r\n        return this.each(function() {\r\n            var element = $(this);\r\n\r\n            requirejs(['text!templates/tooltip/wormhole_info.html', 'mustache'], function (template, Mustache) {\r\n                var content = Mustache.render(template, tooltipData);\r\n\r\n                element.popover({\r\n                    placement: 'top',\r\n                    html: true,\r\n                    trigger: 'hover',\r\n                    content: '',\r\n                    container: 'body',\r\n                    title: tooltipData.name +\r\n                        '<span class=\"pull-right ' + tooltipData.class +'\">' + tooltipData.security + '</span>',\r\n                    delay: {\r\n                        show: 250,\r\n                        hide: 0\r\n                    }\r\n                });\r\n\r\n                // set new popover content\r\n                var popover = element.data('bs.popover');\r\n                popover.options.content = content;\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * display a custom message (info/warning/error) to a container element\r\n     * check: $.fn.showFormMessage() for an other way of showing messages\r\n     * @param config\r\n     */\r\n    $.fn.showMessage = function(config){\r\n        var containerElement = $(this);\r\n\r\n        requirejs(['text!templates/form/message.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var messageTypeClass = 'alert-danger';\r\n            var messageTextClass = 'txt-color-danger';\r\n\r\n            switch(config.type){\r\n                case 'info':\r\n                    messageTypeClass = 'alert-info';\r\n                    messageTextClass = 'txt-color-information';\r\n                    break;\r\n                case 'success':\r\n                    messageTypeClass = 'alert-success';\r\n                    messageTextClass = 'txt-color-success';\r\n                    break;\r\n                case 'warning':\r\n                    messageTypeClass = 'alert-warning';\r\n                    messageTextClass = 'txt-color-warning';\r\n                    break;\r\n            }\r\n\r\n            var data = {\r\n                title: config.title,\r\n                text: config.text,\r\n                messageTypeClass: messageTypeClass,\r\n                messageTextClass: messageTextClass\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            containerElement.html(content);\r\n\r\n            containerElement.children().first().velocity('stop').velocity('fadeIn');\r\n\r\n        });\r\n    };\r\n\r\n    /**\r\n     * wrapper function for onClick() || onDblClick() events in order to distinguish between this two types of events\r\n     * @param singleClickCallback\r\n     * @param doubleClickCallback\r\n     * @param timeout\r\n     * @returns {any|JQuery|*}\r\n     */\r\n    $.fn.singleDoubleClick = function(singleClickCallback, doubleClickCallback, timeout) {\r\n        return this.each(function(){\r\n            var clicks = 0, self = this;\r\n\r\n            // prevent default behaviour (e.g. open <a>-tag link)\r\n            $(this).on('click', function(e){\r\n                e.preventDefault();\r\n            });\r\n\r\n            $(this).on('mouseup', function(e){\r\n                clicks++;\r\n                if (clicks === 1) {\r\n                    setTimeout(function(){\r\n                        if(clicks === 1) {\r\n                            singleClickCallback.call(self, e);\r\n                        } else {\r\n                            doubleClickCallback.call(self, e);\r\n                        }\r\n                        clicks = 0;\r\n                    }, timeout || Init.timer.DBL_CLICK);\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * highlight jquery elements\r\n     * add/remove css class for keyframe animation\r\n     * @returns {any|JQuery|*}\r\n     */\r\n    $.fn.pulseTableRow = function(status, clear){\r\n\r\n        var animationClass = '';\r\n        switch(status){\r\n            case 'added':\r\n                animationClass = config.animationPulseSuccessClass;\r\n                break;\r\n            case 'changed':\r\n                animationClass = config.animationPulseWarningClass;\r\n                break;\r\n        }\r\n\r\n        var clearTimer =  function(element) {\r\n            element.removeClass( animationClass );\r\n            var currentTimer = element.data('animationTimer');\r\n\r\n            if( animationTimerCache.hasOwnProperty(currentTimer) ){\r\n                clearTimeout( currentTimer );\r\n                delete animationTimerCache[currentTimer];\r\n                element.removeData('animationTimer');\r\n            }\r\n        };\r\n\r\n        return this.each(function(){\r\n            var element = $(this);\r\n\r\n            if( element.hasClass(animationClass) ){\r\n                // clear timer -> set new timer\r\n                clearTimer(element);\r\n            }\r\n\r\n            if(clear !== true){\r\n                element.addClass( animationClass );\r\n                var timer = setTimeout(clearTimer, 1500, element);\r\n                element.data('animationTimer', timer);\r\n                animationTimerCache[timer] = true;\r\n            }\r\n\r\n        });\r\n    };\r\n\r\n    /*\r\n     *  ===========================================================================================================\r\n     *   Util functions that are global available for all modules\r\n     *   ==========================================================================================================\r\n     */\r\n\r\n    /**\r\n     * show current program version information in browser console\r\n     */\r\n    var showVersionInfo = function(){\r\n        var versionNumber = $('body').data('version');\r\n        console.info('PATHFINDER ' + versionNumber);\r\n    };\r\n\r\n    /**\r\n     * init utility prototype functions\r\n     */\r\n    var initPrototypes = function(){\r\n        // Array diff\r\n        // [1,2,3,4,5,6].diff( [3,4,5] );\r\n        // => [1, 2, 6]\r\n        Array.prototype.diff = function(a) {\r\n            return this.filter(function(i) {return a.indexOf(i) < 0;});\r\n        };\r\n    };\r\n\r\n    /**\r\n     * set default configuration  for \"Bootbox\" dialogs\r\n     */\r\n    var initDefaultBootboxConfig = function(){\r\n        bootbox.setDefaults({\r\n            onEscape: true      // enables close dialogs on ESC key\r\n        });\r\n    };\r\n\r\n    /**\r\n     * get the current main trigger delay for the main trigger functions\r\n     * optional in/decrease the delay\r\n     * @param updateKey\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    var getCurrentTriggerDelay = function( updateKey, value ){\r\n\r\n        // make sure the delay timer is valid!\r\n        // if this is called for the first time -> set CURRENT_DELAY\r\n        if(\r\n            Init.timer[updateKey].CURRENT_DELAY === undefined ||\r\n            Init.timer[updateKey].CURRENT_DELAY <= 0\r\n        ){\r\n            Init.timer[updateKey].CURRENT_DELAY = Init.timer[updateKey].DELAY;\r\n        }\r\n\r\n        // in/decrease the trigger delay\r\n        if(\r\n            value === parseInt(value, 10)  &&\r\n            ( Init.timer[updateKey].CURRENT_DELAY ) + value > 0\r\n        ){\r\n            Init.timer[updateKey].CURRENT_DELAY += value;\r\n        }\r\n\r\n        return Init.timer[updateKey].CURRENT_DELAY;\r\n    };\r\n\r\n    /**\r\n     * get date obj with current EVE Server Time.\r\n     * @returns {Date}\r\n     */\r\n    var getServerTime = function(){\r\n\r\n        // Server is running with GMT/UTC (EVE Time)\r\n        var localDate = new Date();\r\n\r\n        var serverDate= new Date(\r\n            localDate.getUTCFullYear(),\r\n            localDate.getUTCMonth(),\r\n            localDate.getUTCDate(),\r\n            localDate.getUTCHours(),\r\n            localDate.getUTCMinutes(),\r\n            localDate.getUTCSeconds()\r\n        );\r\n\r\n        return serverDate;\r\n    };\r\n\r\n    /**\r\n     * convert timestamp to server time\r\n     * @param timestamp\r\n     * @returns {Date}\r\n     */\r\n    var convertTimestampToServerTime = function(timestamp){\r\n        var currentTimeZoneOffsetInMinutes = new Date().getTimezoneOffset();\r\n        return new Date( (timestamp + (currentTimeZoneOffsetInMinutes * 60)) * 1000);\r\n    };\r\n\r\n    /**\r\n     * get date difference as time parts (days, hours, minutes, seconds)\r\n     * @param date1\r\n     * @param date2\r\n     * @returns {{}}\r\n     */\r\n    var getTimeDiffParts = function(date1, date2){\r\n        var parts = {};\r\n        var time1 = date1.getTime();\r\n        var time2 = date2.getTime();\r\n        var diff  = 0;\r\n\r\n        if(\r\n            time1 >= 0 &&\r\n            time2 >= 0\r\n        ){\r\n            diff = (date2.getTime() - date1.getTime()) / 1000;\r\n        }\r\n\r\n        diff = Math.abs(Math.floor(diff));\r\n\r\n        parts.days = Math.floor(diff/(24*60*60));\r\n        var leftSec = diff - parts.days * 24*60*60;\r\n\r\n        parts.hours = Math.floor(leftSec/(60*60));\r\n        leftSec = leftSec - parts.hours * 60*60;\r\n\r\n        parts.min = Math.floor(leftSec/(60));\r\n        parts.sec = leftSec - parts.min * 60;\r\n        return parts;\r\n    };\r\n\r\n    /**\r\n     * start time measurement by a unique string identifier\r\n     * @param timerName\r\n     */\r\n    var timeStart = function(timerName){\r\n\r\n        if(typeof performance === 'object'){\r\n            stopTimerCache[timerName] = performance.now();\r\n        }else{\r\n            stopTimerCache[timerName] = new Date().getTime();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get time delta between timeStart() and timeStop() by a unique string identifier\r\n     * @param timerName\r\n     * @returns {number}\r\n     */\r\n    var timeStop = function(timerName){\r\n\r\n        var duration = 0;\r\n\r\n        if( stopTimerCache.hasOwnProperty(timerName) ){\r\n            // check browser support for performance API\r\n            var timeNow = 0;\r\n\r\n            if(typeof performance === 'object'){\r\n                timeNow = performance.now();\r\n            }else{\r\n                timeNow = new Date();\r\n            }\r\n\r\n            // format ms time duration\r\n            duration = Number( (timeNow - stopTimerCache[timerName] ).toFixed(2) );\r\n\r\n            // delete key\r\n            delete( stopTimerCache[timerName]);\r\n        }\r\n\r\n        return duration;\r\n    };\r\n\r\n    /**\r\n     * trigger main logging event with log information\r\n     * @param message\r\n     * @param options\r\n     */\r\n    var log = function(logKey, options){\r\n        $(window).trigger('pf:log', [logKey, options]);\r\n    };\r\n\r\n    /**\r\n     * trigger a notification (on screen or desktop)\r\n     * @param customConfig\r\n     * @param desktop\r\n     */\r\n    var showNotify = function(customConfig, desktop){\r\n        requirejs(['app/notification'], function(Notification) {\r\n            Notification.showNotify(customConfig, desktop);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * stop browser tab title \"blinking\"\r\n     */\r\n    var stopTabBlink = function(){\r\n        requirejs(['app/notification'], function(Notification) {\r\n            Notification.stopTabBlink();\r\n        });\r\n    };\r\n\r\n    /**\r\n     * get log entry info\r\n     * @param logType\r\n     * @param option\r\n     * @returns {string}\r\n     */\r\n    var getLogInfo = function(logType, option){\r\n        var logInfo = '';\r\n\r\n        if(Init.classes.logTypes.hasOwnProperty(logType)){\r\n            logInfo = Init.classes.logTypes[logType][option];\r\n        }\r\n\r\n        return logInfo;\r\n    };\r\n\r\n    /**\r\n     * set default jQuery AJAX configuration\r\n     */\r\n    var ajaxSetup = function(){\r\n        $.ajaxSetup({\r\n            beforeSend: function(xhr, settings) {\r\n                // Add custom application headers on \"same origin\" requests only!\r\n                // -> Otherwise a \"preflight\" request is made, which will \"probably\" fail\r\n                if(settings.crossDomain === false){\r\n                    // add current character data to ANY XHR request (HTTP HEADER)\r\n                    // -> This helps to identify multiple characters on multiple browser tabs\r\n                    var userData = getCurrentUserData();\r\n                    var currentCharacterId = 0;\r\n                    if(\r\n                        userData &&\r\n                        userData.character\r\n                    ){\r\n                        currentCharacterId = parseInt( userData.character.id );\r\n                    }\r\n\r\n                    xhr.setRequestHeader('Pf-Character', currentCharacterId);\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Returns true if the user hit Esc or navigated away from the\r\n     * current page before an AJAX call was done. (The response\r\n     * headers will be null or empty, depending on the browser.)\r\n     *\r\n     * NOTE: this function is only meaningful when called from\r\n     * inside an AJAX \"error\" callback!\r\n     * @param jqXHR XMLHttpRequest instance\r\n     * @returns {boolean}\r\n     */\r\n    var isXHRAborted = function(jqXHR){\r\n        return !jqXHR.getAllResponseHeaders();\r\n    };\r\n\r\n    /**\r\n     * get all mapTabElements (<a> tags)\r\n     * or search for a specific tabElement within the\r\n     * mapModuleElement\r\n     * @param mapId\r\n     * @returns {JQuery|*|{}|T}\r\n     */\r\n    $.fn.getMapTabElements = function(mapId){\r\n\r\n        var mapModuleElement = $(this);\r\n\r\n        var mapTabElements = mapModuleElement.find('#' + config.mapTabBarId).find('a');\r\n\r\n        if(mapId){\r\n            // search for a specific tab element\r\n            mapTabElements = mapTabElements.filter(function(i, el){\r\n                return ( $(el).data('map-id') === mapId );\r\n            });\r\n        }\r\n\r\n        return mapTabElements;\r\n    };\r\n\r\n    /**\r\n     * get the map module object or create a new module\r\n     * @returns {*|HTMLElement}\r\n     */\r\n    var getMapModule = function(){\r\n\r\n        var mapModule = $('#' + config.mapModuleId);\r\n        if(mapModule.length === 0){\r\n            mapModule = $('<div>', {\r\n                id: config.mapModuleId\r\n            });\r\n        }\r\n\r\n        return mapModule;\r\n    };\r\n\r\n    /**\r\n     * get system effect data by system security and system class\r\n     * if no search parameters given -> get all effect data\r\n     * @param security\r\n     * @param effect\r\n     * @returns {boolean}\r\n     */\r\n    var getSystemEffectData = function(security, effect){\r\n        var data =  SystemEffect;\r\n        if(security){\r\n            // look for specific data\r\n            data = false;\r\n            var areaId = getAreaIdBySecurity(security);\r\n\r\n            if(\r\n                areaId > 0 &&\r\n                SystemEffect.wh[effect] &&\r\n                SystemEffect.wh[effect][areaId]\r\n            ){\r\n                data = SystemEffect.wh[effect][areaId];\r\n            }\r\n        }\r\n\r\n        return data;\r\n    };\r\n\r\n    /**\r\n     * get status info for a character for a given status\r\n     * @param characterData\r\n     * @param option\r\n     * @returns {string}\r\n     */\r\n    var getStatusInfoForCharacter = function(characterData, option){\r\n\r\n        var statusInfo = '';\r\n\r\n        // character status can not be checked if there are no reference data\r\n        // e.g. during registration process (login page)\r\n        if(Init.characterStatus){\r\n            // get info for current \"main\" character\r\n            var corporationId = getCurrentUserInfo('corporationId');\r\n            var allianceId = getCurrentUserInfo('allianceId');\r\n\r\n            // get all user characters\r\n            var userData = getCurrentUserData();\r\n\r\n            if(userData){\r\n                // check if character is one of his own characters\r\n                var userCharactersData = userData.characters;\r\n\r\n                for(var i = 0; i < userCharactersData.length; i++){\r\n                    if(userCharactersData[i].id === characterData.id){\r\n                        statusInfo = Init.characterStatus.own[option];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if(statusInfo === ''){\r\n                // compare current user data with given user data\r\n                if(\r\n                    characterData.corporation &&\r\n                    characterData.corporation.id === corporationId\r\n                ){\r\n                    statusInfo = Init.characterStatus.corporation[option];\r\n                }else if(\r\n                    characterData.alliance &&\r\n                    characterData.alliance.id === allianceId\r\n                ){\r\n                    statusInfo = Init.characterStatus.alliance[option];\r\n                }\r\n            }\r\n        }\r\n\r\n        return statusInfo;\r\n    };\r\n\r\n    /**\r\n     * get a HTML table with system effect information\r\n     * e.g. for popover\r\n     * @param data\r\n     * @returns {string}\r\n     */\r\n    var getSystemEffectTable = function(data){\r\n        var table = '';\r\n\r\n        if(data.length > 0){\r\n\r\n            table += '<table>';\r\n            for(var i = 0; i < data.length; i++){\r\n                table += '<tr>';\r\n                table += '<td>';\r\n                table += data[i].effect;\r\n                table += '</td>';\r\n                table += '<td class=\"text-right\">';\r\n                table += data[i].value;\r\n                table += '</td>';\r\n                table += '</tr>';\r\n            }\r\n            table += '</table>';\r\n        }\r\n\r\n        return table;\r\n    };\r\n\r\n    /**\r\n     * get a HTML table with information for multiple systems\r\n     * e.g. for popover\r\n     * @param data\r\n     * @returns {string}\r\n     */\r\n    var getSystemsInfoTable = function(data){\r\n        var table = '';\r\n\r\n        if(data.length > 0){\r\n\r\n            table += '<table>';\r\n            for(var i = 0; i < data.length; i++){\r\n\r\n                var trueSecClass = getTrueSecClassForSystem( data[i].trueSec );\r\n                var securityClass = getSecurityClassForSystem( data[i].security );\r\n\r\n                table += '<tr>';\r\n                table += '<td>';\r\n                table += data[i].name;\r\n                table += '</td>';\r\n                table += '<td class=\"text-right ' + securityClass + '\">';\r\n                table += data[i].security;\r\n                table += '</td>';\r\n                table += '<td class=\"text-right ' + trueSecClass + '\">';\r\n                table += parseFloat( data[i].trueSec ).toFixed(1);\r\n                table += '</td>';\r\n                table += '</tr>';\r\n            }\r\n            table += '</table>';\r\n        }\r\n\r\n        return table;\r\n    };\r\n\r\n    /**\r\n     * get a css class for the security level of a system\r\n     * @param sec\r\n     * @returns {string}\r\n     */\r\n    var getSecurityClassForSystem = function(sec){\r\n        var secClass = '';\r\n\r\n        if( Init.classes.systemSecurity.hasOwnProperty(sec) ){\r\n            secClass = Init.classes.systemSecurity[sec]['class'];\r\n        }\r\n\r\n        return secClass;\r\n    };\r\n\r\n    /**\r\n     * get a css class for the trueSec level of a system\r\n     * @param sec\r\n     * @returns {string}\r\n     */\r\n    var getTrueSecClassForSystem = function(trueSec){\r\n        var trueSecClass = '';\r\n\r\n        trueSec = parseFloat(trueSec);\r\n\r\n        // check for valid decimal number\r\n        if(\r\n            !isNaN( trueSec ) &&\r\n            isFinite( trueSec )\r\n        ){\r\n            if(trueSec < 0){\r\n                trueSec = 0;\r\n            }\r\n\r\n            trueSec = trueSec.toFixed(1).toString();\r\n\r\n            if( Init.classes.trueSec.hasOwnProperty(trueSec) ){\r\n                trueSecClass = Init.classes.trueSec[trueSec]['class'];\r\n            }\r\n        }\r\n\r\n        return trueSecClass;\r\n    };\r\n\r\n    /**\r\n     * get status info\r\n     * @param status\r\n     * @param option\r\n     * @returns {string}\r\n     */\r\n    var getStatusInfoForSystem = function(status, option){\r\n\r\n        var statusInfo = '';\r\n\r\n        if( Init.systemStatus.hasOwnProperty(status) ){\r\n            // search by status string\r\n            statusInfo = Init.systemStatus[status][option];\r\n        }else{\r\n            // saarch by statusID\r\n            $.each(Init.systemStatus, function(prop, data){\r\n\r\n                if(status === data.id){\r\n                    statusInfo = data[option];\r\n                    return;\r\n                }\r\n            });\r\n        }\r\n\r\n        return statusInfo;\r\n    };\r\n\r\n    /**\r\n     * get signature group information\r\n     * @param option\r\n     * @returns {{}}\r\n     */\r\n    var getSignatureGroupInfo = function(option){\r\n\r\n        var groupInfo = {};\r\n\r\n        for (var prop in Init.signatureGroups) {\r\n            if(Init.signatureGroups.hasOwnProperty(prop)){\r\n                prop = parseInt(prop);\r\n                groupInfo[prop] = Init.signatureGroups[prop][option];\r\n            }\r\n        }\r\n\r\n        return groupInfo;\r\n    };\r\n\r\n    /**\r\n     * get Signature names out of global\r\n     * @param systemTypeId\r\n     * @param areaId\r\n     * @param sigGroupId\r\n     * @returns {{}}\r\n     */\r\n    var getAllSignatureNames = function(systemTypeId, areaId, sigGroupId){\r\n\r\n        var signatureNames = {};\r\n\r\n        if(\r\n            SignatureType[systemTypeId] &&\r\n            SignatureType[systemTypeId][areaId] &&\r\n            SignatureType[systemTypeId][areaId][sigGroupId]\r\n        ){\r\n            signatureNames =  SignatureType[systemTypeId][areaId][sigGroupId];\r\n        }\r\n\r\n        return signatureNames;\r\n    };\r\n\r\n    /**\r\n     * get the typeID of a signature name\r\n     * @param systemData\r\n     * @param sigGroupId\r\n     * @param name\r\n     * @returns {number}\r\n     */\r\n    var getSignatureTypeIdByName = function(systemData, sigGroupId, name){\r\n\r\n        var signatureTypeId = 0;\r\n\r\n        var areaId = getAreaIdBySecurity(systemData.security);\r\n\r\n        if(areaId > 0){\r\n            var signatureNames = getAllSignatureNames(systemData.type.id, areaId, sigGroupId );\r\n            name = name.toLowerCase();\r\n\r\n            for(var prop in signatureNames) {\r\n\r\n                if(\r\n                    signatureNames.hasOwnProperty(prop) &&\r\n                    signatureNames[prop].toLowerCase() === name\r\n                ){\r\n                    signatureTypeId = parseInt( prop );\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return signatureTypeId;\r\n    };\r\n\r\n    /**\r\n     * get Area ID by security string\r\n     * @param security\r\n     * @returns {number}\r\n     */\r\n    var getAreaIdBySecurity = function(security){\r\n\r\n        var areaId = 0;\r\n\r\n        switch(security){\r\n            case 'H':\r\n                areaId = 10;\r\n                break;\r\n            case 'L':\r\n                areaId = 11;\r\n                break;\r\n            case '0.0':\r\n                areaId = 12;\r\n                break;\r\n            case 'SH':\r\n                areaId = 13;\r\n                break;\r\n            default:\r\n                // w-space\r\n                for(var i = 1; i <= 6; i++){\r\n                    if(security === 'C' + i){\r\n                        areaId = i;\r\n                        break;\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n\r\n        return areaId;\r\n    };\r\n\r\n    /**\r\n     * set currentMapUserData as \"global\" variable (count of active pilots)\r\n     * this function should be called continuously after data change\r\n     * to keep the data always up2data\r\n     * @param mapUserData\r\n     */\r\n    var setCurrentMapUserData = function(mapUserData){\r\n        Init.currentMapUserData = mapUserData;\r\n\r\n        return getCurrentMapUserData();\r\n    };\r\n\r\n    /**\r\n     * get currentMapUserData from \"global\" variable for specific map or all maps\r\n     * @param mapId\r\n     * @returns {boolean}\r\n     */\r\n    var getCurrentMapUserData = function(mapId){\r\n\r\n        var currentMapUserData = false;\r\n\r\n        if( mapId === parseInt(mapId, 10) ){\r\n            // search for a specific map\r\n            for(var i = 0; i < Init.currentMapUserData.length; i++){\r\n                if(Init.currentMapUserData[i].config.id === mapId){\r\n                    currentMapUserData = Init.currentMapUserData[i];\r\n                    break;\r\n                }\r\n            }\r\n        }else{\r\n            // get data for all maps\r\n            currentMapUserData = Init.currentMapUserData;\r\n        }\r\n\r\n        if(currentMapUserData !== false){\r\n            // return a fresh (deep) copy of that, in case of further modifications\r\n            currentMapUserData = $.extend(true, {}, currentMapUserData);\r\n        }\r\n\r\n        return currentMapUserData;\r\n    };\r\n\r\n    /**\r\n     * set currentMapData as \"global\" variable\r\n     * this function should be called continuously after data change\r\n     * to keep the data always up2data\r\n     * @param mapData\r\n     */\r\n    var setCurrentMapData = function(mapData){\r\n        Init.currentMapData = mapData;\r\n\r\n        return getCurrentMapData();\r\n    };\r\n\r\n    /**\r\n     * get currentMapData from \"global\" variable for a specific map or all maps\r\n     * @param mapId\r\n     * @returns {boolean}\r\n     */\r\n    var getCurrentMapData = function(mapId){\r\n        var currentMapData = false;\r\n\r\n        if( mapId === parseInt(mapId, 10) ){\r\n            // search for a specific map\r\n            for(var i = 0; i < Init.currentMapData.length; i++){\r\n                if(Init.currentMapData[i].config.id === mapId){\r\n                    currentMapData = Init.currentMapData[i];\r\n                    break;\r\n                }\r\n            }\r\n        }else{\r\n            // get data for all maps\r\n            currentMapData = Init.currentMapData;\r\n        }\r\n\r\n        return currentMapData;\r\n    };\r\n\r\n    /**\r\n     * get mapData array index by mapId\r\n     * @param mapId\r\n     * @returns {boolean|int}\r\n     */\r\n    var getCurrentMapDataIndex = function(mapId){\r\n        var mapDataIndex = false;\r\n\r\n        if( mapId === parseInt(mapId, 10) ){\r\n            for(var i = 0; i < Init.currentMapData.length; i++){\r\n                if(Init.currentMapData[i].config.id === mapId){\r\n                    mapDataIndex = i;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return mapDataIndex;\r\n    };\r\n\r\n\r\n    /**\r\n     * set currentUserData as \"global\" variable\r\n     * this function should be called continuously after data change\r\n     * to keep the data always up2data\r\n     * @param userData\r\n     */\r\n    var setCurrentUserData = function(userData){\r\n        Init.currentUserData = userData;\r\n\r\n        // check if function is available\r\n        // this is not the case in \"login\" page\r\n        if( $.fn.updateHeaderUserData ){\r\n            $.fn.updateHeaderUserData();\r\n        }\r\n\r\n        return getCurrentUserData();\r\n    };\r\n\r\n    /**\r\n     * get currentUserData from \"global\" variable\r\n     * @returns {*}\r\n     */\r\n    var getCurrentUserData = function(){\r\n        return Init.currentUserData;\r\n    };\r\n\r\n    /**\r\n     * get the current log data for the current user character\r\n     * @returns {boolean}\r\n     */\r\n    var getCurrentCharacterLog = function(){\r\n\r\n        var characterLog = false;\r\n\r\n        var currentUserData = getCurrentUserData();\r\n\r\n        if(\r\n            currentUserData &&\r\n            currentUserData.character &&\r\n            currentUserData.character.log\r\n        ){\r\n            characterLog = currentUserData.character.log;\r\n        }\r\n\r\n        return characterLog;\r\n    };\r\n\r\n    /**\r\n     * get information for the current mail user\r\n     * @param option\r\n     * @returns {boolean}\r\n     */\r\n    var getCurrentUserInfo = function(option){\r\n        var currentUserData = getCurrentUserData();\r\n        var userInfo = false;\r\n\r\n        if(currentUserData){\r\n            // user data is set -> user data will be set AFTER the main init request!\r\n            var characterData = currentUserData.character;\r\n\r\n            if(characterData){\r\n                if(\r\n                    option === 'allianceId' &&\r\n                    characterData.alliance\r\n                ){\r\n                    userInfo = characterData.alliance.id;\r\n                }\r\n\r\n                if(\r\n                    option === 'corporationId' &&\r\n                    characterData.corporation\r\n                ){\r\n                    userInfo = characterData.corporation.id;\r\n                }\r\n            }\r\n        }\r\n\r\n        return userInfo;\r\n    };\r\n\r\n    /**\r\n     * set new destination for a system\r\n     * -> CREST request\r\n     * @param systemData\r\n     * @param type\r\n     */\r\n    var setDestination = function(systemData, type){\r\n        var description = '';\r\n        switch(type){\r\n            case 'set_destination':\r\n                description = 'Set destination';\r\n                break;\r\n            case 'add_first_waypoint':\r\n                description = 'Set first waypoint';\r\n                break;\r\n            case 'add_last_waypoint':\r\n                description = 'Set new waypoint';\r\n                break;\r\n        }\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.setDestination,\r\n            data: {\r\n                clearOtherWaypoints: (type === 'set_destination') ? 1 : 0,\r\n                first: (type === 'add_last_waypoint') ? 0 : 1,\r\n                systemData: [{\r\n                    systemId: systemData.systemId,\r\n                    name: systemData.name\r\n                }]\r\n            },\r\n            context: {\r\n                description: description\r\n            },\r\n            dataType: 'json'\r\n        }).done(function(responseData){\r\n            if(\r\n                responseData.systemData &&\r\n                responseData.systemData.length > 0\r\n            ){\r\n                for (var j = 0; j < responseData.systemData.length; j++) {\r\n                    showNotify({title: this.description, text: 'System: ' + responseData.systemData[j].name, type: 'success'});\r\n                }\r\n            }\r\n\r\n            if(\r\n                responseData.error &&\r\n                responseData.error.length > 0\r\n            ){\r\n                for(var i = 0; i < responseData.error.length; i++){\r\n                    showNotify({title: this.description + ' error', text: 'System: ' + responseData.error[i].message, type: 'error'});\r\n                }\r\n            }\r\n\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            showNotify({title: jqXHR.status + ': ' + this.description, text: reason, type: 'warning'});\r\n        });\r\n    };\r\n\r\n    /**\r\n     * set currentSystemData as \"global\" variable\r\n     * @param systemData\r\n     */\r\n    var setCurrentSystemData = function(systemData){\r\n        Init.currentSystemData = systemData;\r\n    };\r\n\r\n    /**\r\n     * get currentSystemData from \"global\" variables\r\n     * @returns {*}\r\n     */\r\n    var getCurrentSystemData = function(){\r\n        return Init.currentSystemData;\r\n    };\r\n\r\n\r\n    /**\r\n     * get all \"open\" dialog elements\r\n     * @returns {*|jQuery}\r\n     */\r\n    var getOpenDialogs = function(){\r\n        return $('.' + config.dialogClass).filter(':visible');\r\n    };\r\n\r\n    /**\r\n     * formats a price string into an ISK Price\r\n     * @param price\r\n     * @returns {string}\r\n     */\r\n    var formatPrice = function(price){\r\n        price = Number( price ).toFixed(2);\r\n\r\n        var parts = price.toString().split('.');\r\n        price = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',') + (parts[1] ? '.' + parts[1] : '');\r\n\r\n        return price + ' ISK';\r\n    };\r\n\r\n    /**\r\n     * get localForage instance (singleton) for offline client site storage\r\n     * @returns {localforage}\r\n     */\r\n    var getLocalStorage = function(){\r\n        if(localStorage === undefined){\r\n            localStorage = localforage.createInstance({\r\n                driver: [localforage.INDEXEDDB, localforage.WEBSQL, localforage.LOCALSTORAGE],\r\n                name: 'Pathfinder local storage'\r\n            });\r\n        }\r\n        return localStorage;\r\n    };\r\n\r\n    /**\r\n     * Create Date as UTC\r\n     * @param date\r\n     * @returns {Date}\r\n     */\r\n    var createDateAsUTC = function(date) {\r\n        return new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds()));\r\n    };\r\n\r\n    /**\r\n     * Convert Date to UTC (!important function!)\r\n     * @param date\r\n     * @returns {Date}\r\n     */\r\n    var convertDateToUTC = function(date) {\r\n        return new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\r\n    };\r\n\r\n    /**\r\n     * Convert Date to Time String\r\n     * @param date\r\n     * @returns {string}\r\n     */\r\n    var convertDateToString = function(date){\r\n        var dateString = ('0'+ (date.getMonth() + 1 )).slice(-2) + '/' + ('0'+date.getDate()).slice(-2) + '/' + date.getFullYear();\r\n        var timeString = ('0' + date.getHours()).slice(-2) + ':' + ('0'+date.getMinutes()).slice(-2);\r\n        return   dateString + ' ' + timeString;\r\n    };\r\n\r\n    /**\r\n     * get document path\r\n     * -> www.pathfinder.com/pathfinder/ -> /pathfinder\r\n     * @returns {string|string}\r\n     */\r\n    var getDocumentPath = function(){\r\n        var pathname = window.location.pathname;\r\n        // replace file endings\r\n        var r = /[^\\/]*$/;\r\n        var path = pathname.replace(r, '');\r\n        return path || '/';\r\n    };\r\n\r\n    /**\r\n     * redirect\r\n     * @param url\r\n     * @param params\r\n     */\r\n    var redirect = function(url, params){\r\n        var currentUrl = document.URL;\r\n\r\n        if(url !== currentUrl){\r\n            if(\r\n                params &&\r\n                params.length > 0\r\n            ){\r\n                url += '?' + params.join('&');\r\n            }\r\n            window.location = url;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * send logout request\r\n     * @param  params\r\n     */\r\n    var logout = function(params){\r\n        var data = {};\r\n        if(\r\n            params &&\r\n            params.ajaxData\r\n        ){\r\n            data = params.ajaxData;\r\n        }\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.logout,\r\n            data: data,\r\n            dataType: 'json'\r\n        }).done(function(data){\r\n            if(data.reroute){\r\n                redirect(data.reroute, ['logout']);\r\n            }\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            showNotify({title: jqXHR.status + ': logout', text: reason, type: 'error'});\r\n        });\r\n    };\r\n\r\n    return {\r\n        config: config,\r\n        showVersionInfo: showVersionInfo,\r\n        initPrototypes: initPrototypes,\r\n        initDefaultBootboxConfig: initDefaultBootboxConfig,\r\n        getCurrentTriggerDelay: getCurrentTriggerDelay,\r\n        getServerTime: getServerTime,\r\n        convertTimestampToServerTime: convertTimestampToServerTime,\r\n        getTimeDiffParts: getTimeDiffParts,\r\n        timeStart: timeStart,\r\n        timeStop: timeStop,\r\n        log: log,\r\n        showNotify: showNotify,\r\n        stopTabBlink: stopTabBlink,\r\n        getLogInfo: getLogInfo,\r\n        ajaxSetup: ajaxSetup,\r\n        isXHRAborted: isXHRAborted,\r\n        getMapModule: getMapModule,\r\n        getSystemEffectData: getSystemEffectData,\r\n        getSystemEffectTable: getSystemEffectTable,\r\n        getSystemsInfoTable: getSystemsInfoTable,\r\n        getStatusInfoForCharacter: getStatusInfoForCharacter,\r\n        getSecurityClassForSystem: getSecurityClassForSystem,\r\n        getTrueSecClassForSystem: getTrueSecClassForSystem,\r\n        getStatusInfoForSystem: getStatusInfoForSystem,\r\n        getSignatureGroupInfo: getSignatureGroupInfo,\r\n        getAllSignatureNames: getAllSignatureNames,\r\n        getSignatureTypeIdByName: getSignatureTypeIdByName,\r\n        getAreaIdBySecurity: getAreaIdBySecurity,\r\n        setCurrentMapUserData: setCurrentMapUserData,\r\n        getCurrentMapUserData: getCurrentMapUserData,\r\n        setCurrentMapData: setCurrentMapData,\r\n        getCurrentMapData: getCurrentMapData,\r\n        getCurrentMapDataIndex: getCurrentMapDataIndex,\r\n        setCurrentUserData: setCurrentUserData,\r\n        getCurrentUserData: getCurrentUserData,\r\n        setCurrentSystemData: setCurrentSystemData,\r\n        getCurrentSystemData: getCurrentSystemData,\r\n        getCurrentUserInfo: getCurrentUserInfo,\r\n        getCurrentCharacterLog: getCurrentCharacterLog,\r\n        setDestination: setDestination,\r\n        convertDateToString: convertDateToString,\r\n        getOpenDialogs: getOpenDialogs,\r\n        formatPrice: formatPrice,\r\n        getLocalStorage: getLocalStorage,\r\n        getDocumentPath: getDocumentPath,\r\n        redirect: redirect,\r\n        logout: logout\r\n    };\r\n});\n",
    "(function(global,factory){if(typeof exports===\"object\"&&exports){factory(exports)}else if(typeof define===\"function\"&&define.amd){define('mustache',[\"exports\"],factory)}else{factory(global.Mustache={})}})(this,function(mustache){var Object_toString=Object.prototype.toString;var isArray=Array.isArray||function(object){return Object_toString.call(object)===\"[object Array]\"};function isFunction(object){return typeof object===\"function\"}function escapeRegExp(string){return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g,\"\\\\$&\")}var RegExp_test=RegExp.prototype.test;function testRegExp(re,string){return RegExp_test.call(re,string)}var nonSpaceRe=/\\S/;function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}var entityMap={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"/\":\"&#x2F;\"};function escapeHtml(string){return String(string).replace(/[&<>\"'\\/]/g,function(s){return entityMap[s]})}var whiteRe=/\\s*/;var spaceRe=/\\s+/;var equalsRe=/\\s*=/;var curlyRe=/\\s*\\}/;var tagRe=/#|\\^|\\/|>|\\{|&|=|!/;function parseTemplate(template,tags){if(!template)return[];var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length)delete tokens[spaces.pop()]}else{spaces=[]}hasTag=false;nonSpace=false}var openingTagRe,closingTagRe,closingCurlyRe;function compileTags(tags){if(typeof tags===\"string\")tags=tags.split(spaceRe,2);if(!isArray(tags)||tags.length!==2)throw new Error(\"Invalid tags: \"+tags);openingTagRe=new RegExp(escapeRegExp(tags[0])+\"\\\\s*\");closingTagRe=new RegExp(\"\\\\s*\"+escapeRegExp(tags[1]));closingCurlyRe=new RegExp(\"\\\\s*\"+escapeRegExp(\"}\"+tags[1]))}compileTags(tags||mustache.tags);var scanner=new Scanner(template);var start,type,value,chr,token,openSection;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(openingTagRe);if(value){for(var i=0,valueLength=value.length;i<valueLength;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push([\"text\",chr,start,start+1]);start+=1;if(chr===\"\\n\")stripSpace()}}if(!scanner.scan(openingTagRe))break;hasTag=true;type=scanner.scan(tagRe)||\"name\";scanner.scan(whiteRe);if(type===\"=\"){value=scanner.scanUntil(equalsRe);scanner.scan(equalsRe);scanner.scanUntil(closingTagRe)}else if(type===\"{\"){value=scanner.scanUntil(closingCurlyRe);scanner.scan(curlyRe);scanner.scanUntil(closingTagRe);type=\"&\"}else{value=scanner.scanUntil(closingTagRe)}if(!scanner.scan(closingTagRe))throw new Error(\"Unclosed tag at \"+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type===\"#\"||type===\"^\"){sections.push(token)}else if(type===\"/\"){openSection=sections.pop();if(!openSection)throw new Error('Unopened section \"'+value+'\" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section \"'+openSection[1]+'\" at '+start)}else if(type===\"name\"||type===\"{\"||type===\"&\"){nonSpace=true}else if(type===\"=\"){compileTags(value)}}openSection=sections.pop();if(openSection)throw new Error('Unclosed section \"'+openSection[1]+'\" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];if(token){if(token[0]===\"text\"&&lastToken&&lastToken[0]===\"text\"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{squashedTokens.push(token);lastToken=token}}}return squashedTokens}function nestTokens(tokens){var nestedTokens=[];var collector=nestedTokens;var sections=[];var token,section;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];switch(token[0]){case\"#\":case\"^\":collector.push(token);sections.push(token);collector=token[4]=[];break;case\"/\":section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}}return nestedTokens}function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function(){return this.tail===\"\"};Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(!match||match.index!==0)return\"\";var string=match[0];this.tail=this.tail.substring(string.length);this.pos+=string.length;return string};Scanner.prototype.scanUntil=function(re){var index=this.tail.search(re),match;switch(index){case-1:match=this.tail;this.tail=\"\";break;case 0:match=\"\";break;default:match=this.tail.substring(0,index);this.tail=this.tail.substring(index)}this.pos+=match.length;return match};function Context(view,parentContext){this.view=view==null?{}:view;this.cache={\".\":this.view};this.parent=parentContext}Context.prototype.push=function(view){return new Context(view,this)};Context.prototype.lookup=function(name){var cache=this.cache;var value;if(name in cache){value=cache[name]}else{var context=this,names,index;while(context){if(name.indexOf(\".\")>0){value=context.view;names=name.split(\".\");index=0;while(value!=null&&index<names.length)value=value[names[index++]]}else if(typeof context.view==\"object\"){value=context.view[name]}if(value!=null)break;context=context.parent}cache[name]=value}if(isFunction(value))value=value.call(this.view);return value};function Writer(){this.cache={}}Writer.prototype.clearCache=function(){this.cache={}};Writer.prototype.parse=function(template,tags){var cache=this.cache;var tokens=cache[template];if(tokens==null)tokens=cache[template]=parseTemplate(template,tags);return tokens};Writer.prototype.render=function(template,view,partials){var tokens=this.parse(template);var context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)};Writer.prototype.renderTokens=function(tokens,context,partials,originalTemplate){var buffer=\"\";var self=this;function subRender(template){return self.render(template,context,partials)}var token,value;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];switch(token[0]){case\"#\":value=context.lookup(token[1]);if(!value)continue;if(isArray(value)){for(var j=0,valueLength=value.length;j<valueLength;++j){buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate)}}else if(typeof value===\"object\"||typeof value===\"string\"){buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate)}else if(isFunction(value)){if(typeof originalTemplate!==\"string\")throw new Error(\"Cannot use higher-order sections without the original template\");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender);if(value!=null)buffer+=value}else{buffer+=this.renderTokens(token[4],context,partials,originalTemplate)}break;case\"^\":value=context.lookup(token[1]);if(!value||isArray(value)&&value.length===0)buffer+=this.renderTokens(token[4],context,partials,originalTemplate);break;case\">\":if(!partials)continue;value=isFunction(partials)?partials(token[1]):partials[token[1]];if(value!=null)buffer+=this.renderTokens(this.parse(value),context,partials,value);break;case\"&\":value=context.lookup(token[1]);if(value!=null)buffer+=value;break;case\"name\":value=context.lookup(token[1]);if(value!=null)buffer+=mustache.escape(value);break;case\"text\":buffer+=token[1];break}}return buffer};mustache.name=\"mustache.js\";mustache.version=\"1.0.0\";mustache.tags=[\"{{\",\"}}\"];var defaultWriter=new Writer;mustache.clearCache=function(){return defaultWriter.clearCache()};mustache.parse=function(template,tags){return defaultWriter.parse(template,tags)};mustache.render=function(template,view,partials){return defaultWriter.render(template,view,partials)};mustache.to_html=function(template,view,partials,send){var result=mustache.render(template,view,partials);if(isFunction(send)){send(result)}else{return result}};mustache.escape=escapeHtml;mustache.Scanner=Scanner;mustache.Context=Context;mustache.Writer=Writer});\n",
    "/**\r\n *  Render controller\r\n */\r\n\r\ndefine('app/render',['jquery', 'mustache'], function($, Mustache) {\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * init function will be called before and after a new module is loaded\r\n     * @param functionName\r\n     * @param config\r\n     */\r\n    var initModule = function(functionName, config){\r\n\r\n        if(\r\n            typeof config.functions === 'object' &&\r\n            typeof config.functions[functionName] === 'function'\r\n        ){\r\n            config.functions[functionName]();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * load a template and render is with Mustache\r\n     * @param config\r\n     * @param data\r\n     */\r\n    var showModule = function(config, data){\r\n\r\n        // require module template\r\n        requirejs(['text!templates/' + config.name + '.html'], function(template) {\r\n\r\n            // check for an id, if module already exists, do not insert again\r\n            if(\r\n                data.id === 'undefined' ||\r\n                 $('#' + data.id).length === 0\r\n            ){\r\n\r\n                var content = Mustache.render(template, data);\r\n\r\n                // display module\r\n                switch(config.link){\r\n                    case 'prepend':\r\n                        config.position.prepend(content);\r\n                        break;\r\n                    case 'before':\r\n                        config.position.before(content);\r\n                        break;\r\n                    case 'after':\r\n                        config.position.after(content);\r\n                        break;\r\n                    default:\r\n                        config.position.append(content);\r\n                }\r\n            }\r\n\r\n            // init module function after render\r\n            initModule('after', config);\r\n\r\n\r\n        });\r\n    };\r\n\r\n\r\n    return {\r\n        showModule: showModule\r\n    };\r\n});\n",
    "/**\r\n * logging\r\n */\r\n\r\ndefine('app/logging',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'bootbox'\r\n], function($, Init, Util, bootbox) {\r\n\r\n    'use strict';\r\n\r\n    var logData = [];                                               // cache object for all log entries\r\n    var logDataTable = null;                                        // \"Datatables\" Object\r\n\r\n    // Morris charts data\r\n    var maxGraphDataCount = 30;                                     // max date entries for a graph\r\n    var chartData = {};                                             // chart Data object for all Morris Log graphs\r\n\r\n    var config = {\r\n        dialogDynamicAreaClass: 'pf-dynamic-area',                  // class for dynamic areas\r\n        logGraphClass: 'pf-log-graph',                              // class for all log Morris graphs\r\n        tableToolsClass: 'pf-table-tools'                           // class for table tools\r\n    };\r\n\r\n    /**\r\n     * get log time string\r\n     * @returns {string}\r\n     */\r\n    var getLogTime = function(){\r\n\r\n        var serverTime = Util.getServerTime();\r\n\r\n        var logTime = serverTime.toLocaleTimeString('en-US', { hour12: false });\r\n\r\n        return logTime;\r\n    };\r\n\r\n    /**\r\n     * shows the logging dialog\r\n     */\r\n    var showDialog = function(){\r\n\r\n        // dialog content\r\n\r\n        var content = $('<div>');\r\n\r\n        // content row  for log graphs\r\n        var rowElementGraphs = $('<div>', {\r\n            class: 'row'\r\n        });\r\n\r\n        content.append(rowElementGraphs);\r\n\r\n\r\n\r\n        var tableHeadline = $('<h4>', {\r\n            text: ' Processes'\r\n        }).prepend( $('<i>', {\r\n            class: ['fa', 'fa-fw', 'fa-lg', 'fa-list-alt'].join(' ')\r\n        }));\r\n\r\n        // add content Structure to dome before table initialization\r\n        content.append(tableHeadline);\r\n\r\n        // log table area --------------------------------------------------\r\n        var logTableArea = $('<div>', {\r\n            class: config.dialogDynamicAreaClass\r\n        });\r\n\r\n        var logTableActionBar = $('<div>', {\r\n            class: config.tableToolsClass\r\n        });\r\n        logTableArea.append(logTableActionBar);\r\n\r\n        var logTable = $('<table>', {\r\n            class: ['compact', 'stripe', 'order-column', 'row-border'].join(' ')\r\n        });\r\n        logTableArea.append(logTable);\r\n\r\n        content.append(logTableArea);\r\n\r\n        // init log table\r\n        logDataTable = logTable.DataTable({\r\n            paging: true,\r\n            ordering: true,\r\n            order: [ 1, 'desc' ],\r\n            autoWidth: false,\r\n            hover: false,\r\n            pageLength: 15,\r\n            lengthMenu: [[10, 15, 25, 50, 50], [10, 15, 25, 50, 50]],\r\n            data: logData,                      // load cached logs (if available)\r\n            language: {\r\n                emptyTable:  'No entries',\r\n                zeroRecords: 'No entries found',\r\n                lengthMenu:  'Show _MENU_ entries',\r\n                info:        'Showing _START_ to _END_ of _TOTAL_ entries'\r\n            },\r\n            columnDefs: [\r\n                {\r\n                    targets: 0,\r\n                    title: '<i class=\"fa fa-lg fa-tag\"></i>',\r\n                    width: '18px',\r\n                    searchable: false,\r\n                    class: ['text-center'].join(' '),\r\n                    data: 'status'\r\n                },{\r\n                    targets: 1,\r\n                    title: '<i class=\"fa fa-lg fa-fw fa-clock-o\"></i>&nbsp;&nbsp;',\r\n                    width: '50px',\r\n                    searchable: true,\r\n                    class: 'text-right',\r\n                    data: 'time'\r\n                },{\r\n                    targets: 2,\r\n                    title: '<i class=\"fa fa-lg fa-fw fa-history\"></i>&nbsp;&nbsp;',\r\n                    width: '35px',\r\n                    searchable: false,\r\n                    class: 'text-right',\r\n                    sType: 'html',\r\n                    data: 'duration'\r\n                },{\r\n                    targets: 3,\r\n                    title: 'description',\r\n                    searchable: true,\r\n                    data: 'description'\r\n                },{\r\n                    targets: 4,\r\n                    title: 'type',\r\n                    width: '40px',\r\n                    searchable: true,\r\n                    class: ['text-center'].join(' '),\r\n                    data: 'type'\r\n                },{\r\n                    targets: 5,\r\n                    title: 'Prozess-ID&nbsp;&nbsp;&nbsp;',\r\n                    width: '80px',\r\n                    searchable: false,\r\n                    class: 'text-right',\r\n                    data: 'key'\r\n                }\r\n            ]\r\n\r\n        });\r\n\r\n        // open dialog\r\n        var logDialog = bootbox.dialog({\r\n            title: 'Task-Manager',\r\n            message: content,\r\n            size: 'large',\r\n            buttons: {\r\n                close: {\r\n                    label: 'close',\r\n                    className: 'btn-default'\r\n                }\r\n            }\r\n        });\r\n\r\n        // modal dialog is shown\r\n        logDialog.on('shown.bs.modal', function(e) {\r\n\r\n            // show Morris graphs ----------------------------------------------------------\r\n\r\n            // function for chart label formation\r\n            var labelYFormat = function(y){\r\n                return Math.round(y) + 'ms';\r\n            };\r\n\r\n            for(var key in chartData) {\r\n                if(chartData.hasOwnProperty(key)) {\r\n                    // create a chart for each key\r\n\r\n                    var colElementGraph = $('<div>', {\r\n                        class: ['col-md-6'].join(' ')\r\n                    });\r\n\r\n\r\n                    // graph element\r\n                    var graphElement = $('<div>', {\r\n                        class: config.logGraphClass\r\n                    });\r\n\r\n                    var graphArea = $('<div>', {\r\n                        class: config.dialogDynamicAreaClass\r\n                    }).append(  graphElement );\r\n\r\n                    // headline\r\n                    var headline = $('<h4>', {\r\n                        text: key\r\n                    }).prepend(\r\n                        $('<span>', {\r\n                            class: ['txt-color', 'txt-color-grayLight'].join(' '),\r\n                            text: 'Prozess-ID: '\r\n                        })\r\n                    );\r\n\r\n                    // show update ping between function calls\r\n                    var updateElement = $('<small>', {\r\n                        class: ['txt-color', 'txt-color-blue', 'pull-right'].join(' ')\r\n                    });\r\n                    headline.append(updateElement).append('<br>');\r\n\r\n                    // show average execution time\r\n                    var averageElement = $('<small>', {\r\n                        class: 'pull-right'\r\n                    });\r\n                    headline.append(averageElement);\r\n\r\n                    colElementGraph.append( headline );\r\n                    colElementGraph.append( graphArea );\r\n\r\n                    graphArea.showLoadingAnimation();\r\n\r\n                    rowElementGraphs.append( colElementGraph );\r\n\r\n                    // cache DOM Elements that will be updated frequently\r\n                    chartData[key].averageElement = averageElement;\r\n                    chartData[key].updateElement = updateElement;\r\n\r\n                    chartData[key].graph = Morris.Area({\r\n                        element: graphElement,\r\n                        data: [],\r\n                        xkey: 'x',\r\n                        ykeys: ['y'],\r\n                        labels: [key],\r\n                        units: 'ms',\r\n                        parseTime: false,\r\n                        ymin: 0,\r\n                        yLabelFormat: labelYFormat,\r\n                        padding: 10,\r\n                        hideHover: true,\r\n                        pointSize: 3,\r\n                        lineColors: ['#375959'],\r\n                        pointFillColors: ['#477372'],\r\n                        pointStrokeColors: ['#313335'],\r\n                        lineWidth: 2,\r\n                        grid: false,\r\n                        gridStrokeWidth: 0.3,\r\n                        gridTextSize: 9,\r\n                        gridTextFamily: 'Oxygen Bold',\r\n                        gridTextColor: '#63676a',\r\n                        behaveLikeLine: true,\r\n                        goals: [],\r\n                        goalLineColors: ['#66c84f'],\r\n                        smooth: false,\r\n                        fillOpacity: 0.3,\r\n                        resize: true\r\n                    });\r\n\r\n                    graphArea.hideLoadingAnimation();\r\n\r\n                }\r\n            }\r\n\r\n            // ------------------------------------------------------------------------------\r\n            // add dataTable buttons (extension)\r\n\r\n            var buttons = new $.fn.dataTable.Buttons( logDataTable, {\r\n                buttons: [\r\n                    {\r\n                        extend: 'copy',\r\n                        className: 'btn btn-sm btn-default',\r\n                        text: '<i class=\"fa fa-fw fa-clipboard\"></i> copy'\r\n                    },{\r\n                        extend: 'csv',\r\n                        className: 'btn btn-sm btn-default',\r\n                        text: '<i class=\"fa fa-fw fa-download\"></i> csv'\r\n                    }\r\n                ]\r\n            } );\r\n\r\n            logDataTable.buttons().container().appendTo( $(this).find('.' + config.tableToolsClass));\r\n        });\r\n\r\n\r\n        // modal dialog is closed\r\n        logDialog.on('hidden.bs.modal', function(e) {\r\n            // clear memory -> destroy all charts\r\n            for (var key in chartData) {\r\n                if (chartData.hasOwnProperty(key)) {\r\n                    chartData[key].graph = null;\r\n                }\r\n            }\r\n        });\r\n\r\n        // modal dialog before hide\r\n        logDialog.on('hide.bs.modal', function(e) {\r\n\r\n            // destroy logTable\r\n            logDataTable.destroy(true);\r\n            logDataTable= null;\r\n\r\n            // remove event -> prevent calling this multiple times\r\n            $(this).off('hide.bs.modal');\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * updates the log graph for a log key\r\n     * @param key\r\n     * @param duration\r\n     */\r\n    var updateLogGraph = function(key, duration){\r\n\r\n        // check if graph data already exist\r\n        if( !(chartData.hasOwnProperty(key))){\r\n            chartData[key] = {};\r\n            chartData[key].data = [];\r\n            chartData[key].graph = null;\r\n            chartData[key].averageElement = null;\r\n            chartData[key].updateElement = null;\r\n        }\r\n\r\n        // add new value\r\n        chartData[key].data.unshift(duration);\r\n\r\n        if(chartData[key].data.length > maxGraphDataCount){\r\n            chartData[key].data = chartData[key].data.slice(0, maxGraphDataCount);\r\n        }\r\n\r\n        function getGraphData(data) {\r\n            var tempChartData = {\r\n                data: [],\r\n                dataSum: 0,\r\n                average: 0\r\n            };\r\n\r\n            for(var x = 0; x < maxGraphDataCount; x++){\r\n                var value = 0;\r\n                if(data[x]){\r\n                    value = data[x];\r\n                    tempChartData.dataSum = Number( (tempChartData.dataSum + value).toFixed(2) );\r\n                }\r\n\r\n                tempChartData.data.push({\r\n                    x: x,\r\n                    y: value\r\n                });\r\n            }\r\n\r\n            // calculate average\r\n            tempChartData.average = Number( ( tempChartData.dataSum / data.length ).toFixed(2) );\r\n\r\n            return tempChartData;\r\n        }\r\n\r\n        var tempChartData = getGraphData(chartData[key].data);\r\n\r\n        // add new data to graph (Morris chart) - if is already initialized\r\n        if(chartData[key].graph !== null){\r\n            var avgElement = chartData[key].averageElement;\r\n            var updateElement = chartData[key].updateElement;\r\n\r\n            var delay = Util.getCurrentTriggerDelay( key, 0 );\r\n\r\n            if(delay){\r\n                updateElement[0].textContent = ' delay: ' + delay + 'ms ';\r\n            }\r\n\r\n            // set/change average line\r\n            chartData[key].graph.options.goals = [tempChartData.average];\r\n\r\n            // change avg. display\r\n            avgElement[0].textContent = 'Avg. ' + tempChartData.average + 'ms';\r\n\r\n            var avgStatus = getLogStatusByDuration(key, tempChartData.average);\r\n            var avgStatusClass = Util.getLogInfo( avgStatus, 'class' );\r\n\r\n            //change avg. display class\r\n            if( !avgElement.hasClass(avgStatusClass) ){\r\n                // avg status changed!\r\n                avgElement.removeClass().addClass('pull-right txt-color ' + avgStatusClass);\r\n\r\n                // change goals line color\r\n                if(avgStatus === 'warning'){\r\n                    chartData[key].graph.options.goalLineColors = ['#e28a0d'];\r\n                    $(document).setProgramStatus('problem');\r\n                }else{\r\n                    chartData[key].graph.options.goalLineColors = ['#5cb85c'];\r\n                }\r\n            }\r\n\r\n            // set new data and redraw\r\n            chartData[key].graph.setData( tempChartData.data );\r\n        }\r\n\r\n        return tempChartData.data;\r\n    };\r\n\r\n    /**\r\n     * get the log \"status\" by log duration (ms).\r\n     * If duration > warning limit -> show as warning\r\n     * @param logKey\r\n     * @param logDuration\r\n     * @returns {string}\r\n     */\r\n    var getLogStatusByDuration = function(logKey, logDuration){\r\n\r\n        var logStatus = 'info';\r\n        if( logDuration > Init.timer[logKey].EXECUTION_LIMIT ){\r\n            logStatus = 'warning';\r\n        }\r\n        return logStatus;\r\n    };\r\n\r\n    /**\r\n     * get the css class for a specific log type\r\n     * @param logType\r\n     * @returns {string}\r\n     */\r\n    var getLogTypeIconClass = function(logType){\r\n\r\n        var logIconClass = '';\r\n\r\n        switch(logType){\r\n            case 'client':\r\n                logIconClass = 'fa-user';\r\n                break;\r\n            case 'server':\r\n                logIconClass = 'fa-download';\r\n                break;\r\n        }\r\n\r\n        return logIconClass;\r\n    };\r\n\r\n    /**\r\n     * init logging -> set global log event\r\n     */\r\n    var init = function(){\r\n\r\n        var maxEntries = 150;\r\n\r\n        // set global logging listener\r\n        $(window).on('pf:log', function(e, logKey, options){\r\n\r\n            // check required logging information\r\n            if(\r\n                options &&\r\n                options.duration &&\r\n                options.description\r\n            ){\r\n                var logDescription = options.description;\r\n                var logDuration = options.duration;\r\n                var logType = options.type;\r\n\r\n                // check log status by duration\r\n                var logStatus = getLogStatusByDuration(logKey, logDuration);\r\n\r\n                var statusClass = Util.getLogInfo( logStatus, 'class' );\r\n\r\n                var typeIconClass = getLogTypeIconClass(logType);\r\n\r\n                // update graph data\r\n                updateLogGraph(logKey, logDuration);\r\n\r\n                var logRowData = {\r\n                    status:  '<i class=\"fa fa-fw fa-circle txt-color ' + statusClass + '\"></i>',\r\n                    time: getLogTime(),\r\n                    duration: '<span class=\"txt-color ' + statusClass + '\">' + logDuration + '<small>ms</small></span>',\r\n                    description: logDescription,\r\n                    type: '<i class=\"fa ' + typeIconClass + '\"></i>',\r\n                    key: logKey\r\n                };\r\n\r\n\r\n                if(logDataTable){\r\n                    // add row if dataTable is initialized before new log\r\n                    logDataTable.row.add( logRowData ).draw(false);\r\n                }else{\r\n                    // add row data to cache\r\n                    logData.push(logRowData);\r\n                }\r\n            }\r\n\r\n            // delete old log entries from table ---------------------------------\r\n            var rowCount = logData.length;\r\n\r\n            if( rowCount >= maxEntries ){\r\n\r\n                if(logDataTable){\r\n                    logDataTable.rows(0, {order:'index'}).remove().draw(false);\r\n                }else{\r\n                    logData.shift();\r\n                }\r\n            }\r\n\r\n            // cache logs in order to keep previous logs in table after reopening the dialog\r\n            if(logDataTable){\r\n                logData = logDataTable.rows({order:'index'}).data();\r\n            }\r\n\r\n        });\r\n    };\r\n\r\n\r\n    return {\r\n        init: init,\r\n        getLogTime: getLogTime,\r\n        showDialog: showDialog\r\n    };\r\n});\n",
    "/**\r\n * @license RequireJS text 2.0.12 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.\r\n * Available via the MIT or new BSD license.\r\n * see: http://github.com/requirejs/text for details\r\n */\r\n/*jslint regexp: true */\r\n/*global require, XMLHttpRequest, ActiveXObject,\r\n  define, window, process, Packages,\r\n  java, location, Components, FileUtils */\r\n\r\ndefine('text',['module'], function (module) {\r\n    'use strict';\r\n\r\n    var text, fs, Cc, Ci, xpcIsWindows,\r\n        progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'],\r\n        xmlRegExp = /^\\s*<\\?xml(\\s)+version=[\\'\\\"](\\d)*.(\\d)*[\\'\\\"](\\s)*\\?>/im,\r\n        bodyRegExp = /<body[^>]*>\\s*([\\s\\S]+)\\s*<\\/body>/im,\r\n        hasLocation = typeof location !== 'undefined' && location.href,\r\n        defaultProtocol = hasLocation && location.protocol && location.protocol.replace(/\\:/, ''),\r\n        defaultHostName = hasLocation && location.hostname,\r\n        defaultPort = hasLocation && (location.port || undefined),\r\n        buildMap = {},\r\n        masterConfig = (module.config && module.config()) || {};\r\n\r\n    text = {\r\n        version: '2.0.12',\r\n\r\n        strip: function (content) {\r\n            //Strips <?xml ...?> declarations so that external SVG and XML\r\n            //documents can be added to a document without worry. Also, if the string\r\n            //is an HTML document, only the part inside the body tag is returned.\r\n            if (content) {\r\n                content = content.replace(xmlRegExp, \"\");\r\n                var matches = content.match(bodyRegExp);\r\n                if (matches) {\r\n                    content = matches[1];\r\n                }\r\n            } else {\r\n                content = \"\";\r\n            }\r\n            return content;\r\n        },\r\n\r\n        jsEscape: function (content) {\r\n            return content.replace(/(['\\\\])/g, '\\\\$1')\r\n                .replace(/[\\f]/g, \"\\\\f\")\r\n                .replace(/[\\b]/g, \"\\\\b\")\r\n                .replace(/[\\n]/g, \"\\\\n\")\r\n                .replace(/[\\t]/g, \"\\\\t\")\r\n                .replace(/[\\r]/g, \"\\\\r\")\r\n                .replace(/[\\u2028]/g, \"\\\\u2028\")\r\n                .replace(/[\\u2029]/g, \"\\\\u2029\");\r\n        },\r\n\r\n        createXhr: masterConfig.createXhr || function () {\r\n            //Would love to dump the ActiveX crap in here. Need IE 6 to die first.\r\n            var xhr, i, progId;\r\n            if (typeof XMLHttpRequest !== \"undefined\") {\r\n                return new XMLHttpRequest();\r\n            } else if (typeof ActiveXObject !== \"undefined\") {\r\n                for (i = 0; i < 3; i += 1) {\r\n                    progId = progIds[i];\r\n                    try {\r\n                        xhr = new ActiveXObject(progId);\r\n                    } catch (e) {}\r\n\r\n                    if (xhr) {\r\n                        progIds = [progId];  // so faster next time\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return xhr;\r\n        },\r\n\r\n        /**\r\n         * Parses a resource name into its component parts. Resource names\r\n         * look like: module/name.ext!strip, where the !strip part is\r\n         * optional.\r\n         * @param {String} name the resource name\r\n         * @returns {Object} with properties \"moduleName\", \"ext\" and \"strip\"\r\n         * where strip is a boolean.\r\n         */\r\n        parseName: function (name) {\r\n            var modName, ext, temp,\r\n                strip = false,\r\n                index = name.indexOf(\".\"),\r\n                isRelative = name.indexOf('./') === 0 ||\r\n                             name.indexOf('../') === 0;\r\n\r\n            if (index !== -1 && (!isRelative || index > 1)) {\r\n                modName = name.substring(0, index);\r\n                ext = name.substring(index + 1, name.length);\r\n            } else {\r\n                modName = name;\r\n            }\r\n\r\n            temp = ext || modName;\r\n            index = temp.indexOf(\"!\");\r\n            if (index !== -1) {\r\n                //Pull off the strip arg.\r\n                strip = temp.substring(index + 1) === \"strip\";\r\n                temp = temp.substring(0, index);\r\n                if (ext) {\r\n                    ext = temp;\r\n                } else {\r\n                    modName = temp;\r\n                }\r\n            }\r\n\r\n            return {\r\n                moduleName: modName,\r\n                ext: ext,\r\n                strip: strip\r\n            };\r\n        },\r\n\r\n        xdRegExp: /^((\\w+)\\:)?\\/\\/([^\\/\\\\]+)/,\r\n\r\n        /**\r\n         * Is an URL on another domain. Only works for browser use, returns\r\n         * false in non-browser environments. Only used to know if an\r\n         * optimized .js version of a text resource should be loaded\r\n         * instead.\r\n         * @param {String} url\r\n         * @returns Boolean\r\n         */\r\n        useXhr: function (url, protocol, hostname, port) {\r\n            var uProtocol, uHostName, uPort,\r\n                match = text.xdRegExp.exec(url);\r\n            if (!match) {\r\n                return true;\r\n            }\r\n            uProtocol = match[2];\r\n            uHostName = match[3];\r\n\r\n            uHostName = uHostName.split(':');\r\n            uPort = uHostName[1];\r\n            uHostName = uHostName[0];\r\n\r\n            return (!uProtocol || uProtocol === protocol) &&\r\n                   (!uHostName || uHostName.toLowerCase() === hostname.toLowerCase()) &&\r\n                   ((!uPort && !uHostName) || uPort === port);\r\n        },\r\n\r\n        finishLoad: function (name, strip, content, onLoad) {\r\n            content = strip ? text.strip(content) : content;\r\n            if (masterConfig.isBuild) {\r\n                buildMap[name] = content;\r\n            }\r\n            onLoad(content);\r\n        },\r\n\r\n        load: function (name, req, onLoad, config) {\r\n            //Name has format: some.module.filext!strip\r\n            //The strip part is optional.\r\n            //if strip is present, then that means only get the string contents\r\n            //inside a body tag in an HTML string. For XML/SVG content it means\r\n            //removing the <?xml ...?> declarations so the content can be inserted\r\n            //into the current doc without problems.\r\n\r\n            // Do not bother with the work if a build and text will\r\n            // not be inlined.\r\n            if (config && config.isBuild && !config.inlineText) {\r\n                onLoad();\r\n                return;\r\n            }\r\n\r\n            masterConfig.isBuild = config && config.isBuild;\r\n\r\n            var parsed = text.parseName(name),\r\n                nonStripName = parsed.moduleName +\r\n                    (parsed.ext ? '.' + parsed.ext : ''),\r\n                url = req.toUrl(nonStripName),\r\n                useXhr = (masterConfig.useXhr) ||\r\n                         text.useXhr;\r\n\r\n            // Do not load if it is an empty: url\r\n            if (url.indexOf('empty:') === 0) {\r\n                onLoad();\r\n                return;\r\n            }\r\n\r\n            //Load the text. Use XHR if possible and in a browser.\r\n            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {\r\n                text.get(url, function (content) {\r\n                    text.finishLoad(name, parsed.strip, content, onLoad);\r\n                }, function (err) {\r\n                    if (onLoad.error) {\r\n                        onLoad.error(err);\r\n                    }\r\n                });\r\n            } else {\r\n                //Need to fetch the resource across domains. Assume\r\n                //the resource has been optimized into a JS module. Fetch\r\n                //by the module name + extension, but do not include the\r\n                //!strip part to avoid file system issues.\r\n                req([nonStripName], function (content) {\r\n                    text.finishLoad(parsed.moduleName + '.' + parsed.ext,\r\n                                    parsed.strip, content, onLoad);\r\n                });\r\n            }\r\n        },\r\n\r\n        write: function (pluginName, moduleName, write, config) {\r\n            if (buildMap.hasOwnProperty(moduleName)) {\r\n                var content = text.jsEscape(buildMap[moduleName]);\r\n                write.asModule(pluginName + \"!\" + moduleName,\r\n                               \"define(function () { return '\" +\r\n                                   content +\r\n                               \"';});\\n\");\r\n            }\r\n        },\r\n\r\n        writeFile: function (pluginName, moduleName, req, write, config) {\r\n            var parsed = text.parseName(moduleName),\r\n                extPart = parsed.ext ? '.' + parsed.ext : '',\r\n                nonStripName = parsed.moduleName + extPart,\r\n                //Use a '.js' file name so that it indicates it is a\r\n                //script that can be loaded across domains.\r\n                fileName = req.toUrl(parsed.moduleName + extPart) + '.js';\r\n\r\n            //Leverage own load() method to load plugin value, but only\r\n            //write out values that do not have the strip argument,\r\n            //to avoid any potential issues with ! in file names.\r\n            text.load(nonStripName, req, function (value) {\r\n                //Use own write() method to construct full module value.\r\n                //But need to create shell that translates writeFile's\r\n                //write() to the right interface.\r\n                var textWrite = function (contents) {\r\n                    return write(fileName, contents);\r\n                };\r\n                textWrite.asModule = function (moduleName, contents) {\r\n                    return write.asModule(moduleName, fileName, contents);\r\n                };\r\n\r\n                text.write(pluginName, nonStripName, textWrite, config);\r\n            }, config);\r\n        }\r\n    };\r\n\r\n    if (masterConfig.env === 'node' || (!masterConfig.env &&\r\n            typeof process !== \"undefined\" &&\r\n            process.versions &&\r\n            !!process.versions.node &&\r\n            !process.versions['node-webkit'])) {\r\n        //Using special require.nodeRequire, something added by r.js.\r\n        fs = require.nodeRequire('fs');\r\n\r\n        text.get = function (url, callback, errback) {\r\n            try {\r\n                var file = fs.readFileSync(url, 'utf8');\r\n                //Remove BOM (Byte Mark Order) from utf8 files if it is there.\r\n                if (file.indexOf('\\uFEFF') === 0) {\r\n                    file = file.substring(1);\r\n                }\r\n                callback(file);\r\n            } catch (e) {\r\n                if (errback) {\r\n                    errback(e);\r\n                }\r\n            }\r\n        };\r\n    } else if (masterConfig.env === 'xhr' || (!masterConfig.env &&\r\n            text.createXhr())) {\r\n        text.get = function (url, callback, errback, headers) {\r\n            var xhr = text.createXhr(), header;\r\n            xhr.open('GET', url, true);\r\n\r\n            //Allow plugins direct access to xhr headers\r\n            if (headers) {\r\n                for (header in headers) {\r\n                    if (headers.hasOwnProperty(header)) {\r\n                        xhr.setRequestHeader(header.toLowerCase(), headers[header]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            //Allow overrides specified in config\r\n            if (masterConfig.onXhr) {\r\n                masterConfig.onXhr(xhr, url);\r\n            }\r\n\r\n            xhr.onreadystatechange = function (evt) {\r\n                var status, err;\r\n                //Do not explicitly handle errors, those should be\r\n                //visible via console output in the browser.\r\n                if (xhr.readyState === 4) {\r\n                    status = xhr.status || 0;\r\n                    if (status > 399 && status < 600) {\r\n                        //An http 4xx or 5xx error. Signal an error.\r\n                        err = new Error(url + ' HTTP status: ' + status);\r\n                        err.xhr = xhr;\r\n                        if (errback) {\r\n                            errback(err);\r\n                        }\r\n                    } else {\r\n                        callback(xhr.responseText);\r\n                    }\r\n\r\n                    if (masterConfig.onXhrComplete) {\r\n                        masterConfig.onXhrComplete(xhr, url);\r\n                    }\r\n                }\r\n            };\r\n            xhr.send(null);\r\n        };\r\n    } else if (masterConfig.env === 'rhino' || (!masterConfig.env &&\r\n            typeof Packages !== 'undefined' && typeof java !== 'undefined')) {\r\n        //Why Java, why is this so awkward?\r\n        text.get = function (url, callback) {\r\n            var stringBuffer, line,\r\n                encoding = \"utf-8\",\r\n                file = new java.io.File(url),\r\n                lineSeparator = java.lang.System.getProperty(\"line.separator\"),\r\n                input = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file), encoding)),\r\n                content = '';\r\n            try {\r\n                stringBuffer = new java.lang.StringBuffer();\r\n                line = input.readLine();\r\n\r\n                // Byte Order Mark (BOM) - The Unicode Standard, version 3.0, page 324\r\n                // http://www.unicode.org/faq/utf_bom.html\r\n\r\n                // Note that when we use utf-8, the BOM should appear as \"EF BB BF\", but it doesn't due to this bug in the JDK:\r\n                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058\r\n                if (line && line.length() && line.charAt(0) === 0xfeff) {\r\n                    // Eat the BOM, since we've already found the encoding on this file,\r\n                    // and we plan to concatenating this buffer with others; the BOM should\r\n                    // only appear at the top of a file.\r\n                    line = line.substring(1);\r\n                }\r\n\r\n                if (line !== null) {\r\n                    stringBuffer.append(line);\r\n                }\r\n\r\n                while ((line = input.readLine()) !== null) {\r\n                    stringBuffer.append(lineSeparator);\r\n                    stringBuffer.append(line);\r\n                }\r\n                //Make sure we return a JavaScript string and not a Java string.\r\n                content = String(stringBuffer.toString()); //String\r\n            } finally {\r\n                input.close();\r\n            }\r\n            callback(content);\r\n        };\r\n    } else if (masterConfig.env === 'xpconnect' || (!masterConfig.env &&\r\n            typeof Components !== 'undefined' && Components.classes &&\r\n            Components.interfaces)) {\r\n        //Avert your gaze!\r\n        Cc = Components.classes;\r\n        Ci = Components.interfaces;\r\n        Components.utils['import']('resource://gre/modules/FileUtils.jsm');\r\n        xpcIsWindows = ('@mozilla.org/windows-registry-key;1' in Cc);\r\n\r\n        text.get = function (url, callback) {\r\n            var inStream, convertStream, fileObj,\r\n                readData = {};\r\n\r\n            if (xpcIsWindows) {\r\n                url = url.replace(/\\//g, '\\\\');\r\n            }\r\n\r\n            fileObj = new FileUtils.File(url);\r\n\r\n            //XPCOM, you so crazy\r\n            try {\r\n                inStream = Cc['@mozilla.org/network/file-input-stream;1']\r\n                           .createInstance(Ci.nsIFileInputStream);\r\n                inStream.init(fileObj, 1, 0, false);\r\n\r\n                convertStream = Cc['@mozilla.org/intl/converter-input-stream;1']\r\n                                .createInstance(Ci.nsIConverterInputStream);\r\n                convertStream.init(inStream, \"utf-8\", inStream.available(),\r\n                Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);\r\n\r\n                convertStream.readString(inStream.available(), readData);\r\n                convertStream.close();\r\n                inStream.close();\r\n                callback(readData.value);\r\n            } catch (e) {\r\n                throw new Error((fileObj && fileObj.path || '') + ': ' + e);\r\n            }\r\n        };\r\n    }\r\n    return text;\r\n});\r\n\n",
    "\n",
    "\n",
    "\n",
    "/**\r\n *  notification dialog\r\n */\r\n\r\ndefine('dialog/notification',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox'\r\n], function($, Init, Util, Render, bootbox) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n\r\n        // shutdown dialog\r\n        notificationDialogId: 'pf-notification-dialog',                                 // id for \"notification\" dialog\r\n        notificationDialogClass: 'pf-notification-dialog'                               // class for \"notification\" dialog\r\n    };\r\n\r\n    /**\r\n     * show/animate dialog page content\r\n     * @param dialog\r\n     */\r\n    var showPageContent = function(dialog){\r\n        var headlineElement = dialog.find('h1');\r\n\r\n        headlineElement.delay(300).velocity('transition.shrinkIn', {\r\n            duration: 500\r\n        }).delay(800);\r\n\r\n        headlineElement.velocity({\r\n            scale: 1.05\r\n        }, {\r\n            duration: 600,\r\n            loop: 5\r\n        });\r\n    };\r\n\r\n    /**\r\n     * show \"notification\" dialog\r\n     * @param dialogData\r\n     */\r\n    $.fn.showNotificationDialog = function(dialogData){\r\n\r\n        // check if there is already a notification dialog open\r\n        var notificationDialogClassDialoges = $('.' + config.notificationDialogClass);\r\n\r\n        if(notificationDialogClassDialoges.length === 0){\r\n\r\n            // close all modals\r\n            $('.modal').modal('hide');\r\n\r\n            requirejs(['text!templates/dialog/notification.html', 'mustache'], function(template, Mustache) {\r\n\r\n                var data = {\r\n                    id: config.notificationDialogId,\r\n                    content: dialogData.content\r\n                };\r\n\r\n                var content = Mustache.render(template, data);\r\n\r\n                // show dialog\r\n                var shutdownDialog = bootbox.dialog({\r\n                    title: dialogData.content.title,\r\n                    message: content,\r\n                    className: config.notificationDialogClass,\r\n                    buttons: dialogData.buttons\r\n                });\r\n\r\n\r\n                shutdownDialog.on('shown.bs.modal', function(e) {\r\n                    // remove close button\r\n                    var dialog = $(this);\r\n\r\n                    dialog.find('.bootbox-close-button').remove();\r\n                    dialog.find('button').blur();\r\n\r\n                    // show error message\r\n                    showPageContent(dialog);\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n\r\n});\n",
    "/**\r\n *  activity stats dialog\r\n */\r\n\r\n\r\ndefine('dialog/stats',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox'\r\n], function($, Init, Util, Render, bootbox, MapUtil) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // dialog\r\n        statsDialogId: 'pf-stats-dialog',                                       // id for \"stats\" dialog\r\n        dialogNavigationClass: 'pf-dialog-navigation-list',                     // class for dialog navigation bar\r\n        dialogNavigationListItemClass: 'pf-dialog-navigation-list-item',        // class for map manual li main navigation elements\r\n\r\n        dialogNavigationOffsetClass : 'pf-dialog-navigation-offset',            // class for \"current\" offset filter\r\n        dialogNavigationPrevClass : 'pf-dialog-navigation-prev',                // class for \"prev\" period load\r\n        dialogNavigationNextClass : 'pf-dialog-navigation-next',                // class for \"next\" period load\r\n\r\n        // stats/dataTable\r\n        statsContainerId: 'pf-stats-dialog-container',                          // class for statistics container (dynamic ajax content)\r\n        statsTableId: 'pf-stats-table',                                         // id for statistics table element\r\n        tableImageCellClass: 'pf-table-image-cell',                             // class for table \"image\" cells\r\n\r\n        // charts\r\n        statsLineChartClass: 'pf-line-chart'                                    // class for inline chart elements\r\n    };\r\n\r\n    /**\r\n     * init blank statistics dataTable\r\n     * @param dialogElement\r\n     */\r\n    var initStatsTable = function(dialogElement){\r\n        var columnNumberWidth = 35;\r\n        var lineColor = '#477372';\r\n\r\n        // render function for inline-chart columns\r\n        var renderInlineChartColumn = function(data, type, row, meta){\r\n            /*\r\n             switch(data.type){\r\n             case 'C': lineColor = '#5cb85c'; break;\r\n             case 'U': lineColor = '#e28a0d'; break;\r\n             case 'D': lineColor = '#a52521'; break;\r\n             }*/\r\n\r\n            if( /^\\d+$/.test(data.data) ){\r\n                // single digit (e.g. single week filter)\r\n                return data.data;\r\n            }else{\r\n                // period -> prepare line chart\r\n                return '<span class=\"' + config.statsLineChartClass + '\" data-peity=\\'{ \"stroke\": \"' + lineColor + '\" }\\'>' + data.data + '</span>';\r\n            }\r\n        };\r\n\r\n        // render function for numeric columns\r\n        var renderNumericColumn = function(data, type, row, meta){\r\n            return data.toLocaleString();\r\n        };\r\n\r\n        // get table element\r\n        // Due to \"complex\" table headers, they are already rendered and part of the stats.html file\r\n        var table = dialogElement.find('#' + config.statsTableId);\r\n\r\n        var  statsTable = table.DataTable({\r\n            pageLength: 30,\r\n            lengthMenu: [[10, 20, 30, 50], [10, 20, 30, 50]],\r\n            paging: true,\r\n            ordering: true,\r\n            order: [ 16, 'desc' ],\r\n            info: true,\r\n            searching: true,\r\n            hover: false,\r\n            autoWidth: false,\r\n            language: {\r\n                emptyTable:  'No statistics found',\r\n                zeroRecords: 'No characters found',\r\n                lengthMenu:  'Show _MENU_ characters',\r\n                info:        'Showing _START_ to _END_ of _TOTAL_ characters'\r\n            },\r\n            columnDefs: [\r\n                {\r\n                    targets: 0,\r\n                    title: '<i class=\"fa fa-hashtag\"></i>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: 10,\r\n                    class: 'text-right',\r\n                    data: 'character.id'\r\n                },{\r\n                    targets: 1,\r\n                    title: '',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: 26,\r\n                    className: ['text-center', config.tableImageCellClass].join(' '),\r\n                    data: 'character',\r\n                    render: {\r\n                        _: function(data, type, row, meta){\r\n                            return '<img src=\"' + Init.url.ccpImageServer + 'Character/' + data.id + '_32.jpg\" />';\r\n                        }\r\n                    }\r\n                },{\r\n                    targets: 2,\r\n                    title: 'name',\r\n                    width: 200,\r\n                    data: 'character',\r\n                    render: {\r\n                        _: 'name',\r\n                        sort: 'name'\r\n                    }\r\n                },{\r\n                    targets: 3,\r\n                    title: 'last login',\r\n                    searchable: false,\r\n                    width: 70,\r\n                    className: ['text-right', 'separator-right'].join(' '),\r\n                    data: 'character',\r\n                    render: {\r\n                        _: 'lastLogin',\r\n                        sort: 'lastLogin'\r\n                    },\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n                        $(cell).initTimestampCounter();\r\n                    }\r\n                },{\r\n                    targets: 4,\r\n                    title: '<span title=\"created\" data-toggle=\"tooltip\">C&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'systemCreate',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 5,\r\n                    title: '<span title=\"updated\" data-toggle=\"tooltip\">U&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'systemUpdate',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 6,\r\n                    title: '<span title=\"deleted\" data-toggle=\"tooltip\">D&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'systemDelete',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 7,\r\n                    title: 'Σ&nbsp;&nbsp;',\r\n                    searchable: false,\r\n                    width: 20,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm', 'separator-right'].join(' '),\r\n                    data: 'systemSum',\r\n                    render: {\r\n                        _: renderNumericColumn\r\n                    }\r\n                },{\r\n                    targets: 8,\r\n                    title: '<span title=\"created\" data-toggle=\"tooltip\">C&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'connectionCreate',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 9,\r\n                    title: '<span title=\"updated\" data-toggle=\"tooltip\">U&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'connectionUpdate',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 10,\r\n                    title: '<span title=\"deleted\" data-toggle=\"tooltip\">D&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'connectionDelete',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 11,\r\n                    title: 'Σ&nbsp;&nbsp;',\r\n                    searchable: false,\r\n                    width: 20,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm', 'separator-right'].join(' '),\r\n                    data: 'connectionSum',\r\n                    render: {\r\n                        _: renderNumericColumn\r\n                    }\r\n                },{\r\n                    targets: 12,\r\n                    title: '<span title=\"created\" data-toggle=\"tooltip\">C&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'signatureCreate',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 13,\r\n                    title: '<span title=\"updated\" data-toggle=\"tooltip\">U&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'signatureUpdate',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 14,\r\n                    title: '<span title=\"deleted\" data-toggle=\"tooltip\">D&nbsp;&nbsp;</span>',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: columnNumberWidth,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm'].join(' '),\r\n                    data: 'signatureDelete',\r\n                    render: {\r\n                        _: renderInlineChartColumn\r\n                    }\r\n                },{\r\n                    targets: 15,\r\n                    title: 'Σ&nbsp;&nbsp;',\r\n                    searchable: false,\r\n                    width: 20,\r\n                    className: ['text-right', 'hidden-xs', 'hidden-sm', 'separator-right'].join(' '),\r\n                    data: 'signatureSum',\r\n                    render: {\r\n                        _: renderNumericColumn\r\n                    }\r\n                },{\r\n                    targets: 16,\r\n                    title: 'Σ&nbsp;&nbsp;',\r\n                    searchable: false,\r\n                    width: 20,\r\n                    className: 'text-right',\r\n                    data: 'totalSum',\r\n                    render: {\r\n                        _: renderNumericColumn\r\n                    }\r\n                }\r\n            ],\r\n            initComplete: function(settings){\r\n                var tableApi = this.api();\r\n\r\n                // initial statistics data request\r\n                var requestData = getRequestDataFromTabPanels(dialogElement);\r\n                getStatsData(requestData, {tableApi: tableApi, callback: drawStatsTable});\r\n            },\r\n            drawCallback: function(settings){\r\n                this.api().rows().nodes().to$().each(function(i, row){\r\n                    $(row).find('.' + config.statsLineChartClass).peity('line', {\r\n                        fill: 'transparent',\r\n                        height: 18,\r\n                        min: 0,\r\n                        width: 50\r\n                    });\r\n                });\r\n            },\r\n            footerCallback: function ( row, data, start, end, display ) {\r\n                var api = this.api();\r\n                var sumColumnIndexes = [7, 11, 15, 16];\r\n\r\n                // column data for \"sum\" columns over this page\r\n                var pageTotalColumns = api\r\n                    .columns( sumColumnIndexes, { page: 'current'} )\r\n                    .data();\r\n\r\n                // sum columns for \"total\" sum\r\n                pageTotalColumns.each(function(colData, index){\r\n                    pageTotalColumns[index] = colData.reduce(function(a, b){\r\n                        return a + b;\r\n                    }, 0);\r\n                });\r\n\r\n                $(sumColumnIndexes).each(function(index, value){\r\n                    $( api.column( value ).footer() ).text( renderNumericColumn(pageTotalColumns[index]) );\r\n                });\r\n            },\r\n            data: [] // will be added dynamic\r\n        });\r\n\r\n        statsTable.on('order.dt search.dt', function(){\r\n            statsTable.column(0, {search:'applied', order:'applied'}).nodes().each(function(cell, i){\r\n                $(cell).html( (i + 1) + '.&nbsp;&nbsp;');\r\n            });\r\n        }).draw();\r\n\r\n        var tooltipElements = dialogElement.find('[data-toggle=\"tooltip\"]');\r\n        tooltipElements.tooltip();\r\n    };\r\n\r\n    /**\r\n     * request raw statistics data and execute callback\r\n     * @param requestData\r\n     * @param context\r\n     */\r\n    var getStatsData = function(requestData, context){\r\n\r\n        context.dynamicArea = $('#' + config.statsContainerId + ' .pf-dynamic-area');\r\n        context.dynamicArea.showLoadingAnimation();\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.getStatisticsData,\r\n            data: requestData,\r\n            dataType: 'json',\r\n            context: context\r\n        }).done(function(data){\r\n            this.dynamicArea.hideLoadingAnimation();\r\n\r\n            this.callback(data);\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            Util.showNotify({title: jqXHR.status + ': loadStatistics', text: reason, type: 'warning'});\r\n        });\r\n    };\r\n\r\n    /**\r\n     * update dataTable with response data\r\n     * update \"header\"/\"filter\" elements in dialog\r\n     * @param responseData\r\n     */\r\n    var drawStatsTable = function(responseData){\r\n        var dialogElement = $('#' + config.statsDialogId);\r\n\r\n        // update filter/header -----------------------------------------------------------------------------\r\n        var navigationListElements = $('.' + config.dialogNavigationClass);\r\n        navigationListElements.find('a[data-type=\"typeId\"][data-value=\"' + responseData.typeId + '\"]').tab('show');\r\n        navigationListElements.find('a[data-type=\"period\"][data-value=\"' + responseData.period + '\"]').tab('show');\r\n\r\n        // update period pagination -------------------------------------------------------------------------\r\n        var prevButton = dialogElement.find('.' + config.dialogNavigationPrevClass);\r\n        prevButton.data('newOffset', responseData.prev);\r\n        prevButton.find('span').text('Week ' + responseData.prev.week + ', ' + responseData.prev.year);\r\n        prevButton.css('visibility', 'visible');\r\n\r\n        var nextButton = dialogElement.find('.' + config.dialogNavigationNextClass);\r\n        if(responseData.next){\r\n            nextButton.data('newOffset', responseData.next);\r\n            nextButton.find('span').text('Week ' + responseData.next.week + ', ' + responseData.next.year);\r\n            nextButton.css('visibility', 'visible');\r\n        }else{\r\n            nextButton.css('visibility', 'hidden');\r\n        }\r\n\r\n        // update current period information label ----------------------------------------------------------\r\n        // if period == \"weekly\" there is no \"offset\" -> just a single week\r\n        var offsetText = 'Week ' + responseData.start.week + ', ' + responseData.start.year;\r\n        if(responseData.period !== 'weekly'){\r\n            offsetText += ' <small><i class=\"fa fa-fw fa-minus\"></i></small> ' +\r\n                            'Week ' + responseData.offset.week + ', ' + responseData.offset.year;\r\n        }\r\n        dialogElement.find('.' + config.dialogNavigationOffsetClass)\r\n            .data('start', responseData.start)\r\n            .data('period', responseData.period)\r\n            .html(offsetText);\r\n\r\n        // clear and (re)-fill table ------------------------------------------------------------------------\r\n        var formattedData = formatStatisticsData(responseData);\r\n        this.tableApi.clear();\r\n        this.tableApi.rows.add(formattedData).draw();\r\n    };\r\n\r\n    /**\r\n     * format statistics data for dataTable\r\n     * -> e.g. format inline-chart data\r\n     * @param statsData\r\n     * @returns {Array}\r\n     */\r\n    var formatStatisticsData = function(statsData){\r\n        var formattedData = [];\r\n        var yearStart = statsData.start.year;\r\n        var weekStart = statsData.start.week;\r\n        var weekCount = statsData.weekCount;\r\n        var yearWeeks = statsData.yearWeeks;\r\n\r\n        var tempRand = function(min, max){\r\n            return Math.random() * (max - min) + min;\r\n        };\r\n\r\n        // format/sum week statistics data for inline charts\r\n        var formatWeekData = function(weeksData){\r\n            var currentYear = yearStart;\r\n            var currentWeek = weekStart;\r\n\r\n            var formattedWeeksData = {\r\n                systemCreate: [],\r\n                systemUpdate: [],\r\n                systemDelete: [],\r\n                connectionCreate: [],\r\n                connectionUpdate: [],\r\n                connectionDelete: [],\r\n                signatureCreate: [],\r\n                signatureUpdate: [],\r\n                signatureDelete: [],\r\n                systemSum: 0,\r\n                connectionSum: 0,\r\n                signatureSum: 0\r\n            };\r\n\r\n            for(let i = 0; i < weekCount; i++){\r\n                let yearWeekProp = currentYear + '' + currentWeek;\r\n\r\n                if(weeksData.hasOwnProperty( yearWeekProp )){\r\n                    let weekData = weeksData[ yearWeekProp ];\r\n\r\n                    // system -------------------------------------------------------------------------------\r\n                    formattedWeeksData.systemCreate.push( weekData.systemCreate );\r\n                    formattedWeeksData.systemSum += parseInt( weekData.systemCreate );\r\n\r\n                    formattedWeeksData.systemUpdate.push( weekData.systemUpdate );\r\n                    formattedWeeksData.systemSum += parseInt( weekData.systemUpdate );\r\n\r\n                    formattedWeeksData.systemDelete.push( weekData.systemDelete );\r\n                    formattedWeeksData.systemSum += parseInt( weekData.systemDelete );\r\n\r\n                    // connection ---------------------------------------------------------------------------\r\n                    formattedWeeksData.connectionCreate.push( weekData.connectionCreate );\r\n                    formattedWeeksData.connectionSum += parseInt( weekData.connectionCreate );\r\n\r\n                    formattedWeeksData.connectionUpdate.push( weekData.connectionUpdate );\r\n                    formattedWeeksData.connectionSum += parseInt( weekData.connectionUpdate );\r\n\r\n                    formattedWeeksData.connectionDelete.push( weekData.connectionDelete );\r\n                    formattedWeeksData.connectionSum += parseInt( weekData.connectionDelete );\r\n\r\n                    // signature ----------------------------------------------------------------------------\r\n                    formattedWeeksData.signatureCreate.push( weekData.signatureCreate );\r\n                    formattedWeeksData.signatureSum += parseInt( weekData.signatureCreate );\r\n\r\n                    formattedWeeksData.signatureUpdate.push( weekData.signatureUpdate );\r\n                    formattedWeeksData.signatureSum += parseInt( weekData.signatureUpdate );\r\n\r\n                    formattedWeeksData.signatureDelete.push( weekData.signatureDelete );\r\n                    formattedWeeksData.signatureSum += parseInt( weekData.signatureDelete );\r\n                }else{\r\n                    // system -------------------------------------------------------------------------------\r\n                    formattedWeeksData.systemCreate.push(0);\r\n                    formattedWeeksData.systemUpdate.push(0);\r\n                    formattedWeeksData.systemDelete.push(0);\r\n\r\n                    // connection ---------------------------------------------------------------------------\r\n                    formattedWeeksData.connectionCreate.push(0);\r\n                    formattedWeeksData.connectionUpdate.push(0);\r\n                    formattedWeeksData.connectionDelete.push(0);\r\n\r\n                    // signature ----------------------------------------------------------------------------\r\n                    formattedWeeksData.signatureCreate.push(0);\r\n                    formattedWeeksData.signatureUpdate.push(0);\r\n                    formattedWeeksData.signatureDelete.push(0);\r\n                }\r\n\r\n                currentWeek++;\r\n\r\n                if( currentWeek > yearWeeks[currentYear] ){\r\n                    currentWeek = 1;\r\n                    currentYear++;\r\n                }\r\n            }\r\n\r\n            // system ---------------------------------------------------------------------------------------\r\n            formattedWeeksData.systemCreate = formattedWeeksData.systemCreate.join(',');\r\n            formattedWeeksData.systemUpdate = formattedWeeksData.systemUpdate.join(',');\r\n            formattedWeeksData.systemDelete = formattedWeeksData.systemDelete.join(',');\r\n\r\n            // connection -----------------------------------------------------------------------------------\r\n            formattedWeeksData.connectionCreate = formattedWeeksData.connectionCreate.join(',');\r\n            formattedWeeksData.connectionUpdate = formattedWeeksData.connectionUpdate.join(',');\r\n            formattedWeeksData.connectionDelete = formattedWeeksData.connectionDelete.join(',');\r\n\r\n            // signature ------------------------------------------------------------------------------------\r\n            formattedWeeksData.signatureCreate = formattedWeeksData.signatureCreate.join(',');\r\n            formattedWeeksData.signatureUpdate = formattedWeeksData.signatureUpdate.join(',');\r\n            formattedWeeksData.signatureDelete = formattedWeeksData.signatureDelete.join(',');\r\n\r\n            return formattedWeeksData;\r\n        };\r\n\r\n        $.each(statsData.statistics, function(characterId, data){\r\n\r\n            var formattedWeeksData = formatWeekData(data.weeks);\r\n\r\n            var rowData = {\r\n                character: {\r\n                    id: characterId,\r\n                    name: data.name,\r\n                    lastLogin: data.lastLogin\r\n                },\r\n                systemCreate: {\r\n                    type: 'C',\r\n                    data: formattedWeeksData.systemCreate\r\n                },\r\n                systemUpdate: {\r\n                    type: 'U',\r\n                    data: formattedWeeksData.systemUpdate\r\n                },\r\n                systemDelete: {\r\n                    type: 'D',\r\n                    data: formattedWeeksData.systemDelete\r\n                },\r\n                systemSum: formattedWeeksData.systemSum,\r\n                connectionCreate: {\r\n                    type: 'C',\r\n                    data: formattedWeeksData.connectionCreate\r\n                },\r\n                connectionUpdate: {\r\n                    type: 'U',\r\n                    data: formattedWeeksData.connectionUpdate\r\n                },\r\n                connectionDelete: {\r\n                    type: 'D',\r\n                    data: formattedWeeksData.connectionDelete\r\n                },\r\n                connectionSum: formattedWeeksData.connectionSum,\r\n                signatureCreate: {\r\n                    type: 'C',\r\n                    data: formattedWeeksData.signatureCreate\r\n                },\r\n                signatureUpdate: {\r\n                    type: 'U',\r\n                    data: formattedWeeksData.signatureUpdate\r\n                },\r\n                signatureDelete: {\r\n                    type: 'D',\r\n                    data: formattedWeeksData.signatureDelete\r\n                },\r\n                signatureSum: formattedWeeksData.signatureSum,\r\n                totalSum: formattedWeeksData.systemSum + formattedWeeksData.connectionSum + formattedWeeksData.signatureSum\r\n            };\r\n\r\n            formattedData.push(rowData);\r\n        });\r\n\r\n        return formattedData;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param dialogElement\r\n     * @returns {{}}\r\n     */\r\n    var getRequestDataFromTabPanels = function(dialogElement){\r\n        var requestData = {};\r\n\r\n        // get data from \"tab\" panel links ------------------------------------------------------------------\r\n        var navigationListElements = dialogElement.find('.' + config.dialogNavigationClass);\r\n        navigationListElements.find('.' + config.dialogNavigationListItemClass + '.active a').each(function(){\r\n            var linkElement = $(this);\r\n            requestData[linkElement.data('type')]= linkElement.data('value');\r\n        });\r\n\r\n        // get current period (no offset) data (if available) -----------------------------------------------\r\n        var navigationOffsetElement = dialogElement.find('.' + config.dialogNavigationOffsetClass);\r\n        var startData = navigationOffsetElement.data('start');\r\n        var periodOld = navigationOffsetElement.data('period');\r\n\r\n        // if period switch was detected\r\n        // -> \"year\" and \"week\" should not be send\r\n        // -> start from \"now\"\r\n        if(\r\n            requestData.period === periodOld &&\r\n            startData\r\n        ){\r\n            requestData.year = startData.year;\r\n            requestData.week = startData.week;\r\n        }\r\n\r\n        return requestData;\r\n    };\r\n\r\n    /**\r\n     * check if \"activity log\" type is enabled for a group\r\n     * @param type\r\n     * @returns {boolean}\r\n     */\r\n    var isTabTypeEnabled = function(type){\r\n        var enabled = false;\r\n\r\n        switch(type){\r\n            case 'private':\r\n                if(Init.activityLogging.character){\r\n                    enabled = true;\r\n                }\r\n                break;\r\n            case 'corporation':\r\n                if(\r\n                    Init.activityLogging.corporation &&\r\n                    Util.getCurrentUserInfo('corporationId')\r\n                ){\r\n                    enabled = true;\r\n                }\r\n                break;\r\n            case 'alliance':\r\n                if(\r\n                    Init.activityLogging.alliance &&\r\n                    Util.getCurrentUserInfo('allianceId')\r\n                ){\r\n                    enabled = true;\r\n                }\r\n                break;\r\n        }\r\n\r\n        return enabled;\r\n    };\r\n\r\n    /**\r\n     * show activity stats dialog\r\n     */\r\n    $.fn.showStatsDialog = function(){\r\n        requirejs(['text!templates/dialog/stats.html', 'mustache', 'peityInlineChart'], function(template, Mustache) {\r\n\r\n            var data = {\r\n                id: config.statsDialogId,\r\n                dialogNavigationClass: config.dialogNavigationClass,\r\n                dialogNavLiClass: config.dialogNavigationListItemClass,\r\n                enablePrivateTab: isTabTypeEnabled('private'),\r\n                enableCorporationTab: isTabTypeEnabled('corporation'),\r\n                enableAllianceTab: isTabTypeEnabled('alliance'),\r\n                statsContainerId: config.statsContainerId,\r\n                statsTableId: config.statsTableId,\r\n                dialogNavigationOffsetClass: config.dialogNavigationOffsetClass,\r\n                dialogNavigationPrevClass: config.dialogNavigationPrevClass,\r\n                dialogNavigationNextClass: config.dialogNavigationNextClass\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var statsDialog = bootbox.dialog({\r\n                title: 'Statistics',\r\n                message: content,\r\n                size: 'large',\r\n                show: false,\r\n                buttons: {\r\n                    close: {\r\n                        label: 'close',\r\n                        className: 'btn-default'\r\n                    }\r\n                }\r\n            });\r\n\r\n            // model events\r\n            statsDialog.on('show.bs.modal', function(e) {\r\n                var dialogElement = $(e.target);\r\n\r\n                initStatsTable(dialogElement);\r\n            });\r\n\r\n            // Tab module events\r\n            statsDialog.find('a[data-toggle=\"tab\"]').on('show.bs.tab', function (e, b, c) {\r\n                if( $(e.target).parent().hasClass('disabled') ){\r\n                    // no action on \"disabled\" tabs\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            statsDialog.find('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\r\n                var requestData = getRequestDataFromTabPanels(statsDialog);\r\n                var tableApi = statsDialog.find('#' + config.statsTableId).DataTable();\r\n\r\n                getStatsData(requestData, {tableApi: tableApi, callback: drawStatsTable});\r\n            });\r\n\r\n            // offset change links\r\n            statsDialog.find('.' + config.dialogNavigationPrevClass + ', .' + config.dialogNavigationNextClass).on('click', function(){\r\n                var offsetData = $(this).data('newOffset');\r\n                if(offsetData){\r\n                    // this should NEVER fail!\r\n                    // get \"base\" request data (e.g. typeId, period)\r\n                    // --> overwrite period data with new period data\r\n                    var tmpRequestData = getRequestDataFromTabPanels(statsDialog);\r\n                    var requestData =  $.extend({}, tmpRequestData, offsetData);\r\n                    var tableApi = statsDialog.find('#' + config.statsTableId).DataTable();\r\n\r\n                    getStatsData(requestData, {tableApi: tableApi, callback: drawStatsTable});\r\n                }\r\n            });\r\n\r\n            // show dialog\r\n            statsDialog.modal('show');\r\n        });\r\n    };\r\n});\n",
    "/**\r\n * Map util functions\r\n */\r\n\r\ndefine('app/map/util',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util'\r\n], function($, Init, Util) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        mapSnapToGridDimension: 20,                                     // px for grid snapping (grid YxY)\r\n\r\n        // local storage\r\n        characterLocalStoragePrefix: 'character_',                      // prefix for character data local storage key\r\n        mapLocalStoragePrefix: 'map_',                                  // prefix for map data local storage key\r\n        mapTabContentClass: 'pf-map-tab-content',                       // Tab-Content element (parent element)\r\n\r\n        systemClass: 'pf-system',                                       // class for all systems\r\n        mapGridClass: 'pf-grid-small'                                   // class for map grid snapping\r\n    };\r\n\r\n    // map menu options\r\n    var mapOptions = {\r\n        mapMagnetizer: {\r\n            buttonId: Util.config.menuButtonMagnetizerId,\r\n            description: 'Magnetizer',\r\n            onEnable: 'initMagnetizer',     // jQuery extension function\r\n            onDisable: 'destroyMagnetizer'  // jQuery extension function\r\n        },\r\n        mapSnapToGrid : {\r\n            buttonId: Util.config.menuButtonGridId,\r\n            description: 'Grid snapping',\r\n            class: 'mapGridClass'\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get all available map Types\r\n     * optional they can be filtered by current access level of a user\r\n     * @param {bool} filterByUser\r\n     * @returns {Array}\r\n     */\r\n    var getMapTypes = function(filterByUser){\r\n        var mapTypes = [];\r\n\r\n        $.each(Init.mapTypes, function(prop, data){\r\n            // skip \"default\" type -> just for 'add' icon\r\n            if(data.label.length > 0){\r\n                var tempData = data;\r\n                tempData.name = prop;\r\n                mapTypes.push(tempData);\r\n            }\r\n        });\r\n\r\n        if(filterByUser === true){\r\n            var corporationId = Util.getCurrentUserInfo('corporationId');\r\n            var allianceId = Util.getCurrentUserInfo('allianceId');\r\n\r\n            var authorizedMapTypes = [];\r\n            // check if character data exists\r\n            if(corporationId > 0) {\r\n                authorizedMapTypes.push('corporation');\r\n            }\r\n            if(allianceId > 0){\r\n                authorizedMapTypes.push('alliance');\r\n            }\r\n\r\n            // private maps are always allowed\r\n            authorizedMapTypes.push('private');\r\n\r\n            // compare \"all\" map types with \"authorized\" types\r\n            var tempMapTypes = [];\r\n            for(var i = 0; i < mapTypes.length; i++){\r\n                for(var j = 0; j < authorizedMapTypes.length; j++){\r\n                    if(mapTypes[i].name === authorizedMapTypes[j]){\r\n                        tempMapTypes.push(mapTypes[i]);\r\n                        break;\r\n                    }\r\n\r\n                }\r\n            }\r\n            mapTypes = tempMapTypes;\r\n        }\r\n\r\n        return mapTypes;\r\n    };\r\n\r\n    /**\r\n     * get all available scopes for a map\r\n     * @returns {Array}\r\n     */\r\n    var getMapScopes = function(){\r\n        var scopes = [];\r\n        $.each(Init.mapScopes, function(prop, data){\r\n            var tempData = data;\r\n            tempData.name = prop;\r\n            scopes.push(tempData);\r\n        });\r\n\r\n        return scopes;\r\n    };\r\n\r\n    /**\r\n     * get some scope info for a given info string\r\n     * @param {string} info\r\n     * @param {string} option\r\n     * @returns {string}\r\n     */\r\n    var getScopeInfoForMap = function(info, option){\r\n        var scopeInfo = '';\r\n        if(Init.mapScopes.hasOwnProperty(info)){\r\n            scopeInfo = Init.mapScopes[info][option];\r\n        }\r\n        return scopeInfo;\r\n    };\r\n\r\n    /**\r\n     * get all available map icons\r\n     * @returns {Object[]}\r\n     */\r\n    var getMapIcons = function(){\r\n        return Init.mapIcons;\r\n    };\r\n\r\n    /**\r\n     * get map info\r\n     * @param {string} mapType\r\n     * @param {string} option\r\n     * @returns {string}\r\n     */\r\n    var getInfoForMap = function(mapType, option){\r\n        var mapInfo = '';\r\n        if(Init.mapTypes.hasOwnProperty(mapType)){\r\n            mapInfo = Init.mapTypes[mapType][option];\r\n        }\r\n        return mapInfo;\r\n    };\r\n\r\n    /**\r\n     * get some system info for a given info string (e.g. rally class)\r\n     * @param {string} info\r\n     * @param {string} option\r\n     * @returns {string}\r\n     */\r\n    var getInfoForSystem = function(info, option){\r\n        var systemInfo = '';\r\n        if(Init.classes.systemInfo.hasOwnProperty(info)){\r\n            systemInfo = Init.classes.systemInfo[info][option];\r\n        }\r\n        return systemInfo;\r\n    };\r\n\r\n    /**\r\n     * get system type information\r\n     * @param {number} systemTypeId\r\n     * @param {string} option\r\n     * @returns {string}\r\n     */\r\n    var getSystemTypeInfo = function(systemTypeId, option){\r\n        var systemTypeInfo = '';\r\n        $.each(Init.systemType, function(prop, data){\r\n            if(systemTypeId === data.id){\r\n                systemTypeInfo = data[option];\r\n                return;\r\n            }\r\n        });\r\n        return systemTypeInfo;\r\n    };\r\n\r\n    /**\r\n     * get some info for a given effect string\r\n     * @param effect\r\n     * @param option\r\n     * @returns {string}\r\n     */\r\n    var getEffectInfoForSystem = function(effect, option){\r\n        var effectInfo = '';\r\n        if( Init.classes.systemEffects.hasOwnProperty(effect) ){\r\n            effectInfo = Init.classes.systemEffects[effect][option];\r\n        }\r\n        return effectInfo;\r\n    };\r\n\r\n    /**\r\n     * get system elements on a map\r\n     * @returns {*|jQuery}\r\n     */\r\n    $.fn.getSystems = function(){\r\n        return this.find('.' + config.systemClass);\r\n    };\r\n\r\n\r\n    /**\r\n     * search connections by systems\r\n     * @param {Object} map - jsPlumb\r\n     * @param {JQuery[]} systems - system DOM elements\r\n     * @returns {Array} connections - found connection, DOM elements\r\n     */\r\n    var searchConnectionsBySystems = function(map, systems){\r\n        var connections = [];\r\n        var withBackConnection = false;\r\n\r\n        $.each(systems, function(i, system){\r\n            // get connections where system is source\r\n            connections = connections.concat( map.getConnections({source: system}) );\r\n            if(withBackConnection === true){\r\n                // get connections where system is target\r\n                connections = connections.concat( map.getConnections({target: system}) );\r\n            }\r\n        });\r\n        return connections;\r\n    };\r\n\r\n    /**\r\n     * search connections by scope and/or type\r\n     * -> scope and target can be an array\r\n     * @param {Object} map - jsPlumb\r\n     * @param {string|string[]} scope\r\n     * @param {string|string[]} type\r\n     * @returns {Array}\r\n     */\r\n    var searchConnectionsByScopeAndType = function(map, scope, type){\r\n        var connections = [];\r\n        var scopeArray = (scope === undefined) ? ['*'] : ((Array.isArray(scope)) ? scope : [scope]);\r\n        var typeArray = (type === undefined) ? [] : ((Array.isArray(type)) ? type : [type]);\r\n\r\n        map.select({scope: scopeArray}).each(function(connection){\r\n            if(typeArray.length > 0){\r\n                // filter by connection type as well...\r\n                for(var i = 0; i < typeArray.length; i++){\r\n                    if( connection.hasType(typeArray[i]) ){\r\n                        connections.push(connection);\r\n                        break; // don´t add same connection multiple times\r\n                    }\r\n                }\r\n            }else{\r\n                // connection type is ignored\r\n                connections.push(connection);\r\n            }\r\n        });\r\n\r\n        return connections;\r\n    };\r\n\r\n    /**\r\n     * get Connection Info by option\r\n     * @param {string} connectionTyp\r\n     * @param {string} option\r\n     * @returns {string}\r\n     */\r\n    var getConnectionInfo = function(connectionTyp, option){\r\n        var connectionInfo = '';\r\n        if(Init.connectionTypes.hasOwnProperty(connectionTyp)){\r\n            connectionInfo = Init.connectionTypes[connectionTyp][option];\r\n        }\r\n        return connectionInfo;\r\n    };\r\n\r\n    /**\r\n     * get all direct connections between two given systems\r\n     * @param map\r\n     * @param {JQuery} systemA\r\n     * @param {JQuery} systemB\r\n     * @returns {Array}\r\n     */\r\n    var checkForConnection = function(map, systemA, systemB){\r\n        var connections = [];\r\n        connections = connections.concat( map.getConnections({scope: '*', source: systemA, target: systemB}) );\r\n        // get connections where system is target\r\n        connections = connections.concat( map.getConnections({scope: '*', source: systemB, target: systemA}) );\r\n        return connections;\r\n    };\r\n\r\n    /**\r\n     * get the default connection type for a scope\r\n     * e.g. for new type after scope change\r\n     * @param {string} scope\r\n     * @returns {string}\r\n     */\r\n    var getDefaultConnectionTypeByScope = function(scope){\r\n        var type = '';\r\n        switch(scope){\r\n            case 'wh':\r\n                type = 'wh_fresh';\r\n                break;\r\n            case 'jumpbridge':\r\n                type = 'jumpbridge';\r\n                break;\r\n            case'stargate':\r\n                type = 'stargate';\r\n                break;\r\n            default:\r\n                console.error('Connection scope \"' + scope + '\" unknown!');\r\n        }\r\n\r\n        return type;\r\n    };\r\n\r\n    /**\r\n     * set/change connection status of a wormhole\r\n     * @param {Object} connection - jsPlumb object\r\n     * @param {string} status\r\n     */\r\n    var setConnectionWHStatus = function(connection, status){\r\n        if(\r\n            status === 'wh_fresh' &&\r\n            connection.hasType('wh_fresh') !== true\r\n        ){\r\n            connection.removeType('wh_reduced');\r\n            connection.removeType('wh_critical');\r\n            connection.addType('wh_fresh');\r\n        }else if(\r\n            status === 'wh_reduced' &&\r\n            connection.hasType('wh_reduced') !== true\r\n        ){\r\n            connection.removeType('wh_fresh');\r\n            connection.removeType('wh_critical');\r\n            connection.addType('wh_reduced');\r\n        }else if(\r\n            status === 'wh_critical' &&\r\n            connection.hasType('wh_critical') !== true\r\n        ){\r\n            connection.removeType('wh_fresh');\r\n            connection.removeType('wh_reduced');\r\n            connection.addType('wh_critical');\r\n        }else if(\r\n            status === 'wh_eol' &&\r\n            connection.hasType('wh_eol') !== true\r\n        ){\r\n            connection.addType('wh_eol');\r\n        }else if(\r\n            status === 'wh_eol' &&\r\n            connection.hasType('wh_eol') !== true\r\n        ){\r\n            connection.addType('wh_eol');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get some scope info for a given info string\r\n     * @param {string} info\r\n     * @param {string} option\r\n     * @returns {string}\r\n     */\r\n    var getScopeInfoForConnection = function(info, option){\r\n        var scopeInfo = '';\r\n        if(Init.connectionScopes.hasOwnProperty(info)){\r\n            switch(option){\r\n                case 'connectorDefinition':\r\n                    // json data in DB\r\n                    var temp = '{ \"data\": ' + Init.connectionScopes[info][option] + '}';\r\n                    scopeInfo = $.parseJSON( temp).data;\r\n                    break;\r\n                default:\r\n                    scopeInfo = Init.connectionScopes[info][option];\r\n                    break;\r\n            }\r\n        }\r\n\r\n        return scopeInfo;\r\n    };\r\n\r\n    /**\r\n     * get TabContentElement by any element on a map e.g. system\r\n     * @param element\r\n     * @returns {*}\r\n     */\r\n    var getTabContentElementByMapElement = function(element){\r\n        var tabContentElement = $(element).parents('.' + config.mapTabContentClass);\r\n        return tabContentElement;\r\n    };\r\n\r\n    /**\r\n     * set or change rallyPoint for systems\r\n     * @param rallyUpdated\r\n     * @param options\r\n     * @returns {*}\r\n     */\r\n    $.fn.setSystemRally = function(rallyUpdated, options){\r\n        rallyUpdated = rallyUpdated || 0;\r\n        var rallyPoke = false;\r\n\r\n        var defaultOptions = {\r\n            poke: false,\r\n            hideNotification: false,\r\n            hideCounter: false,\r\n        };\r\n        options = $.extend({}, defaultOptions, options);\r\n\r\n        return this.each(function(){\r\n            var system = $(this);\r\n            var rally = system.data('rallyUpdated') || 0;\r\n\r\n            if(rallyUpdated !== rally){\r\n                // rally status changed\r\n                if( !options.hideCounter ){\r\n                    system.getMapOverlay('timer').startMapUpdateCounter();\r\n                }\r\n\r\n                var rallyClass = getInfoForSystem('rally', 'class');\r\n\r\n                if(rallyUpdated > 0){\r\n                    // new rally point set OR update system with rally information\r\n\r\n                    system.addClass( rallyClass );\r\n                    // rallyUpdated > 0 is required for poke!\r\n                    rallyPoke = options.poke;\r\n\r\n                    var notificationOptions = {\r\n                        title: 'Rally Point',\r\n                        text: 'System: ' +  system.data('name')\r\n                    };\r\n\r\n                    if(rallyUpdated === 1){\r\n                        // rally point not saved on DB\r\n                        notificationOptions.type = 'success';\r\n                        Util.showNotify(notificationOptions);\r\n                    }else if(options.poke){\r\n                        // rally saved AND poke option active\r\n\r\n                        // check if desktop notification was already send\r\n                        var mapId = system.data('mapid');\r\n                        var systemId = system.data('id');\r\n                        var promiseStore = getLocaleData('map', mapId);\r\n                        promiseStore.then(function(data) {\r\n                            // This code runs once the value has been loaded\r\n                            // from the offline store.\r\n                            var rallyPokeData = {};\r\n\r\n                            if(\r\n                                data &&\r\n                                data.rallyPoke\r\n                            ){\r\n                                // poke data exists\r\n                                rallyPokeData = data.rallyPoke;\r\n                            }\r\n\r\n                            if(\r\n                                !rallyPokeData.hasOwnProperty(this.systemId) || // rally poke was not already send to client\r\n                                rallyPokeData[this.systemId] !== rallyUpdated // already send to that system but in the past\r\n                            ){\r\n                                rallyPokeData[this.systemId] = rallyUpdated;\r\n                                storeLocalData('map', this.mapId, 'rallyPoke', rallyPokeData);\r\n\r\n                                notificationOptions.type = 'info';\r\n                                Util.showNotify(notificationOptions, {desktop: true, stack: 'barBottom'});\r\n                            }\r\n                        }.bind({\r\n                            mapId: mapId,\r\n                            systemId: systemId,\r\n                            rallyUpdated: rallyUpdated\r\n                        }));\r\n                    }\r\n                }else{\r\n                    // rally point removed\r\n                    system.removeClass( rallyClass );\r\n\r\n                    if( !options.hideNotification ){\r\n                        Util.showNotify({title: 'Rally point removed', type: 'success'});\r\n                    }\r\n                }\r\n            }\r\n\r\n            system.data('rallyUpdated', rallyUpdated);\r\n            system.data('rallyPoke', rallyPoke);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * store mapId for current user (IndexedDB)\r\n     * @param mapId\r\n     */\r\n    var storeDefaultMapId = function(mapId){\r\n        if(mapId > 0){\r\n            var userData = Util.getCurrentUserData();\r\n            if(\r\n                userData &&\r\n                userData.character\r\n            ){\r\n                storeLocalData('character', userData.character.id, 'defaultMapId', mapId);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get key prefix for local storage data\r\n     * @param type\r\n     * @returns {boolean}\r\n     */\r\n    var getLocalStoragePrefixByType = function(type){\r\n        var prefix = false;\r\n        switch(type){\r\n            case 'character':   prefix = config.characterLocalStoragePrefix; break;\r\n            case 'map':   prefix = config.mapLocalStoragePrefix; break;\r\n            default:   prefix = config.mapLocalStoragePrefix;\r\n        }\r\n        return prefix;\r\n    };\r\n\r\n    /**\r\n     * get stored local data from client cache (IndexedDB)\r\n     * @param type\r\n     * @param objectId\r\n     * @returns {*}\r\n     */\r\n    var getLocaleData = function(type, objectId){\r\n        if(objectId > 0){\r\n            var storageKey = getLocalStoragePrefixByType(type) + objectId;\r\n            return Util.getLocalStorage().getItem(storageKey);\r\n        }else{\r\n            console.warn('Local storage requires object id > 0');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * store local config data to client cache (IndexedDB)\r\n     * @param type\r\n     * @param objectId\r\n     * @param key\r\n     * @param value\r\n     */\r\n    var storeLocalData = function(type, objectId, key, value){\r\n        if(objectId > 0){\r\n            // get current map config\r\n            var storageKey = getLocalStoragePrefixByType(type) + objectId;\r\n            Util.getLocalStorage().getItem(storageKey).then(function(data) {\r\n                // This code runs once the value has been loaded\r\n                // from the offline store.\r\n                data = (data === null) ? {} : data;\r\n                // set/update value\r\n                data[this.key] = this.value;\r\n                Util.getLocalStorage().setItem(this.storageKey, data);\r\n            }.bind({\r\n                key: key,\r\n                value: value,\r\n                storageKey: storageKey\r\n            })).catch(function(err) {\r\n                // This code runs if there were any errors\r\n                console.error('Map local storage can not be accessed!');\r\n            });\r\n        }else{\r\n            console.warn('storeLocalData(): Local storage requires object id > 0');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * delete local map configuration by key (IndexedDB)\r\n     * @param type\r\n     * @param objectId\r\n     * @param key\r\n     */\r\n    var deleteLocalData = function(type, objectId, key){\r\n        if(objectId > 0){\r\n            // get current map config\r\n            var storageKey = getLocalStoragePrefixByType(type) + objectId;\r\n            Util.getLocalStorage().getItem(storageKey).then(function(data) {\r\n                if(\r\n                    data &&\r\n                    data.hasOwnProperty(key)\r\n                ){\r\n                    delete data[key];\r\n                    Util.getLocalStorage().setItem(this.storageKey, data);\r\n                }\r\n            }.bind({\r\n                storageKey: storageKey\r\n            }));\r\n        }else{\r\n            console.warn('deleteLocalData(): Local storage requires object id > 0');\r\n        }\r\n    };\r\n\r\n    return {\r\n        config: config,\r\n        mapOptions: mapOptions,\r\n        getMapTypes: getMapTypes,\r\n        getMapScopes: getMapScopes,\r\n        getScopeInfoForMap: getScopeInfoForMap,\r\n        getMapIcons: getMapIcons,\r\n        getInfoForMap: getInfoForMap,\r\n        getInfoForSystem: getInfoForSystem,\r\n        getSystemTypeInfo: getSystemTypeInfo,\r\n        getEffectInfoForSystem: getEffectInfoForSystem,\r\n        searchConnectionsBySystems: searchConnectionsBySystems,\r\n        searchConnectionsByScopeAndType: searchConnectionsByScopeAndType,\r\n        getConnectionInfo: getConnectionInfo,\r\n        checkForConnection: checkForConnection,\r\n        getDefaultConnectionTypeByScope: getDefaultConnectionTypeByScope,\r\n        setConnectionWHStatus: setConnectionWHStatus,\r\n        getScopeInfoForConnection: getScopeInfoForConnection,\r\n        getTabContentElementByMapElement: getTabContentElementByMapElement,\r\n        storeDefaultMapId: storeDefaultMapId,\r\n        getLocaleData: getLocaleData,\r\n        storeLocalData: storeLocalData,\r\n        deleteLocalData: deleteLocalData\r\n    };\r\n});\n",
    "/**\r\n * map info dialog\r\n */\r\n\r\ndefine('dialog/map_info',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'bootbox',\r\n    'app/map/util'\r\n], function($, Init, Util, bootbox, MapUtil) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n        // global dialog\r\n        dialogNavigationClass: 'pf-dialog-navigation-list',                     // class for dialog navigation bar\r\n\r\n        // map info dialog/tabs\r\n        dialogMapInfoSummaryId: 'pf-map-info-dialog-summary',                   // id for map \"summary\" container\r\n        dialogMapInfoUsersId: 'pf-map-info-dialog-users',                       // id for map \"user\" container\r\n        dialogMapInfoRefreshId: 'pf-map-info-dialog-refresh',                   // id for map \"refresh\" container\r\n\r\n        // \"summary\" container\r\n        mapInfoId: 'pf-map-info',                                               // id for map info\r\n        mapInfoSystemsId: 'pf-map-info-systems',                                // id for map info systems box\r\n        mapInfoConnectionsId: 'pf-map-info-connections',                        // id for map info connections box\r\n        mapInfoUsersId: 'pf-map-info-users',                                    // id for map info users box\r\n\r\n        mapInfoTableClass: 'pf-map-info-table',                                 // class for data\r\n        mapInfoLifetimeCounterClass: 'pf-map-info-lifetime-counter',            // class for map lifetime counter\r\n\r\n        // dataTable\r\n        tableImageCellClass: 'pf-table-image-cell',                             // class for table \"image\" cells\r\n        tableImageSmallCellClass: 'pf-table-image-small-cell',                  // class for table \"small image\" cells\r\n        tableActionCellClass: 'pf-table-action-cell',                           // class for table \"action\" cells\r\n        tableCounterCellClass: 'pf-table-counter-cell',                         // class for table \"counter\" cells\r\n\r\n        systemIdPrefix: 'pf-system-',                                           // id prefix for a system\r\n\r\n        loadingOptions: {                                                       // config for loading overlay\r\n            icon: {\r\n                size: 'fa-2x'\r\n            }\r\n        }\r\n    };\r\n\r\n    // confirmation dialog settings (e.g. delete row)\r\n    var confirmationSettings = {\r\n        container: 'body',\r\n        placement: 'left',\r\n        btnCancelClass: 'btn btn-sm btn-default',\r\n        btnCancelLabel: 'cancel',\r\n        btnCancelIcon: 'fa fa-fw fa-ban',\r\n        btnOkClass: 'btn btn-sm btn-danger',\r\n        btnOkLabel: 'delete',\r\n        btnOkIcon: 'fa fa-fw fa-close'\r\n    };\r\n\r\n    /**\r\n     * loads the map info data into an element\r\n     * @param mapData\r\n     */\r\n    $.fn.loadMapInfoData = function(mapData){\r\n\r\n        var mapElement = $(this);\r\n\r\n        mapElement.empty();\r\n\r\n        mapElement.showLoadingAnimation(config.loadingOptions);\r\n\r\n        var countSystems = mapData.data.systems.length;\r\n        var countConnections = mapData.data.connections.length;\r\n\r\n        // map type\r\n        var mapTypes = MapUtil.getMapTypes();\r\n        var mapTypeName = '';\r\n        var mapTypeClass = '';\r\n        for(var i = 0; i < mapTypes.length; i++){\r\n            if(mapTypes[i].id === mapData.config.type.id){\r\n                mapTypeName = mapTypes[i].name;\r\n                mapTypeClass = mapTypes[i].class;\r\n            }\r\n        }\r\n\r\n        var dlElementLeft = $('<dl>', {\r\n            class: 'dl-horizontal',\r\n            css: {'float': 'left'}\r\n        }).append(\r\n                $('<dt>').text( 'Icon' )\r\n            ).append(\r\n                $('<dd>').append(\r\n                    $('<i>', {\r\n                        class: ['fa', 'fa-fw', mapData.config.icon].join(' ')\r\n                    })\r\n                )\r\n            ).append(\r\n                $('<dt>').text( 'Name' )\r\n            ).append(\r\n                $('<dd>').text( mapData.config.name )\r\n            ).append(\r\n                $('<dt>').text( 'Type' )\r\n            ).append(\r\n                $('<dd>', {\r\n                    class: mapTypeClass\r\n                }).text( mapTypeName )\r\n            );\r\n\r\n        mapElement.append(dlElementLeft);\r\n\r\n        var dlElementRight = $('<dl>', {\r\n            class: 'dl-horizontal',\r\n            css: {'float': 'right'}\r\n            }).append(\r\n                $('<dt>').text( 'Lifetime' )\r\n            ).append(\r\n                $('<dd>', {\r\n                    class: config.mapInfoLifetimeCounterClass,\r\n                    text: mapData.config.created\r\n                })\r\n            ).append(\r\n                $('<dt>').text( 'Systems' )\r\n            ).append(\r\n                $('<dd>').text( countSystems )\r\n            ).append(\r\n                $('<dt>').text( 'Connections' )\r\n            ).append(\r\n                $('<dd>').text( countConnections )\r\n            );\r\n\r\n        mapElement.append(dlElementRight);\r\n\r\n        // init map lifetime counter\r\n        $('.' + config.mapInfoLifetimeCounterClass).initTimestampCounter();\r\n\r\n\r\n\r\n        mapElement.hideLoadingAnimation();\r\n\r\n    };\r\n\r\n    /**\r\n     * loads the system info table into an element\r\n     * @param mapData\r\n     */\r\n    $.fn.loadSystemInfoTable = function(mapData){\r\n\r\n        var systemsElement = $(this);\r\n\r\n        systemsElement.empty();\r\n\r\n        var systemTable = $('<table>', {\r\n            class: ['compact', 'stripe', 'order-column', 'row-border', config.mapInfoTableClass].join(' ')\r\n        });\r\n        systemsElement.append(systemTable);\r\n\r\n        systemsElement.showLoadingAnimation(config.loadingOptions);\r\n\r\n        // table init complete\r\n        systemTable.on( 'init.dt', function () {\r\n            systemsElement.hideLoadingAnimation();\r\n\r\n            // init table tooltips\r\n            var tooltipElements = systemsElement.find('[data-toggle=\"tooltip\"]');\r\n            tooltipElements.tooltip();\r\n        });\r\n\r\n        // prepare data for dataTables\r\n        var systemsData = [];\r\n        for(var i = 0; i < mapData.data.systems.length; i++){\r\n            var tempSystemData = mapData.data.systems[i];\r\n\r\n            var tempData = {};\r\n\r\n            // system id\r\n            tempData.id = tempSystemData.id;\r\n\r\n            // current position\r\n            if(tempSystemData.currentUser === true){\r\n                tempData.position = {\r\n                    position: '<i class=\"fa fa fa-map-marker fa-lg fa-fw\"></i>',\r\n                    position_sort: 1\r\n                };\r\n            }else{\r\n                tempData.position = {\r\n                    position: '',\r\n                    position_sort: 0\r\n                };\r\n            }\r\n\r\n            // active pilots\r\n            if(tempSystemData.userCount > 0){\r\n                tempData.userCount = tempSystemData.userCount;\r\n            }else{\r\n                tempData.userCount = '';\r\n            }\r\n\r\n            // type\r\n            tempData.type = {\r\n                type: MapUtil.getSystemTypeInfo(tempSystemData.type.id, 'name'),\r\n                type_sort: tempSystemData.type.id\r\n            };\r\n\r\n            // security\r\n            var securityClass = Util.getSecurityClassForSystem(tempSystemData.security);\r\n            tempData.security = {\r\n                security: '<span class=\"' + securityClass + '\">' + tempSystemData.security + '</span>',\r\n                security_sort: tempSystemData.security\r\n            };\r\n\r\n            // name\r\n            tempData.name = tempSystemData.name;\r\n\r\n            // region\r\n            tempData.region = tempSystemData.region.name;\r\n\r\n            // static\r\n            var statics = [];\r\n            for(var j = 0; j < tempSystemData.statics.length; j++){\r\n                var security = tempSystemData.statics[j].security;\r\n                var secClass = Util.getSecurityClassForSystem(security);\r\n                statics.push('<span class=\"' + secClass + '\">' + security + '</span>');\r\n            }\r\n            tempData.static = statics.join('&nbsp;&nbsp;');\r\n\r\n            // status\r\n            var systemStatusClass = Util.getStatusInfoForSystem(tempSystemData.status.id, 'class');\r\n            if(systemStatusClass !== ''){\r\n                tempData.status = {\r\n                    status: '<i class=\"fa fa fa-square-o fa-lg fa-fw ' + systemStatusClass + '\"></i>',\r\n                    status_sort: tempSystemData.status.id\r\n                };\r\n            }else{\r\n                tempData.status = {\r\n                    status: '',\r\n                    status_sort: tempSystemData.status.id\r\n                };\r\n            }\r\n\r\n            // effect\r\n            var systemEffectClass = MapUtil.getEffectInfoForSystem(tempSystemData.effect, 'class');\r\n            if(systemEffectClass !== ''){\r\n                tempData.effect = {\r\n                    effect: '<i class=\"fa fa fa-square fa-lg fa-fw ' + systemEffectClass + '\"></i>',\r\n                    effect_sort: tempSystemData.effect\r\n                };\r\n            }else{\r\n                tempData.effect = {\r\n                    effect: '',\r\n                    effect_sort: ''\r\n                };\r\n            }\r\n\r\n            // trueSec\r\n            var systemTrueSecClass = Util.getTrueSecClassForSystem(tempSystemData.trueSec);\r\n            if(systemTrueSecClass !== ''){\r\n                tempData.trueSec = {\r\n                    trueSec: '<span class=\"' + systemTrueSecClass + '\">' + tempSystemData.trueSec.toFixed(1) + '</span>',\r\n                    trueSec_sort: tempSystemData.trueSec\r\n                };\r\n            }else{\r\n                tempData.trueSec = {\r\n                    trueSec: '',\r\n                    trueSec_sort: tempSystemData.trueSec\r\n                };\r\n            }\r\n\r\n            // locked\r\n            if(tempSystemData.locked === 1){\r\n                tempData.locked = {\r\n                    locked: '<i class=\"fa fa-lock fa-lg fa-fw\"></i>',\r\n                    locked_sort: tempSystemData.locked\r\n                };\r\n            }else{\r\n                tempData.locked = {\r\n                    locked: '',\r\n                    locked_sort: 0\r\n                };\r\n            }\r\n\r\n            // updated\r\n            tempData.updated = tempSystemData.updated.updated;\r\n\r\n            // delete row\r\n            tempData.clear = '<i class=\"fa fa-close txt-color txt-color-redDarker\"></i>';\r\n\r\n            systemsData.push(tempData);\r\n        }\r\n\r\n        var systemsDataTable = systemTable.dataTable( {\r\n            pageLength: 20,\r\n            paging: true,\r\n            lengthMenu: [[5, 10, 20, 50, -1], [5, 10, 20, 50, 'All']],\r\n            ordering: true,\r\n            order: [[ 9, 'desc' ], [ 3, 'asc' ]],\r\n            autoWidth: false,\r\n            responsive: {\r\n                breakpoints: Init.breakpoints,\r\n                details: false\r\n            },\r\n            hover: false,\r\n            data: systemsData,\r\n            columnDefs: [],\r\n            language: {\r\n                emptyTable:  'Map is empty',\r\n                zeroRecords: 'No systems found',\r\n                lengthMenu:  'Show _MENU_ systems',\r\n                info:        'Showing _START_ to _END_ of _TOTAL_ systems'\r\n            },\r\n            columns: [\r\n                {\r\n                    title: 'type',\r\n                    width: '25px',\r\n                    className: ['min-desktop'].join(' '),\r\n                    data: 'type',\r\n                    render: {\r\n                        _: 'type',\r\n                        sort: 'type_sort'\r\n                    }\r\n                },{\r\n                    title: '',\r\n                    width: '1px',\r\n                    searchable: false,\r\n                    data: 'security',\r\n                    render: {\r\n                        _: 'security',\r\n                        sort: 'security_sort'\r\n                    }\r\n                },{\r\n                    title: 'sec',\r\n                    width: '18px',\r\n                    className: ['text-center', 'min-desktop'].join(' '),\r\n                    searchable: false,\r\n                    data: 'trueSec',\r\n                    render: {\r\n                        _: 'trueSec',\r\n                        sort: 'trueSec_sort'\r\n                    }\r\n                },{\r\n                    title: 'system',\r\n                    data: 'name'\r\n                },{\r\n                    title: 'region',\r\n                    data: 'region'\r\n                },{\r\n                    title: '<i class=\"fa fa-square-o fa-lg\" title=\"system&nbsp;status\" data-toggle=\"tooltip\"></i>',\r\n                    width: '12px',\r\n                    searchable: false,\r\n                    data: 'status',\r\n                    render: {\r\n                        _: 'status',\r\n                        sort: 'status_sort'\r\n                    }\r\n                },{\r\n                    title: '<i class=\"fa fa-square fa-lg\" title=\"system&nbsp;effect\" data-toggle=\"tooltip\"></i>',\r\n                    width: '12px',\r\n                    className: 'text-center',\r\n                    searchable: false,\r\n                    data: 'effect',\r\n                    render: {\r\n                        _: 'effect',\r\n                        sort: 'effect_sort'\r\n                    }\r\n                },{\r\n                    title: 'static',\r\n                    width: '30px',\r\n                    data: 'static'\r\n                },{\r\n                    title: '<i class=\"fa fa-map-marker fa-lg\" title=\"your&nbsp;position\" data-toggle=\"tooltip\"></i>',\r\n                    width: '8px',\r\n                    searchable: false,\r\n                    data: 'position',\r\n                    render: {\r\n                        _: 'position',\r\n                        sort: 'position_sort'\r\n                    }\r\n                },{\r\n                    title: '<i class=\"fa fa-plane fa-lg\" title=\"active&nbsp;pilots\" data-toggle=\"tooltip\"></i>',\r\n                    width: '12px',\r\n                    className: 'text-center',\r\n                    searchable: false,\r\n                    data: 'userCount'\r\n                },{\r\n                    title: '<i class=\"fa fa-lock fa-lg\" title=\"system&nbsp;locked\" data-toggle=\"tooltip\"></i>',\r\n                    width: '10px',\r\n                    searchable: false,\r\n                    data: 'locked',\r\n                    render: {\r\n                        _: 'locked',\r\n                        sort: 'locked_sort'\r\n                    }\r\n                },{\r\n                    title: 'updated',\r\n                    width: '80px',\r\n                    searchable: false,\r\n                    className: ['text-right', config.tableCounterCellClass, 'min-desktop'].join(' '),\r\n                    data: 'updated',\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n                        $(cell).initTimestampCounter();\r\n\r\n                        // highlight cell\r\n                        var diff = new Date().getTime() - cellData * 1000;\r\n                        var dateDiff = new Date(diff);\r\n                        if(dateDiff.getUTCDate() > 1){\r\n                            $(cell).addClass('txt-color txt-color-warning');\r\n                        }\r\n                    }\r\n                },{\r\n                    title: '',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: '10px',\r\n                    className: ['text-center', config.tableActionCellClass].join(' '),\r\n                    data: 'clear',\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex) {\r\n                        var tempTableElement = this;\r\n\r\n                        var tempConfirmationSettings = confirmationSettings;\r\n                        tempConfirmationSettings.title = 'Delete system';\r\n                        tempConfirmationSettings.onConfirm = function(e, target){\r\n                            var deleteRowElement = $(target).parents('tr');\r\n\r\n                            var activeMap = Util.getMapModule().getActiveMap();\r\n                            var systemElement = $('#' + config.systemIdPrefix + mapData.config.id + '-' + rowData.id);\r\n\r\n                            if(systemElement){\r\n                                // trigger system delete event\r\n                                activeMap.trigger('pf:deleteSystems', [{\r\n                                    systems: [systemElement],\r\n                                    callback: function(){\r\n                                        // callback function after ajax \"delete\" success\r\n                                        // remove table row\r\n                                        tempTableElement.DataTable().rows(deleteRowElement).remove().draw();\r\n\r\n                                        Util.showNotify({title: 'System deleted', text: rowData.name, type: 'success'});\r\n\r\n                                        // refresh connection table (connections might have changed) ------------------------------\r\n                                        var connectionsElement = $('#' + config.mapInfoConnectionsId);\r\n                                        var mapDataNew = activeMap.getMapDataFromClient({forceData: true});\r\n\r\n                                        connectionsElement.loadConnectionInfoTable(mapDataNew);\r\n                                    }\r\n                                }]);\r\n                            }\r\n                        };\r\n\r\n                        // init confirmation dialog\r\n                        $(cell).confirmation(tempConfirmationSettings);\r\n\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * loads the connection info table into an element\r\n     * @param mapData\r\n     */\r\n    $.fn.loadConnectionInfoTable = function(mapData){\r\n        var connectionsElement = $(this);\r\n\r\n        connectionsElement.empty();\r\n\r\n        var connectionTable = $('<table>', {\r\n            class: ['compact', 'stripe', 'order-column', 'row-border', config.mapInfoTableClass].join(' ')\r\n        });\r\n        connectionsElement.append(connectionTable);\r\n\r\n        connectionsElement.showLoadingAnimation(config.loadingOptions);\r\n\r\n        // table init complete\r\n        connectionTable.on( 'init.dt', function () {\r\n            connectionsElement.hideLoadingAnimation();\r\n        });\r\n\r\n        // connections table ==================================================\r\n\r\n        // prepare data for dataTables\r\n        var connectionData = [];\r\n        for(var j = 0; j < mapData.data.connections.length; j++){\r\n            var tempConnectionData = mapData.data.connections[j];\r\n\r\n            var tempConData = {};\r\n\r\n            tempConData.id = tempConnectionData.id;\r\n\r\n            tempConData.scope = {\r\n                scope: MapUtil.getScopeInfoForConnection(tempConnectionData.scope, 'label'),\r\n                scope_sort: tempConnectionData.scope\r\n            };\r\n\r\n            // source system name\r\n            tempConData.source = tempConnectionData.sourceName;\r\n\r\n            // connection\r\n            var connectionClasses = [];\r\n            for(var k = 0; k < tempConnectionData.type.length; k++){\r\n                connectionClasses.push( MapUtil.getConnectionInfo( tempConnectionData.type[k], 'cssClass') );\r\n\r\n            }\r\n\r\n            connectionClasses = connectionClasses.join(' ');\r\n\r\n            tempConData.connection = '<div class=\"pf-fake-connection ' + connectionClasses + '\"></div>';\r\n\r\n\r\n            tempConData.target = tempConnectionData.targetName;\r\n\r\n            tempConData.updated = tempConnectionData.updated;\r\n\r\n            tempConData.clear = '<i class=\"fa fa-close txt-color txt-color-redDarker\"></i>';\r\n\r\n            connectionData.push(tempConData);\r\n        }\r\n\r\n        var connectionDataTable = connectionTable.dataTable( {\r\n            pageLength: 20,\r\n            paging: true,\r\n            lengthMenu: [[5, 10, 20, 50, -1], [5, 10, 20, 50, 'All']],\r\n            ordering: true,\r\n            order: [ 0, 'desc' ],\r\n            autoWidth: false,\r\n            hover: false,\r\n            data: connectionData,\r\n            columnDefs: [],\r\n            language: {\r\n                emptyTable:  'No connections',\r\n                zeroRecords: 'No connections found',\r\n                lengthMenu:  'Show _MENU_ connections',\r\n                info:        'Showing _START_ to _END_ of _TOTAL_ connections'\r\n            },\r\n            columns: [\r\n                {\r\n                    title: 'scope',\r\n                    width: '50px',\r\n                    orderable: true,\r\n                    data: 'scope',\r\n                    render: {\r\n                        _: 'scope',\r\n                        sort: 'scope_sort'\r\n                    }\r\n                },{\r\n                    title: 'source system',\r\n                    data: 'source'\r\n                },{\r\n                    title: 'connection',\r\n                    width: '80px',\r\n                    className: 'text-center',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    data: 'connection'\r\n                }, {\r\n                    title: 'target system',\r\n                    data: 'target'\r\n                },{\r\n                    title: 'updated',\r\n                    width: '80px',\r\n                    searchable: false,\r\n                    className: ['text-right', config.tableCounterCellClass].join(' '),\r\n                    data: 'updated',\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n                        $(cell).initTimestampCounter();\r\n\r\n                        // highlight cell\r\n                        var diff = new Date().getTime() - cellData * 1000;\r\n                        var dateDiff = new Date(diff);\r\n                        if(dateDiff.getUTCDate() > 1){\r\n                            $(cell).addClass('txt-color txt-color-warning');\r\n                        }\r\n                    }\r\n                },{\r\n                    title: '',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: '10px',\r\n                    className: ['text-center', config.tableActionCellClass].join(' '),\r\n                    data: 'clear',\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex) {\r\n                        var tempTableElement = this;\r\n\r\n                        var tempConfirmationSettings = confirmationSettings;\r\n                        tempConfirmationSettings.title = 'Delete connection';\r\n                        tempConfirmationSettings.onConfirm = function(e, target){\r\n                            var deleteRowElement = $(target).parents('tr');\r\n\r\n                            // deleteSignatures(row);\r\n                            var connection = $().getConnectionById(mapData.config.id, rowData.id);\r\n\r\n                            $().deleteConnections([connection], function(){\r\n                                // callback function after ajax \"delete\" success\r\n                                // remove table row\r\n                                tempTableElement.DataTable().rows(deleteRowElement).remove().draw();\r\n                            });\r\n                        };\r\n\r\n                        // init confirmation dialog\r\n                        $(cell).confirmation(tempConfirmationSettings);\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    };\r\n\r\n    $.fn.loadUsersInfoTable = function(mapData){\r\n        var usersElement = $(this);\r\n\r\n        usersElement.empty();\r\n\r\n        var userTable = $('<table>', {\r\n            class: ['compact', 'stripe', 'order-column', 'row-border', config.mapInfoTableClass].join(' ')\r\n        });\r\n        usersElement.append(userTable);\r\n\r\n        usersElement.showLoadingAnimation(config.loadingOptions);\r\n\r\n        // table init complete\r\n        userTable.on( 'init.dt', function () {\r\n            usersElement.hideLoadingAnimation();\r\n        });\r\n\r\n        // users table ========================================================\r\n        // prepare users data for dataTables\r\n        var currentMapUserData = Util.getCurrentMapUserData( mapData.config.id );\r\n        var usersData = [];\r\n\r\n        if(\r\n            currentMapUserData &&\r\n            currentMapUserData.data &&\r\n            currentMapUserData.data.systems\r\n        ){\r\n            for(var i = 0; i < currentMapUserData.data.systems.length; i++){\r\n                var tempSystemUserData = currentMapUserData.data.systems[i];\r\n                for(var j = 0; j < tempSystemUserData.user.length; j++){\r\n                    usersData.push( tempSystemUserData.user[j] );\r\n                }\r\n            }\r\n        }\r\n\r\n        var userDataTable = userTable.dataTable( {\r\n            pageLength: 20,\r\n            paging: true,\r\n            lengthMenu: [[5, 10, 20, 50, -1], [5, 10, 20, 50, 'All']],\r\n            ordering: true,\r\n            order: [ 1, 'asc' ],\r\n            autoWidth: false,\r\n            hover: false,\r\n            data: usersData,\r\n            language: {\r\n                emptyTable:  'No active pilots',\r\n                zeroRecords: 'No active pilots found',\r\n                lengthMenu:  'Show _MENU_ pilots',\r\n                info:        'Showing _START_ to _END_ of _TOTAL_ pilots'\r\n            },\r\n            columnDefs: [\r\n                {\r\n                    targets: 0,\r\n                    title: '',\r\n                    width: '26px',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    className: ['text-center', config.tableImageCellClass].join(' '),\r\n                    data: 'log.ship',\r\n                    render: {\r\n                        _: function(data, type, row, meta){\r\n                            return '<img src=\"' + Init.url.ccpImageServer + 'Render/' + data.typeId + '_32.png\" />';\r\n                        }\r\n                    }\r\n                },{\r\n                    targets: 1,\r\n                    title: 'ship',\r\n                    orderable: true,\r\n                    searchable: true,\r\n                    data: 'log.ship',\r\n                    render: {\r\n                        _: 'typeName',\r\n                        sort: 'typeName'\r\n                    }\r\n                },{\r\n                    targets: 2,\r\n                    title: '',\r\n                    width: '26px',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    className: [config.tableImageCellClass].join(' '),\r\n                    data: 'id',\r\n                    render: {\r\n                        _: function(data, type, row, meta){\r\n                            return '<img src=\"' + Init.url.ccpImageServer + 'Character/' + data + '_32.jpg\" />';\r\n                        }\r\n                    }\r\n                },{\r\n                    targets: 3,\r\n                    title: 'pilot',\r\n                    orderable: true,\r\n                    searchable: true,\r\n                    data: 'name'\r\n                },{\r\n                    targets: 4,\r\n                    title: '',\r\n                    width: '26px',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    className: [config.tableImageCellClass, config.tableImageSmallCellClass].join(' '),\r\n                    data: 'corporation',\r\n                    render: {\r\n                        _: function(data, type, row, meta){\r\n                            return '<img src=\"' + Init.url.ccpImageServer + 'Corporation/' + data.id + '_32.png\" />';\r\n                        }\r\n                    }\r\n                },{\r\n                    targets: 5,\r\n                    title: 'corporation',\r\n                    orderable: true,\r\n                    searchable: true,\r\n                    data: 'corporation',\r\n                    render: {\r\n                        _: 'name'\r\n                    }\r\n                },{\r\n                    targets: 6,\r\n                    title: 'system',\r\n                    orderable: true,\r\n                    searchable: true,\r\n                    data: 'log.system',\r\n                    render: {\r\n                        _: 'name',\r\n                        sort: 'name'\r\n                    }\r\n                },{\r\n                    targets: 7,\r\n                    title: 'station',\r\n                    orderable: true,\r\n                    searchable: true,\r\n                    data: 'log.station',\r\n                    render: {\r\n                        _: 'name',\r\n                        sort: 'name'\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * shows the map information modal dialog\r\n     */\r\n    $.fn.showMapInfoDialog = function(){\r\n\r\n        var activeMap = Util.getMapModule().getActiveMap();\r\n        var mapData = activeMap.getMapDataFromClient({forceData: true});\r\n\r\n        if(mapData !== false){\r\n            requirejs(['text!templates/dialog/map_info.html', 'mustache'], function(template, Mustache) {\r\n\r\n                var data = {\r\n                    dialogSummaryContainerId: config.dialogMapInfoSummaryId,\r\n                    dialogUsersContainerId: config.dialogMapInfoUsersId,\r\n                    dialogRefreshContainerId: config.dialogMapInfoRefreshId,\r\n                    dialogNavigationClass: config.dialogNavigationClass,\r\n                    mapInfoId: config.mapInfoId,\r\n                    mapInfoSystemsId: config.mapInfoSystemsId,\r\n                    mapInfoConnectionsId: config.mapInfoConnectionsId,\r\n                    mapInfoUsersId: config.mapInfoUsersId\r\n                };\r\n\r\n                var content = Mustache.render(template, data);\r\n\r\n                var mapInfoDialog = bootbox.dialog({\r\n                    title: 'Map information',\r\n                    message: content,\r\n                    size: 'large',\r\n                    buttons: {\r\n                        success: {\r\n                            label: 'close',\r\n                            className: 'btn-primary',\r\n                            callback: function() {\r\n                                $(mapInfoDialog).modal('hide');\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                mapInfoDialog.on('shown.bs.modal', function(e) {\r\n                    // modal on open\r\n\r\n                    var mapElement = $('#' + config.mapInfoId);\r\n                    var systemsElement = $('#' + config.mapInfoSystemsId);\r\n                    var connectionsElement = $('#' + config.mapInfoConnectionsId);\r\n                    var usersElement = $('#' + config.mapInfoUsersId);\r\n\r\n\r\n                    // set refresh button observer\r\n                    $('#' + config.dialogMapInfoRefreshId).on('click', function(){\r\n                        var menuAction = $(this).attr('data-action');\r\n                        if(menuAction === 'refresh'){\r\n                            // get new map data\r\n                            var mapData = activeMap.getMapDataFromClient({forceData: true});\r\n\r\n                            mapElement.loadMapInfoData(mapData);\r\n                            systemsElement.loadSystemInfoTable(mapData);\r\n                            connectionsElement.loadConnectionInfoTable(mapData);\r\n                            usersElement.loadUsersInfoTable(mapData);\r\n                        }\r\n                    });\r\n\r\n                    // load map data\r\n                    mapElement.loadMapInfoData(mapData);\r\n\r\n                    // load system table\r\n                    systemsElement.loadSystemInfoTable(mapData);\r\n\r\n                    // load connection table\r\n                    connectionsElement.loadConnectionInfoTable(mapData);\r\n\r\n                    // load users table\r\n                    usersElement.loadUsersInfoTable(mapData);\r\n                });\r\n\r\n            });\r\n        }\r\n\r\n    };\r\n});\n",
    "/**\r\n *  user settings/share dialog\r\n */\r\n\r\ndefine('dialog/account_settings',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox'\r\n], function($, Init, Util, Render, bootbox) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // select character dialog\r\n        settingsDialogId: 'pf-settings-dialog',                                 // id for \"settings\" dialog\r\n        settingsAccountContainerId: 'pf-settings-dialog-account',               // id for the \"account\" container\r\n        settingsShareContainerId: 'pf-settings-dialog-share',                   // id for the \"share\" container\r\n\r\n        // captcha\r\n        captchaKeyUpdateAccount: 'SESSION.CAPTCHA.ACCOUNT.UPDATE',              // key for captcha reason\r\n        captchaImageWrapperId: 'pf-dialog-captcha-wrapper',                     // id for \"captcha image\" wrapper\r\n        captchaImageId: 'pf-dialog-captcha-image',                              // id for \"captcha image\"\r\n\r\n        loadingOptions: {                                                       // config for loading overlay\r\n            icon: {\r\n                size: 'fa-2x'\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * show \"register/settings\" dialog\r\n     * @returns {boolean}\r\n     */\r\n    $.fn.showSettingsDialog = function(){\r\n\r\n        // check if there are other dialogs open\r\n        var openDialogs = Util.getOpenDialogs();\r\n        if(openDialogs.length > 0){\r\n            return false;\r\n        }\r\n\r\n        requirejs(['text!templates/dialog/settings.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var data = {\r\n                id: config.settingsDialogId,\r\n                settingsAccountContainerId: config.settingsAccountContainerId,\r\n                settingsShareContainerId: config.settingsShareContainerId,\r\n                userData: Init.currentUserData,\r\n                captchaImageWrapperId: config.captchaImageWrapperId,\r\n                captchaImageId: config.captchaImageId,\r\n                formErrorContainerClass: Util.config.formErrorContainerClass,\r\n                ccpImageServer: Init.url.ccpImageServer\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var accountSettingsDialog = bootbox.dialog({\r\n                title: 'Account settings',\r\n                message: content,\r\n                buttons: {\r\n                    close: {\r\n                        label: 'cancel',\r\n                        className: 'btn-default'\r\n                    },\r\n                    success: {\r\n                        label: '<i class=\"fa fa-check fa-fw\"></i>&nbsp;save',\r\n                        className: 'btn-success',\r\n                        callback: function() {\r\n\r\n                            // get the current active form\r\n                            var form = $('#' + config.settingsDialogId).find('form').filter(':visible');\r\n\r\n                            // validate form\r\n                            form.validator('validate');\r\n\r\n                            // check whether the form is valid\r\n                            var formValid = form.isValidForm();\r\n\r\n                            if(formValid === true){\r\n                                var tabFormValues = form.getFormValues();\r\n\r\n                                // send Tab data and store values\r\n                                var requestData = {\r\n                                    formData: tabFormValues\r\n                                };\r\n\r\n                                accountSettingsDialog.find('.modal-content').showLoadingAnimation();\r\n\r\n                                $.ajax({\r\n                                    type: 'POST',\r\n                                    url: Init.path.saveUserConfig,\r\n                                    data: requestData,\r\n                                    dataType: 'json'\r\n                                }).done(function(responseData){\r\n                                    accountSettingsDialog.find('.modal-content').hideLoadingAnimation();\r\n\r\n                                    // set new captcha for any request\r\n                                    // captcha is required for sensitive data (not for all data)\r\n                                    if(\r\n                                        responseData.error &&\r\n                                        responseData.error.length > 0\r\n                                    ){\r\n                                        form.showFormMessage(responseData.error);\r\n\r\n                                        $('#' + config.captchaImageWrapperId).showCaptchaImage(config.captchaKeyUpdateAccount, function(){\r\n                                            $('#captcha').resetFormFields();\r\n                                        });\r\n                                    }else{\r\n                                        // store new/updated user data -> update head\r\n                                        if(responseData.userData){\r\n                                            Util.setCurrentUserData(responseData.userData);\r\n                                        }\r\n\r\n                                        form.find('.alert').velocity('transition.slideDownOut',{\r\n                                            duration: 500,\r\n                                            complete: function(){\r\n                                                $('#' + config.captchaImageWrapperId).showCaptchaImage(config.captchaKeyUpdateAccount, function(){\r\n                                                    $('#captcha').resetFormFields();\r\n                                                });\r\n                                            }\r\n                                        });\r\n\r\n                                        Util.showNotify({title: 'Account saved', type: 'success'});\r\n\r\n                                        // close dialog/menu\r\n                                        $(document).trigger('pf:closeMenu', [{}]);\r\n                                        accountSettingsDialog.modal('hide');\r\n                                    }\r\n\r\n                                }).fail(function( jqXHR, status, error) {\r\n                                    accountSettingsDialog.find('.modal-content').hideLoadingAnimation();\r\n\r\n                                    var reason = status + ' ' + error;\r\n                                    Util.showNotify({title: jqXHR.status + ': saveAccountSettings', text: reason, type: 'error'});\r\n\r\n                                    // set new captcha for any request\r\n                                    // captcha is required for sensitive data (not for all)\r\n                                    $('#' + config.captchaImageWrapperId).showCaptchaImage(config.captchaKeyUpdateAccount, function(){\r\n                                        $('#captcha').resetFormFields();\r\n                                    });\r\n\r\n                                    // check for DB errors\r\n                                    if(jqXHR.status === 500){\r\n\r\n                                        if(jqXHR.responseText){\r\n                                            var errorObj = $.parseJSON(jqXHR.responseText);\r\n\r\n                                            if(\r\n                                                errorObj.error &&\r\n                                                errorObj.error.length > 0\r\n                                            ){\r\n                                                form.showFormMessage(errorObj.error);\r\n                                            }\r\n                                        }\r\n                                    }\r\n\r\n                                    $(document).setProgramStatus('problem');\r\n\r\n                                });\r\n                            }\r\n\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            // after modal is shown =======================================================================\r\n            accountSettingsDialog.on('shown.bs.modal', function(e) {\r\n\r\n                var dialogElement = $(this);\r\n                var form = dialogElement.find('form');\r\n\r\n                // request captcha image and show\r\n                var captchaImageWrapperContainer = $('#' + config.captchaImageWrapperId);\r\n                captchaImageWrapperContainer.showCaptchaImage(config.captchaKeyUpdateAccount);\r\n\r\n                // init captcha refresh button\r\n                captchaImageWrapperContainer.find('i').on('click', function(){\r\n                    captchaImageWrapperContainer.showCaptchaImage(config.captchaKeyUpdateAccount);\r\n                });\r\n\r\n\r\n                // init dialog tooltips\r\n                dialogElement.initTooltips();\r\n\r\n                form.initFormValidation();\r\n            });\r\n\r\n            // events for tab change\r\n            accountSettingsDialog.find('.navbar a').on('shown.bs.tab', function(e){\r\n\r\n                // init \"toggle\" switches on current active tab\r\n                accountSettingsDialog.find( $(this).attr('href') ).find('input[type=\"checkbox\"]').bootstrapToggle({\r\n                    on: '<i class=\"fa fa-fw fa-check\"></i>&nbsp;Enable',\r\n                    off: 'Disable&nbsp;<i class=\"fa fa-fw fa-ban\"></i>',\r\n                    onstyle: 'success',\r\n                    offstyle: 'warning',\r\n                    width: 90,\r\n                    height: 30\r\n                });\r\n\r\n            });\r\n\r\n        });\r\n    };\r\n});\n",
    "/**\r\n *  map manual dialog\r\n */\r\n\r\ndefine('dialog/manual',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox',\r\n], function($, Init, Util, Render, bootbox) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n        // global dialog\r\n        dialogNavigationClass: 'pf-dialog-navigation-list',                     // class for dialog navigation bar\r\n        dialogNavigationListItemClass: 'pf-dialog-navigation-list-item',        // class for map manual li main navigation elements\r\n\r\n        // map manual dialog\r\n        mapManualScrollspyId: 'pf-manual-scrollspy'                             // id for map manual scrollspy\r\n    };\r\n\r\n    /**\r\n     * shows the map manual modal dialog\r\n     */\r\n    $.fn.showMapManual = function(){\r\n\r\n        requirejs(['text!templates/dialog/map_manual.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var data = {\r\n                dialogNavigationClass: config.dialogNavigationClass,\r\n                dialogNavLiClass: config.dialogNavigationListItemClass,\r\n                scrollspyId: config.mapManualScrollspyId,\r\n                pieChartClass : Init.classes.pieChart.pieChartMapCounterClass,\r\n                mapCounterClass : Init.classes.pieChart.pieChartMapCounterClass\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            // show dialog\r\n            var mapManualDialog = bootbox.dialog({\r\n                title: 'Manual',\r\n                message: content,\r\n                size: 'large',\r\n                buttons: {\r\n                    success: {\r\n                        label: 'close',\r\n                        className: 'btn-default',\r\n                        callback: function() {\r\n                            $(mapManualDialog).modal('hide');\r\n                        }\r\n                    }\r\n                },\r\n                show: true\r\n            });\r\n\r\n            // modal offset top\r\n            var modalOffsetTop = 200;\r\n\r\n            // disable on scroll event\r\n            var disableOnScrollEvent = false;\r\n\r\n            // scroll breakpoints\r\n            var scrolLBreakpointElements = null;\r\n            // scroll navigation links\r\n            var scrollNavLiElements = null;\r\n\r\n            mapManualDialog.on('shown.bs.modal', function(e) {\r\n                // modal on open\r\n                scrolLBreakpointElements = $('.pf-manual-scroll-break');\r\n                scrollNavLiElements = $('.' + config.dialogNavigationListItemClass);\r\n            });\r\n\r\n            var scrollspyElement = $('#' + config.mapManualScrollspyId);\r\n\r\n            var whileScrolling = function(){\r\n\r\n                if(disableOnScrollEvent === false){\r\n                    for(var i = 0; i < scrolLBreakpointElements.length; i++){\r\n                        var offset = $(scrolLBreakpointElements[i]).offset().top;\r\n\r\n                        if( (offset - modalOffsetTop) > 0){\r\n\r\n                            if(! $( scrollNavLiElements[i]).hasClass('active')){\r\n                                // remove all active classes\r\n                                scrollNavLiElements.removeClass('active');\r\n                                // remove focus on links\r\n                                scrollNavLiElements.find('a').blur();\r\n\r\n                                $( scrollNavLiElements[i]).addClass('active');\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            // init scrollbar\r\n            scrollspyElement.mCustomScrollbar({\r\n                axis: 'y',\r\n                theme: 'light-thick',\r\n                scrollInertia: 200,\r\n                autoExpandScrollbar: false,\r\n                scrollButtons:{\r\n                    scrollAmount: 30,\r\n                    enable: true\r\n                },\r\n                advanced: {\r\n                    updateOnBrowserResize: true,\r\n                    updateOnContentResize: true\r\n                },\r\n                callbacks:{\r\n                    onInit: function(){\r\n                        // init fake-map update counter\r\n                        scrollspyElement.find('.' + data.mapCounterClass).initMapUpdateCounter();\r\n\r\n                        // set navigation button observer\r\n                        var mainNavigationLinks = $('.' + config.dialogNavigationClass).find('a');\r\n                        // text anchor links\r\n                        var subNavigationLinks = scrollspyElement.find('a[data-target]');\r\n\r\n                        var navigationLinks = mainNavigationLinks.add(subNavigationLinks);\r\n\r\n                        navigationLinks.on('click', function(e){\r\n                            e.preventDefault();\r\n\r\n                            disableOnScrollEvent = true;\r\n\r\n                            // scroll to anchor\r\n                            scrollspyElement.mCustomScrollbar('scrollTo', $(this).attr('data-target'));\r\n\r\n                            var mainNavigationLiElement = $(this).parent('.' + config.dialogNavigationListItemClass);\r\n\r\n\r\n                            whileScrolling();\r\n\r\n                            // if link is a main navigation link (not an anchor link)\r\n\r\n                            if(mainNavigationLiElement.length > 0){\r\n                                // remove all active classes\r\n                                scrollNavLiElements.removeClass('active');\r\n\r\n                                // set new active class\r\n                                $(this).parent().addClass('active');\r\n                            }\r\n\r\n                        });\r\n\r\n                    },\r\n                    onScroll: function(){\r\n                        disableOnScrollEvent = false;\r\n\r\n                        whileScrolling();\r\n                    },\r\n                    whileScrolling: whileScrolling\r\n                },\r\n                mouseWheel:{\r\n                    enable: true,\r\n                    scrollAmount: 200,\r\n                    axis: 'y',\r\n                    preventDefault: true // do not scroll parent at the end\r\n                },\r\n                scrollbarPosition: 'outsite',\r\n                autoDraggerLength: true\r\n            });\r\n\r\n        });\r\n\r\n    };\r\n\r\n});\n",
    "/**\r\n *  map settings dialogs\r\n */\r\n\r\ndefine('dialog/map_settings',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox',\r\n    'app/map/util'\r\n], function($, Init, Util, Render, bootbox, MapUtil) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // map dialog\r\n        newMapDialogId: 'pf-map-dialog',                                                // id for map settings dialog\r\n        dialogMapCreateContainerId: 'pf-map-dialog-create',                             // id for the \"new map\" container\r\n        dialogMapEditContainerId: 'pf-map-dialog-edit',                                 // id for the \"edit\" container\r\n        dialogMapSettingsContainerId: 'pf-map-dialog-settings',                         // id for the \"settings\" container\r\n        dialogMapDownloadContainerId: 'pf-map-dialog-download',                         // id for the \"download\" container\r\n\r\n        characterSelectId: 'pf-map-dialog-character-select',                            // id for \"character\" select\r\n        corporationSelectId: 'pf-map-dialog-corporation-select',                        // id for \"corporation\" select\r\n        allianceSelectId: 'pf-map-dialog-alliance-select',                              // id for \"alliance\" select\r\n\r\n        dialogMapExportFormId: 'pf-map-dialog-form-export',                             // id for \"export\" form\r\n        dialogMapImportFormId: 'pf-map-dialog-form-import',                             // id for \"import\" form\r\n\r\n        buttonExportId: 'pf-map-dialog-button-export',                                  // id for \"export\" button\r\n        buttonImportId: 'pf-map-dialog-button-import',                                  // id for \"import\" button\r\n\r\n        fieldExportId: 'pf-map-filename-export',                                        // id for \"export\" filename field\r\n        fieldImportId: 'pf-map-filename-import',                                        // id for \"import\" filename field\r\n        dialogMapImportInfoId: 'pf-map-import-container',                               // id for \"info\" container\r\n        dragDropElementClass: 'pf-form-dropzone'                                        // class for \"drag&drop\" zone\r\n    };\r\n\r\n    /**\r\n     * format a given string into a valid filename\r\n     * @param filename\r\n     * @returns {string}\r\n     */\r\n    var formatFilename = function(filename){\r\n        filename = filename.replace(/[^a-zA-Z0-9]/g,'_');\r\n\r\n        var nowDate = new Date();\r\n        var filenameDate = nowDate.toISOString().slice(0,10).replace(/-/g, '_');\r\n\r\n        return  (filename + '_' + filenameDate).replace(/__/g,'_');\r\n    };\r\n\r\n    /**\r\n     * shows the add/edit map dialog\r\n     * @param mapData\r\n     * @param options\r\n     */\r\n    $.fn.showMapSettingsDialog = function(mapData, options){\r\n\r\n        // check if dialog is already open\r\n        var mapInfoDialogElement = $('#' + config.newMapDialogId);\r\n        if(!mapInfoDialogElement.is(':visible')){\r\n\r\n            requirejs([\r\n                'text!templates/dialog/map.html',\r\n                'text!templates/form/map_settings.html',\r\n                'mustache'\r\n            ], function(templateMapDialog, templateMapSettings, Mustache) {\r\n\r\n                var dialogTitle = 'Map settings';\r\n\r\n                // if there are no maps -> hide settings tab\r\n                var hideSettingsTab = false;\r\n                var hideEditTab = false;\r\n                var hideDownloadTab = false;\r\n\r\n                if(mapData === false){\r\n                    hideSettingsTab = true;\r\n                    hideEditTab = true;\r\n                    hideDownloadTab = true;\r\n                }\r\n\r\n                // available map \"types\" for a new or existing map\r\n                var mapTypes = MapUtil.getMapTypes(true);\r\n\r\n                var data = {\r\n                    scope: MapUtil.getMapScopes(),\r\n                    type: mapTypes,\r\n                    icon: MapUtil.getMapIcons(),\r\n                    formErrorContainerClass: Util.config.formErrorContainerClass,\r\n                    formWarningContainerClass: Util.config.formWarningContainerClass,\r\n                    formInfoContainerClass: Util.config.formInfoContainerClass\r\n                };\r\n\r\n                // render \"new map\" tab content -------------------------------------------\r\n                var contentNewMap = Mustache.render(templateMapSettings, data);\r\n\r\n                // render \"edit map\" tab content ------------------------------------------\r\n                var contentEditMap = Mustache.render(templateMapSettings, data);\r\n                contentEditMap = $(contentEditMap);\r\n\r\n                // current map access info\r\n                var accessCharacter = [];\r\n                var accessCorporation = [];\r\n                var accessAlliance = [];\r\n\r\n                if(mapData !== false){\r\n                    // set current map information\r\n                    contentEditMap.find('input[name=\"id\"]').val( mapData.config.id );\r\n                    contentEditMap.find('select[name=\"icon\"]').val( mapData.config.icon );\r\n                    contentEditMap.find('input[name=\"name\"]').val( mapData.config.name );\r\n                    contentEditMap.find('select[name=\"scopeId\"]').val( mapData.config.scope.id );\r\n                    contentEditMap.find('select[name=\"typeId\"]').val( mapData.config.type.id );\r\n\r\n                    accessCharacter = mapData.config.access.character;\r\n                    accessCorporation = mapData.config.access.corporation;\r\n                    accessAlliance = mapData.config.access.alliance;\r\n                }\r\n\r\n                // render main dialog -----------------------------------------------------\r\n                data = {\r\n                    id: config.newMapDialogId,\r\n                    mapData: mapData,\r\n                    type: mapTypes,\r\n\r\n                    // message container\r\n                    formErrorContainerClass: Util.config.formErrorContainerClass,\r\n                    formWarningContainerClass: Util.config.formWarningContainerClass,\r\n                    formInfoContainerClass: Util.config.formInfoContainerClass,\r\n\r\n                    // default open tab ----------\r\n                    openTabNew: options.tab === 'new',\r\n                    openTabEdit: options.tab === 'edit',\r\n                    openTabSettings: options.tab === 'settings',\r\n                    openTabDownload: options.tab === 'download',\r\n\r\n                    dialogMapCreateContainerId: config.dialogMapCreateContainerId,\r\n                    dialogMapEditContainerId: config.dialogMapEditContainerId,\r\n                    dialogMapSettingsContainerId: config.dialogMapSettingsContainerId,\r\n                    dialogMapDownloadContainerId: config.dialogMapDownloadContainerId,\r\n\r\n                    hideEditTab: hideEditTab,\r\n                    hideSettingsTab: hideSettingsTab,\r\n                    hideDownloadTab: hideDownloadTab,\r\n\r\n                    // settings tab --------------\r\n                    characterSelectId: config.characterSelectId,\r\n                    corporationSelectId: config.corporationSelectId,\r\n                    allianceSelectId: config.allianceSelectId,\r\n\r\n                    // map access objects --------\r\n                    accessCharacter: accessCharacter,\r\n                    accessCorporation: accessCorporation,\r\n                    accessAlliance: accessAlliance,\r\n\r\n                    // access limitations --------\r\n                    maxCharacter: Init.maxSharedCount.character,\r\n                    maxCorporation: Init.maxSharedCount.corporation,\r\n                    maxAlliance: Init.maxSharedCount.alliance,\r\n\r\n                    // download tab --------------\r\n                    dialogMapExportFormId: config.dialogMapExportFormId,\r\n                    dialogMapImportFormId: config.dialogMapImportFormId,\r\n                    buttonExportId: config.buttonExportId,\r\n                    buttonImportId: config.buttonImportId,\r\n                    fieldExportId: config.fieldExportId,\r\n                    fieldImportId: config.fieldImportId,\r\n                    dialogMapImportInfoId: config.dialogMapImportInfoId,\r\n\r\n                    formatFilename: function(){\r\n                        // format filename from \"map name\" (initial)\r\n                        return function (mapName, render) {\r\n                            var filename = render(mapName);\r\n                            return formatFilename(filename);\r\n                        };\r\n                    }\r\n                };\r\n\r\n                var contentDialog = Mustache.render(templateMapDialog, data);\r\n                contentDialog = $(contentDialog);\r\n\r\n                // set tab content\r\n                $('#' + config.dialogMapCreateContainerId, contentDialog).html(contentNewMap);\r\n                $('#' + config.dialogMapEditContainerId, contentDialog).html(contentEditMap);\r\n\r\n                var mapInfoDialog = bootbox.dialog({\r\n                    title: dialogTitle,\r\n                    message: contentDialog,\r\n                    buttons: {\r\n                        close: {\r\n                            label: 'cancel',\r\n                            className: 'btn-default'\r\n                        },\r\n                        success: {\r\n                            label: '<i class=\"fa fa-check fa-fw\"></i>&nbsp;save',\r\n                            className: 'btn-success',\r\n                            callback: function() {\r\n\r\n                                // get the current active form\r\n                                var form = $('#' + config.newMapDialogId).find('form').filter(':visible');\r\n\r\n                                // validate form\r\n                                form.validator('validate');\r\n\r\n                                // validate select2 fields (settings tab)\r\n                                form.find('select').each(function(){\r\n                                    var selectField = $(this);\r\n                                    var selectValues = selectField.val();\r\n\r\n                                    if(selectValues === null){\r\n                                        selectField.parents('.form-group').addClass('has-error');\r\n                                    }else{\r\n                                        selectField.parents('.form-group').removeClass('has-error');\r\n                                    }\r\n                                });\r\n\r\n                                // check whether the form is valid\r\n                                var formValid = form.isValidForm();\r\n\r\n                                if(formValid === true){\r\n\r\n                                    // lock dialog\r\n                                    var dialogContent = mapInfoDialog.find('.modal-content');\r\n                                    dialogContent.showLoadingAnimation();\r\n\r\n                                    var newMapData = {formData: form.getFormValues()};\r\n\r\n                                    $.ajax({\r\n                                        type: 'POST',\r\n                                        url: Init.path.saveMap,\r\n                                        data: newMapData,\r\n                                        dataType: 'json'\r\n                                    }).done(function(responseData){\r\n\r\n                                        dialogContent.hideLoadingAnimation();\r\n\r\n                                        if(responseData.error.length){\r\n                                            form.showFormMessage(responseData.error);\r\n                                        }else{\r\n                                            // success\r\n                                            Util.showNotify({title: dialogTitle, text: 'Map: ' + responseData.mapData.mapData.name, type: 'success'});\r\n\r\n                                            // update map-tab Element\r\n                                            var tabLinkElement = Util.getMapModule().getMapTabElements(responseData.mapData.mapData.id);\r\n                                            if(tabLinkElement.length === 1){\r\n                                                tabLinkElement.updateTabData(responseData.mapData.mapData);\r\n                                            }\r\n\r\n                                            $(mapInfoDialog).modal('hide');\r\n                                            $(document).trigger('pf:closeMenu', [{}]);\r\n                                        }\r\n                                    }).fail(function( jqXHR, status, error) {\r\n                                        var reason = status + ' ' + error;\r\n                                        Util.showNotify({title: jqXHR.status + ': saveMap', text: reason, type: 'warning'});\r\n                                        $(document).setProgramStatus('problem');\r\n\r\n                                    });\r\n                                }\r\n\r\n                                return false;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n\r\n                // after modal is shown =======================================================================\r\n                mapInfoDialog.on('shown.bs.modal', function(e){\r\n                    mapInfoDialog.initTooltips();\r\n\r\n                    // prevent \"disabled\" tabs from being clicked... \"bootstrap\" bugFix...\r\n                    mapInfoDialog.find('.navbar a[data-toggle=tab]').on('click', function(e){\r\n                        if ($(this).hasClass('disabled')){\r\n                            e.preventDefault();\r\n                            return false;\r\n                        }\r\n                    });\r\n\r\n                    // set form validator\r\n                    mapInfoDialog.find('form').initFormValidation();\r\n\r\n                    // show form messages -------------------------------------\r\n                    // get current active form(tab)\r\n                    var form = $('#' + config.newMapDialogId).find('form').filter(':visible');\r\n\r\n                    form.showFormMessage([{type: 'info', message: 'Creating new maps or change settings may take a few seconds'}]);\r\n\r\n                    if(mapData === false){\r\n                        // no map data found (probably new user\r\n                        form.showFormMessage([{type: 'warning', message: 'No maps found. Create a new map before you can start'}]);\r\n                    }\r\n\r\n                    // init select fields in case \"settings\" tab is open by default\r\n                    if(options.tab === 'settings'){\r\n                        initSettingsSelectFields(mapInfoDialog);\r\n                    }\r\n\r\n                    // init \"download tab\" ========================================================================\r\n                    var downloadTabElement = mapInfoDialog.find('#' + config.dialogMapDownloadContainerId);\r\n                    if(downloadTabElement.length){\r\n                        // tab exists\r\n\r\n                        // export map data ------------------------------------------------------------------------\r\n                        downloadTabElement.find('#' + config.buttonExportId).on('click', { mapData: mapData }, function(e){\r\n\r\n                            var exportForm = $('#' + config.dialogMapExportFormId);\r\n                            var validExportForm = exportForm.isValidForm();\r\n\r\n                            if(validExportForm){\r\n                                var mapElement = Util.getMapModule().getActiveMap();\r\n\r\n                                if(mapElement){\r\n                                    // IMPORTANT: Get map data from client (NOT from global mapData which is available in here)\r\n                                    // -> This excludes some data (e.g. wh statics)\r\n                                    // -> Bring export inline with main map toggle requests\r\n                                    var exportMapData = mapElement.getMapDataFromClient({\r\n                                        forceData: true,\r\n                                        getAll: true\r\n                                    });\r\n\r\n                                    // set map data right before download\r\n                                    $(this).setExportMapData(exportMapData);\r\n\r\n                                    // disable button\r\n                                    $(this).attr('disabled', true);\r\n                                }else{\r\n                                    console.error('Map not found');\r\n                                }\r\n                            }else{\r\n                                e.preventDefault();\r\n                            }\r\n                        });\r\n\r\n                        // import map data ------------------------------------------------------------------------\r\n                        // check if \"FileReader\" API is supported\r\n                        var importFormElement = downloadTabElement.find('#' + config.dialogMapImportFormId);\r\n                        if(window.File && window.FileReader && window.FileList && window.Blob){\r\n\r\n                            // show file info in UI\r\n                            downloadTabElement.find('#' + config.fieldImportId).on('change', function(e){\r\n                                e.stopPropagation();\r\n                                e.preventDefault();\r\n\r\n                                var infoContainerElement = importFormElement.find('#' + config.dialogMapImportInfoId);\r\n                                infoContainerElement.hide().empty();\r\n                                importFormElement.hideFormMessage('all');\r\n\r\n                                var output = [];\r\n                                var files = e.target.files;\r\n\r\n                                for (var i = 0, f; !!(f = files[i]); i++) {\r\n                                    output.push(( i + 1 ) + '. file: ' + f.name + ' - ' +\r\n                                        f.size + ' bytes; last modified: ' +\r\n                                        f.lastModifiedDate.toLocaleDateString() );\r\n                                }\r\n\r\n                                if(output.length > 0){\r\n                                    infoContainerElement.html( output ).show();\r\n                                }\r\n\r\n                                importFormElement.validator('validate');\r\n                            });\r\n\r\n                            // drag&drop\r\n                            var importData = {};\r\n                            importData.mapData = [];\r\n                            var files = [];\r\n                            var filesCount = 0;\r\n                            var filesCountFail = 0;\r\n\r\n                            // onLoad for FileReader API\r\n                            var readerOnLoad = function(readEvent) {\r\n\r\n                                // get file content\r\n                                try{\r\n                                    importData.mapData.push( JSON.parse( readEvent.target.result ) );\r\n                                }catch(error){\r\n                                    filesCountFail++;\r\n                                    importFormElement.showFormMessage([{type: 'error', message: 'File can not be parsed'}]);\r\n                                }\r\n\r\n                                // start import when all files are parsed\r\n                                if(\r\n                                    filesCount === files.length &&\r\n                                    filesCountFail === 0\r\n                                ){\r\n                                    importMaps(importData);\r\n                                }\r\n                            };\r\n\r\n                            var handleDragOver = function(dragEvent) {\r\n                                dragEvent.stopPropagation();\r\n                                dragEvent.preventDefault();\r\n                                dragEvent.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.\r\n                            };\r\n\r\n                            var handleFileSelect = function(evt){\r\n                                evt.stopPropagation();\r\n                                evt.preventDefault();\r\n\r\n                                importData = importFormElement.getFormValues();\r\n                                importData.mapData = [];\r\n                                filesCount = 0;\r\n                                filesCountFail = 0;\r\n\r\n                                files = evt.dataTransfer.files; // FileList object.\r\n\r\n                                for (var file; !!(file = files[filesCount]); filesCount++){\r\n                                    var reader = new FileReader();\r\n                                    reader.onload = readerOnLoad;\r\n                                    reader.readAsText(file);\r\n                                }\r\n                            };\r\n\r\n                            var dropZone = downloadTabElement.find('.' + config.dragDropElementClass);\r\n                            dropZone[0].addEventListener('dragover', handleDragOver, false);\r\n                            dropZone[0].addEventListener('drop', handleFileSelect, false);\r\n\r\n                            // import \"button\"\r\n                            downloadTabElement.find('#' + config.buttonImportId).on('click', function(e) {\r\n\r\n                                importFormElement.validator('validate');\r\n                                var validImportForm = importFormElement.isValidForm();\r\n\r\n                                if(validImportForm){\r\n                                    importData = importFormElement.getFormValues();\r\n                                    importData.mapData = [];\r\n\r\n                                    var fileElement = downloadTabElement.find('#' + config.fieldImportId);\r\n                                    files = fileElement[0].files;\r\n                                    filesCount = 0;\r\n                                    filesCountFail = 0;\r\n\r\n                                    for (var file; !!(file = files[filesCount]); filesCount++){\r\n                                        var reader = new FileReader();\r\n                                        reader.onload = readerOnLoad;\r\n                                        reader.readAsText(file);\r\n                                    }\r\n                                }\r\n                            });\r\n                        }else{\r\n                            importFormElement.showFormMessage([{type: 'error', message: 'The File APIs are not fully supported in this browser.'}]);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // events for tab change\r\n                mapInfoDialog.find('.navbar a').on('shown.bs.tab', function(e){\r\n                    var selectElementCharacter = mapInfoDialog.find('#' + config.characterSelectId);\r\n                    var selectElementCorporation = mapInfoDialog.find('#' + config.corporationSelectId);\r\n                    var selectElementAlliance = mapInfoDialog.find('#' + config.allianceSelectId);\r\n\r\n                    if($(e.target).attr('href') === '#' + config.dialogMapSettingsContainerId){\r\n                        // \"settings\" tab\r\n                        initSettingsSelectFields(mapInfoDialog);\r\n                    }else{\r\n                        if( $(selectElementCharacter).data('select2') !== undefined ){\r\n                            $(selectElementCharacter).select2('destroy');\r\n                        }\r\n\r\n                        if( $(selectElementCorporation).data('select2') !== undefined ){\r\n                            $(selectElementCorporation).select2('destroy');\r\n                        }\r\n\r\n                        if( $(selectElementAlliance).data('select2') !== undefined ){\r\n                            $(selectElementAlliance).select2('destroy');\r\n                        }\r\n                    }\r\n\r\n                    // no \"save\" dialog  button on \"in/export\" tab\r\n                    if($(e.target).attr('href') === '#' + config.dialogMapDownloadContainerId){\r\n                        mapInfoDialog.find('button.btn-success').hide();\r\n                    }else{\r\n                        mapInfoDialog.find('button.btn-success').show();\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * import new map(s) data\r\n     * @param importData\r\n     */\r\n    var importMaps = function(importData){\r\n\r\n        var importForm = $('#' + config.dialogMapImportFormId);\r\n        importForm.hideFormMessage('all');\r\n\r\n        // lock dialog\r\n        var dialogContent = importForm.parents('.modal-content');\r\n        dialogContent.showLoadingAnimation();\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.importMap,\r\n            data: importData,\r\n            dataType: 'json'\r\n        }).done(function(responseData){\r\n            if(responseData.error.length){\r\n                //   form.showFormMessage(responseData.error);\r\n                importForm.showFormMessage(responseData.error);\r\n            }else{\r\n                // success\r\n\r\n                Util.showNotify({title: 'Import finished', text: 'Map(s) imported', type: 'success'});\r\n            }\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            Util.showNotify({title: jqXHR.status + ': importMap', text: reason, type: 'error'});\r\n        }).always(function() {\r\n            importForm.find('input, select').resetFormFields().trigger('change');\r\n            dialogContent.hideLoadingAnimation();\r\n        });\r\n    };\r\n\r\n    /**\r\n     * set json map data for export to an element (e.g. <a>-Tag or button) for download\r\n     * @param mapData\r\n     * @returns {*}\r\n     */\r\n    $.fn.setExportMapData = function(mapData){\r\n\r\n        var fieldExport = $('#' + config.fieldExportId);\r\n        var filename = '';\r\n        var mapDataEncoded = '';\r\n\r\n        if(fieldExport.length){\r\n            filename = fieldExport.val();\r\n\r\n            if(filename.length > 0){\r\n                mapDataEncoded = 'text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify( mapData ));\r\n            }\r\n        }\r\n\r\n        return this.each(function(){\r\n            var exportButton = $(this);\r\n            exportButton.attr('href', 'data:' + mapDataEncoded);\r\n            exportButton.attr('download', filename + '.json');\r\n        });\r\n    };\r\n\r\n\r\n    /**\r\n     * init select2 fields within the settings dialog\r\n     * @param mapInfoDialog\r\n     */\r\n    var initSettingsSelectFields = function(mapInfoDialog){\r\n\r\n        var selectElementCharacter = mapInfoDialog.find('#' + config.characterSelectId);\r\n        var selectElementCorporation = mapInfoDialog.find('#' + config.corporationSelectId);\r\n        var selectElementAlliance = mapInfoDialog.find('#' + config.allianceSelectId);\r\n\r\n        // init character select live search\r\n        selectElementCharacter.initAccessSelect({\r\n            type: 'character',\r\n            maxSelectionLength: Init.maxSharedCount.character\r\n        });\r\n\r\n        // init corporation select live search\r\n        selectElementCorporation.initAccessSelect({\r\n            type: 'corporation',\r\n            maxSelectionLength: Init.maxSharedCount.corporation\r\n        });\r\n\r\n        // init alliance select live search\r\n        selectElementAlliance.initAccessSelect({\r\n            type: 'alliance',\r\n            maxSelectionLength: Init.maxSharedCount.alliance\r\n        });\r\n    };\r\n\r\n    /**\r\n     * shows the delete map Dialog\r\n     * @param mapData\r\n     */\r\n    $.fn.showDeleteMapDialog = function(mapData){\r\n\r\n        var mapName = mapData.config.name;\r\n\r\n        var mapDeleteDialog = bootbox.confirm('Delete map \"' + mapName + '\"?', function(result){\r\n            if(result){\r\n\r\n                var data = {mapData: mapData.config};\r\n\r\n                $.ajax({\r\n                    type: 'POST',\r\n                    url: Init.path.deleteMap,\r\n                    data: data,\r\n                    dataType: 'json'\r\n                }).done(function(data){\r\n                    Util.showNotify({title: 'Map deleted', text: 'Map: ' + mapName, type: 'success'});\r\n\r\n                    $(mapDeleteDialog).modal('hide');\r\n                }).fail(function( jqXHR, status, error) {\r\n                    var reason = status + ' ' + error;\r\n                    Util.showNotify({title: jqXHR.status + ': deleteMap', text: reason, type: 'warning'});\r\n                    $(document).setProgramStatus('problem');\r\n                });\r\n\r\n                return false;\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n});\n",
    "/**\r\n *  system effects dialog\r\n */\r\n\r\n\r\ndefine('dialog/system_effects',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox',\r\n    'app/map/util'\r\n], function($, Init, Util, Render, bootbox, MapUtil) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // system effect dialog\r\n        systemEffectDialogWrapperClass: 'pf-system-effect-dialog-wrapper'       // class for system effect dialog\r\n    };\r\n\r\n    var cache = {\r\n        systemEffectDialog: false                                               // system effect info dialog\r\n    };\r\n\r\n    /**\r\n     * show system effect dialog\r\n     */\r\n    $.fn.showSystemEffectInfoDialog = function(){\r\n\r\n        // cache table structure\r\n        if(!cache.systemEffectDialog){\r\n\r\n            var dialogWrapperElement = $('<div>', {\r\n                class: config.systemEffectDialogWrapperClass\r\n            });\r\n\r\n            var systemEffectData = Util.getSystemEffectData();\r\n\r\n            $.each( systemEffectData.wh, function( effectName, effectData ) {\r\n\r\n                var table = $('<table>', {\r\n                    class: ['table', 'table-condensed'].join(' ')\r\n                });\r\n\r\n                var tbody = $('<tbody>');\r\n                var thead = $('<thead>');\r\n\r\n                var rows = [];\r\n\r\n                // get formatted system effect name\r\n                var systemEffectName = MapUtil.getEffectInfoForSystem(effectName, 'name');\r\n                var systemEffectClass = MapUtil.getEffectInfoForSystem(effectName, 'class');\r\n\r\n                $.each( effectData, function( areaId, areaData ) {\r\n\r\n                    var systemType = 'C' + areaId;\r\n                    var securityClass = Util.getSecurityClassForSystem( systemType );\r\n\r\n                    if(areaId === '1'){\r\n                        rows.push( $('<tr>') );\r\n                        thead.append( rows[0] );\r\n\r\n                        rows[0].append(\r\n                            $('<td>').html( '&nbsp;&nbsp;' + systemEffectName).prepend(\r\n                                $('<i>', {\r\n                                    class: ['fa', 'fa-square', 'fa-fw', systemEffectClass].join(' ')\r\n                                })\r\n                            )\r\n                        );\r\n                    }\r\n\r\n                    rows[0].append( $('<td>', {\r\n                        class: ['text-right', 'col-xs-1', securityClass].join(' ')\r\n                    }).text( systemType ));\r\n\r\n                    $.each( areaData, function( i, data ) {\r\n\r\n                        if(areaId === '1'){\r\n                            rows.push( $('<tr>') );\r\n                            tbody.append(rows[i + 1]);\r\n\r\n                            // add label\r\n                            rows[i + 1].append( $('<td>').text( data.effect ));\r\n                        }\r\n\r\n\r\n                        rows[i + 1].append( $('<td>', {\r\n                            class: 'text-right'\r\n                        }).text( data.value ));\r\n                    });\r\n\r\n\r\n                });\r\n\r\n                dialogWrapperElement.append( table.append( thead ).append( tbody ) );\r\n\r\n                cache.systemEffectDialog = dialogWrapperElement;\r\n            });\r\n        }\r\n\r\n        bootbox.dialog({\r\n            title: 'System effect information',\r\n            message: cache.systemEffectDialog\r\n        });\r\n\r\n    };\r\n});\n",
    "/**\r\n *  jump info dialog\r\n */\r\n\r\ndefine('dialog/jump_info',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox',\r\n], function($, Init, Util, Render, bootbox) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // jump info dialog\r\n        jumpInfoDialogClass: 'pf-jump-info-dialog'                              // class for jump info dialog\r\n    };\r\n\r\n    /**\r\n     * show jump info dialog\r\n     */\r\n    $.fn.showJumpInfoDialog = function(){\r\n\r\n        requirejs(['text!templates/dialog/jump_info.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var data = {};\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var signatureReaderDialog = bootbox.dialog({\r\n                className: config.jumpInfoDialogClass,\r\n                title: 'Wormhole jump information',\r\n                message: content\r\n            });\r\n\r\n        });\r\n\r\n    };\r\n});\n",
    "/**\r\n * delete account dialog\r\n */\r\n\r\ndefine('dialog/delete_account',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'bootbox'\r\n], function($, Init, Util, bootbox) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // global dialog\r\n        deleteAccountId: 'pf-dialog-delete-account',                            // dialog id\r\n\r\n        // captcha\r\n        captchaKeyDeleteAccount: 'SESSION.CAPTCHA.ACCOUNT.DELETE',              // key for captcha reason\r\n        captchaImageWrapperId: 'pf-dialog-captcha-wrapper'                      // id for \"captcha image\" wrapper\r\n    };\r\n\r\n    /**\r\n     * shows delete account dialog\r\n     */\r\n    $.fn.showDeleteAccountDialog = function(){\r\n\r\n\r\n        requirejs(['text!templates/dialog/delete_account.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var data = {\r\n                deleteAccountId: config.deleteAccountId,\r\n                userData: Util.getCurrentUserData(),\r\n                captchaImageWrapperId: config.captchaImageWrapperId,\r\n                formErrorContainerClass: Util.config.formErrorContainerClass\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var deleteAccountDialog = bootbox.dialog({\r\n                title: 'Delete account',\r\n                message: content,\r\n                buttons: {\r\n                    close: {\r\n                        label: 'cancel',\r\n                        className: 'btn-default'\r\n                    },\r\n                    success: {\r\n                        label: '<i class=\"fa fa-user-times fa-fw\"></i>&nbsp;delete account',\r\n                        className: 'btn-danger',\r\n                        callback: function() {\r\n                            var dialogElement = $(this);\r\n                            var form = dialogElement.find('form');\r\n\r\n                            // validate form\r\n                            form.validator('validate');\r\n                            var formValid = form.isValidForm();\r\n\r\n                            if(formValid){\r\n\r\n                                var formValues = form.getFormValues();\r\n\r\n                                if(! $.isEmptyObject(formValues) ){\r\n                                    // send Tab data and store values\r\n                                    var requestData = {\r\n                                        formData: formValues\r\n                                    };\r\n\r\n                                    dialogElement.find('.modal-content').showLoadingAnimation();\r\n\r\n                                    $.ajax({\r\n                                        type: 'POST',\r\n                                        url: Init.path.deleteAccount,\r\n                                        data: requestData,\r\n                                        dataType: 'json'\r\n                                    }).done(function(responseData){\r\n                                        dialogElement.find('.modal-content').hideLoadingAnimation();\r\n\r\n                                        if(responseData.reroute !== undefined){\r\n                                            Util.redirect(responseData.reroute, []);\r\n                                        }else if(\r\n                                            responseData.error &&\r\n                                            responseData.error.length > 0\r\n                                        ){\r\n                                            form.showFormMessage(responseData.error);\r\n\r\n                                            $('#' + config.captchaImageWrapperId).showCaptchaImage(config.captchaKeyDeleteAccount, function(){\r\n                                                form.find('[name=\"captcha\"]').resetFormFields();\r\n                                            });\r\n                                        }\r\n\r\n                                    }).fail(function( jqXHR, status, error) {\r\n                                        dialogElement.find('.modal-content').hideLoadingAnimation();\r\n\r\n                                        var reason = status + ' ' + error;\r\n                                        Util.showNotify({title: jqXHR.status + ': deleteAccount', text: reason, type: 'error'});\r\n\r\n                                    });\r\n                                }\r\n                            }\r\n\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            // after modal is shown =======================================================================\r\n            deleteAccountDialog.on('shown.bs.modal', function(e) {\r\n                // request captcha image and show\r\n                $('#' + config.captchaImageWrapperId).showCaptchaImage(config.captchaKeyDeleteAccount);\r\n            });\r\n\r\n        });\r\n\r\n    };\r\n});\n",
    "/*\r\n * Lazy Line Painter\r\n * SVG Stroke animation.\r\n *\r\n * https://github.com/camoconnell/lazy-line-painter\r\n * http://www.camoconnell.com\r\n *\r\n * Licensed under the MIT license.\r\n *\r\n */\r\n(function(e){var g={init:function(a){return this.each(function(){var b=e(this),c=b.data(\"lazyLinePainter\");b.addClass(\"lazy-line\");if(!c){var c=e.extend({width:null,height:null,strokeWidth:2,strokeColor:\"#000\",strokeOverColor:null,strokeCap:\"round\",strokeJoin:\"round\",strokeOpacity:1,arrowEnd:\"none\",onComplete:null,onStart:null,delay:null,overrideKey:null,drawSequential:!0,speedMultiplier:1,reverse:!1,responsive:!1},a),d=c.overrideKey?c.overrideKey:b.attr(\"id\").replace(\"#\",\"\"),f=c.svgData[d].dimensions.width,\r\nl=c.svgData[d].dimensions.height;c.svgData=c.svgData[d].strokepath;null===c.width&&(c.width=f);null===c.height&&(c.height=l);c.responsive||b.css({width:c.width,height:c.height});d=\"0 0 \"+f+\" \"+l;f=document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\");f.setAttributeNS(null,\"viewBox\",d);f.setAttribute(\"xmlns\",\"http://www.w3.org/2000/svg\");c.svg=e(f);b.append(c.svg);b.data(\"lazyLinePainter\",c)}})},paint:function(){return this.each(function(){var a=e(this).data(\"lazyLinePainter\"),b=function(){a.paths=\r\n[];a.longestDuration=0;for(var b=a.playhead=0,d=0,f=0,d=0;d<a.svgData.length;d++)b=a.svgData[d].duration*a.speedMultiplier,f+=b;for(d=0;d<a.svgData.length;d++){var e=m(a,d),h=e.getTotalLength();e.style.strokeDasharray=h+\" \"+h;e.style.strokeDashoffset=h;e.style.display=\"block\";e.getBoundingClientRect();b=a.svgData[d].duration*a.speedMultiplier;b>a.longestDuration&&(a.longestDuration=b);var g;g=a.reverse?f-=b:a.playhead;a.paths.push({duration:b,drawStartTime:g,path:e,length:h});a.playhead+=b}a.totalDuration=\r\na.drawSequential?a.playhead:a.longestDuration;a.rAF=requestAnimationFrame(function(b){k(b,a)});if(null!==a.onStart)a.onStart()};null===a.delay?b():setTimeout(b,a.delay)})},pauseResume:function(){return this.each(function(){var a=e(this).data(\"lazyLinePainter\");a.paused?(a.paused=!1,requestAnimationFrame(function(b){n(b,a)})):(a.paused=!0,cancelAnimationFrame(a.rAF))})},erase:function(){return this.each(function(){var a=e(this).data(\"lazyLinePainter\");a.startTime=null;a.elapsedTime=null;cancelAnimationFrame(a.rAF);\r\na.svg.empty()})},destroy:function(){return this.each(function(){var a=e(this);a.removeData(\"lazyLinePainter\");a.remove()})}},n=function(a,b){b.startTime=a-b.elapsedTime;requestAnimationFrame(function(a){k(a,b)})},k=function(a,b){b.startTime||(b.startTime=a);b.elapsedTime=a-b.startTime;for(var c=0;c<b.paths.length;c++){var d;b.drawSequential?(d=b.elapsedTime-b.paths[c].drawStartTime,0>d&&(d=0)):d=b.elapsedTime;d<b.paths[c].duration&&0<d?(d=d/b.paths[c].duration*b.paths[c].length,b.paths[c].path.style.strokeDashoffset=\r\nb.reverse||b.svgData[c].reverse?-b.paths[c].length+d:b.paths[c].length-d):d>b.paths[c].duration&&(b.paths[c].path.style.strokeDashoffset=0)}if(b.elapsedTime<b.totalDuration)b.rAF=requestAnimationFrame(function(a){k(a,b)});else if(null!==b.onComplete)b.onComplete()},m=function(a,b){var c=document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),d=e(c);a.svg.append(d);d.attr(p(a,a.svgData[b]));return c},p=function(a,b){return{d:b.path,stroke:b.strokeColor?b.strokeColor:a.strokeColor,\"fill-opacity\":0,\r\n\"stroke-opacity\":b.strokeOpacity?b.strokeOpacity:a.strokeOpacity,\"stroke-width\":b.strokeWidth?b.strokeWidth:a.strokeWidth,\"stroke-linecap\":b.strokeCap?b.strokeCap:a.strokeCap,\"stroke-linejoin\":b.strokeJoin?b.strokeJoin:a.strokeJoin}};e.fn.lazylinepainter=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,1));if(\"object\"!==typeof a&&a)console.log(\"opps - issue finding method\");else return g.init.apply(this,arguments)}})(jQuery);\ndefine(\"lazylinepainter\", [\"jquery\",\"bootstrap\"], function(){});\n\n",
    "/**\r\n * Logo\r\n */\r\n\r\ndefine('app/ui/logo',[\r\n    'jquery',\r\n    'lazylinepainter'\r\n], function($) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n\r\n        staticLogoId: 'pf-static-logo-svg',                                     // id for \"static\" logo\r\n\r\n        logoPartTopRightClass: 'logo-ploygon-top-right',                        // class for logo part \"top right\"\r\n        logoPartBottomLeftClass: 'logo-ploygon-bottom-left',                    // class for logo part \"bottom left\"\r\n        logoPartBottomRightClass: 'logo-ploygon-bottom-right',                  // class for logo part \"bottom right\"\r\n        logoPartTopLeftClass: 'logo-ploygon-top-left'\r\n    };\r\n\r\n\r\n    /**\r\n     * draws the pathfinder logo to an element and add some animation features\r\n     * @param callback\r\n     * @param enableHover\r\n     */\r\n    $.fn.drawLogo = function(callback, enableHover){\r\n        var canvasElement = $(this);\r\n\r\n        var pathObj = {\r\n            logo: {\r\n                strokepath: [\r\n                    {\r\n                        path: 'M195.9 9.6 226.9 297.1 354.2 365 196.2 9.8 ',\r\n                        strokeColor: '#477372',\r\n                        duration: 1600\r\n                    },\r\n                    {\r\n                        path: 'M1.7 361.3 73.9 284.9 178.6 286.7 2.2 361.4 ',\r\n                        strokeColor: '#5cb85c',\r\n                        duration: 1000\r\n                    },\r\n                    {\r\n                        path: 'M192.9 286.7 121.2 318.6 335.6 363.5 193.4 286.7 ',\r\n                        strokeColor: '#375959',\r\n                        duration: 900\r\n                    },\r\n                    {\r\n                        path: 'M202.8 141.9 0.2 352.6 189.1 0.8 202.7 141.3 ',\r\n                        strokeColor: '#63676a',\r\n                        duration: 1500\r\n                    }\r\n                ],\r\n                dimensions: {\r\n                    width: 355,\r\n                    height: 366\r\n                }\r\n            }\r\n        };\r\n\r\n        // load Logo svg\r\n        requirejs(['text!templates/ui/logo.html', 'mustache'], function(template, Mustache) {\r\n            var logoData = {\r\n                staticLogoId: config.staticLogoId,\r\n                logoPartTopRightClass: config.logoPartTopRightClass,\r\n                logoPartBottomLeftClass: config.logoPartBottomLeftClass,\r\n                logoPartBottomRightClass: config.logoPartBottomRightClass,\r\n                logoPartTopLeftClass: config.logoPartTopLeftClass\r\n            };\r\n\r\n            var logoContent = Mustache.render(template, logoData);\r\n\r\n            canvasElement.html(logoContent);\r\n\r\n            // draw the logo\r\n            canvasElement.lazylinepainter(\r\n                {\r\n                    svgData: pathObj,\r\n                    strokeWidth: 2,\r\n                    drawSequential: false,\r\n                    delay: 300,\r\n                    overrideKey: 'logo',\r\n                    strokeJoin: 'bevel',\r\n                    onComplete: function(){\r\n\r\n                        // hide lines\r\n                        canvasElement.find('svg:not(#' + config.staticLogoId + ')').velocity({\r\n                            opacity: 0\r\n                        },{\r\n                            delay: 100\r\n                        });\r\n\r\n                        // show full logo\r\n                        canvasElement.find('#' + config.staticLogoId + '').velocity({\r\n                            opacity: 1\r\n                        },{\r\n                            delay: 100,\r\n                            duration: 200,\r\n                            complete: function(){\r\n\r\n                                // execute callback\r\n                                if(typeof callback === 'function'){\r\n                                    callback();\r\n                                }\r\n\r\n                                // init logo animation\r\n                                if(enableHover === true){\r\n                                    var logoElements = $('#' + config.staticLogoId + ' path');\r\n\r\n                                    var animate = [];\r\n                                    logoElements.on('mouseover', function(e){\r\n                                        var currentLogoElement = $(e.target);\r\n                                        var currentLogoElementIndex = logoElements.index(currentLogoElement);\r\n\r\n                                        var animationXValue = currentLogoElement.attr('data-animationX');\r\n                                        var animationYValue = currentLogoElement.attr('data-animationY');\r\n\r\n                                        var animationConfig = {};\r\n                                        animationConfig.opacity = [1, 1];\r\n                                        animationConfig.translateZ = [0, 0];\r\n                                        animationConfig.translateX = [animationXValue, 0 ];\r\n                                        animationConfig.translateY = [animationYValue, 0];\r\n\r\n                                        if(animate[currentLogoElementIndex] !== false){\r\n                                            $(this).velocity(animationConfig,{\r\n                                                duration: 120,\r\n                                                begin: function(){\r\n                                                    animate[currentLogoElementIndex] = false;\r\n                                                }\r\n                                            }).velocity('reverse',{\r\n                                                delay: 240,\r\n                                                complete: function(){\r\n                                                    animate[currentLogoElementIndex] = true;\r\n                                                }\r\n                                            });\r\n                                        }\r\n\r\n                                    });\r\n                                }\r\n\r\n\r\n                            }\r\n                        });\r\n                    }\r\n                }).lazylinepainter('paint');\r\n        });\r\n    };\r\n\r\n});\n",
    "/**\r\n *  credits dialog\r\n */\r\n\r\ndefine('dialog/credit',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox',\r\n    'app/ui/logo'\r\n], function($, Init, Util, Render, bootbox) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // jump info dialog\r\n        creditsDialogClass: 'pf-credits-dialog',                                // class for credits dialog\r\n        creditsDialogLogoContainerId: 'pf-logo-container'                       // id for logo element\r\n    };\r\n\r\n    /**\r\n     * show jump info dialog\r\n     */\r\n    $.fn.showCreditsDialog = function(callback, enableHover){\r\n\r\n        requirejs(['text!templates/dialog/credit.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var data = {\r\n                logoContainerId: config.creditsDialogLogoContainerId,\r\n                version: $('body').data('version')\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var creditDialog = bootbox.dialog({\r\n                className: config.creditsDialogClass,\r\n                title: 'Licence',\r\n                message: content\r\n            });\r\n\r\n            // after modal is shown =======================================================================\r\n            creditDialog.on('shown.bs.modal', function(e) {\r\n\r\n                // load Logo svg\r\n                creditDialog.find('#' + config.creditsDialogLogoContainerId).drawLogo(callback, enableHover);\r\n            });\r\n\r\n        });\r\n\r\n    };\r\n});\n",
    "// -----------------------------------\r\n// Slidebars\r\n// Version 0.10\r\n// http://plugins.adchsm.me/slidebars/\r\n//\r\n// Written by Adam Smith\r\n// http://www.adchsm.me/\r\n//\r\n// Released under MIT License\r\n// http://plugins.adchsm.me/slidebars/license.txt\r\n//\r\n// ---------------------\r\n// Index of Slidebars.js\r\n//\r\n// 001 - Default Settings\r\n// 002 - Feature Detection\r\n// 003 - User Agents\r\n// 004 - Setup\r\n// 005 - Animation\r\n// 006 - Operations\r\n// 007 - API\r\n// 008 - User Input\r\n\r\n;(function($) {\r\n\r\n\t$.slidebars = function(options) {\r\n\r\n\t\t// ----------------------\r\n\t\t// 001 - Default Settings\r\n\r\n\t\tvar settings = $.extend({\r\n\t\t\tsiteClose: true, // true or false - Enable closing of Slidebars by clicking on #sb-site.\r\n\t\t\tscrollLock: false, // true or false - Prevent scrolling of site when a Slidebar is open.\r\n\t\t\tdisableOver: false, // integer or false - Hide Slidebars over a specific width.\r\n\t\t\thideControlClasses: false // true or false - Hide controls at same width as disableOver.\r\n\t\t}, options);\r\n\r\n\t\t// -----------------------\r\n\t\t// 002 - Feature Detection\r\n\r\n\t\tvar test = document.createElement('div').style, // Create element to test on.\r\n\t\tsupportTransition = false, // Variable for testing transitions.\r\n\t\tsupportTransform = false; // variable for testing transforms.\r\n\r\n\t\t// Test for CSS Transitions\r\n\t\tif (test.MozTransition === '' || test.WebkitTransition === '' || test.OTransition === '' || test.transition === '') supportTransition = true;\r\n\r\n\t\t// Test for CSS Transforms\r\n\t\tif (test.MozTransform === '' || test.WebkitTransform === '' || test.OTransform === '' || test.transform === '') supportTransform = true;\r\n\r\n\t\t// -----------------\r\n\t\t// 003 - User Agents\r\n\r\n\t\tvar ua = navigator.userAgent, // Get user agent string.\r\n\t\tandroid = false, // Variable for storing android version.\r\n\t\tiOS = false; // Variable for storing iOS version.\r\n\t\t\r\n\t\tif (/Android/.test(ua)) { // Detect Android in user agent string.\r\n\t\t\tandroid = ua.substr(ua.indexOf('Android')+8, 3); // Set version of Android.\r\n\t\t} else if (/(iPhone|iPod|iPad)/.test(ua)) { // Detect iOS in user agent string.\r\n\t\t\tiOS = ua.substr(ua.indexOf('OS ')+3, 3).replace('_', '.'); // Set version of iOS.\r\n\t\t}\r\n\t\t\r\n\t\tif (android && android < 3 || iOS && iOS < 5) $('html').addClass('sb-static'); // Add helper class for older versions of Android & iOS.\r\n\r\n\t\t// -----------\r\n\t\t// 004 - Setup\r\n\r\n\t\t// Site container\r\n\t\tvar $site = $('#sb-site, .sb-site-container'); // Cache the selector.\r\n\r\n\t\t// Left Slidebar\t\r\n\t\tif ($('.sb-left').length) { // Check if the left Slidebar exists.\r\n\t\t\tvar $left = $('.sb-left'), // Cache the selector.\r\n\t\t\tleftActive = false; // Used to check whether the left Slidebar is open or closed.\r\n\t\t}\r\n\r\n\t\t// Right Slidebar\r\n\t\tif ($('.sb-right').length) { // Check if the right Slidebar exists.\r\n\t\t\tvar $right = $('.sb-right'), // Cache the selector.\r\n\t\t\trightActive = false; // Used to check whether the right Slidebar is open or closed.\r\n\t\t}\r\n\t\t\t\t\r\n\t\tvar init = false, // Initialisation variable.\r\n\t\twindowWidth = $(window).width(), // Get width of window.\r\n\t\t$controls = $('.sb-toggle-left, .sb-toggle-right, .sb-open-left, .sb-open-right, .sb-close'), // Cache the control classes.\r\n\t\t$slide = $('.sb-slide'); // Cache users elements to animate.\r\n\t\t\r\n\t\t// Initailise Slidebars\r\n\t\tfunction initialise() {\r\n\t\t\tif (!settings.disableOver || (typeof settings.disableOver === 'number' && settings.disableOver >= windowWidth)) { // False or larger than window size. \r\n\t\t\t\tinit = true; // true enabled Slidebars to open.\r\n\t\t\t\t$('html').addClass('sb-init'); // Add helper class.\r\n\t\t\t\tif (settings.hideControlClasses) $controls.removeClass('sb-hide'); // Remove class just incase Slidebars was originally disabled.\r\n\t\t\t\tcss(); // Set required inline styles.\r\n\t\t\t} else if (typeof settings.disableOver === 'number' && settings.disableOver < windowWidth) { // Less than window size.\r\n\t\t\t\tinit = false; // false stop Slidebars from opening.\r\n\t\t\t\t$('html').removeClass('sb-init'); // Remove helper class.\r\n\t\t\t\tif (settings.hideControlClasses) $controls.addClass('sb-hide'); // Hide controls\r\n\t\t\t\t$site.css('minHeight', ''); // Remove minimum height.\r\n\t\t\t\tif (leftActive || rightActive) close(); // Close Slidebars if open.\r\n\t\t\t}\r\n\t\t}\r\n\t\tinitialise();\r\n\t\t\r\n\t\t// Inline CSS\r\n\t\tfunction css() {\r\n\t\t\t// Set minimum height.\r\n\t\t\t$site.css('minHeight', ''); // Reset minimum height.\r\n\t\t\t$site.css('minHeight', $('html').height() + 'px'); // Set minimum height of the site to the minimum height of the html.\r\n\t\t\t\r\n\t\t\t// Custom Slidebar widths.\r\n\t\t\tif ($left && $left.hasClass('sb-width-custom')) $left.css('width', $left.attr('data-sb-width')); // Set user custom width.\r\n\t\t\tif ($right && $right.hasClass('sb-width-custom')) $right.css('width', $right.attr('data-sb-width')); // Set user custom width.\r\n\t\t\t\r\n\t\t\t// Set off-canvas margins for Slidebars with push and overlay animations.\r\n\t\t\tif ($left && ($left.hasClass('sb-style-push') || $left.hasClass('sb-style-overlay'))) $left.css('marginLeft', '-' + $left.css('width'));\r\n\t\t\tif ($right && ($right.hasClass('sb-style-push') || $right.hasClass('sb-style-overlay'))) $right.css('marginRight', '-' + $right.css('width'));\r\n\t\t\t\r\n\t\t\t// Site scroll locking.\r\n\t\t\tif (settings.scrollLock) $('html').addClass('sb-scroll-lock');\r\n\t\t}\r\n\t\t\r\n\t\t// Resize Functions\r\n\t\t$(window).resize(function() {\r\n\t\t\tvar resizedWindowWidth = $(window).width(); // Get resized window width.\r\n\t\t\tif (windowWidth !== resizedWindowWidth) { // Slidebars is running and window was actually resized.\r\n\t\t\t\twindowWidth = resizedWindowWidth; // Set the new window width.\r\n\t\t\t\tinitialise(); // Call initalise to see if Slidebars should still be running.\r\n\t\t\t\tif (leftActive) open('left'); // If left Slidebar is open, calling open will ensure it is the correct size.\r\n\t\t\t\tif (rightActive) open('right'); // If right Slidebar is open, calling open will ensure it is the correct size.\r\n\t\t\t}\r\n\t\t});\r\n\t\t// I may include a height check along side a width check here in future.\r\n\r\n\t\t// ---------------\r\n\t\t// 005 - Animation\r\n\r\n\t\tvar animation; // Animation type.\r\n\r\n\t\t// Set animation type.\r\n\t\tif (supportTransition && supportTransform) { // Browser supports css transitions and transforms.\r\n\t\t\tanimation = 'translate'; // Translate for browsers that support it.\r\n\t\t\tif (android && android < 4.4) animation = 'side'; // Android supports both, but can't translate any fixed positions, so use left instead.\r\n\t\t} else {\r\n\t\t\tanimation = 'jQuery'; // Browsers that don't support css transitions and transitions.\r\n\t\t}\r\n\r\n\t\t// Animate mixin.\r\n\t\tfunction animate(object, amount, side) {\r\n\t\t\t// Choose selectors depending on animation style.\r\n\t\t\tvar selector;\r\n\t\t\t\r\n\t\t\tif (object.hasClass('sb-style-push')) {\r\n\t\t\t\tselector = $site.add(object).add($slide); // Push - Animate site, Slidebar and user elements.\r\n\t\t\t} else if (object.hasClass('sb-style-overlay')) {\r\n\t\t\t\tselector = object; // Overlay - Animate Slidebar only.\r\n\t\t\t} else {\r\n\t\t\t\tselector = $site.add($slide); // Reveal - Animate site and user elements.\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Apply animation\r\n\t\t\tif (animation === 'translate') {\r\n\t\t\t\tselector.css('transform', 'translate(' + amount + ')'); // Apply the animation.\r\n\r\n\t\t\t} else if (animation === 'side') {\t\t\r\n\t\t\t\tif (amount[0] === '-') amount = amount.substr(1); // Remove the '-' from the passed amount for side animations.\r\n\t\t\t\tif (amount !== '0px') selector.css(side, '0px'); // Add a 0 value so css transition works.\r\n\t\t\t\tsetTimeout(function() { // Set a timeout to allow the 0 value to be applied above.\r\n\t\t\t\t\tselector.css(side, amount); // Apply the animation.\r\n\t\t\t\t}, 1);\r\n\r\n\t\t\t} else if (animation === 'jQuery') {\r\n\t\t\t\tif (amount[0] === '-') amount = amount.substr(1); // Remove the '-' from the passed amount for jQuery animations.\r\n\t\t\t\tvar properties = {};\r\n\t\t\t\tproperties[side] = amount;\r\n\t\t\t\tselector.stop().animate(properties, 400); // Stop any current jQuery animation before starting another.\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// If closed, remove the inline styling on completion of the animation.\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (amount === '0px') {\r\n\t\t\t\t\tselector.removeAttr('style');\r\n\t\t\t\t\tcss();\r\n\t\t\t\t}\r\n\t\t\t}, 400);\r\n\t\t}\r\n\r\n\t\t// ----------------\r\n\t\t// 006 - Operations\r\n\r\n\t\t// Open a Slidebar\r\n\t\tfunction open(side) {\r\n\t\t\t// Check to see if opposite Slidebar is open.\r\n\t\t\tif (side === 'left' && $left && rightActive || side === 'right' && $right && leftActive) { // It's open, close it, then continue.\r\n\t\t\t\tclose();\r\n\t\t\t\tsetTimeout(proceed, 400);\r\n\t\t\t} else { // Its not open, continue.\r\n\t\t\t\tproceed();\r\n\t\t\t}\r\n\r\n\t\t\t// Open\r\n\t\t\tfunction proceed() {\r\n\t\t\t\tif (init && side === 'left' && $left) { // Slidebars is initiated, left is in use and called to open.\r\n\t\t\t\t\t$('html').addClass('sb-active sb-active-left'); // Add active classes.\r\n\t\t\t\t\t$left.addClass('sb-active');\r\n\t\t\t\t\tanimate($left, $left.css('width'), 'left'); // Animation\r\n\t\t\t\t\tsetTimeout(function() { leftActive = true; }, 400); // Set active variables.\r\n\t\t\t\t} else if (init && side === 'right' && $right) { // Slidebars is initiated, right is in use and called to open.\r\n\t\t\t\t\t$('html').addClass('sb-active sb-active-right'); // Add active classes.\r\n\t\t\t\t\t$right.addClass('sb-active');\r\n\t\t\t\t\tanimate($right, '-' + $right.css('width'), 'right'); // Animation\r\n\t\t\t\t\tsetTimeout(function() { rightActive = true; }, 400); // Set active variables.\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\t\r\n\t\t// Close either Slidebar\r\n\t\tfunction close(link) {\r\n\t\t\tif (leftActive || rightActive) { // If a Slidebar is open.\r\n\t\t\t\tif (leftActive) {\r\n\t\t\t\t\tanimate($left, '0px', 'left'); // Animation\r\n\t\t\t\t\tleftActive = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (rightActive) {\r\n\t\t\t\t\tanimate($right, '0px', 'right'); // Animation\r\n\t\t\t\t\trightActive = false;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tsetTimeout(function() { // Wait for closing animation to finish.\r\n\t\t\t\t\t$('html').removeClass('sb-active sb-active-left sb-active-right'); // Remove active classes.\r\n\t\t\t\t\tif ($left) $left.removeClass('sb-active');\r\n\t\t\t\t\tif ($right) $right.removeClass('sb-active');\r\n\t\t\t\t\tif (typeof link !== 'undefined') window.location = link; // If a link has been passed to the function, go to it.\r\n\t\t\t\t}, 400);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// Toggle either Slidebar\r\n\t\tfunction toggle(side) {\r\n\t\t\tif (side === 'left' && $left) { // If left Slidebar is called and in use.\r\n\t\t\t\tif (!leftActive) {\r\n\t\t\t\t\topen('left'); // Slidebar is closed, open it.\r\n\t\t\t\t} else {\r\n\t\t\t\t\tclose(); // Slidebar is open, close it.\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (side === 'right' && $right) { // If right Slidebar is called and in use.\r\n\t\t\t\tif (!rightActive) {\r\n\t\t\t\t\topen('right'); // Slidebar is closed, open it.\r\n\t\t\t\t} else {\r\n\t\t\t\t\tclose(); // Slidebar is open, close it.\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// ---------\r\n\t\t// 007 - API\r\n\t\t\r\n\t\tthis.slidebars = {\r\n\t\t\topen: open, // Maps user variable name to the open method.\r\n\t\t\tclose: close, // Maps user variable name to the close method.\r\n\t\t\ttoggle: toggle, // Maps user variable name to the toggle method.\r\n\t\t\tinit: function() { // Returns true or false whether Slidebars are running or not.\r\n\t\t\t\treturn init; // Returns true or false whether Slidebars are running.\r\n\t\t\t},\r\n\t\t\tactive: function(side) { // Returns true or false whether Slidebar is open or closed.\r\n\t\t\t\tif (side === 'left' && $left) return leftActive;\r\n\t\t\t\tif (side === 'right' && $right) return rightActive;\r\n\t\t\t},\r\n\t\t\tdestroy: function(side) { // Removes the Slidebar from the DOM.\r\n\t\t\t\tif (side === 'left' && $left) {\r\n\t\t\t\t\tif (leftActive) close(); // Close if its open.\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t$left.remove(); // Remove it.\r\n\t\t\t\t\t\t$left = false; // Set variable to false so it cannot be opened again.\r\n\t\t\t\t\t}, 400);\r\n\t\t\t\t}\r\n\t\t\t\tif (side === 'right' && $right) {\r\n\t\t\t\t\tif (rightActive) close(); // Close if its open.\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t$right.remove(); // Remove it.\r\n\t\t\t\t\t\t$right = false; // Set variable to false so it cannot be opened again.\r\n\t\t\t\t\t}, 400);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// ----------------\r\n\t\t// 008 - User Input\r\n\t\t\r\n\t\tfunction eventHandler(event, selector) {\r\n\t\t\tevent.stopPropagation(); // Stop event bubbling.\r\n\t\t\tevent.preventDefault(); // Prevent default behaviour\r\n\t\t\tif (event.type === 'touchend') selector.off('click'); // If event type was touch turn off clicks to prevent phantom clicks.\r\n\t\t}\r\n\t\t\r\n\t\t// Toggle left Slidebar\r\n\t\t$('.sb-toggle-left').on('touchend click', function(event) {\r\n\t\t\teventHandler(event, $(this)); // Handle the event.\r\n\t\t\ttoggle('left'); // Toggle the left Slidbar.\r\n\t\t});\r\n\t\t\r\n\t\t// Toggle right Slidebar\r\n\t\t$('.sb-toggle-right').on('touchend click', function(event) {\r\n\t\t\teventHandler(event, $(this)); // Handle the event.\r\n\t\t\ttoggle('right'); // Toggle the right Slidbar.\r\n\t\t});\r\n\t\t\r\n\t\t// Open left Slidebar\r\n\t\t$('.sb-open-left').on('touchend click', function(event) {\r\n\t\t\teventHandler(event, $(this)); // Handle the event.\r\n\t\t\topen('left'); // Open the left Slidebar.\r\n\t\t});\r\n\t\t\r\n\t\t// Open right Slidebar\r\n\t\t$('.sb-open-right').on('touchend click', function(event) {\r\n\t\t\teventHandler(event, $(this)); // Handle the event.\r\n\t\t\topen('right'); // Open the right Slidebar.\r\n\t\t});\r\n\t\t\r\n\t\t// Close a Slidebar\r\n\t\t$('.sb-close').on('touchend click', function(event) {\r\n\t\t\teventHandler(event, $(this)); // Handle the event.\r\n\t\t\tvar link;\r\n\t\t\t\r\n\t\t\t// Close Slidebar via link\r\n\t\t\tif ( $(this).parents('.sb-slidebar') ) {\r\n\t\t\t\tif ( $(this).is('a') ) {\r\n\t\t\t\t\tlink = $(this).attr('href');\r\n\t\t\t\t} else if ( $(this).children('a') ) {\r\n\t\t\t\t\tlink = $(this).children('a').attr('href');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tclose(link); // Close Slidebar and pass link.\r\n\t\t});\r\n\t\t\r\n\t\t// Close Slidebar via site\r\n\t\t$site.on('touchend click', function(event) {\r\n\t\t\tif (settings.siteClose && (leftActive || rightActive)) { // If settings permit closing by site and left or right Slidebar is open.\r\n\t\t\t\teventHandler(event, $(this)); // Handle the event.\r\n\t\t\t\tclose(); // Close it.\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t}; // End Slidebars function.\r\n\r\n}) (jQuery);\ndefine(\"slidebars\", [\"jquery\"], function(){});\n\n",
    "/**\r\n *  map system functions\r\n */\r\n\r\n\r\ndefine('app/map/system',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'bootbox',\r\n    'app/map/util'\r\n], ($, Init, Util, bootbox, MapUtil) => {\r\n    'use strict';\r\n\r\n    var config = {\r\n        systemActiveClass: 'pf-system-active'                           // class for an active system in a map\r\n    };\r\n\r\n    /**\r\n     * show \"set rally point\" dialog for system\r\n     * @param system\r\n     */\r\n    $.fn.showRallyPointDialog = (system) => {\r\n        requirejs(['text!templates/dialog/system_rally.html', 'mustache'], function(template, Mustache) {\r\n            var data = {\r\n                notificationStatus: Init.notificationStatus.rallySet\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var rallyDialog = bootbox.dialog({\r\n                message: content,\r\n                title: 'Set rally point for \"' + system.getSystemInfo( ['alias'] ) + '\"',\r\n                buttons: {\r\n                    close: {\r\n                        label: 'cancel',\r\n                        className: 'btn-default'\r\n                    },\r\n                    setRallyPoke: {\r\n                        label: '<i class=\"fa fa-fw fa-volume-up\"></i> set rally and poke',\r\n                        className: 'btn-primary',\r\n                        callback: function() {\r\n                            system.setSystemRally(1, {\r\n                                poke: true\r\n                            });\r\n                            system.markAsChanged();\r\n                        }\r\n                    },\r\n                    success: {\r\n                        label: '<i class=\"fa fa-fw fa-users\"></i> set rally',\r\n                        className: 'btn-success',\r\n                        callback: function() {\r\n                            system.setSystemRally(1);\r\n                            system.markAsChanged();\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * shows delete dialog for systems that should be deleted\r\n     * @param map\r\n     * @param systems\r\n     * @returns {*}\r\n     */\r\n    $.fn.showDeleteSystemDialog = (map, systems = []) => {\r\n        var mapContainer = $( map.getContainer() );\r\n        var validDeleteSystems = [];\r\n        var activeCharacters = 0;\r\n        // check if systems belong to map -> security check\r\n        for (let system of systems) {\r\n            let systemElement = $(system);\r\n            if(\r\n                systemElement.data('mapid') === mapContainer.data('id')  &&\r\n                !systemElement.data('locked')\r\n            ){\r\n                // system belongs to map -> valid system\r\n                validDeleteSystems.push(system);\r\n\r\n                activeCharacters += (systemElement.data('userCount') ? parseInt( systemElement.data('userCount') ) : 0);\r\n            }\r\n        }\r\n\r\n        if(validDeleteSystems.length){\r\n            var msg = '';\r\n            if(validDeleteSystems.length === 1){\r\n                msg = 'Delete system \"' + $(validDeleteSystems[0]).data('name') + '\" and all its connections?';\r\n            }else{\r\n                msg = 'Delete ' + validDeleteSystems.length + ' selected systems and their connections?';\r\n            }\r\n\r\n            // add warning for active characters\r\n            if(activeCharacters > 0){\r\n                msg += ' <span class=\"txt-color txt-color-warning\">Warning: ' + activeCharacters + ' active characters</span>';\r\n            }\r\n\r\n            var systemDeleteDialog = bootbox.confirm(msg, result => {\r\n                if(result){\r\n                    deleteSystems(map, validDeleteSystems, (systems) => {\r\n                        // callback function after deleted -> close dialog\r\n                        systemDeleteDialog.modal('hide');\r\n\r\n                        if(systems.length === 1){\r\n                            Util.showNotify({title: 'System deleted', text: $(systems[0]).data('name'), type: 'success'});\r\n                        }else{\r\n                            Util.showNotify({title: systems.length + ' systems deleted', type: 'success'});\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }else{\r\n            Util.showNotify({title: 'No systems selected', type: 'warning'});\r\n        }\r\n\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * delete system(s) with all their connections\r\n     * (ajax call) remove system from DB\r\n     * @param map\r\n     * @param systems\r\n     * @param callback function\r\n     */\r\n    var deleteSystems = (map, systems = [], callback = (systems) => {}) => {\r\n        var mapContainer = $( map.getContainer() );\r\n        mapContainer.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.deleteSystem,\r\n            data: {\r\n                systemIds: systems.map( system => $(system).data('id') )\r\n            },\r\n            dataType: 'json',\r\n            context: {\r\n                map: map,\r\n                systems: systems\r\n            }\r\n        }).done(function(){\r\n            // remove systems from map\r\n            removeSystems(this.map,  this.systems);\r\n\r\n            callback(this.systems);\r\n        }).fail(function(jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            Util.showNotify({title: jqXHR.status + ': deleteSystem', text: reason, type: 'warning'});\r\n            $(document).setProgramStatus('problem');\r\n        });\r\n    };\r\n\r\n    /**\r\n     * remove system(s) from map (no backend requests)\r\n     * @param map\r\n     * @param systems\r\n     */\r\n    var removeSystems = (map, systems) => {\r\n\r\n        var removeSystemCallbak = function(deleteSystem){\r\n            map.remove(deleteSystem);\r\n        };\r\n\r\n        for (let system of systems){\r\n            system = $(system);\r\n\r\n            // check if system is \"active\"\r\n            if( system.hasClass(config.systemActiveClass) ){\r\n                // get parent Tab Content and fire clear modules event\r\n                var tabContentElement = MapUtil.getTabContentElementByMapElement( system );\r\n                $(tabContentElement).trigger('pf:removeSystemModules');\r\n            }\r\n\r\n            // remove endpoints and their connections\r\n            // do not fire a \"connectionDetached\" event\r\n            map.detachAllConnections(system, {fireEvent: false});\r\n\r\n            // hide tooltip\r\n            system.toggleSystemTooltip('destroy', {});\r\n\r\n            // remove system\r\n            system.velocity('transition.whirlOut', {\r\n                duration: Init.animationSpeed.mapDeleteSystem,\r\n                complete: removeSystemCallbak\r\n            });\r\n        }\r\n    };\r\n\r\n    return {\r\n        deleteSystems: deleteSystems,\r\n        removeSystems: removeSystems\r\n    };\r\n});\n",
    "/**\r\n * jsBezier-0.7\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * licensed under the MIT license.\r\n *\r\n * a set of Bezier curve functions that deal with Beziers, used by jsPlumb, and perhaps useful for other people.  These functions work with Bezier\r\n * curves of arbitrary degree.\r\n *\r\n * - functions are all in the 'jsBezier' namespace.\r\n *\r\n * - all input points should be in the format {x:.., y:..}. all output points are in this format too.\r\n *\r\n * - all input curves should be in the format [ {x:.., y:..}, {x:.., y:..}, {x:.., y:..}, {x:.., y:..} ]\r\n *\r\n * - 'location' as used as an input here refers to a decimal in the range 0-1 inclusive, which indicates a point some proportion along the length\r\n * of the curve.  location as output has the same format and meaning.\r\n *\r\n *\r\n * Function List:\r\n * --------------\r\n *\r\n * distanceFromCurve(point, curve)\r\n *\r\n * \tCalculates the distance that the given point lies from the given Bezier.  Note that it is computed relative to the center of the Bezier,\r\n * so if you have stroked the curve with a wide pen you may wish to take that into account!  The distance returned is relative to the values\r\n * of the curve and the point - it will most likely be pixels.\r\n *\r\n * gradientAtPoint(curve, location)\r\n *\r\n * \tCalculates the gradient to the curve at the given location, as a decimal between 0 and 1 inclusive.\r\n *\r\n * gradientAtPointAlongCurveFrom (curve, location)\r\n *\r\n *\tCalculates the gradient at the point on the given curve that is 'distance' units from location.\r\n *\r\n * nearestPointOnCurve(point, curve)\r\n *\r\n *\tCalculates the nearest point to the given point on the given curve.  The return value of this is a JS object literal, containing both the\r\n *point's coordinates and also the 'location' of the point (see above), for example:  { point:{x:551,y:150}, location:0.263365 }.\r\n *\r\n * pointOnCurve(curve, location)\r\n *\r\n * \tCalculates the coordinates of the point on the given Bezier curve at the given location.\r\n *\r\n * pointAlongCurveFrom(curve, location, distance)\r\n *\r\n * \tCalculates the coordinates of the point on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\r\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\r\n *\r\n * locationAlongCurveFrom(curve, location, distance)\r\n *\r\n * \tCalculates the location on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\r\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\r\n *\r\n * perpendicularToCurveAt(curve, location, length, distance)\r\n *\r\n * \tCalculates the perpendicular to the given curve at the given location.  length is the length of the line you wish for (it will be centered\r\n * on the point at 'location'). distance is optional, and allows you to specify a point along the path from the given location as the center of\r\n * the perpendicular returned.  The return value of this is an array of two points: [ {x:...,y:...}, {x:...,y:...} ].\r\n *\r\n *\r\n */\r\n\r\n(function() {\r\n\r\n    var root = this;\r\n\r\n    if(typeof Math.sgn == \"undefined\") {\r\n        Math.sgn = function(x) { return x == 0 ? 0 : x > 0 ? 1 :-1; };\r\n    }\r\n\r\n    var Vectors = {\r\n            subtract \t: \tfunction(v1, v2) { return {x:v1.x - v2.x, y:v1.y - v2.y }; },\r\n            dotProduct\t: \tfunction(v1, v2) { return (v1.x * v2.x)  + (v1.y * v2.y); },\r\n            square\t\t:\tfunction(v) { return Math.sqrt((v.x * v.x) + (v.y * v.y)); },\r\n            scale\t\t:\tfunction(v, s) { return {x:v.x * s, y:v.y * s }; }\r\n        },\r\n\r\n        maxRecursion = 64,\r\n        flatnessTolerance = Math.pow(2.0,-maxRecursion-1);\r\n\r\n    /**\r\n     * Calculates the distance that the point lies from the curve.\r\n     *\r\n     * @param point a point in the form {x:567, y:3342}\r\n     * @param curve a Bezier curve in the form [{x:..., y:...}, {x:..., y:...}, {x:..., y:...}, {x:..., y:...}].  note that this is currently\r\n     * hardcoded to assume cubiz beziers, but would be better off supporting any degree.\r\n     * @return a JS object literal containing location and distance, for example: {location:0.35, distance:10}.  Location is analogous to the location\r\n     * argument you pass to the pointOnPath function: it is a ratio of distance travelled along the curve.  Distance is the distance in pixels from\r\n     * the point to the curve.\r\n     */\r\n    var _distanceFromCurve = function(point, curve) {\r\n        var candidates = [],\r\n            w = _convertToBezier(point, curve),\r\n            degree = curve.length - 1, higherDegree = (2 * degree) - 1,\r\n            numSolutions = _findRoots(w, higherDegree, candidates, 0),\r\n            v = Vectors.subtract(point, curve[0]), dist = Vectors.square(v), t = 0.0;\r\n\r\n        for (var i = 0; i < numSolutions; i++) {\r\n            v = Vectors.subtract(point, _bezier(curve, degree, candidates[i], null, null));\r\n            var newDist = Vectors.square(v);\r\n            if (newDist < dist) {\r\n                dist = newDist;\r\n                t = candidates[i];\r\n            }\r\n        }\r\n        v = Vectors.subtract(point, curve[degree]);\r\n        newDist = Vectors.square(v);\r\n        if (newDist < dist) {\r\n            dist = newDist;\r\n            t = 1.0;\r\n        }\r\n        return {location:t, distance:dist};\r\n    };\r\n    /**\r\n     * finds the nearest point on the curve to the given point.\r\n     */\r\n    var _nearestPointOnCurve = function(point, curve) {\r\n        var td = _distanceFromCurve(point, curve);\r\n        return {point:_bezier(curve, curve.length - 1, td.location, null, null), location:td.location};\r\n    };\r\n    var _convertToBezier = function(point, curve) {\r\n        var degree = curve.length - 1, higherDegree = (2 * degree) - 1,\r\n            c = [], d = [], cdTable = [], w = [],\r\n            z = [ [1.0, 0.6, 0.3, 0.1], [0.4, 0.6, 0.6, 0.4], [0.1, 0.3, 0.6, 1.0] ];\r\n\r\n        for (var i = 0; i <= degree; i++) c[i] = Vectors.subtract(curve[i], point);\r\n        for (var i = 0; i <= degree - 1; i++) {\r\n            d[i] = Vectors.subtract(curve[i+1], curve[i]);\r\n            d[i] = Vectors.scale(d[i], 3.0);\r\n        }\r\n        for (var row = 0; row <= degree - 1; row++) {\r\n            for (var column = 0; column <= degree; column++) {\r\n                if (!cdTable[row]) cdTable[row] = [];\r\n                cdTable[row][column] = Vectors.dotProduct(d[row], c[column]);\r\n            }\r\n        }\r\n        for (i = 0; i <= higherDegree; i++) {\r\n            if (!w[i]) w[i] = [];\r\n            w[i].y = 0.0;\r\n            w[i].x = parseFloat(i) / higherDegree;\r\n        }\r\n        var n = degree, m = degree-1;\r\n        for (var k = 0; k <= n + m; k++) {\r\n            var lb = Math.max(0, k - m),\r\n                ub = Math.min(k, n);\r\n            for (i = lb; i <= ub; i++) {\r\n                j = k - i;\r\n                w[i+j].y += cdTable[j][i] * z[j][i];\r\n            }\r\n        }\r\n        return w;\r\n    };\r\n    /**\r\n     * counts how many roots there are.\r\n     */\r\n    var _findRoots = function(w, degree, t, depth) {\r\n        var left = [], right = [],\r\n            left_count, right_count,\r\n            left_t = [], right_t = [];\r\n\r\n        switch (_getCrossingCount(w, degree)) {\r\n            case 0 : {\r\n                return 0;\r\n            }\r\n            case 1 : {\r\n                if (depth >= maxRecursion) {\r\n                    t[0] = (w[0].x + w[degree].x) / 2.0;\r\n                    return 1;\r\n                }\r\n                if (_isFlatEnough(w, degree)) {\r\n                    t[0] = _computeXIntercept(w, degree);\r\n                    return 1;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        _bezier(w, degree, 0.5, left, right);\r\n        left_count  = _findRoots(left,  degree, left_t, depth+1);\r\n        right_count = _findRoots(right, degree, right_t, depth+1);\r\n        for (var i = 0; i < left_count; i++) t[i] = left_t[i];\r\n        for (var i = 0; i < right_count; i++) t[i+left_count] = right_t[i];\r\n        return (left_count+right_count);\r\n    };\r\n    var _getCrossingCount = function(curve, degree) {\r\n        var n_crossings = 0, sign, old_sign;\r\n        sign = old_sign = Math.sgn(curve[0].y);\r\n        for (var i = 1; i <= degree; i++) {\r\n            sign = Math.sgn(curve[i].y);\r\n            if (sign != old_sign) n_crossings++;\r\n            old_sign = sign;\r\n        }\r\n        return n_crossings;\r\n    };\r\n    var _isFlatEnough = function(curve, degree) {\r\n        var  error,\r\n            intercept_1, intercept_2, left_intercept, right_intercept,\r\n            a, b, c, det, dInv, a1, b1, c1, a2, b2, c2;\r\n        a = curve[0].y - curve[degree].y;\r\n        b = curve[degree].x - curve[0].x;\r\n        c = curve[0].x * curve[degree].y - curve[degree].x * curve[0].y;\r\n\r\n        var max_distance_above = max_distance_below = 0.0;\r\n\r\n        for (var i = 1; i < degree; i++) {\r\n            var value = a * curve[i].x + b * curve[i].y + c;\r\n            if (value > max_distance_above)\r\n                max_distance_above = value;\r\n            else if (value < max_distance_below)\r\n                max_distance_below = value;\r\n        }\r\n\r\n        a1 = 0.0; b1 = 1.0; c1 = 0.0; a2 = a; b2 = b;\r\n        c2 = c - max_distance_above;\r\n        det = a1 * b2 - a2 * b1;\r\n        dInv = 1.0/det;\r\n        intercept_1 = (b1 * c2 - b2 * c1) * dInv;\r\n        a2 = a; b2 = b; c2 = c - max_distance_below;\r\n        det = a1 * b2 - a2 * b1;\r\n        dInv = 1.0/det;\r\n        intercept_2 = (b1 * c2 - b2 * c1) * dInv;\r\n        left_intercept = Math.min(intercept_1, intercept_2);\r\n        right_intercept = Math.max(intercept_1, intercept_2);\r\n        error = right_intercept - left_intercept;\r\n        return (error < flatnessTolerance)? 1 : 0;\r\n    };\r\n    var _computeXIntercept = function(curve, degree) {\r\n        var XLK = 1.0, YLK = 0.0,\r\n            XNM = curve[degree].x - curve[0].x, YNM = curve[degree].y - curve[0].y,\r\n            XMK = curve[0].x - 0.0, YMK = curve[0].y - 0.0,\r\n            det = XNM*YLK - YNM*XLK, detInv = 1.0/det,\r\n            S = (XNM*YMK - YNM*XMK) * detInv;\r\n        return 0.0 + XLK * S;\r\n    };\r\n    var _bezier = function(curve, degree, t, left, right) {\r\n        var temp = [[]];\r\n        for (var j =0; j <= degree; j++) temp[0][j] = curve[j];\r\n        for (var i = 1; i <= degree; i++) {\r\n            for (var j =0 ; j <= degree - i; j++) {\r\n                if (!temp[i]) temp[i] = [];\r\n                if (!temp[i][j]) temp[i][j] = {};\r\n                temp[i][j].x = (1.0 - t) * temp[i-1][j].x + t * temp[i-1][j+1].x;\r\n                temp[i][j].y = (1.0 - t) * temp[i-1][j].y + t * temp[i-1][j+1].y;\r\n            }\r\n        }\r\n        if (left != null)\r\n            for (j = 0; j <= degree; j++) left[j]  = temp[j][0];\r\n        if (right != null)\r\n            for (j = 0; j <= degree; j++) right[j] = temp[degree-j][j];\r\n\r\n        return (temp[degree][0]);\r\n    };\r\n\r\n    var _curveFunctionCache = {};\r\n    var _getCurveFunctions = function(order) {\r\n        var fns = _curveFunctionCache[order];\r\n        if (!fns) {\r\n            fns = [];\r\n            var f_term = function() { return function(t) { return Math.pow(t, order); }; },\r\n                l_term = function() { return function(t) { return Math.pow((1-t), order); }; },\r\n                c_term = function(c) { return function(t) { return c; }; },\r\n                t_term = function() { return function(t) { return t; }; },\r\n                one_minus_t_term = function() { return function(t) { return 1-t; }; },\r\n                _termFunc = function(terms) {\r\n                    return function(t) {\r\n                        var p = 1;\r\n                        for (var i = 0; i < terms.length; i++) p = p * terms[i](t);\r\n                        return p;\r\n                    };\r\n                };\r\n\r\n            fns.push(new f_term());  // first is t to the power of the curve order\r\n            for (var i = 1; i < order; i++) {\r\n                var terms = [new c_term(order)];\r\n                for (var j = 0 ; j < (order - i); j++) terms.push(new t_term());\r\n                for (var j = 0 ; j < i; j++) terms.push(new one_minus_t_term());\r\n                fns.push(new _termFunc(terms));\r\n            }\r\n            fns.push(new l_term());  // last is (1-t) to the power of the curve order\r\n\r\n            _curveFunctionCache[order] = fns;\r\n        }\r\n\r\n        return fns;\r\n    };\r\n\r\n\r\n    /**\r\n     * calculates a point on the curve, for a Bezier of arbitrary order.\r\n     * @param curve an array of control points, eg [{x:10,y:20}, {x:50,y:50}, {x:100,y:100}, {x:120,y:100}].  For a cubic bezier this should have four points.\r\n     * @param location a decimal indicating the distance along the curve the point should be located at.  this is the distance along the curve as it travels, taking the way it bends into account.  should be a number from 0 to 1, inclusive.\r\n     */\r\n    var _pointOnPath = function(curve, location) {\r\n        var cc = _getCurveFunctions(curve.length - 1),\r\n            _x = 0, _y = 0;\r\n        for (var i = 0; i < curve.length ; i++) {\r\n            _x = _x + (curve[i].x * cc[i](location));\r\n            _y = _y + (curve[i].y * cc[i](location));\r\n        }\r\n\r\n        return {x:_x, y:_y};\r\n    };\r\n\r\n    var _dist = function(p1,p2) {\r\n        return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\r\n    };\r\n\r\n    var _isPoint = function(curve) {\r\n        return curve[0].x == curve[1].x && curve[0].y == curve[1].y;\r\n    };\r\n\r\n    /**\r\n     * finds the point that is 'distance' along the path from 'location'.  this method returns both the x,y location of the point and also\r\n     * its 'location' (proportion of travel along the path); the method below - _pointAlongPathFrom - calls this method and just returns the\r\n     * point.\r\n     */\r\n    var _pointAlongPath = function(curve, location, distance) {\r\n\r\n        if (_isPoint(curve)) {\r\n            return {\r\n                point:curve[0],\r\n                location:location\r\n            };\r\n        }\r\n\r\n        var prev = _pointOnPath(curve, location),\r\n            tally = 0,\r\n            curLoc = location,\r\n            direction = distance > 0 ? 1 : -1,\r\n            cur = null;\r\n\r\n        while (tally < Math.abs(distance)) {\r\n            curLoc += (0.005 * direction);\r\n            cur = _pointOnPath(curve, curLoc);\r\n            tally += _dist(cur, prev);\r\n            prev = cur;\r\n        }\r\n        return {point:cur, location:curLoc};\r\n    };\r\n\r\n    var _length = function(curve) {\r\n        if (_isPoint(curve)) return 0;\r\n\r\n        var prev = _pointOnPath(curve, 0),\r\n            tally = 0,\r\n            curLoc = 0,\r\n            direction = 1,\r\n            cur = null;\r\n\r\n        while (curLoc < 1) {\r\n            curLoc += (0.005 * direction);\r\n            cur = _pointOnPath(curve, curLoc);\r\n            tally += _dist(cur, prev);\r\n            prev = cur;\r\n        }\r\n        return tally;\r\n    };\r\n\r\n    /**\r\n     * finds the point that is 'distance' along the path from 'location'.\r\n     */\r\n    var _pointAlongPathFrom = function(curve, location, distance) {\r\n        return _pointAlongPath(curve, location, distance).point;\r\n    };\r\n\r\n    /**\r\n     * finds the location that is 'distance' along the path from 'location'.\r\n     */\r\n    var _locationAlongPathFrom = function(curve, location, distance) {\r\n        return _pointAlongPath(curve, location, distance).location;\r\n    };\r\n\r\n    /**\r\n     * returns the gradient of the curve at the given location, which is a decimal between 0 and 1 inclusive.\r\n     *\r\n     * thanks // http://bimixual.org/AnimationLibrary/beziertangents.html\r\n     */\r\n    var _gradientAtPoint = function(curve, location) {\r\n        var p1 = _pointOnPath(curve, location),\r\n            p2 = _pointOnPath(curve.slice(0, curve.length - 1), location),\r\n            dy = p2.y - p1.y, dx = p2.x - p1.x;\r\n        return dy == 0 ? Infinity : Math.atan(dy / dx);\r\n    };\r\n\r\n    /**\r\n     returns the gradient of the curve at the point which is 'distance' from the given location.\r\n     if this point is greater than location 1, the gradient at location 1 is returned.\r\n     if this point is less than location 0, the gradient at location 0 is returned.\r\n     */\r\n    var _gradientAtPointAlongPathFrom = function(curve, location, distance) {\r\n        var p = _pointAlongPath(curve, location, distance);\r\n        if (p.location > 1) p.location = 1;\r\n        if (p.location < 0) p.location = 0;\r\n        return _gradientAtPoint(curve, p.location);\r\n    };\r\n\r\n    /**\r\n     * calculates a line that is 'length' pixels long, perpendicular to, and centered on, the path at 'distance' pixels from the given location.\r\n     * if distance is not supplied, the perpendicular for the given location is computed (ie. we set distance to zero).\r\n     */\r\n    var _perpendicularToPathAt = function(curve, location, length, distance) {\r\n        distance = distance == null ? 0 : distance;\r\n        var p = _pointAlongPath(curve, location, distance),\r\n            m = _gradientAtPoint(curve, p.location),\r\n            _theta2 = Math.atan(-1 / m),\r\n            y =  length / 2 * Math.sin(_theta2),\r\n            x =  length / 2 * Math.cos(_theta2);\r\n        return [{x:p.point.x + x, y:p.point.y + y}, {x:p.point.x - x, y:p.point.y - y}];\r\n    };\r\n\r\n    this.jsBezier = {\r\n        distanceFromCurve : _distanceFromCurve,\r\n        gradientAtPoint : _gradientAtPoint,\r\n        gradientAtPointAlongCurveFrom : _gradientAtPointAlongPathFrom,\r\n        nearestPointOnCurve : _nearestPointOnCurve,\r\n        pointOnCurve : _pointOnPath,\r\n        pointAlongCurveFrom : _pointAlongPathFrom,\r\n        perpendicularToCurveAt : _perpendicularToPathAt,\r\n        locationAlongCurveFrom:_locationAlongPathFrom,\r\n        getLength:_length\r\n    };\r\n}).call(this);\r\n\r\n/**\r\n * Biltong v0.2\r\n *\r\n * Various geometry functions written as part of jsPlumb and perhaps useful for others.\r\n *\r\n * Copyright (c) 2014 Simon Porritt\r\n *\r\n * Permission is hereby granted, free of charge, to any person\r\n * obtaining a copy of this software and associated documentation\r\n * files (the \"Software\"), to deal in the Software without\r\n * restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the\r\n * Software is furnished to do so, subject to the following\r\n * conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\r\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\r\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\r\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\r\n * OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n;(function() {\r\n\r\n\t\r\n\t\"use strict\";\r\n\r\n\tvar Biltong = this.Biltong = {};\r\n\r\n\tvar _isa = function(a) { return Object.prototype.toString.call(a) === \"[object Array]\"; },\r\n\t\t_pointHelper = function(p1, p2, fn) {\r\n\t\t    p1 = _isa(p1) ? p1 : [p1.x, p1.y];\r\n\t\t    p2 = _isa(p2) ? p2 : [p2.x, p2.y];    \r\n\t\t    return fn(p1, p2);\r\n\t\t},\r\n\t\t/**\r\n\t\t* @name Biltong.gradient\r\n\t\t* @function\r\n\t\t* @desc Calculates the gradient of a line between the two points.\r\n\t\t* @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @return {Float} The gradient of a line between the two points.\r\n\t\t*/\r\n\t\t_gradient = Biltong.gradient = function(p1, p2) {\r\n\t\t    return _pointHelper(p1, p2, function(_p1, _p2) { \r\n\t\t        if (_p2[0] == _p1[0])\r\n\t\t            return _p2[1] > _p1[1] ? Infinity : -Infinity;\r\n\t\t        else if (_p2[1] == _p1[1]) \r\n\t\t            return _p2[0] > _p1[0] ? 0 : -0;\r\n\t\t        else \r\n\t\t            return (_p2[1] - _p1[1]) / (_p2[0] - _p1[0]); \r\n\t\t    });\t\t\r\n\t\t},\r\n\t\t/**\r\n\t\t* @name Biltong.normal\r\n\t\t* @function\r\n\t\t* @desc Calculates the gradient of a normal to a line between the two points.\r\n\t\t* @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @return {Float} The gradient of a normal to a line between the two points.\r\n\t\t*/\r\n\t\t_normal = Biltong.normal = function(p1, p2) {\r\n\t\t    return -1 / _gradient(p1, p2);\r\n\t\t},\r\n\t\t/**\r\n\t\t* @name Biltong.lineLength\r\n\t\t* @function\r\n\t\t* @desc Calculates the length of a line between the two points.\r\n\t\t* @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @return {Float} The length of a line between the two points.\r\n\t\t*/\r\n\t\t_lineLength = Biltong.lineLength = function(p1, p2) {\r\n\t\t    return _pointHelper(p1, p2, function(_p1, _p2) {\r\n\t\t        return Math.sqrt(Math.pow(_p2[1] - _p1[1], 2) + Math.pow(_p2[0] - _p1[0], 2));\t\t\t\r\n\t\t    });\r\n\t\t},\r\n\t\t/**\r\n\t\t* @name Biltong.quadrant\r\n\t\t* @function\r\n\t\t* @desc Calculates the quadrant in which the angle between the two points lies. \r\n\t\t* @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @return {Integer} The quadrant - 1 for upper right, 2 for lower right, 3 for lower left, 4 for upper left.\r\n\t\t*/\r\n\t\t_quadrant = Biltong.quadrant = function(p1, p2) {\r\n\t\t    return _pointHelper(p1, p2, function(_p1, _p2) {\r\n\t\t        if (_p2[0] > _p1[0]) {\r\n\t\t            return (_p2[1] > _p1[1]) ? 2 : 1;\r\n\t\t        }\r\n\t\t        else if (_p2[0] == _p1[0]) {\r\n\t\t            return _p2[1] > _p1[1] ? 2 : 1;    \r\n\t\t        }\r\n\t\t        else {\r\n\t\t            return (_p2[1] > _p1[1]) ? 3 : 4;\r\n\t\t        }\r\n\t\t    });\r\n\t\t},\r\n\t\t/**\r\n\t\t* @name Biltong.theta\r\n\t\t* @function\r\n\t\t* @desc Calculates the angle between the two points. \r\n\t\t* @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @return {Float} The angle between the two points.\r\n\t\t*/\r\n\t\t_theta = Biltong.theta = function(p1, p2) {\r\n\t\t    return _pointHelper(p1, p2, function(_p1, _p2) {\r\n\t\t        var m = _gradient(_p1, _p2),\r\n\t\t            t = Math.atan(m),\r\n\t\t            s = _quadrant(_p1, _p2);\r\n\t\t        if ((s == 4 || s== 3)) t += Math.PI;\r\n\t\t        if (t < 0) t += (2 * Math.PI);\r\n\t\t    \r\n\t\t        return t;\r\n\t\t    });\r\n\t\t},\r\n\t\t/**\r\n\t\t* @name Biltong.intersects\r\n\t\t* @function\r\n\t\t* @desc Calculates whether or not the two rectangles intersect.\r\n\t\t* @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\r\n\t\t* @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\r\n\t\t* @return {Boolean} True if the rectangles intersect, false otherwise.\r\n\t\t*/\r\n\t\t_intersects = Biltong.intersects = function(r1, r2) {\r\n\t\t    var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\r\n\t\t        a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h;\r\n\t\t\r\n\t\t\treturn  ( (x1 <= a1 && a1 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\r\n\t\t\t        ( (x1 <= a2 && a2 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\r\n\t\t\t        ( (x1 <= a1 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\r\n\t\t\t        ( (x1 <= a2 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\t\r\n\t\t\t        ( (a1 <= x1 && x1 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\r\n\t\t\t        ( (a1 <= x2 && x2 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\r\n\t\t\t        ( (a1 <= x1 && x1 <= a2) && (b1 <= y2 && y2 <= b2) ) ||\r\n\t\t\t        ( (a1 <= x2 && x1 <= a2) && (b1 <= y2 && y2 <= b2) );\r\n\t\t},\r\n\t\t/**\r\n\t\t* @name Biltong.encloses\r\n\t\t* @function\r\n\t\t* @desc Calculates whether or not r2 is completely enclosed by r1.\r\n\t\t* @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\r\n\t\t* @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\r\n\t\t* @param {Boolean} [allowSharedEdges=false] If true, the concept of enclosure allows for one or more edges to be shared by the two rectangles.\r\n\t\t* @return {Boolean} True if r1 encloses r2, false otherwise.\r\n\t\t*/\r\n\t\t_encloses = Biltong.encloses = function(r1, r2, allowSharedEdges) {\r\n\t\t\tvar x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\r\n\t\t        a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h,\r\n\t\t\t\tc = function(v1, v2, v3, v4) { return allowSharedEdges ? v1 <= v2 && v3>= v4 : v1 < v2 && v3 > v4; };\r\n\t\t\t\t\r\n\t\t\treturn c(x1,a1,x2,a2) && c(y1,b1,y2,b2);\r\n\t\t},\r\n\t\t_segmentMultipliers = [null, [1, -1], [1, 1], [-1, 1], [-1, -1] ],\r\n\t\t_inverseSegmentMultipliers = [null, [-1, -1], [-1, 1], [1, 1], [1, -1] ],\r\n\t\t/**\r\n\t\t* @name Biltong.pointOnLine\r\n\t\t* @function\r\n\t\t* @desc Calculates a point on the line from `fromPoint` to `toPoint` that is `distance` units along the length of the line.\r\n\t\t* @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @return {Point} Point on the line, in the form `{ x:..., y:... }`.\r\n\t\t*/\r\n\t\t_pointOnLine = Biltong.pointOnLine = function(fromPoint, toPoint, distance) {\r\n\t\t    var m = _gradient(fromPoint, toPoint),\r\n\t\t        s = _quadrant(fromPoint, toPoint),\r\n\t\t        segmentMultiplier = distance > 0 ? _segmentMultipliers[s] : _inverseSegmentMultipliers[s],\r\n\t\t        theta = Math.atan(m),\r\n\t\t        y = Math.abs(distance * Math.sin(theta)) * segmentMultiplier[1],\r\n\t\t        x =  Math.abs(distance * Math.cos(theta)) * segmentMultiplier[0];\r\n\t\t    return { x:fromPoint.x + x, y:fromPoint.y + y };\r\n\t\t},\r\n\t\t/**\r\n\t\t* @name Biltong.perpendicularLineTo\r\n\t\t* @function\r\n\t\t* @desc Calculates a line of length `length` that is perpendicular to the line from `fromPoint` to `toPoint` and passes through `toPoint`.\r\n\t\t* @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\r\n\t\t* @return {Line} Perpendicular line, in the form `[ { x:..., y:... }, { x:..., y:... } ]`.\r\n\t\t*/        \r\n\t\t_perpendicularLineTo = Biltong.perpendicularLineTo = function(fromPoint, toPoint, length) {\r\n\t\t    var m = _gradient(fromPoint, toPoint),\r\n\t\t        theta2 = Math.atan(-1 / m),\r\n\t\t        y =  length / 2 * Math.sin(theta2),\r\n\t\t        x =  length / 2 * Math.cos(theta2);\r\n\t\t    return [{x:toPoint.x + x, y:toPoint.y + y}, {x:toPoint.x - x, y:toPoint.y - y}];\r\n\t\t};\t\r\n}).call(this);\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n\r\n    var Sniff = {\r\n        android: navigator.userAgent.toLowerCase().indexOf(\"android\") > -1\r\n    };\r\n\r\n    var matchesSelector = function (el, selector, ctx) {\r\n            ctx = ctx || el.parentNode;\r\n            var possibles = ctx.querySelectorAll(selector);\r\n            for (var i = 0; i < possibles.length; i++) {\r\n                if (possibles[i] === el) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        _gel = function (el) {\r\n            return typeof el == \"string\" ? document.getElementById(el) : el;\r\n        },\r\n        _t = function (e) {\r\n            return e.srcElement || e.target;\r\n        },\r\n        _d = function (l, fn) {\r\n            for (var i = 0, j = l.length; i < j; i++) {\r\n                if (l[i] == fn) break;\r\n            }\r\n            if (i < l.length) l.splice(i, 1);\r\n        },\r\n        guid = 1,\r\n    //\r\n    // this function generates a guid for every handler, sets it on the handler, then adds\r\n    // it to the associated object's map of handlers for the given event. this is what enables us\r\n    // to unbind all events of some type, or all events (the second of which can be requested by the user,\r\n    // but it also used by Mottle when an element is removed.)\r\n        _store = function (obj, event, fn) {\r\n            var g = guid++;\r\n            obj.__ta = obj.__ta || {};\r\n            obj.__ta[event] = obj.__ta[event] || {};\r\n            // store each handler with a unique guid.\r\n            obj.__ta[event][g] = fn;\r\n            // set the guid on the handler.\r\n            fn.__tauid = g;\r\n            return g;\r\n        },\r\n        _unstore = function (obj, event, fn) {\r\n            obj.__ta && obj.__ta[event] && delete obj.__ta[event][fn.__tauid];\r\n            // a handler might have attached extra functions, so we unbind those too.\r\n            if (fn.__taExtra) {\r\n                for (var i = 0; i < fn.__taExtra.length; i++) {\r\n                    _unbind(obj, fn.__taExtra[i][0], fn.__taExtra[i][1]);\r\n                }\r\n                fn.__taExtra.length = 0;\r\n            }\r\n            // a handler might have attached an unstore callback\r\n            fn.__taUnstore && fn.__taUnstore();\r\n        },\r\n        _curryChildFilter = function (children, obj, fn, evt) {\r\n            if (children == null) return fn;\r\n            else {\r\n                var c = children.split(\",\"),\r\n                    _fn = function (e) {\r\n                        _fn.__tauid = fn.__tauid;\r\n                        var t = _t(e);\r\n                        for (var i = 0; i < c.length; i++) {\r\n                            if (matchesSelector(t, c[i], obj)) {\r\n                                fn.apply(t, arguments);\r\n                            }\r\n                        }\r\n                    };\r\n                registerExtraFunction(fn, evt, _fn);\r\n                return _fn;\r\n            }\r\n        },\r\n    //\r\n    // registers an 'extra' function on some event listener function we were given - a function that we\r\n    // created and bound to the element as part of our housekeeping, and which we want to unbind and remove\r\n    // whenever the given function is unbound.\r\n        registerExtraFunction = function (fn, evt, newFn) {\r\n            fn.__taExtra = fn.__taExtra || [];\r\n            fn.__taExtra.push([evt, newFn]);\r\n        },\r\n        DefaultHandler = function (obj, evt, fn, children) {\r\n            if (isTouchDevice && touchMap[evt]) {\r\n                var tfn = _curryChildFilter(children, obj, fn, touchMap[evt]);\r\n                _bind(obj, touchMap[evt], tfn , fn);\r\n            }\r\n            if (evt === \"focus\" && obj.getAttribute(\"tabindex\") == null) {\r\n                obj.setAttribute(\"tabindex\", \"1\");\r\n            }\r\n            _bind(obj, evt, _curryChildFilter(children, obj, fn, evt), fn);\r\n        },\r\n        SmartClickHandler = function (obj, evt, fn, children) {\r\n            if (obj.__taSmartClicks == null) {\r\n                var down = function (e) {\r\n                        obj.__tad = _pageLocation(e);\r\n                    },\r\n                    up = function (e) {\r\n                        obj.__tau = _pageLocation(e);\r\n                    },\r\n                    click = function (e) {\r\n                        if (obj.__tad && obj.__tau && obj.__tad[0] === obj.__tau[0] && obj.__tad[1] === obj.__tau[1]) {\r\n                            for (var i = 0; i < obj.__taSmartClicks.length; i++)\r\n                                obj.__taSmartClicks[i].apply(_t(e), [ e ]);\r\n                        }\r\n                    };\r\n                DefaultHandler(obj, \"mousedown\", down, children);\r\n                DefaultHandler(obj, \"mouseup\", up, children);\r\n                DefaultHandler(obj, \"click\", click, children);\r\n                obj.__taSmartClicks = [];\r\n            }\r\n\r\n            // store in the list of callbacks\r\n            obj.__taSmartClicks.push(fn);\r\n            // the unstore function removes this function from the object's listener list for this type.\r\n            fn.__taUnstore = function () {\r\n                _d(obj.__taSmartClicks, fn);\r\n            };\r\n        },\r\n        _tapProfiles = {\r\n            \"tap\": {touches: 1, taps: 1},\r\n            \"dbltap\": {touches: 1, taps: 2},\r\n            \"contextmenu\": {touches: 2, taps: 1}\r\n        },\r\n        TapHandler = function (clickThreshold, dblClickThreshold) {\r\n            return function (obj, evt, fn, children) {\r\n                // if event is contextmenu, for devices which are mouse only, we want to\r\n                // use the default bind.\r\n                if (evt == \"contextmenu\" && isMouseDevice)\r\n                    DefaultHandler(obj, evt, fn, children);\r\n                else {\r\n                    // the issue here is that this down handler gets registered only for the\r\n                    // child nodes in the first registration. in fact it should be registered with\r\n                    // no child selector and then on down we should cycle through the regustered\r\n                    // functions to see if one of them matches. on mouseup we should execute ALL of\r\n                    // the functions whose children are either null or match the element.\r\n                    if (obj.__taTapHandler == null) {\r\n                        var tt = obj.__taTapHandler = {\r\n                            tap: [],\r\n                            dbltap: [],\r\n                            contextmenu: [],\r\n                            down: false,\r\n                            taps: 0,\r\n                            downSelectors: []\r\n                        };\r\n                        var down = function (e) {\r\n                                var target = e.srcElement || e.target;\r\n                                for (var i = 0; i < tt.downSelectors.length; i++) {\r\n                                    if (tt.downSelectors[i] == null || matchesSelector(target, tt.downSelectors[i], obj)) {\r\n                                        tt.down = true;\r\n                                        setTimeout(clearSingle, clickThreshold);\r\n                                        setTimeout(clearDouble, dblClickThreshold);\r\n                                        break; // we only need one match on mousedown\r\n                                    }\r\n                                }\r\n                            },\r\n                            up = function (e) {\r\n                                if (tt.down) {\r\n                                    var target = e.srcElement || e.target;\r\n                                    tt.taps++;\r\n                                    var tc = _touchCount(e);\r\n                                    for (var eventId in _tapProfiles) {\r\n                                        var p = _tapProfiles[eventId];\r\n                                        if (p.touches === tc && (p.taps === 1 || p.taps === tt.taps)) {\r\n                                            for (var i = 0; i < tt[eventId].length; i++) {\r\n                                                if (tt[eventId][i][1] == null || matchesSelector(target, tt[eventId][i][1], obj))\r\n                                                    tt[eventId][i][0].apply(_t(e), [ e ]);\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            },\r\n                            clearSingle = function () {\r\n                                tt.down = false;\r\n                            },\r\n                            clearDouble = function () {\r\n                                tt.taps = 0;\r\n                            };\r\n\r\n                        DefaultHandler(obj, \"mousedown\", down/*, children*/);\r\n                        DefaultHandler(obj, \"mouseup\", up/*, children*/);\r\n                    }\r\n                    // add this child selector (it can be null, that's fine).\r\n                    obj.__taTapHandler.downSelectors.push(children);\r\n\r\n                    obj.__taTapHandler[evt].push([fn, children]);\r\n                    // the unstore function removes this function from the object's listener list for this type.\r\n                    fn.__taUnstore = function () {\r\n                        _d(obj.__taTapHandler[evt], fn);\r\n                    };\r\n                }\r\n            };\r\n        },\r\n        meeHelper = function (type, evt, obj, target) {\r\n            for (var i in obj.__tamee[type]) {\r\n                obj.__tamee[type][i].apply(target, [ evt ]);\r\n            }\r\n        },\r\n        MouseEnterExitHandler = function () {\r\n            var activeElements = [];\r\n            return function (obj, evt, fn, children) {\r\n                if (!obj.__tamee) {\r\n                    // __tamee holds a flag saying whether the mouse is currently \"in\" the element, and a list of\r\n                    // both mouseenter and mouseexit functions.\r\n                    obj.__tamee = { over: false, mouseenter: [], mouseexit: [] };\r\n                    // register over and out functions\r\n                    var over = function (e) {\r\n                            var t = _t(e);\r\n                            if ((children == null && (t == obj && !obj.__tamee.over)) || (matchesSelector(t, children, obj) && (t.__tamee == null || !t.__tamee.over))) {\r\n                                meeHelper(\"mouseenter\", e, obj, t);\r\n                                t.__tamee = t.__tamee || {};\r\n                                t.__tamee.over = true;\r\n                                activeElements.push(t);\r\n                            }\r\n                        },\r\n                        out = function (e) {\r\n                            var t = _t(e);\r\n                            // is the current target one of the activeElements? and is the\r\n                            // related target NOT a descendant of it?\r\n                            for (var i = 0; i < activeElements.length; i++) {\r\n                                if (t == activeElements[i] && !matchesSelector((e.relatedTarget || e.toElement), \"*\", t)) {\r\n                                    t.__tamee.over = false;\r\n                                    activeElements.splice(i, 1);\r\n                                    meeHelper(\"mouseexit\", e, obj, t);\r\n                                }\r\n                            }\r\n                        };\r\n\r\n                    _bind(obj, \"mouseover\", _curryChildFilter(children, obj, over, \"mouseover\"), over);\r\n                    _bind(obj, \"mouseout\", _curryChildFilter(children, obj, out, \"mouseout\"), out);\r\n                }\r\n\r\n                fn.__taUnstore = function () {\r\n                    delete obj.__tamee[evt][fn.__tauid];\r\n                };\r\n\r\n                _store(obj, evt, fn);\r\n                obj.__tamee[evt][fn.__tauid] = fn;\r\n            };\r\n        },\r\n        isTouchDevice = \"ontouchstart\" in document.documentElement,\r\n        isMouseDevice = \"onmousedown\" in document.documentElement,\r\n        touchMap = { \"mousedown\": \"touchstart\", \"mouseup\": \"touchend\", \"mousemove\": \"touchmove\" },\r\n        touchstart = \"touchstart\", touchend = \"touchend\", touchmove = \"touchmove\",\r\n        iev = (function () {\r\n            var rv = -1;\r\n            if (navigator.appName == 'Microsoft Internet Explorer') {\r\n                var ua = navigator.userAgent,\r\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\r\n                if (re.exec(ua) != null)\r\n                    rv = parseFloat(RegExp.$1);\r\n            }\r\n            return rv;\r\n        })(),\r\n        isIELT9 = iev > -1 && iev < 9,\r\n        _genLoc = function (e, prefix) {\r\n            if (e == null) return [ 0, 0 ];\r\n            var ts = _touches(e), t = _getTouch(ts, 0);\r\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\r\n        },\r\n        _pageLocation = function (e) {\r\n            if (e == null) return [ 0, 0 ];\r\n            if (isIELT9) {\r\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\r\n            }\r\n            else {\r\n                return _genLoc(e, \"page\");\r\n            }\r\n        },\r\n        _screenLocation = function (e) {\r\n            return _genLoc(e, \"screen\");\r\n        },\r\n        _clientLocation = function (e) {\r\n            return _genLoc(e, \"client\");\r\n        },\r\n        _getTouch = function (touches, idx) {\r\n            return touches.item ? touches.item(idx) : touches[idx];\r\n        },\r\n        _touches = function (e) {\r\n            return e.touches && e.touches.length > 0 ? e.touches :\r\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\r\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\r\n                [ e ];\r\n        },\r\n        _touchCount = function (e) {\r\n            return _touches(e).length;\r\n        },\r\n    //http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html\r\n        _bind = function (obj, type, fn, originalFn) {\r\n            _store(obj, type, fn);\r\n            originalFn.__tauid = fn.__tauid;\r\n            if (obj.addEventListener)\r\n                obj.addEventListener(type, fn, false);\r\n            else if (obj.attachEvent) {\r\n                var key = type + fn.__tauid;\r\n                obj[\"e\" + key] = fn;\r\n                // TODO look at replacing with .call(..)\r\n                obj[key] = function () {\r\n                    obj[\"e\" + key] && obj[\"e\" + key](window.event);\r\n                };\r\n                obj.attachEvent(\"on\" + type, obj[key]);\r\n            }\r\n        },\r\n        _unbind = function (obj, type, fn) {\r\n            if (fn == null) return;\r\n            _each(obj, function () {\r\n                var _el = _gel(this);\r\n                _unstore(_el, type, fn);\r\n                // it has been bound if there is a tauid. otherwise it was not bound and we can ignore it.\r\n                if (fn.__tauid != null) {\r\n                    if (_el.removeEventListener) {\r\n                        _el.removeEventListener(type, fn, false);\r\n                        if (isTouchDevice && touchMap[type]) _el.removeEventListener(touchMap[type], fn, false);\r\n                    }\r\n                    else if (this.detachEvent) {\r\n                        var key = type + fn.__tauid;\r\n                        _el[key] && _el.detachEvent(\"on\" + type, _el[key]);\r\n                        _el[key] = null;\r\n                        _el[\"e\" + key] = null;\r\n                    }\r\n                }\r\n\r\n                // if a touch event was also registered, deregister now.\r\n                if (fn.__taTouchProxy) {\r\n                    _unbind(obj, fn.__taTouchProxy[1], fn.__taTouchProxy[0]);\r\n                }\r\n            });\r\n        },\r\n        _devNull = function () {\r\n        },\r\n        _each = function (obj, fn) {\r\n            if (obj == null) return;\r\n            // if a list (or list-like), use it. if a string, get a list\r\n            // by running the string through querySelectorAll. else, assume\r\n            // it's an Element.\r\n            // obj.top is \"unknown\" in IE8.\r\n            obj = (typeof Window !== \"undefined\" && (typeof obj.top !== \"unknown\" && obj == obj.top)) ? [ obj ] :\r\n                    (typeof obj !== \"string\") && (obj.tagName == null && obj.length != null) ? obj :\r\n                    typeof obj === \"string\" ? document.querySelectorAll(obj)\r\n                : [ obj ];\r\n\r\n            for (var i = 0; i < obj.length; i++)\r\n                fn.apply(obj[i]);\r\n        };\r\n\r\n    /**\r\n     * Mottle offers support for abstracting out the differences\r\n     * between touch and mouse devices, plus \"smart click\" functionality\r\n     * (don't fire click if the mouse has moved between mousedown and mouseup),\r\n     * and synthesized click/tap events.\r\n     * @class Mottle\r\n     * @constructor\r\n     * @param {Object} params Constructor params\r\n     * @param {Integer} [params.clickThreshold=150] Threshold, in milliseconds beyond which a touchstart followed by a touchend is not considered to be a click.\r\n     * @param {Integer} [params.dblClickThreshold=350] Threshold, in milliseconds beyond which two successive tap events are not considered to be a click.\r\n     * @param {Boolean} [params.smartClicks=false] If true, won't fire click events if the mouse has moved between mousedown and mouseup. Note that this functionality\r\n     * requires that Mottle consume the mousedown event, and so may not be viable in all use cases.\r\n     */\r\n    this.Mottle = function (params) {\r\n        params = params || {};\r\n        var clickThreshold = params.clickThreshold || 150,\r\n            dblClickThreshold = params.dblClickThreshold || 350,\r\n            mouseEnterExitHandler = new MouseEnterExitHandler(),\r\n            tapHandler = new TapHandler(clickThreshold, dblClickThreshold),\r\n            _smartClicks = params.smartClicks,\r\n            _doBind = function (obj, evt, fn, children) {\r\n                if (fn == null) return;\r\n                _each(obj, function () {\r\n                    var _el = _gel(this);\r\n                    if (_smartClicks && evt === \"click\")\r\n                        SmartClickHandler(_el, evt, fn, children);\r\n                    else if (evt === \"tap\" || evt === \"dbltap\" || evt === \"contextmenu\") {\r\n                        tapHandler(_el, evt, fn, children);\r\n                    }\r\n                    else if (evt === \"mouseenter\" || evt == \"mouseexit\")\r\n                        mouseEnterExitHandler(_el, evt, fn, children);\r\n                    else\r\n                        DefaultHandler(_el, evt, fn, children);\r\n                });\r\n            };\r\n\r\n        /**\r\n         * Removes an element from the DOM, and deregisters all event handlers for it. You should use this\r\n         * to ensure you don't leak memory.\r\n         * @method remove\r\n         * @param {String|Element} el Element, or id of the element, to remove.\r\n         * @return {Mottle} The current Mottle instance; you can chain this method.\r\n         */\r\n        this.remove = function (el) {\r\n            _each(el, function () {\r\n                var _el = _gel(this);\r\n                if (_el.__ta) {\r\n                    for (var evt in _el.__ta) {\r\n                        for (var h in _el.__ta[evt]) {\r\n                            _unbind(_el, evt, _el.__ta[evt][h]);\r\n                        }\r\n                    }\r\n                }\r\n                _el.parentNode && _el.parentNode.removeChild(_el);\r\n            });\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Register an event handler, optionally as a delegate for some set of descendant elements. Note\r\n         * that this method takes either 3 or 4 arguments - if you supply 3 arguments it is assumed you have\r\n         * omitted the `children` parameter, and that the event handler should be bound directly to the given element.\r\n         * @method on\r\n         * @param {Element[]|Element|String} el Either an Element, or a CSS spec for a list of elements, or an array of Elements.\r\n         * @param {String} [children] Comma-delimited list of selectors identifying allowed children.\r\n         * @param {String} event Event ID.\r\n         * @param {Function} fn Event handler function.\r\n         * @return {Mottle} The current Mottle instance; you can chain this method.\r\n         */\r\n        this.on = function (el, event, children, fn) {\r\n            var _el = arguments[0],\r\n                _c = arguments.length == 4 ? arguments[2] : null,\r\n                _e = arguments[1],\r\n                _f = arguments[arguments.length - 1];\r\n\r\n            _doBind(_el, _e, _f, _c);\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Cancel delegate event handling for the given function. Note that unlike with 'on' you do not supply\r\n         * a list of child selectors here: it removes event delegation from all of the child selectors for which the\r\n         * given function was registered (if any).\r\n         * @method off\r\n         * @param {Element[]|Element|String} el Element - or ID of element - from which to remove event listener.\r\n         * @param {String} event Event ID.\r\n         * @param {Function} fn Event handler function.\r\n         * @return {Mottle} The current Mottle instance; you can chain this method.\r\n         */\r\n        this.off = function (el, event, fn) {\r\n            _unbind(el, event, fn);\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Triggers some event for a given element.\r\n         * @method trigger\r\n         * @param {Element} el Element for which to trigger the event.\r\n         * @param {String} event Event ID.\r\n         * @param {Event} originalEvent The original event. Should be optional of course, but currently is not, due\r\n         * to the jsPlumb use case that caused this method to be added.\r\n         * @param {Object} [payload] Optional object to set as `payload` on the generated event; useful for message passing.\r\n         * @return {Mottle} The current Mottle instance; you can chain this method.\r\n         */\r\n        this.trigger = function (el, event, originalEvent, payload) {\r\n            // MouseEvent undefined in old IE; that's how we know it's a mouse event.  A fine Microsoft paradox.\r\n            var originalIsMouse = isMouseDevice && (typeof MouseEvent === \"undefined\" || originalEvent == null || originalEvent.constructor === MouseEvent);\r\n\r\n            var eventToBind = (isTouchDevice && !isMouseDevice && touchMap[event]) ? touchMap[event] : event,\r\n                bindingAMouseEvent = !(isTouchDevice && !isMouseDevice && touchMap[event]);\r\n\r\n            var pl = _pageLocation(originalEvent), sl = _screenLocation(originalEvent), cl = _clientLocation(originalEvent);\r\n            _each(el, function () {\r\n                var _el = _gel(this), evt;\r\n                originalEvent = originalEvent || {\r\n                    screenX: sl[0],\r\n                    screenY: sl[1],\r\n                    clientX: cl[0],\r\n                    clientY: cl[1]\r\n                };\r\n\r\n                var _decorate = function (_evt) {\r\n                    if (payload) _evt.payload = payload;\r\n                };\r\n\r\n                var eventGenerators = {\r\n                    \"TouchEvent\": function (evt) {\r\n                        var touch = document.createTouch(window, _el, 0, pl[0], pl[1],\r\n                            sl[0], sl[1],\r\n                            cl[0], cl[1],\r\n                            0, 0, 0, 0);\r\n\r\n                        // https://gist.github.com/sstephenson/448808\r\n                        var touches = document.createTouchList(touch);\r\n                        var targetTouches = document.createTouchList(touch);\r\n                        var changedTouches = document.createTouchList(touch);\r\n                        evt.initTouchEvent(eventToBind, true, true, window, null, sl[0], sl[1],\r\n                            cl[0], cl[1], false, false, false, false,\r\n                            touches, targetTouches, changedTouches, 1, 0);\r\n                    },\r\n                    \"MouseEvents\": function (evt) {\r\n                        evt.initMouseEvent(eventToBind, true, true, window, 0,\r\n                            sl[0], sl[1],\r\n                            cl[0], cl[1],\r\n                            false, false, false, false, 1, _el);\r\n\r\n                        if (Sniff.android) {\r\n                            // Android's touch events are not standard.\r\n                            var t = document.createTouch(window, _el, 0, pl[0], pl[1],\r\n                                sl[0], sl[1],\r\n                                cl[0], cl[1],\r\n                                0, 0, 0, 0);\r\n\r\n                            evt.touches = evt.targetTouches = evt.changedTouches = document.createTouchList(t);\r\n                        }\r\n                    }\r\n                };\r\n\r\n                if (document.createEvent) {\r\n\r\n                    var ite = !bindingAMouseEvent && !originalIsMouse && (isTouchDevice && touchMap[event] && !Sniff.android),\r\n                        evtName = ite ? \"TouchEvent\" : \"MouseEvents\";\r\n\r\n                    evt = document.createEvent(evtName);\r\n                    eventGenerators[evtName](evt);\r\n                    _decorate(evt);\r\n                    _el.dispatchEvent(evt);\r\n                }\r\n                else if (document.createEventObject) {\r\n                    evt = document.createEventObject();\r\n                    evt.eventType = evt.eventName = eventToBind;\r\n                    evt.screenX = sl[0];\r\n                    evt.screenY = sl[1];\r\n                    evt.clientX = cl[0];\r\n                    evt.clientY = cl[1];\r\n                    _decorate(evt);\r\n                    _el.fireEvent('on' + eventToBind, evt);\r\n                }\r\n            });\r\n            return this;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Static method to assist in 'consuming' an element: uses `stopPropagation` where available, or sets `e.returnValue=false` where it is not.\r\n     * @method Mottle.consume\r\n     * @param {Event} e Event to consume\r\n     * @param {Boolean} [doNotPreventDefault=false] If true, does not call `preventDefault()` on the event.\r\n     */\r\n    Mottle.consume = function (e, doNotPreventDefault) {\r\n        if (e.stopPropagation)\r\n            e.stopPropagation();\r\n        else\r\n            e.returnValue = false;\r\n\r\n        if (!doNotPreventDefault && e.preventDefault)\r\n            e.preventDefault();\r\n    };\r\n\r\n    /**\r\n     * Gets the page location corresponding to the given event. For touch events this means get the page location of the first touch.\r\n     * @method Mottle.pageLocation\r\n     * @param {Event} e Event to get page location for.\r\n     * @return {Integer[]} [left, top] for the given event.\r\n     */\r\n    Mottle.pageLocation = _pageLocation;\r\n\r\n    /**\r\n     * Forces touch events to be turned \"on\". Useful for testing: even if you don't have a touch device, you can still\r\n     * trigger a touch event when this is switched on and it will be captured and acted on.\r\n     * @method setForceTouchEvents\r\n     * @param {Boolean} value If true, force touch events to be on.\r\n     */\r\n    Mottle.setForceTouchEvents = function (value) {\r\n        isTouchDevice = value;\r\n    };\r\n\r\n    /**\r\n     * Forces mouse events to be turned \"on\". Useful for testing: even if you don't have a mouse, you can still\r\n     * trigger a mouse event when this is switched on and it will be captured and acted on.\r\n     * @method setForceMouseEvents\r\n     * @param {Boolean} value If true, force mouse events to be on.\r\n     */\r\n    Mottle.setForceMouseEvents = function (value) {\r\n        isMouseDevice = value;\r\n    };\r\n\r\n}).call(this);\r\n\r\n/**\r\n drag/drop functionality for use with jsPlumb but with\r\n no knowledge of jsPlumb. supports multiple scopes (separated by whitespace), dragging\r\n multiple elements, constrain to parent, drop filters, drag start filters, custom\r\n css classes.\r\n\r\n a lot of the functionality of this script is expected to be plugged in:\r\n\r\n addClass\r\n removeClass\r\n\r\n addEvent\r\n removeEvent\r\n\r\n getPosition\r\n setPosition\r\n getSize\r\n\r\n indexOf\r\n intersects\r\n\r\n the name came from here:\r\n\r\n http://mrsharpoblunto.github.io/foswig.js/\r\n\r\n copyright 2015 jsPlumb\r\n */\r\n\r\n;(function() {\r\n\r\n    \"use strict\";\r\n\r\n    var getOffsetRect = function (elem) {\r\n        // (1)\r\n        var box = elem.getBoundingClientRect();\r\n\r\n        var body = document.body;\r\n        var docElem = document.documentElement;\r\n\r\n        // (2)\r\n        var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n        var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n\r\n        // (3)\r\n        var clientTop = docElem.clientTop || body.clientTop || 0;\r\n        var clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n\r\n        // (4)\r\n        var top  = box.top +  scrollTop - clientTop;\r\n        var left = box.left + scrollLeft - clientLeft;\r\n\r\n        return { top: Math.round(top), left: Math.round(left) };\r\n    };\r\n\r\n    var matchesSelector = function(el, selector, ctx) {\r\n        ctx = ctx || el.parentNode;\r\n        var possibles = ctx.querySelectorAll(selector);\r\n        for (var i = 0; i < possibles.length; i++) {\r\n            if (possibles[i] === el)\r\n                return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var iev = (function() {\r\n            var rv = -1;\r\n            if (navigator.appName == 'Microsoft Internet Explorer') {\r\n                var ua = navigator.userAgent,\r\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\r\n                if (re.exec(ua) != null)\r\n                    rv = parseFloat(RegExp.$1);\r\n            }\r\n            return rv;\r\n        })(),\r\n        DEFAULT_GRID_X = 50,\r\n        DEFAULT_GRID_Y = 50,\r\n        isIELT9 = iev > -1 && iev < 9,\r\n        _pl = function(e) {\r\n            if (isIELT9) {\r\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\r\n            }\r\n            else {\r\n                var ts = _touches(e), t = _getTouch(ts, 0);\r\n                // this is for iPad. may not fly for Android.\r\n                return [t.pageX, t.pageY];\r\n            }\r\n        },\r\n        _getTouch = function(touches, idx) { return touches.item ? touches.item(idx) : touches[idx]; },\r\n        _touches = function(e) {\r\n            return e.touches && e.touches.length > 0 ? e.touches :\r\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\r\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\r\n                [ e ];\r\n        },\r\n        _classes = {\r\n            draggable:\"katavorio-draggable\",    // draggable elements\r\n            droppable:\"katavorio-droppable\",    // droppable elements\r\n            drag : \"katavorio-drag\",            // elements currently being dragged\r\n            selected:\"katavorio-drag-selected\", // elements in current drag selection\r\n            active : \"katavorio-drag-active\",   // droppables that are targets of a currently dragged element\r\n            hover : \"katavorio-drag-hover\",     // droppables over which a matching drag element is hovering\r\n            noSelect : \"katavorio-drag-no-select\" // added to the body to provide a hook to suppress text selection\r\n        },\r\n        _defaultScope = \"katavorio-drag-scope\",\r\n        _events = [ \"stop\", \"start\", \"drag\", \"drop\", \"over\", \"out\" ],\r\n        _devNull = function() {},\r\n        _true = function() { return true; },\r\n        _foreach = function(l, fn, from) {\r\n            for (var i = 0; i < l.length; i++) {\r\n                if (l[i] != from)\r\n                    fn(l[i]);\r\n            }\r\n        },\r\n        _setDroppablesActive = function(dd, val, andHover, drag) {\r\n            _foreach(dd, function(e) {\r\n                e.setActive(val);\r\n                if (val) e.updatePosition();\r\n                if (andHover) e.setHover(drag, val);\r\n            });\r\n        },\r\n        _each = function(obj, fn) {\r\n            if (obj == null) return;\r\n            obj = (typeof obj !== \"string\") && (obj.tagName == null && obj.length != null) ? obj : [ obj ];\r\n            for (var i = 0; i < obj.length; i++)\r\n                fn.apply(obj[i], [ obj[i] ]);\r\n        },\r\n        _consume = function(e) {\r\n            if (e.stopPropagation) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n            }\r\n            else {\r\n                e.returnValue = false;\r\n            }\r\n        },\r\n        _defaultInputFilterSelector = \"input,textarea,select,button,option\",\r\n    //\r\n    // filters out events on all input elements, like textarea, checkbox, input, select.\r\n        _inputFilter = function(e, el, _katavorio) {\r\n            var t = e.srcElement || e.target;\r\n            return !matchesSelector(t, _katavorio.getInputFilterSelector(), el);\r\n        };\r\n\r\n    var Super = function(el, params, css, scope) {\r\n        this.params = params || {};\r\n        this.el = el;\r\n        this.params.addClass(this.el, this._class);\r\n        this.uuid = _uuid();\r\n        var enabled = true;\r\n        this.setEnabled = function(e) { enabled = e; };\r\n        this.isEnabled = function() { return enabled; };\r\n        this.toggleEnabled = function() { enabled = !enabled; };\r\n        this.setScope = function(scopes) {\r\n            this.scopes = scopes ? scopes.split(/\\s+/) : [ scope ];\r\n        };\r\n        this.addScope = function(scopes) {\r\n            var m = {};\r\n            _each(this.scopes, function(s) { m[s] = true;});\r\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { m[s] = true;});\r\n            this.scopes = [];\r\n            for (var i in m) this.scopes.push(i);\r\n        };\r\n        this.removeScope = function(scopes) {\r\n            var m = {};\r\n            _each(this.scopes, function(s) { m[s] = true;});\r\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { delete m[s];});\r\n            this.scopes = [];\r\n            for (var i in m) this.scopes.push(i);\r\n        };\r\n        this.toggleScope = function(scopes) {\r\n            var m = {};\r\n            _each(this.scopes, function(s) { m[s] = true;});\r\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) {\r\n                if (m[s]) delete m[s];\r\n                else m[s] = true;\r\n            });\r\n            this.scopes = [];\r\n            for (var i in m) this.scopes.push(i);\r\n        };\r\n        this.setScope(params.scope);\r\n        this.k = params.katavorio;\r\n        return params.katavorio;\r\n    };\r\n\r\n    var Drag = function(el, params, css, scope) {\r\n        this._class = css.draggable;\r\n        var k = Super.apply(this, arguments);\r\n        this.rightButtonCanDrag = this.params.rightButtonCanDrag;\r\n        var downAt = [0,0], posAtDown = null, moving = false,\r\n            consumeStartEvent = this.params.consumeStartEvent !== false,\r\n            dragEl = this.el,\r\n            clone = this.params.clone,\r\n            scroll = this.params.scroll,\r\n            _multipleDrop = params.multipleDrop !== false;\r\n\r\n        var snapThreshold = params.snapThreshold || 5,\r\n            _snap = function(pos, x, y, thresholdX, thresholdY) {\r\n                thresholdX = thresholdX || snapThreshold;\r\n                thresholdY = thresholdY || snapThreshold;\r\n                var _dx = Math.floor(pos[0] / x),\r\n                    _dxl = x * _dx,\r\n                    _dxt = _dxl + x,\r\n                    _x = Math.abs(pos[0] - _dxl) <= thresholdX ? _dxl : Math.abs(_dxt - pos[0]) <= thresholdX ? _dxt : pos[0];\r\n\r\n                var _dy = Math.floor(pos[1] / y),\r\n                    _dyl = y * _dy,\r\n                    _dyt = _dyl + y,\r\n                    _y = Math.abs(pos[1] - _dyl) <= thresholdY ? _dyl : Math.abs(_dyt - pos[1]) <= thresholdY ? _dyt : pos[1];\r\n\r\n                return [ _x, _y];\r\n            };\r\n\r\n        this.toGrid = function(pos) {\r\n            if (this.params.grid == null) {\r\n                return pos;\r\n            }\r\n            else {\r\n                return _snap(pos, this.params.grid[0], this.params.grid[1]);\r\n            }\r\n        };\r\n\r\n        this.snap = function(x, y) {\r\n            if (dragEl == null) return;\r\n            x = x || (this.params.grid ? this.params.grid[0] : DEFAULT_GRID_X);\r\n            y = y || (this.params.grid ? this.params.grid[1] : DEFAULT_GRID_Y);\r\n            var p = this.params.getPosition(dragEl);\r\n            this.params.setPosition(dragEl, _snap(p, x, y, x, y));\r\n        };\r\n\r\n        this.constrain = typeof this.params.constrain === \"function\" ? this.params.constrain  : (this.params.constrain || this.params.containment) ? function(pos) {\r\n            return [\r\n                Math.max(0, Math.min(constrainRect.w - this.size[0], pos[0])),\r\n                Math.max(0, Math.min(constrainRect.h - this.size[1], pos[1]))\r\n            ];\r\n        } : function(pos) { return pos; };\r\n\r\n        var _assignId = function(obj) {\r\n                if (typeof obj == \"function\") {\r\n                    obj._katavorioId = _uuid();\r\n                    return obj._katavorioId;\r\n                } else {\r\n                    return obj;\r\n                }\r\n            },\r\n        // a map of { spec -> [ fn, exclusion ] } entries.\r\n            _filters = {},\r\n            _testFilter = function(e) {\r\n                for (var key in _filters) {\r\n                    var f = _filters[key];\r\n                    var rv = f[0](e);\r\n                    if (f[1]) rv = !rv;\r\n                    if (!rv) return false;\r\n                }\r\n                return true;\r\n            },\r\n            _setFilter = this.setFilter = function(f, _exclude) {\r\n                if (f) {\r\n                    var key = _assignId(f);\r\n                    _filters[key] = [\r\n                        function(e) {\r\n                            var t = e.srcElement || e.target, m;\r\n                            if (typeof f === \"string\") {\r\n                                m = matchesSelector(t, f, el);\r\n                            }\r\n                            else if (typeof f === \"function\") {\r\n                                m = f(e, el);\r\n                            }\r\n                            return m;\r\n                        },\r\n                            _exclude !== false\r\n                    ];\r\n\r\n                }\r\n            },\r\n            _addFilter = this.addFilter = _setFilter,\r\n            _removeFilter = this.removeFilter = function(f) {\r\n                var key = typeof f == \"function\" ? f._katavorioId : f;\r\n                delete _filters[key];\r\n            };\r\n\r\n        this.clearAllFilters = function() {\r\n            _filters = {};\r\n        };\r\n\r\n        this.canDrag = this.params.canDrag || _true;\r\n\r\n        var constrainRect,\r\n            matchingDroppables = [], intersectingDroppables = [];\r\n\r\n        this.downListener = function(e) {\r\n            var isNotRightClick = this.rightButtonCanDrag || (e.which !== 3 && e.button !== 2);\r\n            if (isNotRightClick && this.isEnabled() && this.canDrag()) {\r\n                var _f =  _testFilter(e) && _inputFilter(e, this.el, this.k);\r\n                if (_f) {\r\n                    if (!clone)\r\n                        dragEl = this.el;\r\n                    else {\r\n                        dragEl = this.el.cloneNode(true);\r\n                        dragEl.setAttribute(\"id\", null);\r\n                        dragEl.style.position = \"absolute\";\r\n                        // the clone node is added to the body; getOffsetRect gives us a value\r\n                        // relative to the body.\r\n                        var b = getOffsetRect(this.el);\r\n                        dragEl.style.left = b.left + \"px\";\r\n                        dragEl.style.top = b.top + \"px\";\r\n                        document.body.appendChild(dragEl);\r\n                    }\r\n                    consumeStartEvent && _consume(e);\r\n                    downAt = _pl(e);\r\n                    //\r\n                    this.params.bind(document, \"mousemove\", this.moveListener);\r\n                    this.params.bind(document, \"mouseup\", this.upListener);\r\n                    k.markSelection(this);\r\n                    this.params.addClass(document.body, css.noSelect);\r\n                }\r\n                else if (this.params.consumeFilteredEvents) {\r\n                    _consume(e);\r\n                }\r\n            }\r\n        }.bind(this);\r\n\r\n        this.moveListener = function(e) {\r\n            if (downAt) {\r\n                if (!moving) {\r\n                    var _continue = this.params.events[\"start\"]({el:this.el, pos:posAtDown, e:e, drag:this});\r\n                    if (_continue !== false) {\r\n                        if (!downAt) return;\r\n                        this.mark(true);\r\n                        moving = true;\r\n                    }\r\n                }\r\n\r\n                // it is possible that the start event caused the drag to be aborted. So we check\r\n                // again that we are currently dragging.\r\n                if (downAt) {\r\n                    intersectingDroppables.length = 0;\r\n                    var pos = _pl(e), dx = pos[0] - downAt[0], dy = pos[1] - downAt[1],\r\n                        z = this.params.ignoreZoom ? 1 : k.getZoom();\r\n                    dx /= z;\r\n                    dy /= z;\r\n                    this.moveBy(dx, dy, e);\r\n                    k.updateSelection(dx, dy, this);\r\n                }\r\n            }\r\n        }.bind(this);\r\n\r\n        this.upListener = function(e) {\r\n            if (downAt) {\r\n                downAt = null;\r\n                this.params.unbind(document, \"mousemove\", this.moveListener);\r\n                this.params.unbind(document, \"mouseup\", this.upListener);\r\n                this.params.removeClass(document.body, css.noSelect);\r\n                this.unmark(e);\r\n                k.unmarkSelection(this, e);\r\n                this.stop(e);\r\n                k.notifySelectionDragStop(this, e);\r\n                moving = false;\r\n                if (clone) {\r\n                    dragEl && dragEl.parentNode && dragEl.parentNode.removeChild(dragEl);\r\n                    dragEl = null;\r\n                }\r\n            }\r\n        }.bind(this);\r\n\r\n        this.getFilters = function() { return _filters; };\r\n\r\n        this.abort = function() {\r\n            if (downAt != null)\r\n                this.upListener();\r\n        };\r\n\r\n        this.getDragElement = function() {\r\n            return dragEl || this.el;\r\n        };\r\n\r\n        this.notifyStart = function(e) {\r\n            this.params.events[\"start\"]({el:this.el, pos:this.params.getPosition(dragEl), e:e, drag:this});\r\n        };\r\n\r\n        this.stop = function(e, force) {\r\n            if (force || moving) {\r\n                var positions = [],\r\n                    sel = k.getSelection(),\r\n                    dPos = this.params.getPosition(dragEl);\r\n\r\n                if (sel.length > 1) {\r\n                    for (var i = 0; i < sel.length; i++) {\r\n                        var p = this.params.getPosition(sel[i].el);\r\n                        positions.push([ sel[i].el, { left: p[0], top: p[1] }, sel[i] ]);\r\n                    }\r\n                }\r\n                else {\r\n                    positions.push([ dragEl, {left:dPos[0], top:dPos[1]}, this ]);\r\n                }\r\n\r\n                this.params.events[\"stop\"]({\r\n                    el: dragEl, pos: dPos, e: e, drag: this, selection:positions\r\n                });\r\n            }\r\n        };\r\n\r\n        this.mark = function(andNotify) {\r\n            posAtDown = this.params.getPosition(dragEl);\r\n            this.size = this.params.getSize(dragEl);\r\n            matchingDroppables = k.getMatchingDroppables(this);\r\n            _setDroppablesActive(matchingDroppables, true, false, this);\r\n            this.params.addClass(dragEl, this.params.dragClass || css.drag);\r\n            if (this.params.constrain || this.params.containment) {\r\n                var cs = this.params.getSize(dragEl.parentNode);\r\n                constrainRect = { w:cs[0], h:cs[1] };\r\n            }\r\n            if (andNotify) {\r\n                k.notifySelectionDragStart(this);\r\n            }\r\n        };\r\n        this.unmark = function(e) {\r\n            _setDroppablesActive(matchingDroppables, false, true, this);\r\n            this.params.removeClass(dragEl, this.params.dragClass || css.drag);\r\n            matchingDroppables.length = 0;\r\n            for (var i = 0; i < intersectingDroppables.length; i++) {\r\n                var retVal = intersectingDroppables[i].drop(this, e);\r\n                if (retVal === true) break;\r\n            }\r\n        };\r\n        this.moveBy = function(dx, dy, e) {\r\n            intersectingDroppables.length = 0;\r\n            var cPos = this.constrain(this.toGrid(([posAtDown[0] + dx, posAtDown[1] + dy])), dragEl),\r\n                rect = { x:cPos[0], y:cPos[1], w:this.size[0], h:this.size[1]};\r\n            this.params.setPosition(dragEl, cPos);\r\n            for (var i = 0; i < matchingDroppables.length; i++) {\r\n                var r2 = { x:matchingDroppables[i].position[0], y:matchingDroppables[i].position[1], w:matchingDroppables[i].size[0], h:matchingDroppables[i].size[1]};\r\n                //if (this.params.intersects(rect, r2) && matchingDroppables[i].canDrop(this) && (_multipleDrop || intersectingDroppables.length == 0)) {\r\n                if (this.params.intersects(rect, r2) && matchingDroppables[i].canDrop(this)) {\r\n                    intersectingDroppables.push(matchingDroppables[i]);\r\n                    matchingDroppables[i].setHover(this, true, e);\r\n                }\r\n                else if (matchingDroppables[i].isHover()) {\r\n                    matchingDroppables[i].setHover(this, false, e);\r\n                }\r\n            }\r\n            this.params.events[\"drag\"]({el:this.el, pos:cPos, e:e, drag:this});\r\n\r\n            /* test to see if the parent needs to be scrolled\r\n             if (scroll) {\r\n             var pnsl = dragEl.parentNode.scrollLeft, pnst = dragEl.parentNode.scrollTop;\r\n             console.log(\"scroll!\", pnsl, pnst);\r\n             }*/\r\n        };\r\n        this.destroy = function() {\r\n            this.params.unbind(this.el, \"mousedown\", this.downListener);\r\n            this.params.unbind(document, \"mousemove\", this.moveListener);\r\n            this.params.unbind(document, \"mouseup\", this.upListener);\r\n            this.downListener = null;\r\n            this.upListener = null;\r\n            this.moveListener = null;\r\n            //this.params = null;\r\n            //this.el = null;\r\n            //dragEl = null;\r\n        };\r\n\r\n        // init:register mousedown, and perhaps set a filter\r\n        this.params.bind(this.el, \"mousedown\", this.downListener);\r\n\r\n        // if handle provded, use that.  otherwise, try to set a filter.\r\n        // note that a `handle` selector always results in filterExclude being set to false, ie.\r\n        // the selector defines the handle element(s).\r\n        if (this.params.handle)\r\n            _setFilter(this.params.handle, false);\r\n        else\r\n            _setFilter(this.params.filter, this.params.filterExclude);\r\n    };\r\n\r\n    var Drop = function(el, params, css, scope) {\r\n        this._class = css.droppable;\r\n        this.params = params || {};\r\n        this._activeClass = params.activeClass || css.active;\r\n        this._hoverClass = params.hoverClass || css.hover;\r\n        Super.apply(this, arguments);\r\n        var hover = false;\r\n\r\n        this.setActive = function(val) {\r\n            this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._activeClass);\r\n        };\r\n\r\n        this.updatePosition = function() {\r\n            this.position = this.params.getPosition(this.el);\r\n            this.size = this.params.getSize(this.el);\r\n        };\r\n\r\n        this.canDrop = this.params.canDrop || function(drag) {\r\n            return true;\r\n        };\r\n\r\n        this.isHover = function() { return hover; };\r\n\r\n        this.setHover = function(drag, val, e) {\r\n            // if turning off hover but this was not the drag that caused the hover, ignore.\r\n            if (val || this.el._katavorioDragHover == null || this.el._katavorioDragHover == drag.el._katavorio) {\r\n                this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._hoverClass);\r\n                //this.el._katavorioDragHover = val ? drag.el._katavorio : null;\r\n                this.el._katavorioDragHover = val ? drag.el._katavorio : null;\r\n                if (hover !== val)\r\n                    this.params.events[val ? \"over\" : \"out\"]({el:this.el, e:e, drag:drag, drop:this});\r\n                hover = val;\r\n            }\r\n        };\r\n\r\n        this.drop = function(drag, event) {\r\n            return this.params.events[\"drop\"]({ drag:drag, e:event, drop:this });\r\n        };\r\n\r\n        this.destroy = function() {\r\n            this._class = null;\r\n            this._activeClass = null;\r\n            this._hoverClass = null;\r\n            //this.params = null;\r\n            hover = null;\r\n            //this.el = null;\r\n        };\r\n    };\r\n\r\n    var _uuid = function() {\r\n        return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n            var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\r\n            return v.toString(16);\r\n        }));\r\n    };\r\n\r\n    var _gel = function(el) {\r\n        if (el == null) return null;\r\n        el = typeof el === \"string\" ? document.getElementById(el) : el;\r\n        if (el == null) return null;\r\n        el._katavorio = el._katavorio || _uuid();\r\n        return el;\r\n    };\r\n\r\n    this.Katavorio = function(katavorioParams) {\r\n\r\n        var _selection = [],\r\n            _selectionMap = {};\r\n        this._dragsByScope = {};\r\n        this._dropsByScope = {};\r\n        var _zoom = 1,\r\n            _reg = function(obj, map) {\r\n                for(var i = 0; i < obj.scopes.length; i++) {\r\n                    map[obj.scopes[i]] = map[obj.scopes[i]] || [];\r\n                    map[obj.scopes[i]].push(obj);\r\n                }\r\n            },\r\n            _unreg = function(obj, map) {\r\n                var c = 0;\r\n                for(var i = 0; i < obj.scopes.length; i++) {\r\n                    if (map[obj.scopes[i]]) {\r\n                        var idx = katavorioParams.indexOf(map[obj.scopes[i]], obj);\r\n                        if (idx != -1) {\r\n                            map[obj.scopes[i]].splice(idx, 1);\r\n                            c++;\r\n                        }\r\n                    }\r\n                }\r\n                return c > 0 ;\r\n            },\r\n            _getMatchingDroppables = this.getMatchingDroppables = function(drag) {\r\n                var dd = [], _m = {};\r\n                for (var i = 0; i < drag.scopes.length; i++) {\r\n                    var _dd = this._dropsByScope[drag.scopes[i]];\r\n                    if (_dd) {\r\n                        for (var j = 0; j < _dd.length; j++) {\r\n                            //if (_dd[j].canDrop(drag) &&  !_m[_dd[j].el._katavorio] && _dd[j].el !== drag.el) {\r\n                            if (_dd[j].canDrop(drag) &&  !_m[_dd[j].uuid] && _dd[j].el !== drag.el) {\r\n                                _m[_dd[j].uuid] = true;\r\n                                dd.push(_dd[j]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return dd;\r\n            },\r\n            _prepareParams = function(p) {\r\n                p = p || {};\r\n                var _p = {\r\n                    events:{}\r\n                };\r\n                for (var i in katavorioParams) _p[i] = katavorioParams[i];\r\n                for (var i in p) _p[i] = p[i];\r\n                // events\r\n\r\n                for (var i = 0; i < _events.length; i++) {\r\n                    _p.events[_events[i]] = p[_events[i]] || _devNull;\r\n                }\r\n                _p.katavorio = this;\r\n                return _p;\r\n            }.bind(this),\r\n            _css = {},\r\n            overrideCss = katavorioParams.css || {},\r\n            _scope = katavorioParams.scope || _defaultScope;\r\n\r\n        // prepare map of css classes based on defaults frst, then optional overrides\r\n        for (var i in _classes) _css[i] = _classes[i];\r\n        for (var i in overrideCss) _css[i] = overrideCss[i];\r\n\r\n        var inputFilterSelector = katavorioParams.inputFilterSelector || _defaultInputFilterSelector;\r\n        /**\r\n         * Gets the selector identifying which input elements to filter from drag events.\r\n         * @method getInputFilterSelector\r\n         * @return {String} Current input filter selector.\r\n         */\r\n        this.getInputFilterSelector = function() { return inputFilterSelector; };\r\n\r\n        /**\r\n         * Sets the selector identifying which input elements to filter from drag events.\r\n         * @method setInputFilterSelector\r\n         * @param {String} selector Input filter selector to set.\r\n         * @return {Katavorio} Current instance; method may be chained.\r\n         */\r\n        this.setInputFilterSelector = function(selector) {\r\n            inputFilterSelector = selector;\r\n            return this;\r\n        };\r\n\r\n        this.draggable = function(el, params) {\r\n            var o = [];\r\n            _each(el, function(_el) {\r\n                _el = _gel(_el);\r\n                if (_el != null) {\r\n                    var p = _prepareParams(params);\r\n                    _el._katavorioDrag = new Drag(_el, p, _css, _scope);\r\n                    _reg(_el._katavorioDrag, this._dragsByScope);\r\n                    o.push(_el._katavorioDrag);\r\n                    katavorioParams.addClass(_el, _css.draggable);\r\n                }\r\n            }.bind(this));\r\n            return o;\r\n\r\n        };\r\n\r\n        this.droppable = function(el, params) {\r\n            var o = [];\r\n            _each(el, function(_el) {\r\n                _el = _gel(_el);\r\n                if (_el != null) {\r\n                    _el._katavorioDrop = new Drop(_el, _prepareParams(params), _css, _scope);\r\n                    _reg(_el._katavorioDrop, this._dropsByScope);\r\n                    o.push(_el._katavorioDrop);\r\n                    katavorioParams.addClass(_el, _css.droppable);\r\n                }\r\n            }.bind(this));\r\n            return o;\r\n        };\r\n\r\n        /**\r\n         * @name Katavorio#select\r\n         * @function\r\n         * @desc Adds an element to the current selection (for multiple node drag)\r\n         * @param {Element|String} DOM element - or id of the element - to add.\r\n         */\r\n        this.select = function(el) {\r\n            _each(el, function() {\r\n                var _el = _gel(this);\r\n                if (_el && _el._katavorioDrag) {\r\n                    if (!_selectionMap[_el._katavorio]) {\r\n                        _selection.push(_el._katavorioDrag);\r\n                        _selectionMap[_el._katavorio] = [ _el, _selection.length - 1 ];\r\n                        katavorioParams.addClass(_el, _css.selected);\r\n                    }\r\n                }\r\n            });\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * @name Katavorio#deselect\r\n         * @function\r\n         * @desc Removes an element from the current selection (for multiple node drag)\r\n         * @param {Element|String} DOM element - or id of the element - to remove.\r\n         */\r\n        this.deselect = function(el) {\r\n            _each(el, function() {\r\n                var _el = _gel(this);\r\n                if (_el && _el._katavorio) {\r\n                    var e = _selectionMap[_el._katavorio];\r\n                    if (e) {\r\n                        var _s = [];\r\n                        for (var i = 0; i < _selection.length; i++)\r\n                            if (_selection[i].el !== _el) _s.push(_selection[i]);\r\n                        _selection = _s;\r\n                        delete _selectionMap[_el._katavorio];\r\n                        katavorioParams.removeClass(_el, _css.selected);\r\n                    }\r\n                }\r\n            });\r\n            return this;\r\n        };\r\n\r\n        this.deselectAll = function() {\r\n            for (var i in _selectionMap) {\r\n                var d = _selectionMap[i];\r\n                katavorioParams.removeClass(d[0], _css.selected);\r\n            }\r\n\r\n            _selection.length = 0;\r\n            _selectionMap = {};\r\n        };\r\n\r\n        this.markSelection = function(drag) {\r\n            _foreach(_selection, function(e) { e.mark(); }, drag);\r\n        };\r\n\r\n        this.unmarkSelection = function(drag, event) {\r\n            _foreach(_selection, function(e) { e.unmark(event); }, drag);\r\n        };\r\n\r\n        this.getSelection = function() { return _selection.slice(0); };\r\n\r\n        this.updateSelection = function(dx, dy, drag) {\r\n            _foreach(_selection, function(e) { e.moveBy(dx, dy); }, drag);\r\n        };\r\n\r\n        this.notifySelectionDragStop = function(drag, evt) {\r\n            _foreach(_selection, function(e) { e.stop(evt, true); }, drag);\r\n        };\r\n\r\n        this.notifySelectionDragStart = function(drag, evt) {\r\n            _foreach(_selection, function(e) { e.notifyStart(evt);}, drag);\r\n        };\r\n\r\n        this.setZoom = function(z) { _zoom = z; };\r\n        this.getZoom = function() { return _zoom; };\r\n\r\n        // does the work of changing scopes\r\n        var _scopeManip = function(kObj, scopes, map, fn) {\r\n            if (kObj != null) {\r\n                _unreg(kObj, map);  // deregister existing scopes\r\n                kObj[fn](scopes); // set scopes\r\n                _reg(kObj, map); // register new ones\r\n            }\r\n        };\r\n\r\n        _each([ \"set\", \"add\", \"remove\", \"toggle\"], function(v) {\r\n            this[v + \"Scope\"] = function(el, scopes) {\r\n                _scopeManip(el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\r\n                _scopeManip(el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\r\n            }.bind(this);\r\n            this[v + \"DragScope\"] = function(el, scopes) {\r\n                _scopeManip(el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\r\n            }.bind(this);\r\n            this[v + \"DropScope\"] = function(el, scopes) {\r\n                _scopeManip(el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\r\n            }.bind(this);\r\n        }.bind(this));\r\n\r\n        this.snapToGrid = function(x, y) {\r\n            for (var s in this._dragsByScope) {\r\n                _foreach(this._dragsByScope[s], function(d) { d.snap(x, y); });\r\n            }\r\n        };\r\n\r\n        this.getDragsForScope = function(s) { return this._dragsByScope[s]; };\r\n        this.getDropsForScope = function(s) { return this._dropsByScope[s]; };\r\n\r\n        var _destroy = function(el, type, map) {\r\n            el = _gel(el);\r\n            if (el[type]) {\r\n                if (_unreg(el[type], map))\r\n                    el[type].destroy();\r\n                el[type] = null;\r\n            }\r\n        };\r\n\r\n        this.elementRemoved = function(el) {\r\n            this.destroyDraggable(el);\r\n            this.destroyDroppable(el);\r\n        };\r\n\r\n        this.destroyDraggable = function(el) {\r\n            _destroy(el, \"_katavorioDrag\", this._dragsByScope);\r\n        };\r\n\r\n        this.destroyDroppable = function(el) {\r\n            _destroy(el, \"_katavorioDrop\", this._dropsByScope);\r\n        };\r\n\r\n        this.reset = function() {\r\n            this._dragsByScope = {};\r\n            this._dropsByScope = {};\r\n            _selection = [];\r\n            _selectionMap = {};\r\n        };\r\n    };\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n *\r\n * Title:jsPlumb 1.7.6\r\n *\r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.\r\n *\r\n * This file contains utility functions that run in both browsers and headless.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n;\r\n(function () {\r\n\r\n    var _isa = function (a) {\r\n            return Object.prototype.toString.call(a) === \"[object Array]\";\r\n        },\r\n        _isnum = function (n) {\r\n            return Object.prototype.toString.call(n) === \"[object Number]\";\r\n        },\r\n        _iss = function (s) {\r\n            return typeof s === \"string\";\r\n        },\r\n        _isb = function (s) {\r\n            return typeof s === \"boolean\";\r\n        },\r\n        _isnull = function (s) {\r\n            return s == null;\r\n        },\r\n        _iso = function (o) {\r\n            return o == null ? false : Object.prototype.toString.call(o) === \"[object Object]\";\r\n        },\r\n        _isd = function (o) {\r\n            return Object.prototype.toString.call(o) === \"[object Date]\";\r\n        },\r\n        _isf = function (o) {\r\n            return Object.prototype.toString.call(o) === \"[object Function]\";\r\n        },\r\n        _ise = function (o) {\r\n            for (var i in o) {\r\n                if (o.hasOwnProperty(i)) return false;\r\n            }\r\n            return true;\r\n        };\r\n\r\n    var root = this;\r\n    var exports = root.jsPlumbUtil = {\r\n        isArray: _isa,\r\n        isString: _iss,\r\n        isBoolean: _isb,\r\n        isNull: _isnull,\r\n        isObject: _iso,\r\n        isDate: _isd,\r\n        isFunction: _isf,\r\n        isEmpty: _ise,\r\n        isNumber: _isnum,\r\n        clone: function (a) {\r\n            if (_iss(a)) return \"\" + a;\r\n            else if (_isb(a)) return !!a;\r\n            else if (_isd(a)) return new Date(a.getTime());\r\n            else if (_isf(a)) return a;\r\n            else if (_isa(a)) {\r\n                var b = [];\r\n                for (var i = 0; i < a.length; i++)\r\n                    b.push(this.clone(a[i]));\r\n                return b;\r\n            }\r\n            else if (_iso(a)) {\r\n                var c = {};\r\n                for (var j in a)\r\n                    c[j] = this.clone(a[j]);\r\n                return c;\r\n            }\r\n            else return a;\r\n        },\r\n        merge: function (a, b, collations) {\r\n            // first change the collations array - if present - into a lookup table, because its faster.\r\n            var cMap = {}, ar, i;\r\n            collations = collations || [];\r\n            for (i = 0; i < collations.length; i++)\r\n                cMap[collations[i]] = true;\r\n\r\n            var c = this.clone(a);\r\n            for (i in b) {\r\n                if (c[i] == null) {\r\n                    c[i] = b[i];\r\n                }\r\n                else if (_iss(b[i]) || _isb(b[i])) {\r\n                    if (!cMap[i]) {\r\n                        c[i] = b[i]; // if we dont want to collate, just copy it in.\r\n                    }\r\n                    else {\r\n                        ar = [];\r\n                        // if c's object is also an array we can keep its values.\r\n                        ar.push.apply(ar, _isa(c[i]) ? c[i] : [ c[i] ]);\r\n                        ar.push.apply(ar, _isa(b[i]) ? b[i] : [ b[i] ]);\r\n                        c[i] = ar;\r\n                    }\r\n                }\r\n                else {\r\n                    if (_isa(b[i])) {\r\n                        ar = [];\r\n                        // if c's object is also an array we can keep its values.\r\n                        if (_isa(c[i])) ar.push.apply(ar, c[i]);\r\n                        ar.push.apply(ar, b[i]);\r\n                        c[i] = ar;\r\n                    }\r\n                    else if (_iso(b[i])) {\r\n                        // overwite c's value with an object if it is not already one.\r\n                        if (!_iso(c[i]))\r\n                            c[i] = {};\r\n                        for (var j in b[i]) {\r\n                            c[i][j] = b[i][j];\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n            return c;\r\n        },\r\n        replace: function (inObj, path, value) {\r\n            if (inObj == null) return;\r\n            var q = inObj, t = q;\r\n            path.replace(/([^\\.])+/g, function (term, lc, pos, str) {\r\n                var array = term.match(/([^\\[0-9]+){1}(\\[)([0-9+])/),\r\n                    last = pos + term.length >= str.length,\r\n                    _getArray = function () {\r\n                        return t[array[1]] || (function () {\r\n                            t[array[1]] = [];\r\n                            return t[array[1]];\r\n                        })();\r\n                    };\r\n\r\n                if (last) {\r\n                    // set term = value on current t, creating term as array if necessary.\r\n                    if (array)\r\n                        _getArray()[array[3]] = value;\r\n                    else\r\n                        t[term] = value;\r\n                }\r\n                else {\r\n                    // set to current t[term], creating t[term] if necessary.\r\n                    if (array) {\r\n                        var a = _getArray();\r\n                        t = a[array[3]] || (function () {\r\n                            a[array[3]] = {};\r\n                            return a[array[3]];\r\n                        })();\r\n                    }\r\n                    else\r\n                        t = t[term] || (function () {\r\n                            t[term] = {};\r\n                            return t[term];\r\n                        })();\r\n                }\r\n            });\r\n\r\n            return inObj;\r\n        },\r\n        //\r\n        // chain a list of functions, supplied by [ object, method name, args ], and return on the first\r\n        // one that returns the failValue. if none return the failValue, return the successValue.\r\n        //\r\n        functionChain: function (successValue, failValue, fns) {\r\n            for (var i = 0; i < fns.length; i++) {\r\n                var o = fns[i][0][fns[i][1]].apply(fns[i][0], fns[i][2]);\r\n                if (o === failValue) {\r\n                    return o;\r\n                }\r\n            }\r\n            return successValue;\r\n        },\r\n        // take the given model and expand out any parameters.\r\n        populate: function (model, values) {\r\n            // for a string, see if it has parameter matches, and if so, try to make the substitutions.\r\n            var getValue = function (fromString) {\r\n                    var matches = fromString.match(/(\\${.*?})/g);\r\n                    if (matches != null) {\r\n                        for (var i = 0; i < matches.length; i++) {\r\n                            var val = values[matches[i].substring(2, matches[i].length - 1)] || \"\";\r\n                            if (val != null) {\r\n                                fromString = fromString.replace(matches[i], val);\r\n                            }\r\n                        }\r\n                    }\r\n                    return fromString;\r\n                },\r\n            // process one entry.\r\n                _one = function (d) {\r\n                    if (d != null) {\r\n                        if (_iss(d)) {\r\n                            return getValue(d);\r\n                        }\r\n                        else if (_isa(d)) {\r\n                            var r = [];\r\n                            for (var i = 0; i < d.length; i++)\r\n                                r.push(_one(d[i]));\r\n                            return r;\r\n                        }\r\n                        else if (_iso(d)) {\r\n                            var s = {};\r\n                            for (var j in d) {\r\n                                s[j] = _one(d[j]);\r\n                            }\r\n                            return s;\r\n                        }\r\n                        else {\r\n                            return d;\r\n                        }\r\n                    }\r\n                };\r\n\r\n            return _one(model);\r\n        },\r\n        convertStyle: function (s, ignoreAlpha) {\r\n            // TODO: jsPlumb should support a separate 'opacity' style member.\r\n            if (\"transparent\" === s) return s;\r\n            var o = s,\r\n                pad = function (n) {\r\n                    return n.length == 1 ? \"0\" + n : n;\r\n                },\r\n                hex = function (k) {\r\n                    return pad(Number(k).toString(16));\r\n                },\r\n                pattern = /(rgb[a]?\\()(.*)(\\))/;\r\n            if (s.match(pattern)) {\r\n                var parts = s.match(pattern)[2].split(\",\");\r\n                o = \"#\" + hex(parts[0]) + hex(parts[1]) + hex(parts[2]);\r\n                if (!ignoreAlpha && parts.length == 4)\r\n                    o = o + hex(parts[3]);\r\n            }\r\n            return o;\r\n        },\r\n        findWithFunction: function (a, f) {\r\n            if (a)\r\n                for (var i = 0; i < a.length; i++) if (f(a[i])) return i;\r\n            return -1;\r\n        },\r\n        indexOf: function (l, v) {\r\n            return l.indexOf ? l.indexOf(v) : exports.findWithFunction(l, function (_v) {\r\n                return _v == v;\r\n            });\r\n        },\r\n        removeWithFunction: function (a, f) {\r\n            var idx = exports.findWithFunction(a, f);\r\n            if (idx > -1) a.splice(idx, 1);\r\n            return idx != -1;\r\n        },\r\n        remove: function (l, v) {\r\n            var idx = exports.indexOf(l, v);\r\n            if (idx > -1) l.splice(idx, 1);\r\n            return idx != -1;\r\n        },\r\n        // TODO support insert index\r\n        addWithFunction: function (list, item, hashFunction) {\r\n            if (exports.findWithFunction(list, hashFunction) == -1) list.push(item);\r\n        },\r\n        addToList: function (map, key, value, insertAtStart) {\r\n            var l = map[key];\r\n            if (l == null) {\r\n                l = [];\r\n                map[key] = l;\r\n            }\r\n            l[insertAtStart ? \"unshift\" : \"push\"](value);\r\n            return l;\r\n        },\r\n        //\r\n        // extends the given obj (which can be an array) with the given constructor function, prototype functions, and\r\n        // class members, any of which may be null.\r\n        //\r\n        extend: function (child, parent, _protoFn) {\r\n            var i;\r\n            parent = _isa(parent) ? parent : [ parent ];\r\n\r\n            for (i = 0; i < parent.length; i++) {\r\n                for (var j in parent[i].prototype) {\r\n                    if (parent[i].prototype.hasOwnProperty(j)) {\r\n                        child.prototype[j] = parent[i].prototype[j];\r\n                    }\r\n                }\r\n            }\r\n\r\n            var _makeFn = function (name, protoFn) {\r\n                return function () {\r\n                    for (i = 0; i < parent.length; i++) {\r\n                        if (parent[i].prototype[name])\r\n                            parent[i].prototype[name].apply(this, arguments);\r\n                    }\r\n                    return protoFn.apply(this, arguments);\r\n                };\r\n            };\r\n\r\n            var _oneSet = function (fns) {\r\n                for (var k in fns) {\r\n                    child.prototype[k] = _makeFn(k, fns[k]);\r\n                }\r\n            };\r\n\r\n            if (arguments.length > 2) {\r\n                for (i = 2; i < arguments.length; i++)\r\n                    _oneSet(arguments[i]);\r\n            }\r\n\r\n            return child;\r\n        },\r\n        uuid: function () {\r\n            return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n                return v.toString(16);\r\n            }));\r\n        },\r\n        logEnabled: true,\r\n        log: function () {\r\n            if (exports.logEnabled && typeof console != \"undefined\") {\r\n                try {\r\n                    var msg = arguments[arguments.length - 1];\r\n                    console.log(msg);\r\n                }\r\n                catch (e) {\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Wraps one function with another, creating a placeholder for the\r\n         * wrapped function if it was null. this is used to wrap the various\r\n         * drag/drop event functions - to allow jsPlumb to be notified of\r\n         * important lifecycle events without imposing itself on the user's\r\n         * drag/drop functionality.\r\n         * @method jsPlumbUtil.wrap\r\n         * @param {Function} wrappedFunction original function to wrap; may be null.\r\n         * @param {Function} newFunction function to wrap the original with.\r\n         * @param {Object} [returnOnThisValue] Optional. Indicates that the wrappedFunction should\r\n         * not be executed if the newFunction returns a value matching 'returnOnThisValue'.\r\n         * note that this is a simple comparison and only works for primitives right now.\r\n         */\r\n        wrap: function (wrappedFunction, newFunction, returnOnThisValue) {\r\n            wrappedFunction = wrappedFunction || function () {\r\n            };\r\n            newFunction = newFunction || function () {\r\n            };\r\n            return function () {\r\n                var r = null;\r\n                try {\r\n                    r = newFunction.apply(this, arguments);\r\n                } catch (e) {\r\n                    exports.log(\"jsPlumb function failed : \" + e);\r\n                }\r\n                if (returnOnThisValue == null || (r !== returnOnThisValue)) {\r\n                    try {\r\n                        r = wrappedFunction.apply(this, arguments);\r\n                    } catch (e) {\r\n                        exports.log(\"wrapped function failed : \" + e);\r\n                    }\r\n                }\r\n                return r;\r\n            };\r\n        }\r\n    };\r\n\r\n    exports.EventGenerator = function () {\r\n        var _listeners = {},\r\n            eventsSuspended = false,\r\n        // this is a list of events that should re-throw any errors that occur during their dispatch. it is current private.\r\n            eventsToDieOn = { \"ready\": true };\r\n\r\n        this.bind = function (event, listener, insertAtStart) {\r\n            var _one = function(evt) {\r\n                exports.addToList(_listeners, evt, listener, insertAtStart);\r\n                listener.__jsPlumb = listener.__jsPlumb || {};\r\n                listener.__jsPlumb[jsPlumbUtil.uuid()] = evt;\r\n            };\r\n\r\n            if (typeof event === \"string\") _one(event);\r\n            else if (event.length != null) {\r\n                for (var i = 0; i < event.length; i++) {\r\n                    _one(event[i]);\r\n                }\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        this.fire = function (event, value, originalEvent) {\r\n            if (!eventsSuspended && _listeners[event]) {\r\n                var l = _listeners[event].length, i = 0, _gone = false, ret = null;\r\n                if (!this.shouldFireEvent || this.shouldFireEvent(event, value, originalEvent)) {\r\n                    while (!_gone && i < l && ret !== false) {\r\n                        // doing it this way rather than catching and then possibly re-throwing means that an error propagated by this\r\n                        // method will have the whole call stack available in the debugger.\r\n                        if (eventsToDieOn[event])\r\n                            _listeners[event][i].apply(this, [ value, originalEvent]);\r\n                        else {\r\n                            try {\r\n                                ret = _listeners[event][i].apply(this, [ value, originalEvent ]);\r\n                            } catch (e) {\r\n                                exports.log(\"jsPlumb: fire failed for event \" + event + \" : \" + e);\r\n                            }\r\n                        }\r\n                        i++;\r\n                        if (_listeners == null || _listeners[event] == null)\r\n                            _gone = true;\r\n                    }\r\n                }\r\n            }\r\n            return this;\r\n        };\r\n\r\n        this.unbind = function (eventOrListener, listener) {\r\n\r\n            if (arguments.length === 0) {\r\n                _listeners = {};\r\n            }\r\n            else if (arguments.length === 1) {\r\n                if (typeof eventOrListener === \"string\")\r\n                    delete _listeners[eventOrListener];\r\n                else if (eventOrListener.__jsPlumb) {\r\n                    var evt;\r\n                    for (var i in eventOrListener.__jsPlumb) {\r\n                        evt = eventOrListener.__jsPlumb[i];\r\n                        exports.remove(_listeners[evt] || [], eventOrListener);\r\n                    }\r\n                }\r\n            }\r\n            else if (arguments.length === 2) {\r\n                exports.remove(_listeners[eventOrListener] || [], listener);\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        this.getListener = function (forEvent) {\r\n            return _listeners[forEvent];\r\n        };\r\n        this.setSuspendEvents = function (val) {\r\n            eventsSuspended = val;\r\n        };\r\n        this.isSuspendEvents = function () {\r\n            return eventsSuspended;\r\n        };\r\n        this.silently = function(fn) {\r\n            this.setSuspendEvents(true);\r\n            try {\r\n                fn();\r\n            }\r\n            catch (e) {\r\n                jsPlumbUtil.log(\"Cannot execute silent function \" + e);\r\n            }\r\n            this.setSuspendEvents(false);\r\n        };\r\n        this.cleanupListeners = function () {\r\n            for (var i in _listeners) {\r\n                _listeners[i] = null;\r\n            }\r\n        };\r\n    };\r\n\r\n    exports.EventGenerator.prototype = {\r\n        cleanup: function () {\r\n            this.cleanupListeners();\r\n        }\r\n    };\r\n\r\n    // thanks MDC\r\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FFunction%2Fbind\r\n    if (!Function.prototype.bind) {\r\n        Function.prototype.bind = function (oThis) {\r\n            if (typeof this !== \"function\") {\r\n                // closest thing possible to the ECMAScript 5 internal IsCallable function\r\n                throw new TypeError(\"Function.prototype.bind - what is trying to be bound is not callable\");\r\n            }\r\n\r\n            var aArgs = Array.prototype.slice.call(arguments, 1),\r\n                fToBind = this,\r\n                fNOP = function () {\r\n                },\r\n                fBound = function () {\r\n                    return fToBind.apply(this instanceof fNOP && oThis ? this : oThis,\r\n                        aArgs.concat(Array.prototype.slice.call(arguments)));\r\n                };\r\n\r\n            fNOP.prototype = this.prototype;\r\n            fBound.prototype = new fNOP();\r\n\r\n            return fBound;\r\n        };\r\n    }\r\n\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n *\r\n * Title:jsPlumb 1.7.6\r\n *\r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.\r\n *\r\n * This file contains utility functions that run in browsers only.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n ;(function() {\r\n\r\n  \"use strict\";\r\n\r\n   var root = this;\r\n   var exports = root.jsPlumbUtil;\r\n\r\n   exports.ieVersion = /MSIE\\s([\\d.]+)/.test(navigator.userAgent) ? (new Number(RegExp.$1)) : -1;\r\n\r\n   exports.oldIE = exports.ieVersion > -1 && exports.ieVersion < 9;\r\n\r\n   exports.matchesSelector = function(el, selector, ctx) {\r\n       ctx = ctx || el.parentNode;\r\n       var possibles = ctx.querySelectorAll(selector);\r\n       for (var i = 0; i < possibles.length; i++) {\r\n           if (possibles[i] === el)\r\n               return true;\r\n       }\r\n       return false;\r\n   };\r\n\r\n   exports.consume = function(e, doNotPreventDefault) {\r\n       if (e.stopPropagation)\r\n           e.stopPropagation();\r\n       else\r\n           e.returnValue = false;\r\n\r\n       if (!doNotPreventDefault && e.preventDefault)\r\n            e.preventDefault();\r\n   };\r\n\r\n   /*\r\n    * Function: sizeElement\r\n    * Helper to size and position an element. You would typically use\r\n    * this when writing your own Connector or Endpoint implementation.\r\n    *\r\n    * Parameters:\r\n    *  x - [int] x position for the element origin\r\n    *  y - [int] y position for the element origin\r\n    *  w - [int] width of the element\r\n    *  h - [int] height of the element\r\n    *\r\n    */\r\n   exports.sizeElement = function(el, x, y, w, h) {\r\n       if (el) {\r\n           el.style.height = h + \"px\";\r\n           el.height = h;\r\n           el.style.width = w + \"px\";\r\n           el.width = w;\r\n           el.style.left = x + \"px\";\r\n           el.style.top = y + \"px\";\r\n       }\r\n   };\r\n\r\n\r\n }).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the core code.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n(function () {\r\n\r\n    \"use strict\";\r\n\r\n    var root = this;\r\n    var connectorTypes = [], rendererTypes;\r\n\r\n    var _ju = root.jsPlumbUtil,\r\n        _getOffset = function (el, _instance, relativeToRoot) {\r\n            return _instance.getOffset(el, relativeToRoot);\r\n        },\r\n\r\n        /**\r\n         * creates a timestamp, using milliseconds since 1970, but as a string.\r\n         */\r\n        _timestamp = function () {\r\n            return \"\" + (new Date()).getTime();\r\n        },\r\n\r\n    // helper method to update the hover style whenever it, or paintStyle, changes.\r\n    // we use paintStyle as the foundation and merge hoverPaintStyle over the\r\n    // top.\r\n        _updateHoverStyle = function (component) {\r\n            if (component._jsPlumb.paintStyle && component._jsPlumb.hoverPaintStyle) {\r\n                var mergedHoverStyle = {};\r\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.paintStyle);\r\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.hoverPaintStyle);\r\n                delete component._jsPlumb.hoverPaintStyle;\r\n                // we want the fillStyle of paintStyle to override a gradient, if possible.\r\n                if (mergedHoverStyle.gradient && component._jsPlumb.paintStyle.fillStyle)\r\n                    delete mergedHoverStyle.gradient;\r\n                component._jsPlumb.hoverPaintStyle = mergedHoverStyle;\r\n            }\r\n        },\r\n        events = [\"tap\", \"dbltap\", \"click\", \"dblclick\", \"mouseover\", \"mouseout\", \"mousemove\", \"mousedown\", \"mouseup\", \"contextmenu\" ],\r\n        eventFilters = { \"mouseout\": \"mouseleave\", \"mouseexit\": \"mouseleave\" },\r\n        _updateAttachedElements = function (component, state, timestamp, sourceElement) {\r\n            var affectedElements = component.getAttachedElements();\r\n            if (affectedElements) {\r\n                for (var i = 0, j = affectedElements.length; i < j; i++) {\r\n                    if (!sourceElement || sourceElement != affectedElements[i])\r\n                        affectedElements[i].setHover(state, true, timestamp);\t\t\t// tell the attached elements not to inform their own attached elements.\r\n                }\r\n            }\r\n        },\r\n        _splitType = function (t) {\r\n            return t == null ? null : t.split(\" \");\r\n        },\r\n        _mapType = function(map, obj, typeId) {\r\n            for (var i in obj)\r\n                map[i] = typeId;\r\n        },\r\n        _applyTypes = function (component, params, doNotRepaint) {\r\n            if (component.getDefaultType) {\r\n                var td = component.getTypeDescriptor(), map = {};\r\n                var defType = component.getDefaultType();\r\n                var o = _ju.merge({}, defType);\r\n                _mapType(map, defType, \"__default\");\r\n                for (var i = 0, j = component._jsPlumb.types.length; i < j; i++) {\r\n                    var tid = component._jsPlumb.types[i];\r\n                    if (tid !== \"__default\") {\r\n                        var _t = component._jsPlumb.instance.getType(tid, td);\r\n                        if (_t != null) {\r\n                            o = _ju.merge(o, _t, [ \"cssClass\" ]);\r\n                            _mapType(map, _t, tid);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (params) {\r\n                    o = _ju.populate(o, params);\r\n                }\r\n\r\n                component.applyType(o, doNotRepaint, map);\r\n                if (!doNotRepaint) component.repaint();\r\n            }\r\n        },\r\n\r\n// ------------------------------ BEGIN jsPlumbUIComponent --------------------------------------------\r\n\r\n        jsPlumbUIComponent = window.jsPlumbUIComponent = function (params) {\r\n\r\n            jsPlumbUtil.EventGenerator.apply(this, arguments);\r\n\r\n            var self = this,\r\n                a = arguments,\r\n                idPrefix = self.idPrefix,\r\n                id = idPrefix + (new Date()).getTime();\r\n\r\n            this._jsPlumb = {\r\n                instance: params._jsPlumb,\r\n                parameters: params.parameters || {},\r\n                paintStyle: null,\r\n                hoverPaintStyle: null,\r\n                paintStyleInUse: null,\r\n                hover: false,\r\n                beforeDetach: params.beforeDetach,\r\n                beforeDrop: params.beforeDrop,\r\n                overlayPlacements: [],\r\n                hoverClass: params.hoverClass || params._jsPlumb.Defaults.HoverClass,\r\n                types: [],\r\n                typeCache:{}\r\n            };\r\n\r\n            this.cacheTypeItem = function(key, item, typeId) {\r\n                this._jsPlumb.typeCache[typeId] = this._jsPlumb.typeCache[typeId] || {};\r\n                this._jsPlumb.typeCache[typeId][key] = item;\r\n            };\r\n            this.getCachedTypeItem = function(key, typeId) {\r\n                return this._jsPlumb.typeCache[typeId] ? this._jsPlumb.typeCache[typeId][key] : null;\r\n            };\r\n\r\n            this.getId = function () {\r\n                return id;\r\n            };\r\n\r\n// ----------------------------- default type --------------------------------------------\r\n\r\n\r\n            var o = params.overlays || [], oo = {};\r\n            if (this.defaultOverlayKeys) {\r\n                for (var i = 0; i < this.defaultOverlayKeys.length; i++)\r\n                    Array.prototype.push.apply(o, this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[i]] || []);\r\n\r\n                for (i = 0; i < o.length; i++) {\r\n                    // if a string, convert to object representation so that we can store the typeid on it.\r\n                    // also assign an id.\r\n                    var fo = jsPlumb.convertToFullOverlaySpec(o[i]);\r\n                    oo[fo[1].id] = fo;\r\n                }\r\n            }\r\n\r\n            var _defaultType = {\r\n                overlays:oo,\r\n                parameters: params.parameters || {},\r\n                scope: params.scope || this._jsPlumb.instance.getDefaultScope()\r\n            };\r\n            this.getDefaultType = function() {\r\n                return _defaultType;\r\n            };\r\n            this.appendToDefaultType = function(obj) {\r\n                for (var i in obj) _defaultType[i] = obj[i];\r\n            };\r\n\r\n// ----------------------------- end default type --------------------------------------------\r\n\r\n            // all components can generate events\r\n\r\n            if (params.events) {\r\n                for (i in params.events)\r\n                    self.bind(i, params.events[i]);\r\n            }\r\n\r\n            // all components get this clone function.\r\n            // TODO issue 116 showed a problem with this - it seems 'a' that is in\r\n            // the clone function's scope is shared by all invocations of it, the classic\r\n            // JS closure problem.  for now, jsPlumb does a version of this inline where\r\n            // it used to call clone.  but it would be nice to find some time to look\r\n            // further at this.\r\n            this.clone = function () {\r\n                var o = {};//new Object();\r\n                this.constructor.apply(o, a);\r\n                return o;\r\n            }.bind(this);\r\n\r\n            // user can supply a beforeDetach callback, which will be executed before a detach\r\n            // is performed; returning false prevents the detach.\r\n            this.isDetachAllowed = function (connection) {\r\n                var r = true;\r\n                if (this._jsPlumb.beforeDetach) {\r\n                    try {\r\n                        r = this._jsPlumb.beforeDetach(connection);\r\n                    }\r\n                    catch (e) {\r\n                        _ju.log(\"jsPlumb: beforeDetach callback failed\", e);\r\n                    }\r\n                }\r\n                return r;\r\n            };\r\n\r\n            // user can supply a beforeDrop callback, which will be executed before a dropped\r\n            // connection is confirmed. user can return false to reject connection.\r\n            this.isDropAllowed = function (sourceId, targetId, scope, connection, dropEndpoint, source, target) {\r\n                var r = this._jsPlumb.instance.checkCondition(\"beforeDrop\", {\r\n                    sourceId: sourceId,\r\n                    targetId: targetId,\r\n                    scope: scope,\r\n                    connection: connection,\r\n                    dropEndpoint: dropEndpoint,\r\n                    source: source, target: target\r\n                });\r\n                if (this._jsPlumb.beforeDrop) {\r\n                    try {\r\n                        r = this._jsPlumb.beforeDrop({\r\n                            sourceId: sourceId,\r\n                            targetId: targetId,\r\n                            scope: scope,\r\n                            connection: connection,\r\n                            dropEndpoint: dropEndpoint,\r\n                            source: source, target: target\r\n                        });\r\n                    }\r\n                    catch (e) {\r\n                        _ju.log(\"jsPlumb: beforeDrop callback failed\", e);\r\n                    }\r\n                }\r\n                return r;\r\n            };\r\n\r\n            var boundListeners = [],\r\n                bindAListener = function (obj, type, fn) {\r\n                    boundListeners.push([obj, type, fn]);\r\n                    obj.bind(type, fn);\r\n                },\r\n                domListeners = [];\r\n\r\n            // sets the component associated with listener events. for instance, an overlay delegates\r\n            // its events back to a connector. but if the connector is swapped on the underlying connection,\r\n            // then this component must be changed. This is called by setConnector in the Connection class.\r\n            this.setListenerComponent = function (c) {\r\n                for (var i = 0; i < domListeners.length; i++)\r\n                    domListeners[i][3] = c;\r\n            };\r\n\r\n\r\n        };\r\n\r\n    var _removeTypeCssHelper = function (component, typeIndex) {\r\n        var typeId = component._jsPlumb.types[typeIndex],\r\n            type = component._jsPlumb.instance.getType(typeId, component.getTypeDescriptor());\r\n\r\n        if (type != null) {\r\n\r\n            if (type.cssClass && component.canvas)\r\n                component._jsPlumb.instance.removeClass(component.canvas, type.cssClass);\r\n        }\r\n    };\r\n\r\n    jsPlumbUtil.extend(jsPlumbUIComponent, jsPlumbUtil.EventGenerator, {\r\n\r\n        getParameter: function (name) {\r\n            return this._jsPlumb.parameters[name];\r\n        },\r\n\r\n        setParameter: function (name, value) {\r\n            this._jsPlumb.parameters[name] = value;\r\n        },\r\n\r\n        getParameters: function () {\r\n            return this._jsPlumb.parameters;\r\n        },\r\n\r\n        setParameters: function (p) {\r\n            this._jsPlumb.parameters = p;\r\n        },\r\n\r\n        hasClass:function(clazz) {\r\n            return jsPlumb.hasClass(this.canvas, clazz);\r\n        },\r\n\r\n        addClass: function (clazz) {\r\n            jsPlumb.addClass(this.canvas, clazz);\r\n        },\r\n\r\n        removeClass: function (clazz) {\r\n            jsPlumb.removeClass(this.canvas, clazz);\r\n        },\r\n\r\n        updateClasses: function (classesToAdd, classesToRemove) {\r\n            jsPlumb.updateClasses(this.canvas, classesToAdd, classesToRemove);\r\n        },\r\n\r\n        setType: function (typeId, params, doNotRepaint) {\r\n            this.clearTypes();\r\n            this._jsPlumb.types = _splitType(typeId) || [];\r\n            _applyTypes(this, params, doNotRepaint);\r\n        },\r\n\r\n        getType: function () {\r\n            return this._jsPlumb.types;\r\n        },\r\n\r\n        reapplyTypes: function (params, doNotRepaint) {\r\n            _applyTypes(this, params, doNotRepaint);\r\n        },\r\n\r\n        hasType: function (typeId) {\r\n            return jsPlumbUtil.indexOf(this._jsPlumb.types, typeId) != -1;\r\n        },\r\n\r\n        addType: function (typeId, params, doNotRepaint) {\r\n            var t = _splitType(typeId), _cont = false;\r\n            if (t != null) {\r\n                for (var i = 0, j = t.length; i < j; i++) {\r\n                    if (!this.hasType(t[i])) {\r\n                        this._jsPlumb.types.push(t[i]);\r\n                        _cont = true;\r\n                    }\r\n                }\r\n                if (_cont) _applyTypes(this, params, doNotRepaint);\r\n            }\r\n        },\r\n\r\n        removeType: function (typeId, doNotRepaint) {\r\n            var t = _splitType(typeId), _cont = false, _one = function (tt) {\r\n                var idx = _ju.indexOf(this._jsPlumb.types, tt);\r\n                if (idx != -1) {\r\n                    // remove css class if necessary\r\n                    _removeTypeCssHelper(this, idx);\r\n                    this._jsPlumb.types.splice(idx, 1);\r\n                    return true;\r\n                }\r\n                return false;\r\n            }.bind(this);\r\n\r\n            if (t != null) {\r\n                for (var i = 0, j = t.length; i < j; i++) {\r\n                    _cont = _one(t[i]) || _cont;\r\n                }\r\n                if (_cont) _applyTypes(this, null, doNotRepaint);\r\n            }\r\n        },\r\n        clearTypes: function (doNotRepaint) {\r\n            var i = this._jsPlumb.types.length;\r\n            for (var j = 0; j < i; j++) {\r\n                _removeTypeCssHelper(this, 0);\r\n                this._jsPlumb.types.splice(0, 1);\r\n            }\r\n            _applyTypes(this, {}, doNotRepaint);\r\n        },\r\n\r\n        toggleType: function (typeId, params, doNotRepaint) {\r\n            var t = _splitType(typeId);\r\n            if (t != null) {\r\n                for (var i = 0, j = t.length; i < j; i++) {\r\n                    var idx = jsPlumbUtil.indexOf(this._jsPlumb.types, t[i]);\r\n                    if (idx != -1) {\r\n                        _removeTypeCssHelper(this, idx);\r\n                        this._jsPlumb.types.splice(idx, 1);\r\n                    }\r\n                    else\r\n                        this._jsPlumb.types.push(t[i]);\r\n                }\r\n\r\n                _applyTypes(this, params, doNotRepaint);\r\n            }\r\n        },\r\n        applyType: function (t, doNotRepaint) {\r\n            this.setPaintStyle(t.paintStyle, doNotRepaint);\r\n            this.setHoverPaintStyle(t.hoverPaintStyle, doNotRepaint);\r\n            if (t.parameters) {\r\n                for (var i in t.parameters)\r\n                    this.setParameter(i, t.parameters[i]);\r\n            }\r\n            this._jsPlumb.paintStyleInUse = this.getPaintStyle();\r\n        },\r\n        setPaintStyle: function (style, doNotRepaint) {\r\n//\t\t    \tthis._jsPlumb.paintStyle = jsPlumb.extend({}, style);\r\n// TODO figure out if we want components to clone paintStyle so as not to share it.\r\n            this._jsPlumb.paintStyle = style;\r\n            this._jsPlumb.paintStyleInUse = this._jsPlumb.paintStyle;\r\n            _updateHoverStyle(this);\r\n            if (!doNotRepaint) this.repaint();\r\n        },\r\n        getPaintStyle: function () {\r\n            return this._jsPlumb.paintStyle;\r\n        },\r\n        setHoverPaintStyle: function (style, doNotRepaint) {\r\n            //this._jsPlumb.hoverPaintStyle = jsPlumb.extend({}, style);\r\n// TODO figure out if we want components to clone paintStyle so as not to share it.\t\t    \t\r\n            this._jsPlumb.hoverPaintStyle = style;\r\n            _updateHoverStyle(this);\r\n            if (!doNotRepaint) this.repaint();\r\n        },\r\n        getHoverPaintStyle: function () {\r\n            return this._jsPlumb.hoverPaintStyle;\r\n        },\r\n        destroy: function (force) {\r\n            if (force || this.typeId == null) {\r\n                this.cleanupListeners(); // this is on EventGenerator\r\n                this.clone = null;\r\n                this._jsPlumb = null;\r\n            }\r\n        },\r\n\r\n        isHover: function () {\r\n            return this._jsPlumb.hover;\r\n        },\r\n\r\n        setHover: function (hover, ignoreAttachedElements, timestamp) {\r\n            // while dragging, we ignore these events.  this keeps the UI from flashing and\r\n            // swishing and whatevering.\r\n            if (this._jsPlumb && !this._jsPlumb.instance.currentlyDragging && !this._jsPlumb.instance.isHoverSuspended()) {\r\n\r\n                this._jsPlumb.hover = hover;\r\n\r\n                if (this.canvas != null) {\r\n                    if (this._jsPlumb.instance.hoverClass != null) {\r\n                        var method = hover ? \"addClass\" : \"removeClass\";\r\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.instance.hoverClass);\r\n                    }\r\n                    if (this._jsPlumb.hoverClass != null) {\r\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.hoverClass);\r\n                    }\r\n                }\r\n                if (this._jsPlumb.hoverPaintStyle != null) {\r\n                    this._jsPlumb.paintStyleInUse = hover ? this._jsPlumb.hoverPaintStyle : this._jsPlumb.paintStyle;\r\n                    if (!this._jsPlumb.instance.isSuspendDrawing()) {\r\n                        timestamp = timestamp || _timestamp();\r\n                        this.repaint({timestamp: timestamp, recalc: false});\r\n                    }\r\n                }\r\n                // get the list of other affected elements, if supported by this component.\r\n                // for a connection, its the endpoints.  for an endpoint, its the connections! surprise.\r\n                if (this.getAttachedElements && !ignoreAttachedElements)\r\n                    _updateAttachedElements(this, hover, _timestamp(), this);\r\n            }\r\n        }\r\n    });\r\n\r\n// ------------------------------ END jsPlumbUIComponent --------------------------------------------\r\n\r\n    var _jsPlumbInstanceIndex = 0,\r\n        getInstanceIndex = function () {\r\n            var i = _jsPlumbInstanceIndex + 1;\r\n            _jsPlumbInstanceIndex++;\r\n            return i;\r\n        };\r\n\r\n    var jsPlumbInstance = window.jsPlumbInstance = function (_defaults) {\r\n\r\n        this.Defaults = {\r\n            Anchor: \"Bottom\",\r\n            Anchors: [ null, null ],\r\n            ConnectionsDetachable: true,\r\n            ConnectionOverlays: [ ],\r\n            Connector: \"Bezier\",\r\n            Container: null,\r\n            DoNotThrowErrors: false,\r\n            DragOptions: { },\r\n            DropOptions: { },\r\n            Endpoint: \"Dot\",\r\n            EndpointOverlays: [ ],\r\n            Endpoints: [ null, null ],\r\n            EndpointStyle: { fillStyle: \"#456\" },\r\n            EndpointStyles: [ null, null ],\r\n            EndpointHoverStyle: null,\r\n            EndpointHoverStyles: [ null, null ],\r\n            HoverPaintStyle: null,\r\n            LabelStyle: { color: \"black\" },\r\n            LogEnabled: false,\r\n            Overlays: [ ],\r\n            MaxConnections: 1,\r\n            PaintStyle: { lineWidth: 4, strokeStyle: \"#456\" },\r\n            ReattachConnections: false,\r\n            RenderMode: \"svg\",\r\n            Scope: \"jsPlumb_DefaultScope\"\r\n        };\r\n        if (_defaults) jsPlumb.extend(this.Defaults, _defaults);\r\n\r\n        this.logEnabled = this.Defaults.LogEnabled;\r\n        this._connectionTypes = {};\r\n        this._endpointTypes = {};\r\n\r\n        jsPlumbUtil.EventGenerator.apply(this);\r\n\r\n        var _currentInstance = this,\r\n            _instanceIndex = getInstanceIndex(),\r\n            _bb = _currentInstance.bind,\r\n            _initialDefaults = {},\r\n            _zoom = 1,\r\n            _info = function (el) {\r\n                if (el == null) return null;\r\n                else if (el.nodeType == 3 || el.nodeType == 8) {\r\n                    return { el:el, text:true };\r\n                }\r\n                else {\r\n                    var _el = _currentInstance.getElement(el);\r\n                    return { el: _el, id: (jsPlumbUtil.isString(el) && _el == null) ? el : _getId(_el) };\r\n                }\r\n            };\r\n\r\n        this.getInstanceIndex = function () {\r\n            return _instanceIndex;\r\n        };\r\n\r\n        this.setZoom = function (z, repaintEverything) {\r\n            if (!jsPlumbUtil.oldIE) {\r\n                _zoom = z;\r\n                _currentInstance.fire(\"zoom\", _zoom);\r\n                if (repaintEverything) _currentInstance.repaintEverything();\r\n            }\r\n            return !jsPlumbUtil.oldIE;\r\n\r\n        };\r\n        this.getZoom = function () {\r\n            return _zoom;\r\n        };\r\n\r\n        for (var i in this.Defaults)\r\n            _initialDefaults[i] = this.Defaults[i];\r\n\r\n        var _container, _containerDelegations = [];\r\n        this.unbindContainer = function() {\r\n            if (_container != null && _containerDelegations.length > 0) {\r\n                for (var i = 0; i < _containerDelegations.length; i++) {\r\n                    _currentInstance.off(_container, _containerDelegations[i][0], _containerDelegations[i][1]);\r\n                }\r\n            }\r\n        };\r\n        this.setContainer = function (c) {\r\n\r\n            this.unbindContainer();\r\n\r\n            // get container as dom element.\r\n            c = this.getElement(c);\r\n            // move existing connections and endpoints, if any.\r\n            this.select().each(function (conn) {\r\n                conn.moveParent(c);\r\n            });\r\n            this.selectEndpoints().each(function (ep) {\r\n                ep.moveParent(c);\r\n            });\r\n\r\n            // set container.\r\n            _container = c;\r\n            _containerDelegations.length = 0;\r\n\r\n            var _oneDelegateHandler = function (id, e) {\r\n                var t = e.srcElement || e.target,\r\n                    jp = (t && t.parentNode ? t.parentNode._jsPlumb : null) || (t ? t._jsPlumb : null) || (t && t.parentNode && t.parentNode.parentNode ? t.parentNode.parentNode._jsPlumb : null);\r\n                if (jp) {\r\n                    jp.fire(id, jp, e);\r\n                    // jsplumb also fires every event coming from components/overlays. That's what the test for `jp.component` is for.\r\n                    _currentInstance.fire(id, jp.component || jp, e);\r\n                }\r\n            };\r\n\r\n            var _addOneDelegate = function(eventId, selector, fn) {\r\n                _containerDelegations.push([eventId, fn]);\r\n                _currentInstance.on(_container, eventId, selector, fn);\r\n            };\r\n\r\n            // delegate one event on the container to jsplumb elements. it might be possible to\r\n            // abstract this out: each of endpoint, connection and overlay could register themselves with\r\n            // jsplumb as \"component types\" or whatever, and provide a suitable selector. this would be\r\n            // done by the renderer (although admittedly from 2.0 onwards we're not supporting vml anymore)\r\n            var _oneDelegate = function (id) {\r\n                // connections.\r\n                //_addOneDelegate(id, \"._jsPlumb_connector, ._jsPlumb_connector > *\", function (e) {\r\n                _addOneDelegate(id, \".jsplumb-connector > *\", function (e) {\r\n                    _oneDelegateHandler(id, e);\r\n                });\r\n                // endpoints. note they can have an enclosing div, or not.\r\n                _addOneDelegate(id, \".jsplumb-endpoint, .jsplumb-endpoint > *, .jsplumb-endpoint svg *\", function (e) {\r\n                    _oneDelegateHandler(id, e);\r\n                });\r\n                // overlays\r\n                _addOneDelegate(id, \".jsplumb-overlay, .jsplumb-overlay *\", function (e) {\r\n                    _oneDelegateHandler(id, e);\r\n                });\r\n            };\r\n\r\n            for (var i = 0; i < events.length; i++)\r\n                _oneDelegate(events[i]);\r\n\r\n        };\r\n        this.getContainer = function () {\r\n            return _container;\r\n        };\r\n\r\n        this.bind = function (event, fn) {\r\n            if (\"ready\" === event && initialized) fn();\r\n            else _bb.apply(_currentInstance, [event, fn]);\r\n        };\r\n\r\n        _currentInstance.importDefaults = function (d) {\r\n            for (var i in d) {\r\n                _currentInstance.Defaults[i] = d[i];\r\n            }\r\n            if (d.Container)\r\n                _currentInstance.setContainer(d.Container);\r\n\r\n            return _currentInstance;\r\n        };\r\n\r\n        _currentInstance.restoreDefaults = function () {\r\n            _currentInstance.Defaults = jsPlumb.extend({}, _initialDefaults);\r\n            return _currentInstance;\r\n        };\r\n\r\n        var log = null,\r\n            initialized = false,\r\n        // TODO remove from window scope\r\n            connections = [],\r\n        // map of element id -> endpoint lists. an element can have an arbitrary\r\n        // number of endpoints on it, and not all of them have to be connected\r\n        // to anything.\r\n            endpointsByElement = {},\r\n            endpointsByUUID = {},\r\n            managedElements = {},\r\n            offsets = {},\r\n            offsetTimestamps = {},\r\n            draggableStates = {},\r\n            connectionBeingDragged = false,\r\n            sizes = [],\r\n            _suspendDrawing = false,\r\n            _suspendedAt = null,\r\n            DEFAULT_SCOPE = this.Defaults.Scope,\r\n            renderMode = null,  // will be set in init()\r\n            _curIdStamp = 1,\r\n            _idstamp = function () {\r\n                return \"\" + _curIdStamp++;\r\n            },\r\n\r\n        //\r\n        // appends an element to some other element, which is calculated as follows:\r\n        //\r\n        // 1. if Container exists, use that element.\r\n        // 2. if the 'parent' parameter exists, use that.\r\n        // 3. otherwise just use the root element.\r\n        //\r\n        //\r\n            _appendElement = function (el, parent) {\r\n                if (_container)\r\n                    _container.appendChild(el);\r\n                else if (!parent)\r\n                    this.appendToRoot(el);\r\n                else\r\n                    this.getElement(parent).appendChild(el);\r\n            }.bind(this),\r\n\r\n        //\r\n        // Draws an endpoint and its connections. this is the main entry point into drawing connections as well\r\n        // as endpoints, since jsPlumb is endpoint-centric under the hood.\r\n        //\r\n        // @param element element to draw (of type library specific element object)\r\n        // @param ui UI object from current library's event system. optional.\r\n        // @param timestamp timestamp for this paint cycle. used to speed things up a little by cutting down the amount of offset calculations we do.\r\n        // @param clearEdits defaults to false; indicates that mouse edits for connectors should be cleared\r\n        ///\r\n            _draw = function (element, ui, timestamp, clearEdits) {\r\n\r\n                // TODO is it correct to filter by headless at this top level? how would a headless adapter ever repaint?\r\n                // NO. it is not correct.\r\n                if (!jsPlumb.headless && !_suspendDrawing) {\r\n                    var id = _getId(element),\r\n                        repaintEls = _currentInstance.getDragManager().getElementsForDraggable(id);\r\n\r\n                    if (timestamp == null) timestamp = _timestamp();\r\n\r\n                    // update the offset of everything _before_ we try to draw anything.\r\n                    var o = _updateOffset({ elId: id, offset: ui, recalc: false, timestamp: timestamp });\r\n\r\n                    if (repaintEls) {\r\n                        for (var i in repaintEls) {\r\n                            _updateOffset({\r\n                                elId: repaintEls[i].id,\r\n                                offset: {\r\n                                    left: o.o.left + repaintEls[i].offset.left,\r\n                                    top: o.o.top + repaintEls[i].offset.top\r\n                                },\r\n                                recalc: false,\r\n                                timestamp: timestamp\r\n                            });\r\n                        }\r\n                    }\r\n\r\n                    _currentInstance.anchorManager.redraw(id, ui, timestamp, null, clearEdits);\r\n\r\n                    if (repaintEls) {\r\n                        for (var j in repaintEls) {\r\n                            _currentInstance.anchorManager.redraw(repaintEls[j].id, ui, timestamp, repaintEls[j].offset, clearEdits, true);\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n\r\n        //\r\n        // gets an Endpoint by uuid.\r\n        //\r\n            _getEndpoint = function (uuid) {\r\n                return endpointsByUUID[uuid];\r\n            },\r\n\r\n            /**\r\n             * inits a draggable if it's not already initialised.\r\n             * TODO: somehow abstract this to the adapter, because the concept of \"draggable\" has no\r\n             * place on the server.\r\n             */\r\n            _initDraggableIfNecessary = function (element, isDraggable, dragOptions, id) {\r\n                // move to DragManager?\r\n                if (!jsPlumb.headless) {\r\n                    var _draggable = isDraggable == null ? false : isDraggable;\r\n                    if (_draggable) {\r\n                        if (jsPlumb.isDragSupported(element, _currentInstance) && !jsPlumb.isAlreadyDraggable(element, _currentInstance)) {\r\n                            var options = dragOptions || _currentInstance.Defaults.DragOptions;\r\n                            options = jsPlumb.extend({}, options); // make a copy.\r\n                            var dragEvent = jsPlumb.dragEvents.drag,\r\n                                stopEvent = jsPlumb.dragEvents.stop,\r\n                                startEvent = jsPlumb.dragEvents.start,\r\n                                _del = _currentInstance.getElement(element),\r\n                                _ancestor = _currentInstance.getDragManager().getDragAncestor(_del),\r\n                                _noOffset = {left: 0, top: 0},\r\n                                _ancestorOffset = _noOffset,\r\n                                _started = false;\r\n\r\n                            _manage(id, element);\r\n\r\n                            options[startEvent] = _ju.wrap(options[startEvent], function () {\r\n                                _ancestorOffset = _ancestor != null ? _currentInstance.getOffset(_ancestor) : _noOffset;\r\n                                _currentInstance.setHoverSuspended(true);\r\n                                _currentInstance.select({source: element}).addClass(_currentInstance.elementDraggingClass + \" \" + _currentInstance.sourceElementDraggingClass, true);\r\n                                _currentInstance.select({target: element}).addClass(_currentInstance.elementDraggingClass + \" \" + _currentInstance.targetElementDraggingClass, true);\r\n                                _currentInstance.setConnectionBeingDragged(true);\r\n                                if (options.canDrag) return dragOptions.canDrag();\r\n                            }, false);\r\n\r\n                            options[dragEvent] = _ju.wrap(options[dragEvent], function () {\r\n                                // TODO: here we could actually use getDragObject, and then compute it ourselves,\r\n                                // since every adapter does the same thing. but i'm not sure why YUI's getDragObject\r\n                                // differs from getUIPosition so much\r\n                                var ui = _currentInstance.getUIPosition(arguments, _currentInstance.getZoom());\r\n                                // adjust by ancestor offset if there is one: this is for the case that a draggable\r\n                                // is contained inside some other element that is not the Container.\r\n                                ui.left += _ancestorOffset.left;\r\n                                ui.top += _ancestorOffset.top;\r\n                                _draw(element, ui, null, true);\r\n                                if (_started) _currentInstance.addClass(element, \"jsPlumb_dragged\");\r\n                                _started = true;\r\n                            });\r\n                            options[stopEvent] = _ju.wrap(options[stopEvent], function () {\r\n                                var elements = [];\r\n\r\n                                // TODO once jquery is no longer supported, remove this, as we will know\r\n                                // exactly what the method signature is. For now, we need to cater for the\r\n                                // fact that jquery ui provides two args and katavorio provides only one.\r\n                                if (arguments.length == 1 && arguments[0].selection && arguments[0].selection.length > 0) {\r\n                                    elements = arguments[0].selection;\r\n                                }\r\n                                else {\r\n                                    elements = [ [ element, _currentInstance.getUIPosition(arguments, _currentInstance.getZoom(), true) ] ];\r\n                                }\r\n\r\n                                // this is one element\r\n                                var _one = function(_e) {\r\n                                    _draw(_e[0], _e[1]);\r\n                                    _currentInstance.removeClass(_e[0], \"jsPlumb_dragged\");\r\n                                    _currentInstance.select({source: _e[0]}).removeClass(_currentInstance.elementDraggingClass + \" \" + _currentInstance.sourceElementDraggingClass, true);\r\n                                    _currentInstance.select({target: _e[0]}).removeClass(_currentInstance.elementDraggingClass + \" \" + _currentInstance.targetElementDraggingClass, true);\r\n                                    _currentInstance.getDragManager().dragEnded(_e[0]);\r\n                                };\r\n\r\n                                for (var i = 0; i < elements.length; i++)\r\n                                    _one(elements[i]);\r\n\r\n                                // this is common across all\r\n                                _started = false;\r\n                                _currentInstance.setHoverSuspended(false);\r\n                                _currentInstance.setConnectionBeingDragged(false);\r\n                            });\r\n                            var elId = _getId(element); // need ID\r\n                            draggableStates[elId] = true;\r\n                            var draggable = draggableStates[elId];\r\n                            options.disabled = draggable == null ? false : !draggable;\r\n                            _currentInstance.initDraggable(element, options);\r\n                            _currentInstance.getDragManager().register(element);\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n\r\n            _scopeMatch = function (e1, e2) {\r\n                var s1 = e1.scope.split(/\\s/), s2 = e2.scope.split(/\\s/);\r\n                for (var i = 0; i < s1.length; i++)\r\n                    for (var j = 0; j < s2.length; j++)\r\n                        if (s2[j] == s1[i]) return true;\r\n\r\n                return false;\r\n            },\r\n\r\n        /*\r\n         * prepares a final params object that can be passed to _newConnection, taking into account defaults, events, etc.\r\n         */\r\n            _prepareConnectionParams = function (params, referenceParams) {\r\n                var _p = jsPlumb.extend({ }, params);\r\n                if (referenceParams) jsPlumb.extend(_p, referenceParams);\r\n\r\n                // hotwire endpoints passed as source or target to sourceEndpoint/targetEndpoint, respectively.\r\n                if (_p.source) {\r\n                    if (_p.source.endpoint)\r\n                        _p.sourceEndpoint = _p.source;\r\n                    else\r\n                        _p.source = _currentInstance.getElement(_p.source);\r\n                }\r\n                if (_p.target) {\r\n                    if (_p.target.endpoint)\r\n                        _p.targetEndpoint = _p.target;\r\n                    else\r\n                        _p.target = _currentInstance.getElement(_p.target);\r\n                }\r\n\r\n                // test for endpoint uuids to connect\r\n                if (params.uuids) {\r\n                    _p.sourceEndpoint = _getEndpoint(params.uuids[0]);\r\n                    _p.targetEndpoint = _getEndpoint(params.uuids[1]);\r\n                }\r\n\r\n                // now ensure that if we do have Endpoints already, they're not full.\r\n                // source:\r\n                if (_p.sourceEndpoint && _p.sourceEndpoint.isFull()) {\r\n                    _ju.log(_currentInstance, \"could not add connection; source endpoint is full\");\r\n                    return;\r\n                }\r\n\r\n                // target:\r\n                if (_p.targetEndpoint && _p.targetEndpoint.isFull()) {\r\n                    _ju.log(_currentInstance, \"could not add connection; target endpoint is full\");\r\n                    return;\r\n                }\r\n\r\n                // if source endpoint mandates connection type and nothing specified in our params, use it.\r\n                if (!_p.type && _p.sourceEndpoint)\r\n                    _p.type = _p.sourceEndpoint.connectionType;\r\n\r\n                // copy in any connectorOverlays that were specified on the source endpoint.\r\n                // it doesnt copy target endpoint overlays.  i'm not sure if we want it to or not.\r\n                if (_p.sourceEndpoint && _p.sourceEndpoint.connectorOverlays) {\r\n                    _p.overlays = _p.overlays || [];\r\n                    for (var i = 0, j = _p.sourceEndpoint.connectorOverlays.length; i < j; i++) {\r\n                        _p.overlays.push(_p.sourceEndpoint.connectorOverlays[i]);\r\n                    }\r\n                }\r\n\r\n                // pointer events\r\n                if (!_p[\"pointer-events\"] && _p.sourceEndpoint && _p.sourceEndpoint.connectorPointerEvents)\r\n                    _p[\"pointer-events\"] = _p.sourceEndpoint.connectorPointerEvents;\r\n\r\n                var _mergeOverrides = function (def, values) {\r\n                    var m = jsPlumb.extend({}, def);\r\n                    for (var i in values) {\r\n                        if (values[i]) m[i] = values[i];\r\n                    }\r\n                    return m;\r\n                };\r\n\r\n                var _addEndpoint = function (el, def, idx) {\r\n                    return _currentInstance.addEndpoint(el, _mergeOverrides(def, {\r\n                        anchor: _p.anchors ? _p.anchors[idx] : _p.anchor,\r\n                        endpoint: _p.endpoints ? _p.endpoints[idx] : _p.endpoint,\r\n                        paintStyle: _p.endpointStyles ? _p.endpointStyles[idx] : _p.endpointStyle,\r\n                        hoverPaintStyle: _p.endpointHoverStyles ? _p.endpointHoverStyles[idx] : _p.endpointHoverStyle\r\n                    }));\r\n                };\r\n\r\n                // check for makeSource/makeTarget specs.\r\n\r\n                var _oneElementDef = function (type, idx, defs) {\r\n                    if (_p[type] && !_p[type].endpoint && !_p[type + \"Endpoint\"] && !_p.newConnection) {\r\n                        var tid = _getId(_p[type]), tep = defs[tid];\r\n\r\n                        if (tep) {\r\n                            // if not enabled, return.\r\n                            if (!tep.enabled) return false;\r\n                            var newEndpoint = tep.endpoint != null && tep.endpoint._jsPlumb ? tep.endpoint : _addEndpoint(_p[type], tep.def, idx);\r\n                            if (newEndpoint.isFull()) return false;\r\n                            _p[type + \"Endpoint\"] = newEndpoint;\r\n                            newEndpoint._doNotDeleteOnDetach = false; // reset.\r\n                            newEndpoint._deleteOnDetach = true;\r\n                            if (tep.uniqueEndpoint) {\r\n                                if (!tep.endpoint) {\r\n                                    tep.endpoint = newEndpoint;\r\n                                    newEndpoint._deleteOnDetach = false;\r\n                                    newEndpoint._doNotDeleteOnDetach = true;\r\n                                }\r\n                                else\r\n                                    newEndpoint.finalEndpoint = tep.endpoint;\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n\r\n                if (_oneElementDef(\"source\", 0, this.sourceEndpointDefinitions) === false) return;\r\n                if (_oneElementDef(\"target\", 1, this.targetEndpointDefinitions) === false) return;\r\n\r\n                // last, ensure scopes match\r\n                if (_p.sourceEndpoint && _p.targetEndpoint)\r\n                    if (!_scopeMatch(_p.sourceEndpoint, _p.targetEndpoint)) _p = null;\r\n\r\n                return _p;\r\n            }.bind(_currentInstance),\r\n\r\n            _newConnection = function (params) {\r\n                var connectionFunc = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType();\r\n\r\n                params._jsPlumb = _currentInstance;\r\n                params.newConnection = _newConnection;\r\n                params.newEndpoint = _newEndpoint;\r\n                params.endpointsByUUID = endpointsByUUID;\r\n                params.endpointsByElement = endpointsByElement;\r\n                params.finaliseConnection = _finaliseConnection;\r\n                params.id = \"con_\" + _idstamp();\r\n                var con = new connectionFunc(params);\r\n\r\n                // if the connection is draggable, then maybe we need to tell the target endpoint to init the\r\n                // dragging code. it won't run again if it already configured to be draggable.\r\n                if (con.isDetachable()) {\r\n                    con.endpoints[0].initDraggable(\"_jsPlumbSource\");\r\n                    con.endpoints[1].initDraggable(\"_jsPlumbTarget\");\r\n                }\r\n\r\n                return con;\r\n            },\r\n\r\n        //\r\n        // adds the connection to the backing model, fires an event if necessary and then redraws\r\n        //\r\n            _finaliseConnection = _currentInstance.finaliseConnection = function (jpc, params, originalEvent, doInformAnchorManager) {\r\n                params = params || {};\r\n                // add to list of connections (by scope).\r\n                if (!jpc.suspendedEndpoint)\r\n                    connections.push(jpc);\r\n\r\n                // turn off isTemporarySource on the source endpoint (only viable on first draw)\r\n                jpc.endpoints[0].isTemporarySource = false;\r\n\r\n                // always inform the anchor manager\r\n                // except that if jpc has a suspended endpoint it's not true to say the\r\n                // connection is new; it has just (possibly) moved. the question is whether\r\n                // to make that call here or in the anchor manager.  i think perhaps here.\r\n                if (jpc.suspendedEndpoint == null || doInformAnchorManager)\r\n                    _currentInstance.anchorManager.newConnection(jpc);\r\n\r\n                // force a paint\r\n                _draw(jpc.source);\r\n\r\n                // fire an event\r\n                if (!params.doNotFireConnectionEvent && params.fireEvent !== false) {\r\n\r\n                    var eventArgs = {\r\n                        connection: jpc,\r\n                        source: jpc.source, target: jpc.target,\r\n                        sourceId: jpc.sourceId, targetId: jpc.targetId,\r\n                        sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\r\n                    };\r\n\r\n                    _currentInstance.fire(\"connection\", eventArgs, originalEvent);\r\n                }\r\n            },\r\n\r\n        /*\r\n         factory method to prepare a new endpoint.  this should always be used instead of creating Endpoints\r\n         manually, since this method attaches event listeners and an id.\r\n         */\r\n            _newEndpoint = function (params, id) {\r\n                var endpointFunc = _currentInstance.Defaults.EndpointType || jsPlumb.Endpoint;\r\n                var _p = jsPlumb.extend({}, params);\r\n                _p._jsPlumb = _currentInstance;\r\n                _p.newConnection = _newConnection;\r\n                _p.newEndpoint = _newEndpoint;\r\n                _p.endpointsByUUID = endpointsByUUID;\r\n                _p.endpointsByElement = endpointsByElement;\r\n                _p.fireDetachEvent = fireDetachEvent;\r\n                _p.elementId = id || _getId(_p.source);\r\n                var ep = new endpointFunc(_p);\r\n                ep.id = \"ep_\" + _idstamp();\r\n                _manage(_p.elementId, _p.source);\r\n\r\n                if (!jsPlumb.headless)\r\n                    _currentInstance.getDragManager().endpointAdded(_p.source, id);\r\n\r\n                return ep;\r\n            },\r\n\r\n        /*\r\n         * performs the given function operation on all the connections found\r\n         * for the given element id; this means we find all the endpoints for\r\n         * the given element, and then for each endpoint find the connectors\r\n         * connected to it. then we pass each connection in to the given\r\n         * function.\r\n         */\r\n            _operation = function (elId, func, endpointFunc) {\r\n                var endpoints = endpointsByElement[elId];\r\n                if (endpoints && endpoints.length) {\r\n                    for (var i = 0, ii = endpoints.length; i < ii; i++) {\r\n                        for (var j = 0, jj = endpoints[i].connections.length; j < jj; j++) {\r\n                            var retVal = func(endpoints[i].connections[j]);\r\n                            // if the function passed in returns true, we exit.\r\n                            // most functions return false.\r\n                            if (retVal) return;\r\n                        }\r\n                        if (endpointFunc) endpointFunc(endpoints[i]);\r\n                    }\r\n                }\r\n            },\r\n\r\n            _setDraggable = function (element, draggable) {\r\n                return jsPlumb.each(element, function (el) {\r\n                    if (_currentInstance.isDragSupported(el)) {\r\n                        draggableStates[_currentInstance.getAttribute(el, \"id\")] = draggable;\r\n                        _currentInstance.setElementDraggable(el, draggable);\r\n                    }\r\n                });\r\n            },\r\n        /*\r\n         * private method to do the business of hiding/showing.\r\n         *\r\n         * @param el\r\n         *            either Id of the element in question or a library specific\r\n         *            object for the element.\r\n         * @param state\r\n         *            String specifying a value for the css 'display' property\r\n         *            ('block' or 'none').\r\n         */\r\n            _setVisible = function (el, state, alsoChangeEndpoints) {\r\n                state = state === \"block\";\r\n                var endpointFunc = null;\r\n                if (alsoChangeEndpoints) {\r\n                    if (state) endpointFunc = function (ep) {\r\n                        ep.setVisible(true, true, true);\r\n                    };\r\n                    else endpointFunc = function (ep) {\r\n                        ep.setVisible(false, true, true);\r\n                    };\r\n                }\r\n                var info = _info(el);\r\n                _operation(info.id, function (jpc) {\r\n                    if (state && alsoChangeEndpoints) {\r\n                        // this test is necessary because this functionality is new, and i wanted to maintain backwards compatibility.\r\n                        // this block will only set a connection to be visible if the other endpoint in the connection is also visible.\r\n                        var oidx = jpc.sourceId === info.id ? 1 : 0;\r\n                        if (jpc.endpoints[oidx].isVisible()) jpc.setVisible(true);\r\n                    }\r\n                    else  // the default behaviour for show, and what always happens for hide, is to just set the visibility without getting clever.\r\n                        jpc.setVisible(state);\r\n                }, endpointFunc);\r\n            },\r\n        /*\r\n         * toggles the draggable state of the given element(s).\r\n         * el is either an id, or an element object, or a list of ids/element objects.\r\n         */\r\n            _toggleDraggable = function (el) {\r\n                return jsPlumb.each(el, function (el) {\r\n                    var elId = _currentInstance.getAttribute(el, \"id\");\r\n                    var state = draggableStates[elId] == null ? false : draggableStates[elId];\r\n                    state = !state;\r\n                    draggableStates[elId] = state;\r\n                    _currentInstance.setDraggable(el, state);\r\n                    return state;\r\n                }.bind(this));\r\n            },\r\n            /**\r\n             * private method to do the business of toggling hiding/showing.\r\n             */\r\n            _toggleVisible = function (elId, changeEndpoints) {\r\n                var endpointFunc = null;\r\n                if (changeEndpoints) {\r\n                    endpointFunc = function (ep) {\r\n                        var state = ep.isVisible();\r\n                        ep.setVisible(!state);\r\n                    };\r\n                }\r\n                _operation(elId, function (jpc) {\r\n                    var state = jpc.isVisible();\r\n                    jpc.setVisible(!state);\r\n                }, endpointFunc);\r\n            },\r\n\r\n        // TODO comparison performance\r\n            _getCachedData = function (elId) {\r\n                var o = offsets[elId];\r\n                if (!o)\r\n                    return _updateOffset({elId: elId});\r\n                else\r\n                    return {o: o, s: sizes[elId]};\r\n            },\r\n\r\n            /**\r\n             * gets an id for the given element, creating and setting one if\r\n             * necessary.  the id is of the form\r\n             *\r\n             *    jsPlumb_<instance index>_<index in instance>\r\n             *\r\n             * where \"index in instance\" is a monotonically increasing integer that starts at 0,\r\n             * for each instance.  this method is used not only to assign ids to elements that do not\r\n             * have them but also to connections and endpoints.\r\n             */\r\n            _getId = function (element, uuid, doNotCreateIfNotFound) {\r\n                if (jsPlumbUtil.isString(element)) return element;\r\n                if (element == null) return null;\r\n                var id = _currentInstance.getAttribute(element, \"id\");\r\n                if (!id || id === \"undefined\") {\r\n                    // check if fixed uuid parameter is given\r\n                    if (arguments.length == 2 && arguments[1] !== undefined)\r\n                        id = uuid;\r\n                    else if (arguments.length == 1 || (arguments.length == 3 && !arguments[2]))\r\n                        id = \"jsPlumb_\" + _instanceIndex + \"_\" + _idstamp();\r\n\r\n                    if (!doNotCreateIfNotFound) _currentInstance.setAttribute(element, \"id\", id);\r\n                }\r\n                return id;\r\n            };\r\n\r\n        this.setConnectionBeingDragged = function (v) {\r\n            connectionBeingDragged = v;\r\n        };\r\n        this.isConnectionBeingDragged = function () {\r\n            return connectionBeingDragged;\r\n        };\r\n\r\n        this.connectorClass = \"jsplumb-connector\";\r\n        this.connectorOutlineClass = \"jsplumb-connector-outline\";\r\n        this.connectedClass = \"jsplumb-connected\";\r\n        this.hoverClass = \"jsplumb-hover\";\r\n        this.endpointClass = \"jsplumb-endpoint\";\r\n        this.endpointConnectedClass = \"jsplumb-endpoint-connected\";\r\n        this.endpointFullClass = \"jsplumb-endpoint-full\";\r\n        this.endpointDropAllowedClass = \"jsplumb-endpoint-drop-allowed\";\r\n        this.endpointDropForbiddenClass = \"jsplumb-endpoint-drop-forbidden\";\r\n        this.overlayClass = \"jsplumb-overlay\";\r\n        this.draggingClass = \"jsplumb-dragging\";\r\n        this.elementDraggingClass = \"jsplumb-element-dragging\";\r\n        this.sourceElementDraggingClass = \"jsplumb-source-element-dragging\";\r\n        this.targetElementDraggingClass = \"jsplumb-target-element-dragging\";\r\n        this.endpointAnchorClassPrefix = \"jsplumb-endpoint-anchor\";\r\n        this.hoverSourceClass = \"jsplumb-source-hover\";\r\n        this.hoverTargetClass = \"jsplumb-target-hover\";\r\n        this.dragSelectClass = \"jsplumb-drag-select\";\r\n\r\n        this.Anchors = {};\r\n        this.Connectors = {  \"svg\": {}, \"vml\": {} };\r\n        this.Endpoints = { \"svg\": {}, \"vml\": {} };\r\n        this.Overlays = { \"svg\": {}, \"vml\": {} } ;\r\n        this.ConnectorRenderers = {};\r\n        this.SVG = \"svg\";\r\n        this.VML = \"vml\";\r\n\r\n// --------------------------- jsPlumbInstance public API ---------------------------------------------------------\r\n\r\n\r\n        this.addEndpoint = function (el, params, referenceParams) {\r\n            referenceParams = referenceParams || {};\r\n            var p = jsPlumb.extend({}, referenceParams);\r\n            jsPlumb.extend(p, params);\r\n            p.endpoint = p.endpoint || _currentInstance.Defaults.Endpoint;\r\n            p.paintStyle = p.paintStyle || _currentInstance.Defaults.EndpointStyle;\r\n\r\n            var results = [],\r\n                inputs = (_ju.isArray(el) || (el.length != null && !_ju.isString(el))) ? el : [ el ];\r\n\r\n            for (var i = 0, j = inputs.length; i < j; i++) {\r\n                p.source = _currentInstance.getElement(inputs[i]);\r\n                _ensureContainer(p.source);\r\n\r\n                var id = _getId(p.source), e = _newEndpoint(p, id);\r\n\r\n                // SP new. here we have introduced a class-wide element manager, which is responsible\r\n                // for getting object dimensions and width/height, and for updating these values only\r\n                // when necessary (after a drag, or on a forced refresh call).\r\n                var myOffset = _manage(id, p.source).info.o;\r\n                _ju.addToList(endpointsByElement, id, e);\r\n\r\n                if (!_suspendDrawing) {\r\n                    e.paint({\r\n                        anchorLoc: e.anchor.compute({ xy: [ myOffset.left, myOffset.top ], wh: sizes[id], element: e, timestamp: _suspendedAt }),\r\n                        timestamp: _suspendedAt\r\n                    });\r\n                }\r\n\r\n                results.push(e);\r\n                e._doNotDeleteOnDetach = true; // mark this as being added via addEndpoint.\r\n            }\r\n\r\n            return results.length == 1 ? results[0] : results;\r\n        };\r\n\r\n        this.addEndpoints = function (el, endpoints, referenceParams) {\r\n            var results = [];\r\n            for (var i = 0, j = endpoints.length; i < j; i++) {\r\n                var e = _currentInstance.addEndpoint(el, endpoints[i], referenceParams);\r\n                if (_ju.isArray(e))\r\n                    Array.prototype.push.apply(results, e);\r\n                else results.push(e);\r\n            }\r\n            return results;\r\n        };\r\n\r\n        this.animate = function (el, properties, options) {\r\n            if (!this.animationSupported) return false;\r\n\r\n            options = options || {};\r\n            var del = _currentInstance.getElement(el),\r\n                id = _getId(del),\r\n                stepFunction = jsPlumb.animEvents.step,\r\n                completeFunction = jsPlumb.animEvents.complete;\r\n\r\n            options[stepFunction] = _ju.wrap(options[stepFunction], function () {\r\n                _currentInstance.revalidate(id);\r\n            });\r\n\r\n            // onComplete repaints, just to make sure everything looks good at the end of the animation.\r\n            options[completeFunction] = _ju.wrap(options[completeFunction], function () {\r\n                _currentInstance.revalidate(id);\r\n            });\r\n\r\n            _currentInstance.doAnimate(del, properties, options);\r\n        };\r\n\r\n        /**\r\n         * checks for a listener for the given condition, executing it if found, passing in the given value.\r\n         * condition listeners would have been attached using \"bind\" (which is, you could argue, now overloaded, since\r\n         * firing click events etc is a bit different to what this does).  i thought about adding a \"bindCondition\"\r\n         * or something, but decided against it, for the sake of simplicity. jsPlumb will never fire one of these\r\n         * condition events anyway.\r\n         */\r\n        this.checkCondition = function (conditionName, args) {\r\n            var l = _currentInstance.getListener(conditionName),\r\n                r = true;\r\n\r\n            if (l && l.length > 0) {\r\n                var values = Array.prototype.slice.call(arguments, 1);\r\n                try {\r\n                    for (var i = 0, j = l.length; i < j; i++) {\r\n                        r = r && l[i].apply(l[i], values);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    _ju.log(_currentInstance, \"cannot check condition [\" + conditionName + \"]\" + e);\r\n                }\r\n            }\r\n            return r;\r\n        };\r\n\r\n        this.connect = function (params, referenceParams) {\r\n            // prepare a final set of parameters to create connection with\r\n            var _p = _prepareConnectionParams(params, referenceParams), jpc;\r\n            // TODO probably a nicer return value if the connection was not made.  _prepareConnectionParams\r\n            // will return null (and log something) if either endpoint was full.  what would be nicer is to\r\n            // create a dedicated 'error' object.\r\n            if (_p) {\r\n                if (_p.source == null && _p.sourceEndpoint == null) {\r\n                    jsPlumbUtil.log(\"Cannot establish connection - source does not exist\");\r\n                    return;\r\n                }\r\n                if (_p.target == null && _p.targetEndpoint == null) {\r\n                    jsPlumbUtil.log(\"Cannot establish connection - target does not exist\");\r\n                    return;\r\n                }\r\n                _ensureContainer(_p.source);\r\n                // create the connection.  it is not yet registered\r\n                jpc = _newConnection(_p);\r\n                // now add it the model, fire an event, and redraw\r\n                _finaliseConnection(jpc, _p);\r\n            }\r\n            return jpc;\r\n        };\r\n\r\n        var stTypes = [\r\n            { el: \"source\", elId: \"sourceId\", epDefs: \"sourceEndpointDefinitions\" },\r\n            { el: \"target\", elId: \"targetId\", epDefs: \"targetEndpointDefinitions\" }\r\n        ];\r\n\r\n        var _set = function (c, el, idx, doNotRepaint) {\r\n            var ep, _st = stTypes[idx], cId = c[_st.elId], cEl = c[_st.el], sid, sep,\r\n                oldEndpoint = c.endpoints[idx];\r\n\r\n            var evtParams = {\r\n                index: idx,\r\n                originalSourceId: idx === 0 ? cId : c.sourceId,\r\n                newSourceId: c.sourceId,\r\n                originalTargetId: idx == 1 ? cId : c.targetId,\r\n                newTargetId: c.targetId,\r\n                connection: c\r\n            };\r\n\r\n            if (el.constructor == jsPlumb.Endpoint) { // TODO here match the current endpoint class; users can change it {\r\n                ep = el;\r\n                ep.addConnection(c);\r\n            }\r\n            else {\r\n                sid = _getId(el);\r\n                sep = this[_st.epDefs][sid];\r\n\r\n                if (sid === c[_st.elId])\r\n                    ep = null;  // dont change source/target if the element is already the one given.\r\n                else if (sep) {\r\n                    if (!sep.enabled) return;\r\n                    ep = sep.endpoint != null && sep.endpoint._jsPlumb ? sep.endpoint : this.addEndpoint(el, sep.def);\r\n                    if (sep.uniqueEndpoint) sep.endpoint = ep;\r\n                    ep._doNotDeleteOnDetach = false;\r\n                    ep._deleteOnDetach = true;\r\n                    ep.addConnection(c);\r\n                }\r\n                else {\r\n                    ep = c.makeEndpoint(idx === 0, el, sid);\r\n                    ep._doNotDeleteOnDetach = false;\r\n                    ep._deleteOnDetach = true;\r\n                }\r\n            }\r\n\r\n            if (ep != null) {\r\n                oldEndpoint.detachFromConnection(c);\r\n                c.endpoints[idx] = ep;\r\n                c[_st.el] = ep.element;\r\n                c[_st.elId] = ep.elementId;\r\n                evtParams[idx === 0 ? \"newSourceId\" : \"newTargetId\"] = ep.elementId;\r\n\r\n                fireMoveEvent(evtParams);\r\n\r\n                if (!doNotRepaint)\r\n                    c.repaint();\r\n            }\r\n\r\n            return evtParams;\r\n\r\n        }.bind(this);\r\n\r\n        this.setSource = function (connection, el, doNotRepaint) {\r\n            var p = _set(connection, el, 0, doNotRepaint);\r\n            this.anchorManager.sourceChanged(p.originalSourceId, p.newSourceId, connection);\r\n        };\r\n        this.setTarget = function (connection, el, doNotRepaint) {\r\n            var p = _set(connection, el, 1, doNotRepaint);\r\n            this.anchorManager.updateOtherEndpoint(p.originalSourceId, p.originalTargetId, p.newTargetId, connection);\r\n        };\r\n\r\n        this.deleteEndpoint = function (object, dontUpdateHover) {\r\n            var endpoint = (typeof object === \"string\") ? endpointsByUUID[object] : object;\r\n            if (endpoint) {\r\n                _currentInstance.deleteObject({ endpoint: endpoint, dontUpdateHover: dontUpdateHover });\r\n            }\r\n            return _currentInstance;\r\n        };\r\n\r\n        this.deleteEveryEndpoint = function () {\r\n            var _is = _currentInstance.setSuspendDrawing(true);\r\n            for (var id in endpointsByElement) {\r\n                var endpoints = endpointsByElement[id];\r\n                if (endpoints && endpoints.length) {\r\n                    for (var i = 0, j = endpoints.length; i < j; i++) {\r\n                        _currentInstance.deleteEndpoint(endpoints[i], true);\r\n                    }\r\n                }\r\n            }\r\n            endpointsByElement = {};\r\n            // SP new\r\n            managedElements = {};\r\n            endpointsByUUID = {};\r\n            offsets = {};\r\n            offsetTimestamps = {};\r\n            _currentInstance.anchorManager.reset();\r\n            _currentInstance.getDragManager().reset();\r\n            if (!_is) _currentInstance.setSuspendDrawing(false);\r\n            return _currentInstance;\r\n        };\r\n\r\n        var fireDetachEvent = function (jpc, doFireEvent, originalEvent) {\r\n            // may have been given a connection, or in special cases, an object\r\n            var connType = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType(),\r\n                argIsConnection = jpc.constructor == connType,\r\n                params = argIsConnection ? {\r\n                    connection: jpc,\r\n                    source: jpc.source, target: jpc.target,\r\n                    sourceId: jpc.sourceId, targetId: jpc.targetId,\r\n                    sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\r\n                } : jpc;\r\n\r\n            if (doFireEvent)\r\n                _currentInstance.fire(\"connectionDetached\", params, originalEvent);\r\n\r\n            _currentInstance.anchorManager.connectionDetached(params);\r\n        };\r\n\r\n        var fireMoveEvent = _currentInstance.fireMoveEvent = function (params, evt) {\r\n            _currentInstance.fire(\"connectionMoved\", params, evt);\r\n        };\r\n\r\n        this.unregisterEndpoint = function (endpoint) {\r\n            //if (endpoint._jsPlumb == null) return;\r\n            if (endpoint._jsPlumb.uuid) endpointsByUUID[endpoint._jsPlumb.uuid] = null;\r\n            _currentInstance.anchorManager.deleteEndpoint(endpoint);\r\n            // TODO at least replace this with a removeWithFunction call.\r\n            for (var e in endpointsByElement) {\r\n                var endpoints = endpointsByElement[e];\r\n                if (endpoints) {\r\n                    var newEndpoints = [];\r\n                    for (var i = 0, j = endpoints.length; i < j; i++)\r\n                        if (endpoints[i] != endpoint) newEndpoints.push(endpoints[i]);\r\n\r\n                    endpointsByElement[e] = newEndpoints;\r\n                }\r\n                if (endpointsByElement[e].length < 1) {\r\n                    delete endpointsByElement[e];\r\n                }\r\n            }\r\n        };\r\n\r\n        this.detach = function () {\r\n\r\n            if (arguments.length === 0) return;\r\n            var connType = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType(),\r\n                firstArgIsConnection = arguments[0].constructor == connType,\r\n                params = arguments.length == 2 ? firstArgIsConnection ? (arguments[1] || {}) : arguments[0] : arguments[0],\r\n                fireEvent = (params.fireEvent !== false),\r\n                forceDetach = params.forceDetach,\r\n                conn = firstArgIsConnection ? arguments[0] : params.connection;\r\n\r\n            if (conn) {\r\n                if (forceDetach || jsPlumbUtil.functionChain(true, false, [\r\n                    [ conn.endpoints[0], \"isDetachAllowed\", [ conn ] ],\r\n                    [ conn.endpoints[1], \"isDetachAllowed\", [ conn ] ],\r\n                    [ conn, \"isDetachAllowed\", [ conn ] ],\r\n                    [ _currentInstance, \"checkCondition\", [ \"beforeDetach\", conn ] ]\r\n                ])) {\r\n\r\n                    conn.endpoints[0].detach(conn, false, true, fireEvent);\r\n                }\r\n            }\r\n            else {\r\n                var _p = jsPlumb.extend({}, params); // a backwards compatibility hack: source should be thought of as 'params' in this case.\r\n                // test for endpoint uuids to detach\r\n                if (_p.uuids) {\r\n                    _getEndpoint(_p.uuids[0]).detachFrom(_getEndpoint(_p.uuids[1]), fireEvent);\r\n                } else if (_p.sourceEndpoint && _p.targetEndpoint) {\r\n                    _p.sourceEndpoint.detachFrom(_p.targetEndpoint);\r\n                } else {\r\n                    var sourceId = _getId(_currentInstance.getElement(_p.source)),\r\n                        targetId = _getId(_currentInstance.getElement(_p.target));\r\n                    _operation(sourceId, function (jpc) {\r\n                        if ((jpc.sourceId == sourceId && jpc.targetId == targetId) || (jpc.targetId == sourceId && jpc.sourceId == targetId)) {\r\n                            if (_currentInstance.checkCondition(\"beforeDetach\", jpc)) {\r\n                                jpc.endpoints[0].detach(jpc, false, true, fireEvent);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        };\r\n\r\n        this.detachAllConnections = function (el, params) {\r\n            params = params || {};\r\n            el = _currentInstance.getElement(el);\r\n            var id = _getId(el),\r\n                endpoints = endpointsByElement[id];\r\n            if (endpoints && endpoints.length) {\r\n                for (var i = 0, j = endpoints.length; i < j; i++) {\r\n                    endpoints[i].detachAll(params.fireEvent !== false, params.forceDetach);\r\n                }\r\n            }\r\n            return _currentInstance;\r\n        };\r\n\r\n        this.detachEveryConnection = function (params) {\r\n            params = params || {};\r\n            _currentInstance.batch(function () {\r\n                for (var id in endpointsByElement) {\r\n                    var endpoints = endpointsByElement[id];\r\n                    if (endpoints && endpoints.length) {\r\n                        for (var i = 0, j = endpoints.length; i < j; i++) {\r\n                            endpoints[i].detachAll(params.fireEvent !== false, params.forceDetach);\r\n                        }\r\n                    }\r\n                }\r\n                connections.length = 0;\r\n            });\r\n            return _currentInstance;\r\n        };\r\n\r\n        /// not public.  but of course its exposed. how to change this.\r\n        this.deleteObject = function (params) {\r\n            var result = {\r\n                    endpoints: {},\r\n                    connections: {},\r\n                    endpointCount: 0,\r\n                    connectionCount: 0\r\n                },\r\n                fireEvent = params.fireEvent !== false,\r\n                deleteAttachedObjects = params.deleteAttachedObjects !== false;\r\n\r\n            var unravelConnection = function (connection) {\r\n                if (connection != null && result.connections[connection.id] == null) {\r\n                    if (!params.dontUpdateHover && connection._jsPlumb != null) connection.setHover(false);\r\n                    result.connections[connection.id] = connection;\r\n                    result.connectionCount++;\r\n                    if (deleteAttachedObjects) {\r\n                        for (var j = 0; j < connection.endpoints.length; j++) {\r\n                            if (connection.endpoints[j]._deleteOnDetach)\r\n                                unravelEndpoint(connection.endpoints[j]);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            var unravelEndpoint = function (endpoint) {\r\n                if (endpoint != null && result.endpoints[endpoint.id] == null) {\r\n                    if (!params.dontUpdateHover && endpoint._jsPlumb != null) endpoint.setHover(false);\r\n                    result.endpoints[endpoint.id] = endpoint;\r\n                    result.endpointCount++;\r\n\r\n                    if (deleteAttachedObjects) {\r\n                        for (var i = 0; i < endpoint.connections.length; i++) {\r\n                            var c = endpoint.connections[i];\r\n                            unravelConnection(c);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            if (params.connection)\r\n                unravelConnection(params.connection);\r\n            else unravelEndpoint(params.endpoint);\r\n\r\n            // loop through connections\r\n            for (var i in result.connections) {\r\n                var c = result.connections[i];\r\n                if (c._jsPlumb) {\r\n                    jsPlumbUtil.removeWithFunction(connections, function (_c) {\r\n                        return c.id == _c.id;\r\n                    });\r\n                    fireDetachEvent(c, fireEvent, params.originalEvent);\r\n\r\n                    c.endpoints[0].detachFromConnection(c);\r\n                    c.endpoints[1].detachFromConnection(c);\r\n                    c.cleanup(true);\r\n                    c.destroy(true);\r\n                }\r\n            }\r\n\r\n            // loop through endpoints\r\n            for (var j in result.endpoints) {\r\n                var e = result.endpoints[j];\r\n                if (e._jsPlumb) {\r\n                    _currentInstance.unregisterEndpoint(e);\r\n                    // FIRE some endpoint deleted event?\r\n                    e.cleanup(true);\r\n                    e.destroy(true);\r\n                }\r\n            }\r\n\r\n            return result;\r\n        };\r\n\r\n        this.draggable = function (el, options) {\r\n            var i, j, info;\r\n            // allows for array or jquery selector\r\n            if (typeof el == 'object' && el.length) {\r\n                for (i = 0, j = el.length; i < j; i++) {\r\n                    info = _info(el[i]);\r\n                    if (info.el) _initDraggableIfNecessary(info.el, true, options, info.id);\r\n                }\r\n            }\r\n            else {\r\n                //ele = _currentInstance.getElement(el);\r\n                info = _info(el);\r\n                if (info.el) _initDraggableIfNecessary(info.el, true, options, info.id);\r\n            }\r\n            return _currentInstance;\r\n        };\r\n\r\n        // helpers for select/selectEndpoints\r\n        var _setOperation = function (list, func, args, selector) {\r\n                for (var i = 0, j = list.length; i < j; i++) {\r\n                    list[i][func].apply(list[i], args);\r\n                }\r\n                return selector(list);\r\n            },\r\n            _getOperation = function (list, func, args) {\r\n                var out = [];\r\n                for (var i = 0, j = list.length; i < j; i++) {\r\n                    out.push([ list[i][func].apply(list[i], args), list[i] ]);\r\n                }\r\n                return out;\r\n            },\r\n            setter = function (list, func, selector) {\r\n                return function () {\r\n                    return _setOperation(list, func, arguments, selector);\r\n                };\r\n            },\r\n            getter = function (list, func) {\r\n                return function () {\r\n                    return _getOperation(list, func, arguments);\r\n                };\r\n            },\r\n            prepareList = function (input, doNotGetIds) {\r\n                var r = [];\r\n                if (input) {\r\n                    if (typeof input == 'string') {\r\n                        if (input === \"*\") return input;\r\n                        r.push(input);\r\n                    }\r\n                    else {\r\n                        if (doNotGetIds) r = input;\r\n                        else {\r\n                            if (input.length) {\r\n                                for (var i = 0, j = input.length; i < j; i++)\r\n                                    r.push(_info(input[i]).id);\r\n                            }\r\n                            else\r\n                                r.push(_info(input).id);\r\n                        }\r\n                    }\r\n                }\r\n                return r;\r\n            },\r\n            filterList = function (list, value, missingIsFalse) {\r\n                if (list === \"*\") return true;\r\n                return list.length > 0 ? jsPlumbUtil.indexOf(list, value) != -1 : !missingIsFalse;\r\n            };\r\n\r\n        // get some connections, specifying source/target/scope\r\n        this.getConnections = function (options, flat) {\r\n            if (!options) {\r\n                options = {};\r\n            } else if (options.constructor == String) {\r\n                options = { \"scope\": options };\r\n            }\r\n            var scope = options.scope || _currentInstance.getDefaultScope(),\r\n                scopes = prepareList(scope, true),\r\n                sources = prepareList(options.source),\r\n                targets = prepareList(options.target),\r\n                results = (!flat && scopes.length > 1) ? {} : [],\r\n                _addOne = function (scope, obj) {\r\n                    if (!flat && scopes.length > 1) {\r\n                        var ss = results[scope];\r\n                        if (ss == null) {\r\n                            ss = results[scope] = [];\r\n                        }\r\n                        ss.push(obj);\r\n                    } else results.push(obj);\r\n                };\r\n\r\n            for (var j = 0, jj = connections.length; j < jj; j++) {\r\n                var c = connections[j];\r\n                if (filterList(scopes, c.scope) && filterList(sources, c.sourceId) && filterList(targets, c.targetId))\r\n                    _addOne(c.scope, c);\r\n            }\r\n\r\n            return results;\r\n        };\r\n\r\n        var _curryEach = function (list, executor) {\r\n                return function (f) {\r\n                    for (var i = 0, ii = list.length; i < ii; i++) {\r\n                        f(list[i]);\r\n                    }\r\n                    return executor(list);\r\n                };\r\n            },\r\n            _curryGet = function (list) {\r\n                return function (idx) {\r\n                    return list[idx];\r\n                };\r\n            };\r\n\r\n        var _makeCommonSelectHandler = function (list, executor) {\r\n            var out = {\r\n                    length: list.length,\r\n                    each: _curryEach(list, executor),\r\n                    get: _curryGet(list)\r\n                },\r\n                setters = [\"setHover\", \"removeAllOverlays\", \"setLabel\", \"addClass\", \"addOverlay\", \"removeOverlay\",\r\n                    \"removeOverlays\", \"showOverlay\", \"hideOverlay\", \"showOverlays\", \"hideOverlays\", \"setPaintStyle\",\r\n                    \"setHoverPaintStyle\", \"setSuspendEvents\", \"setParameter\", \"setParameters\", \"setVisible\",\r\n                    \"repaint\", \"addType\", \"toggleType\", \"removeType\", \"removeClass\", \"setType\", \"bind\", \"unbind\" ],\r\n\r\n                getters = [\"getLabel\", \"getOverlay\", \"isHover\", \"getParameter\", \"getParameters\", \"getPaintStyle\",\r\n                    \"getHoverPaintStyle\", \"isVisible\", \"hasType\", \"getType\", \"isSuspendEvents\" ],\r\n                i, ii;\r\n\r\n            for (i = 0, ii = setters.length; i < ii; i++)\r\n                out[setters[i]] = setter(list, setters[i], executor);\r\n\r\n            for (i = 0, ii = getters.length; i < ii; i++)\r\n                out[getters[i]] = getter(list, getters[i]);\r\n\r\n            return out;\r\n        };\r\n\r\n        var _makeConnectionSelectHandler = function (list) {\r\n            var common = _makeCommonSelectHandler(list, _makeConnectionSelectHandler);\r\n            return jsPlumb.extend(common, {\r\n                // setters\r\n                setDetachable: setter(list, \"setDetachable\", _makeConnectionSelectHandler),\r\n                setReattach: setter(list, \"setReattach\", _makeConnectionSelectHandler),\r\n                setConnector: setter(list, \"setConnector\", _makeConnectionSelectHandler),\r\n                detach: function () {\r\n                    for (var i = 0, ii = list.length; i < ii; i++)\r\n                        _currentInstance.detach(list[i]);\r\n                },\r\n                // getters\r\n                isDetachable: getter(list, \"isDetachable\"),\r\n                isReattach: getter(list, \"isReattach\")\r\n            });\r\n        };\r\n\r\n        var _makeEndpointSelectHandler = function (list) {\r\n            var common = _makeCommonSelectHandler(list, _makeEndpointSelectHandler);\r\n            return jsPlumb.extend(common, {\r\n                setEnabled: setter(list, \"setEnabled\", _makeEndpointSelectHandler),\r\n                setAnchor: setter(list, \"setAnchor\", _makeEndpointSelectHandler),\r\n                isEnabled: getter(list, \"isEnabled\"),\r\n                detachAll: function () {\r\n                    for (var i = 0, ii = list.length; i < ii; i++)\r\n                        list[i].detachAll();\r\n                },\r\n                \"remove\": function () {\r\n                    for (var i = 0, ii = list.length; i < ii; i++)\r\n                        _currentInstance.deleteObject({endpoint: list[i]});\r\n                }\r\n            });\r\n        };\r\n\r\n        this.select = function (params) {\r\n            params = params || {};\r\n            params.scope = params.scope || \"*\";\r\n            return _makeConnectionSelectHandler(params.connections || _currentInstance.getConnections(params, true));\r\n        };\r\n\r\n        this.selectEndpoints = function (params) {\r\n            params = params || {};\r\n            params.scope = params.scope || \"*\";\r\n            var noElementFilters = !params.element && !params.source && !params.target,\r\n                elements = noElementFilters ? \"*\" : prepareList(params.element),\r\n                sources = noElementFilters ? \"*\" : prepareList(params.source),\r\n                targets = noElementFilters ? \"*\" : prepareList(params.target),\r\n                scopes = prepareList(params.scope, true);\r\n\r\n            var ep = [];\r\n\r\n            for (var el in endpointsByElement) {\r\n                var either = filterList(elements, el, true),\r\n                    source = filterList(sources, el, true),\r\n                    sourceMatchExact = sources != \"*\",\r\n                    target = filterList(targets, el, true),\r\n                    targetMatchExact = targets != \"*\";\r\n\r\n                // if they requested 'either' then just match scope. otherwise if they requested 'source' (not as a wildcard) then we have to match only endpoints that have isSource set to to true, and the same thing with isTarget.\r\n                if (either || source || target) {\r\n                    inner:\r\n                        for (var i = 0, ii = endpointsByElement[el].length; i < ii; i++) {\r\n                            var _ep = endpointsByElement[el][i];\r\n                            if (filterList(scopes, _ep.scope, true)) {\r\n\r\n                                var noMatchSource = (sourceMatchExact && sources.length > 0 && !_ep.isSource),\r\n                                    noMatchTarget = (targetMatchExact && targets.length > 0 && !_ep.isTarget);\r\n\r\n                                if (noMatchSource || noMatchTarget)\r\n                                    continue inner;\r\n\r\n                                ep.push(_ep);\r\n                            }\r\n                        }\r\n                }\r\n            }\r\n\r\n            return _makeEndpointSelectHandler(ep);\r\n        };\r\n\r\n        // get all connections managed by the instance of jsplumb.\r\n        this.getAllConnections = function () {\r\n            return connections;\r\n        };\r\n        this.getDefaultScope = function () {\r\n            return DEFAULT_SCOPE;\r\n        };\r\n        // get an endpoint by uuid.\r\n        this.getEndpoint = _getEndpoint;\r\n        // get endpoints for some element.\r\n        this.getEndpoints = function (el) {\r\n            return endpointsByElement[_info(el).id];\r\n        };\r\n        // gets the default endpoint type. used when subclassing. see wiki.\r\n        this.getDefaultEndpointType = function () {\r\n            return jsPlumb.Endpoint;\r\n        };\r\n        // gets the default connection type. used when subclassing.  see wiki.\r\n        this.getDefaultConnectionType = function () {\r\n            return jsPlumb.Connection;\r\n        };\r\n        /*\r\n         * Gets an element's id, creating one if necessary. really only exposed\r\n         * for the lib-specific functionality to access; would be better to pass\r\n         * the current instance into the lib-specific code (even though this is\r\n         * a static call. i just don't want to expose it to the public API).\r\n         */\r\n        this.getId = _getId;\r\n\r\n        /*this.getOffset = function (id) {\r\n            return _updateOffset({elId: id}).o;\r\n        };*/\r\n\r\n        this.appendElement = _appendElement;\r\n\r\n        var _hoverSuspended = false;\r\n        this.isHoverSuspended = function () {\r\n            return _hoverSuspended;\r\n        };\r\n        this.setHoverSuspended = function (s) {\r\n            _hoverSuspended = s;\r\n        };\r\n\r\n        // set an element's connections to be hidden\r\n        this.hide = function (el, changeEndpoints) {\r\n            _setVisible(el, \"none\", changeEndpoints);\r\n            return _currentInstance;\r\n        };\r\n\r\n        // exposed for other objects to use to get a unique id.\r\n        this.idstamp = _idstamp;\r\n\r\n        this.connectorsInitialized = false;\r\n        this.registerConnectorType = function (connector, name) {\r\n            connectorTypes.push([connector, name]);\r\n        };\r\n\r\n        // ensure that, if the current container exists, it is a DOM element and not a selector.\r\n        // if it does not exist and `candidate` is supplied, the offset parent of that element will be set as the Container.\r\n        // this is used to do a better default behaviour for the case that the user has not set a container:\r\n        // addEndpoint, makeSource, makeTarget and connect all call this method with the offsetParent of the\r\n        // element in question (for connect it is the source element). So if no container is set, it is inferred\r\n        // to be the offsetParent of the first element the user tries to connect.\r\n        var _ensureContainer = function (candidate) {\r\n            if (!_container && candidate) {\r\n                var can = _currentInstance.getElement(candidate);\r\n                if (can.offsetParent) _currentInstance.setContainer(can.offsetParent);\r\n            }\r\n        };\r\n\r\n        var _getContainerFromDefaults = function () {\r\n            if (_currentInstance.Defaults.Container)\r\n                _currentInstance.setContainer(_currentInstance.Defaults.Container);\r\n        };\r\n\r\n        // check if a given element is managed or not. if not, add to our map. if drawing is not suspended then\r\n        // we'll also stash its dimensions; otherwise we'll do this in a lazy way through updateOffset.\r\n        // TODO make sure we add a test that this tracks a setId call.\r\n        var _manage = _currentInstance.manage = function (id, element) {\r\n            if (!managedElements[id]) {\r\n                managedElements[id] = {\r\n                    el: element,\r\n                    endpoints: [],\r\n                    connections: []\r\n                };\r\n\r\n                managedElements[id].info = _updateOffset({ elId: id, timestamp: _suspendedAt });\r\n            }\r\n\r\n            return managedElements[id];\r\n        };\r\n\r\n        /**\r\n         * updates the offset and size for a given element, and stores the\r\n         * values. if 'offset' is not null we use that (it would have been\r\n         * passed in from a drag call) because it's faster; but if it is null,\r\n         * or if 'recalc' is true in order to force a recalculation, we get the current values.\r\n         */\r\n        var _updateOffset = this.updateOffset = function (params) {\r\n\r\n            var timestamp = params.timestamp, recalc = params.recalc, offset = params.offset, elId = params.elId, s;\r\n            if (_suspendDrawing && !timestamp) timestamp = _suspendedAt;\r\n            if (!recalc) {\r\n                if (timestamp && timestamp === offsetTimestamps[elId]) {\r\n                    return {o: params.offset || offsets[elId], s: sizes[elId]};\r\n                }\r\n            }\r\n            if (recalc || (!offset && offsets[elId] == null)) { // if forced repaint or no offset available, we recalculate.\r\n\r\n                // get the current size and offset, and store them\r\n                s = managedElements[elId] ? managedElements[elId].el : null;\r\n                if (s != null) {\r\n                    sizes[elId] = _currentInstance.getSize(s);\r\n                    offsets[elId] = _currentInstance.getOffset(s);\r\n                    offsetTimestamps[elId] = timestamp;\r\n                }\r\n            } else {\r\n                offsets[elId] = offset || offsets[elId];\r\n                if (sizes[elId] == null) {\r\n                    s = managedElements[elId].el;\r\n                    if (s != null) sizes[elId] = _currentInstance.getSize(s);\r\n                }\r\n                offsetTimestamps[elId] = timestamp;\r\n            }\r\n\r\n            if (offsets[elId] && !offsets[elId].right) {\r\n                offsets[elId].right = offsets[elId].left + sizes[elId][0];\r\n                offsets[elId].bottom = offsets[elId].top + sizes[elId][1];\r\n                offsets[elId].width = sizes[elId][0];\r\n                offsets[elId].height = sizes[elId][1];\r\n                offsets[elId].centerx = offsets[elId].left + (offsets[elId].width / 2);\r\n                offsets[elId].centery = offsets[elId].top + (offsets[elId].height / 2);\r\n            }\r\n\r\n            return {o: offsets[elId], s: sizes[elId]};\r\n        };\r\n\r\n        /**\r\n         * callback from the current library to tell us to prepare ourselves (attach\r\n         * mouse listeners etc; can't do that until the library has provided a bind method)\r\n         */\r\n        this.init = function () {\r\n            rendererTypes = jsPlumb.getRenderModes();\r\n\r\n            var _oneType = function (renderer, name, fn) {\r\n                jsPlumb.Connectors[renderer][name] = function () {\r\n                    fn.apply(this, arguments);\r\n                    jsPlumb.ConnectorRenderers[renderer].apply(this, arguments);\r\n                };\r\n                jsPlumbUtil.extend(jsPlumb.Connectors[renderer][name], [ fn, jsPlumb.ConnectorRenderers[renderer]]);\r\n            };\r\n\r\n            if (!jsPlumb.connectorsInitialized) {\r\n                for (var i = 0; i < connectorTypes.length; i++) {\r\n                    for (var j = 0; j < rendererTypes.length; j++) {\r\n                        _oneType(rendererTypes[j], connectorTypes[i][1], connectorTypes[i][0]);\r\n                    }\r\n\r\n                }\r\n                jsPlumb.connectorsInitialized = true;\r\n            }\r\n\r\n            if (!initialized) {\r\n                _getContainerFromDefaults();\r\n                _currentInstance.anchorManager = new jsPlumb.AnchorManager({jsPlumbInstance: _currentInstance});\r\n                _currentInstance.setRenderMode(_currentInstance.Defaults.RenderMode);  // calling the method forces the capability logic to be run.\r\n                initialized = true;\r\n                _currentInstance.fire(\"ready\", _currentInstance);\r\n            }\r\n        }.bind(this);\r\n\r\n        this.log = log;\r\n        this.jsPlumbUIComponent = jsPlumbUIComponent;\r\n\r\n        /*\r\n         * Creates an anchor with the given params.\r\n         *\r\n         *\r\n         * Returns: The newly created Anchor.\r\n         * Throws: an error if a named anchor was not found.\r\n         */\r\n        this.makeAnchor = function () {\r\n            var pp, _a = function (t, p) {\r\n                if (jsPlumb.Anchors[t]) return new jsPlumb.Anchors[t](p);\r\n                if (!_currentInstance.Defaults.DoNotThrowErrors)\r\n                    throw { msg: \"jsPlumb: unknown anchor type '\" + t + \"'\" };\r\n            };\r\n            if (arguments.length === 0) return null;\r\n            var specimen = arguments[0], elementId = arguments[1], jsPlumbInstance = arguments[2], newAnchor = null;\r\n            // if it appears to be an anchor already...\r\n            if (specimen.compute && specimen.getOrientation) return specimen;  //TODO hazy here about whether it should be added or is already added somehow.\r\n            // is it the name of an anchor type?\r\n            else if (typeof specimen == \"string\") {\r\n                newAnchor = _a(arguments[0], {elementId: elementId, jsPlumbInstance: _currentInstance});\r\n            }\r\n            // is it an array? it will be one of:\r\n            // \t\tan array of [spec, params] - this defines a single anchor, which may be dynamic, but has parameters.\r\n            //\t\tan array of arrays - this defines some dynamic anchors\r\n            //\t\tan array of numbers - this defines a single anchor.\r\n            else if (_ju.isArray(specimen)) {\r\n                if (_ju.isArray(specimen[0]) || _ju.isString(specimen[0])) {\r\n                    // if [spec, params] format\r\n                    if (specimen.length == 2 && _ju.isObject(specimen[1])) {\r\n                        // if first arg is a string, its a named anchor with params\r\n                        if (_ju.isString(specimen[0])) {\r\n                            pp = jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance}, specimen[1]);\r\n                            newAnchor = _a(specimen[0], pp);\r\n                        }\r\n                        // otherwise first arg is array, second is params. we treat as a dynamic anchor, which is fine\r\n                        // even if the first arg has only one entry. you could argue all anchors should be implicitly dynamic in fact.\r\n                        else {\r\n                            pp = jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance, anchors: specimen[0]}, specimen[1]);\r\n                            newAnchor = new jsPlumb.DynamicAnchor(pp);\r\n                        }\r\n                    }\r\n                    else\r\n                        newAnchor = new jsPlumb.DynamicAnchor({anchors: specimen, selector: null, elementId: elementId, jsPlumbInstance: _currentInstance});\r\n\r\n                }\r\n                else {\r\n                    var anchorParams = {\r\n                        x: specimen[0], y: specimen[1],\r\n                        orientation: (specimen.length >= 4) ? [ specimen[2], specimen[3] ] : [0, 0],\r\n                        offsets: (specimen.length >= 6) ? [ specimen[4], specimen[5] ] : [ 0, 0 ],\r\n                        elementId: elementId,\r\n                        jsPlumbInstance: _currentInstance,\r\n                        cssClass: specimen.length == 7 ? specimen[6] : null\r\n                    };\r\n                    newAnchor = new jsPlumb.Anchor(anchorParams);\r\n                    newAnchor.clone = function () {\r\n                        return new jsPlumb.Anchor(anchorParams);\r\n                    };\r\n                }\r\n            }\r\n\r\n            if (!newAnchor.id) newAnchor.id = \"anchor_\" + _idstamp();\r\n            return newAnchor;\r\n        };\r\n\r\n        /**\r\n         * makes a list of anchors from the given list of types or coords, eg\r\n         * [\"TopCenter\", \"RightMiddle\", \"BottomCenter\", [0, 1, -1, -1] ]\r\n         */\r\n        this.makeAnchors = function (types, elementId, jsPlumbInstance) {\r\n            var r = [];\r\n            for (var i = 0, ii = types.length; i < ii; i++) {\r\n                if (typeof types[i] == \"string\")\r\n                    r.push(jsPlumb.Anchors[types[i]]({elementId: elementId, jsPlumbInstance: jsPlumbInstance}));\r\n                else if (_ju.isArray(types[i]))\r\n                    r.push(_currentInstance.makeAnchor(types[i], elementId, jsPlumbInstance));\r\n            }\r\n            return r;\r\n        };\r\n\r\n        /**\r\n         * Makes a dynamic anchor from the given list of anchors (which may be in shorthand notation as strings or dimension arrays, or Anchor\r\n         * objects themselves) and the given, optional, anchorSelector function (jsPlumb uses a default if this is not provided; most people will\r\n         * not need to provide this - i think).\r\n         */\r\n        this.makeDynamicAnchor = function (anchors, anchorSelector) {\r\n            return new jsPlumb.DynamicAnchor({anchors: anchors, selector: anchorSelector, elementId: null, jsPlumbInstance: _currentInstance});\r\n        };\r\n\r\n// --------------------- makeSource/makeTarget ---------------------------------------------- \r\n\r\n        this.targetEndpointDefinitions = {};\r\n        var _setEndpointPaintStylesAndAnchor = function (ep, epIndex, _instance) {\r\n            ep.paintStyle = ep.paintStyle ||\r\n                _instance.Defaults.EndpointStyles[epIndex] ||\r\n                _instance.Defaults.EndpointStyle;\r\n\r\n            ep.hoverPaintStyle = ep.hoverPaintStyle ||\r\n                _instance.Defaults.EndpointHoverStyles[epIndex] ||\r\n                _instance.Defaults.EndpointHoverStyle;\r\n\r\n            ep.anchor = ep.anchor ||\r\n                _instance.Defaults.Anchors[epIndex] ||\r\n                _instance.Defaults.Anchor;\r\n\r\n            ep.endpoint = ep.endpoint ||\r\n                _instance.Defaults.Endpoints[epIndex] ||\r\n                _instance.Defaults.Endpoint;\r\n        };\r\n\r\n        // TODO put all the source stuff inside one parent, keyed by id.\r\n        this.sourceEndpointDefinitions = {};\r\n\r\n        var selectorFilter = function (evt, _el, selector, _instance, negate) {\r\n            var t = evt.target || evt.srcElement, ok = false,\r\n                sel = _instance.getSelector(_el, selector);\r\n            for (var j = 0; j < sel.length; j++) {\r\n                if (sel[j] == t) {\r\n                    ok = true;\r\n                    break;\r\n                }\r\n            }\r\n            return negate ? !ok : ok;\r\n        };\r\n\r\n        // SP target source refactor\r\n        var _makeElementDropHandler = function (elInfo, p, dropOptions, isSource, isTarget, definitionId) {\r\n            var proxyComponent = new jsPlumbUIComponent(p);\r\n            var _drop = p._jsPlumb.EndpointDropHandler({\r\n                jsPlumb: _currentInstance,\r\n                enabled: function () {\r\n                    return elInfo.el[definitionId].enabled;\r\n                },\r\n                isFull: function () {\r\n                    var targetCount = _currentInstance.select({target: elInfo.id}).length;\r\n                    var def = elInfo.el[definitionId];\r\n                    return def.maxConnections > 0 && targetCount >= def.maxConnections;\r\n                },\r\n                element: elInfo.el,\r\n                elementId: elInfo.id,\r\n                isSource: isSource,\r\n                isTarget: isTarget,\r\n                addClass: function (clazz) {\r\n                    _currentInstance.addClass(elInfo.el, clazz);\r\n                },\r\n                removeClass: function (clazz) {\r\n                    _currentInstance.removeClass(elInfo.el, clazz);\r\n                },\r\n                onDrop: function (jpc) {\r\n                    var source = jpc.endpoints[0];\r\n                    source.anchor.locked = false;\r\n                },\r\n                isDropAllowed: function () {\r\n                    return proxyComponent.isDropAllowed.apply(proxyComponent, arguments);\r\n                },\r\n                isRedrop:function(jpc) {\r\n                    return (jpc.suspendedElement != null && jpc.suspendedEndpoint != null && jpc.suspendedEndpoint.element === elInfo.el);\r\n                },\r\n                getEndpoint: function (jpc) {\r\n\r\n                    // make a new Endpoint for the target, or get it from the cache if uniqueEndpoint\r\n                    // is set. if its a redrop the new endpoint will be immediately cleaned up.\r\n                    var def = elInfo.el[definitionId],\r\n                        newEndpoint = def.endpoint;\r\n\r\n                    // if no cached endpoint, or there was one but it has been cleaned up\r\n                    // (ie. detached), create a new one\r\n                    if (newEndpoint == null || newEndpoint._jsPlumb == null) {\r\n                        newEndpoint = _currentInstance.addEndpoint(elInfo.el, p);\r\n                        newEndpoint._mtNew = true;\r\n                    }\r\n\r\n                    if (p.uniqueEndpoint) def.endpoint = newEndpoint;  // may of course just store what it just pulled out. that's ok.\r\n                    // TODO test options to makeTarget to see if we should do this?\r\n                    newEndpoint._doNotDeleteOnDetach = false; // reset.\r\n                    newEndpoint._deleteOnDetach = true;\r\n\r\n                    // if connection is detachable, init the new endpoint to be draggable, to support that happening.\r\n                    if (jpc.isDetachable())\r\n                        newEndpoint.initDraggable();\r\n\r\n                    // if the anchor has a 'positionFinder' set, then delegate to that function to find\r\n                    // out where to locate the anchor.\r\n                    if (newEndpoint.anchor.positionFinder != null) {\r\n                        var dropPosition = _currentInstance.getUIPosition(arguments, _currentInstance.getZoom()),\r\n                            //elPosition = _currentInstance.getOffset(_el),\r\n                            elPosition = _currentInstance.getOffset(elInfo.el),\r\n                            //elSize = _currentInstance.getSize(_el),\r\n                            elSize = _currentInstance.getSize(elInfo.el),\r\n                            ap = newEndpoint.anchor.positionFinder(dropPosition, elPosition, elSize, newEndpoint.anchor.constructorParams);\r\n                        newEndpoint.anchor.x = ap[0];\r\n                        newEndpoint.anchor.y = ap[1];\r\n                        // now figure an orientation for it..kind of hard to know what to do actually. probably the best thing i can do is to\r\n                        // support specifying an orientation in the anchor's spec. if one is not supplied then i will make the orientation\r\n                        // be what will cause the most natural link to the source: it will be pointing at the source, but it needs to be\r\n                        // specified in one axis only, and so how to make that choice? i think i will use whichever axis is the one in which\r\n                        // the target is furthest away from the source.\r\n                    }\r\n\r\n                    return newEndpoint;\r\n                },\r\n                maybeCleanup: function (ep) {\r\n                    if (ep._mtNew && ep.connections.length === 0) {\r\n                        _currentInstance.deleteObject({endpoint: ep});\r\n                    }\r\n                    else\r\n                        delete ep._mtNew;\r\n                }\r\n            });\r\n\r\n            // wrap drop events as needed and initialise droppable\r\n            var dropEvent = jsPlumb.dragEvents.drop;\r\n            dropOptions.scope = dropOptions.scope || (p.scope || _currentInstance.Defaults.Scope);\r\n            dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], _drop, true);\r\n\r\n            // if target, return true from the over event. this will cause katavorio to stop setting drops to hover\r\n            // if multipleDrop is set to false.\r\n            if (isTarget) {\r\n                dropOptions[jsPlumb.dragEvents.over] = function () { return true; };\r\n            }\r\n\r\n            dropOptions.definitionId = definitionId;\r\n\r\n            // vanilla jsplumb only\r\n            if (p.allowLoopback === false) {\r\n                dropOptions.canDrop = function (_drag) {\r\n                    var de = _drag.getDragElement()._jsPlumbRelatedElement;\r\n                    return de != elInfo.el;\r\n                };\r\n            }\r\n            _currentInstance.initDroppable(elInfo.el, dropOptions, \"internal\");\r\n\r\n            return _drop;\r\n\r\n        };\r\n\r\n        // see API docs\r\n        this.makeTarget = function (el, params, referenceParams) {\r\n\r\n            // put jsplumb ref into params without altering the params passed in\r\n            var p = jsPlumb.extend({_jsPlumb: this}, referenceParams);\r\n            jsPlumb.extend(p, params);\r\n\r\n            // calculate appropriate paint styles and anchor from the params given\r\n            _setEndpointPaintStylesAndAnchor(p, 1, this);\r\n\r\n            var deleteEndpointsOnDetach = !(p.deleteEndpointsOnDetach === false),\r\n                maxConnections = p.maxConnections || -1,\r\n\r\n                _doOne = function (el) {\r\n\r\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\r\n                    // and use the endpoint definition if found.\r\n                    // decode the info for this element (id and element)\r\n                    var elInfo = _info(el),\r\n                        elid = elInfo.id,\r\n                        dropOptions = jsPlumb.extend({}, p.dropOptions || {});\r\n\r\n                    _ensureContainer(elid);\r\n\r\n                    // store the definition\r\n                    var _def = {\r\n                        def: p,\r\n                        uniqueEndpoint: p.uniqueEndpoint,\r\n                        maxConnections: maxConnections,\r\n                        enabled: true\r\n                    };\r\n                    elInfo.el._jsPlumbTarget = _def;\r\n                    this.targetEndpointDefinitions[elid] = _def;\r\n                    _makeElementDropHandler(elInfo, p, dropOptions, p.isSource === true, true, \"_jsPlumbTarget\");\r\n\r\n                }.bind(this);\r\n\r\n            // make an array if only given one element\r\n            var inputs = el.length && el.constructor != String ? el : [ el ];\r\n\r\n            // register each one in the list.\r\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\r\n                _doOne(inputs[i]);\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        // see api docs\r\n        this.unmakeTarget = function (el, doNotClearArrays) {\r\n            var info = _info(el);\r\n            jsPlumb.destroyDroppable(info.el);\r\n            if (!doNotClearArrays) {\r\n                delete this.targetEndpointDefinitions[info.id];\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        // see api docs\r\n        this.makeSource = function (el, params, referenceParams) {\r\n            var p = jsPlumb.extend({_jsPlumb: this}, referenceParams);\r\n            jsPlumb.extend(p, params);\r\n            _setEndpointPaintStylesAndAnchor(p, 0, this);\r\n            var maxConnections = p.maxConnections || 1,\r\n                onMaxConnections = p.onMaxConnections,\r\n                _doOne = function (elInfo) {\r\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\r\n                    // and use the endpoint definition if found.\r\n                    var elid = elInfo.id,\r\n                        _del = this.getElement(elInfo.el);\r\n\r\n                    _ensureContainer(elid);\r\n\r\n                    var _def = {\r\n                        def: p,\r\n                        uniqueEndpoint: p.uniqueEndpoint,\r\n                        maxConnections: maxConnections,\r\n                        enabled: true\r\n                    };\r\n                    this.sourceEndpointDefinitions[elid] = _def;\r\n                    elInfo.el._jsPlumbSource = _def;\r\n\r\n                    var stopEvent = jsPlumb.dragEvents.stop,\r\n                        dragEvent = jsPlumb.dragEvents.drag,\r\n                        dragOptions = jsPlumb.extend({ }, p.dragOptions || {}),\r\n                        existingDrag = dragOptions.drag,\r\n                        existingStop = dragOptions.stop,\r\n                        ep = null,\r\n                        endpointAddedButNoDragYet = false;\r\n\r\n                    // set scope if its not set in dragOptions but was passed in in params\r\n                    dragOptions.scope = dragOptions.scope || p.scope;\r\n\r\n                    dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], function () {\r\n                        if (existingDrag) existingDrag.apply(this, arguments);\r\n                        endpointAddedButNoDragYet = false;\r\n                    });\r\n\r\n                    dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], function () {\r\n\r\n                        if (existingStop) existingStop.apply(this, arguments);\r\n                        this.currentlyDragging = false;\r\n                        if (ep._jsPlumb != null) { // if not cleaned up...\r\n\r\n                            // reset the anchor to the anchor that was initially provided. the one we were using to drag\r\n                            // the connection was just a placeholder that was located at the place the user pressed the\r\n                            // mouse button to initiate the drag.\r\n                            var anchorDef = p.anchor || this.Defaults.Anchor,\r\n                                oldAnchor = ep.anchor,\r\n                                oldConnection = ep.connections[0],\r\n                                newAnchor = this.makeAnchor(anchorDef, elid, this),\r\n                                _el = ep.element;\r\n\r\n                            // if the anchor has a 'positionFinder' set, then delegate to that function to find\r\n                            // out where to locate the anchor. issue 117.\r\n                            if (newAnchor.positionFinder != null) {\r\n                                var elPosition = _currentInstance.getOffset(_el),\r\n                                    elSize = this.getSize(_el),\r\n                                    dropPosition = { left: elPosition.left + (oldAnchor.x * elSize[0]), top: elPosition.top + (oldAnchor.y * elSize[1]) },\r\n                                    ap = newAnchor.positionFinder(dropPosition, elPosition, elSize, newAnchor.constructorParams);\r\n\r\n                                newAnchor.x = ap[0];\r\n                                newAnchor.y = ap[1];\r\n                            }\r\n\r\n                            ep.setAnchor(newAnchor, true);\r\n                            ep.repaint();\r\n                            this.repaint(ep.elementId);\r\n                            if (oldConnection != null) this.repaint(oldConnection.targetId);\r\n                        }\r\n                    }.bind(this));\r\n\r\n                    // when the user presses the mouse, add an Endpoint, if we are enabled.\r\n                    var mouseDownListener = function (e) {\r\n                        var evt = this.getOriginalEvent(e);\r\n                        // on right mouse button, abort.\r\n                        if (e.which === 3 || e.button === 2) return;\r\n\r\n                        // TODO store def on element.\r\n                        var def = this.sourceEndpointDefinitions[elid];\r\n\r\n                        // if disabled, return.\r\n                        if (!def.enabled) return;\r\n\r\n                        elid = this.getId(this.getElement(elInfo.el)); // elid might have changed since this method was called to configure the element.\r\n\r\n                        // if a filter was given, run it, and return if it says no.\r\n                        if (p.filter) {\r\n                            var r = jsPlumbUtil.isString(p.filter) ? selectorFilter(evt, elInfo.el, p.filter, this, p.filterExclude) : p.filter(evt, elInfo.el);\r\n                            if (r === false) return;\r\n                        }\r\n\r\n                        // if maxConnections reached\r\n                        var sourceCount = this.select({source: elid}).length;\r\n                        if (def.maxConnections >= 0 && (def.uniqueEndpoint && sourceCount >= def.maxConnections)) {\r\n                            if (onMaxConnections) {\r\n                                onMaxConnections({\r\n                                    element: elInfo.el,\r\n                                    maxConnections: maxConnections\r\n                                }, e);\r\n                            }\r\n                            return false;\r\n                        }\r\n\r\n                        // find the position on the element at which the mouse was pressed; this is where the endpoint\r\n                        // will be located.\r\n                        var elxy = jsPlumb.getPositionOnElement(evt, _del, _zoom);\r\n\r\n                        // we need to override the anchor in here, and force 'isSource', but we don't want to mess with\r\n                        // the params passed in, because after a connection is established we're going to reset the endpoint\r\n                        // to have the anchor we were given.\r\n                        var tempEndpointParams = {};\r\n                        jsPlumb.extend(tempEndpointParams, p);\r\n                        tempEndpointParams.isTemporarySource = true;\r\n                        tempEndpointParams.anchor = [ elxy[0], elxy[1] , 0, 0];\r\n                        tempEndpointParams.dragOptions = dragOptions;\r\n\r\n                        ep = this.addEndpoint(elid, tempEndpointParams);\r\n                        endpointAddedButNoDragYet = true;\r\n                        ep._doNotDeleteOnDetach = false; // reset.\r\n                        ep._deleteOnDetach = true;\r\n\r\n                        // if unique endpoint and it's already been created, push it onto the endpoint we create. at the end\r\n                        // of a successful connection we'll switch to that endpoint.\r\n                        // TODO this is the same code as the programmatic endpoints create on line 1050 ish\r\n                        if (def.uniqueEndpoint) {\r\n                            if (!def.endpoint) {\r\n                                def.endpoint = ep;\r\n                                ep._deleteOnDetach = false;\r\n                                ep._doNotDeleteOnDetach = true;\r\n                            }\r\n                            else\r\n                                ep.finalEndpoint = def.endpoint;\r\n                        }\r\n\r\n                        var _delTempEndpoint = function () {\r\n                            // this mouseup event is fired only if no dragging occurred, by jquery and yui, but for mootools\r\n                            // it is fired even if dragging has occurred, in which case we would blow away a perfectly\r\n                            // legitimate endpoint, were it not for this check.  the flag is set after adding an\r\n                            // endpoint and cleared in a drag listener we set in the dragOptions above.\r\n                            _currentInstance.off(ep.canvas, \"mouseup\", _delTempEndpoint);\r\n                            _currentInstance.off(elInfo.el, \"mouseup\", _delTempEndpoint);\r\n                            if (endpointAddedButNoDragYet) {\r\n                                endpointAddedButNoDragYet = false;\r\n                                _currentInstance.deleteEndpoint(ep);\r\n                            }\r\n                        };\r\n\r\n                        _currentInstance.on(ep.canvas, \"mouseup\", _delTempEndpoint);\r\n                        _currentInstance.on(elInfo.el, \"mouseup\", _delTempEndpoint);\r\n\r\n                        // and then trigger its mousedown event, which will kick off a drag, which will start dragging\r\n                        // a new connection from this endpoint.\r\n                        _currentInstance.trigger(ep.canvas, \"mousedown\", e);\r\n\r\n                        jsPlumbUtil.consume(e);\r\n\r\n                    }.bind(this);\r\n\r\n                    //this.on(_el, \"mousedown\", mouseDownListener);\r\n                    this.on(elInfo.el, \"mousedown\", mouseDownListener);\r\n                    _def.trigger = mouseDownListener;\r\n\r\n                    // if a filter was provided, set it as a dragFilter on the element,\r\n                    // to prevent the element drag function from kicking in when we want to\r\n                    // drag a new connection\r\n                    if (p.filter && (jsPlumbUtil.isString(p.filter) || jsPlumbUtil.isFunction(p.filter))) {\r\n                        //_currentInstance.setDragFilter(_el, p.filter/*, p.filterExclude*/);\r\n                        _currentInstance.setDragFilter(elInfo.el, p.filter/*, p.filterExclude*/);\r\n                    }\r\n\r\n                    var dropOptions = jsPlumb.extend({}, p.dropOptions || {});\r\n\r\n                    _makeElementDropHandler(elInfo, p, dropOptions, true, p.isTarget === true, \"_jsPlumbSource\");\r\n\r\n                }.bind(this);\r\n\r\n            var inputs = el.length && el.constructor != String ? el : [ el ];\r\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\r\n                _doOne(_info(inputs[i]));\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        // see api docs\r\n        this.unmakeSource = function (el, doNotClearArrays) {\r\n            var info = _info(el),\r\n                mouseDownListener = this.sourceEndpointDefinitions[info.id].trigger;\r\n\r\n            if (mouseDownListener)\r\n                _currentInstance.off(info.el, \"mousedown\", mouseDownListener);\r\n\r\n            if (!doNotClearArrays) {\r\n                delete this.sourceEndpointDefinitions[info.id];\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        // see api docs\r\n        this.unmakeEverySource = function () {\r\n            for (var i in this.sourceEndpointDefinitions)\r\n                _currentInstance.unmakeSource(i, true);\r\n\r\n            this.sourceEndpointDefinitions = {};\r\n            return this;\r\n        };\r\n\r\n        var _getScope = function (el, types) {\r\n            types = jsPlumbUtil.isArray(types) ? types : [ types ];\r\n            var id = _getId(el);\r\n            for (var i = 0; i < types.length; i++) {\r\n                var def = this[types[i]][id];\r\n                if (def) return def.def.scope || this.Defaults.Scope;\r\n            }\r\n        }.bind(this);\r\n\r\n        var _setScope = function (el, scope, types) {\r\n            types = jsPlumbUtil.isArray(types) ? types : [ types ];\r\n            var id = _getId(el);\r\n            for (var i = 0; i < types.length; i++) {\r\n                var def = this[types[i]][id];\r\n                if (def) {\r\n                    def.def.scope = scope;\r\n                    if (this.scopeChange != null) this.scopeChange(el, id, endpointsByElement[id], scope, types[i]);\r\n                }\r\n            }\r\n\r\n        }.bind(this);\r\n\r\n        this.getScope = function (el, scope) {\r\n            return _getScope(el, [ \"sourceEndpointDefinitions\", \"targetEndpointDefinitions\" ]);\r\n        };\r\n        this.getSourceScope = function (el) {\r\n            return _getScope(el, \"sourceEndpointDefinitions\");\r\n        };\r\n        this.getTargetScope = function (el) {\r\n            return _getScope(el, \"targetEndpointDefinitions\");\r\n        };\r\n        this.setScope = function (el, scope) {\r\n            _setScope(el, scope, [ \"sourceEndpointDefinitions\", \"targetEndpointDefinitions\" ]);\r\n        };\r\n        this.setSourceScope = function (el, scope) {\r\n            _setScope(el, scope, \"sourceEndpointDefinitions\");\r\n        };\r\n        this.setTargetScope = function (el, scope) {\r\n            _setScope(el, scope, \"targetEndpointDefinitions\");\r\n        };\r\n\r\n        // see api docs\r\n        this.unmakeEveryTarget = function () {\r\n            for (var i in this.targetEndpointDefinitions)\r\n                _currentInstance.unmakeTarget(i, true);\r\n\r\n            this.targetEndpointDefinitions = {};\r\n            return this;\r\n        };\r\n\r\n        // does the work of setting a source enabled or disabled.\r\n        var _setEnabled = function (type, el, state, toggle) {\r\n            var a = type == \"source\" ? this.sourceEndpointDefinitions : this.targetEndpointDefinitions;\r\n\r\n            if (_ju.isString(el)) a[el].enabled = toggle ? !a[el].enabled : state;\r\n            else if (el.length) {\r\n                for (var i = 0, ii = el.length; i < ii; i++) {\r\n                    var info = _info(el[i]);\r\n                    if (a[info.id])\r\n                        a[info.id].enabled = toggle ? !a[info.id].enabled : state;\r\n                }\r\n            }\r\n            // otherwise a DOM element\r\n            else {\r\n                var id = _info(el).id;\r\n                a[id].enabled = toggle ? !a[id].enabled : state;\r\n            }\r\n            return this;\r\n        }.bind(this);\r\n\r\n        var _first = function (el, fn) {\r\n            if (_ju.isString(el) || !el.length)\r\n                return fn.apply(this, [ el ]);\r\n            else if (el.length)\r\n                return fn.apply(this, [ el[0] ]);\r\n\r\n        }.bind(this);\r\n\r\n        this.toggleSourceEnabled = function (el) {\r\n            _setEnabled(\"source\", el, null, true);\r\n            return this.isSourceEnabled(el);\r\n        };\r\n\r\n        this.setSourceEnabled = function (el, state) {\r\n            return _setEnabled(\"source\", el, state);\r\n        };\r\n        this.isSource = function (el) {\r\n            return _first(el, function (_el) {\r\n                return this.sourceEndpointDefinitions[_info(_el).id] != null;\r\n            }.bind(this));\r\n        };\r\n        this.isSourceEnabled = function (el) {\r\n            return _first(el, function (_el) {\r\n                var sep = this.sourceEndpointDefinitions[_info(_el).id];\r\n                return sep && sep.enabled === true;\r\n            }.bind(this));\r\n        };\r\n\r\n        this.toggleTargetEnabled = function (el) {\r\n            _setEnabled(\"target\", el, null, true);\r\n            return this.isTargetEnabled(el);\r\n        };\r\n\r\n        this.isTarget = function (el) {\r\n            return _first(el, function (_el) {\r\n                return this.targetEndpointDefinitions[_info(_el).id] != null;\r\n            }.bind(this));\r\n        };\r\n        this.isTargetEnabled = function (el) {\r\n            return _first(el, function (_el) {\r\n                var tep = this.targetEndpointDefinitions[_info(_el).id];\r\n                return tep && tep.enabled === true;\r\n            }.bind(this));\r\n        };\r\n        this.setTargetEnabled = function (el, state) {\r\n            return _setEnabled(\"target\", el, state);\r\n        };\r\n\r\n// --------------------- end makeSource/makeTarget ---------------------------------------------- \t\t\t\t\r\n\r\n        this.ready = function (fn) {\r\n            _currentInstance.bind(\"ready\", fn);\r\n        };\r\n\r\n        var _elEach = function(el, fn) {\r\n            // support both lists...\r\n            if (typeof el == 'object' && el.length)\r\n                for (var i = 0, ii = el.length; i < ii; i++) {\r\n                    fn(el[i]);\r\n                }\r\n            else // ...and single strings or elements.\r\n                fn(el);\r\n\r\n            return _currentInstance;\r\n        };\r\n\r\n        // repaint some element's endpoints and connections\r\n        this.repaint = function (el, ui, timestamp) {\r\n            return _elEach(el, function(_el) {\r\n                _draw(_el, ui, timestamp);\r\n            });\r\n        };\r\n\r\n        this.revalidate = function (el, timestamp, isIdAlready) {\r\n            return _elEach(el, function(_el) {\r\n                var elId = isIdAlready ? _el : _currentInstance.getId(_el);\r\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp:timestamp });\r\n                _currentInstance.repaint(_el);\r\n            });\r\n        };\r\n\r\n        // repaint every endpoint and connection.\r\n        this.repaintEverything = function () {\r\n            // TODO this timestamp causes continuous anchors to not repaint properly.\r\n            // fix this. do not just take out the timestamp. it runs a lot faster with\r\n            // the timestamp included.\r\n            var timestamp = _timestamp(), elId;\r\n\r\n            for (elId in endpointsByElement) {\r\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp: timestamp });\r\n            }\r\n\r\n            for (elId in endpointsByElement) {\r\n                _draw(elId, null, timestamp);\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        this.removeAllEndpoints = function (el, recurse, affectedElements) {\r\n            affectedElements = affectedElements || [];\r\n            var _one = function (_el) {\r\n                var info = _info(_el),\r\n                    ebe = endpointsByElement[info.id],\r\n                    i, ii;\r\n\r\n                if (ebe) {\r\n                    affectedElements.push(info);\r\n                    for (i = 0, ii = ebe.length; i < ii; i++)\r\n                        _currentInstance.deleteEndpoint(ebe[i]);\r\n                }\r\n                delete endpointsByElement[info.id];\r\n\r\n                if (recurse) {\r\n                    if (info.el && info.el.nodeType != 3 && info.el.nodeType != 8) {\r\n                        for (i = 0, ii = info.el.childNodes.length; i < ii; i++) {\r\n                            _one(info.el.childNodes[i]);\r\n                        }\r\n                    }\r\n                }\r\n\r\n            };\r\n            _one(el);\r\n            return this;\r\n        };\r\n\r\n        var _doRemove = function(info, affectedElements) {\r\n            _currentInstance.removeAllEndpoints(info.id, true, affectedElements);\r\n            var _one = function(_info) {\r\n                _currentInstance.getDragManager().elementRemoved(_info.id);\r\n                _currentInstance.anchorManager.clearFor(_info.id);\r\n                _currentInstance.anchorManager.removeFloatingConnection(_info.id);\r\n                delete _currentInstance.floatingConnections[_info.id];\r\n                delete managedElements[_info.id];\r\n                delete offsets[_info.id];\r\n                if (_info.el) {\r\n                    _currentInstance.removeElement(_info.el);\r\n                    _info.el._jsPlumb = null;\r\n                }\r\n            };\r\n\r\n            // remove all affected child elements\r\n            for (var ae = 1; ae < affectedElements.length; ae++) {\r\n                _one(affectedElements[ae]);\r\n            }\r\n            // and always remove the requested one from the dom.\r\n            _one(info);\r\n        };\r\n\r\n        /**\r\n         * Remove the given element, including cleaning up all endpoints registered for it.\r\n         * This is exposed in the public API but also used internally by jsPlumb when removing the\r\n         * element associated with a connection drag.\r\n         */\r\n        this.remove = function (el, doNotRepaint) {\r\n            var info = _info(el), affectedElements = [];\r\n            if (info.text) {\r\n                info.el.parentNode.removeChild(info.el);\r\n            }\r\n            else if (info.id) {\r\n                _currentInstance.batch(function () {\r\n                    _doRemove(info, affectedElements);\r\n                }, doNotRepaint === false);\r\n            }\r\n            return _currentInstance;\r\n        };\r\n\r\n        this.empty = function (el, doNotRepaint) {\r\n            var affectedElements = [];\r\n            var _one = function(el, dontRemoveFocus) {\r\n                var info = _info(el);\r\n                if (info.text) {\r\n                    info.el.parentNode.removeChild(info.el);\r\n                }\r\n                else if (info.el) {\r\n                    while(info.el.childNodes.length > 0) {\r\n                        _one(info.el.childNodes[0]);\r\n                    }\r\n                    if (!dontRemoveFocus) _doRemove(info, affectedElements);\r\n                }\r\n            };\r\n\r\n            _currentInstance.batch(function() {\r\n                _one(el, true);\r\n            }, doNotRepaint === false);\r\n\r\n            return _currentInstance;\r\n        };\r\n\r\n        this.reset = function () {\r\n            _currentInstance.silently(function() {\r\n                _currentInstance.deleteEveryEndpoint();\r\n                _currentInstance.unbind();\r\n                this.targetEndpointDefinitions = {};\r\n                this.sourceEndpointDefinitions = {};\r\n                connections.length = 0;\r\n                if (this.doReset) this.doReset();\r\n            }.bind(this));\r\n        };\r\n\r\n        var _clearObject = function (obj) {\r\n            if (obj.canvas && obj.canvas.parentNode)\r\n                obj.canvas.parentNode.removeChild(obj.canvas);\r\n            obj.cleanup();\r\n            obj.destroy();\r\n        };\r\n\r\n        this.clear = function () {\r\n            _currentInstance.select().each(_clearObject);\r\n            _currentInstance.selectEndpoints().each(_clearObject);\r\n\r\n            endpointsByElement = {};\r\n            endpointsByUUID = {};\r\n        };\r\n\r\n        this.setDefaultScope = function (scope) {\r\n            DEFAULT_SCOPE = scope;\r\n            return _currentInstance;\r\n        };\r\n\r\n        // sets whether or not some element should be currently draggable.\r\n        this.setDraggable = _setDraggable;\r\n\r\n        // sets the id of some element, changing whatever we need to to keep track.\r\n        this.setId = function (el, newId, doNotSetAttribute) {\r\n            //\r\n            var id;\r\n\r\n            if (jsPlumbUtil.isString(el)) {\r\n                id = el;\r\n            }\r\n            else {\r\n                el = this.getElement(el);\r\n                id = this.getId(el);\r\n            }\r\n\r\n            var sConns = this.getConnections({source: id, scope: '*'}, true),\r\n                tConns = this.getConnections({target: id, scope: '*'}, true);\r\n\r\n            newId = \"\" + newId;\r\n\r\n            if (!doNotSetAttribute) {\r\n                el = this.getElement(id);\r\n                this.setAttribute(el, \"id\", newId);\r\n            }\r\n            else\r\n                el = this.getElement(newId);\r\n\r\n            endpointsByElement[newId] = endpointsByElement[id] || [];\r\n            for (var i = 0, ii = endpointsByElement[newId].length; i < ii; i++) {\r\n                endpointsByElement[newId][i].setElementId(newId);\r\n                endpointsByElement[newId][i].setReferenceElement(el);\r\n            }\r\n            delete endpointsByElement[id];\r\n\r\n            this.anchorManager.changeId(id, newId);\r\n            this.getDragManager().changeId(id, newId);\r\n            managedElements[newId] = managedElements[id];\r\n            delete managedElements[id];\r\n\r\n            var _conns = function (list, epIdx, type) {\r\n                for (var i = 0, ii = list.length; i < ii; i++) {\r\n                    list[i].endpoints[epIdx].setElementId(newId);\r\n                    list[i].endpoints[epIdx].setReferenceElement(el);\r\n                    list[i][type + \"Id\"] = newId;\r\n                    list[i][type] = el;\r\n                }\r\n            };\r\n            _conns(sConns, 0, \"source\");\r\n            _conns(tConns, 1, \"target\");\r\n\r\n            this.repaint(newId);\r\n        };\r\n\r\n        this.setDebugLog = function (debugLog) {\r\n            log = debugLog;\r\n        };\r\n\r\n        this.setSuspendDrawing = function (val, repaintAfterwards) {\r\n            var curVal = _suspendDrawing;\r\n            _suspendDrawing = val;\r\n            if (val) _suspendedAt = new Date().getTime(); else _suspendedAt = null;\r\n            if (repaintAfterwards) this.repaintEverything();\r\n            return curVal;\r\n        };\r\n\r\n        // returns whether or not drawing is currently suspended.\r\n        this.isSuspendDrawing = function () {\r\n            return _suspendDrawing;\r\n        };\r\n\r\n        // return timestamp for when drawing was suspended.\r\n        this.getSuspendedAt = function () {\r\n            return _suspendedAt;\r\n        };\r\n\r\n        this.batch = function (fn, doNotRepaintAfterwards) {\r\n            var _wasSuspended = this.isSuspendDrawing();\r\n            if (!_wasSuspended)\r\n                this.setSuspendDrawing(true);\r\n            try {\r\n                fn();\r\n            }\r\n            catch (e) {\r\n                _ju.log(\"Function run while suspended failed\", e);\r\n            }\r\n            if (!_wasSuspended)\r\n                this.setSuspendDrawing(false, !doNotRepaintAfterwards);\r\n        };\r\n\r\n        this.doWhileSuspended = this.batch;\r\n\r\n        /*\r\n        this.getOffset = function (elId) {\r\n            return offsets[elId];\r\n        };*/\r\n\r\n        this.getCachedData = _getCachedData;\r\n        this.timestamp = _timestamp;\r\n        this.setRenderMode = function (mode) {\r\n            if (mode !== jsPlumb.SVG && mode !== jsPlumb.VML) throw new TypeError(\"Render mode [\" + mode + \"] not supported\");\r\n            renderMode = this.trySetRenderMode(mode);\r\n            return renderMode;\r\n        };\r\n        this.getRenderMode = function () {\r\n            return renderMode;\r\n        };\r\n        this.show = function (el, changeEndpoints) {\r\n            _setVisible(el, \"block\", changeEndpoints);\r\n            return _currentInstance;\r\n        };\r\n\r\n        // TODO: update this method to return the current state.\r\n        this.toggleVisible = _toggleVisible;\r\n        this.toggleDraggable = _toggleDraggable;\r\n        this.addListener = this.bind;\r\n    };\r\n\r\n    jsPlumbUtil.extend(jsPlumbInstance, jsPlumbUtil.EventGenerator, {\r\n        setAttribute: function (el, a, v) {\r\n            this.setAttribute(el, a, v);\r\n        },\r\n        getAttribute: function (el, a) {\r\n            return this.getAttribute(jsPlumb.getElement(el), a);\r\n        },\r\n        convertToFullOverlaySpec: function(spec) {\r\n            if (jsPlumbUtil.isString(spec)) {\r\n                spec = [ spec, { } ];\r\n            }\r\n            spec[1].id = spec[1].id || jsPlumbUtil.uuid();\r\n            return spec;\r\n        },\r\n        registerConnectionType: function (id, type) {\r\n            this._connectionTypes[id] = jsPlumb.extend({}, type);\r\n            if (type.overlays) {\r\n                var to = {};\r\n                for (var i = 0; i < type.overlays.length; i++) {\r\n                    // if a string, convert to object representation so that we can store the typeid on it.\r\n                    // also assign an id.\r\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\r\n                    to[fo[1].id] = fo;\r\n                }\r\n                this._connectionTypes[id].overlays = to;\r\n            }\r\n        },\r\n        registerConnectionTypes: function (types) {\r\n            for (var i in types)\r\n                this.registerConnectionType(i, types[i]);\r\n        },\r\n        registerEndpointType: function (id, type) {\r\n            this._endpointTypes[id] = jsPlumb.extend({}, type);\r\n        },\r\n        registerEndpointTypes: function (types) {\r\n            for (var i in types)\r\n                this._endpointTypes[i] = jsPlumb.extend({}, types[i]);\r\n        },\r\n        getType: function (id, typeDescriptor) {\r\n            return typeDescriptor === \"connection\" ? this._connectionTypes[id] : this._endpointTypes[id];\r\n        },\r\n        setIdChanged: function (oldId, newId) {\r\n            this.setId(oldId, newId, true);\r\n        },\r\n        // set parent: change the parent for some node and update all the registrations we need to.\r\n        setParent: function (el, newParent) {\r\n            var _dom = this.getElement(el),\r\n                _id = this.getId(_dom),\r\n                _pdom = this.getElement(newParent),\r\n                _pid = this.getId(_pdom);\r\n\r\n            _dom.parentNode.removeChild(_dom);\r\n            _pdom.appendChild(_dom);\r\n            this.getDragManager().setParent(_dom, _id, _pdom, _pid);\r\n        },\r\n        extend: function (o1, o2, names) {\r\n            var i;\r\n            if (names) {\r\n                for (i = 0; i < names.length; i++)\r\n                    o1[names[i]] = o2[names[i]];\r\n            }\r\n            else\r\n                for (i in o2) o1[i] = o2[i];\r\n            return o1;\r\n        },\r\n        floatingConnections: {},\r\n        getFloatingAnchorIndex: function (jpc) {\r\n            return jpc.endpoints[0].isFloating() ? 0 : 1;\r\n        }\r\n    });\r\n\r\n// --------------------- static instance + AMD registration -------------------------------------------\t\r\n\r\n// create static instance and assign to window if window exists.\t\r\n    var jsPlumb = new jsPlumbInstance();\r\n    // register on window if defined (lets us run on server)\r\n    if (typeof window != 'undefined') window.jsPlumb = jsPlumb;\r\n    // add 'getInstance' method to static instance\r\n    jsPlumb.getInstance = function (_defaults) {\r\n        var j = new jsPlumbInstance(_defaults);\r\n        j.init();\r\n        return j;\r\n    };\r\n    jsPlumb.each = function (spec, fn) {\r\n        if (spec == null) return;\r\n        if (typeof spec === \"string\")\r\n            fn(jsPlumb.getElement(spec));\r\n        else if (spec.length != null) {\r\n            for (var i = 0; i < spec.length; i++)\r\n                fn(jsPlumb.getElement(spec[i]));\r\n        }\r\n        else\r\n            fn(spec); // assume it's an element.\r\n    };\r\n// maybe register static instance as an AMD module, and getInstance method too.\r\n    if (typeof define === \"function\") {\r\n        define(\"jsplumb\", [], function () {\r\n            return jsPlumb;\r\n        });\r\n        define(\"jsplumbinstance\", [], function () {\r\n            return jsPlumb.getInstance();\r\n        });\r\n    }\r\n    // CommonJS\r\n    if (typeof exports !== 'undefined') {\r\n        exports.jsPlumb = jsPlumb;\r\n    }\r\n\r\n\r\n// --------------------- end static instance + AMD registration -------------------------------------------\t\t\r\n\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n *\r\n * Title:jsPlumb 1.7.6\r\n *\r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.\r\n *\r\n * This file contains the base functionality for DOM type adapters.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n    var root = this, _ju = root.jsPlumbUtil;\r\n\r\n    var svgAvailable = !!window.SVGAngle || document.implementation.hasFeature(\"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\"),\r\n        vmlAvailable = function () {\r\n            if (vmlAvailable.vml === undefined) {\r\n                var a = document.body.appendChild(document.createElement('div'));\r\n                a.innerHTML = '<v:shape id=\"vml_flag1\" adj=\"1\" />';\r\n                var b = a.firstChild;\r\n                if (b != null && b.style != null) {\r\n                    b.style.behavior = \"url(#default#VML)\";\r\n                    vmlAvailable.vml = b ? typeof b.adj == \"object\" : true;\r\n                }\r\n                else\r\n                    vmlAvailable.vml = false;\r\n                a.parentNode.removeChild(a);\r\n            }\r\n            return vmlAvailable.vml;\r\n        },\r\n    // TODO: remove this once we remove all library adapter versions and have only vanilla jsplumb: this functionality\r\n    // comes from Mottle.\r\n        iev = (function () {\r\n            var rv = -1;\r\n            if (navigator.appName == 'Microsoft Internet Explorer') {\r\n                var ua = navigator.userAgent,\r\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\r\n                if (re.exec(ua) != null)\r\n                    rv = parseFloat(RegExp.$1);\r\n            }\r\n            return rv;\r\n        })(),\r\n        isIELT9 = iev > -1 && iev < 9,\r\n        _genLoc = function (e, prefix) {\r\n            if (e == null) return [ 0, 0 ];\r\n            var ts = _touches(e), t = _getTouch(ts, 0);\r\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\r\n        },\r\n        _pageLocation = function (e) {\r\n            if (e == null) return [ 0, 0 ];\r\n            if (isIELT9) {\r\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\r\n            }\r\n            else {\r\n                return _genLoc(e, \"page\");\r\n            }\r\n        },\r\n        _screenLocation = function (e) {\r\n            return _genLoc(e, \"screen\");\r\n        },\r\n        _clientLocation = function (e) {\r\n            return _genLoc(e, \"client\");\r\n        },\r\n        _getTouch = function (touches, idx) {\r\n            return touches.item ? touches.item(idx) : touches[idx];\r\n        },\r\n        _touches = function (e) {\r\n            return e.touches && e.touches.length > 0 ? e.touches :\r\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\r\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\r\n                [ e ];\r\n        };\r\n\r\n    /**\r\n     Manages dragging for some instance of jsPlumb.\r\n\r\n     TODO instead of this being accessed directly, it should subscribe to events on the jsPlumb instance: every method\r\n     in here is called directly by jsPlumb. But what should happen is that we have unpublished events that this listens\r\n     to.  The only trick is getting one of these instantiated with every jsPlumb instance: it needs to have a hook somehow.\r\n     Basically the general idea is to pull ALL the drag code out (prototype method registrations plus this) into a\r\n     dedicated drag script), that does not necessarily need to be included.\r\n\r\n\r\n     */\r\n    var DragManager = function (_currentInstance) {\r\n        var _draggables = {}, _dlist = [], _delements = {}, _elementsWithEndpoints = {},\r\n        // elementids mapped to the draggable to which they belong.\r\n            _draggablesForElements = {};\r\n\r\n        /**\r\n         register some element as draggable.  right now the drag init stuff is done elsewhere, and it is\r\n         possible that will continue to be the case.\r\n         */\r\n        this.register = function (el) {\r\n            var id = _currentInstance.getId(el),\r\n                parentOffset = _currentInstance.getOffset(el);\r\n\r\n            if (!_draggables[id]) {\r\n                _draggables[id] = el;\r\n                _dlist.push(el);\r\n                _delements[id] = {};\r\n            }\r\n\r\n            // look for child elements that have endpoints and register them against this draggable.\r\n            var _oneLevel = function (p) {\r\n                if (p) {\r\n                    for (var i = 0; i < p.childNodes.length; i++) {\r\n                        if (p.childNodes[i].nodeType != 3 && p.childNodes[i].nodeType != 8) {\r\n                            var cEl = jsPlumb.getElement(p.childNodes[i]),\r\n                                cid = _currentInstance.getId(p.childNodes[i], null, true);\r\n                            if (cid && _elementsWithEndpoints[cid] && _elementsWithEndpoints[cid] > 0) {\r\n                                var cOff = _currentInstance.getOffset(cEl);\r\n                                _delements[id][cid] = {\r\n                                    id: cid,\r\n                                    offset: {\r\n                                        left: cOff.left - parentOffset.left,\r\n                                        top: cOff.top - parentOffset.top\r\n                                    }\r\n                                };\r\n                                _draggablesForElements[cid] = id;\r\n                            }\r\n                            _oneLevel(p.childNodes[i]);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            _oneLevel(el);\r\n        };\r\n\r\n        // refresh the offsets for child elements of this element.\r\n        this.updateOffsets = function (elId) {\r\n            if (elId != null) {\r\n                var domEl = jsPlumb.getElement(elId),\r\n                    id = _currentInstance.getId(domEl),\r\n                    children = _delements[id],\r\n                    parentOffset = _currentInstance.getOffset(domEl);\r\n\r\n                if (children) {\r\n                    for (var i in children) {\r\n                        if (children.hasOwnProperty(i)) {\r\n                            var cel = jsPlumb.getElement(i),\r\n                                cOff = _currentInstance.getOffset(cel);\r\n\r\n                            _delements[id][i] = {\r\n                                id: i,\r\n                                offset: {\r\n                                    left: cOff.left - parentOffset.left,\r\n                                    top: cOff.top - parentOffset.top\r\n                                }\r\n                            };\r\n                            _draggablesForElements[i] = id;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        /**\r\n         notification that an endpoint was added to the given el.  we go up from that el's parent\r\n         node, looking for a parent that has been registered as a draggable. if we find one, we add this\r\n         el to that parent's list of elements to update on drag (if it is not there already)\r\n         */\r\n        this.endpointAdded = function (el, id) {\r\n\r\n            id = id || _currentInstance.getId(el);\r\n\r\n            var b = document.body,\r\n                p = el.parentNode;\r\n\r\n            _elementsWithEndpoints[id] = _elementsWithEndpoints[id] ? _elementsWithEndpoints[id] + 1 : 1;\r\n\r\n            while (p != null && p != b) {\r\n                var pid = _currentInstance.getId(p, null, true);\r\n                if (pid && _draggables[pid]) {\r\n                    var pLoc = _currentInstance.getOffset(p);\r\n\r\n                    if (_delements[pid][id] == null) {\r\n                        var cLoc = _currentInstance.getOffset(el);\r\n                        _delements[pid][id] = {\r\n                            id: id,\r\n                            offset: {\r\n                                left: cLoc.left - pLoc.left,\r\n                                top: cLoc.top - pLoc.top\r\n                            }\r\n                        };\r\n                        _draggablesForElements[id] = pid;\r\n                    }\r\n                    break;\r\n                }\r\n                p = p.parentNode;\r\n            }\r\n        };\r\n\r\n        this.endpointDeleted = function (endpoint) {\r\n            if (_elementsWithEndpoints[endpoint.elementId]) {\r\n                _elementsWithEndpoints[endpoint.elementId]--;\r\n                if (_elementsWithEndpoints[endpoint.elementId] <= 0) {\r\n                    for (var i in _delements) {\r\n                        if (_delements.hasOwnProperty(i) && _delements[i]) {\r\n                            delete _delements[i][endpoint.elementId];\r\n                            delete _draggablesForElements[endpoint.elementId];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        this.changeId = function (oldId, newId) {\r\n            _delements[newId] = _delements[oldId];\r\n            _delements[oldId] = {};\r\n            _draggablesForElements[newId] = _draggablesForElements[oldId];\r\n            _draggablesForElements[oldId] = null;\r\n        };\r\n\r\n        this.getElementsForDraggable = function (id) {\r\n            return _delements[id];\r\n        };\r\n\r\n        this.elementRemoved = function (elementId) {\r\n            var elId = _draggablesForElements[elementId];\r\n            if (elId) {\r\n                delete _delements[elId][elementId];\r\n                delete _draggablesForElements[elementId];\r\n            }\r\n        };\r\n\r\n        this.reset = function () {\r\n            _draggables = {};\r\n            _dlist = [];\r\n            _delements = {};\r\n            _elementsWithEndpoints = {};\r\n        };\r\n\r\n        //\r\n        // notification drag ended. We check automatically if need to update some\r\n        // ancestor's offsets.\r\n        //\r\n        this.dragEnded = function (el) {\r\n            var id = _currentInstance.getId(el),\r\n                ancestor = _draggablesForElements[id];\r\n\r\n            if (ancestor) this.updateOffsets(ancestor);\r\n        };\r\n\r\n        this.setParent = function (el, elId, p, pId) {\r\n            var current = _draggablesForElements[elId];\r\n            if (current) {\r\n                if (!_delements[pId])\r\n                    _delements[pId] = {};\r\n                _delements[pId][elId] = _delements[current][elId];\r\n                delete _delements[current][elId];\r\n                var pLoc = _currentInstance.getOffset(p),\r\n                    cLoc = _currentInstance.getOffset(el);\r\n                _delements[pId][elId].offset = {\r\n                    left: cLoc.left - pLoc.left,\r\n                    top: cLoc.top - pLoc.top\r\n                };\r\n                _draggablesForElements[elId] = pId;\r\n            }\r\n        };\r\n\r\n        this.getDragAncestor = function (el) {\r\n            var de = jsPlumb.getElement(el),\r\n                id = _currentInstance.getId(de),\r\n                aid = _draggablesForElements[id];\r\n\r\n            if (aid)\r\n                return jsPlumb.getElement(aid);\r\n            else\r\n                return null;\r\n        };\r\n\r\n    };\r\n\r\n    var trim = function (str) {\r\n            return str == null ? null : (str.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, ''));\r\n        },\r\n        _setClassName = function (el, cn) {\r\n            cn = trim(cn);\r\n            if (typeof el.className.baseVal != \"undefined\")  // SVG\r\n                el.className.baseVal = cn;\r\n            else\r\n                el.className = cn;\r\n        },\r\n        _getClassName = function (el) {\r\n            return (typeof el.className.baseVal == \"undefined\") ? el.className : el.className.baseVal;\r\n        },\r\n        _classManip = function (el, classesToAdd, classesToRemove) {\r\n            classesToAdd = classesToAdd == null ? [] : jsPlumbUtil.isArray(classesToAdd) ? classesToAdd : classesToAdd.split(/\\s+/);\r\n            classesToRemove = classesToRemove == null ? [] : jsPlumbUtil.isArray(classesToRemove) ? classesToRemove : classesToRemove.split(/\\s+/);\r\n\r\n            var className = _getClassName(el),\r\n                curClasses = className.split(/\\s+/);\r\n\r\n            var _oneSet = function (add, classes) {\r\n                for (var i = 0; i < classes.length; i++) {\r\n                    if (add) {\r\n                        if (jsPlumbUtil.indexOf(curClasses, classes[i]) == -1)\r\n                            curClasses.push(classes[i]);\r\n                    }\r\n                    else {\r\n                        var idx = jsPlumbUtil.indexOf(curClasses, classes[i]);\r\n                        if (idx != -1)\r\n                            curClasses.splice(idx, 1);\r\n                    }\r\n                }\r\n            };\r\n\r\n            _oneSet(true, classesToAdd);\r\n            _oneSet(false, classesToRemove);\r\n\r\n            _setClassName(el, curClasses.join(\" \"));\r\n        };\r\n\r\n    jsPlumb.extend(jsPlumbInstance.prototype, {\r\n\r\n        headless: false,\r\n\r\n        pageLocation: _pageLocation,\r\n        screenLocation: _screenLocation,\r\n        clientLocation: _clientLocation,\r\n\r\n        getDragManager:function() {\r\n            if (this.dragManager == null)\r\n                this.dragManager = new DragManager(this);\r\n\r\n            return this.dragManager;\r\n        },\r\n\r\n        recalculateOffsets:function(elId) {\r\n            this.getDragManager().updateOffsets(elId);\r\n        },\r\n\r\n        createElement:function(tag, style, clazz, atts) {\r\n            return this.createElementNS(null, tag, style, clazz, atts);\r\n        },\r\n\r\n        createElementNS:function(ns, tag, style, clazz, atts) {\r\n            var e = ns == null ? document.createElement(tag) : document.createElementNS(ns, tag);\r\n            var i;\r\n            style = style || {};\r\n            for (i in style)\r\n                e.style[i] = style[i];\r\n\r\n            if (clazz)\r\n                e.className = clazz;\r\n\r\n            atts = atts || {};\r\n            for (i in atts)\r\n                e.setAttribute(i, \"\" + atts[i]);\r\n\r\n            return e;\r\n        },\r\n\r\n        getAttribute: function (el, attName) {\r\n            return el.getAttribute != null ? el.getAttribute(attName) : null;\r\n        },\r\n\r\n        setAttribute: function (el, a, v) {\r\n            if (el.setAttribute != null) el.setAttribute(a, v);\r\n        },\r\n\r\n        setAttributes: function (el, atts) {\r\n            for (var i in atts)\r\n                if (atts.hasOwnProperty(i)) el.setAttribute(i, atts[i]);\r\n        },\r\n\r\n        appendToRoot: function (node) {\r\n            document.body.appendChild(node);\r\n        },\r\n        getRenderModes: function () {\r\n            return [ \"svg\", \"vml\" ];\r\n        },\r\n        isRenderModeAvailable: function (m) {\r\n            return {\r\n                \"svg\": svgAvailable,\r\n                \"vml\": vmlAvailable()\r\n            }[m];\r\n        },\r\n        trySetRenderMode: function (mode) {\r\n            var renderMode;\r\n\r\n            if (mode) {\r\n                mode = mode.toLowerCase();\r\n\r\n                var svgAvailable = this.isRenderModeAvailable(\"svg\"),\r\n                    vmlAvailable = this.isRenderModeAvailable(\"vml\");\r\n\r\n                // now test we actually have the capability to do this.\r\n                if (mode === \"svg\") {\r\n                    if (svgAvailable) renderMode = \"svg\";\r\n                    else if (vmlAvailable) renderMode = \"vml\";\r\n                }\r\n                else if (vmlAvailable) renderMode = \"vml\";\r\n            }\r\n\r\n            return renderMode;\r\n        },\r\n        addClass: function (el, clazz) {\r\n            jsPlumb.each(el, function (e) {\r\n                _classManip(e, clazz);\r\n            });\r\n        },\r\n        hasClass: function (el, clazz) {\r\n            el = jsPlumb.getElement(el);\r\n            if (el.classList) return el.classList.contains(clazz);\r\n            else {\r\n                return _getClassName(el).indexOf(clazz) != -1;\r\n            }\r\n        },\r\n        removeClass: function (el, clazz) {\r\n            jsPlumb.each(el, function (e) {\r\n                _classManip(e, null, clazz);\r\n            });\r\n        },\r\n        updateClasses: function (el, toAdd, toRemove) {\r\n            jsPlumb.each(el, function (e) {\r\n                _classManip(e, toAdd, toRemove);\r\n            });\r\n        },\r\n        setClass: function (el, clazz) {\r\n            jsPlumb.each(el, function (e) {\r\n                _setClassName(e, clazz);\r\n            });\r\n        },\r\n        setPosition: function (el, p) {\r\n            el.style.left = p.left + \"px\";\r\n            el.style.top = p.top + \"px\";\r\n        },\r\n        getPosition: function (el) {\r\n            var _one = function (prop) {\r\n                var v = el.style[prop];\r\n                return v ? v.substring(0, v.length - 2) : 0;\r\n            };\r\n            return {\r\n                left: _one(\"left\"),\r\n                top: _one(\"top\")\r\n            };\r\n        },\r\n        getStyle:function(el, prop) {\r\n            if (typeof window.getComputedStyle !== 'undefined') {\r\n                return getComputedStyle(el, null).getPropertyValue(prop);\r\n            } else {\r\n                return el.currentStyle[prop];\r\n            }\r\n        },\r\n\r\n        getSelector: function (ctx, spec) {\r\n            var sel = null;\r\n            if (arguments.length == 1) {\r\n                sel = ctx.nodeType != null ? ctx : document.querySelectorAll(ctx);\r\n            }\r\n            else\r\n                sel = ctx.querySelectorAll(spec);\r\n\r\n            return sel;\r\n        },\r\n        getOffset:function(el, relativeToRoot) {\r\n            el = jsPlumb.getElement(el);\r\n            var container = this.getContainer();\r\n            var out = {\r\n                    left: el.offsetLeft,\r\n                    top: el.offsetTop\r\n                },\r\n                op = (relativeToRoot  || (container != null && el.offsetParent != container)) ?  el.offsetParent : null,\r\n                _maybeAdjustScroll = function(offsetParent) {\r\n                    if (offsetParent != null && offsetParent !== document.body && (offsetParent.scrollTop > 0 || offsetParent.scrollLeft > 0)) {\r\n                        var p = this.getStyle(el, \"position\");\r\n                        //if (p !== \"fixed\") {\r\n                            out.left -= offsetParent.scrollLeft;\r\n                            out.top -= offsetParent.scrollTop;\r\n                        //}\r\n                    }\r\n                }.bind(this);\r\n\r\n            while (op != null) {\r\n                out.left += op.offsetLeft;\r\n                out.top += op.offsetTop;\r\n                //if (!relativeToRoot) _maybeAdjustScroll(op);\r\n                _maybeAdjustScroll(op);\r\n                op = relativeToRoot ? op.offsetParent :\r\n                        op.offsetParent == container ? null : op.offsetParent;\r\n            }\r\n\r\n            // if container is scrolled and the element (or its offset parent) is not absolute or fixed, adjust accordingly.\r\n            if (container != null && !relativeToRoot && (container.scrollTop > 0 || container.scrollLeft > 0)) {\r\n                var pp = el.offsetParent != null ? this.getStyle(el.offsetParent, \"position\") : \"static\",\r\n                    p = this.getStyle(el, \"position\");\r\n                if (p !== \"absolute\" && p !== \"fixed\" && pp !== \"absolute\" && pp != \"fixed\") {\r\n                    out.left -= container.scrollLeft;\r\n                    out.top -= container.scrollTop;\r\n                }\r\n            }\r\n            return out;\r\n        },\r\n        //\r\n        // return x+y proportion of the given element's size corresponding to the location of the given event.\r\n        //\r\n        getPositionOnElement: function (evt, el, zoom) {\r\n            var box = typeof el.getBoundingClientRect !== \"undefined\" ? el.getBoundingClientRect() : { left: 0, top: 0, width: 0, height: 0 },\r\n                body = document.body,\r\n                docElem = document.documentElement,\r\n                scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\r\n                scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\r\n                clientTop = docElem.clientTop || body.clientTop || 0,\r\n                clientLeft = docElem.clientLeft || body.clientLeft || 0,\r\n                pst = 0,\r\n                psl = 0,\r\n                top = box.top + scrollTop - clientTop + (pst * zoom),\r\n                left = box.left + scrollLeft - clientLeft + (psl * zoom),\r\n                cl = jsPlumb.pageLocation(evt),\r\n                w = box.width || (el.offsetWidth * zoom),\r\n                h = box.height || (el.offsetHeight * zoom),\r\n                x = (cl[0] - left) / w,\r\n                y = (cl[1] - top) / h;\r\n\r\n            return [ x, y ];\r\n        },\r\n\r\n        /**\r\n         * Gets the absolute position of some element as read from the left/top properties in its style.\r\n         * @method getAbsolutePosition\r\n         * @param {Element} el The element to retrieve the absolute coordinates from. **Note** this is a DOM element, not a selector from the underlying library.\r\n         * @return {Number[]} [left, top] pixel values.\r\n         */\r\n        getAbsolutePosition: function (el) {\r\n            var _one = function (s) {\r\n                var ss = el.style[s];\r\n                if (ss) return parseFloat(ss.substring(0, ss.length - 2));\r\n            };\r\n            return [ _one(\"left\"), _one(\"top\") ];\r\n        },\r\n\r\n        /**\r\n         * Sets the absolute position of some element by setting the left/top properties in its style.\r\n         * @method setAbsolutePosition\r\n         * @param {Element} el The element to set the absolute coordinates on. **Note** this is a DOM element, not a selector from the underlying library.\r\n         * @param {Number[]} xy x and y coordinates\r\n         * @param {Number[]} [animateFrom] Optional previous xy to animate from.\r\n         * @param {Object} [animateOptions] Options for the animation.\r\n         */\r\n        setAbsolutePosition: function (el, xy, animateFrom, animateOptions) {\r\n            if (animateFrom) {\r\n                this.animate(el, {\r\n                    left: \"+=\" + (xy[0] - animateFrom[0]),\r\n                    top: \"+=\" + (xy[1] - animateFrom[1])\r\n                }, animateOptions);\r\n            }\r\n            else {\r\n                el.style.left = xy[0] + \"px\";\r\n                el.style.top = xy[1] + \"px\";\r\n            }\r\n        },\r\n        /**\r\n         * gets the size for the element, in an array : [ width, height ].\r\n         */\r\n        getSize: function (el) {\r\n            return [ el.offsetWidth, el.offsetHeight ];\r\n        },\r\n        getWidth: function (el) {\r\n            return el.offsetWidth;\r\n        },\r\n        getHeight: function (el) {\r\n            return el.offsetHeight;\r\n        }\r\n\r\n    });\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n *\r\n * Title:jsPlumb 1.7.6\r\n *\r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.\r\n *\r\n * This file contains code for components that support overlays.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;(function() {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    // ------------------------------ BEGIN OverlayCapablejsPlumbUIComponent --------------------------------------------\r\n\r\n    var _internalLabelOverlayId = \"__label\",\r\n    // this is a shortcut helper method to let people add a label as\r\n    // overlay.\r\n        _makeLabelOverlay = function (component, params) {\r\n\r\n            var _params = {\r\n                    cssClass: params.cssClass,\r\n                    labelStyle: component.labelStyle,\r\n                    id: _internalLabelOverlayId,\r\n                    component: component,\r\n                    _jsPlumb: component._jsPlumb.instance  // TODO not necessary, since the instance can be accessed through the component.\r\n                },\r\n                mergedParams = jsPlumb.extend(_params, params);\r\n\r\n            return new _jp.Overlays[component._jsPlumb.instance.getRenderMode()].Label(mergedParams);\r\n        },\r\n        _processOverlay = function (component, o) {\r\n            var _newOverlay = null;\r\n            if (_ju.isArray(o)) {\t// this is for the shorthand [\"Arrow\", { width:50 }] syntax\r\n                // there's also a three arg version:\r\n                // [\"Arrow\", { width:50 }, {location:0.7}]\r\n                // which merges the 3rd arg into the 2nd.\r\n                var type = o[0],\r\n                // make a copy of the object so as not to mess up anyone else's reference...\r\n                    p = _jp.extend({component: component, _jsPlumb: component._jsPlumb.instance}, o[1]);\r\n                if (o.length == 3) _jp.extend(p, o[2]);\r\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][type](p);\r\n            } else if (o.constructor == String) {\r\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][o]({component: component, _jsPlumb: component._jsPlumb.instance});\r\n            } else {\r\n                _newOverlay = o;\r\n            }\r\n\r\n            _newOverlay.id = _newOverlay.id || _ju.uuid();\r\n            component.cacheTypeItem(\"overlay\", _newOverlay, _newOverlay.id);\r\n            //component._jsPlumb.overlays.push(_newOverlay);\r\n            component._jsPlumb.overlays[_newOverlay.id] = _newOverlay;\r\n\r\n            return _newOverlay;\r\n        };\r\n\r\n    _jp.OverlayCapableJsPlumbUIComponent = function (params) {\r\n\r\n        jsPlumbUIComponent.apply(this, arguments);\r\n        this._jsPlumb.overlays = {};\r\n        this._jsPlumb.overlayPositions = {};\r\n\r\n        if (params.label) {\r\n            this.getDefaultType().overlays[_internalLabelOverlayId] = [\"Label\", {\r\n                label: params.label,\r\n                location: params.labelLocation || this.defaultLabelLocation || 0.5,\r\n                labelStyle: params.labelStyle || this._jsPlumb.instance.Defaults.LabelStyle,\r\n                id:_internalLabelOverlayId\r\n            }];\r\n        }\r\n\r\n        this.setListenerComponent = function (c) {\r\n            if (this._jsPlumb) {\r\n                for (var i in this._jsPlumb.overlays)\r\n                    this._jsPlumb.overlays[i].setListenerComponent(c);\r\n            }\r\n        };\r\n    };\r\n\r\n    _jp.OverlayCapableJsPlumbUIComponent.applyType = function (component, t) {\r\n        if (t.overlays) {\r\n            // loop through the ones in the type. if already present on the component,\r\n            // dont remove or re-add.\r\n            var keep = {}, i;\r\n\r\n            for (i in t.overlays) {\r\n\r\n                var existing = component._jsPlumb.overlays[t.overlays[i][1].id];\r\n                if (existing) {\r\n                    // maybe update from data, if there were parameterised values for instance.\r\n                    existing.updateFrom(t.overlays[i][1]);\r\n                    keep[t.overlays[i][1].id] = true;\r\n                }\r\n                else {\r\n                    var c = component.getCachedTypeItem(\"overlay\", t.overlays[i][1].id);\r\n                    if (c != null) {\r\n                        c.reattach(component._jsPlumb.instance);\r\n                        // maybe update from data, if there were parameterised values for instance.\r\n                        c.updateFrom(t.overlays[i][1]);\r\n                        component._jsPlumb.overlays[c.id] = c;\r\n                    }\r\n                    else {\r\n                        c = component.addOverlay(t.overlays[i], true);\r\n                    }\r\n                    keep[c.id] = true;\r\n                }\r\n            }\r\n\r\n            // now loop through the full overlays and remove those that we dont want to keep\r\n            for (i in component._jsPlumb.overlays) {\r\n                if (keep[component._jsPlumb.overlays[i].id] == null)\r\n                    component.removeOverlay(component._jsPlumb.overlays[i].id);\r\n            }\r\n        }\r\n    };\r\n\r\n    _ju.extend(_jp.OverlayCapableJsPlumbUIComponent, jsPlumbUIComponent, {\r\n\r\n        setHover: function (hover, ignoreAttachedElements) {\r\n            if (this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\r\n                for (var i in this._jsPlumb.overlays) {\r\n                    this._jsPlumb.overlays[i][hover ? \"addClass\" : \"removeClass\"](this._jsPlumb.instance.hoverClass);\r\n                }\r\n            }\r\n        },\r\n        addOverlay: function (overlay, doNotRepaint) {\r\n            var o = _processOverlay(this, overlay);\r\n            if (!doNotRepaint) this.repaint();\r\n            return o;\r\n        },\r\n        getOverlay: function (id) {\r\n            return this._jsPlumb.overlays[id];\r\n        },\r\n        getOverlays: function () {\r\n            return this._jsPlumb.overlays;\r\n        },\r\n        hideOverlay: function (id) {\r\n            var o = this.getOverlay(id);\r\n            if (o) o.hide();\r\n        },\r\n        hideOverlays: function () {\r\n            for (var i in this._jsPlumb.overlays)\r\n                this._jsPlumb.overlays[i].hide();\r\n        },\r\n        showOverlay: function (id) {\r\n            var o = this.getOverlay(id);\r\n            if (o) o.show();\r\n        },\r\n        showOverlays: function () {\r\n            for (var i in this._jsPlumb.overlays)\r\n                this._jsPlumb.overlays[i].show();\r\n        },\r\n        removeAllOverlays: function (doNotRepaint) {\r\n            for (var i in this._jsPlumb.overlays) {\r\n                if (this._jsPlumb.overlays[i].cleanup) this._jsPlumb.overlays[i].cleanup();\r\n            }\r\n\r\n            this._jsPlumb.overlays = {};\r\n            this._jsPlumb.overlayPositions = null;\r\n            if (!doNotRepaint)\r\n                this.repaint();\r\n        },\r\n        removeOverlay: function (overlayId) {\r\n            var o = this._jsPlumb.overlays[overlayId];\r\n            if (o) {\r\n                if (o.cleanup) o.cleanup();\r\n                delete this._jsPlumb.overlays[overlayId];\r\n                if (this._jsPlumb.overlayPositions)\r\n                    delete this._jsPlumb.overlayPositions[overlayId];\r\n            }\r\n        },\r\n        removeOverlays: function () {\r\n            for (var i = 0, j = arguments.length; i < j; i++)\r\n                this.removeOverlay(arguments[i]);\r\n        },\r\n        moveParent: function (newParent) {\r\n            if (this.bgCanvas) {\r\n                this.bgCanvas.parentNode.removeChild(this.bgCanvas);\r\n                newParent.appendChild(this.bgCanvas);\r\n            }\r\n\r\n            this.canvas.parentNode.removeChild(this.canvas);\r\n            newParent.appendChild(this.canvas);\r\n\r\n            for (var i in this._jsPlumb.overlays) {\r\n                if (this._jsPlumb.overlays[i].isAppendedAtTopLevel) {\r\n                    var el = this._jsPlumb.overlays[i].getElement();\r\n                    el.parentNode.removeChild(el);\r\n                    newParent.appendChild(el);\r\n                }\r\n            }\r\n        },\r\n        getLabel: function () {\r\n            var lo = this.getOverlay(_internalLabelOverlayId);\r\n            return lo != null ? lo.getLabel() : null;\r\n        },\r\n        getLabelOverlay: function () {\r\n            return this.getOverlay(_internalLabelOverlayId);\r\n        },\r\n        setLabel: function (l) {\r\n            var lo = this.getOverlay(_internalLabelOverlayId);\r\n            if (!lo) {\r\n                var params = l.constructor == String || l.constructor == Function ? { label: l } : l;\r\n                lo = _makeLabelOverlay(this, params);\r\n                this._jsPlumb.overlays[_internalLabelOverlayId] = lo;\r\n            }\r\n            else {\r\n                if (l.constructor == String || l.constructor == Function) lo.setLabel(l);\r\n                else {\r\n                    if (l.label) lo.setLabel(l.label);\r\n                    if (l.location) lo.setLocation(l.location);\r\n                }\r\n            }\r\n\r\n            if (!this._jsPlumb.instance.isSuspendDrawing())\r\n                this.repaint();\r\n        },\r\n        cleanup: function (force) {\r\n            for (var i in this._jsPlumb.overlays) {\r\n                this._jsPlumb.overlays[i].cleanup(force);\r\n                this._jsPlumb.overlays[i].destroy(force);\r\n            }\r\n            if (force) {\r\n                this._jsPlumb.overlays = {};\r\n                this._jsPlumb.overlayPositions = null;\r\n            }\r\n        },\r\n        setVisible: function (v) {\r\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\r\n        },\r\n        setAbsoluteOverlayPosition: function (overlay, xy) {\r\n            this._jsPlumb.overlayPositions[overlay.id] = xy;\r\n        },\r\n        getAbsoluteOverlayPosition: function (overlay) {\r\n            return this._jsPlumb.overlayPositions ? this._jsPlumb.overlayPositions[overlay.id] : null;\r\n        }\r\n    });\r\n\r\n// ------------------------------ END OverlayCapablejsPlumbUIComponent --------------------------------------------\r\n\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the code for Endpoints.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    // create the drag handler for a connection\r\n    var _makeConnectionDragHandler = function (placeholder, _jsPlumb) {\r\n        var stopped = false;\r\n        return {\r\n            drag: function () {\r\n                if (stopped) {\r\n                    stopped = false;\r\n                    return true;\r\n                }\r\n                var _ui = _jp.getUIPosition(arguments, _jsPlumb.getZoom());\r\n\r\n                if (placeholder.element) {\r\n                    jsPlumb.setPosition(placeholder.element, _ui);\r\n                    _jsPlumb.repaint(placeholder.element, _ui);\r\n                }\r\n            },\r\n            stopDrag: function () {\r\n                stopped = true;\r\n            }\r\n        };\r\n    };\r\n\r\n    // creates a placeholder div for dragging purposes, adds it, and pre-computes its offset.\r\n    var _makeDraggablePlaceholder = function (placeholder, _jsPlumb) {\r\n        var n = jsPlumb.createElement(\"div\", { position : \"absolute\" });\r\n        _jsPlumb.appendElement(n);\r\n        var id = _jsPlumb.getId(n);\r\n        _jsPlumb.manage(id, n);\r\n        // create and assign an id, and initialize the offset.\r\n        placeholder.id = id;\r\n        placeholder.element = n;\r\n    };\r\n\r\n    // create a floating endpoint (for drag connections)\r\n    var _makeFloatingEndpoint = function (paintStyle, referenceAnchor, endpoint, referenceCanvas, sourceElement, _jsPlumb, _newEndpoint, scope) {\r\n        var floatingAnchor = new _jp.FloatingAnchor({ reference: referenceAnchor, referenceCanvas: referenceCanvas, jsPlumbInstance: _jsPlumb });\r\n        //setting the scope here should not be the way to fix that mootools issue.  it should be fixed by not\r\n        // adding the floating endpoint as a droppable.  that makes more sense anyway!\r\n        return _newEndpoint({ paintStyle: paintStyle, endpoint: endpoint, anchor: floatingAnchor, source: sourceElement, scope: scope });\r\n    };\r\n\r\n    var typeParameters = [ \"connectorStyle\", \"connectorHoverStyle\", \"connectorOverlays\",\r\n        \"connector\", \"connectionType\", \"connectorClass\", \"connectorHoverClass\" ];\r\n\r\n    // a helper function that tries to find a connection to the given element, and returns it if so. if elementWithPrecedence is null,\r\n    // or no connection to it is found, we return the first connection in our list.\r\n    var findConnectionToUseForDynamicAnchor = function (ep, elementWithPrecedence) {\r\n        var idx = 0;\r\n        if (elementWithPrecedence != null) {\r\n            for (var i = 0; i < ep.connections.length; i++) {\r\n                if (ep.connections[i].sourceId == elementWithPrecedence || ep.connections[i].targetId == elementWithPrecedence) {\r\n                    idx = i;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return ep.connections[idx];\r\n    };\r\n\r\n    var findConnectionIndex = function (conn, ep) {\r\n        return _ju.findWithFunction(ep.connections, function (c) {\r\n            return c.id == conn.id;\r\n        });\r\n    };\r\n\r\n    _jp.Endpoint = function (params) {\r\n        var _jsPlumb = params._jsPlumb,\r\n            _newConnection = params.newConnection,\r\n            _newEndpoint = params.newEndpoint;\r\n\r\n        this.idPrefix = \"_jsplumb_e_\";\r\n        this.defaultLabelLocation = [ 0.5, 0.5 ];\r\n        this.defaultOverlayKeys = [\"Overlays\", \"EndpointOverlays\"];\r\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\r\n\r\n// TYPE\r\n\r\n        this.appendToDefaultType({\r\n            connectionType:params.connectionType,\r\n            maxConnections: params.maxConnections == null ? this._jsPlumb.instance.Defaults.MaxConnections : params.maxConnections, // maximum number of connections this endpoint can be the source of.,\r\n            paintStyle: params.endpointStyle || params.paintStyle || params.style || this._jsPlumb.instance.Defaults.EndpointStyle || _jp.Defaults.EndpointStyle,\r\n            hoverPaintStyle: params.endpointHoverStyle || params.hoverPaintStyle || this._jsPlumb.instance.Defaults.EndpointHoverStyle || _jp.Defaults.EndpointHoverStyle,\r\n            connectorStyle: params.connectorStyle,\r\n            connectorHoverStyle: params.connectorHoverStyle,\r\n            connectorClass: params.connectorClass,\r\n            connectorHoverClass: params.connectorHoverClass,\r\n            connectorOverlays: params.connectorOverlays,\r\n            connector: params.connector,\r\n            connectorTooltip: params.connectorTooltip\r\n        });\r\n\r\n// END TYPE\r\n\r\n        this._jsPlumb.enabled = !(params.enabled === false);\r\n        this._jsPlumb.visible = true;\r\n        this.element = _jp.getElement(params.source);\r\n        this._jsPlumb.uuid = params.uuid;\r\n        this._jsPlumb.floatingEndpoint = null;\r\n        var inPlaceCopy = null;\r\n        if (this._jsPlumb.uuid) params.endpointsByUUID[this._jsPlumb.uuid] = this;\r\n        this.elementId = params.elementId;\r\n\r\n        this._jsPlumb.connectionCost = params.connectionCost;\r\n        this._jsPlumb.connectionsDirected = params.connectionsDirected;\r\n        this._jsPlumb.currentAnchorClass = \"\";\r\n        this._jsPlumb.events = {};\r\n\r\n        var _updateAnchorClass = function () {\r\n            // stash old, get new\r\n            var oldAnchorClass = _jsPlumb.endpointAnchorClassPrefix + \"_\" + this._jsPlumb.currentAnchorClass;\r\n            this._jsPlumb.currentAnchorClass = this.anchor.getCssClass();\r\n            var anchorClass = _jsPlumb.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"_\" + this._jsPlumb.currentAnchorClass : \"\");\r\n\r\n            this.removeClass(oldAnchorClass);\r\n            this.addClass(anchorClass);\r\n            // add and remove at the same time to reduce the number of reflows.\r\n            jsPlumb.updateClasses(this.element, anchorClass, oldAnchorClass);\r\n        }.bind(this);\r\n\r\n        this.prepareAnchor = function(anchorParams) {\r\n            var a = this._jsPlumb.instance.makeAnchor(anchorParams, this.elementId, _jsPlumb);\r\n            a.bind(\"anchorChanged\", function (currentAnchor) {\r\n                this.fire(\"anchorChanged\", {endpoint: this, anchor: currentAnchor});\r\n                _updateAnchorClass();\r\n            }.bind(this));\r\n            return a;\r\n        };\r\n\r\n        this.setPreparedAnchor = function(anchor, doNotRepaint) {\r\n            this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);\r\n            this.anchor = anchor;\r\n            _updateAnchorClass();\r\n\r\n            if (!doNotRepaint)\r\n                this._jsPlumb.instance.repaint(this.elementId);\r\n\r\n            return this;\r\n        };\r\n\r\n        this.setAnchor = function (anchorParams, doNotRepaint) {\r\n            var a = this.prepareAnchor(anchorParams);\r\n            this.setPreparedAnchor(a, doNotRepaint);\r\n            return this;\r\n        };\r\n\r\n        var internalHover = function (state) {\r\n            if (this.connections.length > 0) {\r\n                for (var i = 0; i < this.connections.length; i++)\r\n                    this.connections[i].setHover(state, false);\r\n            }\r\n            else\r\n                this.setHover(state);\r\n        }.bind(this);\r\n\r\n        this.bind(\"mouseover\", function () {\r\n            internalHover(true);\r\n        });\r\n        this.bind(\"mouseout\", function () {\r\n            internalHover(false);\r\n        });\r\n\r\n        // ANCHOR MANAGER\r\n        if (!params._transient) // in place copies, for example, are transient.  they will never need to be retrieved during a paint cycle, because they dont move, and then they are deleted.\r\n            this._jsPlumb.instance.anchorManager.add(this, this.elementId);\r\n\r\n        this.prepareEndpoint = function(ep, typeId) {\r\n            var _e = function (t, p) {\r\n                var rm = _jsPlumb.getRenderMode();\r\n                if (_jp.Endpoints[rm][t]) return new _jp.Endpoints[rm][t](p);\r\n                if (!_jsPlumb.Defaults.DoNotThrowErrors)\r\n                    throw { msg: \"jsPlumb: unknown endpoint type '\" + t + \"'\" };\r\n            };\r\n\r\n            var endpointArgs = {\r\n                _jsPlumb: this._jsPlumb.instance,\r\n                cssClass: params.cssClass,\r\n                container: params.container,\r\n                tooltip: params.tooltip,\r\n                connectorTooltip: params.connectorTooltip,\r\n                endpoint: this\r\n            };\r\n\r\n            var endpoint;\r\n\r\n            if (_ju.isString(ep))\r\n                endpoint = _e(ep, endpointArgs);\r\n            else if (_ju.isArray(ep)) {\r\n                endpointArgs = _ju.merge(ep[1], endpointArgs);\r\n                endpoint = _e(ep[0], endpointArgs);\r\n            }\r\n            else {\r\n                endpoint = ep.clone();\r\n            }\r\n\r\n            // assign a clone function using a copy of endpointArgs. this is used when a drag starts: the endpoint that was dragged is cloned,\r\n            // and the clone is left in its place while the original one goes off on a magical journey.\r\n            // the copy is to get around a closure problem, in which endpointArgs ends up getting shared by\r\n            // the whole world.\r\n            //var argsForClone = jsPlumb.extend({}, endpointArgs);\r\n            endpoint.clone = function () {\r\n                // TODO this, and the code above, can be refactored to be more dry.\r\n                if (_ju.isString(ep))\r\n                    return _e(ep, endpointArgs);\r\n                else if (_ju.isArray(ep)) {\r\n                    endpointArgs = _ju.merge(ep[1], endpointArgs);\r\n                    return _e(ep[0], endpointArgs);\r\n                }\r\n            }.bind(this);\r\n\r\n            endpoint.typeId = typeId;\r\n            return endpoint;\r\n        };\r\n\r\n        this.setEndpoint = function(ep, doNotRepaint) {\r\n            var _ep = this.prepareEndpoint(ep);\r\n            this.setPreparedEndpoint(_ep, true);\r\n        };\r\n\r\n        this.setPreparedEndpoint = function (ep, doNotRepaint) {\r\n            if (this.endpoint != null) {\r\n                this.endpoint.cleanup();\r\n                this.endpoint.destroy();\r\n            }\r\n            this.endpoint = ep;\r\n            this.type = this.endpoint.type;\r\n            this.canvas = this.endpoint.canvas;\r\n        };\r\n\r\n        _jp.extend(this, params, typeParameters);\r\n\r\n        this.isSource = params.isSource || false;\r\n        this.isTemporarySource = params.isTemporarySource || false;\r\n        this.isTarget = params.isTarget || false;\r\n\r\n        this.connections = params.connections || [];\r\n        this.connectorPointerEvents = params[\"connector-pointer-events\"];\r\n\r\n        this.scope = params.scope || _jsPlumb.getDefaultScope();\r\n        this.timestamp = null;\r\n        this.reattachConnections = params.reattach || _jsPlumb.Defaults.ReattachConnections;\r\n        this.connectionsDetachable = _jsPlumb.Defaults.ConnectionsDetachable;\r\n        if (params.connectionsDetachable === false || params.detachable === false)\r\n            this.connectionsDetachable = false;\r\n        this.dragAllowedWhenFull = params.dragAllowedWhenFull !== false;\r\n\r\n        if (params.onMaxConnections)\r\n            this.bind(\"maxConnections\", params.onMaxConnections);\r\n\r\n        //\r\n        // add a connection. not part of public API.\r\n        //\r\n        this.addConnection = function (connection) {\r\n            this.connections.push(connection);\r\n            this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\r\n            this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\r\n        };\r\n\r\n        this.detachFromConnection = function (connection, idx, doNotCleanup) {\r\n            idx = idx == null ? findConnectionIndex(connection, this) : idx;\r\n            if (idx >= 0) {\r\n                this.connections.splice(idx, 1);\r\n                this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\r\n                this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\r\n            }\r\n\r\n            if (!doNotCleanup && this._deleteOnDetach && this.connections.length === 0) {\r\n                _jsPlumb.deleteObject({\r\n                    endpoint: this,\r\n                    fireEvent: false,\r\n                    deleteAttachedObjects: false\r\n                });\r\n            }\r\n        };\r\n\r\n        this.detach = function (connection, ignoreTarget, forceDetach, fireEvent, originalEvent, endpointBeingDeleted, connectionIndex) {\r\n\r\n            var idx = connectionIndex == null ? findConnectionIndex(connection, this) : connectionIndex,\r\n                actuallyDetached = false;\r\n            fireEvent = (fireEvent !== false);\r\n\r\n            if (idx >= 0) {\r\n\r\n                if (forceDetach || connection._forceDetach || (connection.isDetachable() && connection.isDetachAllowed(connection) && this.isDetachAllowed(connection) && _jsPlumb.checkCondition(\"beforeDetach\", connection, endpointBeingDeleted) )) {\r\n\r\n                    _jsPlumb.deleteObject({\r\n                        connection: connection,\r\n                        fireEvent: (!ignoreTarget && fireEvent),\r\n                        originalEvent: originalEvent,\r\n                        deleteAttachedObjects: false/**/\r\n                    });\r\n                    actuallyDetached = true;\r\n                }\r\n            }\r\n            return actuallyDetached;\r\n        };\r\n\r\n        this.detachAll = function (fireEvent, forceDetach) {\r\n            var unaffectedConns = [];\r\n            while (this.connections.length > 0) {\r\n                // TODO this could pass the index in to the detach method to save some time (index will always be zero in this while loop)\r\n                var actuallyDetached = this.detach(this.connections[0], false, forceDetach === true, fireEvent !== false, null, this, 0);\r\n                if (!actuallyDetached) {\r\n                    unaffectedConns.push(this.connections[0]);\r\n                    this.connections.splice(0, 1);\r\n                }\r\n            }\r\n            this.connections = unaffectedConns;\r\n            return this;\r\n        };\r\n        this.detachFrom = function (targetEndpoint, fireEvent, originalEvent) {\r\n            var c = [];\r\n            for (var i = 0; i < this.connections.length; i++) {\r\n                if (this.connections[i].endpoints[1] == targetEndpoint || this.connections[i].endpoints[0] == targetEndpoint) {\r\n                    c.push(this.connections[i]);\r\n                }\r\n            }\r\n            for (var j = 0; j < c.length; j++) {\r\n                this.detach(c[j], false, true, fireEvent, originalEvent);\r\n            }\r\n            return this;\r\n        };\r\n\r\n        this.getElement = function () {\r\n            return this.element;\r\n        };\r\n\r\n        this.setElement = function (el) {\r\n            var parentId = this._jsPlumb.instance.getId(el),\r\n                curId = this.elementId;\r\n            // remove the endpoint from the list for the current endpoint's element\r\n            _ju.removeWithFunction(params.endpointsByElement[this.elementId], function (e) {\r\n                return e.id == this.id;\r\n            }.bind(this));\r\n            this.element = jsPlumb.getElement(el);\r\n            this.elementId = _jsPlumb.getId(this.element);\r\n            _jsPlumb.anchorManager.rehomeEndpoint(this, curId, this.element);\r\n            _jsPlumb.dragManager.endpointAdded(this.element);\r\n            _ju.addToList(params.endpointsByElement, parentId, this);\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * private but must be exposed.\r\n         */\r\n        this.makeInPlaceCopy = function () {\r\n            var loc = this.anchor.getCurrentLocation({element: this}),\r\n                o = this.anchor.getOrientation(this),\r\n                acc = this.anchor.getCssClass(),\r\n                inPlaceAnchor = {\r\n                    bind: function () {\r\n                    },\r\n                    compute: function () {\r\n                        return [ loc[0], loc[1] ];\r\n                    },\r\n                    getCurrentLocation: function () {\r\n                        return [ loc[0], loc[1] ];\r\n                    },\r\n                    getOrientation: function () {\r\n                        return o;\r\n                    },\r\n                    getCssClass: function () {\r\n                        return acc;\r\n                    }\r\n                };\r\n\r\n            return _newEndpoint({\r\n                dropOptions: params.dropOptions,\r\n                anchor: inPlaceAnchor,\r\n                source: this.element,\r\n                paintStyle: this.getPaintStyle(),\r\n                endpoint: params.hideOnDrag ? \"Blank\" : this.endpoint,\r\n                _transient: true,\r\n                scope: this.scope,\r\n                reference:this\r\n            });\r\n        };\r\n\r\n        /**\r\n         * returns a connection from the pool; used when dragging starts.  just gets the head of the array if it can.\r\n         */\r\n        this.connectorSelector = function () {\r\n            var candidate = this.connections[0];\r\n            // SP target source refactor\r\n            if (/*this.isTarget && */candidate) return candidate;\r\n            else {\r\n                return (this.connections.length < this._jsPlumb.maxConnections) || this._jsPlumb.maxConnections == -1 ? null : candidate;\r\n            }\r\n        };\r\n\r\n        this.setStyle = this.setPaintStyle;\r\n\r\n        this.paint = function (params) {\r\n            params = params || {};\r\n            var timestamp = params.timestamp, recalc = !(params.recalc === false);\r\n            if (!timestamp || this.timestamp !== timestamp) {\r\n\r\n                var info = _jsPlumb.updateOffset({ elId: this.elementId, timestamp: timestamp });\r\n\r\n                var xy = params.offset ? params.offset.o : info.o;\r\n                if (xy != null) {\r\n                    var ap = params.anchorPoint, connectorPaintStyle = params.connectorPaintStyle;\r\n                    if (ap == null) {\r\n                        var wh = params.dimensions || info.s,\r\n                            anchorParams = { xy: [ xy.left, xy.top ], wh: wh, element: this, timestamp: timestamp };\r\n                        if (recalc && this.anchor.isDynamic && this.connections.length > 0) {\r\n                            var c = findConnectionToUseForDynamicAnchor(this, params.elementWithPrecedence),\r\n                                oIdx = c.endpoints[0] == this ? 1 : 0,\r\n                                oId = oIdx === 0 ? c.sourceId : c.targetId,\r\n                                oInfo = _jsPlumb.getCachedData(oId),\r\n                                oOffset = oInfo.o, oWH = oInfo.s;\r\n                            anchorParams.txy = [ oOffset.left, oOffset.top ];\r\n                            anchorParams.twh = oWH;\r\n                            anchorParams.tElement = c.endpoints[oIdx];\r\n                        }\r\n                        ap = this.anchor.compute(anchorParams);\r\n                    }\r\n\r\n                    this.endpoint.compute(ap, this.anchor.getOrientation(this), this._jsPlumb.paintStyleInUse, connectorPaintStyle || this.paintStyleInUse);\r\n                    this.endpoint.paint(this._jsPlumb.paintStyleInUse, this.anchor);\r\n                    this.timestamp = timestamp;\r\n\r\n                    // paint overlays\r\n                    for (var i in this._jsPlumb.overlays) {\r\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\r\n                            var o = this._jsPlumb.overlays[i];\r\n                            if (o.isVisible()) {\r\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.endpoint, this._jsPlumb.paintStyleInUse);\r\n                                o.paint(this._jsPlumb.overlayPlacements[i]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        this.getTypeDescriptor = function () {\r\n            return \"endpoint\";\r\n        };\r\n        this.isVisible = function () {\r\n            return this._jsPlumb.visible;\r\n        };\r\n\r\n        this.repaint = this.paint;\r\n\r\n        var draggingInitialised = false;\r\n        this.initDraggable = function (definitionId) {\r\n\r\n            // is this a connection source? we make it draggable and have the\r\n            // drag listener maintain a connection with a floating endpoint.\r\n            if (!draggingInitialised && _jp.isDragSupported(this.element)) {\r\n                var placeholderInfo = { id: null, element: null },\r\n                    jpc = null,\r\n                    existingJpc = false,\r\n                    existingJpcParams = null,\r\n                    _dragHandler = _makeConnectionDragHandler(placeholderInfo, _jsPlumb),\r\n                    dragOptions = params.dragOptions || {},\r\n                    defaultOpts = {},\r\n                    startEvent = _jp.dragEvents.start,\r\n                    stopEvent = _jp.dragEvents.stop,\r\n                    dragEvent = _jp.dragEvents.drag;\r\n\r\n                var start = function () {\r\n                    // drag might have started on an endpoint that is not actually a source, but which has\r\n                    // one or more connections.\r\n                    jpc = this.connectorSelector();\r\n                    var _continue = true;\r\n                    // if not enabled, return\r\n                    if (!this.isEnabled()) _continue = false;\r\n                    // if no connection and we're not a source - or temporarily a source, as is the case with makeSource - return.\r\n                    if (jpc == null && !this.isSource && !this.isTemporarySource) _continue = false;\r\n                    // otherwise if we're full and not allowed to drag, also return false.\r\n                    if (this.isSource && this.isFull() && !(jpc != null && this.dragAllowedWhenFull)) _continue = false;\r\n                    // if the connection was setup as not detachable or one of its endpoints\r\n                    // was setup as connectionsDetachable = false, or Defaults.ConnectionsDetachable\r\n                    // is set to false...\r\n                    if (jpc != null && !jpc.isDetachable(this)) _continue = false;\r\n\r\n                    var beforeDrag = _jsPlumb.checkCondition(jpc == null ? \"beforeDrag\" : \"beforeStartDetach\", {\r\n                        endpoint:this,\r\n                        source:this.element,\r\n                        sourceId:this.elementId,\r\n                        connection:jpc\r\n                    });\r\n                    if (beforeDrag === false) _continue = false;\r\n                    // else we might have been given some data. we'll pass it in to a new connection as 'data'.\r\n\r\n                    if (_continue === false) {\r\n                        // this is for mootools and yui. returning false from this causes jquery to stop drag.\r\n                        // the events are wrapped in both mootools and yui anyway, but i don't think returning\r\n                        // false from the start callback would stop a drag.\r\n                        if (_jsPlumb.stopDrag) _jsPlumb.stopDrag(this.canvas);\r\n                        _dragHandler.stopDrag();\r\n                        return false;\r\n                    }\r\n\r\n                    // clear hover for all connections for this endpoint before continuing.\r\n                    for (var i = 0; i < this.connections.length; i++)\r\n                        this.connections[i].setHover(false);\r\n\r\n                    this.addClass(\"endpointDrag\");\r\n                    _jsPlumb.setConnectionBeingDragged(true);\r\n\r\n                    // if we're not full but there was a connection, make it null. we'll create a new one.\r\n                    if (jpc && !this.isFull() && this.isSource) jpc = null;\r\n\r\n                    _jsPlumb.updateOffset({ elId: this.elementId });\r\n                    inPlaceCopy = this.makeInPlaceCopy();\r\n                    inPlaceCopy.addClass(_jsPlumb.draggingClass);\r\n                    inPlaceCopy.referenceEndpoint = this;\r\n                    inPlaceCopy.paint();\r\n\r\n                    _makeDraggablePlaceholder(placeholderInfo, _jsPlumb);\r\n\r\n                    // set the offset of this div to be where 'inPlaceCopy' is, to start with.\r\n                    // TODO merge this code with the code in both Anchor and FloatingAnchor, because it\r\n                    // does the same stuff.\r\n                    var ipco = this._jsPlumb.instance.getOffset(inPlaceCopy.canvas),\r\n                        canvasElement = this.canvas;\r\n\r\n                    jsPlumb.setPosition(placeholderInfo.element, ipco);\r\n\r\n                    // when using makeSource and a parent, we first draw the source anchor on the source element, then\r\n                    // move it to the parent.  note that this happens after drawing the placeholder for the\r\n                    // first time.\r\n                    if (this.parentAnchor) this.anchor = _jsPlumb.makeAnchor(this.parentAnchor, this.elementId, _jsPlumb);\r\n\r\n                    // store the id of the dragging div and the source element. the drop function will pick these up.                   \r\n                    _jsPlumb.setAttributes(this.canvas, {\r\n                        \"dragId\": placeholderInfo.id,\r\n                        \"elId\": this.elementId\r\n                    });\r\n\r\n                    this._jsPlumb.floatingEndpoint = _makeFloatingEndpoint(this.getPaintStyle(), this.anchor, this.endpoint, this.canvas, placeholderInfo.element, _jsPlumb, _newEndpoint, this.scope);\r\n                    // TODO we should not know about DOM here. make the library adapter do this (or the \r\n                    // dom adapter)\r\n                    this.canvas.style.visibility = \"hidden\";\r\n\r\n                    if (jpc == null) {\r\n                        this.anchor.locked = true;\r\n                        this.setHover(false, false);\r\n                        // create a connection. one end is this endpoint, the other is a floating endpoint.                    \r\n                        jpc = _newConnection({\r\n                            sourceEndpoint: this,\r\n                            targetEndpoint: this._jsPlumb.floatingEndpoint,\r\n                            source: this.endpointWillMoveTo || this.element,  // for makeSource with parent option.  ensure source element is represented correctly.\r\n                            target: placeholderInfo.element,\r\n                            anchors: [ this.anchor, this._jsPlumb.floatingEndpoint.anchor ],\r\n                            paintStyle: params.connectorStyle, // this can be null. Connection will use the default.\r\n                            hoverPaintStyle: params.connectorHoverStyle,\r\n                            connector: params.connector, // this can also be null. Connection will use the default.\r\n                            overlays: params.connectorOverlays,\r\n                            type: this.connectionType,\r\n                            cssClass: this.connectorClass,\r\n                            hoverClass: this.connectorHoverClass,\r\n                            data:beforeDrag\r\n                        });\r\n                        //jpc.pending = true; // mark this connection as not having been established.\r\n                        jpc.addClass(_jsPlumb.draggingClass);\r\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\r\n                        // fire an event that informs that a connection is being dragged\r\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\r\n\r\n                    } else {\r\n                        existingJpc = true;\r\n                        jpc.setHover(false);\r\n                        // new anchor idx\r\n                        var anchorIdx = jpc.endpoints[0].id == this.id ? 0 : 1;\r\n                        this.detachFromConnection(jpc, null, true);                         // detach from the connection while dragging is occurring. but dont cleanup automatically.\r\n\r\n                        // store the original scope (issue 57)\r\n                        var dragScope = _jsPlumb.getDragScope(canvasElement);\r\n                        _jsPlumb.setAttribute(this.canvas, \"originalScope\", dragScope);\r\n                        // now we want to get this endpoint's DROP scope, and set it for now: we can only be dropped on drop zones\r\n                        // that have our drop scope (issue 57).\r\n                        var dropScope = _jsPlumb.getDropScope(canvasElement);\r\n                        _jsPlumb.setDragScope(canvasElement, dropScope);\r\n                        //*/\r\n\r\n                        // fire an event that informs that a connection is being dragged. we do this before\r\n                        // replacing the original target with the floating element info.\r\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\r\n\r\n                        // now we replace ourselves with the temporary div we created above:\r\n                        if (anchorIdx === 0) {\r\n                            existingJpcParams = [ jpc.source, jpc.sourceId, canvasElement, dragScope ];\r\n                            jpc.source = placeholderInfo.element;\r\n                            jpc.sourceId = placeholderInfo.id;\r\n                        } else {\r\n                            existingJpcParams = [ jpc.target, jpc.targetId, canvasElement, dragScope ];\r\n                            jpc.target = placeholderInfo.element;\r\n                            jpc.targetId = placeholderInfo.id;\r\n                        }\r\n\r\n                        // lock the other endpoint; if it is dynamic it will not move while the drag is occurring.\r\n                        jpc.endpoints[anchorIdx === 0 ? 1 : 0].anchor.locked = true;\r\n                        // store the original endpoint and assign the new floating endpoint for the drag.\r\n                        jpc.suspendedEndpoint = jpc.endpoints[anchorIdx];\r\n\r\n                        // PROVIDE THE SUSPENDED ELEMENT, BE IT A SOURCE OR TARGET (ISSUE 39)\r\n                        jpc.suspendedElement = jpc.endpoints[anchorIdx].getElement();\r\n                        jpc.suspendedElementId = jpc.endpoints[anchorIdx].elementId;\r\n                        jpc.suspendedElementType = anchorIdx === 0 ? \"source\" : \"target\";\r\n\r\n                        jpc.suspendedEndpoint.setHover(false);\r\n                        this._jsPlumb.floatingEndpoint.referenceEndpoint = jpc.suspendedEndpoint;\r\n                        jpc.endpoints[anchorIdx] = this._jsPlumb.floatingEndpoint;\r\n\r\n                        jpc.addClass(_jsPlumb.draggingClass);\r\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\r\n                    }\r\n\r\n                    // register it and register connection on it.\r\n                    _jsPlumb.floatingConnections[placeholderInfo.id] = jpc;\r\n                    _jsPlumb.anchorManager.addFloatingConnection(placeholderInfo.id, jpc);\r\n                    // only register for the target endpoint; we will not be dragging the source at any time\r\n                    // before this connection is either discarded or made into a permanent connection.\r\n                    _ju.addToList(params.endpointsByElement, placeholderInfo.id, this._jsPlumb.floatingEndpoint);\r\n                    // tell jsplumb about it\r\n                    _jsPlumb.currentlyDragging = true;\r\n                }.bind(this);\r\n\r\n                var stop = function () {\r\n                    _jsPlumb.setConnectionBeingDragged(false);\r\n                    // if no endpoints, jpc already cleaned up.\r\n                    if (jpc && jpc.endpoints != null) {\r\n                        // get the actual drop event (decode from library args to stop function)\r\n                        var originalEvent = _jsPlumb.getDropEvent(arguments);\r\n                        // unlock the other endpoint (if it is dynamic, it would have been locked at drag start)\r\n                        var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\r\n                        jpc.endpoints[idx === 0 ? 1 : 0].anchor.locked = false;\r\n                        // TODO: Dont want to know about css classes inside jsplumb, ideally.\r\n                        jpc.removeClass(_jsPlumb.draggingClass);\r\n\r\n                        // if we have the floating endpoint then the connection has not been dropped\r\n                        // on another endpoint.  If it is a new connection we throw it away. If it is an\r\n                        // existing connection we check to see if we should reattach it, throwing it away\r\n                        // if not.\r\n                        if (this._jsPlumb && (jpc.deleteConnectionNow || jpc.endpoints[idx] == this._jsPlumb.floatingEndpoint)) {\r\n                            // 6a. if the connection was an existing one...\r\n                            if (existingJpc && jpc.suspendedEndpoint) {\r\n                                // fix for issue35, thanks Sylvain Gizard: when firing the detach event make sure the\r\n                                // floating endpoint has been replaced.\r\n                                if (idx === 0) {\r\n                                    jpc.source = existingJpcParams[0];\r\n                                    jpc.sourceId = existingJpcParams[1];\r\n                                } else {\r\n                                    jpc.target = existingJpcParams[0];\r\n                                    jpc.targetId = existingJpcParams[1];\r\n                                }\r\n\r\n                                var fe = this._jsPlumb.floatingEndpoint; // store for later removal.\r\n                                // restore the original scope (issue 57)\r\n                                _jsPlumb.setDragScope(existingJpcParams[2], existingJpcParams[3]);\r\n                                jpc.endpoints[idx] = jpc.suspendedEndpoint;\r\n                                // IF the connection should be reattached, or the other endpoint refuses detach, then\r\n                                // reset the connection to its original state\r\n                                if (jpc.isReattach() || jpc._forceReattach || jpc._forceDetach || !jpc.endpoints[idx === 0 ? 1 : 0].detach(jpc, false, false, true, originalEvent, true)) {\r\n                                    jpc.setHover(false);\r\n                                    jpc._forceDetach = null;\r\n                                    jpc._forceReattach = null;\r\n                                    this._jsPlumb.floatingEndpoint.detachFromConnection(jpc);\r\n                                    jpc.suspendedEndpoint.addConnection(jpc);\r\n                                    _jsPlumb.repaint(existingJpcParams[1]);\r\n                                }\r\n                                else\r\n                                    _jsPlumb.deleteObject({endpoint: fe});\r\n                            }\r\n                        }\r\n\r\n                        // remove the element associated with the floating endpoint\r\n                        // (and its associated floating endpoint and visual artefacts)\r\n                        _jsPlumb.remove(placeholderInfo.element, false);\r\n                        // remove the inplace copy\r\n                        _jsPlumb.deleteObject({endpoint: inPlaceCopy});\r\n\r\n                        // makeTargets sets this flag, to tell us we have been replaced and should delete ourself.\r\n                        if (this.deleteAfterDragStop) {\r\n                            _jsPlumb.deleteObject({endpoint: this});\r\n                        }\r\n                        else {\r\n                            if (this._jsPlumb) {\r\n                                this._jsPlumb.floatingEndpoint = null;\r\n                                // repaint this endpoint.\r\n                                // make our canvas visible (TODO: hand off to library; we should not know about DOM)\r\n                                this.canvas.style.visibility = \"visible\";\r\n                                // unlock our anchor\r\n                                this.anchor.locked = false;\r\n                                this.paint({recalc: false});\r\n                            }\r\n                        }\r\n\r\n                        // although the connection is no longer valid, there are use cases where this is useful.\r\n                        _jsPlumb.fire(\"connectionDragStop\", jpc, originalEvent);\r\n                        // tell jsplumb that dragging is finished.\r\n                        _jsPlumb.currentlyDragging = false;\r\n                        jpc = null;\r\n                    }\r\n\r\n                }.bind(this);\r\n\r\n                dragOptions = _jp.extend(defaultOpts, dragOptions);\r\n                dragOptions.scope = this.scope || dragOptions.scope;\r\n                dragOptions[startEvent] = _ju.wrap(dragOptions[startEvent], start, false);\r\n                // extracted drag handler function so can be used by makeSource\r\n                dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], _dragHandler.drag);\r\n                dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], stop);\r\n                dragOptions.multipleDrop = false;\r\n                dragOptions.definitionId = definitionId;\r\n\r\n                dragOptions.canDrag = function () {\r\n                    return this.isSource || this.isTemporarySource || /*(this.isTarget && */this.connections.length > 0/*)*/;\r\n                }.bind(this);\r\n\r\n                _jsPlumb.initDraggable(this.canvas, dragOptions, \"internal\");\r\n\r\n                this.canvas._jsPlumbRelatedElement = this.element;\r\n\r\n                draggingInitialised = true;\r\n            }\r\n        };\r\n\r\n        var ep = params.endpoint || this._jsPlumb.instance.Defaults.Endpoint || _jp.Defaults.Endpoint;\r\n        this.setEndpoint(ep, true);\r\n        var anchorParamsToUse = params.anchor ? params.anchor : params.anchors ? params.anchors : (_jsPlumb.Defaults.Anchor || \"Top\");\r\n        this.setAnchor(anchorParamsToUse, true);\r\n\r\n        // finally, set type if it was provided\r\n        var type = [ \"default\", (params.type || \"\")].join(\" \");\r\n        this.addType(type, params.data, true);\r\n        this.canvas = this.endpoint.canvas;\r\n        this.canvas._jsPlumb = this;\r\n\r\n        // if marked as source or target at create time, init the dragging.\r\n        if (this.isSource || this.isTarget || this.isTemporarySource)\r\n            this.initDraggable(this.isTarget ? \"_jsPlumbTarget\" : \"_jsPlumbSource\");\r\n\r\n        // pulled this out into a function so we can reuse it for the inPlaceCopy canvas; you can now drop detached connections\r\n        // back onto the endpoint you detached it from.\r\n        var _initDropTarget = function (canvas, forceInit, isTransient, endpoint, referenceEndpoint) {\r\n\r\n            if ((this.isTarget || forceInit) && _jp.isDropSupported(this.element)) {\r\n                var dropOptions = params.dropOptions || _jsPlumb.Defaults.DropOptions || _jp.Defaults.DropOptions;\r\n                dropOptions = _jp.extend({}, dropOptions);\r\n                dropOptions.scope = dropOptions.scope || this.scope;\r\n                var dropEvent = _jp.dragEvents.drop,\r\n                    overEvent = _jp.dragEvents.over,\r\n                    outEvent = _jp.dragEvents.out,\r\n                    _ep = this,\r\n                    drop = _jsPlumb.EndpointDropHandler({\r\n                        getEndpoint: function () {\r\n                            return _ep;\r\n                        },\r\n                        jsPlumb: _jsPlumb,\r\n                        enabled: function () {\r\n                            return endpoint != null ? endpoint.isEnabled() : true;\r\n                        },\r\n                        isFull: function () {\r\n                            return endpoint.isFull();\r\n                        },\r\n                        element: this.element,\r\n                        elementId: this.elementId,\r\n                        isSource: this.isSource,\r\n                        isTarget: this.isTarget,\r\n                        addClass: function (clazz) {\r\n                            _ep.addClass(clazz);\r\n                        },\r\n                        removeClass: function (clazz) {\r\n                            _ep.removeClass(clazz);\r\n                        },\r\n                        isDropAllowed: function () {\r\n                            return _ep.isDropAllowed.apply(_ep, arguments);\r\n                        },\r\n                        reference:referenceEndpoint,\r\n                        isRedrop:function(jpc, dhParams) {\r\n                            return jpc.suspendedEndpoint && dhParams.reference && (jpc.suspendedEndpoint.id === dhParams.reference.id);\r\n                        }\r\n                    });\r\n\r\n                dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], drop, true);\r\n                dropOptions[overEvent] = _ju.wrap(dropOptions[overEvent], function () {\r\n                    var draggable = _jp.getDragObject(arguments),\r\n                        id = _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\r\n                        _jpc = _jsPlumb.floatingConnections[id];\r\n\r\n                    if (_jpc != null) {\r\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\r\n                        // here we should fire the 'over' event if we are a target and this is a new connection,\r\n                        // or we are the same as the floating endpoint.\r\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id == _jpc.suspendedEndpoint.id);\r\n                        if (_cont) {\r\n                            var bb = _jsPlumb.checkCondition(\"checkDropAllowed\", {\r\n                                sourceEndpoint: _jpc.endpoints[idx],\r\n                                targetEndpoint: this,\r\n                                connection: _jpc\r\n                            });\r\n                            this[(bb ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointDropAllowedClass);\r\n                            this[(bb ? \"remove\" : \"add\") + \"Class\"](_jsPlumb.endpointDropForbiddenClass);\r\n                            _jpc.endpoints[idx].anchor.over(this.anchor, this);\r\n                        }\r\n                    }\r\n                }.bind(this));\r\n\r\n                dropOptions[outEvent] = _ju.wrap(dropOptions[outEvent], function () {\r\n                    var draggable = _jp.getDragObject(arguments),\r\n                        id = draggable == null ? null : _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\r\n                        _jpc = id ? _jsPlumb.floatingConnections[id] : null;\r\n\r\n                    if (_jpc != null) {\r\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\r\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id == _jpc.suspendedEndpoint.id);\r\n                        if (_cont) {\r\n                            this.removeClass(_jsPlumb.endpointDropAllowedClass);\r\n                            this.removeClass(_jsPlumb.endpointDropForbiddenClass);\r\n                            _jpc.endpoints[idx].anchor.out();\r\n                        }\r\n                    }\r\n                }.bind(this));\r\n\r\n                _jsPlumb.initDroppable(canvas, dropOptions, \"internal\", isTransient);\r\n            }\r\n        }.bind(this);\r\n\r\n        // Initialise the endpoint's canvas as a drop target. The drop handler will take care of the logic of whether\r\n        // something can actually be dropped.\r\n        if (!this.anchor.isFloating)\r\n            _initDropTarget(this.canvas, true, !(params._transient || this.anchor.isFloating), this, params.reference);\r\n\r\n\r\n        return this;\r\n    };\r\n\r\n    _ju.extend(_jp.Endpoint, _jp.OverlayCapableJsPlumbUIComponent, {\r\n\r\n        setVisible: function (v, doNotChangeConnections, doNotNotifyOtherEndpoint) {\r\n            this._jsPlumb.visible = v;\r\n            if (this.canvas) this.canvas.style.display = v ? \"block\" : \"none\";\r\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\r\n            if (!doNotChangeConnections) {\r\n                for (var i = 0; i < this.connections.length; i++) {\r\n                    this.connections[i].setVisible(v);\r\n                    if (!doNotNotifyOtherEndpoint) {\r\n                        var oIdx = this === this.connections[i].endpoints[0] ? 1 : 0;\r\n                        // only change the other endpoint if this is its only connection.\r\n                        if (this.connections[i].endpoints[oIdx].connections.length == 1) this.connections[i].endpoints[oIdx].setVisible(v, true, true);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        getAttachedElements: function () {\r\n            return this.connections;\r\n        },\r\n        applyType: function (t, doNotRepaint) {\r\n            this.setPaintStyle(t.endpointStyle || t.paintStyle, doNotRepaint);\r\n            this.setHoverPaintStyle(t.endpointHoverStyle || t.hoverPaintStyle, doNotRepaint);\r\n            if (t.maxConnections != null) this._jsPlumb.maxConnections = t.maxConnections;\r\n            if (t.scope) this.scope = t.scope;\r\n            _jp.extend(this, t, typeParameters);\r\n            if (t.cssClass != null && this.canvas) this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\r\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\r\n        },\r\n        isEnabled: function () {\r\n            return this._jsPlumb.enabled;\r\n        },\r\n        setEnabled: function (e) {\r\n            this._jsPlumb.enabled = e;\r\n        },\r\n        cleanup: function () {\r\n            var anchorClass = this._jsPlumb.instance.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"_\" + this._jsPlumb.currentAnchorClass : \"\");\r\n            jsPlumb.removeClass(this.element, anchorClass);\r\n            this.anchor = null;\r\n            this.endpoint.cleanup();\r\n            this.endpoint.destroy();\r\n            this.endpoint = null;\r\n            // drag/drop\r\n            this._jsPlumb.instance.destroyDraggable(this.canvas, \"internal\");\r\n            this._jsPlumb.instance.destroyDroppable(this.canvas, \"internal\");\r\n        },\r\n        setHover: function (h) {\r\n            if (this.endpoint && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged())\r\n                this.endpoint.setHover(h);\r\n        },\r\n        isFull: function () {\r\n            return this._jsPlumb.maxConnections === 0 ? true : !(this.isFloating() || this._jsPlumb.maxConnections < 0 || this.connections.length < this._jsPlumb.maxConnections);\r\n        },\r\n        /**\r\n         * private but needs to be exposed.\r\n         */\r\n        isFloating: function () {\r\n            return this.anchor != null && this.anchor.isFloating;\r\n        },\r\n        isConnectedTo: function (endpoint) {\r\n            var found = false;\r\n            if (endpoint) {\r\n                for (var i = 0; i < this.connections.length; i++) {\r\n                    if (this.connections[i].endpoints[1] == endpoint || this.connections[i].endpoints[0] == endpoint) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return found;\r\n        },\r\n        getConnectionCost: function () {\r\n            return this._jsPlumb.connectionCost;\r\n        },\r\n        setConnectionCost: function (c) {\r\n            this._jsPlumb.connectionCost = c;\r\n        },\r\n        areConnectionsDirected: function () {\r\n            return this._jsPlumb.connectionsDirected;\r\n        },\r\n        setConnectionsDirected: function (b) {\r\n            this._jsPlumb.connectionsDirected = b;\r\n        },\r\n        setElementId: function (_elId) {\r\n            this.elementId = _elId;\r\n            this.anchor.elementId = _elId;\r\n        },\r\n        setReferenceElement: function (_el) {\r\n            this.element = _jp.getElement(_el);\r\n        },\r\n        setDragAllowedWhenFull: function (allowed) {\r\n            this.dragAllowedWhenFull = allowed;\r\n        },\r\n        equals: function (endpoint) {\r\n            return this.anchor.equals(endpoint.anchor);\r\n        },\r\n        getUuid: function () {\r\n            return this._jsPlumb.uuid;\r\n        },\r\n        computeAnchor: function (params) {\r\n            return this.anchor.compute(params);\r\n        }\r\n    });\r\n\r\n    root.jsPlumbInstance.prototype.EndpointDropHandler = function (dhParams) {\r\n        return function (e) {\r\n\r\n            var _jsPlumb = dhParams.jsPlumb;\r\n\r\n            // remove the classes that are added dynamically. drop is neither forbidden nor allowed now that\r\n            // the drop is finishing.\r\n            // makeTarget:probably keep these. 'this' would refer to the DOM element though\r\n            dhParams.removeClass(_jsPlumb.endpointDropAllowedClass);\r\n            dhParams.removeClass(_jsPlumb.endpointDropForbiddenClass);\r\n\r\n            var originalEvent = _jsPlumb.getDropEvent(arguments),\r\n                draggable = _jsPlumb.getDragObject(arguments),\r\n                id = _jsPlumb.getAttribute(draggable, \"dragId\"),\r\n                elId = _jsPlumb.getAttribute(draggable, \"elId\"),\r\n                scope = _jsPlumb.getAttribute(draggable, \"originalScope\"),\r\n                jpc = _jsPlumb.floatingConnections[id];\r\n\r\n            // if no active connection, bail.\r\n            if (jpc == null) return;\r\n\r\n            // if drag type matches drop type and this is not a new connection (meaning it has a suspendedEndpoint)\r\n            // then bail\r\n            if (e.drag && e.drop) {\r\n                if (e.drag.params.definitionId === e.drop.params.definitionId && jpc.suspendedEndpoint == null) return;\r\n            }\r\n\r\n            // if suspended endpoint has been cleaned up, bail.\r\n            if (jpc.suspendedEndpoint && jpc.suspendedEndpoint._jsPlumb == null) return;\r\n\r\n            // get the drop endpoint. for a normal connection this is just the one that would replace the currently\r\n            // floating endpoint. for a makeTarget this is a new endpoint that is created on drop.\r\n            var _ep = dhParams.getEndpoint(jpc);\r\n\r\n            // if this is a drop back where the connection came from, mark it force reattach and\r\n            // return; the stop handler will reattach. without firing an event.\r\n            //var redrop\r\n            //var redrop = jpc.suspendedEndpoint && dhParams.reference && (jpc.suspendedEndpoint.id === dhParams.reference.id);\r\n            //var redrop = jpc.suspendedEndpoint && (jpc.suspendedEndpoint.elementId === dhParams.elementId);\r\n            //if (redrop) {\r\n            if (dhParams.isRedrop(jpc, dhParams)) {\r\n                jpc._forceReattach = true;\r\n                jpc.setHover(false);\r\n                if (dhParams.maybeCleanup) dhParams.maybeCleanup(_ep);\r\n                return;\r\n            }\r\n\r\n            // ensure we dont bother trying to drop sources on non-source eps, and same for target.\r\n            var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\r\n            if (idx === 0 && !dhParams.isSource) return;\r\n            if (idx === 1 && !dhParams.isTarget) return;\r\n\r\n            if (dhParams.onDrop) dhParams.onDrop(jpc);\r\n\r\n            // restore the original scope if necessary (issue 57)\r\n            if (scope) _jsPlumb.setDragScope(draggable, scope);\r\n\r\n            // if the target of the drop is full, fire an event (we abort below)\r\n            // makeTarget: keep.\r\n            if (dhParams.isFull(e)) {\r\n                _ep.fire(\"maxConnections\", {\r\n                    endpoint: this,\r\n                    connection: jpc,\r\n                    maxConnections: _ep._jsPlumb.maxConnections\r\n                }, originalEvent);\r\n            }\r\n\r\n            //\r\n            // if endpoint enabled, not full, and matches the index of the floating endpoint...\r\n            if (!dhParams.isFull() && !(idx === 0 && !dhParams.isSource) && !(idx == 1 && !dhParams.isTarget) && dhParams.enabled()) {\r\n                var _doContinue = true;\r\n\r\n                // these have to be set before testing for beforeDrop.\r\n                if (idx === 0) {\r\n                    jpc.source = dhParams.element;\r\n                    jpc.sourceId = dhParams.elementId;\r\n                } else {\r\n                    jpc.target = dhParams.element;\r\n                    jpc.targetId = dhParams.elementId;\r\n                }\r\n\r\n                // if this is an existing connection and detach is not allowed we won't continue. The connection's\r\n                // endpoints have been reinstated; everything is back to how it was.\r\n                if (jpc.suspendedEndpoint && jpc.suspendedEndpoint._jsPlumb && jpc.suspendedEndpoint.id != _ep.id) {\r\n\r\n                    if (!jpc.isDetachAllowed(jpc) || !jpc.endpoints[idx].isDetachAllowed(jpc) || !jpc.suspendedEndpoint.isDetachAllowed(jpc) || !_jsPlumb.checkCondition(\"beforeDetach\", jpc))\r\n                        _doContinue = false;\r\n                }\r\n\r\n// ------------ wrap the execution path in a function so we can support asynchronous beforeDrop\r\n\r\n                var continueFunction = function (optionalData) {\r\n                    // remove this jpc from the current endpoint, which is a floating endpoint that we will\r\n                    // subsequently discard.\r\n                    jpc.endpoints[idx].detachFromConnection(jpc);\r\n\r\n                    // if there's a suspended endpoint, detach it from the connection.\r\n                    if (jpc.suspendedEndpoint) jpc.suspendedEndpoint.detachFromConnection(jpc);\r\n                    // TODO why?\r\n\r\n                    jpc.endpoints[idx] = _ep;\r\n                    _ep.addConnection(jpc);\r\n\r\n                    // copy our parameters in to the connection:\r\n                    var params = _ep.getParameters();\r\n                    for (var aParam in params)\r\n                        jpc.setParameter(aParam, params[aParam]);\r\n\r\n                    if (!jpc.suspendedEndpoint) {\r\n                        // if not an existing connection and\r\n                        if (params.draggable)\r\n                            _jsPlumb.initDraggable(this.element, dragOptions, \"internal\", _jsPlumb);\r\n                    }\r\n                    else {\r\n                        var suspendedElementId = jpc.suspendedEndpoint.elementId;\r\n                        _jsPlumb.fireMoveEvent({\r\n                            index: idx,\r\n                            originalSourceId: idx === 0 ? suspendedElementId : jpc.sourceId,\r\n                            newSourceId: idx === 0 ? _ep.elementId : jpc.sourceId,\r\n                            originalTargetId: idx == 1 ? suspendedElementId : jpc.targetId,\r\n                            newTargetId: idx == 1 ? _ep.elementId : jpc.targetId,\r\n                            originalSourceEndpoint: idx === 0 ? jpc.suspendedEndpoint : jpc.endpoints[0],\r\n                            newSourceEndpoint: idx === 0 ? _ep : jpc.endpoints[0],\r\n                            originalTargetEndpoint: idx == 1 ? jpc.suspendedEndpoint : jpc.endpoints[1],\r\n                            newTargetEndpoint: idx == 1 ? _ep : jpc.endpoints[1],\r\n                            connection: jpc\r\n                        }, originalEvent);\r\n                    }\r\n\r\n                    if (idx == 1)\r\n                        _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.suspendedElementId, jpc.targetId, jpc);\r\n                    else\r\n                        _jsPlumb.anchorManager.sourceChanged(jpc.suspendedEndpoint.elementId, jpc.sourceId, jpc);\r\n\r\n                    // when makeSource has uniqueEndpoint:true, we want to create connections with new endpoints\r\n                    // that are subsequently deleted. So makeSource sets `finalEndpoint`, which is the Endpoint to\r\n                    // which the connection should be attached. The `detachFromConnection` call below results in the\r\n                    // temporary endpoint being cleaned up.\r\n                    if (jpc.endpoints[0].finalEndpoint) {\r\n                        var _toDelete = jpc.endpoints[0];\r\n                        _toDelete.detachFromConnection(jpc);\r\n                        jpc.endpoints[0] = jpc.endpoints[0].finalEndpoint;\r\n                        jpc.endpoints[0].addConnection(jpc);\r\n                    }\r\n\r\n                    // if optionalData was given, merge it onto the connection's data.\r\n                    if (jsPlumbUtil.isObject(optionalData)) {\r\n                        jpc.mergeData(optionalData);\r\n                    }\r\n\r\n                    // finalise will inform the anchor manager and also add to\r\n                    // connectionsByScope if necessary.\r\n                    // TODO if this is not set to true, then dragging a connection's target to a new\r\n                    // target causes the connection to be forgotten. however if it IS set to true, then\r\n                    // the opposite happens: dragging by source causes the connection to get forgotten\r\n                    // about and then if you delete it jsplumb breaks.\r\n                    _jsPlumb.finaliseConnection(jpc, null, originalEvent/*, true*/);\r\n                    jpc.setHover(false);\r\n\r\n                }.bind(this);\r\n\r\n                var dontContinueFunction = function () {\r\n                    // otherwise just put it back on the endpoint it was on before the drag.\r\n                    if (jpc.suspendedEndpoint) {\r\n                        jpc.endpoints[idx] = jpc.suspendedEndpoint;\r\n                        jpc.setHover(false);\r\n                        jpc._forceDetach = true;\r\n                        if (idx === 0) {\r\n                            jpc.source = jpc.suspendedEndpoint.element;\r\n                            jpc.sourceId = jpc.suspendedEndpoint.elementId;\r\n                        } else {\r\n                            jpc.target = jpc.suspendedEndpoint.element;\r\n                            jpc.targetId = jpc.suspendedEndpoint.elementId;\r\n                        }\r\n                        jpc.suspendedEndpoint.addConnection(jpc);\r\n\r\n                        _jsPlumb.repaint(jpc.sourceId);\r\n                        jpc._forceDetach = false;\r\n                    }\r\n                };\r\n\r\n// --------------------------------------\r\n                // now check beforeDrop.  this will be available only on Endpoints that are setup to\r\n                // have a beforeDrop condition (although, secretly, under the hood all Endpoints and\r\n                // the Connection have them, because they are on jsPlumbUIComponent.  shhh!), because\r\n                // it only makes sense to have it on a target endpoint.\r\n                _doContinue = _doContinue && dhParams.isDropAllowed(jpc.sourceId, jpc.targetId, jpc.scope, jpc, _ep);// && jpc.pending;\r\n\r\n                if (_doContinue) {\r\n                    continueFunction(_doContinue);\r\n                    return true;\r\n                }\r\n                else {\r\n                    dontContinueFunction();\r\n                }\r\n            }\r\n\r\n            if (dhParams.maybeCleanup) dhParams.maybeCleanup(_ep);\r\n\r\n            _jsPlumb.currentlyDragging = false;\r\n        };\r\n    };\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the code for Connections.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://jsplumb.org\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this,\r\n        _jp = root.jsPlumb,\r\n        _ju = root.jsPlumbUtil;\r\n\r\n\r\n    var makeConnector = function (_jsPlumb, renderMode, connectorName, connectorArgs, forComponent) {\r\n            if (!_jsPlumb.Defaults.DoNotThrowErrors && jsPlumb.Connectors[renderMode][connectorName] == null)\r\n                throw { msg: \"jsPlumb: unknown connector type '\" + connectorName + \"'\" };\r\n\r\n            return new _jp.Connectors[renderMode][connectorName](connectorArgs, forComponent);\r\n        },\r\n        _makeAnchor = function (anchorParams, elementId, _jsPlumb) {\r\n            return (anchorParams) ? _jsPlumb.makeAnchor(anchorParams, elementId, _jsPlumb) : null;\r\n        },\r\n        _updateConnectedClass = function (conn, element, _jsPlumb, remove) {\r\n            if (element != null) {\r\n                element._jsPlumbConnections = element._jsPlumbConnections || {};\r\n                if (remove)\r\n                    delete element._jsPlumbConnections[conn.id];\r\n                else\r\n                    element._jsPlumbConnections[conn.id] = true;\r\n\r\n                if (_ju.isEmpty(element._jsPlumbConnections)) {\r\n                    _jsPlumb.removeClass(element, _jsPlumb.connectedClass);\r\n                }\r\n                else\r\n                    _jsPlumb.addClass(element, _jsPlumb.connectedClass);\r\n            }\r\n        };\r\n\r\n    _jp.Connection = function (params) {\r\n        var _newEndpoint = params.newEndpoint;\r\n\r\n        this.id = params.id;\r\n        this.connector = null;\r\n        this.idPrefix = \"_jsplumb_c_\";\r\n        this.defaultLabelLocation = 0.5;\r\n        this.defaultOverlayKeys = [\"Overlays\", \"ConnectionOverlays\"];\r\n        // if a new connection is the result of moving some existing connection, params.previousConnection\r\n        // will have that Connection in it. listeners for the jsPlumbConnection event can look for that\r\n        // member and take action if they need to.\r\n        this.previousConnection = params.previousConnection;\r\n        this.source = _jp.getElement(params.source);\r\n        this.target = _jp.getElement(params.target);\r\n        // sourceEndpoint and targetEndpoint override source/target, if they are present. but \r\n        // source is not overridden if the Endpoint has declared it is not the final target of a connection;\r\n        // instead we use the source that the Endpoint declares will be the final source element.\r\n        if (params.sourceEndpoint) this.source = params.sourceEndpoint.getElement();\r\n        if (params.targetEndpoint) this.target = params.targetEndpoint.getElement();\r\n\r\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\r\n\r\n        this.sourceId = this._jsPlumb.instance.getId(this.source);\r\n        this.targetId = this._jsPlumb.instance.getId(this.target);\r\n        this.scope = params.scope; // scope may have been passed in to the connect call. if it wasn't, we will pull it from the source endpoint, after having initialised the endpoints.            \r\n        this.endpoints = [];\r\n        this.endpointStyles = [];\r\n\r\n        var _jsPlumb = this._jsPlumb.instance;\r\n\r\n        _jsPlumb.manage(this.sourceId, this.source);\r\n        _jsPlumb.manage(this.targetId, this.target);\r\n\r\n        this._jsPlumb.visible = true;\r\n        this._jsPlumb.editable = params.editable === true;\r\n        this._jsPlumb.params = {\r\n            cssClass: params.cssClass,\r\n            container: params.container,\r\n            \"pointer-events\": params[\"pointer-events\"],\r\n            editorParams: params.editorParams,\r\n            overlays: params.overlays\r\n        };\r\n        this._jsPlumb.lastPaintedAt = null;\r\n\r\n        // listen to mouseover and mouseout events passed from the container delegate.\r\n        this.bind(\"mouseover\", function () {\r\n            this.setHover(true);\r\n        }.bind(this));\r\n        this.bind(\"mouseout\", function () {\r\n            this.setHover(false);\r\n        }.bind(this));\r\n\r\n// INITIALISATION CODE\r\n\r\n        this.makeEndpoint = function (isSource, el, elId, ep) {\r\n            elId = elId || this._jsPlumb.instance.getId(el);\r\n            return this.prepareEndpoint(_jsPlumb, _newEndpoint, this, ep, isSource ? 0 : 1, params, el, elId);\r\n        };\r\n\r\n        var eS = this.makeEndpoint(true, this.source, this.sourceId, params.sourceEndpoint),\r\n            eT = this.makeEndpoint(false, this.target, this.targetId, params.targetEndpoint);\r\n\r\n        if (eS) _ju.addToList(params.endpointsByElement, this.sourceId, eS);\r\n        if (eT) _ju.addToList(params.endpointsByElement, this.targetId, eT);\r\n        // if scope not set, set it to be the scope for the source endpoint.\r\n        if (!this.scope) this.scope = this.endpoints[0].scope;\r\n\r\n        // if explicitly told to (or not to) delete endpoints on detach, override endpoint's preferences\r\n        if (params.deleteEndpointsOnDetach != null) {\r\n            this.endpoints[0]._deleteOnDetach = params.deleteEndpointsOnDetach;\r\n            this.endpoints[1]._deleteOnDetach = params.deleteEndpointsOnDetach;\r\n        }\r\n        else {\r\n            // otherwise, unless the endpoints say otherwise, mark them for deletion.\r\n            if (!this.endpoints[0]._doNotDeleteOnDetach) this.endpoints[0]._deleteOnDetach = true;\r\n            if (!this.endpoints[1]._doNotDeleteOnDetach) this.endpoints[1]._deleteOnDetach = true;\r\n        }\r\n\r\n// -------------------------- DEFAULT TYPE ---------------------------------------------\r\n\r\n        // DETACHABLE\r\n        var _detachable = _jsPlumb.Defaults.ConnectionsDetachable;\r\n        if (params.detachable === false) _detachable = false;\r\n        if (this.endpoints[0].connectionsDetachable === false) _detachable = false;\r\n        if (this.endpoints[1].connectionsDetachable === false) _detachable = false;\r\n        // REATTACH\r\n        var _reattach = params.reattach || this.endpoints[0].reattachConnections || this.endpoints[1].reattachConnections || _jsPlumb.Defaults.ReattachConnections;\r\n\r\n        this.appendToDefaultType({\r\n            detachable: _detachable,\r\n            rettach: _reattach,\r\n            paintStyle:this.endpoints[0].connectorStyle || this.endpoints[1].connectorStyle || params.paintStyle || _jsPlumb.Defaults.PaintStyle || jsPlumb.Defaults.PaintStyle,\r\n            hoverPaintStyle:this.endpoints[0].connectorHoverStyle || this.endpoints[1].connectorHoverStyle || params.hoverPaintStyle || _jsPlumb.Defaults.HoverPaintStyle || jsPlumb.Defaults.HoverPaintStyle\r\n        });\r\n\r\n\r\n        var _suspendedAt = _jsPlumb.getSuspendedAt();\r\n        if (!_jsPlumb.isSuspendDrawing()) {\r\n            // paint the endpoints\r\n            var myInfo = _jsPlumb.getCachedData(this.sourceId),\r\n                myOffset = myInfo.o, myWH = myInfo.s,\r\n                otherInfo = _jsPlumb.getCachedData(this.targetId),\r\n                otherOffset = otherInfo.o,\r\n                otherWH = otherInfo.s,\r\n                initialTimestamp = _suspendedAt || _jsPlumb.timestamp(),\r\n                anchorLoc = this.endpoints[0].anchor.compute({\r\n                    xy: [ myOffset.left, myOffset.top ], wh: myWH, element: this.endpoints[0],\r\n                    elementId: this.endpoints[0].elementId,\r\n                    txy: [ otherOffset.left, otherOffset.top ], twh: otherWH, tElement: this.endpoints[1],\r\n                    timestamp: initialTimestamp\r\n                });\r\n\r\n            this.endpoints[0].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\r\n\r\n            anchorLoc = this.endpoints[1].anchor.compute({\r\n                xy: [ otherOffset.left, otherOffset.top ], wh: otherWH, element: this.endpoints[1],\r\n                elementId: this.endpoints[1].elementId,\r\n                txy: [ myOffset.left, myOffset.top ], twh: myWH, tElement: this.endpoints[0],\r\n                timestamp: initialTimestamp\r\n            });\r\n            this.endpoints[1].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\r\n        }\r\n\r\n        this.getTypeDescriptor = function () {\r\n            return \"connection\";\r\n        };\r\n        this.getAttachedElements = function () {\r\n            return this.endpoints;\r\n        };\r\n\r\n        this.isDetachable = function () {\r\n            return this._jsPlumb.detachable === true;\r\n        };\r\n        this.setDetachable = function (detachable) {\r\n            this._jsPlumb.detachable = detachable === true;\r\n        };\r\n        this.isReattach = function () {\r\n            return this._jsPlumb.reattach === true || this.endpoints[0].reattachConnections === true || this.endpoints[1].reattachConnections === true;\r\n        };\r\n        this.setReattach = function (reattach) {\r\n            this._jsPlumb.reattach = reattach === true;\r\n        };\r\n\r\n// END INITIALISATION CODE\r\n\r\n\r\n// COST + DIRECTIONALITY\r\n        // if cost not supplied, try to inherit from source endpoint\r\n        this._jsPlumb.cost = params.cost || this.endpoints[0].getConnectionCost();\r\n        this._jsPlumb.directed = params.directed;\r\n        // inherit directed flag if set no source endpoint\r\n        if (params.directed == null) this._jsPlumb.directed = this.endpoints[0].areConnectionsDirected();\r\n// END COST + DIRECTIONALITY\r\n\r\n// PARAMETERS\r\n        // merge all the parameters objects into the connection.  parameters set\r\n        // on the connection take precedence; then source endpoint params, then\r\n        // finally target endpoint params.\r\n        var _p = jsPlumb.extend({}, this.endpoints[1].getParameters());\r\n        _jp.extend(_p, this.endpoints[0].getParameters());\r\n        _jp.extend(_p, this.getParameters());\r\n        this.setParameters(_p);\r\n// END PARAMETERS\r\n\r\n// PAINTING\r\n\r\n        this.setConnector(this.endpoints[0].connector || this.endpoints[1].connector || params.connector || _jsPlumb.Defaults.Connector || _jp.Defaults.Connector, true);\r\n        var data = params.data == null || !jsPlumbUtil.isObject(params.data) ? {} : params.data;\r\n        this.getData = function() { return data; };\r\n        this.setData = function(d) { data = d || {}; };\r\n        this.mergeData = function(d) { data = jsPlumb.extend(data, d); };\r\n\r\n        // the very last thing we do is apply types, if there are any.\r\n        var _types = [ \"default\",  params.type, this.endpoints[0].connectionType, this.endpoints[1].connectionType ].join(\" \");\r\n        if (/[^\\s]/.test(_types))\r\n            this.addType(_types, params.data, true);\r\n\r\n        this.updateConnectedClass();\r\n\r\n// END PAINTING    \r\n    };\r\n\r\n    _ju.extend(_jp.Connection, _jp.OverlayCapableJsPlumbUIComponent, {\r\n        applyType: function (t, doNotRepaint, typeMap) {\r\n\r\n            // none of these things result in the creation of objects so can be ignored.\r\n            if (t.detachable != null) this.setDetachable(t.detachable);\r\n            if (t.reattach != null) this.setReattach(t.reattach);\r\n            if (t.scope) this.scope = t.scope;\r\n\r\n            if (t.cssClass != null && this.canvas) this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\r\n\r\n            var _anchors = null;\r\n            // this also results in the creation of objects.\r\n            if (t.anchor) {\r\n                // note that even if the param was anchor, we store `anchors`.\r\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchor);\r\n                if (_anchors == null) {\r\n                    _anchors = [ this._jsPlumb.instance.makeAnchor(t.anchor), this._jsPlumb.instance.makeAnchor(t.anchor) ];\r\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchor);\r\n                }\r\n            }\r\n            else if (t.anchors) {\r\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchors);\r\n                if (_anchors == null) {\r\n                    _anchors = [\r\n                        this._jsPlumb.instance.makeAnchor(t.anchors[0]),\r\n                        this._jsPlumb.instance.makeAnchor(t.anchors[1])\r\n                    ];\r\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchors);\r\n                }\r\n            }\r\n            if (_anchors != null) {\r\n                this.endpoints[0].anchor = _anchors[0];\r\n                this.endpoints[1].anchor = _anchors[1];\r\n            }\r\n\r\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\r\n        },\r\n        addClass: function (c, informEndpoints) {\r\n            if (informEndpoints) {\r\n                this.endpoints[0].addClass(c);\r\n                this.endpoints[1].addClass(c);\r\n                if (this.suspendedEndpoint) this.suspendedEndpoint.addClass(c);\r\n            }\r\n            if (this.connector) {\r\n                this.connector.addClass(c);\r\n            }\r\n        },\r\n        removeClass: function (c, informEndpoints) {\r\n            if (informEndpoints) {\r\n                this.endpoints[0].removeClass(c);\r\n                this.endpoints[1].removeClass(c);\r\n                if (this.suspendedEndpoint) this.suspendedEndpoint.removeClass(c);\r\n            }\r\n            if (this.connector) {\r\n                this.connector.removeClass(c);\r\n            }\r\n        },\r\n        isVisible: function () {\r\n            return this._jsPlumb.visible;\r\n        },\r\n        setVisible: function (v) {\r\n            this._jsPlumb.visible = v;\r\n            if (this.connector)\r\n                this.connector.setVisible(v);\r\n            this.repaint();\r\n        },\r\n        cleanup: function () {\r\n            this.updateConnectedClass(true);\r\n            this.endpoints = null;\r\n            this.source = null;\r\n            this.target = null;\r\n            if (this.connector != null) {\r\n                this.connector.cleanup(true);\r\n                this.connector.destroy(true);\r\n            }\r\n            this.connector = null;\r\n        },\r\n        updateConnectedClass:function(remove) {\r\n            _updateConnectedClass(this, this.source, this._jsPlumb.instance, remove);\r\n            _updateConnectedClass(this, this.target, this._jsPlumb.instance, remove);\r\n        },\r\n        setHover: function (state) {\r\n            if (this.connector && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\r\n                this.connector.setHover(state);\r\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.source, this._jsPlumb.instance.hoverSourceClass);\r\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.target, this._jsPlumb.instance.hoverTargetClass);\r\n            }\r\n        },\r\n        getUuids:function() {\r\n            return [ this.endpoints[0].getUuid(), this.endpoints[1].getUuid() ];\r\n        },\r\n        getCost: function () {\r\n            return this._jsPlumb.cost;\r\n        },\r\n        setCost: function (c) {\r\n            this._jsPlumb.cost = c;\r\n        },\r\n        isDirected: function () {\r\n            return this._jsPlumb.directed === true;\r\n        },\r\n        getConnector: function () {\r\n            return this.connector;\r\n        },\r\n        prepareConnector:function(connectorSpec, typeId) {\r\n            var connectorArgs = {\r\n                    _jsPlumb: this._jsPlumb.instance,\r\n                    cssClass: this._jsPlumb.params.cssClass,\r\n                    container: this._jsPlumb.params.container,\r\n                    \"pointer-events\": this._jsPlumb.params[\"pointer-events\"]\r\n                },\r\n                renderMode = this._jsPlumb.instance.getRenderMode(),\r\n                connector;\r\n\r\n            if (_ju.isString(connectorSpec))\r\n                connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec, connectorArgs, this); // lets you use a string as shorthand.\r\n            else if (_ju.isArray(connectorSpec)) {\r\n                if (connectorSpec.length == 1)\r\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], connectorArgs, this);\r\n                else\r\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], _ju.merge(connectorSpec[1], connectorArgs), this);\r\n            }\r\n            if (typeId != null) connector.typeId = typeId;\r\n            return connector;\r\n        },\r\n        setPreparedConnector: function(connector, doNotRepaint, doNotChangeListenerComponent, typeId) {\r\n\r\n            var previous;\r\n            // the connector will not be cleaned up if it was set as part of a type, because `typeId` will be set on it\r\n            // and we havent passed in `true` for \"force\" here.\r\n            if (this.connector != null) {\r\n                previous = this.connector;\r\n                this.connector.cleanup();\r\n                this.connector.destroy();\r\n            }\r\n\r\n            this.connector = connector;\r\n            if (typeId) {\r\n                this.cacheTypeItem(\"connector\", connector, typeId);\r\n            }\r\n\r\n            this.canvas = this.connector.canvas;\r\n            this.bgCanvas = this.connector.bgCanvas;\r\n\r\n            // new: instead of binding listeners per connector, we now just have one delegate on the container.\r\n            // so for that handler we set the connection as the '_jsPlumb' member of the canvas element, and\r\n            // bgCanvas, if it exists, which it does right now in the VML renderer, so it won't from v 2.0.0 onwards.\r\n            if (this.canvas) this.canvas._jsPlumb = this;\r\n            if (this.bgCanvas) this.bgCanvas._jsPlumb = this;\r\n\r\n            if (previous != null) {\r\n                var o = this.getOverlays();\r\n                for (var i = 0; i < o.length; i++) {\r\n                    if (o[i].transfer) o[i].transfer(this.connector);\r\n                }\r\n            }\r\n\r\n            if (!doNotChangeListenerComponent) this.setListenerComponent(this.connector);\r\n            if (!doNotRepaint) this.repaint();\r\n        },\r\n        setConnector: function (connectorSpec, doNotRepaint, doNotChangeListenerComponent, typeId) {\r\n            var connector = this.prepareConnector(connectorSpec, typeId);\r\n            this.setPreparedConnector(connector, doNotRepaint, doNotChangeListenerComponent, typeId);\r\n        },\r\n        paint: function (params) {\r\n\r\n            if (!this._jsPlumb.instance.isSuspendDrawing() && this._jsPlumb.visible) {\r\n                params = params || {};\r\n                var timestamp = params.timestamp,\r\n                // if the moving object is not the source we must transpose the two references.\r\n                    swap = false,\r\n                    tId = swap ? this.sourceId : this.targetId, sId = swap ? this.targetId : this.sourceId,\r\n                    tIdx = swap ? 0 : 1, sIdx = swap ? 1 : 0;\r\n\r\n                if (timestamp == null || timestamp != this._jsPlumb.lastPaintedAt) {\r\n                    var sourceInfo = this._jsPlumb.instance.updateOffset({elId:sId}).o,\r\n                        targetInfo = this._jsPlumb.instance.updateOffset({elId:tId}).o,\r\n                        sE = this.endpoints[sIdx], tE = this.endpoints[tIdx];\r\n\r\n                    var sAnchorP = sE.anchor.getCurrentLocation({xy: [sourceInfo.left, sourceInfo.top], wh: [sourceInfo.width, sourceInfo.height], element: sE, timestamp: timestamp}),\r\n                        tAnchorP = tE.anchor.getCurrentLocation({xy: [targetInfo.left, targetInfo.top], wh: [targetInfo.width, targetInfo.height], element: tE, timestamp: timestamp});\r\n\r\n                    this.connector.resetBounds();\r\n\r\n                    this.connector.compute({\r\n                        sourcePos: sAnchorP,\r\n                        targetPos: tAnchorP,\r\n                        sourceEndpoint: this.endpoints[sIdx],\r\n                        targetEndpoint: this.endpoints[tIdx],\r\n                        lineWidth: this._jsPlumb.paintStyleInUse.lineWidth,\r\n                        sourceInfo: sourceInfo,\r\n                        targetInfo: targetInfo\r\n                    });\r\n\r\n                    var overlayExtents = { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity };\r\n\r\n                    // compute overlays. we do this first so we can get their placements, and adjust the\r\n                    // container if needs be (if an overlay would be clipped)\r\n                    for (var i in this._jsPlumb.overlays) {\r\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\r\n                            var o = this._jsPlumb.overlays[i];\r\n                            if (o.isVisible()) {\r\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.connector, this._jsPlumb.paintStyleInUse, this.getAbsoluteOverlayPosition(o));\r\n                                overlayExtents.minX = Math.min(overlayExtents.minX, this._jsPlumb.overlayPlacements[i].minX);\r\n                                overlayExtents.maxX = Math.max(overlayExtents.maxX, this._jsPlumb.overlayPlacements[i].maxX);\r\n                                overlayExtents.minY = Math.min(overlayExtents.minY, this._jsPlumb.overlayPlacements[i].minY);\r\n                                overlayExtents.maxY = Math.max(overlayExtents.maxY, this._jsPlumb.overlayPlacements[i].maxY);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    var lineWidth = parseFloat(this._jsPlumb.paintStyleInUse.lineWidth || 1) / 2,\r\n                        outlineWidth = parseFloat(this._jsPlumb.paintStyleInUse.lineWidth || 0),\r\n                        extents = {\r\n                            xmin: Math.min(this.connector.bounds.minX - (lineWidth + outlineWidth), overlayExtents.minX),\r\n                            ymin: Math.min(this.connector.bounds.minY - (lineWidth + outlineWidth), overlayExtents.minY),\r\n                            xmax: Math.max(this.connector.bounds.maxX + (lineWidth + outlineWidth), overlayExtents.maxX),\r\n                            ymax: Math.max(this.connector.bounds.maxY + (lineWidth + outlineWidth), overlayExtents.maxY)\r\n                        };\r\n                    // paint the connector.\r\n                    this.connector.paint(this._jsPlumb.paintStyleInUse, null, extents);\r\n                    // and then the overlays\r\n                    for (var j in this._jsPlumb.overlays) {\r\n                        if (this._jsPlumb.overlays.hasOwnProperty(j)) {\r\n                            var p = this._jsPlumb.overlays[j];\r\n                            if (p.isVisible()) {\r\n                                p.paint(this._jsPlumb.overlayPlacements[j], extents);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                this._jsPlumb.lastPaintedAt = timestamp;\r\n            }\r\n        },\r\n        repaint: function (params) {\r\n            params = params || {};\r\n            this.paint({ elId: this.sourceId, recalc: !(params.recalc === false), timestamp: params.timestamp});\r\n        },\r\n        prepareEndpoint: function (_jsPlumb, _newEndpoint, conn, existing, index, params, element, elementId) {\r\n            var e;\r\n            if (existing) {\r\n                conn.endpoints[index] = existing;\r\n                existing.addConnection(conn);\r\n            } else {\r\n                if (!params.endpoints) params.endpoints = [ null, null ];\r\n                var ep = params.endpoints[index] || params.endpoint || _jsPlumb.Defaults.Endpoints[index] || jsPlumb.Defaults.Endpoints[index] || _jsPlumb.Defaults.Endpoint || jsPlumb.Defaults.Endpoint;\r\n                if (!params.endpointStyles) params.endpointStyles = [ null, null ];\r\n                if (!params.endpointHoverStyles) params.endpointHoverStyles = [ null, null ];\r\n                var es = params.endpointStyles[index] || params.endpointStyle || _jsPlumb.Defaults.EndpointStyles[index] || jsPlumb.Defaults.EndpointStyles[index] || _jsPlumb.Defaults.EndpointStyle || jsPlumb.Defaults.EndpointStyle;\r\n                // Endpoints derive their fillStyle from the connector's strokeStyle, if no fillStyle was specified.\r\n                if (es.fillStyle == null && params.paintStyle != null)\r\n                    es.fillStyle = params.paintStyle.strokeStyle;\r\n\r\n                if (es.outlineColor == null && params.paintStyle != null)\r\n                    es.outlineColor = params.paintStyle.outlineColor;\r\n                if (es.outlineWidth == null && params.paintStyle != null)\r\n                    es.outlineWidth = params.paintStyle.outlineWidth;\r\n\r\n                var ehs = params.endpointHoverStyles[index] || params.endpointHoverStyle || _jsPlumb.Defaults.EndpointHoverStyles[index] || jsPlumb.Defaults.EndpointHoverStyles[index] || _jsPlumb.Defaults.EndpointHoverStyle || jsPlumb.Defaults.EndpointHoverStyle;\r\n                // endpoint hover fill style is derived from connector's hover stroke style\r\n                if (params.hoverPaintStyle != null) {\r\n                    if (ehs == null) ehs = {};\r\n                    if (ehs.fillStyle == null) {\r\n                        ehs.fillStyle = params.hoverPaintStyle.strokeStyle;\r\n                    }\r\n                }\r\n                var a = params.anchors ? params.anchors[index] :\r\n                        params.anchor ? params.anchor :\r\n                            _makeAnchor(_jsPlumb.Defaults.Anchors[index], elementId, _jsPlumb) ||\r\n                            _makeAnchor(_jp.Defaults.Anchors[index], elementId, _jsPlumb) ||\r\n                            _makeAnchor(_jsPlumb.Defaults.Anchor, elementId, _jsPlumb) ||\r\n                            _makeAnchor(_jp.Defaults.Anchor, elementId, _jsPlumb),\r\n                    u = params.uuids ? params.uuids[index] : null;\r\n\r\n                e = _newEndpoint({\r\n                    paintStyle: es, hoverPaintStyle: ehs, endpoint: ep, connections: [ conn ],\r\n                    uuid: u, anchor: a, source: element, scope: params.scope,\r\n                    reattach: params.reattach || _jsPlumb.Defaults.ReattachConnections,\r\n                    detachable: params.detachable || _jsPlumb.Defaults.ConnectionsDetachable\r\n                });\r\n                conn.endpoints[index] = e;\r\n\r\n                if (params.drawEndpoints === false) e.setVisible(false, true, true);\r\n\r\n            }\r\n            return e;\r\n        }\r\n\r\n    }); // END Connection class            \r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the code for creating and manipulating anchors.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n\r\n    var root = this,\r\n        _ju = root.jsPlumbUtil,\r\n        _jp = root.jsPlumb;\r\n\r\n    //\r\n    // manages anchors for all elements.\r\n    //\r\n    _jp.AnchorManager = function (params) {\r\n        var _amEndpoints = {},\r\n            continuousAnchorLocations = {},\r\n            userDefinedContinuousAnchorLocations = {},\r\n            continuousAnchorOrientations = {},\r\n            Orientation = { HORIZONTAL: \"horizontal\", VERTICAL: \"vertical\", DIAGONAL: \"diagonal\", IDENTITY: \"identity\" },\r\n            axes = [\"left\", \"top\", \"right\", \"bottom\"],\r\n            connectionsByElementId = {},\r\n            self = this,\r\n            anchorLists = {},\r\n            jsPlumbInstance = params.jsPlumbInstance,\r\n            floatingConnections = {},\r\n            calculateOrientation = function (sourceId, targetId, sd, td, sourceAnchor, targetAnchor) {\r\n\r\n                if (sourceId === targetId) return {\r\n                    orientation: Orientation.IDENTITY,\r\n                    a: [\"top\", \"top\"]\r\n                };\r\n\r\n                var theta = Math.atan2((td.centery - sd.centery), (td.centerx - sd.centerx)),\r\n                    theta2 = Math.atan2((sd.centery - td.centery), (sd.centerx - td.centerx));\r\n\r\n// --------------------------------------------------------------------------------------\r\n\r\n                // improved face calculation. get midpoints of each face for source and target, then put in an array with all combinations of\r\n                // source/target faces. sort this array by distance between midpoints. the entry at index 0 is our preferred option. we can\r\n                // go through the array one by one until we find an entry in which each requested face is supported.\r\n                var candidates = [], midpoints = { };\r\n                (function (types, dim) {\r\n                    for (var i = 0; i < types.length; i++) {\r\n                        midpoints[types[i]] = {\r\n                            \"left\": [ dim[i].left, dim[i].centery ],\r\n                            \"right\": [ dim[i].right, dim[i].centery ],\r\n                            \"top\": [ dim[i].centerx, dim[i].top ],\r\n                            \"bottom\": [ dim[i].centerx , dim[i].bottom]\r\n                        };\r\n                    }\r\n                })([ \"source\", \"target\" ], [ sd, td ]);\r\n\r\n                for (var sf = 0; sf < axes.length; sf++) {\r\n                    for (var tf = 0; tf < axes.length; tf++) {\r\n                        if (sf != tf) {\r\n                            candidates.push({\r\n                                source: axes[sf],\r\n                                target: axes[tf],\r\n                                dist: Biltong.lineLength(midpoints.source[axes[sf]], midpoints.target[axes[tf]])\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n\r\n                candidates.sort(function (a, b) {\r\n                    return a.dist < b.dist ? -1 : a.dist > b.dist ? 1 : 0;\r\n                });\r\n\r\n                // now go through this list and try to get an entry that satisfies both (there will be one, unless one of the anchors\r\n                // declares no available faces)\r\n                var sourceEdge = candidates[0].source, targetEdge = candidates[0].target;\r\n                for (var i = 0; i < candidates.length; i++) {\r\n\r\n                    if (!sourceAnchor.isContinuous || sourceAnchor.isEdgeSupported(candidates[i].source))\r\n                        sourceEdge = candidates[i].source;\r\n                    else\r\n                        sourceEdge = null;\r\n\r\n                    if (!targetAnchor.isContinuous || targetAnchor.isEdgeSupported(candidates[i].target))\r\n                        targetEdge = candidates[i].target;\r\n                    else {\r\n                        targetEdge = null;\r\n                    }\r\n\r\n                    if (sourceEdge != null && targetEdge != null) break;\r\n                }\r\n\r\n// --------------------------------------------------------------------------------------\r\n\r\n                return {\r\n                    a: [ sourceEdge, targetEdge ],\r\n                    theta: theta,\r\n                    theta2: theta2\r\n                };\r\n            },\r\n        // used by placeAnchors function\r\n            placeAnchorsOnLine = function (desc, elementDimensions, elementPosition, connections, horizontal, otherMultiplier, reverse) {\r\n                var a = [], step = elementDimensions[horizontal ? 0 : 1] / (connections.length + 1);\r\n\r\n                for (var i = 0; i < connections.length; i++) {\r\n                    var val = (i + 1) * step, other = otherMultiplier * elementDimensions[horizontal ? 1 : 0];\r\n                    if (reverse)\r\n                        val = elementDimensions[horizontal ? 0 : 1] - val;\r\n\r\n                    var dx = (horizontal ? val : other), x = elementPosition[0] + dx, xp = dx / elementDimensions[0],\r\n                        dy = (horizontal ? other : val), y = elementPosition[1] + dy, yp = dy / elementDimensions[1];\r\n\r\n                    a.push([ x, y, xp, yp, connections[i][1], connections[i][2] ]);\r\n                }\r\n\r\n                return a;\r\n            },\r\n        // used by edgeSortFunctions\r\n            currySort = function (reverseAngles) {\r\n                return function (a, b) {\r\n                    var r = true;\r\n                    if (reverseAngles) {\r\n                        r = a[0][0] < b[0][0];\r\n                    }\r\n                    else {\r\n                        r = a[0][0] > b[0][0];\r\n                    }\r\n                    return r === false ? -1 : 1;\r\n                };\r\n            },\r\n        // used by edgeSortFunctions\r\n            leftSort = function (a, b) {\r\n                // first get adjusted values\r\n                var p1 = a[0][0] < 0 ? -Math.PI - a[0][0] : Math.PI - a[0][0],\r\n                    p2 = b[0][0] < 0 ? -Math.PI - b[0][0] : Math.PI - b[0][0];\r\n                if (p1 > p2) return 1;\r\n                else return a[0][1] > b[0][1] ? 1 : -1;\r\n            },\r\n        // used by placeAnchors\r\n            edgeSortFunctions = {\r\n                \"top\": function (a, b) {\r\n                    return a[0] > b[0] ? 1 : -1;\r\n                },\r\n                \"right\": currySort(true),\r\n                \"bottom\": currySort(true),\r\n                \"left\": leftSort\r\n            },\r\n        // used by placeAnchors\r\n            _sortHelper = function (_array, _fn) {\r\n                return _array.sort(_fn);\r\n            },\r\n        // used by AnchorManager.redraw\r\n            placeAnchors = function (elementId, _anchorLists) {\r\n                var cd = jsPlumbInstance.getCachedData(elementId), sS = cd.s, sO = cd.o,\r\n                    placeSomeAnchors = function (desc, elementDimensions, elementPosition, unsortedConnections, isHorizontal, otherMultiplier, orientation) {\r\n                        if (unsortedConnections.length > 0) {\r\n                            var sc = _sortHelper(unsortedConnections, edgeSortFunctions[desc]), // puts them in order based on the target element's pos on screen\r\n                                reverse = desc === \"right\" || desc === \"top\",\r\n                                anchors = placeAnchorsOnLine(desc, elementDimensions,\r\n                                    elementPosition, sc,\r\n                                    isHorizontal, otherMultiplier, reverse);\r\n\r\n                            // takes a computed anchor position and adjusts it for parent offset and scroll, then stores it.\r\n                            var _setAnchorLocation = function (endpoint, anchorPos) {\r\n                                continuousAnchorLocations[endpoint.id] = [ anchorPos[0], anchorPos[1], anchorPos[2], anchorPos[3] ];\r\n                                continuousAnchorOrientations[endpoint.id] = orientation;\r\n                            };\r\n\r\n                            for (var i = 0; i < anchors.length; i++) {\r\n                                var c = anchors[i][4], weAreSource = c.endpoints[0].elementId === elementId, weAreTarget = c.endpoints[1].elementId === elementId;\r\n                                if (weAreSource)\r\n                                    _setAnchorLocation(c.endpoints[0], anchors[i]);\r\n                                else if (weAreTarget)\r\n                                    _setAnchorLocation(c.endpoints[1], anchors[i]);\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                placeSomeAnchors(\"bottom\", sS, [sO.left, sO.top], _anchorLists.bottom, true, 1, [0, 1]);\r\n                placeSomeAnchors(\"top\", sS, [sO.left, sO.top], _anchorLists.top, true, 0, [0, -1]);\r\n                placeSomeAnchors(\"left\", sS, [sO.left, sO.top], _anchorLists.left, false, 0, [-1, 0]);\r\n                placeSomeAnchors(\"right\", sS, [sO.left, sO.top], _anchorLists.right, false, 1, [1, 0]);\r\n            };\r\n\r\n        this.reset = function () {\r\n            _amEndpoints = {};\r\n            connectionsByElementId = {};\r\n            anchorLists = {};\r\n        };\r\n        this.addFloatingConnection = function (key, conn) {\r\n            floatingConnections[key] = conn;\r\n        };\r\n        this.removeFloatingConnection = function (key) {\r\n            delete floatingConnections[key];\r\n        };\r\n        this.newConnection = function (conn) {\r\n            var sourceId = conn.sourceId, targetId = conn.targetId,\r\n                ep = conn.endpoints,\r\n                doRegisterTarget = true,\r\n                registerConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\r\n                    if ((sourceId == targetId) && otherAnchor.isContinuous) {\r\n                        // remove the target endpoint's canvas.  we dont need it.\r\n                        conn._jsPlumb.instance.removeElement(ep[1].canvas);\r\n                        doRegisterTarget = false;\r\n                    }\r\n                    _ju.addToList(connectionsByElementId, elId, [c, otherEndpoint, otherAnchor.constructor == _jp.DynamicAnchor]);\r\n                };\r\n\r\n            registerConnection(0, ep[0], ep[0].anchor, targetId, conn);\r\n            if (doRegisterTarget)\r\n                registerConnection(1, ep[1], ep[1].anchor, sourceId, conn);\r\n        };\r\n        var removeEndpointFromAnchorLists = function (endpoint) {\r\n            (function (list, eId) {\r\n                if (list) {  // transient anchors dont get entries in this list.\r\n                    var f = function (e) {\r\n                        return e[4] == eId;\r\n                    };\r\n                    _ju.removeWithFunction(list.top, f);\r\n                    _ju.removeWithFunction(list.left, f);\r\n                    _ju.removeWithFunction(list.bottom, f);\r\n                    _ju.removeWithFunction(list.right, f);\r\n                }\r\n            })(anchorLists[endpoint.elementId], endpoint.id);\r\n        };\r\n        this.connectionDetached = function (connInfo) {\r\n            var connection = connInfo.connection || connInfo,\r\n                sourceId = connInfo.sourceId,\r\n                targetId = connInfo.targetId,\r\n                ep = connection.endpoints,\r\n                removeConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\r\n                    if (otherAnchor != null && otherAnchor.constructor == _jp.FloatingAnchor) {\r\n                        // no-op\r\n                    }\r\n                    else {\r\n                        _ju.removeWithFunction(connectionsByElementId[elId], function (_c) {\r\n                            return _c[0].id == c.id;\r\n                        });\r\n                    }\r\n                };\r\n\r\n            removeConnection(1, ep[1], ep[1].anchor, sourceId, connection);\r\n            removeConnection(0, ep[0], ep[0].anchor, targetId, connection);\r\n\r\n            // remove from anchorLists            \r\n            removeEndpointFromAnchorLists(connection.endpoints[0]);\r\n            removeEndpointFromAnchorLists(connection.endpoints[1]);\r\n\r\n            self.redraw(connection.sourceId);\r\n            self.redraw(connection.targetId);\r\n        };\r\n        this.add = function (endpoint, elementId) {\r\n            _ju.addToList(_amEndpoints, elementId, endpoint);\r\n        };\r\n        this.changeId = function (oldId, newId) {\r\n            connectionsByElementId[newId] = connectionsByElementId[oldId];\r\n            _amEndpoints[newId] = _amEndpoints[oldId];\r\n            delete connectionsByElementId[oldId];\r\n            delete _amEndpoints[oldId];\r\n        };\r\n        this.getConnectionsFor = function (elementId) {\r\n            return connectionsByElementId[elementId] || [];\r\n        };\r\n        this.getEndpointsFor = function (elementId) {\r\n            return _amEndpoints[elementId] || [];\r\n        };\r\n        this.deleteEndpoint = function (endpoint) {\r\n            _ju.removeWithFunction(_amEndpoints[endpoint.elementId], function (e) {\r\n                return e.id == endpoint.id;\r\n            });\r\n            removeEndpointFromAnchorLists(endpoint);\r\n        };\r\n        this.clearFor = function (elementId) {\r\n            delete _amEndpoints[elementId];\r\n            _amEndpoints[elementId] = [];\r\n        };\r\n        // updates the given anchor list by either updating an existing anchor's info, or adding it. this function\r\n        // also removes the anchor from its previous list, if the edge it is on has changed.\r\n        // all connections found along the way (those that are connected to one of the faces this function\r\n        // operates on) are added to the connsToPaint list, as are their endpoints. in this way we know to repaint\r\n        // them wthout having to calculate anything else about them.\r\n        var _updateAnchorList = function (lists, theta, order, conn, aBoolean, otherElId, idx, reverse, edgeId, elId, connsToPaint, endpointsToPaint) {\r\n            // first try to find the exact match, but keep track of the first index of a matching element id along the way.s\r\n            var exactIdx = -1,\r\n                firstMatchingElIdx = -1,\r\n                endpoint = conn.endpoints[idx],\r\n                endpointId = endpoint.id,\r\n                oIdx = [1, 0][idx],\r\n                values = [\r\n                    [ theta, order ],\r\n                    conn,\r\n                    aBoolean,\r\n                    otherElId,\r\n                    endpointId\r\n                ],\r\n                listToAddTo = lists[edgeId],\r\n                listToRemoveFrom = endpoint._continuousAnchorEdge ? lists[endpoint._continuousAnchorEdge] : null,\r\n                i,\r\n                candidate;\r\n\r\n            if (listToRemoveFrom) {\r\n                var rIdx = _ju.findWithFunction(listToRemoveFrom, function (e) {\r\n                    return e[4] == endpointId;\r\n                });\r\n                if (rIdx != -1) {\r\n                    listToRemoveFrom.splice(rIdx, 1);\r\n                    // get all connections from this list\r\n                    for (i = 0; i < listToRemoveFrom.length; i++) {\r\n                        candidate = listToRemoveFrom[i][1];\r\n                        _ju.addWithFunction(connsToPaint, candidate, function (c) {\r\n                            return c.id == candidate.id;\r\n                        });\r\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[idx], function (e) {\r\n                            return e.id == candidate.endpoints[idx].id;\r\n                        });\r\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[oIdx], function (e) {\r\n                            return e.id == candidate.endpoints[oIdx].id;\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            for (i = 0; i < listToAddTo.length; i++) {\r\n                candidate = listToAddTo[i][1];\r\n                if (params.idx == 1 && listToAddTo[i][3] === otherElId && firstMatchingElIdx == -1)\r\n                    firstMatchingElIdx = i;\r\n                _ju.addWithFunction(connsToPaint, candidate, function (c) {\r\n                    return c.id == candidate.id;\r\n                });\r\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[idx], function (e) {\r\n                    return e.id == candidate.endpoints[idx].id;\r\n                });\r\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[oIdx], function (e) {\r\n                    return e.id == candidate.endpoints[oIdx].id;\r\n                });\r\n            }\r\n            if (exactIdx != -1) {\r\n                listToAddTo[exactIdx] = values;\r\n            }\r\n            else {\r\n                var insertIdx = reverse ? firstMatchingElIdx != -1 ? firstMatchingElIdx : 0 : listToAddTo.length; // of course we will get this from having looked through the array shortly.\r\n                listToAddTo.splice(insertIdx, 0, values);\r\n            }\r\n\r\n            // store this for next time.\r\n            endpoint._continuousAnchorEdge = edgeId;\r\n        };\r\n\r\n        //\r\n        // find the entry in an endpoint's list for this connection and update its target endpoint\r\n        // with the current target in the connection.\r\n        // \r\n        //\r\n        this.updateOtherEndpoint = function (elId, oldTargetId, newTargetId, connection) {\r\n            var sIndex = _ju.findWithFunction(connectionsByElementId[elId], function (i) {\r\n                    return i[0].id === connection.id;\r\n                }),\r\n                tIndex = _ju.findWithFunction(connectionsByElementId[oldTargetId], function (i) {\r\n                    return i[0].id === connection.id;\r\n                });\r\n\r\n            // update or add data for source\r\n            if (sIndex != -1) {\r\n                connectionsByElementId[elId][sIndex][0] = connection;\r\n                connectionsByElementId[elId][sIndex][1] = connection.endpoints[1];\r\n                connectionsByElementId[elId][sIndex][2] = connection.endpoints[1].anchor.constructor == _jp.DynamicAnchor;\r\n            }\r\n\r\n            // remove entry for previous target (if there)\r\n            if (tIndex > -1) {\r\n                connectionsByElementId[oldTargetId].splice(tIndex, 1);\r\n                // add entry for new target\r\n                _ju.addToList(connectionsByElementId, newTargetId, [connection, connection.endpoints[0], connection.endpoints[0].anchor.constructor == _jp.DynamicAnchor]);\r\n            }\r\n\r\n            connection.updateConnectedClass();\r\n        };\r\n\r\n        //\r\n        // notification that the connection given has changed source from the originalId to the newId.\r\n        // This involves:\r\n        // 1. removing the connection from the list of connections stored for the originalId\r\n        // 2. updating the source information for the target of the connection\r\n        // 3. re-registering the connection in connectionsByElementId with the newId\r\n        //\r\n        this.sourceChanged = function (originalId, newId, connection) {\r\n            if (originalId !== newId) {\r\n                // remove the entry that points from the old source to the target\r\n                _ju.removeWithFunction(connectionsByElementId[originalId], function (info) {\r\n                    return info[0].id === connection.id;\r\n                });\r\n                // find entry for target and update it\r\n                var tIdx = _ju.findWithFunction(connectionsByElementId[connection.targetId], function (i) {\r\n                    return i[0].id === connection.id;\r\n                });\r\n                if (tIdx > -1) {\r\n                    connectionsByElementId[connection.targetId][tIdx][0] = connection;\r\n                    connectionsByElementId[connection.targetId][tIdx][1] = connection.endpoints[0];\r\n                    connectionsByElementId[connection.targetId][tIdx][2] = connection.endpoints[0].anchor.constructor == _jp.DynamicAnchor;\r\n                }\r\n                // add entry for new source\r\n                _ju.addToList(connectionsByElementId, newId, [connection, connection.endpoints[1], connection.endpoints[1].anchor.constructor == _jp.DynamicAnchor]);\r\n\r\n                connection.updateConnectedClass();\r\n            }\r\n        };\r\n\r\n        //\r\n        // moves the given endpoint from `currentId` to `element`.\r\n        // This involves:\r\n        //\r\n        // 1. changing the key in _amEndpoints under which the endpoint is stored\r\n        // 2. changing the source or target values in all of the endpoint's connections\r\n        // 3. changing the array in connectionsByElementId in which the endpoint's connections\r\n        //    are stored (done by either sourceChanged or updateOtherEndpoint)\r\n        //\r\n        this.rehomeEndpoint = function (ep, currentId, element) {\r\n            var eps = _amEndpoints[currentId] || [],\r\n                elementId = jsPlumbInstance.getId(element);\r\n\r\n            if (elementId !== currentId) {\r\n                var idx = _ju.indexOf(eps, ep);\r\n                if (idx > -1) {\r\n                    var _ep = eps.splice(idx, 1)[0];\r\n                    self.add(_ep, elementId);\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < ep.connections.length; i++) {\r\n                if (ep.connections[i].sourceId == currentId) {\r\n                    ep.connections[i].sourceId = ep.elementId;\r\n                    ep.connections[i].source = ep.element;\r\n                    self.sourceChanged(currentId, ep.elementId, ep.connections[i]);\r\n                }\r\n                else if (ep.connections[i].targetId == currentId) {\r\n                    ep.connections[i].targetId = ep.elementId;\r\n                    ep.connections[i].target = ep.element;\r\n                    self.updateOtherEndpoint(ep.connections[i].sourceId, currentId, ep.elementId, ep.connections[i]);\r\n                }\r\n            }\r\n        };\r\n\r\n        this.redraw = function (elementId, ui, timestamp, offsetToUI, clearEdits, doNotRecalcEndpoint) {\r\n\r\n            if (!jsPlumbInstance.isSuspendDrawing()) {\r\n                // get all the endpoints for this element\r\n                var ep = _amEndpoints[elementId] || [],\r\n                    endpointConnections = connectionsByElementId[elementId] || [],\r\n                    connectionsToPaint = [],\r\n                    endpointsToPaint = [],\r\n                    anchorsToUpdate = [];\r\n\r\n                timestamp = timestamp || jsPlumbInstance.timestamp();\r\n                // offsetToUI are values that would have been calculated in the dragManager when registering\r\n                // an endpoint for an element that had a parent (somewhere in the hierarchy) that had been\r\n                // registered as draggable.\r\n                offsetToUI = offsetToUI || {left: 0, top: 0};\r\n                if (ui) {\r\n                    ui = {\r\n                        left: ui.left + offsetToUI.left,\r\n                        top: ui.top + offsetToUI.top\r\n                    };\r\n                }\r\n\r\n                // valid for one paint cycle.\r\n                var myOffset = jsPlumbInstance.updateOffset({ elId: elementId, offset: ui, recalc: false, timestamp: timestamp }),\r\n                    orientationCache = {};\r\n\r\n                // actually, first we should compute the orientation of this element to all other elements to which\r\n                // this element is connected with a continuous anchor (whether both ends of the connection have\r\n                // a continuous anchor or just one)\r\n\r\n                for (var i = 0; i < endpointConnections.length; i++) {\r\n                    var conn = endpointConnections[i][0],\r\n                        sourceId = conn.sourceId,\r\n                        targetId = conn.targetId,\r\n                        sourceContinuous = conn.endpoints[0].anchor.isContinuous,\r\n                        targetContinuous = conn.endpoints[1].anchor.isContinuous;\r\n\r\n                    if (sourceContinuous || targetContinuous) {\r\n                        var oKey = sourceId + \"_\" + targetId,\r\n                            o = orientationCache[oKey],\r\n                            oIdx = conn.sourceId == elementId ? 1 : 0;\r\n\r\n                        if (sourceContinuous && !anchorLists[sourceId]) anchorLists[sourceId] = { top: [], right: [], bottom: [], left: [] };\r\n                        if (targetContinuous && !anchorLists[targetId]) anchorLists[targetId] = { top: [], right: [], bottom: [], left: [] };\r\n\r\n                        if (elementId != targetId) jsPlumbInstance.updateOffset({ elId: targetId, timestamp: timestamp });\r\n                        if (elementId != sourceId) jsPlumbInstance.updateOffset({ elId: sourceId, timestamp: timestamp });\r\n\r\n                        var td = jsPlumbInstance.getCachedData(targetId),\r\n                            sd = jsPlumbInstance.getCachedData(sourceId);\r\n\r\n                        if (targetId == sourceId && (sourceContinuous || targetContinuous)) {\r\n                            // here we may want to improve this by somehow determining the face we'd like\r\n                            // to put the connector on.  ideally, when drawing, the face should be calculated\r\n                            // by determining which face is closest to the point at which the mouse button\r\n                            // was released.  for now, we're putting it on the top face.\r\n                            _updateAnchorList(\r\n                                anchorLists[sourceId],\r\n                                    -Math.PI / 2,\r\n                                0,\r\n                                conn,\r\n                                false,\r\n                                targetId,\r\n                                0, false, \"top\", sourceId, connectionsToPaint, endpointsToPaint);\r\n                        }\r\n                        else {\r\n                            if (!o) {\r\n                                o = calculateOrientation(sourceId, targetId, sd.o, td.o, conn.endpoints[0].anchor, conn.endpoints[1].anchor);\r\n                                orientationCache[oKey] = o;\r\n                                // this would be a performance enhancement, but the computed angles need to be clamped to\r\n                                //the (-PI/2 -> PI/2) range in order for the sorting to work properly.\r\n                                /*  orientationCache[oKey2] = {\r\n                                 orientation:o.orientation,\r\n                                 a:[o.a[1], o.a[0]],\r\n                                 theta:o.theta + Math.PI,\r\n                                 theta2:o.theta2 + Math.PI\r\n                                 };*/\r\n                            }\r\n                            if (sourceContinuous) _updateAnchorList(anchorLists[sourceId], o.theta, 0, conn, false, targetId, 0, false, o.a[0], sourceId, connectionsToPaint, endpointsToPaint);\r\n                            if (targetContinuous) _updateAnchorList(anchorLists[targetId], o.theta2, -1, conn, true, sourceId, 1, true, o.a[1], targetId, connectionsToPaint, endpointsToPaint);\r\n                        }\r\n\r\n                        if (sourceContinuous) _ju.addWithFunction(anchorsToUpdate, sourceId, function (a) {\r\n                            return a === sourceId;\r\n                        });\r\n                        if (targetContinuous) _ju.addWithFunction(anchorsToUpdate, targetId, function (a) {\r\n                            return a === targetId;\r\n                        });\r\n                        _ju.addWithFunction(connectionsToPaint, conn, function (c) {\r\n                            return c.id == conn.id;\r\n                        });\r\n                        if ((sourceContinuous && oIdx === 0) || (targetContinuous && oIdx === 1))\r\n                            _ju.addWithFunction(endpointsToPaint, conn.endpoints[oIdx], function (e) {\r\n                                return e.id == conn.endpoints[oIdx].id;\r\n                            });\r\n                    }\r\n                }\r\n\r\n                // place Endpoints whose anchors are continuous but have no Connections\r\n                for (i = 0; i < ep.length; i++) {\r\n                    if (ep[i].connections.length === 0 && ep[i].anchor.isContinuous) {\r\n                        if (!anchorLists[elementId]) anchorLists[elementId] = { top: [], right: [], bottom: [], left: [] };\r\n                        _updateAnchorList(anchorLists[elementId], -Math.PI / 2, 0, {endpoints: [ep[i], ep[i]], paint: function () {\r\n                        }}, false, elementId, 0, false, ep[i].anchor.getDefaultFace(), elementId, connectionsToPaint, endpointsToPaint);\r\n                        _ju.addWithFunction(anchorsToUpdate, elementId, function (a) {\r\n                            return a === elementId;\r\n                        });\r\n                    }\r\n                }\r\n\r\n\r\n                // now place all the continuous anchors we need to;\r\n                for (i = 0; i < anchorsToUpdate.length; i++) {\r\n                    placeAnchors(anchorsToUpdate[i], anchorLists[anchorsToUpdate[i]]);\r\n                }\r\n\r\n                // now that continuous anchors have been placed, paint all the endpoints for this element\r\n                // TODO performance: add the endpoint ids to a temp array, and then when iterating in the next\r\n                // loop, check that we didn't just paint that endpoint. we can probably shave off a few more milliseconds this way.\r\n                for (i = 0; i < ep.length; i++) {\r\n                    ep[i].paint({ timestamp: timestamp, offset: myOffset, dimensions: myOffset.s, recalc: doNotRecalcEndpoint !== true });\r\n                }\r\n\r\n                // ... and any other endpoints we came across as a result of the continuous anchors.\r\n                for (i = 0; i < endpointsToPaint.length; i++) {\r\n                    var cd = jsPlumbInstance.getCachedData(endpointsToPaint[i].elementId);\r\n                    endpointsToPaint[i].paint({ timestamp: timestamp, offset: cd, dimensions: cd.s });\r\n                }\r\n\r\n                // paint all the standard and \"dynamic connections\", which are connections whose other anchor is\r\n                // static and therefore does need to be recomputed; we make sure that happens only one time.\r\n\r\n                // TODO we could have compiled a list of these in the first pass through connections; might save some time.\r\n                for (i = 0; i < endpointConnections.length; i++) {\r\n                    var otherEndpoint = endpointConnections[i][1];\r\n                    if (otherEndpoint.anchor.constructor == _jp.DynamicAnchor) {\r\n                        otherEndpoint.paint({ elementWithPrecedence: elementId, timestamp: timestamp });\r\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\r\n                            return c.id == endpointConnections[i][0].id;\r\n                        });\r\n                        // all the connections for the other endpoint now need to be repainted\r\n                        for (var k = 0; k < otherEndpoint.connections.length; k++) {\r\n                            if (otherEndpoint.connections[k] !== endpointConnections[i][0])\r\n                                _ju.addWithFunction(connectionsToPaint, otherEndpoint.connections[k], function (c) {\r\n                                    return c.id == otherEndpoint.connections[k].id;\r\n                                });\r\n                        }\r\n                    } else if (otherEndpoint.anchor.constructor == _jp.Anchor) {\r\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\r\n                            return c.id == endpointConnections[i][0].id;\r\n                        });\r\n                    }\r\n                }\r\n\r\n                // paint current floating connection for this element, if there is one.\r\n                var fc = floatingConnections[elementId];\r\n                if (fc)\r\n                    fc.paint({timestamp: timestamp, recalc: false, elId: elementId});\r\n\r\n                // paint all the connections\r\n                for (i = 0; i < connectionsToPaint.length; i++) {\r\n                    connectionsToPaint[i].paint({elId: elementId, timestamp: timestamp, recalc: false, clearEdits: clearEdits});\r\n                }\r\n            }\r\n        };\r\n\r\n        var ContinuousAnchor = function (anchorParams) {\r\n            _ju.EventGenerator.apply(this);\r\n            this.type = \"Continuous\";\r\n            this.isDynamic = true;\r\n            this.isContinuous = true;\r\n            var faces = anchorParams.faces || [\"top\", \"right\", \"bottom\", \"left\"],\r\n                clockwise = !(anchorParams.clockwise === false),\r\n                availableFaces = { },\r\n                opposites = { \"top\": \"bottom\", \"right\": \"left\", \"left\": \"right\", \"bottom\": \"top\" },\r\n                clockwiseOptions = { \"top\": \"right\", \"right\": \"bottom\", \"left\": \"top\", \"bottom\": \"left\" },\r\n                antiClockwiseOptions = { \"top\": \"left\", \"right\": \"top\", \"left\": \"bottom\", \"bottom\": \"right\" },\r\n                secondBest = clockwise ? clockwiseOptions : antiClockwiseOptions,\r\n                lastChoice = clockwise ? antiClockwiseOptions : clockwiseOptions,\r\n                cssClass = anchorParams.cssClass || \"\";\r\n\r\n            for (var i = 0; i < faces.length; i++) {\r\n                availableFaces[faces[i]] = true;\r\n            }\r\n\r\n            this.getDefaultFace = function () {\r\n                return faces.length === 0 ? \"top\" : faces[0];\r\n            };\r\n\r\n            // if the given edge is supported, returns it. otherwise looks for a substitute that _is_\r\n            // supported. if none supported we also return the request edge.\r\n            this.verifyEdge = function (edge) {\r\n                if (availableFaces[edge]) return edge;\r\n                else if (availableFaces[opposites[edge]]) return opposites[edge];\r\n                else if (availableFaces[secondBest[edge]]) return secondBest[edge];\r\n                else if (availableFaces[lastChoice[edge]]) return lastChoice[edge];\r\n                return edge; // we have to give them something.\r\n            };\r\n\r\n            this.isEdgeSupported = function (edge) {\r\n                return availableFaces[edge] === true;\r\n            };\r\n\r\n            this.compute = function (params) {\r\n                return userDefinedContinuousAnchorLocations[params.element.id] || continuousAnchorLocations[params.element.id] || [0, 0];\r\n            };\r\n            this.getCurrentLocation = function (params) {\r\n                return userDefinedContinuousAnchorLocations[params.element.id] || continuousAnchorLocations[params.element.id] || [0, 0];\r\n            };\r\n            this.getOrientation = function (endpoint) {\r\n                return continuousAnchorOrientations[endpoint.id] || [0, 0];\r\n            };\r\n            this.clearUserDefinedLocation = function () {\r\n                delete userDefinedContinuousAnchorLocations[anchorParams.elementId];\r\n            };\r\n            this.setUserDefinedLocation = function (loc) {\r\n                userDefinedContinuousAnchorLocations[anchorParams.elementId] = loc;\r\n            };\r\n            this.getCssClass = function () {\r\n                return cssClass;\r\n            };\r\n        };\r\n\r\n        // continuous anchors\r\n        jsPlumbInstance.continuousAnchorFactory = {\r\n            get: function (params) {\r\n                return new ContinuousAnchor(params);\r\n            },\r\n            clear: function (elementId) {\r\n                delete userDefinedContinuousAnchorLocations[elementId];\r\n                delete continuousAnchorLocations[elementId];\r\n            }\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Anchors model a position on some element at which an Endpoint may be located.  They began as a first class citizen of jsPlumb, ie. a user\r\n     * was required to create these themselves, but over time this has been replaced by the concept of referring to them either by name (eg. \"TopMiddle\"),\r\n     * or by an array describing their coordinates (eg. [ 0, 0.5, 0, -1 ], which is the same as \"TopMiddle\").  jsPlumb now handles all of the\r\n     * creation of Anchors without user intervention.\r\n     */\r\n    _jp.Anchor = function (params) {\r\n        this.x = params.x || 0;\r\n        this.y = params.y || 0;\r\n        this.elementId = params.elementId;\r\n        this.cssClass = params.cssClass || \"\";\r\n        this.userDefinedLocation = null;\r\n        this.orientation = params.orientation || [ 0, 0 ];\r\n        this.lastReturnValue = null;\r\n        this.offsets = params.offsets || [ 0, 0 ];\r\n        this.timestamp = null;\r\n\r\n        _ju.EventGenerator.apply(this);\r\n\r\n        this.compute = function (params) {\r\n\r\n            var xy = params.xy, wh = params.wh, timestamp = params.timestamp;\r\n\r\n            if (params.clearUserDefinedLocation)\r\n                this.userDefinedLocation = null;\r\n\r\n            if (timestamp && timestamp === self.timestamp)\r\n                return this.lastReturnValue;\r\n\r\n            if (this.userDefinedLocation != null) {\r\n                this.lastReturnValue = this.userDefinedLocation;\r\n            }\r\n            else {\r\n                this.lastReturnValue = [ xy[0] + (this.x * wh[0]) + this.offsets[0], xy[1] + (this.y * wh[1]) + this.offsets[1] ];\r\n            }\r\n\r\n            this.timestamp = timestamp;\r\n            return this.lastReturnValue;\r\n        };\r\n\r\n        this.getCurrentLocation = function (params) {\r\n            return (this.lastReturnValue == null || (params.timestamp != null && this.timestamp != params.timestamp)) ? this.compute(params) : this.lastReturnValue;\r\n        };\r\n    };\r\n    _ju.extend(_jp.Anchor, _ju.EventGenerator, {\r\n        equals: function (anchor) {\r\n            if (!anchor) return false;\r\n            var ao = anchor.getOrientation(),\r\n                o = this.getOrientation();\r\n            return this.x == anchor.x && this.y == anchor.y && this.offsets[0] == anchor.offsets[0] && this.offsets[1] == anchor.offsets[1] && o[0] == ao[0] && o[1] == ao[1];\r\n        },\r\n        getUserDefinedLocation: function () {\r\n            return this.userDefinedLocation;\r\n        },\r\n        setUserDefinedLocation: function (l) {\r\n            this.userDefinedLocation = l;\r\n        },\r\n        clearUserDefinedLocation: function () {\r\n            this.userDefinedLocation = null;\r\n        },\r\n        getOrientation: function () {\r\n            return this.orientation;\r\n        },\r\n        getCssClass: function () {\r\n            return this.cssClass;\r\n        }\r\n    });\r\n\r\n    /**\r\n     * An Anchor that floats. its orientation is computed dynamically from\r\n     * its position relative to the anchor it is floating relative to.  It is used when creating\r\n     * a connection through drag and drop.\r\n     *\r\n     * TODO FloatingAnchor could totally be refactored to extend Anchor just slightly.\r\n     */\r\n    _jp.FloatingAnchor = function (params) {\r\n\r\n        _jp.Anchor.apply(this, arguments);\r\n\r\n        // this is the anchor that this floating anchor is referenced to for\r\n        // purposes of calculating the orientation.\r\n        var ref = params.reference,\r\n            // the canvas this refers to.\r\n            refCanvas = params.referenceCanvas,\r\n            size = _jp.getSize(refCanvas),\r\n            // these are used to store the current relative position of our\r\n            // anchor wrt the reference anchor. they only indicate\r\n            // direction, so have a value of 1 or -1 (or, very rarely, 0). these\r\n            // values are written by the compute method, and read\r\n            // by the getOrientation method.\r\n            xDir = 0, yDir = 0,\r\n            // temporary member used to store an orientation when the floating\r\n            // anchor is hovering over another anchor.\r\n            orientation = null,\r\n            _lastResult = null;\r\n\r\n        // clear from parent. we want floating anchor orientation to always be computed.\r\n        this.orientation = null;\r\n\r\n        // set these to 0 each; they are used by certain types of connectors in the loopback case,\r\n        // when the connector is trying to clear the element it is on. but for floating anchor it's not\r\n        // very important.\r\n        this.x = 0;\r\n        this.y = 0;\r\n\r\n        this.isFloating = true;\r\n\r\n        this.compute = function (params) {\r\n            var xy = params.xy,\r\n                result = [ xy[0] + (size[0] / 2), xy[1] + (size[1] / 2) ]; // return origin of the element. we may wish to improve this so that any object can be the drag proxy.\r\n            _lastResult = result;\r\n            return result;\r\n        };\r\n\r\n        this.getOrientation = function (_endpoint) {\r\n            if (orientation) return orientation;\r\n            else {\r\n                var o = ref.getOrientation(_endpoint);\r\n                // here we take into account the orientation of the other\r\n                // anchor: if it declares zero for some direction, we declare zero too. this might not be the most awesome. perhaps we can come\r\n                // up with a better way. it's just so that the line we draw looks like it makes sense. maybe this wont make sense.\r\n                return [ Math.abs(o[0]) * xDir * -1,\r\n                        Math.abs(o[1]) * yDir * -1 ];\r\n            }\r\n        };\r\n\r\n        /**\r\n         * notification the endpoint associated with this anchor is hovering\r\n         * over another anchor; we want to assume that anchor's orientation\r\n         * for the duration of the hover.\r\n         */\r\n        this.over = function (anchor, endpoint) {\r\n            orientation = anchor.getOrientation(endpoint);\r\n        };\r\n\r\n        /**\r\n         * notification the endpoint associated with this anchor is no\r\n         * longer hovering over another anchor; we should resume calculating\r\n         * orientation as we normally do.\r\n         */\r\n        this.out = function () {\r\n            orientation = null;\r\n        };\r\n\r\n        this.getCurrentLocation = function (params) {\r\n            return _lastResult == null ? this.compute(params) : _lastResult;\r\n        };\r\n    };\r\n    _ju.extend(_jp.FloatingAnchor, _jp.Anchor);\r\n\r\n    var _convertAnchor = function (anchor, jsPlumbInstance, elementId) {\r\n        return anchor.constructor == _jp.Anchor ? anchor : jsPlumbInstance.makeAnchor(anchor, elementId, jsPlumbInstance);\r\n    };\r\n\r\n    /* \r\n     * A DynamicAnchor is an Anchor that contains a list of other Anchors, which it cycles\r\n     * through at compute time to find the one that is located closest to\r\n     * the center of the target element, and returns that Anchor's compute\r\n     * method result. this causes endpoints to follow each other with\r\n     * respect to the orientation of their target elements, which is a useful\r\n     * feature for some applications.\r\n     * \r\n     */\r\n    _jp.DynamicAnchor = function (params) {\r\n        _jp.Anchor.apply(this, arguments);\r\n\r\n        this.isDynamic = true;\r\n        this.anchors = [];\r\n        this.elementId = params.elementId;\r\n        this.jsPlumbInstance = params.jsPlumbInstance;\r\n\r\n        for (var i = 0; i < params.anchors.length; i++)\r\n            this.anchors[i] = _convertAnchor(params.anchors[i], this.jsPlumbInstance, this.elementId);\r\n\r\n        this.getAnchors = function () {\r\n            return this.anchors;\r\n        };\r\n        this.locked = false;\r\n        var _curAnchor = this.anchors.length > 0 ? this.anchors[0] : null,\r\n            _lastAnchor = _curAnchor,\r\n            self = this,\r\n\r\n        // helper method to calculate the distance between the centers of the two elements.\r\n            _distance = function (anchor, cx, cy, xy, wh) {\r\n                var ax = xy[0] + (anchor.x * wh[0]), ay = xy[1] + (anchor.y * wh[1]),\r\n                    acx = xy[0] + (wh[0] / 2), acy = xy[1] + (wh[1] / 2);\r\n                return (Math.sqrt(Math.pow(cx - ax, 2) + Math.pow(cy - ay, 2)) +\r\n                    Math.sqrt(Math.pow(acx - ax, 2) + Math.pow(acy - ay, 2)));\r\n            },\r\n        // default method uses distance between element centers.  you can provide your own method in the dynamic anchor\r\n        // constructor (and also to jsPlumb.makeDynamicAnchor). the arguments to it are four arrays:\r\n        // xy - xy loc of the anchor's element\r\n        // wh - anchor's element's dimensions\r\n        // txy - xy loc of the element of the other anchor in the connection\r\n        // twh - dimensions of the element of the other anchor in the connection.\r\n        // anchors - the list of selectable anchors\r\n            _anchorSelector = params.selector || function (xy, wh, txy, twh, anchors) {\r\n                var cx = txy[0] + (twh[0] / 2), cy = txy[1] + (twh[1] / 2);\r\n                var minIdx = -1, minDist = Infinity;\r\n                for (var i = 0; i < anchors.length; i++) {\r\n                    var d = _distance(anchors[i], cx, cy, xy, wh);\r\n                    if (d < minDist) {\r\n                        minIdx = i + 0;\r\n                        minDist = d;\r\n                    }\r\n                }\r\n                return anchors[minIdx];\r\n            };\r\n\r\n        this.compute = function (params) {\r\n            var xy = params.xy, wh = params.wh, txy = params.txy, twh = params.twh;\r\n\r\n            this.timestamp = params.timestamp;\r\n\r\n            var udl = self.getUserDefinedLocation();\r\n            if (udl != null) {\r\n                return udl;\r\n            }\r\n\r\n            // if anchor is locked or an opposite element was not given, we\r\n            // maintain our state. anchor will be locked\r\n            // if it is the source of a drag and drop.\r\n            if (this.locked || txy == null || twh == null)\r\n                return _curAnchor.compute(params);\r\n            else\r\n                params.timestamp = null; // otherwise clear this, i think. we want the anchor to compute.\r\n\r\n            _curAnchor = _anchorSelector(xy, wh, txy, twh, this.anchors);\r\n            this.x = _curAnchor.x;\r\n            this.y = _curAnchor.y;\r\n\r\n            if (_curAnchor != _lastAnchor)\r\n                this.fire(\"anchorChanged\", _curAnchor);\r\n\r\n            _lastAnchor = _curAnchor;\r\n\r\n            return _curAnchor.compute(params);\r\n        };\r\n\r\n        this.getCurrentLocation = function (params) {\r\n            return this.getUserDefinedLocation() || (_curAnchor != null ? _curAnchor.getCurrentLocation(params) : null);\r\n        };\r\n\r\n        this.getOrientation = function (_endpoint) {\r\n            return _curAnchor != null ? _curAnchor.getOrientation(_endpoint) : [ 0, 0 ];\r\n        };\r\n        this.over = function (anchor, endpoint) {\r\n            if (_curAnchor != null) _curAnchor.over(anchor, endpoint);\r\n        };\r\n        this.out = function () {\r\n            if (_curAnchor != null) _curAnchor.out();\r\n        };\r\n\r\n        this.getCssClass = function () {\r\n            return (_curAnchor && _curAnchor.getCssClass()) || \"\";\r\n        };\r\n    };\r\n    _ju.extend(_jp.DynamicAnchor, _jp.Anchor);\r\n\r\n// -------- basic anchors ------------------    \r\n    var _curryAnchor = function (x, y, ox, oy, type, fnInit) {\r\n        _jp.Anchors[type] = function (params) {\r\n            var a = params.jsPlumbInstance.makeAnchor([ x, y, ox, oy, 0, 0 ], params.elementId, params.jsPlumbInstance);\r\n            a.type = type;\r\n            if (fnInit) fnInit(a, params);\r\n            return a;\r\n        };\r\n    };\r\n\r\n    _curryAnchor(0.5, 0, 0, -1, \"TopCenter\");\r\n    _curryAnchor(0.5, 1, 0, 1, \"BottomCenter\");\r\n    _curryAnchor(0, 0.5, -1, 0, \"LeftMiddle\");\r\n    _curryAnchor(1, 0.5, 1, 0, \"RightMiddle\");\r\n\r\n    _curryAnchor(0.5, 0, 0, -1, \"Top\");\r\n    _curryAnchor(0.5, 1, 0, 1, \"Bottom\");\r\n    _curryAnchor(0, 0.5, -1, 0, \"Left\");\r\n    _curryAnchor(1, 0.5, 1, 0, \"Right\");\r\n    _curryAnchor(0.5, 0.5, 0, 0, \"Center\");\r\n    _curryAnchor(1, 0, 0, -1, \"TopRight\");\r\n    _curryAnchor(1, 1, 0, 1, \"BottomRight\");\r\n    _curryAnchor(0, 0, 0, -1, \"TopLeft\");\r\n    _curryAnchor(0, 1, 0, 1, \"BottomLeft\");\r\n\r\n// ------- dynamic anchors -------------------    \r\n\r\n    // default dynamic anchors chooses from Top, Right, Bottom, Left\r\n    _jp.Defaults.DynamicAnchors = function (params) {\r\n        return params.jsPlumbInstance.makeAnchors([\"TopCenter\", \"RightMiddle\", \"BottomCenter\", \"LeftMiddle\"], params.elementId, params.jsPlumbInstance);\r\n    };\r\n\r\n    // default dynamic anchors bound to name 'AutoDefault'\r\n    _jp.Anchors.AutoDefault = function (params) {\r\n        var a = params.jsPlumbInstance.makeDynamicAnchor(_jp.Defaults.DynamicAnchors(params));\r\n        a.type = \"AutoDefault\";\r\n        return a;\r\n    };\r\n\r\n// ------- continuous anchors -------------------    \r\n\r\n    var _curryContinuousAnchor = function (type, faces) {\r\n        _jp.Anchors[type] = function (params) {\r\n            var a = params.jsPlumbInstance.makeAnchor([\"Continuous\", { faces: faces }], params.elementId, params.jsPlumbInstance);\r\n            a.type = type;\r\n            return a;\r\n        };\r\n    };\r\n\r\n    _jp.Anchors.Continuous = function (params) {\r\n        return params.jsPlumbInstance.continuousAnchorFactory.get(params);\r\n    };\r\n\r\n    _curryContinuousAnchor(\"ContinuousLeft\", [\"left\"]);\r\n    _curryContinuousAnchor(\"ContinuousTop\", [\"top\"]);\r\n    _curryContinuousAnchor(\"ContinuousBottom\", [\"bottom\"]);\r\n    _curryContinuousAnchor(\"ContinuousRight\", [\"right\"]);\r\n\r\n// ------- position assign anchors -------------------    \r\n\r\n    // this anchor type lets you assign the position at connection time.\r\n    _curryAnchor(0, 0, 0, 0, \"Assign\", function (anchor, params) {\r\n        // find what to use as the \"position finder\". the user may have supplied a String which represents\r\n        // the id of a position finder in jsPlumb.AnchorPositionFinders, or the user may have supplied the\r\n        // position finder as a function.  we find out what to use and then set it on the anchor.\r\n        var pf = params.position || \"Fixed\";\r\n        anchor.positionFinder = pf.constructor == String ? params.jsPlumbInstance.AnchorPositionFinders[pf] : pf;\r\n        // always set the constructor params; the position finder might need them later (the Grid one does,\r\n        // for example)\r\n        anchor.constructorParams = params;\r\n    });\r\n\r\n    // these are the default anchor positions finders, which are used by the makeTarget function.  supplying\r\n    // a position finder argument to that function allows you to specify where the resulting anchor will\r\n    // be located\r\n    jsPlumbInstance.prototype.AnchorPositionFinders = {\r\n        \"Fixed\": function (dp, ep, es) {\r\n            return [ (dp.left - ep.left) / es[0], (dp.top - ep.top) / es[1] ];\r\n        },\r\n        \"Grid\": function (dp, ep, es, params) {\r\n            var dx = dp.left - ep.left, dy = dp.top - ep.top,\r\n                gx = es[0] / (params.grid[0]), gy = es[1] / (params.grid[1]),\r\n                mx = Math.floor(dx / gx), my = Math.floor(dy / gy);\r\n            return [ ((mx * gx) + (gx / 2)) / es[0], ((my * gy) + (gy / 2)) / es[1] ];\r\n        }\r\n    };\r\n\r\n// ------- perimeter anchors -------------------    \r\n\r\n    _jp.Anchors.Perimeter = function (params) {\r\n        params = params || {};\r\n        var anchorCount = params.anchorCount || 60,\r\n            shape = params.shape;\r\n\r\n        if (!shape) throw new Error(\"no shape supplied to Perimeter Anchor type\");\r\n\r\n        var _circle = function () {\r\n                var r = 0.5, step = Math.PI * 2 / anchorCount, current = 0, a = [];\r\n                for (var i = 0; i < anchorCount; i++) {\r\n                    var x = r + (r * Math.sin(current)),\r\n                        y = r + (r * Math.cos(current));\r\n                    a.push([ x, y, 0, 0 ]);\r\n                    current += step;\r\n                }\r\n                return a;\r\n            },\r\n            _path = function (segments) {\r\n                var anchorsPerFace = anchorCount / segments.length, a = [],\r\n                    _computeFace = function (x1, y1, x2, y2, fractionalLength) {\r\n                        anchorsPerFace = anchorCount * fractionalLength;\r\n                        var dx = (x2 - x1) / anchorsPerFace, dy = (y2 - y1) / anchorsPerFace;\r\n                        for (var i = 0; i < anchorsPerFace; i++) {\r\n                            a.push([\r\n                                    x1 + (dx * i),\r\n                                    y1 + (dy * i),\r\n                                0,\r\n                                0\r\n                            ]);\r\n                        }\r\n                    };\r\n\r\n                for (var i = 0; i < segments.length; i++)\r\n                    _computeFace.apply(null, segments[i]);\r\n\r\n                return a;\r\n            },\r\n            _shape = function (faces) {\r\n                var s = [];\r\n                for (var i = 0; i < faces.length; i++) {\r\n                    s.push([faces[i][0], faces[i][1], faces[i][2], faces[i][3], 1 / faces.length]);\r\n                }\r\n                return _path(s);\r\n            },\r\n            _rectangle = function () {\r\n                return _shape([\r\n                    [ 0, 0, 1, 0 ],\r\n                    [ 1, 0, 1, 1 ],\r\n                    [ 1, 1, 0, 1 ],\r\n                    [ 0, 1, 0, 0 ]\r\n                ]);\r\n            };\r\n\r\n        var _shapes = {\r\n                \"Circle\": _circle,\r\n                \"Ellipse\": _circle,\r\n                \"Diamond\": function () {\r\n                    return _shape([\r\n                        [ 0.5, 0, 1, 0.5 ],\r\n                        [ 1, 0.5, 0.5, 1 ],\r\n                        [ 0.5, 1, 0, 0.5 ],\r\n                        [ 0, 0.5, 0.5, 0 ]\r\n                    ]);\r\n                },\r\n                \"Rectangle\": _rectangle,\r\n                \"Square\": _rectangle,\r\n                \"Triangle\": function () {\r\n                    return _shape([\r\n                        [ 0.5, 0, 1, 1 ],\r\n                        [ 1, 1, 0, 1 ],\r\n                        [ 0, 1, 0.5, 0]\r\n                    ]);\r\n                },\r\n                \"Path\": function (params) {\r\n                    var points = params.points, p = [], tl = 0;\r\n                    for (var i = 0; i < points.length - 1; i++) {\r\n                        var l = Math.sqrt(Math.pow(points[i][2] - points[i][0]) + Math.pow(points[i][3] - points[i][1]));\r\n                        tl += l;\r\n                        p.push([points[i][0], points[i][1], points[i + 1][0], points[i + 1][1], l]);\r\n                    }\r\n                    for (var j = 0; j < p.length; j++) {\r\n                        p[j][4] = p[j][4] / tl;\r\n                    }\r\n                    return _path(p);\r\n                }\r\n            },\r\n            _rotate = function (points, amountInDegrees) {\r\n                var o = [], theta = amountInDegrees / 180 * Math.PI;\r\n                for (var i = 0; i < points.length; i++) {\r\n                    var _x = points[i][0] - 0.5,\r\n                        _y = points[i][1] - 0.5;\r\n\r\n                    o.push([\r\n                            0.5 + ((_x * Math.cos(theta)) - (_y * Math.sin(theta))),\r\n                            0.5 + ((_x * Math.sin(theta)) + (_y * Math.cos(theta))),\r\n                        points[i][2],\r\n                        points[i][3]\r\n                    ]);\r\n                }\r\n                return o;\r\n            };\r\n\r\n        if (!_shapes[shape]) throw new Error(\"Shape [\" + shape + \"] is unknown by Perimeter Anchor type\");\r\n\r\n        var da = _shapes[shape](params);\r\n        if (params.rotation) da = _rotate(da, params.rotation);\r\n        var a = params.jsPlumbInstance.makeDynamicAnchor(da);\r\n        a.type = \"Perimeter\";\r\n        return a;\r\n    };\r\n}).call(this);\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the default Connectors, Endpoint and Overlay definitions.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil, _jg = root.Biltong;\r\n\r\n    _jp.Segments = {\r\n\r\n        /*\r\n         * Class: AbstractSegment\r\n         * A Connector is made up of 1..N Segments, each of which has a Type, such as 'Straight', 'Arc',\r\n         * 'Bezier'. This is new from 1.4.2, and gives us a lot more flexibility when drawing connections: things such\r\n         * as rounded corners for flowchart connectors, for example, or a straight line stub for Bezier connections, are\r\n         * much easier to do now.\r\n         *\r\n         * A Segment is responsible for providing coordinates for painting it, and also must be able to report its length.\r\n         * \r\n         */\r\n        AbstractSegment: function (params) {\r\n            this.params = params;\r\n\r\n            /**\r\n             * Function: findClosestPointOnPath\r\n             * Finds the closest point on this segment to the given [x, y],\r\n             * returning both the x and y of the point plus its distance from\r\n             * the supplied point, and its location along the length of the\r\n             * path inscribed by the segment.  This implementation returns\r\n             * Infinity for distance and null values for everything else;\r\n             * subclasses are expected to override.\r\n             */\r\n            this.findClosestPointOnPath = function (x, y) {\r\n                return {\r\n                    d: Infinity,\r\n                    x: null,\r\n                    y: null,\r\n                    l: null\r\n                };\r\n            };\r\n\r\n            this.getBounds = function () {\r\n                return {\r\n                    minX: Math.min(params.x1, params.x2),\r\n                    minY: Math.min(params.y1, params.y2),\r\n                    maxX: Math.max(params.x1, params.x2),\r\n                    maxY: Math.max(params.y1, params.y2)\r\n                };\r\n            };\r\n        },\r\n        Straight: function (params) {\r\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\r\n                length, m, m2, x1, x2, y1, y2,\r\n                _recalc = function () {\r\n                    length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\r\n                    m = _jg.gradient({x: x1, y: y1}, {x: x2, y: y2});\r\n                    m2 = -1 / m;\r\n                };\r\n\r\n            this.type = \"Straight\";\r\n\r\n            this.getLength = function () {\r\n                return length;\r\n            };\r\n            this.getGradient = function () {\r\n                return m;\r\n            };\r\n\r\n            this.getCoordinates = function () {\r\n                return { x1: x1, y1: y1, x2: x2, y2: y2 };\r\n            };\r\n            this.setCoordinates = function (coords) {\r\n                x1 = coords.x1;\r\n                y1 = coords.y1;\r\n                x2 = coords.x2;\r\n                y2 = coords.y2;\r\n                _recalc();\r\n            };\r\n            this.setCoordinates({x1: params.x1, y1: params.y1, x2: params.x2, y2: params.y2});\r\n\r\n            this.getBounds = function () {\r\n                return {\r\n                    minX: Math.min(x1, x2),\r\n                    minY: Math.min(y1, y2),\r\n                    maxX: Math.max(x1, x2),\r\n                    maxY: Math.max(y1, y2)\r\n                };\r\n            };\r\n\r\n            /**\r\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\r\n             * 0 to 1 inclusive. for the straight line segment this is simple maths.\r\n             */\r\n            this.pointOnPath = function (location, absolute) {\r\n                if (location === 0 && !absolute)\r\n                    return { x: x1, y: y1 };\r\n                else if (location == 1 && !absolute)\r\n                    return { x: x2, y: y2 };\r\n                else {\r\n                    var l = absolute ? location > 0 ? location : length + location : location * length;\r\n                    return _jg.pointOnLine({x: x1, y: y1}, {x: x2, y: y2}, l);\r\n                }\r\n            };\r\n\r\n            /**\r\n             * returns the gradient of the segment at the given point - which for us is constant.\r\n             */\r\n            this.gradientAtPoint = function (_) {\r\n                return m;\r\n            };\r\n\r\n            /**\r\n             * returns the point on the segment's path that is 'distance' along the length of the path from 'location', where\r\n             * 'location' is a decimal from 0 to 1 inclusive, and 'distance' is a number of pixels.\r\n             * this hands off to jsPlumbUtil to do the maths, supplying two points and the distance.\r\n             */\r\n            this.pointAlongPathFrom = function (location, distance, absolute) {\r\n                var p = this.pointOnPath(location, absolute),\r\n                    farAwayPoint = distance <= 0 ? {x: x1, y: y1} : {x: x2, y: y2 };\r\n\r\n                /*\r\n                 location == 1 ? {\r\n                 x:x1 + ((x2 - x1) * 10),\r\n                 y:y1 + ((y1 - y2) * 10)\r\n                 } :\r\n                 */\r\n\r\n                if (distance <= 0 && Math.abs(distance) > 1) distance *= -1;\r\n\r\n                return _jg.pointOnLine(p, farAwayPoint, distance);\r\n            };\r\n\r\n            // is c between a and b?\r\n            var within = function (a, b, c) {\r\n                return c >= Math.min(a, b) && c <= Math.max(a, b);\r\n            };\r\n            // find which of a and b is closest to c\r\n            var closest = function (a, b, c) {\r\n                return Math.abs(c - a) < Math.abs(c - b) ? a : b;\r\n            };\r\n\r\n            /**\r\n             Function: findClosestPointOnPath\r\n             Finds the closest point on this segment to [x,y]. See\r\n             notes on this method in AbstractSegment.\r\n             */\r\n            this.findClosestPointOnPath = function (x, y) {\r\n                var out = {\r\n                    d: Infinity,\r\n                    x: null,\r\n                    y: null,\r\n                    l: null,\r\n                    x1: x1,\r\n                    x2: x2,\r\n                    y1: y1,\r\n                    y2: y2\r\n                };\r\n\r\n                if (m === 0) {\r\n                    out.y = y1;\r\n                    out.x = within(x1, x2, x) ? x : closest(x1, x2, x);\r\n                }\r\n                else if (m == Infinity || m == -Infinity) {\r\n                    out.x = x1;\r\n                    out.y = within(y1, y2, y) ? y : closest(y1, y2, y);\r\n                }\r\n                else {\r\n                    // closest point lies on normal from given point to this line.  \r\n                    var b = y1 - (m * x1),\r\n                        b2 = y - (m2 * x),\r\n                    // y1 = m.x1 + b and y1 = m2.x1 + b2\r\n                    // so m.x1 + b = m2.x1 + b2\r\n                    // x1(m - m2) = b2 - b\r\n                    // x1 = (b2 - b) / (m - m2)\r\n                        _x1 = (b2 - b) / (m - m2),\r\n                        _y1 = (m * _x1) + b;\r\n\r\n                    out.x = within(x1, x2, _x1) ? _x1 : closest(x1, x2, _x1);//_x1;\r\n                    out.y = within(y1, y2, _y1) ? _y1 : closest(y1, y2, _y1);//_y1;\r\n                }\r\n\r\n                var fractionInSegment = _jg.lineLength([ out.x, out.y ], [ x1, y1 ]);\r\n                out.d = _jg.lineLength([x, y], [out.x, out.y]);\r\n                out.l = fractionInSegment / length;\r\n                return out;\r\n            };\r\n        },\r\n\r\n        /*\r\n         Arc Segment. You need to supply:\r\n\r\n         r   -   radius\r\n         cx  -   center x for the arc\r\n         cy  -   center y for the arc\r\n         ac  -   whether the arc is anticlockwise or not. default is clockwise.\r\n\r\n         and then either:\r\n\r\n         startAngle  -   startAngle for the arc.\r\n         endAngle    -   endAngle for the arc.\r\n\r\n         or:\r\n\r\n         x1          -   x for start point\r\n         y1          -   y for start point\r\n         x2          -   x for end point\r\n         y2          -   y for end point\r\n\r\n         */\r\n        Arc: function (params) {\r\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\r\n                _calcAngle = function (_x, _y) {\r\n                    return _jg.theta([params.cx, params.cy], [_x, _y]);\r\n                },\r\n                _calcAngleForLocation = function (segment, location) {\r\n                    if (segment.anticlockwise) {\r\n                        var sa = segment.startAngle < segment.endAngle ? segment.startAngle + TWO_PI : segment.startAngle,\r\n                            s = Math.abs(sa - segment.endAngle);\r\n                        return sa - (s * location);\r\n                    }\r\n                    else {\r\n                        var ea = segment.endAngle < segment.startAngle ? segment.endAngle + TWO_PI : segment.endAngle,\r\n                            ss = Math.abs(ea - segment.startAngle);\r\n\r\n                        return segment.startAngle + (ss * location);\r\n                    }\r\n                },\r\n                TWO_PI = 2 * Math.PI;\r\n\r\n            this.radius = params.r;\r\n            this.anticlockwise = params.ac;\r\n            this.type = \"Arc\";\r\n\r\n            if (params.startAngle && params.endAngle) {\r\n                this.startAngle = params.startAngle;\r\n                this.endAngle = params.endAngle;\r\n                this.x1 = params.cx + (this.radius * Math.cos(params.startAngle));\r\n                this.y1 = params.cy + (this.radius * Math.sin(params.startAngle));\r\n                this.x2 = params.cx + (this.radius * Math.cos(params.endAngle));\r\n                this.y2 = params.cy + (this.radius * Math.sin(params.endAngle));\r\n            }\r\n            else {\r\n                this.startAngle = _calcAngle(params.x1, params.y1);\r\n                this.endAngle = _calcAngle(params.x2, params.y2);\r\n                this.x1 = params.x1;\r\n                this.y1 = params.y1;\r\n                this.x2 = params.x2;\r\n                this.y2 = params.y2;\r\n            }\r\n\r\n            if (this.endAngle < 0) this.endAngle += TWO_PI;\r\n            if (this.startAngle < 0) this.startAngle += TWO_PI;\r\n\r\n            // segment is used by vml     \r\n            this.segment = _jg.quadrant([this.x1, this.y1], [this.x2, this.y2]);\r\n\r\n            // we now have startAngle and endAngle as positive numbers, meaning the\r\n            // absolute difference (|d|) between them is the sweep (s) of this arc, unless the\r\n            // arc is 'anticlockwise' in which case 's' is given by 2PI - |d|.\r\n\r\n            var ea = this.endAngle < this.startAngle ? this.endAngle + TWO_PI : this.endAngle;\r\n            this.sweep = Math.abs(ea - this.startAngle);\r\n            if (this.anticlockwise) this.sweep = TWO_PI - this.sweep;\r\n            var circumference = 2 * Math.PI * this.radius,\r\n                frac = this.sweep / TWO_PI,\r\n                length = circumference * frac;\r\n\r\n            this.getLength = function () {\r\n                return length;\r\n            };\r\n\r\n            this.getBounds = function () {\r\n                return {\r\n                    minX: params.cx - params.r,\r\n                    maxX: params.cx + params.r,\r\n                    minY: params.cy - params.r,\r\n                    maxY: params.cy + params.r\r\n                };\r\n            };\r\n\r\n            var VERY_SMALL_VALUE = 0.0000000001,\r\n                gentleRound = function (n) {\r\n                    var f = Math.floor(n), r = Math.ceil(n);\r\n                    if (n - f < VERY_SMALL_VALUE)\r\n                        return f;\r\n                    else if (r - n < VERY_SMALL_VALUE)\r\n                        return r;\r\n                    return n;\r\n                };\r\n\r\n            /**\r\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\r\n             * 0 to 1 inclusive.\r\n             */\r\n            this.pointOnPath = function (location, absolute) {\r\n\r\n                if (location === 0) {\r\n                    return { x: this.x1, y: this.y1, theta: this.startAngle };\r\n                }\r\n                else if (location == 1) {\r\n                    return { x: this.x2, y: this.y2, theta: this.endAngle };\r\n                }\r\n\r\n                if (absolute) {\r\n                    location = location / length;\r\n                }\r\n\r\n                var angle = _calcAngleForLocation(this, location),\r\n                    _x = params.cx + (params.r * Math.cos(angle)),\r\n                    _y = params.cy + (params.r * Math.sin(angle));\r\n\r\n                return { x: gentleRound(_x), y: gentleRound(_y), theta: angle };\r\n            };\r\n\r\n            /**\r\n             * returns the gradient of the segment at the given point.\r\n             */\r\n            this.gradientAtPoint = function (location, absolute) {\r\n                var p = this.pointOnPath(location, absolute);\r\n                var m = _jg.normal([ params.cx, params.cy ], [p.x, p.y ]);\r\n                if (!this.anticlockwise && (m == Infinity || m == -Infinity)) m *= -1;\r\n                return m;\r\n            };\r\n\r\n            this.pointAlongPathFrom = function (location, distance, absolute) {\r\n                var p = this.pointOnPath(location, absolute),\r\n                    arcSpan = distance / circumference * 2 * Math.PI,\r\n                    dir = this.anticlockwise ? -1 : 1,\r\n                    startAngle = p.theta + (dir * arcSpan),\r\n                    startX = params.cx + (this.radius * Math.cos(startAngle)),\r\n                    startY = params.cy + (this.radius * Math.sin(startAngle));\r\n\r\n                return {x: startX, y: startY};\r\n            };\r\n        },\r\n\r\n        Bezier: function (params) {\r\n            this.curve = [\r\n                { x: params.x1, y: params.y1},\r\n                { x: params.cp1x, y: params.cp1y },\r\n                { x: params.cp2x, y: params.cp2y },\r\n                { x: params.x2, y: params.y2 }\r\n            ];\r\n\r\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments);\r\n            // although this is not a strictly rigorous determination of bounds\r\n            // of a bezier curve, it works for the types of curves that this segment\r\n            // type produces.\r\n            this.bounds = {\r\n                minX: Math.min(params.x1, params.x2, params.cp1x, params.cp2x),\r\n                minY: Math.min(params.y1, params.y2, params.cp1y, params.cp2y),\r\n                maxX: Math.max(params.x1, params.x2, params.cp1x, params.cp2x),\r\n                maxY: Math.max(params.y1, params.y2, params.cp1y, params.cp2y)\r\n            };\r\n\r\n            this.type = \"Bezier\";\r\n\r\n            var _translateLocation = function (_curve, location, absolute) {\r\n                if (absolute)\r\n                    location = root.jsBezier.locationAlongCurveFrom(_curve, location > 0 ? 0 : 1, location);\r\n\r\n                return location;\r\n            };\r\n\r\n            /**\r\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\r\n             * 0 to 1 inclusive.\r\n             */\r\n            this.pointOnPath = function (location, absolute) {\r\n                location = _translateLocation(this.curve, location, absolute);\r\n                return root.jsBezier.pointOnCurve(this.curve, location);\r\n            };\r\n\r\n            /**\r\n             * returns the gradient of the segment at the given point.\r\n             */\r\n            this.gradientAtPoint = function (location, absolute) {\r\n                location = _translateLocation(this.curve, location, absolute);\r\n                return root.jsBezier.gradientAtPoint(this.curve, location);\r\n            };\r\n\r\n            this.pointAlongPathFrom = function (location, distance, absolute) {\r\n                location = _translateLocation(this.curve, location, absolute);\r\n                return root.jsBezier.pointAlongCurveFrom(this.curve, location, distance);\r\n            };\r\n\r\n            this.getLength = function () {\r\n                return root.jsBezier.getLength(this.curve);\r\n            };\r\n\r\n            this.getBounds = function () {\r\n                return this.bounds;\r\n            };\r\n        }\r\n    };\r\n\r\n    /*\r\n     Class: AbstractComponent\r\n     Superclass for AbstractConnector and AbstractEndpoint.\r\n     */\r\n    var AbstractComponent = function () {\r\n        this.resetBounds = function () {\r\n            this.bounds = { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity };\r\n        };\r\n        this.resetBounds();\r\n    };\r\n\r\n    /*\r\n     * Class: AbstractConnector\r\n     * Superclass for all Connectors; here is where Segments are managed.  This is exposed on jsPlumb just so it\r\n     * can be accessed from other files. You should not try to instantiate one of these directly.\r\n     *\r\n     * When this class is asked for a pointOnPath, or gradient etc, it must first figure out which segment to dispatch\r\n     * that request to. This is done by keeping track of the total connector length as segments are added, and also\r\n     * their cumulative ratios to the total length.  Then when the right segment is found it is a simple case of dispatching\r\n     * the request to it (and adjusting 'location' so that it is relative to the beginning of that segment.)\r\n     */\r\n    _jp.Connectors.AbstractConnector = function (params) {\r\n\r\n        AbstractComponent.apply(this, arguments);\r\n\r\n        var segments = [],\r\n            totalLength = 0,\r\n            segmentProportions = [],\r\n            segmentProportionalLengths = [],\r\n            stub = params.stub || 0,\r\n            sourceStub = _ju.isArray(stub) ? stub[0] : stub,\r\n            targetStub = _ju.isArray(stub) ? stub[1] : stub,\r\n            gap = params.gap || 0,\r\n            sourceGap = _ju.isArray(gap) ? gap[0] : gap,\r\n            targetGap = _ju.isArray(gap) ? gap[1] : gap,\r\n            userProvidedSegments = null,\r\n            edited = false,\r\n            paintInfo = null;\r\n\r\n        // to be overridden by subclasses.\r\n        this.getPath = function () {\r\n        };\r\n        this.setPath = function (path) {\r\n        };\r\n\r\n        /**\r\n         * Function: findSegmentForPoint\r\n         * Returns the segment that is closest to the given [x,y],\r\n         * null if nothing found.  This function returns a JS\r\n         * object with:\r\n         *\r\n         *   d   -   distance from segment\r\n         *   l   -   proportional location in segment\r\n         *   x   -   x point on the segment\r\n         *   y   -   y point on the segment\r\n         *   s   -   the segment itself.\r\n         */\r\n        this.findSegmentForPoint = function (x, y) {\r\n            var out = { d: Infinity, s: null, x: null, y: null, l: null };\r\n            for (var i = 0; i < segments.length; i++) {\r\n                var _s = segments[i].findClosestPointOnPath(x, y);\r\n                if (_s.d < out.d) {\r\n                    out.d = _s.d;\r\n                    out.l = _s.l;\r\n                    out.x = _s.x;\r\n                    out.y = _s.y;\r\n                    out.s = segments[i];\r\n                    out.x1 = _s.x1;\r\n                    out.x2 = _s.x2;\r\n                    out.y1 = _s.y1;\r\n                    out.y2 = _s.y2;\r\n                    out.index = i;\r\n                }\r\n            }\r\n\r\n            return out;\r\n        };\r\n\r\n        var _updateSegmentProportions = function () {\r\n                var curLoc = 0;\r\n                for (var i = 0; i < segments.length; i++) {\r\n                    var sl = segments[i].getLength();\r\n                    segmentProportionalLengths[i] = sl / totalLength;\r\n                    segmentProportions[i] = [curLoc, (curLoc += (sl / totalLength)) ];\r\n                }\r\n            },\r\n\r\n            /**\r\n             * returns [segment, proportion of travel in segment, segment index] for the segment\r\n             * that contains the point which is 'location' distance along the entire path, where\r\n             * 'location' is a decimal between 0 and 1 inclusive. in this connector type, paths\r\n             * are made up of a list of segments, each of which contributes some fraction to\r\n             * the total length.\r\n             * From 1.3.10 this also supports the 'absolute' property, which lets us specify a location\r\n             * as the absolute distance in pixels, rather than a proportion of the total path.\r\n             */\r\n            _findSegmentForLocation = function (location, absolute) {\r\n                if (absolute) {\r\n                    location = location > 0 ? location / totalLength : (totalLength + location) / totalLength;\r\n                }\r\n                var idx = segmentProportions.length - 1, inSegmentProportion = 1;\r\n                for (var i = 0; i < segmentProportions.length; i++) {\r\n                    if (segmentProportions[i][1] >= location) {\r\n                        idx = i;\r\n                        // todo is this correct for all connector path types?\r\n                        inSegmentProportion = location == 1 ? 1 : location === 0 ? 0 : (location - segmentProportions[i][0]) / segmentProportionalLengths[i];\r\n                        break;\r\n                    }\r\n                }\r\n                return { segment: segments[idx], proportion: inSegmentProportion, index: idx };\r\n            },\r\n            _addSegment = function (conn, type, params) {\r\n                if (params.x1 == params.x2 && params.y1 == params.y2) return;\r\n                var s = new _jp.Segments[type](params);\r\n                segments.push(s);\r\n                totalLength += s.getLength();\r\n                conn.updateBounds(s);\r\n            },\r\n            _clearSegments = function () {\r\n                totalLength = segments.length = segmentProportions.length = segmentProportionalLengths.length = 0;\r\n            };\r\n\r\n        this.setSegments = function (_segs) {\r\n            userProvidedSegments = [];\r\n            totalLength = 0;\r\n            for (var i = 0; i < _segs.length; i++) {\r\n                userProvidedSegments.push(_segs[i]);\r\n                totalLength += _segs[i].getLength();\r\n            }\r\n        };\r\n\r\n        this.getLength = function() {\r\n            return totalLength;\r\n        };\r\n\r\n        var _prepareCompute = function (params) {\r\n            this.lineWidth = params.lineWidth;\r\n            var segment = _jg.quadrant(params.sourcePos, params.targetPos),\r\n                swapX = params.targetPos[0] < params.sourcePos[0],\r\n                swapY = params.targetPos[1] < params.sourcePos[1],\r\n                lw = params.lineWidth || 1,\r\n                so = params.sourceEndpoint.anchor.getOrientation(params.sourceEndpoint),\r\n                to = params.targetEndpoint.anchor.getOrientation(params.targetEndpoint),\r\n                x = swapX ? params.targetPos[0] : params.sourcePos[0],\r\n                y = swapY ? params.targetPos[1] : params.sourcePos[1],\r\n                w = Math.abs(params.targetPos[0] - params.sourcePos[0]),\r\n                h = Math.abs(params.targetPos[1] - params.sourcePos[1]);\r\n\r\n            // if either anchor does not have an orientation set, we derive one from their relative\r\n            // positions.  we fix the axis to be the one in which the two elements are further apart, and\r\n            // point each anchor at the other element.  this is also used when dragging a new connection.\r\n            if (so[0] === 0 && so[1] === 0 || to[0] === 0 && to[1] === 0) {\r\n                var index = w > h ? 0 : 1, oIndex = [1, 0][index];\r\n                so = [];\r\n                to = [];\r\n                so[index] = params.sourcePos[index] > params.targetPos[index] ? -1 : 1;\r\n                to[index] = params.sourcePos[index] > params.targetPos[index] ? 1 : -1;\r\n                so[oIndex] = 0;\r\n                to[oIndex] = 0;\r\n            }\r\n\r\n            var sx = swapX ? w + (sourceGap * so[0]) : sourceGap * so[0],\r\n                sy = swapY ? h + (sourceGap * so[1]) : sourceGap * so[1],\r\n                tx = swapX ? targetGap * to[0] : w + (targetGap * to[0]),\r\n                ty = swapY ? targetGap * to[1] : h + (targetGap * to[1]),\r\n                oProduct = ((so[0] * to[0]) + (so[1] * to[1]));\r\n\r\n            var result = {\r\n                sx: sx, sy: sy, tx: tx, ty: ty, lw: lw,\r\n                xSpan: Math.abs(tx - sx),\r\n                ySpan: Math.abs(ty - sy),\r\n                mx: (sx + tx) / 2,\r\n                my: (sy + ty) / 2,\r\n                so: so, to: to, x: x, y: y, w: w, h: h,\r\n                segment: segment,\r\n                startStubX: sx + (so[0] * sourceStub),\r\n                startStubY: sy + (so[1] * sourceStub),\r\n                endStubX: tx + (to[0] * targetStub),\r\n                endStubY: ty + (to[1] * targetStub),\r\n                isXGreaterThanStubTimes2: Math.abs(sx - tx) > (sourceStub + targetStub),\r\n                isYGreaterThanStubTimes2: Math.abs(sy - ty) > (sourceStub + targetStub),\r\n                opposite: oProduct == -1,\r\n                perpendicular: oProduct === 0,\r\n                orthogonal: oProduct == 1,\r\n                sourceAxis: so[0] === 0 ? \"y\" : \"x\",\r\n                points: [x, y, w, h, sx, sy, tx, ty ]\r\n            };\r\n            result.anchorOrientation = result.opposite ? \"opposite\" : result.orthogonal ? \"orthogonal\" : \"perpendicular\";\r\n            return result;\r\n        };\r\n\r\n        this.getSegments = function () {\r\n            return segments;\r\n        };\r\n\r\n        this.updateBounds = function (segment) {\r\n            var segBounds = segment.getBounds();\r\n            this.bounds.minX = Math.min(this.bounds.minX, segBounds.minX);\r\n            this.bounds.maxX = Math.max(this.bounds.maxX, segBounds.maxX);\r\n            this.bounds.minY = Math.min(this.bounds.minY, segBounds.minY);\r\n            this.bounds.maxY = Math.max(this.bounds.maxY, segBounds.maxY);\r\n        };\r\n\r\n        var dumpSegmentsToConsole = function () {\r\n            console.log(\"SEGMENTS:\");\r\n            for (var i = 0; i < segments.length; i++) {\r\n                console.log(segments[i].type, segments[i].getLength(), segmentProportions[i]);\r\n            }\r\n        };\r\n\r\n        this.pointOnPath = function (location, absolute) {\r\n            var seg = _findSegmentForLocation(location, absolute);\r\n            return seg.segment && seg.segment.pointOnPath(seg.proportion, false) || [0, 0];\r\n        };\r\n\r\n        this.gradientAtPoint = function (location, absolute) {\r\n            var seg = _findSegmentForLocation(location, absolute);\r\n            return seg.segment && seg.segment.gradientAtPoint(seg.proportion, false) || 0;\r\n        };\r\n\r\n        this.pointAlongPathFrom = function (location, distance, absolute) {\r\n            var seg = _findSegmentForLocation(location, absolute);\r\n            // TODO what happens if this crosses to the next segment?\r\n            return seg.segment && seg.segment.pointAlongPathFrom(seg.proportion, distance, false) || [0, 0];\r\n        };\r\n\r\n        this.compute = function (params) {\r\n            if (!edited)\r\n                paintInfo = _prepareCompute.call(this, params);\r\n\r\n            _clearSegments();\r\n            this._compute(paintInfo, params);\r\n            this.x = paintInfo.points[0];\r\n            this.y = paintInfo.points[1];\r\n            this.w = paintInfo.points[2];\r\n            this.h = paintInfo.points[3];\r\n            this.segment = paintInfo.segment;\r\n            _updateSegmentProportions();\r\n        };\r\n\r\n        return {\r\n            addSegment: _addSegment,\r\n            prepareCompute: _prepareCompute,\r\n            sourceStub: sourceStub,\r\n            targetStub: targetStub,\r\n            maxStub: Math.max(sourceStub, targetStub),\r\n            sourceGap: sourceGap,\r\n            targetGap: targetGap,\r\n            maxGap: Math.max(sourceGap, targetGap)\r\n        };\r\n    };\r\n    _ju.extend(_jp.Connectors.AbstractConnector, AbstractComponent);\r\n\r\n    /**\r\n     * Class: Connectors.Straight\r\n     * The Straight connector draws a simple straight line between the two anchor points.  It does not have any constructor parameters.\r\n     */\r\n    var Straight = _jp.Connectors.Straight = function () {\r\n        this.type = \"Straight\";\r\n        var _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\r\n\r\n        this._compute = function (paintInfo, _) {\r\n            _super.addSegment(this, \"Straight\", {x1: paintInfo.sx, y1: paintInfo.sy, x2: paintInfo.startStubX, y2: paintInfo.startStubY});\r\n            _super.addSegment(this, \"Straight\", {x1: paintInfo.startStubX, y1: paintInfo.startStubY, x2: paintInfo.endStubX, y2: paintInfo.endStubY});\r\n            _super.addSegment(this, \"Straight\", {x1: paintInfo.endStubX, y1: paintInfo.endStubY, x2: paintInfo.tx, y2: paintInfo.ty});\r\n        };\r\n    };\r\n    _ju.extend(_jp.Connectors.Straight, _jp.Connectors.AbstractConnector);\r\n    _jp.registerConnectorType(Straight, \"Straight\");\r\n\r\n\r\n    // ********************************* END OF CONNECTOR TYPES *******************************************************************\r\n\r\n    // ********************************* ENDPOINT TYPES *******************************************************************\r\n\r\n    _jp.Endpoints.AbstractEndpoint = function (params) {\r\n        AbstractComponent.apply(this, arguments);\r\n        var compute = this.compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            var out = this._compute.apply(this, arguments);\r\n            this.x = out[0];\r\n            this.y = out[1];\r\n            this.w = out[2];\r\n            this.h = out[3];\r\n            this.bounds.minX = this.x;\r\n            this.bounds.minY = this.y;\r\n            this.bounds.maxX = this.x + this.w;\r\n            this.bounds.maxY = this.y + this.h;\r\n            return out;\r\n        };\r\n        return {\r\n            compute: compute,\r\n            cssClass: params.cssClass\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.AbstractEndpoint, AbstractComponent);\r\n\r\n    /**\r\n     * Class: Endpoints.Dot\r\n     * A round endpoint, with default radius 10 pixels.\r\n     */\r\n\r\n    /**\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     *\r\n     *    radius    -    radius of the endpoint.  defaults to 10 pixels.\r\n     */\r\n    _jp.Endpoints.Dot = function (params) {\r\n        this.type = \"Dot\";\r\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n        params = params || {};\r\n        this.radius = params.radius || 10;\r\n        this.defaultOffset = 0.5 * this.radius;\r\n        this.defaultInnerRadius = this.radius / 3;\r\n\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            this.radius = endpointStyle.radius || this.radius;\r\n            var x = anchorPoint[0] - this.radius,\r\n                y = anchorPoint[1] - this.radius,\r\n                w = this.radius * 2,\r\n                h = this.radius * 2;\r\n\r\n            if (endpointStyle.strokeStyle) {\r\n                var lw = endpointStyle.lineWidth || 1;\r\n                x -= lw;\r\n                y -= lw;\r\n                w += (lw * 2);\r\n                h += (lw * 2);\r\n            }\r\n            return [ x, y, w, h, this.radius ];\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.Dot, _jp.Endpoints.AbstractEndpoint);\r\n\r\n    _jp.Endpoints.Rectangle = function (params) {\r\n        this.type = \"Rectangle\";\r\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n        params = params || {};\r\n        this.width = params.width || 20;\r\n        this.height = params.height || 20;\r\n\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            var width = endpointStyle.width || this.width,\r\n                height = endpointStyle.height || this.height,\r\n                x = anchorPoint[0] - (width / 2),\r\n                y = anchorPoint[1] - (height / 2);\r\n\r\n            return [ x, y, width, height];\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.Rectangle, _jp.Endpoints.AbstractEndpoint);\r\n\r\n    var DOMElementEndpoint = function (params) {\r\n        _jp.jsPlumbUIComponent.apply(this, arguments);\r\n        this._jsPlumb.displayElements = [];\r\n    };\r\n    _ju.extend(DOMElementEndpoint, _jp.jsPlumbUIComponent, {\r\n        getDisplayElements: function () {\r\n            return this._jsPlumb.displayElements;\r\n        },\r\n        appendDisplayElement: function (el) {\r\n            this._jsPlumb.displayElements.push(el);\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Class: Endpoints.Image\r\n     * Draws an image as the Endpoint.\r\n     */\r\n    /**\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     *\r\n     *    src    -    location of the image to use.\r\n\r\n     TODO: multiple references to self. not sure quite how to get rid of them entirely. perhaps self = null in the cleanup\r\n     function will suffice\r\n\r\n     TODO this class still might leak memory.\r\n\r\n     */\r\n    _jp.Endpoints.Image = function (params) {\r\n\r\n        this.type = \"Image\";\r\n        DOMElementEndpoint.apply(this, arguments);\r\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n\r\n        var _onload = params.onload,\r\n            src = params.src || params.url,\r\n            clazz = params.cssClass ? \" \" + params.cssClass : \"\";\r\n\r\n        this._jsPlumb.img = new Image();\r\n        this._jsPlumb.ready = false;\r\n        this._jsPlumb.initialized = false;\r\n        this._jsPlumb.deleted = false;\r\n        this._jsPlumb.widthToUse = params.width;\r\n        this._jsPlumb.heightToUse = params.height;\r\n        this._jsPlumb.endpoint = params.endpoint;\r\n\r\n        this._jsPlumb.img.onload = function () {\r\n            if (this._jsPlumb != null) {\r\n                this._jsPlumb.ready = true;\r\n                this._jsPlumb.widthToUse = this._jsPlumb.widthToUse || this._jsPlumb.img.width;\r\n                this._jsPlumb.heightToUse = this._jsPlumb.heightToUse || this._jsPlumb.img.height;\r\n                if (_onload) {\r\n                    _onload(this);\r\n                }\r\n            }\r\n        }.bind(this);\r\n\r\n        /*\r\n         Function: setImage\r\n         Sets the Image to use in this Endpoint.\r\n\r\n         Parameters:\r\n         img         -   may be a URL or an Image object\r\n         onload      -   optional; a callback to execute once the image has loaded.\r\n         */\r\n        this._jsPlumb.endpoint.setImage = function (_img, onload) {\r\n            var s = _img.constructor == String ? _img : _img.src;\r\n            _onload = onload;\r\n            this._jsPlumb.img.src = s;\r\n\r\n            if (this.canvas != null)\r\n                this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\r\n        }.bind(this);\r\n\r\n        this._jsPlumb.endpoint.setImage(src, _onload);\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            this.anchorPoint = anchorPoint;\r\n            if (this._jsPlumb.ready) return [anchorPoint[0] - this._jsPlumb.widthToUse / 2, anchorPoint[1] - this._jsPlumb.heightToUse / 2,\r\n                this._jsPlumb.widthToUse, this._jsPlumb.heightToUse];\r\n            else return [0, 0, 0, 0];\r\n        };\r\n\r\n        this.canvas = jsPlumb.createElement(\"img\", {\r\n            position:\"absolute\",\r\n            margin:0,\r\n            padding:0,\r\n            outline:0\r\n        }, this._jsPlumb.instance.endpointClass + clazz);\r\n\r\n        if (this._jsPlumb.widthToUse) this.canvas.setAttribute(\"width\", this._jsPlumb.widthToUse);\r\n        if (this._jsPlumb.heightToUse) this.canvas.setAttribute(\"height\", this._jsPlumb.heightToUse);\r\n        this._jsPlumb.instance.appendElement(this.canvas);\r\n\r\n        this.actuallyPaint = function (d, style, anchor) {\r\n            if (!this._jsPlumb.deleted) {\r\n                if (!this._jsPlumb.initialized) {\r\n                    this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\r\n                    this.appendDisplayElement(this.canvas);\r\n                    this._jsPlumb.initialized = true;\r\n                }\r\n                var x = this.anchorPoint[0] - (this._jsPlumb.widthToUse / 2),\r\n                    y = this.anchorPoint[1] - (this._jsPlumb.heightToUse / 2);\r\n                _ju.sizeElement(this.canvas, x, y, this._jsPlumb.widthToUse, this._jsPlumb.heightToUse);\r\n            }\r\n        };\r\n\r\n        this.paint = function (style, anchor) {\r\n            if (this._jsPlumb != null) {  // may have been deleted\r\n                if (this._jsPlumb.ready) {\r\n                    this.actuallyPaint(style, anchor);\r\n                }\r\n                else {\r\n                    root.setTimeout(function () {\r\n                        this.paint(style, anchor);\r\n                    }.bind(this), 200);\r\n                }\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.Image, [ DOMElementEndpoint, _jp.Endpoints.AbstractEndpoint ], {\r\n        cleanup: function (force) {\r\n            if (force) {\r\n                this._jsPlumb.deleted = true;\r\n                if (this.canvas) this.canvas.parentNode.removeChild(this.canvas);\r\n                this.canvas = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Class: Endpoints.Blank\r\n     * An Endpoint that paints nothing (visible) on the screen.  Supports cssClass and hoverClass parameters like all Endpoints.\r\n     */\r\n    _jp.Endpoints.Blank = function (params) {\r\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n        this.type = \"Blank\";\r\n        DOMElementEndpoint.apply(this, arguments);\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            return [anchorPoint[0], anchorPoint[1], 10, 0];\r\n        };\r\n\r\n        var clazz = params.cssClass ? \" \" + params.cssClass : \"\";\r\n\r\n        this.canvas = jsPlumb.createElement(\"div\", {\r\n            display: \"block\",\r\n            width: \"1px\",\r\n            height: \"1px\",\r\n            background: \"transparent\",\r\n            position: \"absolute\"\r\n        }, this._jsPlumb.instance.endpointClass + clazz);\r\n\r\n        this._jsPlumb.instance.appendElement(this.canvas);\r\n\r\n        this.paint = function (style, anchor) {\r\n            _ju.sizeElement(this.canvas, this.x, this.y, this.w, this.h);\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.Blank, [_jp.Endpoints.AbstractEndpoint, DOMElementEndpoint], {\r\n        cleanup: function () {\r\n            if (this.canvas && this.canvas.parentNode) {\r\n                this.canvas.parentNode.removeChild(this.canvas);\r\n            }\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Class: Endpoints.Triangle\r\n     * A triangular Endpoint.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     *\r\n     * \twidth\t-\twidth of the triangle's base.  defaults to 55 pixels.\r\n     * \theight\t-\theight of the triangle from base to apex.  defaults to 55 pixels.\r\n     */\r\n    _jp.Endpoints.Triangle = function (params) {\r\n        this.type = \"Triangle\";\r\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\r\n        params = params || {  };\r\n        params.width = params.width || 55;\r\n        params.height = params.height || 55;\r\n        this.width = params.width;\r\n        this.height = params.height;\r\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\r\n            var width = endpointStyle.width || self.width,\r\n                height = endpointStyle.height || self.height,\r\n                x = anchorPoint[0] - (width / 2),\r\n                y = anchorPoint[1] - (height / 2);\r\n            return [ x, y, width, height ];\r\n        };\r\n    };\r\n// ********************************* END OF ENDPOINT TYPES *******************************************************************\r\n\r\n\r\n// ********************************* OVERLAY DEFINITIONS ***********************************************************************    \r\n\r\n    var AbstractOverlay = _jp.Overlays.AbstractOverlay = function (params) {\r\n        this.visible = true;\r\n        this.isAppendedAtTopLevel = true;\r\n        this.component = params.component;\r\n        this.loc = params.location == null ? 0.5 : params.location;\r\n        this.endpointLoc = params.endpointLocation == null ? [ 0.5, 0.5] : params.endpointLocation;\r\n    };\r\n    AbstractOverlay.prototype = {\r\n        cleanup: function (force) {\r\n            if (force) {\r\n                this.component = null;\r\n                this.canvas = null;\r\n                this.endpointLoc = null;\r\n            }\r\n        },\r\n        reattach:function(instance) {\r\n\r\n        },\r\n        setVisible: function (val) {\r\n            this.visible = val;\r\n            this.component.repaint();\r\n        },\r\n        isVisible: function () {\r\n            return this.visible;\r\n        },\r\n        hide: function () {\r\n            this.setVisible(false);\r\n        },\r\n        show: function () {\r\n            this.setVisible(true);\r\n        },\r\n        incrementLocation: function (amount) {\r\n            this.loc += amount;\r\n            this.component.repaint();\r\n        },\r\n        setLocation: function (l) {\r\n            this.loc = l;\r\n            this.component.repaint();\r\n        },\r\n        getLocation: function () {\r\n            return this.loc;\r\n        },\r\n        updateFrom:function() { }\r\n    };\r\n\r\n\r\n    /*\r\n     * Class: Overlays.Arrow\r\n     *\r\n     * An arrow overlay, defined by four points: the head, the two sides of the tail, and a 'foldback' point at some distance along the length\r\n     * of the arrow that lines from each tail point converge into.  The foldback point is defined using a decimal that indicates some fraction\r\n     * of the length of the arrow and has a default value of 0.623.  A foldback point value of 1 would mean that the arrow had a straight line\r\n     * across the tail.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     *\r\n     * Parameters:\r\n     *\r\n     * \tlength - distance in pixels from head to tail baseline. default 20.\r\n     * \twidth - width in pixels of the tail baseline. default 20.\r\n     * \tfillStyle - style to use when filling the arrow.  defaults to \"black\".\r\n     * \tstrokeStyle - style to use when stroking the arrow. defaults to null, which means the arrow is not stroked.\r\n     * \tlineWidth - line width to use when stroking the arrow. defaults to 1, but only used if strokeStyle is not null.\r\n     * \tfoldback - distance (as a decimal from 0 to 1 inclusive) along the length of the arrow marking the point the tail points should fold back to.  defaults to 0.623.\r\n     * \tlocation - distance (as a decimal from 0 to 1 inclusive) marking where the arrow should sit on the connector. defaults to 0.5.\r\n     * \tdirection - indicates the direction the arrow points in. valid values are -1 and 1; 1 is default.\r\n     */\r\n    _jp.Overlays.Arrow = function (params) {\r\n        this.type = \"Arrow\";\r\n        AbstractOverlay.apply(this, arguments);\r\n        this.isAppendedAtTopLevel = false;\r\n        params = params || {};\r\n\r\n        this.length = params.length || 20;\r\n        this.width = params.width || 20;\r\n        this.id = params.id;\r\n        var direction = (params.direction || 1) < 0 ? -1 : 1,\r\n            paintStyle = params.paintStyle || { lineWidth: 1 },\r\n        // how far along the arrow the lines folding back in come to. default is 62.3%.\r\n            foldback = params.foldback || 0.623;\r\n\r\n        this.computeMaxSize = function () {\r\n            return self.width * 1.5;\r\n        };\r\n\r\n        this.draw = function (component, currentConnectionPaintStyle) {\r\n\r\n            var hxy, mid, txy, tail, cxy;\r\n            if (component.pointAlongPathFrom) {\r\n\r\n                if (_ju.isString(this.loc) || this.loc > 1 || this.loc < 0) {\r\n                    var l = parseInt(this.loc, 10),\r\n                        fromLoc = this.loc < 0 ? 1 : 0;\r\n                    hxy = component.pointAlongPathFrom(fromLoc, l, false);\r\n                    mid = component.pointAlongPathFrom(fromLoc, l - (direction * this.length / 2), false);\r\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\r\n                }\r\n                else if (this.loc == 1) {\r\n                    hxy = component.pointOnPath(this.loc);\r\n                    mid = component.pointAlongPathFrom(this.loc, -(this.length));\r\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\r\n\r\n                    if (direction == -1) {\r\n                        var _ = txy;\r\n                        txy = hxy;\r\n                        hxy = _;\r\n                    }\r\n                }\r\n                else if (this.loc === 0) {\r\n                    txy = component.pointOnPath(this.loc);\r\n                    mid = component.pointAlongPathFrom(this.loc, this.length);\r\n                    hxy = _jg.pointOnLine(txy, mid, this.length);\r\n                    if (direction == -1) {\r\n                        var __ = txy;\r\n                        txy = hxy;\r\n                        hxy = __;\r\n                    }\r\n                }\r\n                else {\r\n                    hxy = component.pointAlongPathFrom(this.loc, direction * this.length / 2);\r\n                    mid = component.pointOnPath(this.loc);\r\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\r\n                }\r\n\r\n                tail = _jg.perpendicularLineTo(hxy, txy, this.width);\r\n                cxy = _jg.pointOnLine(hxy, txy, foldback * this.length);\r\n\r\n                var d = { hxy: hxy, tail: tail, cxy: cxy },\r\n                    strokeStyle = paintStyle.strokeStyle || currentConnectionPaintStyle.strokeStyle,\r\n                    fillStyle = paintStyle.fillStyle || currentConnectionPaintStyle.strokeStyle,\r\n                    lineWidth = paintStyle.lineWidth || currentConnectionPaintStyle.lineWidth;\r\n\r\n                return {\r\n                    component: component,\r\n                    d: d,\r\n                    lineWidth: lineWidth,\r\n                    strokeStyle: strokeStyle,\r\n                    fillStyle: fillStyle,\r\n                    minX: Math.min(hxy.x, tail[0].x, tail[1].x),\r\n                    maxX: Math.max(hxy.x, tail[0].x, tail[1].x),\r\n                    minY: Math.min(hxy.y, tail[0].y, tail[1].y),\r\n                    maxY: Math.max(hxy.y, tail[0].y, tail[1].y)\r\n                };\r\n            }\r\n            else return {component: component, minX: 0, maxX: 0, minY: 0, maxY: 0};\r\n        };\r\n    };\r\n    _ju.extend(_jp.Overlays.Arrow, AbstractOverlay, {\r\n        updateFrom:function(d) {\r\n            this.length = d.length || this.length;\r\n            this.width = d.width|| this.width;\r\n            this.direction = d.direction != null ? d.direction : this.direction;\r\n            this.foldback = d.foldback|| this.foldback;\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Class: Overlays.PlainArrow\r\n     *\r\n     * A basic arrow.  This is in fact just one instance of the more generic case in which the tail folds back on itself to some\r\n     * point along the length of the arrow: in this case, that foldback point is the full length of the arrow.  so it just does\r\n     * a 'call' to Arrow with foldback set appropriately.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\r\n     */\r\n    _jp.Overlays.PlainArrow = function (params) {\r\n        params = params || {};\r\n        var p = _jp.extend(params, {foldback: 1});\r\n        _jp.Overlays.Arrow.call(this, p);\r\n        this.type = \"PlainArrow\";\r\n    };\r\n    _ju.extend(_jp.Overlays.PlainArrow, _jp.Overlays.Arrow);\r\n\r\n    /*\r\n     * Class: Overlays.Diamond\r\n     * \r\n     * A diamond. Like PlainArrow, this is a concrete case of the more generic case of the tail points converging on some point...it just\r\n     * happens that in this case, that point is greater than the length of the the arrow.\r\n     *\r\n     *      this could probably do with some help with positioning...due to the way it reuses the Arrow paint code, what Arrow thinks is the\r\n     *      center is actually 1/4 of the way along for this guy.  but we don't have any knowledge of pixels at this point, so we're kind of\r\n     *      stuck when it comes to helping out the Arrow class. possibly we could pass in a 'transpose' parameter or something. the value\r\n     *      would be -l/4 in this case - move along one quarter of the total length.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\r\n     */\r\n    _jp.Overlays.Diamond = function (params) {\r\n        params = params || {};\r\n        var l = params.length || 40,\r\n            p = jsPlumb.extend(params, {length: l / 2, foldback: 2});\r\n        _jp.Overlays.Arrow.call(this, p);\r\n        this.type = \"Diamond\";\r\n    };\r\n    _ju.extend(_jp.Overlays.Diamond, _jp.Overlays.Arrow);\r\n\r\n    var _getDimensions = function (component, forceRefresh) {\r\n        if (component._jsPlumb.cachedDimensions == null || forceRefresh)\r\n            component._jsPlumb.cachedDimensions = component.getDimensions();\r\n        return component._jsPlumb.cachedDimensions;\r\n    };\r\n\r\n    // abstract superclass for overlays that add an element to the DOM.\r\n    var AbstractDOMOverlay = function (params) {\r\n        _jp.jsPlumbUIComponent.apply(this, arguments);\r\n        AbstractOverlay.apply(this, arguments);\r\n\r\n        // hand off fired events to associated component.\r\n        var _f = this.fire;\r\n        this.fire = function () {\r\n            _f.apply(this, arguments);\r\n            if (this.component) this.component.fire.apply(this.component, arguments);\r\n        };\r\n\r\n        this.detached=false;\r\n        this.id = params.id;\r\n        this._jsPlumb.div = null;\r\n        this._jsPlumb.initialised = false;\r\n        this._jsPlumb.component = params.component;\r\n        this._jsPlumb.cachedDimensions = null;\r\n        this._jsPlumb.create = params.create;\r\n        this._jsPlumb.initiallyInvisible = params.visible === false;\r\n\r\n        this.getElement = function () {\r\n            if (this._jsPlumb.div == null) {\r\n                var div = this._jsPlumb.div = jsPlumb.getElement(this._jsPlumb.create(this._jsPlumb.component));\r\n                div.style.position = \"absolute\";\r\n                div.className = this._jsPlumb.instance.overlayClass + \" \" +\r\n                    (this.cssClass ? this.cssClass :\r\n                        params.cssClass ? params.cssClass : \"\");\r\n                this._jsPlumb.instance.appendElement(div);\r\n                this._jsPlumb.instance.getId(div);\r\n                this.canvas = div;\r\n\r\n                // in IE the top left corner is what it placed at the desired location.  This will not\r\n                // be fixed. IE8 is not going to be supported for much longer.\r\n                var ts = \"translate(-50%, -50%)\";\r\n                div.style.webkitTransform = ts;\r\n                div.style.mozTransform = ts;\r\n                div.style.msTransform = ts;\r\n                div.style.oTransform = ts;\r\n                div.style.transform = ts;\r\n\r\n                // write the related component into the created element\r\n                div._jsPlumb = this;\r\n\r\n                if (params.visible === false)\r\n                    div.style.display = \"none\";\r\n            }\r\n            return this._jsPlumb.div;\r\n        };\r\n\r\n        this.draw = function (component, currentConnectionPaintStyle, absolutePosition) {\r\n            var td = _getDimensions(this);\r\n            if (td != null && td.length == 2) {\r\n                var cxy = { x: 0, y: 0 };\r\n\r\n                // absolutePosition would have been set by a call to connection.setAbsoluteOverlayPosition.\r\n                if (absolutePosition) {\r\n                    cxy = { x: absolutePosition[0], y: absolutePosition[1] };\r\n                }\r\n                else if (component.pointOnPath) {\r\n                    var loc = this.loc, absolute = false;\r\n                    if (_ju.isString(this.loc) || this.loc < 0 || this.loc > 1) {\r\n                        loc = parseInt(this.loc, 10);\r\n                        absolute = true;\r\n                    }\r\n                    cxy = component.pointOnPath(loc, absolute);  // a connection\r\n                }\r\n                else {\r\n                    var locToUse = this.loc.constructor == Array ? this.loc : this.endpointLoc;\r\n                    cxy = { x: locToUse[0] * component.w,\r\n                        y: locToUse[1] * component.h };\r\n                }\r\n\r\n                var minx = cxy.x - (td[0] / 2),\r\n                    miny = cxy.y - (td[1] / 2);\r\n\r\n                return {\r\n                    component: component,\r\n                    d: { minx: minx, miny: miny, td: td, cxy: cxy },\r\n                    minX: minx,\r\n                    maxX: minx + td[0],\r\n                    minY: miny,\r\n                    maxY: miny + td[1]\r\n                };\r\n            }\r\n            else return {minX: 0, maxX: 0, minY: 0, maxY: 0};\r\n        };\r\n    };\r\n    _ju.extend(AbstractDOMOverlay, [_jp.jsPlumbUIComponent, AbstractOverlay], {\r\n        getDimensions: function () {\r\n// still support the old way, for now, for IE8. But from 2.0.0 this whole method will be gone. \r\n            return _ju.oldIE ? _jp.getSize(this.getElement()) : [1, 1];\r\n        },\r\n        setVisible: function (state) {\r\n            if (this._jsPlumb.div) {\r\n                this._jsPlumb.div.style.display = state ? \"block\" : \"none\";\r\n                // if initially invisible, dimensions are 0,0 and never get updated\r\n                if (state && this._jsPlumb.initiallyInvisible) {\r\n                    _getDimensions(this, true);\r\n                    this.component.repaint();\r\n                    this._jsPlumb.initiallyInvisible = false;\r\n                }\r\n            }\r\n        },\r\n        /*\r\n         * Function: clearCachedDimensions\r\n         * Clears the cached dimensions for the label. As a performance enhancement, label dimensions are\r\n         * cached from 1.3.12 onwards. The cache is cleared when you change the label text, of course, but\r\n         * there are other reasons why the text dimensions might change - if you make a change through CSS, for\r\n         * example, you might change the font size.  in that case you should explicitly call this method.\r\n         */\r\n        clearCachedDimensions: function () {\r\n            this._jsPlumb.cachedDimensions = null;\r\n        },\r\n        cleanup: function (force) {\r\n            if (force) {\r\n                if (this._jsPlumb.div != null) {\r\n                    this._jsPlumb.div._jsPlumb = null;\r\n                    this._jsPlumb.instance.removeElement(this._jsPlumb.div);\r\n                }\r\n            }\r\n            else {\r\n                // if not a forced cleanup, just detach child from parent for now.\r\n                if (this._jsPlumb && this._jsPlumb.div && this._jsPlumb.div.parentNode)\r\n                    this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\r\n                this.detached = true;\r\n            }\r\n\r\n        },\r\n        reattach:function(instance) {\r\n            if (this._jsPlumb.div != null) instance.getContainer().appendChild(this._jsPlumb.div);\r\n            this.detached = false;\r\n        },\r\n        computeMaxSize: function () {\r\n            var td = _getDimensions(this);\r\n            return Math.max(td[0], td[1]);\r\n        },\r\n        paint: function (p, containerExtents) {\r\n            if (!this._jsPlumb.initialised) {\r\n                this.getElement();\r\n                p.component.appendDisplayElement(this._jsPlumb.div);\r\n                this._jsPlumb.initialised = true;\r\n                if (this.detached) this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\r\n            }\r\n            this._jsPlumb.div.style.left = (p.component.x + p.d.minx) + \"px\";\r\n            this._jsPlumb.div.style.top = (p.component.y + p.d.miny) + \"px\";\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Class: Overlays.Custom\r\n     * A Custom overlay. You supply a 'create' function which returns some DOM element, and jsPlumb positions it.\r\n     * The 'create' function is passed a Connection or Endpoint.\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     * \r\n     * Parameters:\r\n     * \tcreate - function for jsPlumb to call that returns a DOM element.\r\n     * \tlocation - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\r\n     * \tid - optional id to use for later retrieval of this overlay.\r\n     * \t\r\n     */\r\n    _jp.Overlays.Custom = function (params) {\r\n        this.type = \"Custom\";\r\n        AbstractDOMOverlay.apply(this, arguments);\r\n    };\r\n    _ju.extend(_jp.Overlays.Custom, AbstractDOMOverlay);\r\n\r\n    _jp.Overlays.GuideLines = function () {\r\n        var self = this;\r\n        self.length = 50;\r\n        self.lineWidth = 5;\r\n        this.type = \"GuideLines\";\r\n        AbstractOverlay.apply(this, arguments);\r\n        _jp.jsPlumbUIComponent.apply(this, arguments);\r\n        this.draw = function (connector, currentConnectionPaintStyle) {\r\n\r\n            var head = connector.pointAlongPathFrom(self.loc, self.length / 2),\r\n                mid = connector.pointOnPath(self.loc),\r\n                tail = _jg.pointOnLine(head, mid, self.length),\r\n                tailLine = _jg.perpendicularLineTo(head, tail, 40),\r\n                headLine = _jg.perpendicularLineTo(tail, head, 20);\r\n\r\n            return {\r\n                connector: connector,\r\n                head: head,\r\n                tail: tail,\r\n                headLine: headLine,\r\n                tailLine: tailLine,\r\n                minX: Math.min(head.x, tail.x, headLine[0].x, headLine[1].x),\r\n                minY: Math.min(head.y, tail.y, headLine[0].y, headLine[1].y),\r\n                maxX: Math.max(head.x, tail.x, headLine[0].x, headLine[1].x),\r\n                maxY: Math.max(head.y, tail.y, headLine[0].y, headLine[1].y)\r\n            };\r\n        };\r\n\r\n        // this.cleanup = function() { };  // nothing to clean up for GuideLines\r\n    };\r\n\r\n    /*\r\n     * Class: Overlays.Label\r\n\r\n     */\r\n    /*\r\n     * Function: Constructor\r\n     * \r\n     * Parameters:\r\n     * \tcssClass - optional css class string to append to css class. This string is appended \"as-is\", so you can of course have multiple classes\r\n     *             defined.  This parameter is preferred to using labelStyle, borderWidth and borderStyle.\r\n     * \tlabel - the label to paint.  May be a string or a function that returns a string.  Nothing will be painted if your label is null or your\r\n     *         label function returns null.  empty strings _will_ be painted.\r\n     * \tlocation - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\r\n     * \tid - optional id to use for later retrieval of this overlay.\r\n     * \r\n     * \t\r\n     */\r\n    _jp.Overlays.Label = function (params) {\r\n        this.labelStyle = params.labelStyle;\r\n\r\n        var labelWidth = null, labelHeight = null, labelText = null, labelPadding = null;\r\n        this.cssClass = this.labelStyle != null ? this.labelStyle.cssClass : null;\r\n        var p = _jp.extend({\r\n            create: function () {\r\n                return jsPlumb.createElement(\"div\");\r\n            }}, params);\r\n        _jp.Overlays.Custom.call(this, p);\r\n        this.type = \"Label\";\r\n        this.label = params.label || \"\";\r\n        this.labelText = null;\r\n        if (this.labelStyle) {\r\n            var el = this.getElement();\r\n            this.labelStyle.font = this.labelStyle.font || \"12px sans-serif\";\r\n            el.style.font = this.labelStyle.font;\r\n            el.style.color = this.labelStyle.color || \"black\";\r\n            if (this.labelStyle.fillStyle) el.style.background = this.labelStyle.fillStyle;\r\n            if (this.labelStyle.borderWidth > 0) {\r\n                var dStyle = this.labelStyle.borderStyle ? this.labelStyle.borderStyle : \"black\";\r\n                el.style.border = this.labelStyle.borderWidth + \"px solid \" + dStyle;\r\n            }\r\n            if (this.labelStyle.padding) el.style.padding = this.labelStyle.padding;\r\n        }\r\n\r\n    };\r\n    _ju.extend(_jp.Overlays.Label, _jp.Overlays.Custom, {\r\n        cleanup: function (force) {\r\n            if (force) {\r\n                this.div = null;\r\n                this.label = null;\r\n                this.labelText = null;\r\n                this.cssClass = null;\r\n                this.labelStyle = null;\r\n            }\r\n        },\r\n        getLabel: function () {\r\n            return this.label;\r\n        },\r\n        /*\r\n         * Function: setLabel\r\n         * sets the label's, um, label.  you would think i'd call this function\r\n         * 'setText', but you can pass either a Function or a String to this, so\r\n         * it makes more sense as 'setLabel'. This uses innerHTML on the label div, so keep\r\n         * that in mind if you need escaped HTML.\r\n         */\r\n        setLabel: function (l) {\r\n            this.label = l;\r\n            this.labelText = null;\r\n            this.clearCachedDimensions();\r\n            this.update();\r\n            this.component.repaint();\r\n        },\r\n        getDimensions: function () {\r\n            this.update();\r\n            return AbstractDOMOverlay.prototype.getDimensions.apply(this, arguments);\r\n        },\r\n        update: function () {\r\n            if (typeof this.label == \"function\") {\r\n                var lt = this.label(this);\r\n                this.getElement().innerHTML = lt.replace(/\\r\\n/g, \"<br/>\");\r\n            }\r\n            else {\r\n                if (this.labelText == null) {\r\n                    this.labelText = this.label;\r\n                    this.getElement().innerHTML = this.labelText.replace(/\\r\\n/g, \"<br/>\");\r\n                }\r\n            }\r\n        },\r\n        updateFrom:function(d) {\r\n            if(d.label) this.setLabel(d.label);\r\n        }\r\n    });\r\n\r\n    // ********************************* END OF OVERLAY DEFINITIONS ***********************************************************************\r\n\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n *\r\n * Title:jsPlumb 1.7.6\r\n *\r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.\r\n *\r\n * This file contains the base class for library adapters.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n *\r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n *\r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;(function() {\r\n    \"use strict\";\r\n    var root = this,\r\n        _jp = root.jsPlumb;\r\n\r\n    var _getEventManager = function(instance) {\r\n        var e = instance._mottle;\r\n        if (!e) {\r\n            e = instance._mottle = new root.Mottle();\r\n        }\r\n        return e;\r\n    };\r\n\r\n    _jp.extend(root.jsPlumbInstance.prototype, {\r\n        getEventManager:function() {\r\n            return _getEventManager(this);\r\n        },\r\n        //           EVENTS\r\n        // e.originalEvent is for jQuery; in Vanilla jsPlumb we get the native event.\r\n\r\n        on : function(el, event, callback) {\r\n            // TODO: here we would like to map the tap event if we know its\r\n            // an internal bind to a click. we have to know its internal because only\r\n            // then can we be sure that the UP event wont be consumed (tap is a synthesized\r\n            // event from a mousedown followed by a mouseup).\r\n            //event = { \"click\":\"tap\", \"dblclick\":\"dbltap\"}[event] || event;\r\n            this.getEventManager().on.apply(this, arguments);\r\n        },\r\n        off : function(el, event, callback) {\r\n            this.getEventManager().off.apply(this, arguments);\r\n        }\r\n    });\r\n\r\n\r\n}).call(this);\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the 'flowchart' connectors, consisting of vertical and horizontal line segments.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    var Flowchart = function (params) {\r\n        this.type = \"Flowchart\";\r\n        params = params || {};\r\n        params.stub = params.stub == null ? 30 : params.stub;\r\n        var segments,\r\n            _super = _jp.Connectors.AbstractConnector.apply(this, arguments),\r\n            midpoint = params.midpoint == null ? 0.5 : params.midpoint,\r\n            alwaysRespectStubs = params.alwaysRespectStubs === true,\r\n            userSuppliedSegments = null,\r\n            lastx = null, lasty = null, lastOrientation,\r\n            cornerRadius = params.cornerRadius != null ? params.cornerRadius : 0,\r\n            sgn = function (n) {\r\n                return n < 0 ? -1 : n === 0 ? 0 : 1;\r\n            },\r\n            /**\r\n             * helper method to add a segment.\r\n             */\r\n            addSegment = function (segments, x, y, paintInfo) {\r\n                if (lastx == x && lasty == y) return;\r\n                var lx = lastx == null ? paintInfo.sx : lastx,\r\n                    ly = lasty == null ? paintInfo.sy : lasty,\r\n                    o = lx == x ? \"v\" : \"h\",\r\n                    sgnx = sgn(x - lx),\r\n                    sgny = sgn(y - ly);\r\n\r\n                lastx = x;\r\n                lasty = y;\r\n                segments.push([lx, ly, x, y, o, sgnx, sgny]);\r\n            },\r\n            segLength = function (s) {\r\n                return Math.sqrt(Math.pow(s[0] - s[2], 2) + Math.pow(s[1] - s[3], 2));\r\n            },\r\n            _cloneArray = function (a) {\r\n                var _a = [];\r\n                _a.push.apply(_a, a);\r\n                return _a;\r\n            },\r\n            writeSegments = function (conn, segments, paintInfo) {\r\n                var current = null, next;\r\n                for (var i = 0; i < segments.length - 1; i++) {\r\n\r\n                    current = current || _cloneArray(segments[i]);\r\n                    next = _cloneArray(segments[i + 1]);\r\n                    if (cornerRadius > 0 && current[4] != next[4]) {\r\n                        var radiusToUse = Math.min(cornerRadius, segLength(current), segLength(next));\r\n                        // right angle. adjust current segment's end point, and next segment's start point.\r\n                        current[2] -= current[5] * radiusToUse;\r\n                        current[3] -= current[6] * radiusToUse;\r\n                        next[0] += next[5] * radiusToUse;\r\n                        next[1] += next[6] * radiusToUse;\r\n                        var ac = (current[6] == next[5] && next[5] == 1) ||\r\n                                ((current[6] == next[5] && next[5] === 0) && current[5] != next[6]) ||\r\n                                (current[6] == next[5] && next[5] == -1),\r\n                            sgny = next[1] > current[3] ? 1 : -1,\r\n                            sgnx = next[0] > current[2] ? 1 : -1,\r\n                            sgnEqual = sgny == sgnx,\r\n                            cx = (sgnEqual && ac || (!sgnEqual && !ac)) ? next[0] : current[2],\r\n                            cy = (sgnEqual && ac || (!sgnEqual && !ac)) ? current[3] : next[1];\r\n\r\n                        _super.addSegment(conn, \"Straight\", {\r\n                            x1: current[0], y1: current[1], x2: current[2], y2: current[3]\r\n                        });\r\n\r\n                        _super.addSegment(conn, \"Arc\", {\r\n                            r: radiusToUse,\r\n                            x1: current[2],\r\n                            y1: current[3],\r\n                            x2: next[0],\r\n                            y2: next[1],\r\n                            cx: cx,\r\n                            cy: cy,\r\n                            ac: ac\r\n                        });\r\n                    }\r\n                    else {\r\n                        // dx + dy are used to adjust for line width.\r\n                        var dx = (current[2] == current[0]) ? 0 : (current[2] > current[0]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2),\r\n                            dy = (current[3] == current[1]) ? 0 : (current[3] > current[1]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2);\r\n                        _super.addSegment(conn, \"Straight\", {\r\n                            x1: current[0] - dx, y1: current[1] - dy, x2: current[2] + dx, y2: current[3] + dy\r\n                        });\r\n                    }\r\n                    current = next;\r\n                }\r\n                if (next != null) {\r\n                    // last segment\r\n                    _super.addSegment(conn, \"Straight\", {\r\n                        x1: next[0], y1: next[1], x2: next[2], y2: next[3]\r\n                    });\r\n                }\r\n            };\r\n\r\n        this.setSegments = function (s) {\r\n            userSuppliedSegments = s;\r\n        };\r\n\r\n        this.isEditable = function () {\r\n            return true;\r\n        };\r\n\r\n        /*\r\n         Function: getOriginalSegments\r\n         Gets the segments before the addition of rounded corners. This is used by the flowchart\r\n         connector editor, since it only wants to concern itself with the original segments.\r\n         */\r\n        this.getOriginalSegments = function () {\r\n            return userSuppliedSegments || segments;\r\n        };\r\n\r\n        this._compute = function (paintInfo, params) {\r\n\r\n            if (params.clearEdits)\r\n                userSuppliedSegments = null;\r\n\r\n            if (userSuppliedSegments != null) {\r\n                writeSegments(this, userSuppliedSegments, paintInfo);\r\n                return;\r\n            }\r\n\r\n            segments = [];\r\n            lastx = null;\r\n            lasty = null;\r\n            lastOrientation = null;\r\n\r\n            var midx = paintInfo.startStubX + ((paintInfo.endStubX - paintInfo.startStubX) * midpoint),\r\n                midy = paintInfo.startStubY + ((paintInfo.endStubY - paintInfo.startStubY) * midpoint);\r\n\r\n            var orientations = { x: [ 0, 1 ], y: [ 1, 0 ] },\r\n                commonStubCalculator = function () {\r\n                    return [ paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY ];\r\n                },\r\n                stubCalculators = {\r\n                    perpendicular: commonStubCalculator,\r\n                    orthogonal: commonStubCalculator,\r\n                    opposite: function (axis) {\r\n                        var pi = paintInfo,\r\n                            idx = axis == \"x\" ? 0 : 1,\r\n                            areInProximity = {\r\n                                \"x\": function () {\r\n                                    return ( (pi.so[idx] == 1 && (\r\n                                        ( (pi.startStubX > pi.endStubX) && (pi.tx > pi.startStubX) ) ||\r\n                                        ( (pi.sx > pi.endStubX) && (pi.tx > pi.sx))))) ||\r\n\r\n                                        ( (pi.so[idx] == -1 && (\r\n                                            ( (pi.startStubX < pi.endStubX) && (pi.tx < pi.startStubX) ) ||\r\n                                            ( (pi.sx < pi.endStubX) && (pi.tx < pi.sx)))));\r\n                                },\r\n                                \"y\": function () {\r\n                                    return ( (pi.so[idx] == 1 && (\r\n                                        ( (pi.startStubY > pi.endStubY) && (pi.ty > pi.startStubY) ) ||\r\n                                        ( (pi.sy > pi.endStubY) && (pi.ty > pi.sy))))) ||\r\n\r\n                                        ( (pi.so[idx] == -1 && (\r\n                                            ( (pi.startStubY < pi.endStubY) && (pi.ty < pi.startStubY) ) ||\r\n                                            ( (pi.sy < pi.endStubY) && (pi.ty < pi.sy)))));\r\n                                }\r\n                            };\r\n\r\n                        if (!alwaysRespectStubs && areInProximity[axis]()) {\r\n                            return {\r\n                                \"x\": [(paintInfo.sx + paintInfo.tx) / 2, paintInfo.startStubY, (paintInfo.sx + paintInfo.tx) / 2, paintInfo.endStubY],\r\n                                \"y\": [paintInfo.startStubX, (paintInfo.sy + paintInfo.ty) / 2, paintInfo.endStubX, (paintInfo.sy + paintInfo.ty) / 2]\r\n                            }[axis];\r\n                        }\r\n                        else {\r\n                            return [ paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY ];\r\n                        }\r\n                    }\r\n                },\r\n                lineCalculators = {\r\n                    perpendicular: function (axis) {\r\n                        var pi = paintInfo,\r\n                            sis = {\r\n                                x: [\r\n                                    [ [ 1, 2, 3, 4 ], null, [ 2, 1, 4, 3 ] ],\r\n                                    null,\r\n                                    [ [ 4, 3, 2, 1 ], null, [ 3, 4, 1, 2 ] ]\r\n                                ],\r\n                                y: [\r\n                                    [ [ 3, 2, 1, 4 ], null, [ 2, 3, 4, 1 ] ],\r\n                                    null,\r\n                                    [ [ 4, 1, 2, 3 ], null, [ 1, 4, 3, 2 ] ]\r\n                                ]\r\n                            },\r\n                            stubs = {\r\n                                x: [ [ pi.startStubX, pi.endStubX ], null, [ pi.endStubX, pi.startStubX ] ],\r\n                                y: [ [ pi.startStubY, pi.endStubY ], null, [ pi.endStubY, pi.startStubY ] ]\r\n                            },\r\n                            midLines = {\r\n                                x: [ [ midx, pi.startStubY ], [ midx, pi.endStubY ] ],\r\n                                y: [ [ pi.startStubX, midy ], [ pi.endStubX, midy ] ]\r\n                            },\r\n                            linesToEnd = {\r\n                                x: [ [ pi.endStubX, pi.startStubY ] ],\r\n                                y: [ [ pi.startStubX, pi.endStubY ] ]\r\n                            },\r\n                            startToEnd = {\r\n                                x: [ [ pi.startStubX, pi.endStubY ], [ pi.endStubX, pi.endStubY ] ],\r\n                                y: [ [ pi.endStubX, pi.startStubY ], [ pi.endStubX, pi.endStubY ] ]\r\n                            },\r\n                            startToMidToEnd = {\r\n                                x: [ [ pi.startStubX, midy ], [ pi.endStubX, midy ], [ pi.endStubX, pi.endStubY ] ],\r\n                                y: [ [ midx, pi.startStubY ], [ midx, pi.endStubY ], [ pi.endStubX, pi.endStubY ] ]\r\n                            },\r\n                            otherStubs = {\r\n                                x: [ pi.startStubY, pi.endStubY ],\r\n                                y: [ pi.startStubX, pi.endStubX ]\r\n                            },\r\n                            soIdx = orientations[axis][0], toIdx = orientations[axis][1],\r\n                            _so = pi.so[soIdx] + 1,\r\n                            _to = pi.to[toIdx] + 1,\r\n                            otherFlipped = (pi.to[toIdx] == -1 && (otherStubs[axis][1] < otherStubs[axis][0])) || (pi.to[toIdx] == 1 && (otherStubs[axis][1] > otherStubs[axis][0])),\r\n                            stub1 = stubs[axis][_so][0],\r\n                            stub2 = stubs[axis][_so][1],\r\n                            segmentIndexes = sis[axis][_so][_to];\r\n\r\n                        if (pi.segment == segmentIndexes[3] || (pi.segment == segmentIndexes[2] && otherFlipped)) {\r\n                            return midLines[axis];\r\n                        }\r\n                        else if (pi.segment == segmentIndexes[2] && stub2 < stub1) {\r\n                            return linesToEnd[axis];\r\n                        }\r\n                        else if ((pi.segment == segmentIndexes[2] && stub2 >= stub1) || (pi.segment == segmentIndexes[1] && !otherFlipped)) {\r\n                            return startToMidToEnd[axis];\r\n                        }\r\n                        else if (pi.segment == segmentIndexes[0] || (pi.segment == segmentIndexes[1] && otherFlipped)) {\r\n                            return startToEnd[axis];\r\n                        }\r\n                    },\r\n                    orthogonal: function (axis, startStub, otherStartStub, endStub, otherEndStub) {\r\n                        var pi = paintInfo,\r\n                            extent = {\r\n                                \"x\": pi.so[0] == -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub),\r\n                                \"y\": pi.so[1] == -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub)\r\n                            }[axis];\r\n\r\n                        return {\r\n                            \"x\": [\r\n                                [ extent, otherStartStub ],\r\n                                [ extent, otherEndStub ],\r\n                                [ endStub, otherEndStub ]\r\n                            ],\r\n                            \"y\": [\r\n                                [ otherStartStub, extent ],\r\n                                [ otherEndStub, extent ],\r\n                                [ otherEndStub, endStub ]\r\n                            ]\r\n                        }[axis];\r\n                    },\r\n                    opposite: function (axis, ss, oss, es) {\r\n                        var pi = paintInfo,\r\n                            otherAxis = {\"x\": \"y\", \"y\": \"x\"}[axis],\r\n                            dim = {\"x\": \"height\", \"y\": \"width\"}[axis],\r\n                            comparator = pi[\"is\" + axis.toUpperCase() + \"GreaterThanStubTimes2\"];\r\n\r\n                        if (params.sourceEndpoint.elementId == params.targetEndpoint.elementId) {\r\n                            var _val = oss + ((1 - params.sourceEndpoint.anchor[otherAxis]) * params.sourceInfo[dim]) + _super.maxStub;\r\n                            return {\r\n                                \"x\": [\r\n                                    [ ss, _val ],\r\n                                    [ es, _val ]\r\n                                ],\r\n                                \"y\": [\r\n                                    [ _val, ss ],\r\n                                    [ _val, es ]\r\n                                ]\r\n                            }[axis];\r\n\r\n                        }\r\n                        else if (!comparator || (pi.so[idx] == 1 && ss > es) || (pi.so[idx] == -1 && ss < es)) {\r\n                            return {\r\n                                \"x\": [\r\n                                    [ ss, midy ],\r\n                                    [ es, midy ]\r\n                                ],\r\n                                \"y\": [\r\n                                    [ midx, ss ],\r\n                                    [ midx, es ]\r\n                                ]\r\n                            }[axis];\r\n                        }\r\n                        else if ((pi.so[idx] == 1 && ss < es) || (pi.so[idx] == -1 && ss > es)) {\r\n                            return {\r\n                                \"x\": [\r\n                                    [ midx, pi.sy ],\r\n                                    [ midx, pi.ty ]\r\n                                ],\r\n                                \"y\": [\r\n                                    [ pi.sx, midy ],\r\n                                    [ pi.tx, midy ]\r\n                                ]\r\n                            }[axis];\r\n                        }\r\n                    }\r\n                };\r\n\r\n            var stubs = stubCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis),\r\n                idx = paintInfo.sourceAxis == \"x\" ? 0 : 1,\r\n                oidx = paintInfo.sourceAxis == \"x\" ? 1 : 0,\r\n                ss = stubs[idx],\r\n                oss = stubs[oidx],\r\n                es = stubs[idx + 2],\r\n                oes = stubs[oidx + 2];\r\n\r\n            // add the start stub segment.\r\n            addSegment(segments, stubs[0], stubs[1], paintInfo);\r\n\r\n            // compute the rest of the line\r\n            var p = lineCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis, ss, oss, es, oes);\r\n            if (p) {\r\n                for (var i = 0; i < p.length; i++) {\r\n                    addSegment(segments, p[i][0], p[i][1], paintInfo);\r\n                }\r\n            }\r\n\r\n            // line to end stub\r\n            addSegment(segments, stubs[2], stubs[3], paintInfo);\r\n\r\n            // end stub to end\r\n            addSegment(segments, paintInfo.tx, paintInfo.ty, paintInfo);\r\n\r\n            writeSegments(this, segments, paintInfo);\r\n        };\r\n\r\n        this.getPath = function () {\r\n            var _last = null, _lastAxis = null, s = [], segs = userSuppliedSegments || segments;\r\n            for (var i = 0; i < segs.length; i++) {\r\n                var seg = segs[i], axis = seg[4], axisIndex = (axis == \"v\" ? 3 : 2);\r\n                if (_last != null && _lastAxis === axis) {\r\n                    _last[axisIndex] = seg[axisIndex];\r\n                }\r\n                else {\r\n                    if (seg[0] != seg[2] || seg[1] != seg[3]) {\r\n                        s.push({\r\n                            start: [ seg[0], seg[1] ],\r\n                            end: [ seg[2], seg[3] ]\r\n                        });\r\n                        _last = seg;\r\n                        _lastAxis = seg[4];\r\n                    }\r\n                }\r\n            }\r\n            return s;\r\n        };\r\n\r\n        this.setPath = function (path) {\r\n            userSuppliedSegments = [];\r\n            for (var i = 0; i < path.length; i++) {\r\n                var lx = path[i].start[0],\r\n                    ly = path[i].start[1],\r\n                    x = path[i].end[0],\r\n                    y = path[i].end[1],\r\n                    o = lx == x ? \"v\" : \"h\",\r\n                    sgnx = sgn(x - lx),\r\n                    sgny = sgn(y - ly);\r\n\r\n                userSuppliedSegments.push([lx, ly, x, y, o, sgnx, sgny]);\r\n            }\r\n        };\r\n    };\r\n\r\n    _ju.extend(Flowchart, _jp.Connectors.AbstractConnector);\r\n    _jp.registerConnectorType(Flowchart, \"Flowchart\");\r\n}).call(this);\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the state machine connectors.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    var _segment = function (x1, y1, x2, y2) {\r\n            if (x1 <= x2 && y2 <= y1) return 1;\r\n            else if (x1 <= x2 && y1 <= y2) return 2;\r\n            else if (x2 <= x1 && y2 >= y1) return 3;\r\n            return 4;\r\n        },\r\n\r\n    // the control point we will use depends on the faces to which each end of the connection is assigned, specifically whether or not the\r\n    // two faces are parallel or perpendicular.  if they are parallel then the control point lies on the midpoint of the axis in which they\r\n    // are parellel and varies only in the other axis; this variation is proportional to the distance that the anchor points lie from the\r\n    // center of that face.  if the two faces are perpendicular then the control point is at some distance from both the midpoints; the amount and\r\n    // direction are dependent on the orientation of the two elements. 'seg', passed in to this method, tells you which segment the target element\r\n    // lies in with respect to the source: 1 is top right, 2 is bottom right, 3 is bottom left, 4 is top left.\r\n    //\r\n    // sourcePos and targetPos are arrays of info about where on the source and target each anchor is located.  their contents are:\r\n    //\r\n    // 0 - absolute x\r\n    // 1 - absolute y\r\n    // 2 - proportional x in element (0 is left edge, 1 is right edge)\r\n    // 3 - proportional y in element (0 is top edge, 1 is bottom edge)\r\n    //\r\n        _findControlPoint = function (midx, midy, segment, sourceEdge, targetEdge, dx, dy, distance, proximityLimit) {\r\n            // TODO (maybe)\r\n            // - if anchor pos is 0.5, make the control point take into account the relative position of the elements.\r\n            if (distance <= proximityLimit) return [midx, midy];\r\n\r\n            if (segment === 1) {\r\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\r\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\r\n                else return [ midx + (-1 * dx) , midy + (-1 * dy) ];\r\n            }\r\n            else if (segment === 2) {\r\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\r\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\r\n                else return [ midx + dx, midy + (-1 * dy) ];\r\n            }\r\n            else if (segment === 3) {\r\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\r\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\r\n                else return [ midx + (-1 * dx) , midy + (-1 * dy) ];\r\n            }\r\n            else if (segment === 4) {\r\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\r\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\r\n                else return [ midx + dx , midy + (-1 * dy) ];\r\n            }\r\n\r\n        };\r\n\r\n    var StateMachine = function (params) {\r\n        params = params || {};\r\n        this.type = \"StateMachine\";\r\n\r\n        var _super = _jp.Connectors.AbstractConnector.apply(this, arguments),\r\n            curviness = params.curviness || 10,\r\n            margin = params.margin || 5,\r\n            proximityLimit = params.proximityLimit || 80,\r\n            clockwise = params.orientation && params.orientation === \"clockwise\",\r\n            loopbackRadius = params.loopbackRadius || 25,\r\n            showLoopback = params.showLoopback !== false;\r\n\r\n        this._compute = function (paintInfo, params) {\r\n            var w = Math.abs(params.sourcePos[0] - params.targetPos[0]),\r\n                h = Math.abs(params.sourcePos[1] - params.targetPos[1]);\r\n\r\n            if (!showLoopback || (params.sourceEndpoint.elementId !== params.targetEndpoint.elementId)) {\r\n                var _sx = params.sourcePos[0] < params.targetPos[0] ? 0 : w,\r\n                    _sy = params.sourcePos[1] < params.targetPos[1] ? 0 : h,\r\n                    _tx = params.sourcePos[0] < params.targetPos[0] ? w : 0,\r\n                    _ty = params.sourcePos[1] < params.targetPos[1] ? h : 0;\r\n\r\n                // now adjust for the margin\r\n                if (params.sourcePos[2] === 0) _sx -= margin;\r\n                if (params.sourcePos[2] === 1) _sx += margin;\r\n                if (params.sourcePos[3] === 0) _sy -= margin;\r\n                if (params.sourcePos[3] === 1) _sy += margin;\r\n                if (params.targetPos[2] === 0) _tx -= margin;\r\n                if (params.targetPos[2] === 1) _tx += margin;\r\n                if (params.targetPos[3] === 0) _ty -= margin;\r\n                if (params.targetPos[3] === 1) _ty += margin;\r\n\r\n                //\r\n                // these connectors are quadratic bezier curves, having a single control point. if both anchors\r\n                // are located at 0.5 on their respective faces, the control point is set to the midpoint and you\r\n                // get a straight line.  this is also the case if the two anchors are within 'proximityLimit', since\r\n                // it seems to make good aesthetic sense to do that. outside of that, the control point is positioned\r\n                // at 'curviness' pixels away along the normal to the straight line connecting the two anchors.\r\n                //\r\n                // there may be two improvements to this.  firstly, we might actually support the notion of avoiding nodes\r\n                // in the UI, or at least making a good effort at doing so.  if a connection would pass underneath some node,\r\n                // for example, we might increase the distance the control point is away from the midpoint in a bid to\r\n                // steer it around that node.  this will work within limits, but i think those limits would also be the likely\r\n                // limits for, once again, aesthetic good sense in the layout of a chart using these connectors.\r\n                //\r\n                // the second possible change is actually two possible changes: firstly, it is possible we should gradually\r\n                // decrease the 'curviness' as the distance between the anchors decreases; start tailing it off to 0 at some\r\n                // point (which should be configurable).  secondly, we might slightly increase the 'curviness' for connectors\r\n                // with respect to how far their anchor is from the center of its respective face. this could either look cool,\r\n                // or stupid, and may indeed work only in a way that is so subtle as to have been a waste of time.\r\n                //\r\n\r\n                var _midx = (_sx + _tx) / 2,\r\n                    _midy = (_sy + _ty) / 2,\r\n                    segment = _segment(_sx, _sy, _tx, _ty),\r\n                    distance = Math.sqrt(Math.pow(_tx - _sx, 2) + Math.pow(_ty - _sy, 2)),\r\n                    // calculate the control point.  this code will be where we'll put in a rudimentary element avoidance scheme; it\r\n                    // will work by extending the control point to force the curve to be, um, curvier.\r\n                    _controlPoint = _findControlPoint(_midx,\r\n                        _midy,\r\n                        segment,\r\n                        params.sourcePos,\r\n                        params.targetPos,\r\n                        curviness, curviness,\r\n                        distance,\r\n                        proximityLimit);\r\n\r\n                _super.addSegment(this, \"Bezier\", {\r\n                    x1: _tx, y1: _ty, x2: _sx, y2: _sy,\r\n                    cp1x: _controlPoint[0], cp1y: _controlPoint[1],\r\n                    cp2x: _controlPoint[0], cp2y: _controlPoint[1]\r\n                });\r\n            }\r\n            else {\r\n                // a loopback connector.  draw an arc from one anchor to the other.\r\n                var x1 = params.sourcePos[0], y1 = params.sourcePos[1] - margin,\r\n                    cx = x1, cy = y1 - loopbackRadius,\r\n                // canvas sizing stuff, to ensure the whole painted area is visible.\r\n                    _w = 2 * loopbackRadius,\r\n                    _h = 2 * loopbackRadius,\r\n                    _x = cx - loopbackRadius,\r\n                    _y = cy - loopbackRadius;\r\n\r\n                paintInfo.points[0] = _x;\r\n                paintInfo.points[1] = _y;\r\n                paintInfo.points[2] = _w;\r\n                paintInfo.points[3] = _h;\r\n\r\n                // ADD AN ARC SEGMENT.\r\n                _super.addSegment(this, \"Arc\", {\r\n                    loopback: true,\r\n                    x1: (x1 - _x) + 4,\r\n                    y1: y1 - _y,\r\n                    startAngle: 0,\r\n                    endAngle: 2 * Math.PI,\r\n                    r: loopbackRadius,\r\n                    ac: !clockwise,\r\n                    x2: (x1 - _x) - 4,\r\n                    y2: y1 - _y,\r\n                    cx: cx - _x,\r\n                    cy: cy - _y\r\n                });\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(StateMachine, _jp.Connectors.AbstractConnector);\r\n    _jp.registerConnectorType(StateMachine, \"StateMachine\");\r\n}).call(this);\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the code for the Bezier connector type.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    var Bezier = function (params) {\r\n        params = params || {};\r\n\r\n        var _super = _jp.Connectors.AbstractConnector.apply(this, arguments),\r\n            majorAnchor = params.curviness || 150,\r\n            minorAnchor = 10;\r\n\r\n        this.type = \"Bezier\";\r\n        this.getCurviness = function () {\r\n            return majorAnchor;\r\n        };\r\n\r\n        this._findControlPoint = function (point, sourceAnchorPosition, targetAnchorPosition, sourceEndpoint, targetEndpoint, soo, too) {\r\n            // determine if the two anchors are perpendicular to each other in their orientation.  we swap the control\r\n            // points around if so (code could be tightened up)\r\n            var perpendicular = soo[0] != too[0] || soo[1] == too[1],\r\n                p = [];\r\n\r\n            if (!perpendicular) {\r\n                if (soo[0] === 0) // X\r\n                    p.push(sourceAnchorPosition[0] < targetAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\r\n                else p.push(point[0] - (majorAnchor * soo[0]));\r\n\r\n                if (soo[1] === 0) // Y\r\n                    p.push(sourceAnchorPosition[1] < targetAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\r\n                else p.push(point[1] + (majorAnchor * too[1]));\r\n            }\r\n            else {\r\n                if (too[0] === 0) // X\r\n                    p.push(targetAnchorPosition[0] < sourceAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\r\n                else p.push(point[0] + (majorAnchor * too[0]));\r\n\r\n                if (too[1] === 0) // Y\r\n                    p.push(targetAnchorPosition[1] < sourceAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\r\n                else p.push(point[1] + (majorAnchor * soo[1]));\r\n            }\r\n\r\n            return p;\r\n        };\r\n\r\n        this._compute = function (paintInfo, p) {\r\n            var sp = p.sourcePos,\r\n                tp = p.targetPos,\r\n                _w = Math.abs(sp[0] - tp[0]),\r\n                _h = Math.abs(sp[1] - tp[1]),\r\n                _sx = sp[0] < tp[0] ? _w : 0,\r\n                _sy = sp[1] < tp[1] ? _h : 0,\r\n                _tx = sp[0] < tp[0] ? 0 : _w,\r\n                _ty = sp[1] < tp[1] ? 0 : _h,\r\n                _CP = this._findControlPoint([_sx, _sy], sp, tp, p.sourceEndpoint, p.targetEndpoint, paintInfo.so, paintInfo.to),\r\n                _CP2 = this._findControlPoint([_tx, _ty], tp, sp, p.targetEndpoint, p.sourceEndpoint, paintInfo.to, paintInfo.so);\r\n\r\n            _super.addSegment(this, \"Bezier\", {\r\n                x1: _sx, y1: _sy, x2: _tx, y2: _ty,\r\n                cp1x: _CP[0], cp1y: _CP[1], cp2x: _CP2[0], cp2y: _CP2[1]\r\n            });\r\n        };\r\n    };\r\n\r\n    _ju.extend(Bezier, _jp.Connectors.AbstractConnector);\r\n    _jp.registerConnectorType(Bezier, \"Bezier\");\r\n\r\n}).call(this);\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the SVG renderers.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n// ************************** SVG utility methods ********************************************\t\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    var svgAttributeMap = {\r\n            \"joinstyle\": \"stroke-linejoin\",\r\n            \"stroke-linejoin\": \"stroke-linejoin\",\r\n            \"stroke-dashoffset\": \"stroke-dashoffset\",\r\n            \"stroke-linecap\": \"stroke-linecap\"\r\n        },\r\n        STROKE_DASHARRAY = \"stroke-dasharray\",\r\n        DASHSTYLE = \"dashstyle\",\r\n        LINEAR_GRADIENT = \"linearGradient\",\r\n        RADIAL_GRADIENT = \"radialGradient\",\r\n        DEFS = \"defs\",\r\n        FILL = \"fill\",\r\n        STOP = \"stop\",\r\n        STROKE = \"stroke\",\r\n        STROKE_WIDTH = \"stroke-width\",\r\n        STYLE = \"style\",\r\n        NONE = \"none\",\r\n        JSPLUMB_GRADIENT = \"jsplumb_gradient_\",\r\n        LINE_WIDTH = \"lineWidth\",\r\n        ns = {\r\n            svg: \"http://www.w3.org/2000/svg\",\r\n            xhtml: \"http://www.w3.org/1999/xhtml\"\r\n        },\r\n        _attr = function (node, attributes) {\r\n            for (var i in attributes)\r\n                node.setAttribute(i, \"\" + attributes[i]);\r\n        },\r\n        _node = function (name, attributes) {\r\n            attributes = attributes || {};\r\n            attributes.version = \"1.1\";\r\n            attributes.xmlns = ns.xhtml;\r\n            return jsPlumb.createElementNS(ns.svg, name, null, null, attributes);\r\n        },\r\n        _pos = function (d) {\r\n            return \"position:absolute;left:\" + d[0] + \"px;top:\" + d[1] + \"px\";\r\n        },\r\n        _clearGradient = function (parent) {\r\n            var els = parent.querySelectorAll(\" defs linearGradient radialGradient\");\r\n            for (var i = 0; i < els.length; i++)\r\n                els[i].parentNode.removeChild(els[i]);\r\n        },\r\n        _updateGradient = function (parent, node, style, dimensions, uiComponent) {\r\n            var id = JSPLUMB_GRADIENT + uiComponent._jsPlumb.instance.idstamp();\r\n            // first clear out any existing gradient\r\n            _clearGradient(parent);\r\n            // this checks for an 'offset' property in the gradient, and in the absence of it, assumes\r\n            // we want a linear gradient. if it's there, we create a radial gradient.\r\n            // it is possible that a more explicit means of defining the gradient type would be\r\n            // better. relying on 'offset' means that we can never have a radial gradient that uses\r\n            // some default offset, for instance.\r\n            // issue 244 suggested the 'gradientUnits' attribute; without this, straight/flowchart connectors with gradients would\r\n            // not show gradients when the line was perfectly horizontal or vertical.\r\n            var g;\r\n            if (!style.gradient.offset)\r\n                g = _node(LINEAR_GRADIENT, {id: id, gradientUnits: \"userSpaceOnUse\"});\r\n            else\r\n                g = _node(RADIAL_GRADIENT, { id: id });\r\n\r\n            var defs = _node(DEFS);\r\n            parent.appendChild(defs);\r\n            defs.appendChild(g);\r\n\r\n            // the svg radial gradient seems to treat stops in the reverse\r\n            // order to how canvas does it.  so we want to keep all the maths the same, but\r\n            // iterate the actual style declarations in reverse order, if the x indexes are not in order.\r\n            for (var i = 0; i < style.gradient.stops.length; i++) {\r\n                var styleToUse = uiComponent.segment == 1 || uiComponent.segment == 2 ? i : style.gradient.stops.length - 1 - i,\r\n                    stopColor = _ju.convertStyle(style.gradient.stops[styleToUse][1], true),\r\n                    s = _node(STOP, {\"offset\": Math.floor(style.gradient.stops[i][0] * 100) + \"%\", \"stop-color\": stopColor});\r\n\r\n                g.appendChild(s);\r\n            }\r\n            var applyGradientTo = style.strokeStyle ? STROKE : FILL;\r\n            node.setAttribute(applyGradientTo, \"url(#\" + id + \")\");\r\n        },\r\n        _applyStyles = function (parent, node, style, dimensions, uiComponent) {\r\n\r\n            node.setAttribute(FILL, style.fillStyle ? _ju.convertStyle(style.fillStyle, true) : NONE);\r\n            node.setAttribute(STROKE, style.strokeStyle ? _ju.convertStyle(style.strokeStyle, true) : NONE);\r\n\r\n            if (style.gradient) {\r\n                _updateGradient(parent, node, style, dimensions, uiComponent);\r\n            }\r\n            else {\r\n                // make sure we clear any existing gradient\r\n                _clearGradient(parent);\r\n                node.setAttribute(STYLE, \"\");\r\n            }\r\n\r\n            if (style.lineWidth) {\r\n                node.setAttribute(STROKE_WIDTH, style.lineWidth);\r\n            }\r\n\r\n            // in SVG there is a stroke-dasharray attribute we can set, and its syntax looks like\r\n            // the syntax in VML but is actually kind of nasty: values are given in the pixel\r\n            // coordinate space, whereas in VML they are multiples of the width of the stroked\r\n            // line, which makes a lot more sense.  for that reason, jsPlumb is supporting both\r\n            // the native svg 'stroke-dasharray' attribute, and also the 'dashstyle' concept from\r\n            // VML, which will be the preferred method.  the code below this converts a dashstyle\r\n            // attribute given in terms of stroke width into a pixel representation, by using the\r\n            // stroke's lineWidth.\r\n            if (style[DASHSTYLE] && style[LINE_WIDTH] && !style[STROKE_DASHARRAY]) {\r\n                var sep = style[DASHSTYLE].indexOf(\",\") == -1 ? \" \" : \",\",\r\n                    parts = style[DASHSTYLE].split(sep),\r\n                    styleToUse = \"\";\r\n                parts.forEach(function (p) {\r\n                    styleToUse += (Math.floor(p * style.lineWidth) + sep);\r\n                });\r\n                node.setAttribute(STROKE_DASHARRAY, styleToUse);\r\n            }\r\n            else if (style[STROKE_DASHARRAY]) {\r\n                node.setAttribute(STROKE_DASHARRAY, style[STROKE_DASHARRAY]);\r\n            }\r\n\r\n            // extra attributes such as join type, dash offset.\r\n            for (var i in svgAttributeMap) {\r\n                if (style[i]) {\r\n                    node.setAttribute(svgAttributeMap[i], style[i]);\r\n                }\r\n            }\r\n        },\r\n        _appendAtIndex = function (svg, path, idx) {\r\n            if (svg.childNodes.length > idx) {\r\n                svg.insertBefore(path, svg.childNodes[idx]);\r\n            }\r\n            else svg.appendChild(path);\r\n        };\r\n\r\n    /**\r\n     utility methods for other objects to use.\r\n     */\r\n    _ju.svg = {\r\n        node: _node,\r\n        attr: _attr,\r\n        pos: _pos\r\n    };\r\n\r\n    // ************************** / SVG utility methods ********************************************\r\n\r\n    /*\r\n     * Base class for SVG components.\r\n     */\r\n    var SvgComponent = function (params) {\r\n        var pointerEventsSpec = params.pointerEventsSpec || \"all\", renderer = {};\r\n\r\n        _jp.jsPlumbUIComponent.apply(this, params.originalArgs);\r\n        this.canvas = null;\r\n        this.path = null;\r\n        this.svg = null;\r\n        this.bgCanvas = null;\r\n\r\n        var clazz = params.cssClass + \" \" + (params.originalArgs[0].cssClass || \"\"),\r\n            svgParams = {\r\n                \"style\": \"\",\r\n                \"width\": 0,\r\n                \"height\": 0,\r\n                \"pointer-events\": pointerEventsSpec,\r\n                \"position\": \"absolute\"\r\n            };\r\n\r\n        this.svg = _node(\"svg\", svgParams);\r\n\r\n        if (params.useDivWrapper) {\r\n            this.canvas = jsPlumb.createElement(\"div\", { position : \"absolute\" });\r\n            _ju.sizeElement(this.canvas, 0, 0, 1, 1);\r\n            this.canvas.className = clazz;\r\n        }\r\n        else {\r\n            _attr(this.svg, { \"class\": clazz });\r\n            this.canvas = this.svg;\r\n        }\r\n\r\n        params._jsPlumb.appendElement(this.canvas, params.originalArgs[0].parent);\r\n        if (params.useDivWrapper) this.canvas.appendChild(this.svg);\r\n\r\n        var displayElements = [ this.canvas ];\r\n        this.getDisplayElements = function () {\r\n            return displayElements;\r\n        };\r\n\r\n        this.appendDisplayElement = function (el) {\r\n            displayElements.push(el);\r\n        };\r\n\r\n        this.paint = function (style, anchor, extents) {\r\n            if (style != null) {\r\n\r\n                var xy = [ this.x, this.y ], wh = [ this.w, this.h ], p;\r\n                if (extents != null) {\r\n                    if (extents.xmin < 0) xy[0] += extents.xmin;\r\n                    if (extents.ymin < 0) xy[1] += extents.ymin;\r\n                    wh[0] = extents.xmax + ((extents.xmin < 0) ? -extents.xmin : 0);\r\n                    wh[1] = extents.ymax + ((extents.ymin < 0) ? -extents.ymin : 0);\r\n                }\r\n\r\n                if (params.useDivWrapper) {\r\n                    _ju.sizeElement(this.canvas, xy[0], xy[1], wh[0], wh[1]);\r\n                    xy[0] = 0;\r\n                    xy[1] = 0;\r\n                    p = _pos([ 0, 0 ]);\r\n                }\r\n                else\r\n                    p = _pos([ xy[0], xy[1] ]);\r\n\r\n                renderer.paint.apply(this, arguments);\r\n\r\n                _attr(this.svg, {\r\n                    \"style\": p,\r\n                    \"width\": wh[0] || 0,\r\n                    \"height\": wh[1] || 0\r\n                });\r\n            }\r\n        };\r\n\r\n        return {\r\n            renderer: renderer\r\n        };\r\n    };\r\n\r\n    _ju.extend(SvgComponent, _jp.jsPlumbUIComponent, {\r\n        cleanup: function (force) {\r\n            if (force || this.typeId == null) {\r\n                if (this.canvas) this.canvas._jsPlumb = null;\r\n                if (this.svg) this.svg._jsPlumb = null;\r\n                if (this.bgCanvas) this.bgCanvas._jsPlumb = null;\r\n\r\n                if (this.canvas && this.canvas.parentNode)\r\n                    this.canvas.parentNode.removeChild(this.canvas);\r\n                if (this.bgCanvas && this.bgCanvas.parentNode)\r\n                    this.canvas.parentNode.removeChild(this.canvas);\r\n\r\n                this.svg = null;\r\n                this.canvas = null;\r\n                this.path = null;\r\n                this.group = null;\r\n            }\r\n            else {\r\n                // if not a forced cleanup, just detach from DOM for now.\r\n                if (this.canvas && this.canvas.parentNode) this.canvas.parentNode.removeChild(this.canvas);\r\n                if (this.bgCanvas && this.bgCanvas.parentNode) this.bgCanvas.parentNode.removeChild(this.bgCanvas);\r\n            }\r\n        },\r\n        reattach:function(instance) {\r\n            var c = instance.getContainer();\r\n            if (this.canvas && this.canvas.parentNode == null) c.appendChild(this.canvas);\r\n            if (this.bgCanvas && this.bgCanvas.parentNode == null) c.appendChild(this.bgCanvas);\r\n        },\r\n        setVisible: function (v) {\r\n            if (this.canvas) {\r\n                this.canvas.style.display = v ? \"block\" : \"none\";\r\n            }\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Base class for SVG connectors.\r\n     */\r\n    _jp.ConnectorRenderers.svg = function (params) {\r\n        var self = this,\r\n            _super = SvgComponent.apply(this, [\r\n                {\r\n                    cssClass: params._jsPlumb.connectorClass,\r\n                    originalArgs: arguments,\r\n                    pointerEventsSpec: \"none\",\r\n                    _jsPlumb: params._jsPlumb\r\n                }\r\n            ]);\r\n\r\n        _super.renderer.paint = function (style, anchor, extents) {\r\n\r\n            var segments = self.getSegments(), p = \"\", offset = [0, 0];\r\n            if (extents.xmin < 0) offset[0] = -extents.xmin;\r\n            if (extents.ymin < 0) offset[1] = -extents.ymin;\r\n\r\n            if (segments.length > 0) {\r\n\r\n                // create path from segments.\r\n                for (var i = 0; i < segments.length; i++) {\r\n                    p += _jp.Segments.svg.SegmentRenderer.getPath(segments[i]);\r\n                    p += \" \";\r\n                }\r\n\r\n                var a = {\r\n                        d: p,\r\n                        transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\",\r\n                        \"pointer-events\": params[\"pointer-events\"] || \"visibleStroke\"\r\n                    },\r\n                    outlineStyle = null,\r\n                    d = [self.x, self.y, self.w, self.h];\r\n\r\n                // outline style.  actually means drawing an svg object underneath the main one.\r\n                if (style.outlineColor) {\r\n                    var outlineWidth = style.outlineWidth || 1,\r\n                        outlineStrokeWidth = style.lineWidth + (2 * outlineWidth);\r\n                    outlineStyle = _jp.extend({}, style);\r\n                    delete outlineStyle.gradient;\r\n                    outlineStyle.strokeStyle = _ju.convertStyle(style.outlineColor);\r\n                    outlineStyle.lineWidth = outlineStrokeWidth;\r\n\r\n                    if (self.bgPath == null) {\r\n                        self.bgPath = _node(\"path\", a);\r\n                        _jp.addClass(self.bgPath, _jp.connectorOutlineClass);\r\n                        _appendAtIndex(self.svg, self.bgPath, 0);\r\n                    }\r\n                    else {\r\n                        _attr(self.bgPath, a);\r\n                    }\r\n\r\n                    _applyStyles(self.svg, self.bgPath, outlineStyle, d, self);\r\n                }\r\n\r\n                if (self.path == null) {\r\n                    self.path = _node(\"path\", a);\r\n                    _appendAtIndex(self.svg, self.path, style.outlineColor ? 1 : 0);\r\n                }\r\n                else {\r\n                    _attr(self.path, a);\r\n                }\r\n\r\n                _applyStyles(self.svg, self.path, style, d, self);\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(_jp.ConnectorRenderers.svg, SvgComponent);\r\n\r\n// ******************************* svg segment renderer *****************************************************\t\r\n\r\n    _jp.Segments.svg = {\r\n        SegmentRenderer: {\r\n            getPath: function (segment) {\r\n                return ({\r\n                    \"Straight\": function () {\r\n                        var d = segment.getCoordinates();\r\n                        return \"M \" + d.x1 + \" \" + d.y1 + \" L \" + d.x2 + \" \" + d.y2;\r\n                    },\r\n                    \"Bezier\": function () {\r\n                        var d = segment.params;\r\n                        return \"M \" + d.x1 + \" \" + d.y1 +\r\n                            \" C \" + d.cp1x + \" \" + d.cp1y + \" \" + d.cp2x + \" \" + d.cp2y + \" \" + d.x2 + \" \" + d.y2;\r\n                    },\r\n                    \"Arc\": function () {\r\n                        var d = segment.params,\r\n                            laf = segment.sweep > Math.PI ? 1 : 0,\r\n                            sf = segment.anticlockwise ? 0 : 1;\r\n\r\n                        return \"M\" + segment.x1 + \" \" + segment.y1 + \" A \" + segment.radius + \" \" + d.r + \" 0 \" + laf + \",\" + sf + \" \" + segment.x2 + \" \" + segment.y2;\r\n                    }\r\n                })[segment.type]();\r\n            }\r\n        }\r\n    };\r\n\r\n// ******************************* /svg segments *****************************************************\r\n\r\n    /*\r\n     * Base class for SVG endpoints.\r\n     */\r\n    var SvgEndpoint = _jp.SvgEndpoint = function (params) {\r\n        var _super = SvgComponent.apply(this, [\r\n            {\r\n                cssClass: params._jsPlumb.endpointClass,\r\n                originalArgs: arguments,\r\n                pointerEventsSpec: \"all\",\r\n                useDivWrapper: true,\r\n                _jsPlumb: params._jsPlumb\r\n            }\r\n        ]);\r\n\r\n        _super.renderer.paint = function (style) {\r\n            var s = _jp.extend({}, style);\r\n            if (s.outlineColor) {\r\n                s.strokeWidth = s.outlineWidth;\r\n                s.strokeStyle = _ju.convertStyle(s.outlineColor, true);\r\n            }\r\n\r\n            if (this.node == null) {\r\n                this.node = this.makeNode(s);\r\n                this.svg.appendChild(this.node);\r\n            }\r\n            else if (this.updateNode != null) {\r\n                this.updateNode(this.node);\r\n            }\r\n            _applyStyles(this.svg, this.node, s, [ this.x, this.y, this.w, this.h ], this);\r\n            _pos(this.node, [ this.x, this.y ]);\r\n        }.bind(this);\r\n\r\n    };\r\n    _ju.extend(SvgEndpoint, SvgComponent);\r\n\r\n    /*\r\n     * SVG Dot Endpoint\r\n     */\r\n    _jp.Endpoints.svg.Dot = function () {\r\n        _jp.Endpoints.Dot.apply(this, arguments);\r\n        SvgEndpoint.apply(this, arguments);\r\n        this.makeNode = function (style) {\r\n            return _node(\"circle\", {\r\n                \"cx\": this.w / 2,\r\n                \"cy\": this.h / 2,\r\n                \"r\": this.radius\r\n            });\r\n        };\r\n        this.updateNode = function (node) {\r\n            _attr(node, {\r\n                \"cx\": this.w / 2,\r\n                \"cy\": this.h / 2,\r\n                \"r\": this.radius\r\n            });\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.svg.Dot, [_jp.Endpoints.Dot, SvgEndpoint]);\r\n\r\n    /*\r\n     * SVG Rectangle Endpoint\r\n     */\r\n    _jp.Endpoints.svg.Rectangle = function () {\r\n        _jp.Endpoints.Rectangle.apply(this, arguments);\r\n        SvgEndpoint.apply(this, arguments);\r\n        this.makeNode = function (style) {\r\n            return _node(\"rect\", {\r\n                \"width\": this.w,\r\n                \"height\": this.h\r\n            });\r\n        };\r\n        this.updateNode = function (node) {\r\n            _attr(node, {\r\n                \"width\": this.w,\r\n                \"height\": this.h\r\n            });\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.svg.Rectangle, [_jp.Endpoints.Rectangle, SvgEndpoint]);\r\n\r\n    /*\r\n     * SVG Image Endpoint is the default image endpoint.\r\n     */\r\n    _jp.Endpoints.svg.Image = _jp.Endpoints.Image;\r\n    /*\r\n     * Blank endpoint in svg renderer is the default Blank endpoint.\r\n     */\r\n    _jp.Endpoints.svg.Blank = _jp.Endpoints.Blank;\r\n    /*\r\n     * Label overlay in svg renderer is the default Label overlay.\r\n     */\r\n    _jp.Overlays.svg.Label = _jp.Overlays.Label;\r\n    /*\r\n     * Custom overlay in svg renderer is the default Custom overlay.\r\n     */\r\n    _jp.Overlays.svg.Custom = _jp.Overlays.Custom;\r\n\r\n    var AbstractSvgArrowOverlay = function (superclass, originalArgs) {\r\n        superclass.apply(this, originalArgs);\r\n        _jp.jsPlumbUIComponent.apply(this, originalArgs);\r\n        this.isAppendedAtTopLevel = false;\r\n        var self = this;\r\n        this.path = null;\r\n        this.paint = function (params, containerExtents) {\r\n            // only draws on connections, not endpoints.\r\n            if (params.component.svg && containerExtents) {\r\n                if (this.path == null) {\r\n                    this.path = _node(\"path\", {\r\n                        \"pointer-events\": \"all\"\r\n                    });\r\n                    params.component.svg.appendChild(this.path);\r\n\r\n                    this.canvas = params.component.svg; // for the sake of completeness; this behaves the same as other overlays\r\n                }\r\n                var clazz = originalArgs && (originalArgs.length == 1) ? (originalArgs[0].cssClass || \"\") : \"\",\r\n                    offset = [0, 0];\r\n\r\n                if (containerExtents.xmin < 0) offset[0] = -containerExtents.xmin;\r\n                if (containerExtents.ymin < 0) offset[1] = -containerExtents.ymin;\r\n\r\n                _attr(this.path, {\r\n                    \"d\": makePath(params.d),\r\n                    \"class\": clazz,\r\n                    stroke: params.strokeStyle ? params.strokeStyle : null,\r\n                    fill: params.fillStyle ? params.fillStyle : null,\r\n                    transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\r\n                });\r\n            }\r\n        };\r\n        var makePath = function (d) {\r\n            return (isNaN(d.cxy.x) || isNaN(d.cxy.y)) ? \"\" : \"M\" + d.hxy.x + \",\" + d.hxy.y +\r\n                \" L\" + d.tail[0].x + \",\" + d.tail[0].y +\r\n                \" L\" + d.cxy.x + \",\" + d.cxy.y +\r\n                \" L\" + d.tail[1].x + \",\" + d.tail[1].y +\r\n                \" L\" + d.hxy.x + \",\" + d.hxy.y;\r\n        };\r\n        this.transfer = function(target) {\r\n            if (target.canvas && this.path && this.path.parentNode) {\r\n                this.path.parentNode.removeChild(this.path);\r\n                target.canvas.appendChild(this.path);\r\n            }\r\n        };\r\n    };\r\n    _ju.extend(AbstractSvgArrowOverlay, [_jp.jsPlumbUIComponent, _jp.Overlays.AbstractOverlay], {\r\n        cleanup: function (force) {\r\n            if (this.path != null) {\r\n                if (force)\r\n                    this._jsPlumb.instance.removeElement(this.path);\r\n                else\r\n                    if (this.path.parentNode)\r\n                        this.path.parentNode.removeChild(this.path);\r\n            }\r\n        },\r\n        reattach:function(instance) {\r\n            if (this.path && this.canvas && this.path.parentNode == null)\r\n                this.canvas.appendChild(this.path);\r\n        },\r\n        setVisible: function (v) {\r\n            if (this.path != null) (this.path.style.display = (v ? \"block\" : \"none\"));\r\n        }\r\n    });\r\n\r\n    _jp.Overlays.svg.Arrow = function () {\r\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Arrow, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.svg.Arrow, [ _jp.Overlays.Arrow, AbstractSvgArrowOverlay ]);\r\n\r\n    _jp.Overlays.svg.PlainArrow = function () {\r\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.PlainArrow, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.svg.PlainArrow, [ _jp.Overlays.PlainArrow, AbstractSvgArrowOverlay ]);\r\n\r\n    _jp.Overlays.svg.Diamond = function () {\r\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Diamond, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.svg.Diamond, [ _jp.Overlays.Diamond, AbstractSvgArrowOverlay ]);\r\n\r\n    // a test\r\n    _jp.Overlays.svg.GuideLines = function () {\r\n        var path = null, self = this, p1_1, p1_2;\r\n        _jp.Overlays.GuideLines.apply(this, arguments);\r\n        this.paint = function (params, containerExtents) {\r\n            if (path == null) {\r\n                path = _node(\"path\");\r\n                params.connector.svg.appendChild(path);\r\n                self.attachListeners(path, params.connector);\r\n                self.attachListeners(path, self);\r\n\r\n                p1_1 = _node(\"path\");\r\n                params.connector.svg.appendChild(p1_1);\r\n                self.attachListeners(p1_1, params.connector);\r\n                self.attachListeners(p1_1, self);\r\n\r\n                p1_2 = _node(\"path\");\r\n                params.connector.svg.appendChild(p1_2);\r\n                self.attachListeners(p1_2, params.connector);\r\n                self.attachListeners(p1_2, self);\r\n            }\r\n\r\n            var offset = [0, 0];\r\n            if (containerExtents.xmin < 0) offset[0] = -containerExtents.xmin;\r\n            if (containerExtents.ymin < 0) offset[1] = -containerExtents.ymin;\r\n\r\n            _attr(path, {\r\n                \"d\": makePath(params.head, params.tail),\r\n                stroke: \"red\",\r\n                fill: null,\r\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\r\n            });\r\n\r\n            _attr(p1_1, {\r\n                \"d\": makePath(params.tailLine[0], params.tailLine[1]),\r\n                stroke: \"blue\",\r\n                fill: null,\r\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\r\n            });\r\n\r\n            _attr(p1_2, {\r\n                \"d\": makePath(params.headLine[0], params.headLine[1]),\r\n                stroke: \"green\",\r\n                fill: null,\r\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\r\n            });\r\n        };\r\n\r\n        var makePath = function (d1, d2) {\r\n            return \"M \" + d1.x + \",\" + d1.y +\r\n                \" L\" + d2.x + \",\" + d2.y;\r\n        };\r\n    };\r\n    _ju.extend(_jp.Overlays.svg.GuideLines, _jp.Overlays.GuideLines);\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the VML renderers.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\r\n\r\n    // http://ajaxian.com/archives/the-vml-changes-in-ie-8\r\n    // http://www.nczonline.net/blog/2010/01/19/internet-explorer-8-document-and-browser-modes/\r\n    // http://www.louisremi.com/2009/03/30/changes-in-vml-for-ie8-or-what-feature-can-the-ie-dev-team-break-for-you-today/\r\n\r\n    var vmlAttributeMap = {\r\n            \"stroke-linejoin\": \"joinstyle\",\r\n            \"joinstyle\": \"joinstyle\",\r\n            \"endcap\": \"endcap\",\r\n            \"miterlimit\": \"miterlimit\"\r\n        },\r\n        jsPlumbStylesheet = null;\r\n\r\n    if (document.createStyleSheet && document.namespaces) {\r\n\r\n        var ruleClasses = [\r\n                \".jsplumb_vml\", \"jsplumb\\\\:textbox\", \"jsplumb\\\\:oval\", \"jsplumb\\\\:rect\",\r\n                \"jsplumb\\\\:stroke\", \"jsplumb\\\\:shape\", \"jsplumb\\\\:group\"\r\n            ],\r\n            rule = \"behavior:url(#default#VML);position:absolute;\";\r\n\r\n        jsPlumbStylesheet = document.createStyleSheet();\r\n\r\n        for (var i = 0; i < ruleClasses.length; i++)\r\n            jsPlumbStylesheet.addRule(ruleClasses[i], rule);\r\n\r\n        // in this page it is also mentioned that IE requires the extra arg to the namespace\r\n        // http://www.louisremi.com/2009/03/30/changes-in-vml-for-ie8-or-what-feature-can-the-ie-dev-team-break-for-you-today/\r\n        // but someone commented saying they didn't need it, and it seems jsPlumb doesnt need it either.\r\n        // var iev = document.documentMode;\r\n        //if (!iev || iev < 8)\r\n        document.namespaces.add(\"jsplumb\", \"urn:schemas-microsoft-com:vml\");\r\n        //else\r\n        //\tdocument.namespaces.add(\"jsplumb\", \"urn:schemas-microsoft-com:vml\", \"#default#VML\");\r\n    }\r\n\r\n    _jp.vml = {};\r\n\r\n    var scale = 1000,\r\n\r\n        _atts = function (o, atts) {\r\n            for (var i in atts) {\r\n                // IE8 fix: setattribute does not work after an element has been added to the dom!\r\n                // http://www.louisremi.com/2009/03/30/changes-in-vml-for-ie8-or-what-feature-can-the-ie-dev-team-break-for-you-today/\r\n                //o.setAttribute(i, atts[i]);\r\n\r\n                /*There is an additional problem when accessing VML elements by using get/setAttribute. The simple solution is following:\r\n\r\n                 if (document.documentMode==8) {\r\n                 ele.opacity=1;\r\n                 } else {\r\n                 ele.setAttribute(‘opacity’,1);\r\n                 }\r\n                 */\r\n\r\n                o[i] = atts[i];\r\n            }\r\n        },\r\n        _node = function (name, d, atts, parent, _jsPlumb, deferToJsPlumbContainer) {\r\n            atts = atts || {};\r\n            var o = document.createElement(\"jsplumb:\" + name);\r\n            if (deferToJsPlumbContainer)\r\n                _jsPlumb.appendElement(o, parent);\r\n            else\r\n            // TODO is this failing? that would be because parent is not a plain DOM element.\r\n            // IF SO, uncomment the line below this one and remove this one.\r\n                parent.appendChild(o);\r\n            //jsPlumb.getElement(parent).appendChild(o);\r\n\r\n            o.className = (atts[\"class\"] ? atts[\"class\"] + \" \" : \"\") + \"jsplumb_vml\";\r\n            _pos(o, d);\r\n            _atts(o, atts);\r\n            return o;\r\n        },\r\n        _pos = function (o, d, zIndex) {\r\n            o.style.left = d[0] + \"px\";\r\n            o.style.top = d[1] + \"px\";\r\n            o.style.width = d[2] + \"px\";\r\n            o.style.height = d[3] + \"px\";\r\n            o.style.position = \"absolute\";\r\n            if (zIndex)\r\n                o.style.zIndex = zIndex;\r\n        },\r\n        _conv = _jp.vml.convertValue = function (v) {\r\n            return Math.floor(v * scale);\r\n        },\r\n    // tests if the given style is \"transparent\" and then sets the appropriate opacity node to 0 if so,\r\n    // or 1 if not.  TODO in the future, support variable opacity.\r\n        _maybeSetOpacity = function (styleToWrite, styleToCheck, type, component) {\r\n            if (\"transparent\" === styleToCheck)\r\n                component.setOpacity(type, \"0.0\");\r\n            else\r\n                component.setOpacity(type, \"1.0\");\r\n        },\r\n        _applyStyles = function (node, style, component, _jsPlumb) {\r\n            var styleToWrite = {};\r\n            if (style.strokeStyle) {\r\n                styleToWrite.stroked = \"true\";\r\n                var strokeColor = _ju.convertStyle(style.strokeStyle, true);\r\n                styleToWrite.strokecolor = strokeColor;\r\n                _maybeSetOpacity(styleToWrite, strokeColor, \"stroke\", component);\r\n                styleToWrite.strokeweight = style.lineWidth + \"px\";\r\n            }\r\n            else styleToWrite.stroked = \"false\";\r\n\r\n            if (style.fillStyle) {\r\n                styleToWrite.filled = \"true\";\r\n                var fillColor = _ju.convertStyle(style.fillStyle, true);\r\n                styleToWrite.fillcolor = fillColor;\r\n                _maybeSetOpacity(styleToWrite, fillColor, \"fill\", component);\r\n            }\r\n            else styleToWrite.filled = \"false\";\r\n\r\n            if (style.dashstyle) {\r\n                if (component.strokeNode == null) {\r\n                    component.strokeNode = _node(\"stroke\", [0, 0, 0, 0], { dashstyle: style.dashstyle }, node, _jsPlumb);\r\n                }\r\n                else\r\n                    component.strokeNode.dashstyle = style.dashstyle;\r\n            }\r\n            else if (style[\"stroke-dasharray\"] && style.lineWidth) {\r\n                var sep = style[\"stroke-dasharray\"].indexOf(\",\") == -1 ? \" \" : \",\",\r\n                    parts = style[\"stroke-dasharray\"].split(sep),\r\n                    styleToUse = \"\";\r\n                for (var i = 0; i < parts.length; i++) {\r\n                    styleToUse += (Math.floor(parts[i] / style.lineWidth) + sep);\r\n                }\r\n                if (component.strokeNode == null) {\r\n                    component.strokeNode = _node(\"stroke\", [0, 0, 0, 0], { dashstyle: styleToUse }, node, _jsPlumb);\r\n                }\r\n                else\r\n                    component.strokeNode.dashstyle = styleToUse;\r\n            }\r\n\r\n            _atts(node, styleToWrite);\r\n        },\r\n    /*\r\n     * Base class for Vml endpoints and connectors. Extends jsPlumbUIComponent.\r\n     */\r\n        VmlComponent = function () {\r\n            var self = this, renderer = {};\r\n            _jp.jsPlumbUIComponent.apply(this, arguments);\r\n\r\n            this.opacityNodes = {\r\n                \"stroke\": null,\r\n                \"fill\": null\r\n            };\r\n            this.initOpacityNodes = function (vml) {\r\n                self.opacityNodes.stroke = _node(\"stroke\", [0, 0, 1, 1], {opacity: \"0.0\"}, vml, self._jsPlumb.instance);\r\n                self.opacityNodes.fill = _node(\"fill\", [0, 0, 1, 1], {opacity: \"0.0\"}, vml, self._jsPlumb.instance);\r\n            };\r\n            this.setOpacity = function (type, value) {\r\n                var node = self.opacityNodes[type];\r\n                if (node) node.opacity = \"\" + value;\r\n            };\r\n            var displayElements = [ ];\r\n            this.getDisplayElements = function () {\r\n                return displayElements;\r\n            };\r\n\r\n            this.appendDisplayElement = function (el, doNotAppendToCanvas) {\r\n                if (!doNotAppendToCanvas) self.canvas.parentNode.appendChild(el);\r\n                displayElements.push(el);\r\n            };\r\n        };\r\n    _ju.extend(VmlComponent, _jp.jsPlumbUIComponent, {\r\n        cleanup: function () {\r\n            if (this.bgCanvas) this.bgCanvas.parentNode.removeChild(this.bgCanvas);\r\n            if (this.canvas) this.canvas.parentNode.removeChild(this.canvas);\r\n        }\r\n    });\r\n\r\n    /*\r\n     * Base class for Vml connectors. extends VmlComponent.\r\n     */\r\n    var VmlConnector = _jp.ConnectorRenderers.vml = function (params, component) {\r\n        this.strokeNode = null;\r\n        this.canvas = null;\r\n        VmlComponent.apply(this, arguments);\r\n        var clazz = this._jsPlumb.instance.connectorClass + (params.cssClass ? (\" \" + params.cssClass) : \"\");\r\n        this.paint = function (style) {\r\n            if (style !== null) {\r\n\r\n                // we need to be at least 1 pixel in each direction, because otherwise coordsize gets set to\r\n                // 0 and overlays cannot paint.\r\n                this.w = Math.max(this.w, 1);\r\n                this.h = Math.max(this.h, 1);\r\n\r\n                var segments = this.getSegments(), p = { \"path\": \"\" },\r\n                    d = [this.x, this.y, this.w, this.h];\r\n\r\n                // create path from segments.\r\n                for (var i = 0; i < segments.length; i++) {\r\n                    p.path += _jp.Segments.vml.SegmentRenderer.getPath(segments[i]);\r\n                    p.path += \" \";\r\n                }\r\n\r\n                //*\r\n                if (style.outlineColor) {\r\n                    var outlineWidth = style.outlineWidth || 1,\r\n                        outlineStrokeWidth = style.lineWidth + (2 * outlineWidth),\r\n                        outlineStyle = {\r\n                            strokeStyle: _ju.convertStyle(style.outlineColor),\r\n                            lineWidth: outlineStrokeWidth\r\n                        };\r\n                    for (var aa in vmlAttributeMap) outlineStyle[aa] = style[aa];\r\n\r\n                    if (this.bgCanvas == null) {\r\n                        p[\"class\"] = clazz;\r\n                        p.coordsize = (d[2] * scale) + \",\" + (d[3] * scale);\r\n                        this.bgCanvas = _node(\"shape\", d, p, params.parent, this._jsPlumb.instance, true);\r\n                        _pos(this.bgCanvas, d);\r\n                        this.appendDisplayElement(this.bgCanvas, true);\r\n                        this.initOpacityNodes(this.bgCanvas, [\"stroke\"]);\r\n                        this.bgCanvas._jsPlumb = component;\r\n                    }\r\n                    else {\r\n                        p.coordsize = (d[2] * scale) + \",\" + (d[3] * scale);\r\n                        _pos(this.bgCanvas, d);\r\n                        _atts(this.bgCanvas, p);\r\n                    }\r\n\r\n                    _applyStyles(this.bgCanvas, outlineStyle, this);\r\n                }\r\n                //*/\r\n\r\n                if (this.canvas == null) {\r\n                    p[\"class\"] = clazz;\r\n                    p.coordsize = (d[2] * scale) + \",\" + (d[3] * scale);\r\n                    this.canvas = _node(\"shape\", d, p, params.parent, this._jsPlumb.instance, true);\r\n                    this.appendDisplayElement(this.canvas, true);\r\n                    this.initOpacityNodes(this.canvas, [\"stroke\"]);\r\n                    this.canvas._jsPlumb = component;\r\n                }\r\n                else {\r\n                    p.coordsize = (d[2] * scale) + \",\" + (d[3] * scale);\r\n                    _pos(this.canvas, d);\r\n                    _atts(this.canvas, p);\r\n                }\r\n\r\n                _applyStyles(this.canvas, style, this, this._jsPlumb.instance);\r\n            }\r\n        };\r\n\r\n    };\r\n    _ju.extend(VmlConnector, VmlComponent, {\r\n        setVisible: function (v) {\r\n            if (this.canvas) {\r\n                this.canvas.style.display = v ? \"block\" : \"none\";\r\n            }\r\n            if (this.bgCanvas) {\r\n                this.bgCanvas.style.display = v ? \"block\" : \"none\";\r\n            }\r\n        }\r\n    });\r\n\r\n    /*\r\n     *\r\n     * Base class for Vml Endpoints. extends VmlComponent.\r\n     *\r\n     */\r\n    var VmlEndpoint = _jp.VmlEndpoint = function (params) {\r\n        VmlComponent.apply(this, arguments);\r\n        this._jsPlumb.vml = null;//, opacityStrokeNode = null, opacityFillNode = null;\r\n        this.canvas = document.createElement(\"div\");\r\n        this.canvas.style.position = \"absolute\";\r\n        this._jsPlumb.clazz = this._jsPlumb.instance.endpointClass + (params.cssClass ? (\" \" + params.cssClass) : \"\");\r\n\r\n        // TODO vml endpoint adds class to VML at constructor time.  but the addClass method adds VML\r\n        // to the enclosing DIV. what to do?  seems like it would be better to just target the div.\r\n        // HOWEVER...vml connection has no containing div.  why not? it feels like it should.\r\n\r\n        params._jsPlumb.appendElement(this.canvas, params.parent);\r\n\r\n        this.paint = function (style, anchor) {\r\n            var p = { }, vml = this._jsPlumb.vml;\r\n\r\n            _ju.sizeElement(this.canvas, this.x, this.y, this.w, this.h);\r\n            if (this._jsPlumb.vml == null) {\r\n                p[\"class\"] = this._jsPlumb.clazz;\r\n                vml = this._jsPlumb.vml = this.getVml([0, 0, this.w, this.h], p, anchor, this.canvas, this._jsPlumb.instance);\r\n\r\n                this.appendDisplayElement(vml, true);\r\n                this.appendDisplayElement(this.canvas, true);\r\n\r\n                this.initOpacityNodes(vml, [\"fill\"]);\r\n            }\r\n            else {\r\n                _pos(vml, [0, 0, this.w, this.h]);\r\n                _atts(vml, p);\r\n            }\r\n\r\n            _applyStyles(vml, style, this);\r\n        };\r\n    };\r\n    _ju.extend(VmlEndpoint, VmlComponent);\r\n\r\n// ******************************* vml segments *****************************************************\t\r\n\r\n    _jp.Segments.vml = {\r\n        SegmentRenderer: {\r\n            getPath: function (segment) {\r\n                return ({\r\n                    \"Straight\": function (segment) {\r\n                        var d = segment.params;\r\n                        return \"m\" + _conv(d.x1) + \",\" + _conv(d.y1) + \" l\" + _conv(d.x2) + \",\" + _conv(d.y2) + \" e\";\r\n                    },\r\n                    \"Bezier\": function (segment) {\r\n                        var d = segment.params;\r\n                        return \"m\" + _conv(d.x1) + \",\" + _conv(d.y1) +\r\n                            \" c\" + _conv(d.cp1x) + \",\" + _conv(d.cp1y) + \",\" + _conv(d.cp2x) + \",\" + _conv(d.cp2y) + \",\" + _conv(d.x2) + \",\" + _conv(d.y2) + \" e\";\r\n                    },\r\n                    \"Arc\": function (segment) {\r\n                        var d = segment.params,\r\n                            xmin = Math.min(d.x1, d.x2),\r\n                            xmax = Math.max(d.x1, d.x2),\r\n                            ymin = Math.min(d.y1, d.y2),\r\n                            ymax = Math.max(d.y1, d.y2),\r\n                            sf = segment.anticlockwise ? 1 : 0,\r\n                            pathType = (segment.anticlockwise ? \"at \" : \"wa \"),\r\n                            makePosString = function () {\r\n                                if (d.loopback)\r\n                                    return \"0,0,\" + _conv(2 * d.r) + \",\" + _conv(2 * d.r);\r\n\r\n                                var xy = [\r\n                                    null,\r\n                                    [ function () {\r\n                                        return [xmin, ymin ];\r\n                                    }, function () {\r\n                                        return [xmin - d.r, ymin - d.r ];\r\n                                    }],\r\n                                    [ function () {\r\n                                        return [xmin - d.r, ymin ];\r\n                                    }, function () {\r\n                                        return [xmin, ymin - d.r ];\r\n                                    }],\r\n                                    [ function () {\r\n                                        return [xmin - d.r, ymin - d.r ];\r\n                                    }, function () {\r\n                                        return [xmin, ymin ];\r\n                                    }],\r\n                                    [ function () {\r\n                                        return [xmin, ymin - d.r ];\r\n                                    }, function () {\r\n                                        return [xmin - d.r, ymin ];\r\n                                    }]\r\n                                ][segment.segment][sf]();\r\n\r\n                                return _conv(xy[0]) + \",\" + _conv(xy[1]) + \",\" + _conv(xy[0] + (2 * d.r)) + \",\" + _conv(xy[1] + (2 * d.r));\r\n                            };\r\n\r\n                        return pathType + \" \" + makePosString() + \",\" + _conv(d.x1) + \",\" + _conv(d.y1) + \",\" + _conv(d.x2) + \",\" + _conv(d.y2) + \" e\";\r\n                    }\r\n\r\n                })[segment.type](segment);\r\n            }\r\n        }\r\n    };\r\n\r\n// ******************************* /vml segments *****************************************************\t\r\n\r\n// ******************************* vml endpoints *****************************************************\r\n\r\n    _jp.Endpoints.vml.Dot = function () {\r\n        _jp.Endpoints.Dot.apply(this, arguments);\r\n        VmlEndpoint.apply(this, arguments);\r\n        this.getVml = function (d, atts, anchor, parent, _jsPlumb) {\r\n            return _node(\"oval\", d, atts, parent, _jsPlumb);\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.vml.Dot, VmlEndpoint);\r\n\r\n    _jp.Endpoints.vml.Rectangle = function () {\r\n        _jp.Endpoints.Rectangle.apply(this, arguments);\r\n        VmlEndpoint.apply(this, arguments);\r\n        this.getVml = function (d, atts, anchor, parent, _jsPlumb) {\r\n            return _node(\"rect\", d, atts, parent, _jsPlumb);\r\n        };\r\n    };\r\n    _ju.extend(_jp.Endpoints.vml.Rectangle, VmlEndpoint);\r\n\r\n    /*\r\n     * VML Image Endpoint is the same as the default image endpoint.\r\n     */\r\n    _jp.Endpoints.vml.Image = _jp.Endpoints.Image;\r\n\r\n    /**\r\n     * placeholder for Blank endpoint in vml renderer.\r\n     */\r\n    _jp.Endpoints.vml.Blank = _jp.Endpoints.Blank;\r\n\r\n// ******************************* /vml endpoints *****************************************************\t\r\n\r\n// ******************************* vml overlays *****************************************************\r\n\r\n    /**\r\n     * VML Label renderer. uses the default label renderer (which adds an element to the DOM)\r\n     */\r\n    _jp.Overlays.vml.Label = _jp.Overlays.Label;\r\n\r\n    /**\r\n     * VML Custom renderer. uses the default Custom renderer (which adds an element to the DOM)\r\n     */\r\n    _jp.Overlays.vml.Custom = _jp.Overlays.Custom;\r\n\r\n    /**\r\n     * Abstract VML arrow superclass\r\n     */\r\n    var AbstractVmlArrowOverlay = function (superclass, originalArgs) {\r\n        superclass.apply(this, originalArgs);\r\n        VmlComponent.apply(this, originalArgs);\r\n        var self = this, path = null;\r\n        this.canvas = null;\r\n        this.isAppendedAtTopLevel = true;\r\n        var getPath = function (d) {\r\n            return \"m \" + _conv(d.hxy.x) + \",\" + _conv(d.hxy.y) +\r\n                \" l \" + _conv(d.tail[0].x) + \",\" + _conv(d.tail[0].y) +\r\n                \" \" + _conv(d.cxy.x) + \",\" + _conv(d.cxy.y) +\r\n                \" \" + _conv(d.tail[1].x) + \",\" + _conv(d.tail[1].y) +\r\n                \" x e\";\r\n        };\r\n        this.paint = function (params, containerExtents) {\r\n            // only draws for connectors, not endpoints.\r\n            if (params.component.canvas && containerExtents) {\r\n                var p = {}, d = params.d, connector = params.component;\r\n                if (params.strokeStyle) {\r\n                    p.stroked = \"true\";\r\n                    p.strokecolor = _ju.convertStyle(params.strokeStyle, true);\r\n                }\r\n                if (params.lineWidth) p.strokeweight = params.lineWidth + \"px\";\r\n                if (params.fillStyle) {\r\n                    p.filled = \"true\";\r\n                    p.fillcolor = params.fillStyle;\r\n                }\r\n\r\n                var xmin = Math.min(d.hxy.x, d.tail[0].x, d.tail[1].x, d.cxy.x),\r\n                    ymin = Math.min(d.hxy.y, d.tail[0].y, d.tail[1].y, d.cxy.y),\r\n                    xmax = Math.max(d.hxy.x, d.tail[0].x, d.tail[1].x, d.cxy.x),\r\n                    ymax = Math.max(d.hxy.y, d.tail[0].y, d.tail[1].y, d.cxy.y),\r\n                    w = Math.abs(xmax - xmin),\r\n                    h = Math.abs(ymax - ymin),\r\n                    dim = [xmin, ymin, w, h];\r\n\r\n                // for VML, we create overlays using shapes that have the same dimensions and\r\n                // coordsize as their connector - overlays calculate themselves relative to the\r\n                // connector (it's how it's been done since the original canvas implementation, because\r\n                // for canvas that makes sense).\r\n                p.path = getPath(d);\r\n                p.coordsize = (connector.w * scale) + \",\" + (connector.h * scale);\r\n\r\n                dim[0] = connector.x;\r\n                dim[1] = connector.y;\r\n                dim[2] = connector.w;\r\n                dim[3] = connector.h;\r\n\r\n                if (self.canvas == null) {\r\n                    var overlayClass = connector._jsPlumb.overlayClass || \"\";\r\n                    var clazz = originalArgs && (originalArgs.length == 1) ? (originalArgs[0].cssClass || \"\") : \"\";\r\n                    p[\"class\"] = clazz + \" \" + overlayClass;\r\n                    self.canvas = _node(\"shape\", dim, p, connector.canvas.parentNode, connector._jsPlumb.instance, true);\r\n                    connector.appendDisplayElement(self.canvas, true);\r\n                }\r\n                else {\r\n                    _pos(self.canvas, dim);\r\n                    _atts(self.canvas, p);\r\n                }\r\n            }\r\n        };\r\n        this.cleanup = function () {\r\n            if (this.canvas != null) this._jsPlumb.instance.removeElement(this.canvas);\r\n        };\r\n    };\r\n    _ju.extend(AbstractVmlArrowOverlay, [VmlComponent, _jp.Overlays.AbstractOverlay], {\r\n        setVisible: function (state) {\r\n            this.canvas.style.display = state ? \"block\" : \"none\";\r\n        }\r\n    });\r\n\r\n    _jp.Overlays.vml.Arrow = function () {\r\n        AbstractVmlArrowOverlay.apply(this, [_jp.Overlays.Arrow, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.vml.Arrow, [ _jp.Overlays.Arrow, AbstractVmlArrowOverlay ]);\r\n\r\n    _jp.Overlays.vml.PlainArrow = function () {\r\n        AbstractVmlArrowOverlay.apply(this, [_jp.Overlays.PlainArrow, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.vml.PlainArrow, [ _jp.Overlays.PlainArrow, AbstractVmlArrowOverlay ]);\r\n\r\n    _jp.Overlays.vml.Diamond = function () {\r\n        AbstractVmlArrowOverlay.apply(this, [_jp.Overlays.Diamond, arguments]);\r\n    };\r\n    _ju.extend(_jp.Overlays.vml.Diamond, [ _jp.Overlays.Diamond, AbstractVmlArrowOverlay ]);\r\n\r\n// ******************************* /vml overlays *****************************************************    \r\n\r\n}).call(this);\r\n\r\n/*\r\n * jsPlumb\r\n * \r\n * Title:jsPlumb 1.7.6\r\n * \r\n * Provides a way to visually connect elements on an HTML page, using SVG or VML.  \r\n * \r\n * This file contains the 'vanilla' adapter - having no external dependencies other than bundled libs.\r\n *\r\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\r\n * \r\n * http://jsplumbtoolkit.com\r\n * http://github.com/sporritt/jsplumb\r\n * \r\n * Dual licensed under the MIT and GPL2 licenses.\r\n */\r\n;\r\n(function () {\r\n\r\n    \"use strict\";\r\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil,\r\n        _jk = root.Katavorio, _jg = root.Biltong;\r\n\r\n    var _getDragManager = function (instance, category) {\r\n\r\n        category = category || \"main\";\r\n        var key = \"_katavorio_\" + category;\r\n        var k = instance[key],\r\n            e = instance.getEventManager();\r\n\r\n        if (!k) {\r\n            k = new _jk({\r\n                bind: e.on,\r\n                unbind: e.off,\r\n                getSize: jsPlumb.getSize,\r\n                getPosition: function (el) {\r\n                    var o = instance.getOffset(el);\r\n                    return [o.left, o.top];\r\n                },\r\n                setPosition: function (el, xy) {\r\n                    el.style.left = xy[0] + \"px\";\r\n                    el.style.top = xy[1] + \"px\";\r\n                },\r\n                addClass: jsPlumb.addClass,\r\n                removeClass: jsPlumb.removeClass,\r\n                intersects: _jg.intersects,\r\n                indexOf: _ju.indexOf,\r\n                css: {\r\n                    noSelect: instance.dragSelectClass,\r\n                    droppable: \"jsplumb-droppable\",\r\n                    draggable: \"jsplumb-draggable\",\r\n                    drag: \"jsplumb-drag\",\r\n                    selected: \"jsplumb-drag-selected\",\r\n                    active: \"jsplumb-drag-active\",\r\n                    hover: \"jsplumb-drag-hover\"\r\n                }\r\n            });\r\n            instance[key] = k;\r\n            instance.bind(\"zoom\", k.setZoom);\r\n        }\r\n        return k;\r\n    };\r\n\r\n    var _animProps = function (o, p) {\r\n        var _one = function (pName) {\r\n            if (p[pName]) {\r\n                if (_ju.isString(p[pName])) {\r\n                    var m = p[pName].match(/-=/) ? -1 : 1,\r\n                        v = p[pName].substring(2);\r\n                    return o[pName] + (m * v);\r\n                }\r\n                else return p[pName];\r\n            }\r\n            else\r\n                return o[pName];\r\n        };\r\n        return [ _one(\"left\"), _one(\"top\") ];\r\n    };\r\n\r\n    _jp.extend(root.jsPlumbInstance.prototype, {\r\n\r\n        animationSupported:true,\r\n\r\n        scopeChange: function (el, elId, endpoints, scope, types) {\r\n\r\n        },\r\n\r\n        getElement: function (el) {\r\n            if (el == null) return null;\r\n            // here we pluck the first entry if el was a list of entries.\r\n            // this is not my favourite thing to do, but previous versions of\r\n            // jsplumb supported jquery selectors, and it is possible a selector\r\n            // will be passed in here.\r\n            el = typeof el === \"string\" ? el : el.length != null && el.enctype == null ? el[0] : el;\r\n            return typeof el === \"string\" ? document.getElementById(el) : el;\r\n        },\r\n        removeElement: function (element) {\r\n            _getDragManager(this).elementRemoved(element);\r\n            this.getEventManager().remove(element);\r\n        },\r\n        //\r\n        // this adapter supports a rudimentary animation function. no easing is supported.  only\r\n        // left/top properties are supported. property delta args are expected to be in the form\r\n        //\r\n        // +=x.xxxx\r\n        //\r\n        // or\r\n        //\r\n        // -=x.xxxx\r\n        //\r\n        doAnimate: function (el, properties, options) {\r\n            options = options || {};\r\n            var o = this.getOffset(el),\r\n                ap = _animProps(o, properties),\r\n                ldist = ap[0] - o.left,\r\n                tdist = ap[1] - o.top,\r\n                d = options.duration || 250,\r\n                step = 15, steps = d / step,\r\n                linc = (step / d) * ldist,\r\n                tinc = (step / d) * tdist,\r\n                idx = 0,\r\n                int = setInterval(function () {\r\n                    jsPlumb.setPosition(el, {\r\n                        left: o.left + (linc * (idx + 1)),\r\n                        top: o.top + (tinc * (idx + 1))\r\n                    });\r\n                    if (options.step != null) options.step();\r\n                    idx++;\r\n                    if (idx >= steps) {\r\n                        window.clearInterval(int);\r\n                        if (options.complete != null) options.complete();\r\n                    }\r\n                }, step);\r\n        },\r\n        // DRAG/DROP\r\n        destroyDraggable: function (el, category) {\r\n            _getDragManager(this, category).destroyDraggable(el);\r\n        },\r\n        destroyDroppable: function (el, category) {\r\n            _getDragManager(this, category).destroyDroppable(el);\r\n        },\r\n        initDraggable: function (el, options, category) {\r\n            _getDragManager(this, category).draggable(el, options);\r\n        },\r\n        initDroppable: function (el, options, category) {\r\n            _getDragManager(this, category).droppable(el, options);\r\n        },\r\n        isAlreadyDraggable: function (el) {\r\n            return el._katavorioDrag != null;\r\n        },\r\n        isDragSupported: function (el, options) {\r\n            return true;\r\n        },\r\n        isDropSupported: function (el, options) {\r\n            return true;\r\n        },\r\n        isElementDraggable: function (el) {\r\n            el = jsPlumb.getElement(el);\r\n            return el._katavorioDrag && el._katavorioDrag.isEnabled();\r\n        },\r\n        getDragObject: function (eventArgs) {\r\n            return eventArgs[0].drag.getDragElement();\r\n        },\r\n        getDragScope: function (el) {\r\n            return el._katavorioDrag && el._katavorioDrag.scopes.join(\" \") || \"\";\r\n        },\r\n        getDropEvent: function (args) {\r\n            return args[0].e;\r\n        },\r\n        getDropScope: function (el) {\r\n            return el._katavorioDrop && el._katavorioDrop.scopes.join(\" \") || \"\";\r\n        },\r\n        getUIPosition: function (eventArgs, zoom) {\r\n            return {\r\n                left: eventArgs[0].pos[0],\r\n                top: eventArgs[0].pos[1]\r\n            };\r\n        },\r\n        setDragFilter: function (el, filter, _exclude) {\r\n            if (el._katavorioDrag) {\r\n                el._katavorioDrag.setFilter(filter, _exclude);\r\n            }\r\n        },\r\n        setElementDraggable: function (el, draggable) {\r\n            el = jsPlumb.getElement(el);\r\n            if (el._katavorioDrag)\r\n                el._katavorioDrag.setEnabled(draggable);\r\n        },\r\n        setDragScope: function (el, scope) {\r\n            if (el._katavorioDrag)\r\n                el._katavorioDrag.k.setDragScope(el, scope);\r\n        },\r\n        dragEvents: {\r\n            'start': 'start', 'stop': 'stop', 'drag': 'drag', 'step': 'step',\r\n            'over': 'over', 'out': 'out', 'drop': 'drop', 'complete': 'complete'\r\n        },\r\n        animEvents: {\r\n            'step': \"step\", 'complete': 'complete'\r\n        },\r\n        stopDrag: function (el) {\r\n            if (el._katavorioDrag)\r\n                el._katavorioDrag.abort();\r\n        },\r\n// \t\tMULTIPLE ELEMENT DRAG\r\n        // these methods are unique to this adapter, because katavorio\r\n        // supports dragging multiple elements.\r\n        addToDragSelection: function (spec) {\r\n            _getDragManager(this).select(spec);\r\n        },\r\n        removeFromDragSelection: function (spec) {\r\n            _getDragManager(this).deselect(spec);\r\n        },\r\n        clearDragSelection: function () {\r\n            _getDragManager(this).deselectAll();\r\n        },\r\n        getOriginalEvent: function (e) {\r\n            return e;\r\n        },\r\n        // each adapter needs to use its own trigger method, because it triggers a drag. Mottle's trigger method\r\n        // works perfectly well but does not cause a drag to start with jQuery. Presumably this is due to some\r\n        // intricacy in the way in which jQuery UI's draggable method registers events.\r\n        trigger: function (el, event, originalEvent) {\r\n            this.getEventManager().trigger(el, event, originalEvent);\r\n        },\r\n        doReset:function() {\r\n            // look for katavorio instances and reset each one if found.\r\n            for (var key in this) {\r\n                if (key.indexOf(\"_katavorio_\") === 0) {\r\n                    this[key].reset();\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    var ready = function (f) {\r\n        var _do = function () {\r\n            if (/complete|loaded|interactive/.test(document.readyState) && typeof(document.body) != \"undefined\" && document.body != null)\r\n                f();\r\n            else\r\n                setTimeout(_do, 9);\r\n        };\r\n\r\n        _do();\r\n    };\r\n    ready(_jp.init);\r\n\r\n}).call(this);\r\n\ndefine(\"jsPlumb\", function(){});\n\n",
    ";(function() {\r\n\r\n    var root = this;\r\n    var Farahey;\r\n    if (typeof exports !== 'undefined') {\r\n        Farahey = exports;\r\n    } else {\r\n        Farahey = root.Farahey = {};\r\n    } \r\n\r\n    var findInsertionPoint = function(sortedArr, val, comparator) {   \r\n           var low = 0, high = sortedArr.length;\r\n           var mid = -1, c = 0;\r\n           while(low < high)   {\r\n              mid = parseInt((low + high)/2);\r\n              c = comparator(sortedArr[mid], val);\r\n              if(c < 0)   {\r\n                 low = mid + 1;\r\n              }else if(c > 0) {\r\n                 high = mid;\r\n              }else {\r\n                 return mid;\r\n              }\r\n           }\r\n           return low;\r\n        },\r\n        geomSupport = typeof jsPlumbGeom !== \"undefined\" ? jsPlumbGeom : Biltong,\r\n        insertSorted = function(array, value, comparator) {\r\n            var ip = findInsertionPoint(array, value, comparator);\r\n            array.splice(ip, 0, value);\r\n        },\r\n        distanceFromOriginComparator = function(r1, r2, origin) {\r\n            var d1 = geomSupport.lineLength(origin, [ r1.x + (r1.w / 2), r1.y + (r1.h / 2)]),\r\n                d2 = geomSupport.lineLength(origin, [ r2.x + (r2.w / 2), r2.y + (r2.h / 2)]);\r\n\r\n            return d1 < d2 ? -1 : d1 == d2 ? 0 : 1;\r\n        },\r\n        EntryComparator = function(origin, getSize) {\r\n            var _origin = origin,\r\n                _cache = {},\r\n                _get = function(entry) {\r\n                    if (!_cache[entry[1]]) {\r\n                        var s = getSize(entry[2]);\r\n                        _cache[entry[1]] = {\r\n                            l:entry[0][0],\r\n                            t:entry[0][1],\r\n                            w:s[0],\r\n                            h:s[1],\r\n                            center:[entry[0][0] + (s[0] / 2), entry[0][1] + (s[1] / 2) ]\r\n                        };\r\n                    }\r\n                    return _cache[entry[1]];\r\n                }\r\n            this.setOrigin = function(o) {\r\n                _origin = o;\r\n                _cache = {};\r\n            };\r\n            this.compare = function(e1, e2) {\r\n                var d1 = geomSupport.lineLength(_origin, _get(e1).center),\r\n                    d2 = geomSupport.lineLength(_origin, _get(e2).center);\r\n\r\n                return d1 < d2 ? -1 : d1 == d2 ? 0 : 1;\r\n            };\r\n        };\r\n\r\n    var _isOnEdge = function(r, axis, dim, v) { return (r[axis] <= v && v <= r[axis] + r[dim]); },\r\n        _xAdj = [ function(r1, r2) { return r1.x + r1.w - r2.x; }, function(r1, r2) { return r1.x - (r2.x + r2.w); } ],\r\n        _yAdj = [ function(r1, r2) { return r1.y + r1.h - r2.y; }, function(r1, r2) { return r1.y - (r2.y + r2.h); } ],\r\n        _adj = [ null, [ _xAdj[0], _yAdj[1] ], [ _xAdj[0], _yAdj[0] ], [ _xAdj[1], _yAdj[0] ], [ _xAdj[1], _yAdj[1] ] ],                  \r\n        _genAdj = function(r1, r2, m, b, s) {\r\n            if (isNaN(m)) m = 0;\r\n            var y = r2.y + r2.h, \r\n                x = (m == Infinity || m == -Infinity) ? r2.x + (r2.w / 2) :  (y - b) / m,\r\n                theta = Math.atan(m);\r\n\r\n            if (_isOnEdge(r2, \"x\", \"w\", x)) {   \r\n                var rise = _adj[s][1](r1, r2), \r\n                    hyp = rise / Math.sin(theta),\r\n                    run = hyp * Math.cos(theta);\r\n                return { left:run, top:rise };\r\n            }           \r\n            else {\r\n                var run = _adj[s][0](r1, r2),\r\n                    hyp = run / Math.cos(theta),\r\n                    rise = hyp * Math.sin(theta);\r\n                return { left:run, top:rise };\r\n            }\r\n        },            \r\n        /*\r\n        * Calculates how far to move r2 from r1 so that it no longer overlaps.\r\n        * if origin is supplied, then it means we want r2 to move along a vector joining r2's center to that point. \r\n        * otherwise we want it to move along a vector joining the two rectangle centers.\r\n        */\r\n        _calculateSpacingAdjustment = Farahey.calculateSpacingAdjustment = function(r1, r2) {\r\n            var c1 = r1.center || [ r1.x + (r1.w / 2), r1.y + (r1.h / 2) ],\r\n                c2 = r2.center || [ r2.x + (r2.w / 2), r2.y + (r2.h / 2) ],\r\n                m = geomSupport.gradient(c1, c2),\r\n                s = geomSupport.quadrant(c1, c2),\r\n                b = (m == Infinity || m == -Infinity || isNaN(m)) ? 0 : c1[1] - (m * c1[0]);                \r\n\r\n            return _genAdj(r1, r2, m, b, s);        \r\n        },    \r\n        // calculate a padded rectangle for the given element with offset & size, and desired padding.\r\n        _paddedRectangle = Farahey.paddedRectangle = function(o, s, p) {\r\n            return { x:o[0] - p[0], y: o[1] - p[1], w:s[0] + (2 * p[0]), h:s[1] + (2 * p[1]) };\r\n        },\r\n        _magnetize = function(positionArray, positions, sizes, padding, \r\n            constrain, origin, filter,\r\n            updateOnStep, stepInterval, stepCallback) \r\n        {                        \r\n            origin = origin || [0,0];\r\n            stepCallback = stepCallback || function() { };\r\n\r\n            var focus = _paddedRectangle(origin, [1,1], padding),\r\n                iterations = 100, iteration = 1, uncleanRun = true, adjustBy, constrainedAdjustment,\r\n                _movedElements = {},\r\n                _move = function(id, o, x, y) {\r\n                    _movedElements[id] = true;\r\n                    o[0] += x;\r\n                    o[1] += y;\r\n                },\r\n                step = function() {\r\n                    for (var i = 0; i < positionArray.length; i++) {\r\n                        var o1 = positions[positionArray[i][1]],\r\n                            oid = positionArray[i][1],\r\n                            a1 = positionArray[i][2], // angle to node from magnet origin\r\n                            s1 = sizes[positionArray[i][1]],\r\n                            // create a rectangle for first element: this encompasses the element and padding on each\r\n                            //side\r\n                            r1 = _paddedRectangle(o1, s1, padding);\r\n                        \r\n                        if (filter(positionArray[i][1]) && geomSupport.intersects(focus, r1)) {\r\n                            adjustBy = _calculateSpacingAdjustment(focus, r1);\r\n                            constrainedAdjustment = constrain(positionArray[i][1], o1, adjustBy);\r\n                            _move(oid, o1, constrainedAdjustment.left, constrainedAdjustment.top);\r\n                        }\r\n\r\n                        // now move others to account for this one, if necessary.\r\n                        // reset rectangle for node\r\n                        r1 = _paddedRectangle(o1, s1, padding);\r\n                        for (var j = 0; j < positionArray.length; j++) {                        \r\n                            if (i != j) {\r\n                              var o2 = positions[positionArray[j][1]],\r\n                                  a2 = positionArray[j][2], // angle to node from magnet origin\r\n                                  s2 = sizes[positionArray[j][1]],\r\n                                  // create a rectangle for the second element, again by putting padding of the desired\r\n                                  // amount around the bounds of the element.\r\n                                  r2 = _paddedRectangle(o2, s2, padding);\r\n                        \r\n                              // if the two rectangles intersect then figure out how much to move the second one by.\r\n                                if (geomSupport.intersects(r1, r2)) {\r\n                                    // TODO in 0.3, instead of moving neither, the other node should move.\r\n                                    if (filter(positionArray[j][1])) {\r\n                                        uncleanRun = true;                                                                          \r\n                                        adjustBy =  _calculateSpacingAdjustment(r1, r2),\r\n                                        constrainedAdjustment = constrain(positionArray[j][1], o2, adjustBy);\r\n\r\n                                        _move(positionArray[j][1], o2, constrainedAdjustment.left, constrainedAdjustment.top);\r\n                                    }\r\n                                }\r\n                            }\r\n                        } \r\n                    }\r\n\r\n                    if (updateOnStep)\r\n                        stepCallback();\r\n\r\n                    if (uncleanRun && iteration < iterations) {\r\n                        uncleanRun = false;\r\n                        iteration++;\r\n                        if (updateOnStep) {\r\n                            window.setTimeout(step, stepInterval);\r\n                        }\r\n                        else\r\n                            step();\r\n                    }\r\n                };            \r\n\r\n            step();       \r\n            return _movedElements;             \r\n        };\r\n\r\n\r\n        /**\r\n        * @name Magnetizer\r\n        * @classdesc Applies repulsive magnetism to a set of elements relative to a given point, with a specified\r\n        * amount of padding around the point.\r\n        */\r\n\r\n        /**\r\n        * @name Magnetizer#constructor\r\n        * @function\r\n        * @param {Selector|Element} [container] Element that contains the elements to magnetize. Only required if you intend to use the `executeAtEvent` method.\r\n        * @param {Function} [getContainerPosition] Function that returns the position of the container (as an object of the form `{left:.., top:..}`) when requested. Only required if you intend to use the `executeAtEvent` method.\r\n        * @param {Function} getPosition A function that takes an element id and returns its position. It does not matter to which element this position is computed as long as you remain consistent with this method, `setPosition` and the `origin` property.\r\n        * @param {Function} setPosition A function that takes an element id and position, and sets it. See note about offset parent above.\r\n        * @param {Function} getSize A function that takes an element id and returns its size, in pixels.\r\n        * @param {Integer[]} [padding] Optional padding for x and y directions. Defaults to 20 pixels in each direction.\r\n        * @param {Function} [constrain] Optional function that takes an id and a proposed amount of movement in each axis, and returns the allowed amount of movement in each axis. You can use this to constrain your elements to a grid, for instance, or a path, etc.\r\n        * @param {Integer[]} [origin] The origin of magnetization, in pixels. Defaults to 0,0. You can also supply this to the `execute` call.\r\n        * @param {Selector|String[]|Element[]} elements List of elements on which to operate.\r\n        * @param {Boolean} [executeNow=false] Whether or not to execute the routine immediately.\r\n        * @param {Function} [filter] Optional function that takes an element id and returns whether or not that element can be moved.\r\n        * @param {Boolean} [orderByDistanceFromOrigin=false] Whether or not to sort elements first by distance from origin. Can have better results but takes more time.\r\n        */\r\n        root.Magnetizer = function(params) {\r\n            var getPosition = params.getPosition,\r\n                getSize = params.getSize,\r\n                getId = params.getId,\r\n                setPosition = params.setPosition,\r\n                padding = params.padding ||  [20, 20],\r\n                // expects a { left:.., top:... } object. returns how far it can actually go.\r\n                constrain = params.constrain || function(id, current, delta) { return delta; },\r\n                positionArray = [],\r\n                positions = {},\r\n                sizes = {},\r\n                elements = params.elements || [],\r\n                origin = params.origin || [0,0],\r\n                executeNow = params.executeNow,\r\n                minx, miny, maxx, maxy,\r\n                getOrigin = this.getOrigin = function() { return origin; },\r\n                filter = params.filter || function(_) { return true; },\r\n                orderByDistanceFromOrigin = params.orderByDistanceFromOrigin,\r\n                comparator = new EntryComparator(origin, getSize),\r\n                updateOnStep = params.updateOnStep,\r\n                stepInterval = params.stepInterval || 350,\r\n                originDebugMarker,\r\n                debug = params.debug,\r\n                createOriginDebugger = function() {\r\n                    var d = document.createElement(\"div\");\r\n                    d.style.position = \"absolute\";\r\n                    d.style.width = \"10px\";\r\n                    d.style.height = \"10px\";\r\n                    d.style.backgroundColor = \"red\";\r\n                    document.body.appendChild(d);\r\n                    originDebugMarker = d;\r\n                },\r\n                _addToPositionArray = function(p) {\r\n                    if (!orderByDistanceFromOrigin || positionArray.length == 0)\r\n                        positionArray.push(p);\r\n                    else {\r\n                        insertSorted(positionArray, p, comparator.compare);                   \r\n                    }\r\n                },\r\n                _updatePositions = function() {\r\n                    comparator.setOrigin(origin);\r\n                    positionArray = []; positions = {}; sizes = {};\r\n                    minx = miny = Infinity;\r\n                    maxx = maxy = -Infinity;\r\n                    for (var i = 0; i < elements.length; i++) {\r\n                        var p = getPosition(elements[i]),\r\n                            s = getSize(elements[i]),\r\n                            id = getId(elements[i]);\r\n\r\n                        positions[id] = [p.left, p.top];\r\n                        _addToPositionArray([ [p.left, p.top], id, elements[i]]);\r\n                        sizes[id] = s;\r\n                        minx = Math.min(minx, p.left);\r\n                        miny = Math.min(miny, p.top);\r\n                        maxx = Math.max(maxx, p.left + s[0]);\r\n                        maxy = Math.max(maxy, p.top + s[1]);\r\n                    }\r\n                },\r\n                _run = function() {\r\n                    if (elements.length > 1) {\r\n                        var _movedElements = _magnetize(positionArray, positions, sizes, padding, constrain, origin, filter, updateOnStep, stepInterval, _positionElements);                        \r\n                        _positionElements(_movedElements);\r\n                    }\r\n                },\r\n                _positionElements = function(_movedElements) {\r\n                    for (var i = 0; i < elements.length; i++) {\r\n                        var id = getId(elements[i]);\r\n                        if (_movedElements[id])\r\n                            setPosition(elements[i], { left:positions[id][0], top:positions[id][1] });\r\n                    }\r\n                },\r\n                setOrigin = function(o) {\r\n                    if (o != null) {\r\n                        origin = o;\r\n                        comparator.setOrigin(o);\r\n                    }            \r\n                };\r\n\r\n            /**\r\n            * @name Magnetizer#execute\r\n            * @function\r\n            * @desc Runs the magnetize routine.\r\n            * @param {Integer[]} [o] Optional origin to use. You may have set this in the constructor and do not wish to supply it, or you may be happy with the default of [0,0].\r\n            */\r\n            this.execute = function(o) {\r\n                setOrigin(o);\r\n                _updatePositions();\r\n                _run();\r\n            };            \r\n\r\n            /**\r\n            * @name Magnetizer#executeAtCenter\r\n            * @function\r\n            * @desc Computes the center of all the nodes and then uses that as the magnetization origin when it runs the routine.\r\n            */\r\n            this.executeAtCenter = function() {\r\n                _updatePositions();\r\n                setOrigin([\r\n                    (minx + maxx) / 2,\r\n                    (miny + maxy) / 2\r\n                ]);\r\n                _run();\r\n            };\r\n\r\n            /**\r\n            * @name Magnetizer#executeAtEvent\r\n            * @function\r\n            * @desc Runs the magnetize routine using the location of the given event as the origin. To use this\r\n            * method you need to have provided a `container`,  and a `getContainerPosition` function to the\r\n            * constructor.\r\n            * @param {Event} e Event to get origin location from.\r\n            */\r\n            this.executeAtEvent = function(e) {\r\n                var c = params.container, \r\n                    o = params.getContainerPosition(c),\r\n                    x = e.pageX - o.left + c[0].scrollLeft, \r\n                    y = e.pageY - o.top + c[0].scrollTop;\r\n\r\n                if (debug) {\r\n                    originDebugMarker.style.left = e.pageX + \"px\";\r\n                    originDebugMarker.style.top = e.pageY + \"px\";\r\n                }\r\n\r\n                this.execute([x,y]);\r\n            };\r\n\r\n            /**\r\n            * @name Magnetize#setElements\r\n            * @function\r\n            * @desc Sets the current list of elements.\r\n            * @param {Object[]} _els List of elements, in whatever format the magnetizer is setup to use.\r\n            */\r\n            this.setElements = function(_els) {\r\n                elements = _els;\r\n            };\r\n\r\n\r\n            if (debug)\r\n                createOriginDebugger();\r\n\r\n            if (executeNow) this.execute();\r\n\r\n        };\r\n}).call(this);        \r\n\r\n\ndefine(\"farahey\", [\"jsPlumb\"], function(){});\n\n",
    "/**\r\n * Map \"magnetizing\" feature\r\n * jsPlumb extension used: http://morrisonpitt.com/farahey/\r\n */\r\n\r\ndefine('app/map/magnetizing',[\r\n    'jquery',\r\n    'app/map/util',\r\n    'farahey'\r\n], function($, MapUtil) {\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Cached current \"Magnetizer\" object\r\n     * @type {Magnetizer}\r\n     */\r\n    var m8 = null;\r\n\r\n    /**\r\n     * init a jsPlumb (map) Element for \"magnetised\" function.\r\n     * this is optional and prevents systems from being overlapped\r\n     */\r\n    $.fn.initMagnetizer = function(){\r\n        var mapContainer = this;\r\n        var systems = mapContainer.getSystems();\r\n\r\n        /**\r\n         * helper function\r\n         * get current system offset\r\n         * @param system\r\n         * @returns {{left, top}}\r\n         * @private\r\n         */\r\n        var _offset = function(system) {\r\n\r\n            var _ = function(p) {\r\n                var v = system.style[p];\r\n                return parseInt(v.substring(0, v.length - 2));\r\n            };\r\n\r\n            return {\r\n                left:_('left'),\r\n                top:_('top')\r\n            };\r\n        };\r\n\r\n        /**\r\n         * helper function\r\n         * set new system offset\r\n         * @param system\r\n         * @param o\r\n         * @private\r\n         */\r\n        var _setOffset = function(system, o) {\r\n            var markAsUpdated = false;\r\n\r\n            // new position must be within parent container\r\n            // no negative offset!\r\n            if(\r\n                o.left >= 0 &&\r\n                o.left <= 2300\r\n            ){\r\n                markAsUpdated = true;\r\n                system.style.left = o.left + 'px';\r\n            }\r\n\r\n            if(\r\n                o.top >= 0 &&\r\n                o.top <= 498\r\n            ){\r\n                markAsUpdated = true;\r\n                system.style.top = o.top + 'px';\r\n            }\r\n\r\n            if(markAsUpdated === true){\r\n                $(system).markAsChanged();\r\n            }\r\n        };\r\n\r\n        /**\r\n         * helper function\r\n         * exclude current dragged element(s) from position update\r\n         * @param id\r\n         * @returns {boolean}\r\n         * @private\r\n         */\r\n        var _dragFilter = function(id) {\r\n            return !$('#' + id).is('.jsPlumb_dragged, .pf-system-locked');\r\n        };\r\n\r\n        var gridConstrain = function(gridX, gridY) {\r\n            return function(id, current, delta) {\r\n                if( mapContainer.hasClass(MapUtil.config.mapGridClass) ){\r\n                    // active grid\r\n                    return {\r\n                        left:(gridX * Math.floor( (current[0] + delta.left) / gridX )) - current[0],\r\n                        top:(gridY * Math.floor( (current[1] + delta.top) / gridY )) - current[1]\r\n                    };\r\n                }else{\r\n                    // no grid\r\n                    return delta;\r\n                }\r\n            };\r\n        };\r\n\r\n        // main init for \"magnetize\" feature ------------------------------------------------------\r\n        m8 = new Magnetizer({\r\n            container: mapContainer,\r\n            getContainerPosition: function(c) {\r\n                return c.offset();\r\n            },\r\n            getPosition:_offset,\r\n            getSize: function(system) {\r\n                return [ $(system).outerWidth(), $(system).outerHeight() ];\r\n            },\r\n            getId : function(system) {\r\n                return $(system).attr('id');\r\n            },\r\n            setPosition:_setOffset,\r\n            elements: systems,\r\n            filter: _dragFilter,\r\n            padding: [6, 6],\r\n            constrain: gridConstrain(MapUtil.config.mapSnapToGridDimension, MapUtil.config.mapSnapToGridDimension)\r\n        });\r\n    };\r\n\r\n    $.fn.destroyMagnetizer = function(){\r\n        var mapContainer = this;\r\n\r\n        // remove cached \"magnetizer\" instance\r\n        m8 = null;\r\n    };\r\n\r\n    /**\r\n     * update system positions for \"all\" systems that are effected by drag&drop\r\n     * @param map\r\n     * @param e\r\n     */\r\n    var executeAtEvent = function(map, e){\r\n        if(m8 !== null && e ){\r\n            m8.executeAtEvent(e);\r\n            map.repaintEverything();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * rearrange all systems of a map\r\n     * needs \"magnetization\" to be active\r\n     * @param map\r\n     */\r\n    var executeAtCenter = function(map){\r\n        if(m8 !== null){\r\n            m8.executeAtCenter();\r\n            map.repaintEverything();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * set/update elements for \"magnetization\"\r\n     * -> (e.g. new systems was added)\r\n     * @param map\r\n     */\r\n    var setElements = function(map){\r\n        if(m8 !== null){\r\n            var mapContainer = $(map.getContainer());\r\n            var systems = mapContainer.getSystems();\r\n            m8.setElements(systems);\r\n\r\n            // re-arrange systems\r\n            executeAtCenter(map);\r\n        }\r\n    };\r\n\r\n    return {\r\n        executeAtCenter: executeAtCenter,\r\n        executeAtEvent: executeAtEvent,\r\n        setElements: setElements\r\n    };\r\n});\n",
    "/**\r\n * Created by Exodus on 26.06.2016.\r\n */\r\ndefine('app/map/scrollbar',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util'\r\n], function($, Init, Util) {\r\n    'use strict';\r\n\r\n    /**\r\n     * init map scrollbar\r\n     * @param config\r\n     * @returns {*}\r\n     */\r\n    $.fn.initCustomScrollbar = function(config){\r\n\r\n        // default config -------------------------------------------------------------------------\r\n        var defaultConfig = {\r\n            axis: 'x',\r\n            theme: 'light-thick',\r\n            scrollInertia: 300,\r\n            autoExpandScrollbar: false,\r\n            scrollButtons:{\r\n                scrollAmount: 30,\r\n                enable: true\r\n            },\r\n            callbacks:{\r\n                onTotalScrollOffset: 0,\r\n                onTotalScrollBackOffset: 0,\r\n                alwaysTriggerOffsets: true\r\n            },\r\n\r\n            advanced: {\r\n                updateOnBrowserResize: true,\r\n                updateOnContentResize: true,\r\n                autoExpandHorizontalScroll: true,\r\n                autoScrollOnFocus: 'div'\r\n            },\r\n            mouseWheel:{\r\n                enable: false, // scroll weel currently disabled\r\n                scrollAmount: 'auto',\r\n                axis: 'x',\r\n                preventDefault: true\r\n            },\r\n            scrollbarPosition: 'inside',\r\n            autoDraggerLength: true\r\n            //autoHideScrollbar: false\r\n        };\r\n\r\n        // init -----------------------------------------------------------------------------------\r\n        config = $.extend(true, {}, defaultConfig, config);\r\n\r\n        return this.each(function(){\r\n            var scrollableElement = $(this);\r\n\r\n            // prevent multiple initialization\r\n            scrollableElement.mCustomScrollbar('destroy');\r\n\r\n            // init custom scrollbars\r\n            scrollableElement.mCustomScrollbar(config);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * scroll to a specific position in the map\r\n     * demo: http://manos.malihu.gr/repository/custom-scrollbar/demo/examples/scrollTo_demo.html\r\n     * @returns {*} // string or id\r\n     */\r\n    $.fn.scrollToX = function(position){\r\n        return this.each(function(){\r\n            $(this).mCustomScrollbar('scrollTo', position);\r\n        });\r\n    };\r\n});\n",
    "/*\r\n@title:\r\nDrag to Select\r\n\r\n@version:\r\n1.1\r\n\r\n@author:\r\nAndreas Lagerkvist\r\n\r\n@date:\r\n2009-04-06\r\n\r\n@url:\r\nhttp://andreaslagerkvist.com/jquery/drag-to-select/\r\n\r\n@license:\r\nhttp://creativecommons.org/licenses/by/3.0/\r\n\r\n@copyright:\r\n2008 Andreas Lagerkvist (andreaslagerkvist.com)\r\n\r\n@requires:\r\njquery, jquery.dragToSelect.css\r\n\r\n@does:\r\nUse this plug-in to allow your users to select certain elements by dragging a \"select box\". Works very similar to how you can drag-n-select files and folders in most OS:es.\r\n\r\n@howto:\r\n$('#my-files').dragToSelect(selectables: 'li'); would make every li in the #my-files-element selectable by dragging. The li:s will recieve a \"selected\"-class when they are within range of the select box when user drops.\r\n\r\nMake sure a parent-element of the selectables has position: relative as well as overflow: auto or scroll.\r\n\r\n@exampleHTML:\r\n<ul>\r\n\t<li><img src=\"http://exscale.se/__files/3d/lamp-and-mates/lamp-and-mates-01_small.jpg\" alt=\"Lamp and Mates\" /></li>\r\n\t<li><img src=\"http://exscale.se/__files/3d/stugan-winter_small.jpg\" alt=\"The Cottage - Winter time\" /></li>\r\n\t<li><img src=\"http://exscale.se/__files/3d/ps2_small.jpg\" alt=\"PS2\" /></li>\r\n</ul>\r\n\r\n@exampleJS:\r\n$('#jquery-drag-to-select-example').dragToSelect({\r\n\tselectables: 'li', \r\n\tonHide: function () {\r\n\t\talert($('#jquery-drag-to-select-example li.selected').length + ' selected');\r\n\t}\r\n});\r\n*/\r\njQuery.fn.dragToSelect = function (conf) {\r\n\tvar c = typeof(conf) == 'object' ? conf : {};\r\n\r\n\t// Config\r\n\tvar config = jQuery.extend({\r\n\t\tclassName:\t\t'pf-map-drag-to-select',\r\n\t\tactiveClass:\t'active',\r\n\t\tdisabledClass:\t'disabled', \r\n\t\tselectedClass:\t'pf-system-selected',\r\n        ignoredClass:   'pf-system-locked', // do not select locked systems\r\n\t\tscrollTH:\t\t10,\r\n\t\tpercentCovered:\t25, \r\n\t\tselectables:\tfalse,\r\n\t\tautoScroll:\t\tfalse,\r\n\t\tselectOnMove:\tfalse,\r\n\t\tonShow:\t\t\tfunction () {return true;}, \r\n\t\tonHide:\t\t\tfunction () {return true;}, \r\n\t\tonRefresh:\t\tfunction () {return true;}\r\n\t}, c);\r\n\r\n\tvar realParent\t= jQuery(this);\r\n\tvar parent\t\t= realParent;\r\n\r\n\tvar animationFrameId;\r\n\tvar mouseIsDown = false;\r\n\tvar lastMousePosition = { x: 0, y: 0 };\r\n\r\n    // deselected items\r\n    var deselectedItems = $();\r\n\r\n\tdo {\r\n\t\tif (/auto|scroll|hidden/.test(parent.css('overflow'))) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tparent = parent.parent();\r\n\t} while (parent[0].parentNode);\r\n\r\n\t// Does user want to disable dragToSelect\r\n\tif (conf == 'disable') {\r\n\t\tparent.addClass(config.disabledClass);\r\n\t\treturn this;\r\n\t}\r\n\telse if (conf == 'enable') {\r\n\t\tparent.removeClass(config.disabledClass);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tvar parentOffset\t= parent.offset();\r\n\tvar parentDim\t\t= {\r\n\t\tleft:\tparentOffset.left, \r\n\t\ttop:\tparentOffset.top, \r\n\t\twidth:\tparent.width(), \r\n\t\theight:\tparent.height()\r\n\t};\r\n\r\n\t// Current origin of select box\r\n\tvar selectBoxOrigin = {\r\n\t\tleft:\t0,\r\n\t\ttop:\t0\r\n\t};\r\n\r\n\t// Create select box\r\n\tvar selectBox = $('<div>')\r\n\t\t\t\t\t\t.appendTo(parent)\r\n\t\t\t\t\t\t.attr('class', config.className)\r\n\t\t\t\t\t\t.css('position', 'absolute');\r\n\r\n\t// Shows the select box\r\n\tvar showSelectBox = function (e) {\r\n\t\tif (parent.is('.' + config.disabledClass)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tselectBoxOrigin.left\t= e.pageX - parentDim.left + parent[0].scrollLeft - 5;\r\n\t\tselectBoxOrigin.top\t\t= e.pageY - parentDim.top + parent[0].scrollTop - 5;\r\n\r\n\t\tvar css = {\r\n\t\t\tleft:\t\tselectBoxOrigin.left + 'px', \r\n\t\t\ttop:\t\tselectBoxOrigin.top + 'px', \r\n\t\t\twidth:\t\t'1px', \r\n\t\t\theight:\t\t'1px'\r\n\t\t};\r\n\t\tselectBox.addClass(config.activeClass).css(css);\r\n\r\n\t\tconfig.onShow();\r\n\t};\r\n\r\n\t// Refreshes the select box dimensions and possibly position\r\n\tvar refreshSelectBox = function () {\r\n\t\tvar refreshed = false;\r\n\r\n\t\tif (!selectBox.is('.' + config.activeClass) || parent.is('.' + config.disabledClass)) {\r\n\t\t\treturn refreshed;\r\n\t\t}\r\n\r\n        // get scroll position\r\n        var leftScroll  = 0;\r\n        var rightScroll = 0;\r\n\r\n        if(realParent.data('scrollLeft')){\r\n            leftScroll  = realParent.data('scrollLeft');\r\n        }\r\n\r\n        if(realParent.data('scrollRight')){\r\n            rightScroll  = realParent.data('scrollRight');\r\n        }\r\n\r\n\t\tvar left\t\t= lastMousePosition.x - parentDim.left + parent[0].scrollLeft;\r\n\t\tvar top\t\t\t= lastMousePosition.y - parentDim.top + parent[0].scrollTop;\r\n\t\tvar newLeft\t\t= left;\r\n\t\tvar newTop\t\t= top;\r\n\t\tvar tempWidth\t= selectBoxOrigin.left - newLeft ;\r\n\t\tvar newHeight\t= selectBoxOrigin.top - newTop;\r\n        newLeft         = selectBoxOrigin.left - leftScroll;\r\n        var newWidth\t= left - selectBoxOrigin.left;\r\n\r\n\r\n        if(newWidth < 0){\r\n            newLeft = newLeft - tempWidth ;\r\n            newWidth = newWidth * -1;\r\n        }\r\n\r\n\r\n\t\tif (top > selectBoxOrigin.top) {\r\n\t\t\tnewTop\t\t= selectBoxOrigin.top;\r\n\t\t\tnewHeight\t= top - selectBoxOrigin.top;\r\n\t\t}\r\n\r\n\t\t// check if dimension has changed -> save performance\r\n\t\tvar dimensionHash = [newWidth, newHeight].join('_');\r\n\r\n\t\tif(selectBox.data('dimension-hash') !== dimensionHash){\r\n\t\t\tselectBox.data('dimension-hash', dimensionHash);\r\n\t\t\tvar css = {\r\n\t\t\t\tleft:\tnewLeft + 'px',\r\n\t\t\t\ttop:\tnewTop + 'px',\r\n\t\t\t\twidth:\tnewWidth + 'px',\r\n\t\t\t\theight:\tnewHeight + 'px'\r\n\t\t\t};\r\n\r\n\t\t\tselectBox.css(css);\r\n\t\t\tconfig.onRefresh();\r\n\t\t\trefreshed = true;\r\n\t\t}\r\n\r\n\t\treturn refreshed;\r\n\t};\r\n\r\n\t// Hides the select box\r\n\tvar hideSelectBox = function () {\r\n\t\tif (!selectBox.is('.' + config.activeClass) || parent.is('.' + config.disabledClass)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (config.onHide(selectBox, deselectedItems) !== false) {\r\n\t\t\tselectBox.removeClass(config.activeClass);\r\n\t\t}\r\n\t};\r\n\r\n\t// Scrolls parent if needed\r\n\tvar scrollPerhaps = function (e) {\r\n\t\tif (!selectBox.is('.' + config.activeClass) || parent.is('.' + config.disabledClass)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Scroll down\r\n\t\tif ((e.pageY + config.scrollTH) > (parentDim.top + parentDim.height)) {\r\n\t\t\tparent[0].scrollTop += config.scrollTH;\r\n\t\t}\r\n\t\t// Scroll up\r\n\t\tif ((e.pageY - config.scrollTH) < parentDim.top) {\r\n\t\t\tparent[0].scrollTop -= config.scrollTH;\r\n\t\t}\r\n\t\t// Scroll right\r\n\t\tif ((e.pageX + config.scrollTH) > (parentDim.left + parentDim.width)) {\r\n\t\t\tparent[0].scrollLeft += config.scrollTH;\r\n\t\t}\r\n\t\t// Scroll left\r\n\t\tif ((e.pageX - config.scrollTH) < parentDim.left) {\r\n\t\t\tparent[0].scrollLeft -= config.scrollTH;\r\n\t\t}\r\n\t};\r\n\r\n\t// Selects all the elements in the select box's range\r\n\tvar selectElementsInRange = function () {\r\n\t\tif (!selectBox.is('.' + config.activeClass) || parent.is('.' + config.disabledClass)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar selectables\t\t= realParent.find(config.selectables + ':not(.' + config.ignoredClass + ')');\r\n\t\tvar selectBoxOffset\t= selectBox.offset();\r\n\t\tvar selectBoxDim\t= {\r\n\t\t\tleft:\tselectBoxOffset.left, \r\n\t\t\ttop:\tselectBoxOffset.top, \r\n\t\t\twidth:\tselectBox.width(), \r\n\t\t\theight:\tselectBox.height()\r\n\t\t};\r\n\r\n\t\tselectables.each(function (i) {\r\n\t\t\tvar el\t\t\t= $(this);\r\n\t\t\tvar elOffset\t= el.offset();\r\n\t\t\tvar elDim\t\t= {\r\n\t\t\t\tleft:\telOffset.left, \r\n\t\t\t\ttop:\telOffset.top, \r\n\t\t\t\twidth:\tel.width(), \r\n\t\t\t\theight:\tel.height()\r\n\t\t\t};\r\n\r\n\t\t\tif (percentCovered(selectBoxDim, elDim) > config.percentCovered) {\r\n\t\t\t\tel.addClass(config.selectedClass);\r\n\t\t\t\t// remove element from \"deselected\" elements (e.g on add -> remove -> add scenario)\r\n\t\t\t\tdeselectedItems = deselectedItems.not(el);\r\n\t\t\t}else {\r\n\r\n                if(el.hasClass(config.selectedClass)){\r\n                    el.removeClass(config.selectedClass);\r\n\t\t\t\t\tdeselectedItems = deselectedItems.add(el);\r\n                }\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t};\r\n\r\n\t// Returns the amount (in %) that dim1 covers dim2\r\n\tvar percentCovered = function (dim1, dim2) {\r\n\t\t// The whole thing is covering the whole other thing\r\n\t\tif (\r\n\t\t\t(dim1.left <= dim2.left) && \r\n\t\t\t(dim1.top <= dim2.top) && \r\n\t\t\t((dim1.left + dim1.width) >= (dim2.left + dim2.width)) && \r\n\t\t\t((dim1.top + dim1.height) > (dim2.top + dim2.height))\r\n\t\t) {\r\n\t\t\treturn 100;\r\n\t\t}\r\n\t\t// Only parts may be covered, calculate percentage\r\n\t\telse {\r\n\t\t\tdim1.right\t\t= dim1.left + dim1.width;\r\n\t\t\tdim1.bottom\t\t= dim1.top + dim1.height;\r\n\t\t\tdim2.right\t\t= dim2.left + dim2.width;\r\n\t\t\tdim2.bottom\t\t= dim2.top + dim2.height;\r\n\r\n\t\t\tvar l = Math.max(dim1.left, dim2.left);\r\n\t\t\tvar r = Math.min(dim1.right, dim2.right);\r\n\t\t\tvar t = Math.max(dim1.top, dim2.top);\r\n\t\t\tvar b = Math.min(dim1.bottom, dim2.bottom);\r\n\r\n\t\t\tif (b >= t && r >= l) {\r\n\t\t\t/*\t$('<div/>').appendTo(document.body).css({\r\n\t\t\t\t\tbackground:\t'red', \r\n\t\t\t\t\tposition:\t'absolute',\r\n\t\t\t\t\tleft:\t\tl + 'px', \r\n\t\t\t\t\ttop:\t\tt + 'px', \r\n\t\t\t\t\twidth:\t\t(r - l) + 'px', \r\n\t\t\t\t\theight:\t\t(b - t) + 'px', \r\n\t\t\t\t\tzIndex:\t\t100\r\n\t\t\t\t}); */\r\n\r\n\t\t\t\tvar percent = (((r - l) * (b - t)) / (dim2.width * dim2.height)) * 100;\r\n\r\n\t\t\t//\talert(percent + '% covered')\r\n\r\n\t\t\t\treturn percent;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Nothing covered, return 0\r\n\t\treturn 0;\r\n\t};\r\n\r\n\t// Event functions ----------------------------------------------------------------------------\r\n\tvar mousemoveCallback = function(){\r\n\t\tif(mouseIsDown){\r\n\t\t\tvar refreshed = refreshSelectBox();\r\n\r\n\t\t\tif(refreshed && config.selectables && config.selectOnMove){\r\n\t\t\t\tselectElementsInRange();\r\n\t\t\t}\r\n\r\n\t\t\t// recursive re-call on next render\r\n\t\t\tanimationFrameId = requestAnimationFrame(mousemoveCallback);\r\n\t\t}\r\n\t}\r\n\r\n\tvar mouseupCallback = function(){\r\n\t\tif (config.selectables){\r\n\t\t\tselectElementsInRange();\r\n\t\t}\r\n\t\thideSelectBox();\r\n\r\n\t\t// stop animation frame and \"reset\" to default\r\n\t\tcancelAnimationFrame(animationFrameId);\r\n\t\tmouseIsDown = false;\r\n\t\t// reset deselected item array\r\n\t\tdeselectedItems = $();\r\n\t}\r\n\r\n\t// Do the right stuff then return this --------------------------------------------------------\r\n\r\n\tselectBox.mousemove(function(e){\r\n\t\tlastMousePosition.x = e.pageX;\r\n\t\tlastMousePosition.y = e.pageY;\r\n\t\te.preventDefault();\r\n\t}).mouseup(mouseupCallback);\r\n\r\n\tparent.mousedown(function(e){\r\n\t\tif (\r\n\t\t\te.which === 1 && // left mouse down\r\n\t\t\te.target === realParent[0] // prevent while dragging a system :)\r\n\t\t) {\r\n\r\n\t\t\t// Make sure user isn't clicking scrollbar (or disallow clicks far to the right actually)\r\n\t\t\tif ((e.pageX + 20) > jQuery(document.body).width()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tshowSelectBox(e);\r\n\t\t\tmouseIsDown = true;\r\n\t\t\tanimationFrameId = requestAnimationFrame(mousemoveCallback);\r\n\t\t}\r\n\r\n\t\te.preventDefault();\r\n\t}).mousemove(function(e){\r\n\t\tlastMousePosition.x = e.pageX;\r\n\t\tlastMousePosition.y = e.pageY;\r\n\t\te.preventDefault();\r\n\t}).mouseup(mouseupCallback);\r\n\r\n\r\n\t// Be nice\r\n\treturn this;\r\n};\ndefine(\"dragToSelect\", [\"jquery\"], function(){});\n\n",
    "/*! Select2 4.0.3 | https://github.com/select2/select2/blob/master/LICENSE.md */!function(a){\"function\"==typeof define&&define.amd?define('select2',[\"jquery\"],a):a(\"object\"==typeof exports?require(\"jquery\"):jQuery)}(function(a){var b=function(){if(a&&a.fn&&a.fn.select2&&a.fn.select2.amd)var b=a.fn.select2.amd;var b;return function(){if(!b||!b.requirejs){b?c=b:b={};var a,c,d;!function(b){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split(\"/\"),o=s.map,p=o&&o[\"*\"]||{};if(a&&\".\"===a.charAt(0))if(b){for(a=a.split(\"/\"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,\"\")),a=n.slice(0,n.length-1).concat(a),k=0;k<a.length;k+=1)if(m=a[k],\".\"===m)a.splice(k,1),k-=1;else if(\"..\"===m){if(1===k&&(\"..\"===a[2]||\"..\"===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join(\"/\")}else 0===a.indexOf(\"./\")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split(\"/\"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join(\"/\"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join(\"/\")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join(\"/\"))}return a}function g(a,c){return function(){var d=v.call(arguments,0);return\"string\"!=typeof d[0]&&1===d.length&&d.push(null),n.apply(b,d.concat([a,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var c=r[a];delete r[a],t[a]=!0,m.apply(b,c)}if(!e(q,a)&&!e(t,a))throw new Error(\"No \"+a);return q[a]}function k(a){var b,c=a?a.indexOf(\"!\"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+\"!\"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return\"undefined\"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:\"\",exports:q[a],config:l(a)}}},m=function(a,c,d,f){var h,k,l,m,n,s,u=[],v=typeof d;if(f=f||a,\"undefined\"===v||\"function\"===v){for(c=!c.length&&d.length?[\"require\",\"exports\",\"module\"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),k=m.f,\"require\"===k)u[n]=p.require(a);else if(\"exports\"===k)u[n]=p.exports(a),s=!0;else if(\"module\"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+\" missing \"+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d?d.apply(q[a],u):void 0,a&&(h&&h.exports!==b&&h.exports!==q[a]?q[a]=h.exports:l===b&&s||(q[a]=l))}else a&&(q[a]=d)},a=c=n=function(a,c,d,e,f){if(\"string\"==typeof a)return p[a]?p[a](c):j(o(a,c).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(a=c,c=d,d=null):a=b}return c=c||function(){},\"function\"==typeof d&&(d=e,e=f),e?m(b,a,c,d):setTimeout(function(){m(b,a,c,d)},4),n},n.config=function(a){return n(a)},a._defined=q,d=function(a,b,c){if(\"string\"!=typeof a)throw new Error(\"See almond README: incorrect module build, no module name\");b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},d.amd={jQuery:!0}}(),b.requirejs=a,b.require=c,b.define=d}}(),b.define(\"almond\",function(){}),b.define(\"jquery\",[],function(){var b=a||$;return null==b&&console&&console.error&&console.error(\"Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page.\"),b}),b.define(\"select2/utils\",[\"jquery\"],function(a){function b(a){var b=a.prototype,c=[];for(var d in b){var e=b[d];\"function\"==typeof e&&\"constructor\"!==d&&c.push(d)}return c}var c={};c.Extend=function(a,b){function c(){this.constructor=a}var d={}.hasOwnProperty;for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},c.Decorate=function(a,c){function d(){var b=Array.prototype.unshift,d=c.prototype.constructor.length,e=a.prototype.constructor;d>0&&(b.call(arguments,a.prototype.constructor),e=c.prototype.constructor),e.apply(this,arguments)}function e(){this.constructor=d}var f=b(c),g=b(a);c.displayName=a.displayName,d.prototype=new e;for(var h=0;h<g.length;h++){var i=g[h];d.prototype[i]=a.prototype[i]}for(var j=(function(a){var b=function(){};a in d.prototype&&(b=d.prototype[a]);var e=c.prototype[a];return function(){var a=Array.prototype.unshift;return a.call(arguments,b),e.apply(this,arguments)}}),k=0;k<f.length;k++){var l=f[k];d.prototype[l]=j(l)}return d};var d=function(){this.listeners={}};return d.prototype.on=function(a,b){this.listeners=this.listeners||{},a in this.listeners?this.listeners[a].push(b):this.listeners[a]=[b]},d.prototype.trigger=function(a){var b=Array.prototype.slice,c=b.call(arguments,1);this.listeners=this.listeners||{},null==c&&(c=[]),0===c.length&&c.push({}),c[0]._type=a,a in this.listeners&&this.invoke(this.listeners[a],b.call(arguments,1)),\"*\"in this.listeners&&this.invoke(this.listeners[\"*\"],arguments)},d.prototype.invoke=function(a,b){for(var c=0,d=a.length;d>c;c++)a[c].apply(this,b)},c.Observable=d,c.generateChars=function(a){for(var b=\"\",c=0;a>c;c++){var d=Math.floor(36*Math.random());b+=d.toString(36)}return b},c.bind=function(a,b){return function(){a.apply(b,arguments)}},c._convertData=function(a){for(var b in a){var c=b.split(\"-\"),d=a;if(1!==c.length){for(var e=0;e<c.length;e++){var f=c[e];f=f.substring(0,1).toLowerCase()+f.substring(1),f in d||(d[f]={}),e==c.length-1&&(d[f]=a[b]),d=d[f]}delete a[b]}}return a},c.hasScroll=function(b,c){var d=a(c),e=c.style.overflowX,f=c.style.overflowY;return e!==f||\"hidden\"!==f&&\"visible\"!==f?\"scroll\"===e||\"scroll\"===f?!0:d.innerHeight()<c.scrollHeight||d.innerWidth()<c.scrollWidth:!1},c.escapeMarkup=function(a){var b={\"\\\\\":\"&#92;\",\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"/\":\"&#47;\"};return\"string\"!=typeof a?a:String(a).replace(/[&<>\"'\\/\\\\]/g,function(a){return b[a]})},c.appendMany=function(b,c){if(\"1.7\"===a.fn.jquery.substr(0,3)){var d=a();a.map(c,function(a){d=d.add(a)}),c=d}b.append(c)},c}),b.define(\"select2/results\",[\"jquery\",\"./utils\"],function(a,b){function c(a,b,d){this.$element=a,this.data=d,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<ul class=\"select2-results__options\" role=\"tree\"></ul>');return this.options.get(\"multiple\")&&b.attr(\"aria-multiselectable\",\"true\"),this.$results=b,b},c.prototype.clear=function(){this.$results.empty()},c.prototype.displayMessage=function(b){var c=this.options.get(\"escapeMarkup\");this.clear(),this.hideLoading();var d=a('<li role=\"treeitem\" aria-live=\"assertive\" class=\"select2-results__option\"></li>'),e=this.options.get(\"translations\").get(b.message);d.append(c(e(b.args))),d[0].className+=\" select2-results__message\",this.$results.append(d)},c.prototype.hideMessages=function(){this.$results.find(\".select2-results__message\").remove()},c.prototype.append=function(a){this.hideLoading();var b=[];if(null==a.results||0===a.results.length)return void(0===this.$results.children().length&&this.trigger(\"results:message\",{message:\"noResults\"}));a.results=this.sort(a.results);for(var c=0;c<a.results.length;c++){var d=a.results[c],e=this.option(d);b.push(e)}this.$results.append(b)},c.prototype.position=function(a,b){var c=b.find(\".select2-results\");c.append(a)},c.prototype.sort=function(a){var b=this.options.get(\"sorter\");return b(a)},c.prototype.highlightFirstItem=function(){var a=this.$results.find(\".select2-results__option[aria-selected]\"),b=a.filter(\"[aria-selected=true]\");b.length>0?b.first().trigger(\"mouseenter\"):a.first().trigger(\"mouseenter\"),this.ensureHighlightVisible()},c.prototype.setClasses=function(){var b=this;this.data.current(function(c){var d=a.map(c,function(a){return a.id.toString()}),e=b.$results.find(\".select2-results__option[aria-selected]\");e.each(function(){var b=a(this),c=a.data(this,\"data\"),e=\"\"+c.id;null!=c.element&&c.element.selected||null==c.element&&a.inArray(e,d)>-1?b.attr(\"aria-selected\",\"true\"):b.attr(\"aria-selected\",\"false\")})})},c.prototype.showLoading=function(a){this.hideLoading();var b=this.options.get(\"translations\").get(\"searching\"),c={disabled:!0,loading:!0,text:b(a)},d=this.option(c);d.className+=\" loading-results\",this.$results.prepend(d)},c.prototype.hideLoading=function(){this.$results.find(\".loading-results\").remove()},c.prototype.option=function(b){var c=document.createElement(\"li\");c.className=\"select2-results__option\";var d={role:\"treeitem\",\"aria-selected\":\"false\"};b.disabled&&(delete d[\"aria-selected\"],d[\"aria-disabled\"]=\"true\"),null==b.id&&delete d[\"aria-selected\"],null!=b._resultId&&(c.id=b._resultId),b.title&&(c.title=b.title),b.children&&(d.role=\"group\",d[\"aria-label\"]=b.text,delete d[\"aria-selected\"]);for(var e in d){var f=d[e];c.setAttribute(e,f)}if(b.children){var g=a(c),h=document.createElement(\"strong\");h.className=\"select2-results__group\";a(h);this.template(b,h);for(var i=[],j=0;j<b.children.length;j++){var k=b.children[j],l=this.option(k);i.push(l)}var m=a(\"<ul></ul>\",{\"class\":\"select2-results__options select2-results__options--nested\"});m.append(i),g.append(h),g.append(m)}else this.template(b,c);return a.data(c,\"data\",b),c},c.prototype.bind=function(b,c){var d=this,e=b.id+\"-results\";this.$results.attr(\"id\",e),b.on(\"results:all\",function(a){d.clear(),d.append(a.data),b.isOpen()&&(d.setClasses(),d.highlightFirstItem())}),b.on(\"results:append\",function(a){d.append(a.data),b.isOpen()&&d.setClasses()}),b.on(\"query\",function(a){d.hideMessages(),d.showLoading(a)}),b.on(\"select\",function(){b.isOpen()&&(d.setClasses(),d.highlightFirstItem())}),b.on(\"unselect\",function(){b.isOpen()&&(d.setClasses(),d.highlightFirstItem())}),b.on(\"open\",function(){d.$results.attr(\"aria-expanded\",\"true\"),d.$results.attr(\"aria-hidden\",\"false\"),d.setClasses(),d.ensureHighlightVisible()}),b.on(\"close\",function(){d.$results.attr(\"aria-expanded\",\"false\"),d.$results.attr(\"aria-hidden\",\"true\"),d.$results.removeAttr(\"aria-activedescendant\")}),b.on(\"results:toggle\",function(){var a=d.getHighlightedResults();0!==a.length&&a.trigger(\"mouseup\")}),b.on(\"results:select\",function(){var a=d.getHighlightedResults();if(0!==a.length){var b=a.data(\"data\");\"true\"==a.attr(\"aria-selected\")?d.trigger(\"close\",{}):d.trigger(\"select\",{data:b})}}),b.on(\"results:previous\",function(){var a=d.getHighlightedResults(),b=d.$results.find(\"[aria-selected]\"),c=b.index(a);if(0!==c){var e=c-1;0===a.length&&(e=0);var f=b.eq(e);f.trigger(\"mouseenter\");var g=d.$results.offset().top,h=f.offset().top,i=d.$results.scrollTop()+(h-g);0===e?d.$results.scrollTop(0):0>h-g&&d.$results.scrollTop(i)}}),b.on(\"results:next\",function(){var a=d.getHighlightedResults(),b=d.$results.find(\"[aria-selected]\"),c=b.index(a),e=c+1;if(!(e>=b.length)){var f=b.eq(e);f.trigger(\"mouseenter\");var g=d.$results.offset().top+d.$results.outerHeight(!1),h=f.offset().top+f.outerHeight(!1),i=d.$results.scrollTop()+h-g;0===e?d.$results.scrollTop(0):h>g&&d.$results.scrollTop(i)}}),b.on(\"results:focus\",function(a){a.element.addClass(\"select2-results__option--highlighted\")}),b.on(\"results:message\",function(a){d.displayMessage(a)}),a.fn.mousewheel&&this.$results.on(\"mousewheel\",function(a){var b=d.$results.scrollTop(),c=d.$results.get(0).scrollHeight-b+a.deltaY,e=a.deltaY>0&&b-a.deltaY<=0,f=a.deltaY<0&&c<=d.$results.height();e?(d.$results.scrollTop(0),a.preventDefault(),a.stopPropagation()):f&&(d.$results.scrollTop(d.$results.get(0).scrollHeight-d.$results.height()),a.preventDefault(),a.stopPropagation())}),this.$results.on(\"mouseup\",\".select2-results__option[aria-selected]\",function(b){var c=a(this),e=c.data(\"data\");return\"true\"===c.attr(\"aria-selected\")?void(d.options.get(\"multiple\")?d.trigger(\"unselect\",{originalEvent:b,data:e}):d.trigger(\"close\",{})):void d.trigger(\"select\",{originalEvent:b,data:e})}),this.$results.on(\"mouseenter\",\".select2-results__option[aria-selected]\",function(b){var c=a(this).data(\"data\");d.getHighlightedResults().removeClass(\"select2-results__option--highlighted\"),d.trigger(\"results:focus\",{data:c,element:a(this)})})},c.prototype.getHighlightedResults=function(){var a=this.$results.find(\".select2-results__option--highlighted\");return a},c.prototype.destroy=function(){this.$results.remove()},c.prototype.ensureHighlightVisible=function(){var a=this.getHighlightedResults();if(0!==a.length){var b=this.$results.find(\"[aria-selected]\"),c=b.index(a),d=this.$results.offset().top,e=a.offset().top,f=this.$results.scrollTop()+(e-d),g=e-d;f-=2*a.outerHeight(!1),2>=c?this.$results.scrollTop(0):(g>this.$results.outerHeight()||0>g)&&this.$results.scrollTop(f)}},c.prototype.template=function(b,c){var d=this.options.get(\"templateResult\"),e=this.options.get(\"escapeMarkup\"),f=d(b,c);null==f?c.style.display=\"none\":\"string\"==typeof f?c.innerHTML=e(f):a(c).append(f)},c}),b.define(\"select2/keys\",[],function(){var a={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return a}),b.define(\"select2/selection/base\",[\"jquery\",\"../utils\",\"../keys\"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,b.Observable),d.prototype.render=function(){var b=a('<span class=\"select2-selection\" role=\"combobox\"  aria-haspopup=\"true\" aria-expanded=\"false\"></span>');return this._tabindex=0,null!=this.$element.data(\"old-tabindex\")?this._tabindex=this.$element.data(\"old-tabindex\"):null!=this.$element.attr(\"tabindex\")&&(this._tabindex=this.$element.attr(\"tabindex\")),b.attr(\"title\",this.$element.attr(\"title\")),b.attr(\"tabindex\",this._tabindex),this.$selection=b,b},d.prototype.bind=function(a,b){var d=this,e=(a.id+\"-container\",a.id+\"-results\");this.container=a,this.$selection.on(\"focus\",function(a){d.trigger(\"focus\",a)}),this.$selection.on(\"blur\",function(a){d._handleBlur(a)}),this.$selection.on(\"keydown\",function(a){d.trigger(\"keypress\",a),a.which===c.SPACE&&a.preventDefault()}),a.on(\"results:focus\",function(a){d.$selection.attr(\"aria-activedescendant\",a.data._resultId)}),a.on(\"selection:update\",function(a){d.update(a.data)}),a.on(\"open\",function(){d.$selection.attr(\"aria-expanded\",\"true\"),d.$selection.attr(\"aria-owns\",e),d._attachCloseHandler(a)}),a.on(\"close\",function(){d.$selection.attr(\"aria-expanded\",\"false\"),d.$selection.removeAttr(\"aria-activedescendant\"),d.$selection.removeAttr(\"aria-owns\"),d.$selection.focus(),d._detachCloseHandler(a)}),a.on(\"enable\",function(){d.$selection.attr(\"tabindex\",d._tabindex)}),a.on(\"disable\",function(){d.$selection.attr(\"tabindex\",\"-1\")})},d.prototype._handleBlur=function(b){var c=this;window.setTimeout(function(){document.activeElement==c.$selection[0]||a.contains(c.$selection[0],document.activeElement)||c.trigger(\"blur\",b)},1)},d.prototype._attachCloseHandler=function(b){a(document.body).on(\"mousedown.select2.\"+b.id,function(b){var c=a(b.target),d=c.closest(\".select2\"),e=a(\".select2.select2-container--open\");e.each(function(){var b=a(this);if(this!=d[0]){var c=b.data(\"element\");c.select2(\"close\")}})})},d.prototype._detachCloseHandler=function(b){a(document.body).off(\"mousedown.select2.\"+b.id)},d.prototype.position=function(a,b){var c=b.find(\".selection\");c.append(a)},d.prototype.destroy=function(){this._detachCloseHandler(this.container)},d.prototype.update=function(a){throw new Error(\"The `update` method must be defined in child classes.\")},d}),b.define(\"select2/selection/single\",[\"jquery\",\"./base\",\"../utils\",\"../keys\"],function(a,b,c,d){function e(){e.__super__.constructor.apply(this,arguments)}return c.Extend(e,b),e.prototype.render=function(){var a=e.__super__.render.call(this);return a.addClass(\"select2-selection--single\"),a.html('<span class=\"select2-selection__rendered\"></span><span class=\"select2-selection__arrow\" role=\"presentation\"><b role=\"presentation\"></b></span>'),a},e.prototype.bind=function(a,b){var c=this;e.__super__.bind.apply(this,arguments);var d=a.id+\"-container\";this.$selection.find(\".select2-selection__rendered\").attr(\"id\",d),this.$selection.attr(\"aria-labelledby\",d),this.$selection.on(\"mousedown\",function(a){1===a.which&&c.trigger(\"toggle\",{originalEvent:a})}),this.$selection.on(\"focus\",function(a){}),this.$selection.on(\"blur\",function(a){}),a.on(\"focus\",function(b){a.isOpen()||c.$selection.focus()}),a.on(\"selection:update\",function(a){c.update(a.data)})},e.prototype.clear=function(){this.$selection.find(\".select2-selection__rendered\").empty()},e.prototype.display=function(a,b){var c=this.options.get(\"templateSelection\"),d=this.options.get(\"escapeMarkup\");return d(c(a,b))},e.prototype.selectionContainer=function(){return a(\"<span></span>\")},e.prototype.update=function(a){if(0===a.length)return void this.clear();var b=a[0],c=this.$selection.find(\".select2-selection__rendered\"),d=this.display(b,c);c.empty().append(d),c.prop(\"title\",b.title||b.text)},e}),b.define(\"select2/selection/multiple\",[\"jquery\",\"./base\",\"../utils\"],function(a,b,c){function d(a,b){d.__super__.constructor.apply(this,arguments)}return c.Extend(d,b),d.prototype.render=function(){var a=d.__super__.render.call(this);return a.addClass(\"select2-selection--multiple\"),a.html('<ul class=\"select2-selection__rendered\"></ul>'),a},d.prototype.bind=function(b,c){var e=this;d.__super__.bind.apply(this,arguments),this.$selection.on(\"click\",function(a){e.trigger(\"toggle\",{originalEvent:a})}),this.$selection.on(\"click\",\".select2-selection__choice__remove\",function(b){if(!e.options.get(\"disabled\")){var c=a(this),d=c.parent(),f=d.data(\"data\");e.trigger(\"unselect\",{originalEvent:b,data:f})}})},d.prototype.clear=function(){this.$selection.find(\".select2-selection__rendered\").empty()},d.prototype.display=function(a,b){var c=this.options.get(\"templateSelection\"),d=this.options.get(\"escapeMarkup\");return d(c(a,b))},d.prototype.selectionContainer=function(){var b=a('<li class=\"select2-selection__choice\"><span class=\"select2-selection__choice__remove\" role=\"presentation\">&times;</span></li>');return b},d.prototype.update=function(a){if(this.clear(),0!==a.length){for(var b=[],d=0;d<a.length;d++){var e=a[d],f=this.selectionContainer(),g=this.display(e,f);f.append(g),f.prop(\"title\",e.title||e.text),f.data(\"data\",e),b.push(f)}var h=this.$selection.find(\".select2-selection__rendered\");c.appendMany(h,b)}},d}),b.define(\"select2/selection/placeholder\",[\"../utils\"],function(a){function b(a,b,c){this.placeholder=this.normalizePlaceholder(c.get(\"placeholder\")),a.call(this,b,c)}return b.prototype.normalizePlaceholder=function(a,b){return\"string\"==typeof b&&(b={id:\"\",text:b}),b},b.prototype.createPlaceholder=function(a,b){var c=this.selectionContainer();return c.html(this.display(b)),c.addClass(\"select2-selection__placeholder\").removeClass(\"select2-selection__choice\"),c},b.prototype.update=function(a,b){var c=1==b.length&&b[0].id!=this.placeholder.id,d=b.length>1;if(d||c)return a.call(this,b);this.clear();var e=this.createPlaceholder(this.placeholder);this.$selection.find(\".select2-selection__rendered\").append(e)},b}),b.define(\"select2/selection/allowClear\",[\"jquery\",\"../keys\"],function(a,b){function c(){}return c.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),null==this.placeholder&&this.options.get(\"debug\")&&window.console&&console.error&&console.error(\"Select2: The `allowClear` option should be used in combination with the `placeholder` option.\"),this.$selection.on(\"mousedown\",\".select2-selection__clear\",function(a){d._handleClear(a)}),b.on(\"keypress\",function(a){d._handleKeyboardClear(a,b)})},c.prototype._handleClear=function(a,b){if(!this.options.get(\"disabled\")){var c=this.$selection.find(\".select2-selection__clear\");if(0!==c.length){b.stopPropagation();for(var d=c.data(\"data\"),e=0;e<d.length;e++){var f={data:d[e]};if(this.trigger(\"unselect\",f),f.prevented)return}this.$element.val(this.placeholder.id).trigger(\"change\"),this.trigger(\"toggle\",{})}}},c.prototype._handleKeyboardClear=function(a,c,d){d.isOpen()||(c.which==b.DELETE||c.which==b.BACKSPACE)&&this._handleClear(c)},c.prototype.update=function(b,c){if(b.call(this,c),!(this.$selection.find(\".select2-selection__placeholder\").length>0||0===c.length)){var d=a('<span class=\"select2-selection__clear\">&times;</span>');d.data(\"data\",c),this.$selection.find(\".select2-selection__rendered\").prepend(d)}},c}),b.define(\"select2/selection/search\",[\"jquery\",\"../utils\",\"../keys\"],function(a,b,c){function d(a,b,c){a.call(this,b,c)}return d.prototype.render=function(b){var c=a('<li class=\"select2-search select2-search--inline\"><input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" role=\"textbox\" aria-autocomplete=\"list\" /></li>');this.$searchContainer=c,this.$search=c.find(\"input\");var d=b.call(this);return this._transferTabIndex(),d},d.prototype.bind=function(a,b,d){var e=this;a.call(this,b,d),b.on(\"open\",function(){e.$search.trigger(\"focus\")}),b.on(\"close\",function(){e.$search.val(\"\"),e.$search.removeAttr(\"aria-activedescendant\"),e.$search.trigger(\"focus\")}),b.on(\"enable\",function(){e.$search.prop(\"disabled\",!1),e._transferTabIndex()}),b.on(\"disable\",function(){e.$search.prop(\"disabled\",!0)}),b.on(\"focus\",function(a){e.$search.trigger(\"focus\")}),b.on(\"results:focus\",function(a){e.$search.attr(\"aria-activedescendant\",a.id)}),this.$selection.on(\"focusin\",\".select2-search--inline\",function(a){e.trigger(\"focus\",a)}),this.$selection.on(\"focusout\",\".select2-search--inline\",function(a){e._handleBlur(a)}),this.$selection.on(\"keydown\",\".select2-search--inline\",function(a){a.stopPropagation(),e.trigger(\"keypress\",a),e._keyUpPrevented=a.isDefaultPrevented();var b=a.which;if(b===c.BACKSPACE&&\"\"===e.$search.val()){var d=e.$searchContainer.prev(\".select2-selection__choice\");if(d.length>0){var f=d.data(\"data\");e.searchRemoveChoice(f),a.preventDefault()}}});var f=document.documentMode,g=f&&11>=f;this.$selection.on(\"input.searchcheck\",\".select2-search--inline\",function(a){return g?void e.$selection.off(\"input.search input.searchcheck\"):void e.$selection.off(\"keyup.search\")}),this.$selection.on(\"keyup.search input.search\",\".select2-search--inline\",function(a){if(g&&\"input\"===a.type)return void e.$selection.off(\"input.search input.searchcheck\");var b=a.which;b!=c.SHIFT&&b!=c.CTRL&&b!=c.ALT&&b!=c.TAB&&e.handleSearch(a)})},d.prototype._transferTabIndex=function(a){this.$search.attr(\"tabindex\",this.$selection.attr(\"tabindex\")),this.$selection.attr(\"tabindex\",\"-1\")},d.prototype.createPlaceholder=function(a,b){this.$search.attr(\"placeholder\",b.text)},d.prototype.update=function(a,b){var c=this.$search[0]==document.activeElement;this.$search.attr(\"placeholder\",\"\"),a.call(this,b),this.$selection.find(\".select2-selection__rendered\").append(this.$searchContainer),this.resizeSearch(),c&&this.$search.focus()},d.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var a=this.$search.val();this.trigger(\"query\",{term:a})}this._keyUpPrevented=!1},d.prototype.searchRemoveChoice=function(a,b){this.trigger(\"unselect\",{data:b}),this.$search.val(b.text),this.handleSearch()},d.prototype.resizeSearch=function(){this.$search.css(\"width\",\"25px\");var a=\"\";if(\"\"!==this.$search.attr(\"placeholder\"))a=this.$selection.find(\".select2-selection__rendered\").innerWidth();else{var b=this.$search.val().length+1;a=.75*b+\"em\"}this.$search.css(\"width\",a)},d}),b.define(\"select2/selection/eventRelay\",[\"jquery\"],function(a){function b(){}return b.prototype.bind=function(b,c,d){var e=this,f=[\"open\",\"opening\",\"close\",\"closing\",\"select\",\"selecting\",\"unselect\",\"unselecting\"],g=[\"opening\",\"closing\",\"selecting\",\"unselecting\"];b.call(this,c,d),c.on(\"*\",function(b,c){if(-1!==a.inArray(b,f)){c=c||{};var d=a.Event(\"select2:\"+b,{params:c});e.$element.trigger(d),-1!==a.inArray(b,g)&&(c.prevented=d.isDefaultPrevented())}})},b}),b.define(\"select2/translation\",[\"jquery\",\"require\"],function(a,b){function c(a){this.dict=a||{}}return c.prototype.all=function(){return this.dict},c.prototype.get=function(a){return this.dict[a]},c.prototype.extend=function(b){this.dict=a.extend({},b.all(),this.dict)},c._cache={},c.loadPath=function(a){if(!(a in c._cache)){var d=b(a);c._cache[a]=d}return new c(c._cache[a])},c}),b.define(\"select2/diacritics\",[],function(){var a={\"Ⓐ\":\"A\",\"Ａ\":\"A\",\"À\":\"A\",\"Á\":\"A\",\"Â\":\"A\",\"Ầ\":\"A\",\"Ấ\":\"A\",\"Ẫ\":\"A\",\"Ẩ\":\"A\",\"Ã\":\"A\",\"Ā\":\"A\",\"Ă\":\"A\",\"Ằ\":\"A\",\"Ắ\":\"A\",\"Ẵ\":\"A\",\"Ẳ\":\"A\",\"Ȧ\":\"A\",\"Ǡ\":\"A\",\"Ä\":\"A\",\"Ǟ\":\"A\",\"Ả\":\"A\",\"Å\":\"A\",\"Ǻ\":\"A\",\"Ǎ\":\"A\",\"Ȁ\":\"A\",\"Ȃ\":\"A\",\"Ạ\":\"A\",\"Ậ\":\"A\",\"Ặ\":\"A\",\"Ḁ\":\"A\",\"Ą\":\"A\",\"Ⱥ\":\"A\",\"Ɐ\":\"A\",\"Ꜳ\":\"AA\",\"Æ\":\"AE\",\"Ǽ\":\"AE\",\"Ǣ\":\"AE\",\"Ꜵ\":\"AO\",\"Ꜷ\":\"AU\",\"Ꜹ\":\"AV\",\"Ꜻ\":\"AV\",\"Ꜽ\":\"AY\",\"Ⓑ\":\"B\",\"Ｂ\":\"B\",\"Ḃ\":\"B\",\"Ḅ\":\"B\",\"Ḇ\":\"B\",\"Ƀ\":\"B\",\"Ƃ\":\"B\",\"Ɓ\":\"B\",\"Ⓒ\":\"C\",\"Ｃ\":\"C\",\"Ć\":\"C\",\"Ĉ\":\"C\",\"Ċ\":\"C\",\"Č\":\"C\",\"Ç\":\"C\",\"Ḉ\":\"C\",\"Ƈ\":\"C\",\"Ȼ\":\"C\",\"Ꜿ\":\"C\",\"Ⓓ\":\"D\",\"Ｄ\":\"D\",\"Ḋ\":\"D\",\"Ď\":\"D\",\"Ḍ\":\"D\",\"Ḑ\":\"D\",\"Ḓ\":\"D\",\"Ḏ\":\"D\",\"Đ\":\"D\",\"Ƌ\":\"D\",\"Ɗ\":\"D\",\"Ɖ\":\"D\",\"Ꝺ\":\"D\",\"Ǳ\":\"DZ\",\"Ǆ\":\"DZ\",\"ǲ\":\"Dz\",\"ǅ\":\"Dz\",\"Ⓔ\":\"E\",\"Ｅ\":\"E\",\"È\":\"E\",\"É\":\"E\",\"Ê\":\"E\",\"Ề\":\"E\",\"Ế\":\"E\",\"Ễ\":\"E\",\"Ể\":\"E\",\"Ẽ\":\"E\",\"Ē\":\"E\",\"Ḕ\":\"E\",\"Ḗ\":\"E\",\"Ĕ\":\"E\",\"Ė\":\"E\",\"Ë\":\"E\",\"Ẻ\":\"E\",\"Ě\":\"E\",\"Ȅ\":\"E\",\"Ȇ\":\"E\",\"Ẹ\":\"E\",\"Ệ\":\"E\",\"Ȩ\":\"E\",\"Ḝ\":\"E\",\"Ę\":\"E\",\"Ḙ\":\"E\",\"Ḛ\":\"E\",\"Ɛ\":\"E\",\"Ǝ\":\"E\",\"Ⓕ\":\"F\",\"Ｆ\":\"F\",\"Ḟ\":\"F\",\"Ƒ\":\"F\",\"Ꝼ\":\"F\",\"Ⓖ\":\"G\",\"Ｇ\":\"G\",\"Ǵ\":\"G\",\"Ĝ\":\"G\",\"Ḡ\":\"G\",\"Ğ\":\"G\",\"Ġ\":\"G\",\"Ǧ\":\"G\",\"Ģ\":\"G\",\"Ǥ\":\"G\",\"Ɠ\":\"G\",\"Ꞡ\":\"G\",\"Ᵹ\":\"G\",\"Ꝿ\":\"G\",\"Ⓗ\":\"H\",\"Ｈ\":\"H\",\"Ĥ\":\"H\",\"Ḣ\":\"H\",\"Ḧ\":\"H\",\"Ȟ\":\"H\",\"Ḥ\":\"H\",\"Ḩ\":\"H\",\"Ḫ\":\"H\",\"Ħ\":\"H\",\"Ⱨ\":\"H\",\"Ⱶ\":\"H\",\"Ɥ\":\"H\",\"Ⓘ\":\"I\",\"Ｉ\":\"I\",\"Ì\":\"I\",\"Í\":\"I\",\"Î\":\"I\",\"Ĩ\":\"I\",\"Ī\":\"I\",\"Ĭ\":\"I\",\"İ\":\"I\",\"Ï\":\"I\",\"Ḯ\":\"I\",\"Ỉ\":\"I\",\"Ǐ\":\"I\",\"Ȉ\":\"I\",\"Ȋ\":\"I\",\"Ị\":\"I\",\"Į\":\"I\",\"Ḭ\":\"I\",\"Ɨ\":\"I\",\"Ⓙ\":\"J\",\"Ｊ\":\"J\",\"Ĵ\":\"J\",\"Ɉ\":\"J\",\"Ⓚ\":\"K\",\"Ｋ\":\"K\",\"Ḱ\":\"K\",\"Ǩ\":\"K\",\"Ḳ\":\"K\",\"Ķ\":\"K\",\"Ḵ\":\"K\",\"Ƙ\":\"K\",\"Ⱪ\":\"K\",\"Ꝁ\":\"K\",\"Ꝃ\":\"K\",\"Ꝅ\":\"K\",\"Ꞣ\":\"K\",\"Ⓛ\":\"L\",\"Ｌ\":\"L\",\"Ŀ\":\"L\",\"Ĺ\":\"L\",\"Ľ\":\"L\",\"Ḷ\":\"L\",\"Ḹ\":\"L\",\"Ļ\":\"L\",\"Ḽ\":\"L\",\"Ḻ\":\"L\",\"Ł\":\"L\",\"Ƚ\":\"L\",\"Ɫ\":\"L\",\"Ⱡ\":\"L\",\"Ꝉ\":\"L\",\"Ꝇ\":\"L\",\"Ꞁ\":\"L\",\"Ǉ\":\"LJ\",\"ǈ\":\"Lj\",\"Ⓜ\":\"M\",\"Ｍ\":\"M\",\"Ḿ\":\"M\",\"Ṁ\":\"M\",\"Ṃ\":\"M\",\"Ɱ\":\"M\",\"Ɯ\":\"M\",\"Ⓝ\":\"N\",\"Ｎ\":\"N\",\"Ǹ\":\"N\",\"Ń\":\"N\",\"Ñ\":\"N\",\"Ṅ\":\"N\",\"Ň\":\"N\",\"Ṇ\":\"N\",\"Ņ\":\"N\",\"Ṋ\":\"N\",\"Ṉ\":\"N\",\"Ƞ\":\"N\",\"Ɲ\":\"N\",\"Ꞑ\":\"N\",\"Ꞥ\":\"N\",\"Ǌ\":\"NJ\",\"ǋ\":\"Nj\",\"Ⓞ\":\"O\",\"Ｏ\":\"O\",\"Ò\":\"O\",\"Ó\":\"O\",\"Ô\":\"O\",\"Ồ\":\"O\",\"Ố\":\"O\",\"Ỗ\":\"O\",\"Ổ\":\"O\",\"Õ\":\"O\",\"Ṍ\":\"O\",\"Ȭ\":\"O\",\"Ṏ\":\"O\",\"Ō\":\"O\",\"Ṑ\":\"O\",\"Ṓ\":\"O\",\"Ŏ\":\"O\",\"Ȯ\":\"O\",\"Ȱ\":\"O\",\"Ö\":\"O\",\"Ȫ\":\"O\",\"Ỏ\":\"O\",\"Ő\":\"O\",\"Ǒ\":\"O\",\"Ȍ\":\"O\",\"Ȏ\":\"O\",\"Ơ\":\"O\",\"Ờ\":\"O\",\"Ớ\":\"O\",\"Ỡ\":\"O\",\"Ở\":\"O\",\"Ợ\":\"O\",\"Ọ\":\"O\",\"Ộ\":\"O\",\"Ǫ\":\"O\",\"Ǭ\":\"O\",\"Ø\":\"O\",\"Ǿ\":\"O\",\"Ɔ\":\"O\",\"Ɵ\":\"O\",\"Ꝋ\":\"O\",\"Ꝍ\":\"O\",\"Ƣ\":\"OI\",\"Ꝏ\":\"OO\",\"Ȣ\":\"OU\",\"Ⓟ\":\"P\",\"Ｐ\":\"P\",\"Ṕ\":\"P\",\"Ṗ\":\"P\",\"Ƥ\":\"P\",\"Ᵽ\":\"P\",\"Ꝑ\":\"P\",\"Ꝓ\":\"P\",\"Ꝕ\":\"P\",\"Ⓠ\":\"Q\",\"Ｑ\":\"Q\",\"Ꝗ\":\"Q\",\"Ꝙ\":\"Q\",\"Ɋ\":\"Q\",\"Ⓡ\":\"R\",\"Ｒ\":\"R\",\"Ŕ\":\"R\",\"Ṙ\":\"R\",\"Ř\":\"R\",\"Ȑ\":\"R\",\"Ȓ\":\"R\",\"Ṛ\":\"R\",\"Ṝ\":\"R\",\"Ŗ\":\"R\",\"Ṟ\":\"R\",\"Ɍ\":\"R\",\"Ɽ\":\"R\",\"Ꝛ\":\"R\",\"Ꞧ\":\"R\",\"Ꞃ\":\"R\",\"Ⓢ\":\"S\",\"Ｓ\":\"S\",\"ẞ\":\"S\",\"Ś\":\"S\",\"Ṥ\":\"S\",\"Ŝ\":\"S\",\"Ṡ\":\"S\",\"Š\":\"S\",\"Ṧ\":\"S\",\"Ṣ\":\"S\",\"Ṩ\":\"S\",\"Ș\":\"S\",\"Ş\":\"S\",\"Ȿ\":\"S\",\"Ꞩ\":\"S\",\"Ꞅ\":\"S\",\"Ⓣ\":\"T\",\"Ｔ\":\"T\",\"Ṫ\":\"T\",\"Ť\":\"T\",\"Ṭ\":\"T\",\"Ț\":\"T\",\"Ţ\":\"T\",\"Ṱ\":\"T\",\"Ṯ\":\"T\",\"Ŧ\":\"T\",\"Ƭ\":\"T\",\"Ʈ\":\"T\",\"Ⱦ\":\"T\",\"Ꞇ\":\"T\",\"Ꜩ\":\"TZ\",\"Ⓤ\":\"U\",\"Ｕ\":\"U\",\"Ù\":\"U\",\"Ú\":\"U\",\"Û\":\"U\",\"Ũ\":\"U\",\"Ṹ\":\"U\",\"Ū\":\"U\",\"Ṻ\":\"U\",\"Ŭ\":\"U\",\"Ü\":\"U\",\"Ǜ\":\"U\",\"Ǘ\":\"U\",\"Ǖ\":\"U\",\"Ǚ\":\"U\",\"Ủ\":\"U\",\"Ů\":\"U\",\"Ű\":\"U\",\"Ǔ\":\"U\",\"Ȕ\":\"U\",\"Ȗ\":\"U\",\"Ư\":\"U\",\"Ừ\":\"U\",\"Ứ\":\"U\",\"Ữ\":\"U\",\"Ử\":\"U\",\"Ự\":\"U\",\"Ụ\":\"U\",\"Ṳ\":\"U\",\"Ų\":\"U\",\"Ṷ\":\"U\",\"Ṵ\":\"U\",\"Ʉ\":\"U\",\"Ⓥ\":\"V\",\"Ｖ\":\"V\",\"Ṽ\":\"V\",\"Ṿ\":\"V\",\"Ʋ\":\"V\",\"Ꝟ\":\"V\",\"Ʌ\":\"V\",\"Ꝡ\":\"VY\",\"Ⓦ\":\"W\",\"Ｗ\":\"W\",\"Ẁ\":\"W\",\"Ẃ\":\"W\",\"Ŵ\":\"W\",\"Ẇ\":\"W\",\"Ẅ\":\"W\",\"Ẉ\":\"W\",\"Ⱳ\":\"W\",\"Ⓧ\":\"X\",\"Ｘ\":\"X\",\"Ẋ\":\"X\",\"Ẍ\":\"X\",\"Ⓨ\":\"Y\",\"Ｙ\":\"Y\",\"Ỳ\":\"Y\",\"Ý\":\"Y\",\"Ŷ\":\"Y\",\"Ỹ\":\"Y\",\"Ȳ\":\"Y\",\"Ẏ\":\"Y\",\"Ÿ\":\"Y\",\"Ỷ\":\"Y\",\"Ỵ\":\"Y\",\"Ƴ\":\"Y\",\"Ɏ\":\"Y\",\"Ỿ\":\"Y\",\"Ⓩ\":\"Z\",\"Ｚ\":\"Z\",\"Ź\":\"Z\",\"Ẑ\":\"Z\",\"Ż\":\"Z\",\"Ž\":\"Z\",\"Ẓ\":\"Z\",\"Ẕ\":\"Z\",\"Ƶ\":\"Z\",\"Ȥ\":\"Z\",\"Ɀ\":\"Z\",\"Ⱬ\":\"Z\",\"Ꝣ\":\"Z\",\"ⓐ\":\"a\",\"ａ\":\"a\",\"ẚ\":\"a\",\"à\":\"a\",\"á\":\"a\",\"â\":\"a\",\"ầ\":\"a\",\"ấ\":\"a\",\"ẫ\":\"a\",\"ẩ\":\"a\",\"ã\":\"a\",\"ā\":\"a\",\"ă\":\"a\",\"ằ\":\"a\",\"ắ\":\"a\",\"ẵ\":\"a\",\"ẳ\":\"a\",\"ȧ\":\"a\",\"ǡ\":\"a\",\"ä\":\"a\",\"ǟ\":\"a\",\"ả\":\"a\",\"å\":\"a\",\"ǻ\":\"a\",\"ǎ\":\"a\",\"ȁ\":\"a\",\"ȃ\":\"a\",\"ạ\":\"a\",\"ậ\":\"a\",\"ặ\":\"a\",\"ḁ\":\"a\",\"ą\":\"a\",\"ⱥ\":\"a\",\"ɐ\":\"a\",\"ꜳ\":\"aa\",\"æ\":\"ae\",\"ǽ\":\"ae\",\"ǣ\":\"ae\",\"ꜵ\":\"ao\",\"ꜷ\":\"au\",\"ꜹ\":\"av\",\"ꜻ\":\"av\",\"ꜽ\":\"ay\",\"ⓑ\":\"b\",\"ｂ\":\"b\",\"ḃ\":\"b\",\"ḅ\":\"b\",\"ḇ\":\"b\",\"ƀ\":\"b\",\"ƃ\":\"b\",\"ɓ\":\"b\",\"ⓒ\":\"c\",\"ｃ\":\"c\",\"ć\":\"c\",\"ĉ\":\"c\",\"ċ\":\"c\",\"č\":\"c\",\"ç\":\"c\",\"ḉ\":\"c\",\"ƈ\":\"c\",\"ȼ\":\"c\",\"ꜿ\":\"c\",\"ↄ\":\"c\",\"ⓓ\":\"d\",\"ｄ\":\"d\",\"ḋ\":\"d\",\"ď\":\"d\",\"ḍ\":\"d\",\"ḑ\":\"d\",\"ḓ\":\"d\",\"ḏ\":\"d\",\"đ\":\"d\",\"ƌ\":\"d\",\"ɖ\":\"d\",\"ɗ\":\"d\",\"ꝺ\":\"d\",\"ǳ\":\"dz\",\"ǆ\":\"dz\",\"ⓔ\":\"e\",\"ｅ\":\"e\",\"è\":\"e\",\"é\":\"e\",\"ê\":\"e\",\"ề\":\"e\",\"ế\":\"e\",\"ễ\":\"e\",\"ể\":\"e\",\"ẽ\":\"e\",\"ē\":\"e\",\"ḕ\":\"e\",\"ḗ\":\"e\",\"ĕ\":\"e\",\"ė\":\"e\",\"ë\":\"e\",\"ẻ\":\"e\",\"ě\":\"e\",\"ȅ\":\"e\",\"ȇ\":\"e\",\"ẹ\":\"e\",\"ệ\":\"e\",\"ȩ\":\"e\",\"ḝ\":\"e\",\"ę\":\"e\",\"ḙ\":\"e\",\"ḛ\":\"e\",\"ɇ\":\"e\",\"ɛ\":\"e\",\"ǝ\":\"e\",\"ⓕ\":\"f\",\"ｆ\":\"f\",\"ḟ\":\"f\",\"ƒ\":\"f\",\"ꝼ\":\"f\",\"ⓖ\":\"g\",\"ｇ\":\"g\",\"ǵ\":\"g\",\"ĝ\":\"g\",\"ḡ\":\"g\",\"ğ\":\"g\",\"ġ\":\"g\",\"ǧ\":\"g\",\"ģ\":\"g\",\"ǥ\":\"g\",\"ɠ\":\"g\",\"ꞡ\":\"g\",\"ᵹ\":\"g\",\"ꝿ\":\"g\",\"ⓗ\":\"h\",\"ｈ\":\"h\",\"ĥ\":\"h\",\"ḣ\":\"h\",\"ḧ\":\"h\",\"ȟ\":\"h\",\"ḥ\":\"h\",\"ḩ\":\"h\",\"ḫ\":\"h\",\"ẖ\":\"h\",\"ħ\":\"h\",\"ⱨ\":\"h\",\"ⱶ\":\"h\",\"ɥ\":\"h\",\"ƕ\":\"hv\",\"ⓘ\":\"i\",\"ｉ\":\"i\",\"ì\":\"i\",\"í\":\"i\",\"î\":\"i\",\"ĩ\":\"i\",\"ī\":\"i\",\"ĭ\":\"i\",\"ï\":\"i\",\"ḯ\":\"i\",\"ỉ\":\"i\",\"ǐ\":\"i\",\"ȉ\":\"i\",\"ȋ\":\"i\",\"ị\":\"i\",\"į\":\"i\",\"ḭ\":\"i\",\"ɨ\":\"i\",\"ı\":\"i\",\"ⓙ\":\"j\",\"ｊ\":\"j\",\"ĵ\":\"j\",\"ǰ\":\"j\",\"ɉ\":\"j\",\"ⓚ\":\"k\",\"ｋ\":\"k\",\"ḱ\":\"k\",\"ǩ\":\"k\",\"ḳ\":\"k\",\"ķ\":\"k\",\"ḵ\":\"k\",\"ƙ\":\"k\",\"ⱪ\":\"k\",\"ꝁ\":\"k\",\"ꝃ\":\"k\",\"ꝅ\":\"k\",\"ꞣ\":\"k\",\"ⓛ\":\"l\",\"ｌ\":\"l\",\"ŀ\":\"l\",\"ĺ\":\"l\",\"ľ\":\"l\",\"ḷ\":\"l\",\"ḹ\":\"l\",\"ļ\":\"l\",\"ḽ\":\"l\",\"ḻ\":\"l\",\"ſ\":\"l\",\"ł\":\"l\",\"ƚ\":\"l\",\"ɫ\":\"l\",\"ⱡ\":\"l\",\"ꝉ\":\"l\",\"ꞁ\":\"l\",\"ꝇ\":\"l\",\"ǉ\":\"lj\",\"ⓜ\":\"m\",\"ｍ\":\"m\",\"ḿ\":\"m\",\"ṁ\":\"m\",\"ṃ\":\"m\",\"ɱ\":\"m\",\"ɯ\":\"m\",\"ⓝ\":\"n\",\"ｎ\":\"n\",\"ǹ\":\"n\",\"ń\":\"n\",\"ñ\":\"n\",\"ṅ\":\"n\",\"ň\":\"n\",\"ṇ\":\"n\",\"ņ\":\"n\",\"ṋ\":\"n\",\"ṉ\":\"n\",\"ƞ\":\"n\",\"ɲ\":\"n\",\"ŉ\":\"n\",\"ꞑ\":\"n\",\"ꞥ\":\"n\",\"ǌ\":\"nj\",\"ⓞ\":\"o\",\"ｏ\":\"o\",\"ò\":\"o\",\"ó\":\"o\",\"ô\":\"o\",\"ồ\":\"o\",\"ố\":\"o\",\"ỗ\":\"o\",\"ổ\":\"o\",\"õ\":\"o\",\"ṍ\":\"o\",\"ȭ\":\"o\",\"ṏ\":\"o\",\"ō\":\"o\",\"ṑ\":\"o\",\"ṓ\":\"o\",\"ŏ\":\"o\",\"ȯ\":\"o\",\"ȱ\":\"o\",\"ö\":\"o\",\"ȫ\":\"o\",\"ỏ\":\"o\",\"ő\":\"o\",\"ǒ\":\"o\",\"ȍ\":\"o\",\"ȏ\":\"o\",\"ơ\":\"o\",\"ờ\":\"o\",\"ớ\":\"o\",\"ỡ\":\"o\",\"ở\":\"o\",\"ợ\":\"o\",\"ọ\":\"o\",\"ộ\":\"o\",\"ǫ\":\"o\",\"ǭ\":\"o\",\"ø\":\"o\",\"ǿ\":\"o\",\"ɔ\":\"o\",\"ꝋ\":\"o\",\"ꝍ\":\"o\",\"ɵ\":\"o\",\"ƣ\":\"oi\",\"ȣ\":\"ou\",\"ꝏ\":\"oo\",\"ⓟ\":\"p\",\"ｐ\":\"p\",\"ṕ\":\"p\",\"ṗ\":\"p\",\"ƥ\":\"p\",\"ᵽ\":\"p\",\"ꝑ\":\"p\",\"ꝓ\":\"p\",\"ꝕ\":\"p\",\"ⓠ\":\"q\",\"ｑ\":\"q\",\"ɋ\":\"q\",\"ꝗ\":\"q\",\"ꝙ\":\"q\",\"ⓡ\":\"r\",\"ｒ\":\"r\",\"ŕ\":\"r\",\"ṙ\":\"r\",\"ř\":\"r\",\"ȑ\":\"r\",\"ȓ\":\"r\",\"ṛ\":\"r\",\"ṝ\":\"r\",\"ŗ\":\"r\",\"ṟ\":\"r\",\"ɍ\":\"r\",\"ɽ\":\"r\",\"ꝛ\":\"r\",\"ꞧ\":\"r\",\"ꞃ\":\"r\",\"ⓢ\":\"s\",\"ｓ\":\"s\",\"ß\":\"s\",\"ś\":\"s\",\"ṥ\":\"s\",\"ŝ\":\"s\",\"ṡ\":\"s\",\"š\":\"s\",\"ṧ\":\"s\",\"ṣ\":\"s\",\"ṩ\":\"s\",\"ș\":\"s\",\"ş\":\"s\",\"ȿ\":\"s\",\"ꞩ\":\"s\",\"ꞅ\":\"s\",\"ẛ\":\"s\",\"ⓣ\":\"t\",\"ｔ\":\"t\",\"ṫ\":\"t\",\"ẗ\":\"t\",\"ť\":\"t\",\"ṭ\":\"t\",\"ț\":\"t\",\"ţ\":\"t\",\"ṱ\":\"t\",\"ṯ\":\"t\",\"ŧ\":\"t\",\"ƭ\":\"t\",\"ʈ\":\"t\",\"ⱦ\":\"t\",\"ꞇ\":\"t\",\"ꜩ\":\"tz\",\"ⓤ\":\"u\",\"ｕ\":\"u\",\"ù\":\"u\",\"ú\":\"u\",\"û\":\"u\",\"ũ\":\"u\",\"ṹ\":\"u\",\"ū\":\"u\",\"ṻ\":\"u\",\"ŭ\":\"u\",\"ü\":\"u\",\"ǜ\":\"u\",\"ǘ\":\"u\",\"ǖ\":\"u\",\"ǚ\":\"u\",\"ủ\":\"u\",\"ů\":\"u\",\"ű\":\"u\",\"ǔ\":\"u\",\"ȕ\":\"u\",\"ȗ\":\"u\",\"ư\":\"u\",\"ừ\":\"u\",\"ứ\":\"u\",\"ữ\":\"u\",\"ử\":\"u\",\"ự\":\"u\",\"ụ\":\"u\",\"ṳ\":\"u\",\"ų\":\"u\",\"ṷ\":\"u\",\"ṵ\":\"u\",\"ʉ\":\"u\",\"ⓥ\":\"v\",\"ｖ\":\"v\",\"ṽ\":\"v\",\"ṿ\":\"v\",\"ʋ\":\"v\",\"ꝟ\":\"v\",\"ʌ\":\"v\",\"ꝡ\":\"vy\",\"ⓦ\":\"w\",\"ｗ\":\"w\",\"ẁ\":\"w\",\"ẃ\":\"w\",\"ŵ\":\"w\",\"ẇ\":\"w\",\"ẅ\":\"w\",\"ẘ\":\"w\",\"ẉ\":\"w\",\"ⱳ\":\"w\",\"ⓧ\":\"x\",\"ｘ\":\"x\",\"ẋ\":\"x\",\"ẍ\":\"x\",\"ⓨ\":\"y\",\"ｙ\":\"y\",\"ỳ\":\"y\",\"ý\":\"y\",\"ŷ\":\"y\",\"ỹ\":\"y\",\"ȳ\":\"y\",\"ẏ\":\"y\",\"ÿ\":\"y\",\"ỷ\":\"y\",\"ẙ\":\"y\",\"ỵ\":\"y\",\"ƴ\":\"y\",\"ɏ\":\"y\",\"ỿ\":\"y\",\"ⓩ\":\"z\",\"ｚ\":\"z\",\"ź\":\"z\",\"ẑ\":\"z\",\"ż\":\"z\",\"ž\":\"z\",\"ẓ\":\"z\",\"ẕ\":\"z\",\"ƶ\":\"z\",\"ȥ\":\"z\",\"ɀ\":\"z\",\"ⱬ\":\"z\",\"ꝣ\":\"z\",\"Ά\":\"Α\",\"Έ\":\"Ε\",\"Ή\":\"Η\",\"Ί\":\"Ι\",\"Ϊ\":\"Ι\",\"Ό\":\"Ο\",\"Ύ\":\"Υ\",\"Ϋ\":\"Υ\",\"Ώ\":\"Ω\",\"ά\":\"α\",\"έ\":\"ε\",\"ή\":\"η\",\"ί\":\"ι\",\"ϊ\":\"ι\",\"ΐ\":\"ι\",\"ό\":\"ο\",\"ύ\":\"υ\",\"ϋ\":\"υ\",\"ΰ\":\"υ\",\"ω\":\"ω\",\"ς\":\"σ\"};return a}),b.define(\"select2/data/base\",[\"../utils\"],function(a){function b(a,c){b.__super__.constructor.call(this)}return a.Extend(b,a.Observable),b.prototype.current=function(a){throw new Error(\"The `current` method must be defined in child classes.\")},b.prototype.query=function(a,b){throw new Error(\"The `query` method must be defined in child classes.\")},b.prototype.bind=function(a,b){},b.prototype.destroy=function(){},b.prototype.generateResultId=function(b,c){var d=b.id+\"-result-\";return d+=a.generateChars(4),d+=null!=c.id?\"-\"+c.id.toString():\"-\"+a.generateChars(4)},b}),b.define(\"select2/data/select\",[\"./base\",\"../utils\",\"jquery\"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,a),d.prototype.current=function(a){var b=[],d=this;this.$element.find(\":selected\").each(function(){var a=c(this),e=d.item(a);b.push(e)}),a(b)},d.prototype.select=function(a){var b=this;if(a.selected=!0,c(a.element).is(\"option\"))return a.element.selected=!0,void this.$element.trigger(\"change\");\r\n    if(this.$element.prop(\"multiple\"))this.current(function(d){var e=[];a=[a],a.push.apply(a,d);for(var f=0;f<a.length;f++){var g=a[f].id;-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger(\"change\")});else{var d=a.id;this.$element.val(d),this.$element.trigger(\"change\")}},d.prototype.unselect=function(a){var b=this;if(this.$element.prop(\"multiple\"))return a.selected=!1,c(a.element).is(\"option\")?(a.element.selected=!1,void this.$element.trigger(\"change\")):void this.current(function(d){for(var e=[],f=0;f<d.length;f++){var g=d[f].id;g!==a.id&&-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger(\"change\")})},d.prototype.bind=function(a,b){var c=this;this.container=a,a.on(\"select\",function(a){c.select(a.data)}),a.on(\"unselect\",function(a){c.unselect(a.data)})},d.prototype.destroy=function(){this.$element.find(\"*\").each(function(){c.removeData(this,\"data\")})},d.prototype.query=function(a,b){var d=[],e=this,f=this.$element.children();f.each(function(){var b=c(this);if(b.is(\"option\")||b.is(\"optgroup\")){var f=e.item(b),g=e.matches(a,f);null!==g&&d.push(g)}}),b({results:d})},d.prototype.addOptions=function(a){b.appendMany(this.$element,a)},d.prototype.option=function(a){var b;a.children?(b=document.createElement(\"optgroup\"),b.label=a.text):(b=document.createElement(\"option\"),void 0!==b.textContent?b.textContent=a.text:b.innerText=a.text),a.id&&(b.value=a.id),a.disabled&&(b.disabled=!0),a.selected&&(b.selected=!0),a.title&&(b.title=a.title);var d=c(b),e=this._normalizeItem(a);return e.element=b,c.data(b,\"data\",e),d},d.prototype.item=function(a){var b={};if(b=c.data(a[0],\"data\"),null!=b)return b;if(a.is(\"option\"))b={id:a.val(),text:a.text(),disabled:a.prop(\"disabled\"),selected:a.prop(\"selected\"),title:a.prop(\"title\")};else if(a.is(\"optgroup\")){b={text:a.prop(\"label\"),children:[],title:a.prop(\"title\")};for(var d=a.children(\"option\"),e=[],f=0;f<d.length;f++){var g=c(d[f]),h=this.item(g);e.push(h)}b.children=e}return b=this._normalizeItem(b),b.element=a[0],c.data(a[0],\"data\",b),b},d.prototype._normalizeItem=function(a){c.isPlainObject(a)||(a={id:a,text:a}),a=c.extend({},{text:\"\"},a);var b={selected:!1,disabled:!1};return null!=a.id&&(a.id=a.id.toString()),null!=a.text&&(a.text=a.text.toString()),null==a._resultId&&a.id&&null!=this.container&&(a._resultId=this.generateResultId(this.container,a)),c.extend({},b,a)},d.prototype.matches=function(a,b){var c=this.options.get(\"matcher\");return c(a,b)},d}),b.define(\"select2/data/array\",[\"./select\",\"../utils\",\"jquery\"],function(a,b,c){function d(a,b){var c=b.get(\"data\")||[];d.__super__.constructor.call(this,a,b),this.addOptions(this.convertToOptions(c))}return b.Extend(d,a),d.prototype.select=function(a){var b=this.$element.find(\"option\").filter(function(b,c){return c.value==a.id.toString()});0===b.length&&(b=this.option(a),this.addOptions(b)),d.__super__.select.call(this,a)},d.prototype.convertToOptions=function(a){function d(a){return function(){return c(this).val()==a.id}}for(var e=this,f=this.$element.find(\"option\"),g=f.map(function(){return e.item(c(this)).id}).get(),h=[],i=0;i<a.length;i++){var j=this._normalizeItem(a[i]);if(c.inArray(j.id,g)>=0){var k=f.filter(d(j)),l=this.item(k),m=c.extend(!0,{},j,l),n=this.option(m);k.replaceWith(n)}else{var o=this.option(j);if(j.children){var p=this.convertToOptions(j.children);b.appendMany(o,p)}h.push(o)}}return h},d}),b.define(\"select2/data/ajax\",[\"./array\",\"../utils\",\"jquery\"],function(a,b,c){function d(a,b){this.ajaxOptions=this._applyDefaults(b.get(\"ajax\")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),d.__super__.constructor.call(this,a,b)}return b.Extend(d,a),d.prototype._applyDefaults=function(a){var b={data:function(a){return c.extend({},a,{q:a.term})},transport:function(a,b,d){var e=c.ajax(a);return e.then(b),e.fail(d),e}};return c.extend({},b,a,!0)},d.prototype.processResults=function(a){return a},d.prototype.query=function(a,b){function d(){var d=f.transport(f,function(d){var f=e.processResults(d,a);e.options.get(\"debug\")&&window.console&&console.error&&(f&&f.results&&c.isArray(f.results)||console.error(\"Select2: The AJAX results did not return an array in the `results` key of the response.\")),b(f)},function(){d.status&&\"0\"===d.status||e.trigger(\"results:message\",{message:\"errorLoading\"})});e._request=d}var e=this;null!=this._request&&(c.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var f=c.extend({type:\"GET\"},this.ajaxOptions);\"function\"==typeof f.url&&(f.url=f.url.call(this.$element,a)),\"function\"==typeof f.data&&(f.data=f.data.call(this.$element,a)),this.ajaxOptions.delay&&null!=a.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(d,this.ajaxOptions.delay)):d()},d}),b.define(\"select2/data/tags\",[\"jquery\"],function(a){function b(b,c,d){var e=d.get(\"tags\"),f=d.get(\"createTag\");void 0!==f&&(this.createTag=f);var g=d.get(\"insertTag\");if(void 0!==g&&(this.insertTag=g),b.call(this,c,d),a.isArray(e))for(var h=0;h<e.length;h++){var i=e[h],j=this._normalizeItem(i),k=this.option(j);this.$element.append(k)}}return b.prototype.query=function(a,b,c){function d(a,f){for(var g=a.results,h=0;h<g.length;h++){var i=g[h],j=null!=i.children&&!d({results:i.children},!0),k=i.text===b.term;if(k||j)return f?!1:(a.data=g,void c(a))}if(f)return!0;var l=e.createTag(b);if(null!=l){var m=e.option(l);m.attr(\"data-select2-tag\",!0),e.addOptions([m]),e.insertTag(g,l)}a.results=g,c(a)}var e=this;return this._removeOldTags(),null==b.term||null!=b.page?void a.call(this,b,c):void a.call(this,b,d)},b.prototype.createTag=function(b,c){var d=a.trim(c.term);return\"\"===d?null:{id:d,text:d}},b.prototype.insertTag=function(a,b,c){b.unshift(c)},b.prototype._removeOldTags=function(b){var c=(this._lastTag,this.$element.find(\"option[data-select2-tag]\"));c.each(function(){this.selected||a(this).remove()})},b}),b.define(\"select2/data/tokenizer\",[\"jquery\"],function(a){function b(a,b,c){var d=c.get(\"tokenizer\");void 0!==d&&(this.tokenizer=d),a.call(this,b,c)}return b.prototype.bind=function(a,b,c){a.call(this,b,c),this.$search=b.dropdown.$search||b.selection.$search||c.find(\".select2-search__field\")},b.prototype.query=function(b,c,d){function e(b){var c=g._normalizeItem(b),d=g.$element.find(\"option\").filter(function(){return a(this).val()===c.id});if(!d.length){var e=g.option(c);e.attr(\"data-select2-tag\",!0),g._removeOldTags(),g.addOptions([e])}f(c)}function f(a){g.trigger(\"select\",{data:a})}var g=this;c.term=c.term||\"\";var h=this.tokenizer(c,this.options,e);h.term!==c.term&&(this.$search.length&&(this.$search.val(h.term),this.$search.focus()),c.term=h.term),b.call(this,c,d)},b.prototype.tokenizer=function(b,c,d,e){for(var f=d.get(\"tokenSeparators\")||[],g=c.term,h=0,i=this.createTag||function(a){return{id:a.term,text:a.term}};h<g.length;){var j=g[h];if(-1!==a.inArray(j,f)){var k=g.substr(0,h),l=a.extend({},c,{term:k}),m=i(l);null!=m?(e(m),g=g.substr(h+1)||\"\",h=0):h++}else h++}return{term:g}},b}),b.define(\"select2/data/minimumInputLength\",[],function(){function a(a,b,c){this.minimumInputLength=c.get(\"minimumInputLength\"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){return b.term=b.term||\"\",b.term.length<this.minimumInputLength?void this.trigger(\"results:message\",{message:\"inputTooShort\",args:{minimum:this.minimumInputLength,input:b.term,params:b}}):void a.call(this,b,c)},a}),b.define(\"select2/data/maximumInputLength\",[],function(){function a(a,b,c){this.maximumInputLength=c.get(\"maximumInputLength\"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){return b.term=b.term||\"\",this.maximumInputLength>0&&b.term.length>this.maximumInputLength?void this.trigger(\"results:message\",{message:\"inputTooLong\",args:{maximum:this.maximumInputLength,input:b.term,params:b}}):void a.call(this,b,c)},a}),b.define(\"select2/data/maximumSelectionLength\",[],function(){function a(a,b,c){this.maximumSelectionLength=c.get(\"maximumSelectionLength\"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){var d=this;this.current(function(e){var f=null!=e?e.length:0;return d.maximumSelectionLength>0&&f>=d.maximumSelectionLength?void d.trigger(\"results:message\",{message:\"maximumSelected\",args:{maximum:d.maximumSelectionLength}}):void a.call(d,b,c)})},a}),b.define(\"select2/dropdown\",[\"jquery\",\"./utils\"],function(a,b){function c(a,b){this.$element=a,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<span class=\"select2-dropdown\"><span class=\"select2-results\"></span></span>');return b.attr(\"dir\",this.options.get(\"dir\")),this.$dropdown=b,b},c.prototype.bind=function(){},c.prototype.position=function(a,b){},c.prototype.destroy=function(){this.$dropdown.remove()},c}),b.define(\"select2/dropdown/search\",[\"jquery\",\"../utils\"],function(a,b){function c(){}return c.prototype.render=function(b){var c=b.call(this),d=a('<span class=\"select2-search select2-search--dropdown\"><input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" role=\"textbox\" /></span>');return this.$searchContainer=d,this.$search=d.find(\"input\"),c.prepend(d),c},c.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),this.$search.on(\"keydown\",function(a){e.trigger(\"keypress\",a),e._keyUpPrevented=a.isDefaultPrevented()}),this.$search.on(\"input\",function(b){a(this).off(\"keyup\")}),this.$search.on(\"keyup input\",function(a){e.handleSearch(a)}),c.on(\"open\",function(){e.$search.attr(\"tabindex\",0),e.$search.focus(),window.setTimeout(function(){e.$search.focus()},0)}),c.on(\"close\",function(){e.$search.attr(\"tabindex\",-1),e.$search.val(\"\")}),c.on(\"focus\",function(){c.isOpen()&&e.$search.focus()}),c.on(\"results:all\",function(a){if(null==a.query.term||\"\"===a.query.term){var b=e.showSearch(a);b?e.$searchContainer.removeClass(\"select2-search--hide\"):e.$searchContainer.addClass(\"select2-search--hide\")}})},c.prototype.handleSearch=function(a){if(!this._keyUpPrevented){var b=this.$search.val();this.trigger(\"query\",{term:b})}this._keyUpPrevented=!1},c.prototype.showSearch=function(a,b){return!0},c}),b.define(\"select2/dropdown/hidePlaceholder\",[],function(){function a(a,b,c,d){this.placeholder=this.normalizePlaceholder(c.get(\"placeholder\")),a.call(this,b,c,d)}return a.prototype.append=function(a,b){b.results=this.removePlaceholder(b.results),a.call(this,b)},a.prototype.normalizePlaceholder=function(a,b){return\"string\"==typeof b&&(b={id:\"\",text:b}),b},a.prototype.removePlaceholder=function(a,b){for(var c=b.slice(0),d=b.length-1;d>=0;d--){var e=b[d];this.placeholder.id===e.id&&c.splice(d,1)}return c},a}),b.define(\"select2/dropdown/infiniteScroll\",[\"jquery\"],function(a){function b(a,b,c,d){this.lastParams={},a.call(this,b,c,d),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return b.prototype.append=function(a,b){this.$loadingMore.remove(),this.loading=!1,a.call(this,b),this.showLoadingMore(b)&&this.$results.append(this.$loadingMore)},b.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),c.on(\"query\",function(a){e.lastParams=a,e.loading=!0}),c.on(\"query:append\",function(a){e.lastParams=a,e.loading=!0}),this.$results.on(\"scroll\",function(){var b=a.contains(document.documentElement,e.$loadingMore[0]);if(!e.loading&&b){var c=e.$results.offset().top+e.$results.outerHeight(!1),d=e.$loadingMore.offset().top+e.$loadingMore.outerHeight(!1);c+50>=d&&e.loadMore()}})},b.prototype.loadMore=function(){this.loading=!0;var b=a.extend({},{page:1},this.lastParams);b.page++,this.trigger(\"query:append\",b)},b.prototype.showLoadingMore=function(a,b){return b.pagination&&b.pagination.more},b.prototype.createLoadingMore=function(){var b=a('<li class=\"select2-results__option select2-results__option--load-more\"role=\"treeitem\" aria-disabled=\"true\"></li>'),c=this.options.get(\"translations\").get(\"loadingMore\");return b.html(c(this.lastParams)),b},b}),b.define(\"select2/dropdown/attachBody\",[\"jquery\",\"../utils\"],function(a,b){function c(b,c,d){this.$dropdownParent=d.get(\"dropdownParent\")||a(document.body),b.call(this,c,d)}return c.prototype.bind=function(a,b,c){var d=this,e=!1;a.call(this,b,c),b.on(\"open\",function(){d._showDropdown(),d._attachPositioningHandler(b),e||(e=!0,b.on(\"results:all\",function(){d._positionDropdown(),d._resizeDropdown()}),b.on(\"results:append\",function(){d._positionDropdown(),d._resizeDropdown()}))}),b.on(\"close\",function(){d._hideDropdown(),d._detachPositioningHandler(b)}),this.$dropdownContainer.on(\"mousedown\",function(a){a.stopPropagation()})},c.prototype.destroy=function(a){a.call(this),this.$dropdownContainer.remove()},c.prototype.position=function(a,b,c){b.attr(\"class\",c.attr(\"class\")),b.removeClass(\"select2\"),b.addClass(\"select2-container--open\"),b.css({position:\"absolute\",top:-999999}),this.$container=c},c.prototype.render=function(b){var c=a(\"<span></span>\"),d=b.call(this);return c.append(d),this.$dropdownContainer=c,c},c.prototype._hideDropdown=function(a){this.$dropdownContainer.detach()},c.prototype._attachPositioningHandler=function(c,d){var e=this,f=\"scroll.select2.\"+d.id,g=\"resize.select2.\"+d.id,h=\"orientationchange.select2.\"+d.id,i=this.$container.parents().filter(b.hasScroll);i.each(function(){a(this).data(\"select2-scroll-position\",{x:a(this).scrollLeft(),y:a(this).scrollTop()})}),i.on(f,function(b){var c=a(this).data(\"select2-scroll-position\");a(this).scrollTop(c.y)}),a(window).on(f+\" \"+g+\" \"+h,function(a){e._positionDropdown(),e._resizeDropdown()})},c.prototype._detachPositioningHandler=function(c,d){var e=\"scroll.select2.\"+d.id,f=\"resize.select2.\"+d.id,g=\"orientationchange.select2.\"+d.id,h=this.$container.parents().filter(b.hasScroll);h.off(e),a(window).off(e+\" \"+f+\" \"+g)},c.prototype._positionDropdown=function(){var b=a(window),c=this.$dropdown.hasClass(\"select2-dropdown--above\"),d=this.$dropdown.hasClass(\"select2-dropdown--below\"),e=null,f=this.$container.offset();f.bottom=f.top+this.$container.outerHeight(!1);var g={height:this.$container.outerHeight(!1)};g.top=f.top,g.bottom=f.top+g.height;var h={height:this.$dropdown.outerHeight(!1)},i={top:b.scrollTop(),bottom:b.scrollTop()+b.height()},j=i.top<f.top-h.height,k=i.bottom>f.bottom+h.height,l={left:f.left,top:g.bottom},m=this.$dropdownParent;\"static\"===m.css(\"position\")&&(m=m.offsetParent());var n=m.offset();l.top-=n.top,l.left-=n.left,c||d||(e=\"below\"),k||!j||c?!j&&k&&c&&(e=\"below\"):e=\"above\",(\"above\"==e||c&&\"below\"!==e)&&(l.top=g.top-n.top-h.height),null!=e&&(this.$dropdown.removeClass(\"select2-dropdown--below select2-dropdown--above\").addClass(\"select2-dropdown--\"+e),this.$container.removeClass(\"select2-container--below select2-container--above\").addClass(\"select2-container--\"+e)),this.$dropdownContainer.css(l)},c.prototype._resizeDropdown=function(){var a={width:this.$container.outerWidth(!1)+\"px\"};this.options.get(\"dropdownAutoWidth\")&&(a.minWidth=a.width,a.position=\"relative\",a.width=\"auto\"),this.$dropdown.css(a)},c.prototype._showDropdown=function(a){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},c}),b.define(\"select2/dropdown/minimumResultsForSearch\",[],function(){function a(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];e.children?c+=a(e.children):c++}return c}function b(a,b,c,d){this.minimumResultsForSearch=c.get(\"minimumResultsForSearch\"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),a.call(this,b,c,d)}return b.prototype.showSearch=function(b,c){return a(c.data.results)<this.minimumResultsForSearch?!1:b.call(this,c)},b}),b.define(\"select2/dropdown/selectOnClose\",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on(\"close\",function(a){d._handleSelectOnClose(a)})},a.prototype._handleSelectOnClose=function(a,b){if(b&&null!=b.originalSelect2Event){var c=b.originalSelect2Event;if(\"select\"===c._type||\"unselect\"===c._type)return}var d=this.getHighlightedResults();if(!(d.length<1)){var e=d.data(\"data\");null!=e.element&&e.element.selected||null==e.element&&e.selected||this.trigger(\"select\",{data:e})}},a}),b.define(\"select2/dropdown/closeOnSelect\",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on(\"select\",function(a){d._selectTriggered(a)}),b.on(\"unselect\",function(a){d._selectTriggered(a)})},a.prototype._selectTriggered=function(a,b){var c=b.originalEvent;c&&c.ctrlKey||this.trigger(\"close\",{originalEvent:c,originalSelect2Event:b})},a}),b.define(\"select2/i18n/en\",[],function(){return{errorLoading:function(){return\"The results could not be loaded.\"},inputTooLong:function(a){var b=a.input.length-a.maximum,c=\"Please delete \"+b+\" character\";return 1!=b&&(c+=\"s\"),c},inputTooShort:function(a){var b=a.minimum-a.input.length,c=\"Please enter \"+b+\" or more characters\";return c},loadingMore:function(){return\"Loading more results…\"},maximumSelected:function(a){var b=\"You can only select \"+a.maximum+\" item\";return 1!=a.maximum&&(b+=\"s\"),b},noResults:function(){return\"No results found\"},searching:function(){return\"Searching…\"}}}),b.define(\"select2/defaults\",[\"jquery\",\"require\",\"./results\",\"./selection/single\",\"./selection/multiple\",\"./selection/placeholder\",\"./selection/allowClear\",\"./selection/search\",\"./selection/eventRelay\",\"./utils\",\"./translation\",\"./diacritics\",\"./data/select\",\"./data/array\",\"./data/ajax\",\"./data/tags\",\"./data/tokenizer\",\"./data/minimumInputLength\",\"./data/maximumInputLength\",\"./data/maximumSelectionLength\",\"./dropdown\",\"./dropdown/search\",\"./dropdown/hidePlaceholder\",\"./dropdown/infiniteScroll\",\"./dropdown/attachBody\",\"./dropdown/minimumResultsForSearch\",\"./dropdown/selectOnClose\",\"./dropdown/closeOnSelect\",\"./i18n/en\"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){function D(){this.reset()}D.prototype.apply=function(l){if(l=a.extend(!0,{},this.defaults,l),null==l.dataAdapter){if(null!=l.ajax?l.dataAdapter=o:null!=l.data?l.dataAdapter=n:l.dataAdapter=m,l.minimumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,r)),l.maximumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,s)),l.maximumSelectionLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,t)),l.tags&&(l.dataAdapter=j.Decorate(l.dataAdapter,p)),(null!=l.tokenSeparators||null!=l.tokenizer)&&(l.dataAdapter=j.Decorate(l.dataAdapter,q)),null!=l.query){var C=b(l.amdBase+\"compat/query\");l.dataAdapter=j.Decorate(l.dataAdapter,C)}if(null!=l.initSelection){var D=b(l.amdBase+\"compat/initSelection\");l.dataAdapter=j.Decorate(l.dataAdapter,D)}}if(null==l.resultsAdapter&&(l.resultsAdapter=c,null!=l.ajax&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,x)),null!=l.placeholder&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,w)),l.selectOnClose&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,A))),null==l.dropdownAdapter){if(l.multiple)l.dropdownAdapter=u;else{var E=j.Decorate(u,v);l.dropdownAdapter=E}if(0!==l.minimumResultsForSearch&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,z)),l.closeOnSelect&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,B)),null!=l.dropdownCssClass||null!=l.dropdownCss||null!=l.adaptDropdownCssClass){var F=b(l.amdBase+\"compat/dropdownCss\");l.dropdownAdapter=j.Decorate(l.dropdownAdapter,F)}l.dropdownAdapter=j.Decorate(l.dropdownAdapter,y)}if(null==l.selectionAdapter){if(l.multiple?l.selectionAdapter=e:l.selectionAdapter=d,null!=l.placeholder&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,f)),l.allowClear&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,g)),l.multiple&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,h)),null!=l.containerCssClass||null!=l.containerCss||null!=l.adaptContainerCssClass){var G=b(l.amdBase+\"compat/containerCss\");l.selectionAdapter=j.Decorate(l.selectionAdapter,G)}l.selectionAdapter=j.Decorate(l.selectionAdapter,i)}if(\"string\"==typeof l.language)if(l.language.indexOf(\"-\")>0){var H=l.language.split(\"-\"),I=H[0];l.language=[l.language,I]}else l.language=[l.language];if(a.isArray(l.language)){var J=new k;l.language.push(\"en\");for(var K=l.language,L=0;L<K.length;L++){var M=K[L],N={};try{N=k.loadPath(M)}catch(O){try{M=this.defaults.amdLanguageBase+M,N=k.loadPath(M)}catch(P){l.debug&&window.console&&console.warn&&console.warn('Select2: The language file for \"'+M+'\" could not be automatically loaded. A fallback will be used instead.');continue}}J.extend(N)}l.translations=J}else{var Q=k.loadPath(this.defaults.amdLanguageBase+\"en\"),R=new k(l.language);R.extend(Q),l.translations=R}return l},D.prototype.reset=function(){function b(a){function b(a){return l[a]||a}return a.replace(/[^\\u0000-\\u007E]/g,b)}function c(d,e){if(\"\"===a.trim(d.term))return e;if(e.children&&e.children.length>0){for(var f=a.extend(!0,{},e),g=e.children.length-1;g>=0;g--){var h=e.children[g],i=c(d,h);null==i&&f.children.splice(g,1)}return f.children.length>0?f:c(d,f)}var j=b(e.text).toUpperCase(),k=b(d.term).toUpperCase();return j.indexOf(k)>-1?e:null}this.defaults={amdBase:\"./\",amdLanguageBase:\"./i18n/\",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:j.escapeMarkup,language:C,matcher:c,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(a){return a},templateResult:function(a){return a.text},templateSelection:function(a){return a.text},theme:\"default\",width:\"resolve\"}},D.prototype.set=function(b,c){var d=a.camelCase(b),e={};e[d]=c;var f=j._convertData(e);a.extend(this.defaults,f)};var E=new D;return E}),b.define(\"select2/options\",[\"require\",\"jquery\",\"./defaults\",\"./utils\"],function(a,b,c,d){function e(b,e){if(this.options=b,null!=e&&this.fromElement(e),this.options=c.apply(this.options),e&&e.is(\"input\")){var f=a(this.get(\"amdBase\")+\"compat/inputData\");this.options.dataAdapter=d.Decorate(this.options.dataAdapter,f)}}return e.prototype.fromElement=function(a){var c=[\"select2\"];null==this.options.multiple&&(this.options.multiple=a.prop(\"multiple\")),null==this.options.disabled&&(this.options.disabled=a.prop(\"disabled\")),null==this.options.language&&(a.prop(\"lang\")?this.options.language=a.prop(\"lang\").toLowerCase():a.closest(\"[lang]\").prop(\"lang\")&&(this.options.language=a.closest(\"[lang]\").prop(\"lang\"))),null==this.options.dir&&(a.prop(\"dir\")?this.options.dir=a.prop(\"dir\"):a.closest(\"[dir]\").prop(\"dir\")?this.options.dir=a.closest(\"[dir]\").prop(\"dir\"):this.options.dir=\"ltr\"),a.prop(\"disabled\",this.options.disabled),a.prop(\"multiple\",this.options.multiple),a.data(\"select2Tags\")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags=\"true\"` attributes and will be removed in future versions of Select2.'),a.data(\"data\",a.data(\"select2Tags\")),a.data(\"tags\",!0)),a.data(\"ajaxUrl\")&&(this.options.debug&&window.console&&console.warn&&console.warn(\"Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2.\"),a.attr(\"ajax--url\",a.data(\"ajaxUrl\")),a.data(\"ajax--url\",a.data(\"ajaxUrl\")));var e={};e=b.fn.jquery&&\"1.\"==b.fn.jquery.substr(0,2)&&a[0].dataset?b.extend(!0,{},a[0].dataset,a.data()):a.data();var f=b.extend(!0,{},e);f=d._convertData(f);for(var g in f)b.inArray(g,c)>-1||(b.isPlainObject(this.options[g])?b.extend(this.options[g],f[g]):this.options[g]=f[g]);return this},e.prototype.get=function(a){return this.options[a]},e.prototype.set=function(a,b){this.options[a]=b},e}),b.define(\"select2/core\",[\"jquery\",\"./options\",\"./utils\",\"./keys\"],function(a,b,c,d){var e=function(a,c){null!=a.data(\"select2\")&&a.data(\"select2\").destroy(),this.$element=a,this.id=this._generateId(a),c=c||{},this.options=new b(c,a),e.__super__.constructor.call(this);var d=a.attr(\"tabindex\")||0;a.data(\"old-tabindex\",d),a.attr(\"tabindex\",\"-1\");var f=this.options.get(\"dataAdapter\");this.dataAdapter=new f(a,this.options);var g=this.render();this._placeContainer(g);var h=this.options.get(\"selectionAdapter\");this.selection=new h(a,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,g);var i=this.options.get(\"dropdownAdapter\");this.dropdown=new i(a,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,g);var j=this.options.get(\"resultsAdapter\");this.results=new j(a,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var k=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(a){k.trigger(\"selection:update\",{data:a})}),a.addClass(\"select2-hidden-accessible\"),a.attr(\"aria-hidden\",\"true\"),this._syncAttributes(),a.data(\"select2\",this)};return c.Extend(e,c.Observable),e.prototype._generateId=function(a){var b=\"\";return b=null!=a.attr(\"id\")?a.attr(\"id\"):null!=a.attr(\"name\")?a.attr(\"name\")+\"-\"+c.generateChars(2):c.generateChars(4),b=b.replace(/(:|\\.|\\[|\\]|,)/g,\"\"),b=\"select2-\"+b},e.prototype._placeContainer=function(a){a.insertAfter(this.$element);var b=this._resolveWidth(this.$element,this.options.get(\"width\"));null!=b&&a.css(\"width\",b)},e.prototype._resolveWidth=function(a,b){var c=/^width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if(\"resolve\"==b){var d=this._resolveWidth(a,\"style\");return null!=d?d:this._resolveWidth(a,\"element\")}if(\"element\"==b){var e=a.outerWidth(!1);return 0>=e?\"auto\":e+\"px\"}if(\"style\"==b){var f=a.attr(\"style\");if(\"string\"!=typeof f)return null;for(var g=f.split(\";\"),h=0,i=g.length;i>h;h+=1){var j=g[h].replace(/\\s/g,\"\"),k=j.match(c);if(null!==k&&k.length>=1)return k[1]}return null}return b},e.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},e.prototype._registerDomEvents=function(){var b=this;this.$element.on(\"change.select2\",function(){b.dataAdapter.current(function(a){b.trigger(\"selection:update\",{data:a})})}),this.$element.on(\"focus.select2\",function(a){b.trigger(\"focus\",a)}),this._syncA=c.bind(this._syncAttributes,this),this._syncS=c.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent(\"onpropertychange\",this._syncA);var d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=d?(this._observer=new d(function(c){a.each(c,b._syncA),a.each(c,b._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener(\"DOMAttrModified\",b._syncA,!1),this.$element[0].addEventListener(\"DOMNodeInserted\",b._syncS,!1),this.$element[0].addEventListener(\"DOMNodeRemoved\",b._syncS,!1))},e.prototype._registerDataEvents=function(){var a=this;this.dataAdapter.on(\"*\",function(b,c){a.trigger(b,c)})},e.prototype._registerSelectionEvents=function(){var b=this,c=[\"toggle\",\"focus\"];this.selection.on(\"toggle\",function(){b.toggleDropdown()}),this.selection.on(\"focus\",function(a){b.focus(a)}),this.selection.on(\"*\",function(d,e){-1===a.inArray(d,c)&&b.trigger(d,e)})},e.prototype._registerDropdownEvents=function(){var a=this;this.dropdown.on(\"*\",function(b,c){a.trigger(b,c)})},e.prototype._registerResultsEvents=function(){var a=this;this.results.on(\"*\",function(b,c){a.trigger(b,c)})},e.prototype._registerEvents=function(){var a=this;this.on(\"open\",function(){a.$container.addClass(\"select2-container--open\")}),this.on(\"close\",function(){a.$container.removeClass(\"select2-container--open\")}),this.on(\"enable\",function(){a.$container.removeClass(\"select2-container--disabled\")}),this.on(\"disable\",function(){a.$container.addClass(\"select2-container--disabled\")}),this.on(\"blur\",function(){a.$container.removeClass(\"select2-container--focus\")}),this.on(\"query\",function(b){a.isOpen()||a.trigger(\"open\",{}),this.dataAdapter.query(b,function(c){a.trigger(\"results:all\",{data:c,query:b})})}),this.on(\"query:append\",function(b){this.dataAdapter.query(b,function(c){a.trigger(\"results:append\",{data:c,query:b})})}),this.on(\"keypress\",function(b){var c=b.which;a.isOpen()?c===d.ESC||c===d.TAB||c===d.UP&&b.altKey?(a.close(),b.preventDefault()):c===d.ENTER?(a.trigger(\"results:select\",{}),b.preventDefault()):c===d.SPACE&&b.ctrlKey?(a.trigger(\"results:toggle\",{}),b.preventDefault()):c===d.UP?(a.trigger(\"results:previous\",{}),b.preventDefault()):c===d.DOWN&&(a.trigger(\"results:next\",{}),b.preventDefault()):(c===d.ENTER||c===d.SPACE||c===d.DOWN&&b.altKey)&&(a.open(),b.preventDefault())})},e.prototype._syncAttributes=function(){this.options.set(\"disabled\",this.$element.prop(\"disabled\")),this.options.get(\"disabled\")?(this.isOpen()&&this.close(),this.trigger(\"disable\",{})):this.trigger(\"enable\",{})},e.prototype._syncSubtree=function(a,b){var c=!1,d=this;if(!a||!a.target||\"OPTION\"===a.target.nodeName||\"OPTGROUP\"===a.target.nodeName){if(b)if(b.addedNodes&&b.addedNodes.length>0)for(var e=0;e<b.addedNodes.length;e++){var f=b.addedNodes[e];f.selected&&(c=!0)}else b.removedNodes&&b.removedNodes.length>0&&(c=!0);else c=!0;c&&this.dataAdapter.current(function(a){d.trigger(\"selection:update\",{data:a})})}},e.prototype.trigger=function(a,b){var c=e.__super__.trigger,d={open:\"opening\",close:\"closing\",select:\"selecting\",unselect:\"unselecting\"};if(void 0===b&&(b={}),a in d){var f=d[a],g={prevented:!1,name:a,args:b};if(c.call(this,f,g),g.prevented)return void(b.prevented=!0)}c.call(this,a,b)},e.prototype.toggleDropdown=function(){this.options.get(\"disabled\")||(this.isOpen()?this.close():this.open())},e.prototype.open=function(){this.isOpen()||this.trigger(\"query\",{})},e.prototype.close=function(){this.isOpen()&&this.trigger(\"close\",{})},e.prototype.isOpen=function(){return this.$container.hasClass(\"select2-container--open\")},e.prototype.hasFocus=function(){return this.$container.hasClass(\"select2-container--focus\")},e.prototype.focus=function(a){this.hasFocus()||(this.$container.addClass(\"select2-container--focus\"),this.trigger(\"focus\",{}))},e.prototype.enable=function(a){this.options.get(\"debug\")&&window.console&&console.warn&&console.warn('Select2: The `select2(\"enable\")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop(\"disabled\") instead.'),(null==a||0===a.length)&&(a=[!0]);var b=!a[0];this.$element.prop(\"disabled\",b)},e.prototype.data=function(){this.options.get(\"debug\")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2(\"data\")`. You should consider setting the value instead using `$element.val()`.');var a=[];return this.dataAdapter.current(function(b){a=b}),a},e.prototype.val=function(b){if(this.options.get(\"debug\")&&window.console&&console.warn&&console.warn('Select2: The `select2(\"val\")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==b||0===b.length)return this.$element.val();var c=b[0];a.isArray(c)&&(c=a.map(c,function(a){return a.toString()})),this.$element.val(c).trigger(\"change\")},e.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent(\"onpropertychange\",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener(\"DOMAttrModified\",this._syncA,!1),this.$element[0].removeEventListener(\"DOMNodeInserted\",this._syncS,!1),this.$element[0].removeEventListener(\"DOMNodeRemoved\",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(\".select2\"),this.$element.attr(\"tabindex\",this.$element.data(\"old-tabindex\")),this.$element.removeClass(\"select2-hidden-accessible\"),this.$element.attr(\"aria-hidden\",\"false\"),this.$element.removeData(\"select2\"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null;\r\n},e.prototype.render=function(){var b=a('<span class=\"select2 select2-container\"><span class=\"selection\"></span><span class=\"dropdown-wrapper\" aria-hidden=\"true\"></span></span>');return b.attr(\"dir\",this.options.get(\"dir\")),this.$container=b,this.$container.addClass(\"select2-container--\"+this.options.get(\"theme\")),b.data(\"element\",this.$element),b},e}),b.define(\"jquery-mousewheel\",[\"jquery\"],function(a){return a}),b.define(\"jquery.select2\",[\"jquery\",\"jquery-mousewheel\",\"./select2/core\",\"./select2/defaults\"],function(a,b,c,d){if(null==a.fn.select2){var e=[\"open\",\"close\",\"destroy\"];a.fn.select2=function(b){if(b=b||{},\"object\"==typeof b)return this.each(function(){var d=a.extend(!0,{},b);new c(a(this),d)}),this;if(\"string\"==typeof b){var d,f=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=a(this).data(\"select2\");null==c&&window.console&&console.error&&console.error(\"The select2('\"+b+\"') method was called on an element that is not using Select2.\"),d=c[b].apply(c,f)}),a.inArray(b,e)>-1?this:d}throw new Error(\"Invalid arguments for Select2: \"+b)}}return null==a.fn.select2.defaults&&(a.fn.select2.defaults=d),c}),{define:b.define,require:b.require}}(),c=b.require(\"jquery.select2\");return a.fn.select2.amd=b,c});\n",
    "/**\r\n * context menu\r\n */\r\n\r\ndefine('app/map/contextmenu',[\r\n    'jquery'\r\n], function($) {\r\n\r\n    'use strict';\r\n\r\n    $.fn.contextMenu = function (settings) {\r\n\r\n        // animation\r\n        var animationInType = 'transition.flipXIn';\r\n        var animationInDuration = 150;\r\n        var animationOutType = 'transition.flipXOut';\r\n        var animationOutDuration = 150;\r\n\r\n        return this.each(function () {\r\n\r\n            // Open context menu\r\n            $(this).off('pf:openContextMenu').on('pf:openContextMenu', function (e, originalEvent, component, hiddenOptions, activeOptions) {\r\n\r\n                // hide all other open context menus\r\n               $('#pf-dialog-wrapper > .dropdown-menu').hide();\r\n\r\n                var contextMenu = $(settings.menuSelector);\r\n\r\n                var menuLiElements = contextMenu.find('li');\r\n\r\n                // show all menu entries\r\n                menuLiElements.show();\r\n\r\n                // disable specific menu entries\r\n                for(var i = 0; i < hiddenOptions.length; i++){\r\n                    contextMenu.find('li[data-action=\"' + hiddenOptions[i] + '\"]').hide();\r\n                }\r\n\r\n                // deactivate all menu entries\r\n                menuLiElements.removeClass('active');\r\n\r\n                //set active specific menu entries\r\n                for(var j = 0; j < activeOptions.length; j++){\r\n                    contextMenu.find('li[data-action=\"' + activeOptions[j] + '\"]').addClass('active');\r\n                }\r\n\r\n                //open menu\r\n                contextMenu.css({\r\n                    position: 'absolute',\r\n                    left: getLeftLocation(originalEvent),\r\n                    top: getTopLocation(originalEvent)\r\n                }).velocity(animationInType, {\r\n                    duration: animationInDuration,\r\n                    complete: function(){\r\n                        // set context menu \"click\" observer\r\n                        $(this).off('click').one('click', {component: component, position:{x: originalEvent.offsetX, y: originalEvent.offsetY}}, function (e) {\r\n                            // hide contextmenu\r\n                            $(this).hide();\r\n\r\n                            var params = {\r\n                                selectedMenu: $(e.target),\r\n                                component: e.data.component,\r\n                                position: e.data.position\r\n                            };\r\n\r\n                            settings.menuSelected.call(this, params);\r\n                        });\r\n                    }\r\n                });\r\n\r\n                //make sure menu closes on any click\r\n                $(document).one('click.closeContextmenu', function () {\r\n                    $('.dropdown-menu[role=\"menu\"]').velocity(animationOutType, {\r\n                        duration: animationOutDuration\r\n                    });\r\n                });\r\n\r\n                return false;\r\n            });\r\n\r\n        });\r\n\r\n        function getLeftLocation(e) {\r\n            var mouseWidth = e.pageX;\r\n            var pageWidth = $(window).width();\r\n            var menuWidth = $(settings.menuSelector).width();\r\n\r\n            // opening menu would pass the side of the page\r\n            if (mouseWidth + menuWidth > pageWidth &&\r\n                menuWidth < mouseWidth) {\r\n                return mouseWidth - menuWidth;\r\n            }\r\n            return mouseWidth;\r\n        }\r\n\r\n        function getTopLocation(e) {\r\n            var mouseHeight = e.pageY;\r\n            var pageHeight = $(window).height();\r\n            var menuHeight = $(settings.menuSelector).height();\r\n\r\n            // opening menu would pass the bottom of the page\r\n            if (mouseHeight + menuHeight > pageHeight &&\r\n                menuHeight < mouseHeight) {\r\n                return mouseHeight - menuHeight;\r\n            }\r\n            return mouseHeight;\r\n        }\r\n\r\n    };\r\n});\n",
    "/**\r\n *  map overlay functions\r\n */\r\n\r\ndefine('app/map/overlay',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util'\r\n], function($, Init, Util) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n        logTimerCount: 3,                                               // map log timer in seconds\r\n\r\n        // map\r\n        mapClass: 'pf-map',                                             // class for all maps\r\n        mapWrapperClass: 'pf-map-wrapper',                              // wrapper div (scrollable)\r\n\r\n        // map overlays\r\n        mapOverlayClass: 'pf-map-overlay',                              // class for all map overlays\r\n        mapOverlayTimerClass: 'pf-map-overlay-timer',                   // class for map overlay timer e.g. map timer\r\n        mapOverlayInfoClass: 'pf-map-overlay-info',                     // class for map overlay info e.g. map info\r\n\r\n        // system\r\n        systemHeadClass: 'pf-system-head',                              // class for system head\r\n\r\n        // connection\r\n        connectionOverlayEolId: 'overlayEol'                            // connection overlay ID (jsPlumb)\r\n    };\r\n\r\n    /**\r\n     * Overlay options (all available map options shown in overlay)\r\n     * \"active\":    (active || hover) indicated whether an icon/option\r\n     *              is marked as \"active\".\r\n     *              \"active\": Makes icon active when visible\r\n     *              \"hover\": Make icon active on hover\r\n     */\r\n    var options = {\r\n        filter: {\r\n            title: 'active filter',\r\n            trigger: 'active',\r\n            class: 'pf-map-overlay-filter',\r\n            iconClass: ['fa', 'fa-fw', 'fa-filter']\r\n        },\r\n        mapSnapToGrid: {\r\n            title: 'active grid',\r\n            trigger: 'active',\r\n            class: 'pf-map-overlay-grid',\r\n            iconClass: ['glyphicon', 'glyphicon-th']\r\n        },\r\n        mapMagnetizer: {\r\n            title: 'active magnetizer',\r\n            trigger: 'active',\r\n            class: 'pf-map-overlay-magnetizer',\r\n            iconClass: ['fa', 'fa-fw', 'fa-magnet']\r\n        },\r\n        systemRegion: {\r\n            title: 'show regions',\r\n            trigger: 'hover',\r\n            class: 'pf-map-overlay-region',\r\n            iconClass: ['fa', 'fa-fw', 'fa-tags'],\r\n            hoverIntent: {\r\n                over: function(e){\r\n                    var mapElement = getMapFromOverlay(this);\r\n                    mapElement.find('.' + config.systemHeadClass).each(function(){\r\n                        var system = $(this);\r\n                        // init tooltip if not already exists\r\n                        if ( !system.data('bs.tooltip') ){\r\n                            system.tooltip({\r\n                                container: mapElement,\r\n                                placement: 'right',\r\n                                title: function(){\r\n                                    return $(this).parent().data('region');\r\n                                },\r\n                                trigger: 'manual'\r\n                            });\r\n                        }\r\n                        system.tooltip('show');\r\n                    });\r\n                },\r\n                out: function(e){\r\n                    var mapElement = getMapFromOverlay(this);\r\n                    mapElement.find('.' + config.systemHeadClass).tooltip('hide');\r\n                }\r\n            }\r\n        },\r\n        systemConnectionTimer: {\r\n            title: 'show EOL timer',\r\n            trigger: 'hover',\r\n            class: 'pf-map-overlay-connection-timer',\r\n            iconClass: ['fa', 'fa-fw', 'fa-clock-o'],\r\n            hoverIntent: {\r\n                over: function(e){\r\n                    var mapElement = getMapFromOverlay(this);\r\n                    var MapUtil = require('app/map/util');\r\n                    var Map = require('app/map/map');\r\n                    var map = Map.getMapInstance( mapElement.data('id') );\r\n                    var connections = MapUtil.searchConnectionsByScopeAndType(map, 'wh', ['wh_eol']);\r\n                    var serverDate = Util.getServerTime();\r\n\r\n                    for (let connection of connections) {\r\n                        var eolTimestamp = connection.getParameter('eolUpdated');\r\n                        var eolDate = Util.convertTimestampToServerTime(eolTimestamp);\r\n                        var diff = Util.getTimeDiffParts(eolDate, serverDate);\r\n\r\n                        // format overlay label\r\n                        var label = '';\r\n                        if(diff.days){\r\n                            label += diff.days + 'd ';\r\n                        }\r\n                        label += ('00' + diff.hours).slice(-2);\r\n                        label += ':' + ('00' + diff.min).slice(-2);\r\n\r\n                        connection.addOverlay([\r\n                            'Label',\r\n                            {\r\n                                label: '<i class=\"fa fa-fw fa-clock-o\"></i>&nbsp;' + label,\r\n                                id: config.connectionOverlayEolId,\r\n                                cssClass: ['pf-map-connection-overlay', 'eol'].join(' '),\r\n                                location: 0.25\r\n                            }\r\n                        ]);\r\n                    }\r\n                },\r\n                out: function(e){\r\n                    var mapElement = getMapFromOverlay(this);\r\n                    var MapUtil = require('app/map/util');\r\n                    var Map = require('app/map/map');\r\n                    var map = Map.getMapInstance( mapElement.data('id') );\r\n                    var connections = MapUtil.searchConnectionsByScopeAndType(map, 'wh', ['wh_eol']);\r\n\r\n                    for (let connection of connections) {\r\n                        connection.removeOverlay(config.connectionOverlayEolId);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get mapElement from overlay or any child of that\r\n     * @param mapOverlay\r\n     * @returns {JQuery}\r\n     */\r\n    var getMapFromOverlay = function(mapOverlay){\r\n        return $(mapOverlay).parents('.' + config.mapWrapperClass).find('.' + config.mapClass);\r\n    };\r\n\r\n    /**\r\n     * get map overlay element by type e.g. timer/counter, info - overlay\r\n     * @param overlayType\r\n     * @returns {*}\r\n     */\r\n    $.fn.getMapOverlay = function(overlayType){\r\n\r\n        var mapWrapperElement = $(this).parents('.' + config.mapWrapperClass);\r\n\r\n        var mapOverlay = null;\r\n        switch(overlayType){\r\n            case 'timer':\r\n                mapOverlay = mapWrapperElement.find('.' + config.mapOverlayTimerClass);\r\n                break;\r\n            case 'info':\r\n                mapOverlay = mapWrapperElement.find('.' + config.mapOverlayInfoClass);\r\n                break;\r\n        }\r\n\r\n        return mapOverlay;\r\n    };\r\n\r\n    /**\r\n     * draws the map update counter to the map overlay timer\r\n     * @param percent\r\n     * @returns {*}\r\n     */\r\n    $.fn.setMapUpdateCounter = function(percent, value){\r\n\r\n        var mapOverlayTimer = $(this);\r\n\r\n        // check if counter already exists\r\n        var counterChart = mapOverlayTimer.getMapCounter();\r\n\r\n        if(counterChart.length === 0){\r\n            // create new counter\r\n\r\n            counterChart = $('<div>', {\r\n                class: [Init.classes.pieChart.class, Init.classes.pieChart.pieChartMapCounterClass].join(' ')\r\n            }).attr('data-percent', percent).append(\r\n                $('<span>', {\r\n                    text: value\r\n                })\r\n            );\r\n\r\n            mapOverlayTimer.append(counterChart);\r\n\r\n            // init counter\r\n            counterChart.initMapUpdateCounter();\r\n\r\n            // set tooltip\r\n            mapOverlayTimer.attr('data-placement', 'left');\r\n            mapOverlayTimer.attr('title', 'update counter');\r\n            mapOverlayTimer.tooltip();\r\n        }\r\n\r\n        return counterChart;\r\n    };\r\n\r\n    /**\r\n     * get the map counter chart by an overlay\r\n     * @returns {*}\r\n     */\r\n    $.fn.getMapCounter = function(){\r\n\r\n        var mapOverlayTimer = $(this);\r\n\r\n        return mapOverlayTimer.find('.' + Init.classes.pieChart.pieChartMapCounterClass);\r\n    };\r\n\r\n    /**\r\n     * start the map update counter or reset\r\n     */\r\n    $.fn.startMapUpdateCounter = function(){\r\n\r\n        var mapOverlayTimer = $(this);\r\n        var counterChart = mapOverlayTimer.getMapCounter();\r\n\r\n        var maxSeconds = config.logTimerCount;\r\n\r\n        var counterChartLabel = counterChart.find('span');\r\n\r\n        var percentPerCount = 100 / maxSeconds;\r\n\r\n        // update counter\r\n        var updateChart = function(tempSeconds){\r\n            var pieChart = counterChart.data('easyPieChart');\r\n\r\n            if(pieChart !== undefined){\r\n                counterChart.data('easyPieChart').update( percentPerCount * tempSeconds);\r\n            }\r\n            counterChartLabel.text(tempSeconds);\r\n        };\r\n\r\n        // main timer function is called on any counter update\r\n        var timer = function(){\r\n            // decrease timer\r\n            var currentSeconds = counterChart.data('currentSeconds');\r\n            currentSeconds--;\r\n            counterChart.data('currentSeconds', currentSeconds);\r\n\r\n\r\n            if(currentSeconds >= 0){\r\n                // update counter\r\n                updateChart(currentSeconds);\r\n            }else{\r\n                // hide counter and reset\r\n                clearInterval(mapUpdateCounter);\r\n\r\n                mapOverlayTimer.velocity('transition.whirlOut', {\r\n                    duration: Init.animationSpeed.mapOverlay,\r\n                    complete: function(){\r\n                        counterChart.data('interval', false);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // get current seconds (in case the timer is already running)\r\n        var currentSeconds = counterChart.data('currentSeconds');\r\n\r\n        // start values for timer and chart\r\n        counterChart.data('currentSeconds', maxSeconds);\r\n        updateChart(maxSeconds);\r\n\r\n        if(\r\n            currentSeconds === undefined ||\r\n            currentSeconds < 0\r\n        ){\r\n            // start timer\r\n            var mapUpdateCounter = setInterval(timer, 1000);\r\n\r\n            // store counter interval\r\n            counterChart.data('interval', mapUpdateCounter);\r\n\r\n            // show overlay\r\n            if(mapOverlayTimer.is(':hidden')){\r\n                mapOverlayTimer.velocity('stop').velocity('transition.whirlIn', { duration: Init.animationSpeed.mapOverlay });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * update (show/hide) a overlay icon in the \"info\"-overlay\r\n     * show/hide the overlay itself is no icons are visible\r\n     * @param option\r\n     * @param viewType\r\n     */\r\n    $.fn.updateOverlayIcon = function(option, viewType){\r\n        var mapOverlayInfo = $(this);\r\n\r\n        var showOverlay = false;\r\n\r\n        var mapOverlayIconClass = options[option].class;\r\n\r\n        // look for the overlay icon that should be updated\r\n        var iconElement = mapOverlayInfo.find('.' + mapOverlayIconClass);\r\n\r\n        if(iconElement){\r\n            if(viewType === 'show'){\r\n                showOverlay = true;\r\n\r\n                // check \"trigger\" and mark as \"active\"\r\n                if(options[option].trigger === 'active'){\r\n                    iconElement.addClass('active');\r\n                }\r\n\r\n                // check if icon is not already visible\r\n                // -> prevents unnecessary \"show\" animation\r\n                if( !iconElement.data('visible') ){\r\n                    // display animation for icon\r\n                    iconElement.velocity({\r\n                        opacity: [0.8, 0],\r\n                        scale: [1, 0],\r\n                        width: ['26px', 0],\r\n                        marginLeft: ['3px', 0]\r\n                    },{\r\n                        duration: 240,\r\n                        easing: 'easeInOutQuad'\r\n                    });\r\n\r\n                    iconElement.data('visible', true);\r\n                }\r\n            }else if(viewType === 'hide'){\r\n                iconElement.removeClass('active').velocity('reverse');\r\n                iconElement.data('visible', false);\r\n\r\n                // check if there is any visible icon remaining\r\n                var visibleIcons = mapOverlayInfo.find('i:visible');\r\n                if(visibleIcons.length > 0){\r\n                    showOverlay = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        // show the entire overlay if there is at least one active icon\r\n        if(\r\n            showOverlay === true &&\r\n            mapOverlayInfo.is(':hidden')\r\n        ){\r\n            // show overlay\r\n            mapOverlayInfo.velocity('stop').velocity('transition.whirlIn', { duration: Init.animationSpeed.mapOverlay });\r\n        }else if(\r\n            showOverlay === false &&\r\n            mapOverlayInfo.is(':visible')\r\n        ){\r\n            // hide overlay\r\n            mapOverlayInfo.velocity('stop').velocity('transition.whirlOut', { duration: Init.animationSpeed.mapOverlay });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * init all map overlays on a \"parent\" element\r\n     * @returns {*}\r\n     */\r\n    $.fn.initMapOverlays = function(){\r\n        return this.each(function(){\r\n            var parentElement = $(this);\r\n\r\n            var mapOverlayTimer = $('<div>', {\r\n                class: [config.mapOverlayClass, config.mapOverlayTimerClass].join(' ')\r\n            });\r\n            parentElement.append(mapOverlayTimer);\r\n\r\n            // ---------------------------------------------------------------------------\r\n            // add map overlay info. after scrollbar is initialized\r\n            var mapOverlayInfo = $('<div>', {\r\n                class: [config.mapOverlayClass, config.mapOverlayInfoClass].join(' ')\r\n            });\r\n\r\n            // add all overlay elements\r\n            for (var prop in options) {\r\n                if(options.hasOwnProperty(prop)){\r\n                    var icon = $('<i>', {\r\n                        class: options[prop].iconClass.concat( ['pull-right', options[prop].class] ).join(' ')\r\n                    }).attr('title', options[prop].title).tooltip({\r\n                        placement: 'bottom',\r\n                        container: 'body',\r\n                        delay: 150\r\n                    });\r\n\r\n                    // add \"hover\" action for some icons\r\n                    if(options[prop].trigger === 'hover'){\r\n                        icon.hoverIntent(options[prop].hoverIntent);\r\n                    }\r\n\r\n                    mapOverlayInfo.append(icon);\r\n                }\r\n            }\r\n            parentElement.append(mapOverlayInfo);\r\n\r\n            // reset map update timer\r\n            mapOverlayTimer.setMapUpdateCounter(100, config.logTimerCount);\r\n        });\r\n    };\r\n\r\n});\n",
    "/**\r\n * Main map functionality\r\n */\r\n\r\ndefine('app/map/map',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox',\r\n    'app/map/util',\r\n    'app/map/system',\r\n    'app/map/magnetizing',\r\n    'app/map/scrollbar',\r\n    'dragToSelect',\r\n    'select2',\r\n    'app/map/contextmenu',\r\n    'app/map/overlay'\r\n], function($, Init, Util, Render, bootbox, MapUtil, System, MagnetizerWrapper) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n        zIndexCounter: 110,\r\n        newSystemOffset: {\r\n          x: 130,\r\n          y: 0\r\n        },\r\n\r\n        mapSnapToGrid: false,                                           // \"Snap to Grid\" feature for drag&drop systems on map (optional)\r\n        mapWrapperClass: 'pf-map-wrapper',                              // wrapper div (scrollable)\r\n\r\n        mapClass: 'pf-map',                                             // class for all maps\r\n        mapIdPrefix: 'pf-map-',                                         // id prefix for all maps\r\n        systemIdPrefix: 'pf-system-',                                   // id prefix for a system\r\n        systemClass: 'pf-system',                                       // class for all systems\r\n        systemActiveClass: 'pf-system-active',                          // class for an active system in a map\r\n        systemSelectedClass: 'pf-system-selected',                      // class for selected systems in a map\r\n        systemLockedClass: 'pf-system-locked',                          // class for locked systems in a map\r\n        systemHeadClass: 'pf-system-head',                              // class for system head\r\n        systemHeadNameClass: 'pf-system-head-name',                     // class for system name\r\n        systemHeadExpandClass: 'pf-system-head-expand',                 // class for system head expand arrow\r\n        systemBodyClass: 'pf-system-body',                              // class for system body\r\n        systemBodyItemHeight: 16,                                       // px of a system body entry\r\n        systemBodyItemClass: 'pf-system-body-item',                     // class for a system body entry\r\n        systemBodyItemStatusClass: 'pf-user-status',                    // class for player status in system body\r\n        systemBodyItemNameClass: 'pf-system-body-item-name',            // class for player name in system body\r\n        systemBodyRightClass: 'pf-system-body-right',                   // class for player ship name in system body\r\n        systemTooltipInnerClass: 'pf-system-tooltip-inner',             // class for system tooltip content\r\n        systemTooltipInnerIdPrefix: 'pf-system-tooltip-inner-',         // id prefix for system tooltip content\r\n        dynamicElementWrapperId: 'pf-dialog-wrapper',                   // wrapper div for dynamic content (dialogs, context-menus,...)\r\n\r\n        // endpoint classes\r\n        endpointSourceClass: 'pf-map-endpoint-source',\r\n        endpointTargetClass: 'pf-map-endpoint-target',\r\n\r\n        // context menus\r\n        mapContextMenuId: 'pf-map-contextmenu',\r\n        connectionContextMenuId: 'pf-map-connection-contextmenu',\r\n        systemContextMenuId: 'pf-map-system-contextmenu',\r\n\r\n        // dialogs\r\n        systemDialogId: 'pf-system-dialog',                             // id for system dialog\r\n        systemDialogSelectClass: 'pf-system-dialog-select',             // class for system select Element\r\n\r\n        // system security classes\r\n        systemSec: 'pf-system-sec',\r\n        systemSecHigh: 'pf-system-sec-highSec',\r\n        systemSecLow: 'pf-system-sec-lowSec',\r\n        systemSecNull: 'pf-system-sec-nullSec',\r\n        systemSecWHHeigh: 'pf-system-sec-high',\r\n        systemSecWHMid: 'pf-system-sec-mid',\r\n        systemSecWHLow: 'pf-system-sec-low'\r\n    };\r\n\r\n    // active jsPlumb instances currently running\r\n    var activeInstances = {};\r\n\r\n    // active connections per map (cache object)\r\n    var connectionCache = {};\r\n\r\n    // jsPlumb config\r\n    var globalMapConfig =  {\r\n        source: {\r\n            filter: '.' + config.systemHeadNameClass,\r\n            //isSource:true,\r\n            isTarget:true,                          // add target Endpoint to each system (e.g. for drag&drop)\r\n            allowLoopback: false,                   // loopBack connections are not allowed\r\n            cssClass: config.endpointSourceClass,\r\n            uniqueEndpoint: false,                  // each connection has its own endpoint visible\r\n            dragOptions:{\r\n            },\r\n            connectionsDetachable: true,            // dragOptions are set -> allow detaching them\r\n            maxConnections: 10,                      // due to isTarget is true, this is the max count of !out!-going connections\r\n           // isSource:true,\r\n            anchor: 'Continuous'\r\n        },\r\n        target: {\r\n            filter: '.' + config.systemHeadNameClass,\r\n            isSource:true,\r\n            //isTarget:true,\r\n            //allowLoopback: false,                   // loopback connections are not allowed\r\n            cssClass: config.endpointTargetClass,\r\n            dropOptions: {\r\n                hoverClass: config.systemActiveClass,\r\n                activeClass: 'dragActive'\r\n            },\r\n           // isTarget:true,\r\n           // uniqueEndpoint: false,\r\n            anchor: 'Continuous'\r\n        },\r\n        connectionTypes: Init.connectionTypes\r\n    };\r\n\r\n    /**\r\n     * updates a system with current information\r\n     * @param map\r\n     * @param data\r\n     * @param currentUserIsHere boolean - if the current user is in this system\r\n     */\r\n    $.fn.updateSystemUserData = function(map, data, currentUserIsHere){\r\n\r\n        var system = $(this);\r\n        var systemId = system.attr('id');\r\n\r\n        // find system body\r\n        var systemBody = $( system.find('.' + config.systemBodyClass) );\r\n\r\n        // find expand arrow\r\n        var systemHeadExpand = $( system.find('.' + config.systemHeadExpandClass) );\r\n\r\n        var oldCacheKey = system.data('userCache');\r\n        var oldUserCount = system.data('userCount');\r\n        oldUserCount = (oldUserCount !== undefined ? oldUserCount : 0);\r\n        var userCounter = 0;\r\n\r\n        system.data('currentUser', false);\r\n\r\n        // if current user is in THIS system trigger event\r\n        if(currentUserIsHere){\r\n            system.data('currentUser', true);\r\n        }\r\n\r\n        // add user information\r\n        if(\r\n            data &&\r\n            data.user\r\n        ){\r\n            var cacheArray = [];\r\n            // loop all active pilots and build cache-key\r\n            for(var i = 0; i < data.user.length; i++){\r\n                userCounter++;\r\n                var tempUserData = data.user[i];\r\n                cacheArray.push(tempUserData.id + '_' + tempUserData.log.ship.id);\r\n            }\r\n            var cacheKey = cacheArray.join('_');\r\n\r\n            // check for if cacheKey has changed\r\n            if(cacheKey !== oldCacheKey){\r\n                // set new CacheKey\r\n                system.data('userCache', cacheKey);\r\n                system.data('userCount', userCounter);\r\n\r\n                // remove all content\r\n                systemBody.empty();\r\n\r\n                // loop \"again\" and build DOM object with user information\r\n                for(let j = 0; j < data.user.length; j++){\r\n                    var userData = data.user[j];\r\n\r\n                    var statusClass = Util.getStatusInfoForCharacter(userData, 'class');\r\n                    var userName = userData.name;\r\n\r\n                    var item = $('<div>', {\r\n                        class: config.systemBodyItemClass\r\n                    }).append(\r\n                            $('<span>', {\r\n                                text: userData.log.ship.typeName,\r\n                                class: config.systemBodyRightClass\r\n                            })\r\n                        ).append(\r\n                            $('<i>', {\r\n                                class: ['fa', 'fa-circle', config.systemBodyItemStatusClass, statusClass].join(' ')\r\n                            })\r\n                        ).append(\r\n                            $('<span>', {\r\n                                class: config.systemBodyItemNameClass,\r\n                                text: userName\r\n                            })\r\n                        );\r\n\r\n                    systemBody.append(item);\r\n                }\r\n\r\n\r\n                // =================================================================\r\n\r\n                // user count changed -> change tooltip content\r\n                var tooltipOptions = {placement: 'top', trigger: 'manual'};\r\n\r\n                // set tooltip color\r\n                var highlight = false;\r\n                var tooltipIconClass = '';\r\n                if(userCounter > oldUserCount){\r\n                    highlight = 'good';\r\n                    tooltipIconClass = 'fa-caret-up';\r\n                }else if(userCounter < oldUserCount){\r\n                    highlight = 'bad';\r\n                    tooltipIconClass = 'fa-caret-down';\r\n                }\r\n\r\n                tooltipOptions.id = systemId;\r\n                tooltipOptions.highlight = highlight;\r\n                tooltipOptions.title = '<i class=\"fa ' + tooltipIconClass + '\"></i>';\r\n                tooltipOptions.title += '&nbsp;' + userCounter;\r\n\r\n                // show system head\r\n                systemHeadExpand.velocity('stop', true).velocity({\r\n                    width: '10px'\r\n                },{\r\n                    duration: 50,\r\n                    display: 'inline-block',\r\n                    progress: function(){\r\n                        //revalidate element size and repaint\r\n                        map.revalidate( systemId );\r\n                    },\r\n                    complete: function(){\r\n                        // show system body\r\n                        system.toggleBody(true, map, {complete: function(system){\r\n                            // complete callback function\r\n                            // show active user tooltip\r\n                            system.toggleSystemTooltip('show', tooltipOptions);\r\n                        }});\r\n                    }\r\n                });\r\n            }\r\n        }else{\r\n            // no user data found for this system\r\n            system.data('userCache', false);\r\n            system.data('userCount', 0);\r\n            systemBody.empty();\r\n\r\n            if(\r\n                oldCacheKey &&\r\n                oldCacheKey.length > 0\r\n            ){\r\n                // remove tooltip\r\n                system.toggleSystemTooltip('destroy', {});\r\n\r\n                // no user -> clear SystemBody\r\n                systemHeadExpand.velocity('stop').velocity('reverse',{\r\n                    display: 'none',\r\n                    complete: function(){\r\n                        system.toggleBody(false, map, {});\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * show/hide system body element\r\n     * @param type\r\n     * @param map\r\n     * @param callback\r\n     */\r\n    $.fn.toggleBody = function(type, map, callback){\r\n        var system = $(this);\r\n        var systemBody = system.find('.' + config.systemBodyClass);\r\n\r\n        var systemDomId = system.attr('id');\r\n\r\n        if(type === true){\r\n            // show minimal body\r\n            systemBody.velocity({\r\n                height: config.systemBodyItemHeight + 'px'\r\n            },{\r\n                duration: 50,\r\n                display: 'auto',\r\n                progress: function(){\r\n                    //revalidate element size and repaint\r\n                    map.revalidate( systemDomId );\r\n                },\r\n                complete: function(){\r\n                    map.revalidate( systemDomId );\r\n\r\n                    if(callback.complete){\r\n                        callback.complete(system);\r\n                    }\r\n                }\r\n            });\r\n        }else if(type === false){\r\n            // hide body\r\n            // remove all inline styles -> possible relict from previous hover-extend\r\n            systemBody.velocity({\r\n                height: 0 + 'px',\r\n                width: '100%',\r\n                'min-width': 'none'\r\n            },{\r\n                duration: 50,\r\n                display: 'none',\r\n                begin: function(){\r\n                },\r\n                progress: function(){\r\n                    // revalidate element size and repaint\r\n                    map.revalidate( systemDomId );\r\n                },\r\n                complete: function(){\r\n                    map.revalidate( systemDomId );\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * show/hide systems tooltip\r\n     * @param show\r\n     * @param options\r\n     */\r\n    $.fn.toggleSystemTooltip = function(show, options){\r\n\r\n        // tooltip colors\r\n        var colorClasses = {\r\n            good: 'txt-color-green',\r\n            bad: 'txt-color-red'\r\n        };\r\n\r\n        return this.each(function(){\r\n            var system = $(this);\r\n            var tooltipId = 0;\r\n            var tooltipClassHighlight = false;\r\n\r\n            // do not update tooltips while a system is dragged\r\n            if(system.hasClass('jsPlumb_dragged')){\r\n                // skip system\r\n                return true;\r\n            }\r\n\r\n            if(show === 'destroy'){\r\n                system.tooltip( show );\r\n                system.removeAttr('data-original-title');\r\n            }else if(show === 'hide'){\r\n                system.tooltip( show );\r\n            } else if(show === 'toggle'){\r\n                system.tooltip( show );\r\n            }else if(show === 'show'){\r\n\r\n                // check if tooltip is currently visible\r\n                var tooltipActive = (system.attr('aria-describedby') !== undefined);\r\n\r\n                if(options === undefined){\r\n                    options = {};\r\n                }\r\n\r\n                // optional color highlight\r\n                if(colorClasses.hasOwnProperty( options.highlight )){\r\n                    tooltipClassHighlight = colorClasses[ options.highlight ];\r\n                }\r\n\r\n                if(\r\n                    tooltipActive === false &&\r\n                    options.id\r\n                ){\r\n\r\n                    // init new tooltip\r\n                    tooltipId = config.systemTooltipInnerIdPrefix + options.id;\r\n\r\n                    var template = '<div class=\"tooltip\" role=\"tooltip\">' +\r\n                        '<div class=\"tooltip-arrow\"></div>' +\r\n                        '<div id=\"' + tooltipId + '\" class=\"tooltip-inner txt-color ' + config.systemTooltipInnerClass + '\"></div>' +\r\n                        '</div>';\r\n\r\n                    options.html = true;\r\n                    options.animation = true;\r\n                    options.template = template;\r\n                    options.viewport = system.parent('.' + config.mapClass);\r\n\r\n                    system.attr('title', options.title);\r\n\r\n                    system.tooltip(options);\r\n\r\n                    system.tooltip(show);\r\n\r\n                    if(tooltipClassHighlight !== false){\r\n                        // set tooltip observer and set new class after open -> due to transition effect\r\n\r\n                        system.on('shown.bs.tooltip', function() {\r\n                            $('#' + tooltipId).addClass( tooltipClassHighlight );\r\n                            // remove observer -> color should not be changed every time a tooltip toggles e.g. dragging system\r\n                            $(this).off('shown.bs.tooltip');\r\n                        });\r\n                    }\r\n                }else{\r\n                    // update/change/toggle tooltip text or color without tooltip reload\r\n\r\n                    var tooltipInner = false;\r\n                    if(\r\n                        options.title ||\r\n                        tooltipClassHighlight !== false\r\n                    ){\r\n                        tooltipInner = system.tooltip('fixTitle')\r\n                            .data('bs.tooltip')\r\n                            .$tip.find('.tooltip-inner');\r\n\r\n                        if(options.title){\r\n                            tooltipInner.html( options.title );\r\n                        }\r\n\r\n                        if(tooltipClassHighlight !== false){\r\n                            tooltipInner.removeClass( colorClasses.good + ' ' + colorClasses.bad).addClass(tooltipClassHighlight);\r\n                        }\r\n                    }\r\n\r\n                    // show() can be forced\r\n                    if(options.show === true){\r\n                        system.tooltip('show');\r\n                    }\r\n\r\n                }\r\n            }\r\n\r\n\r\n        });\r\n    };\r\n\r\n    /**\r\n     * set or change the status of a system\r\n     * @param status\r\n     */\r\n    $.fn.setSystemStatus = function(status){\r\n        var system = $(this);\r\n\r\n        var statusId = Util.getStatusInfoForSystem(status, 'id');\r\n        var statusClass = Util.getStatusInfoForSystem(status, 'class');\r\n\r\n        for(var property in Init.systemStatus) {\r\n            if (Init.systemStatus.hasOwnProperty(property)) {\r\n                system.removeClass( Init.systemStatus[property].class );\r\n            }\r\n        }\r\n\r\n        // add new class\r\n        system.data('statusId', statusId);\r\n        system.addClass( statusClass );\r\n    };\r\n\r\n    /**\r\n     * returns a new system or updates an existing system\r\n     * @param map\r\n     * @param data\r\n     * @returns {HTMLElement}\r\n     */\r\n    $.fn.getSystem = function(map, data){\r\n\r\n        // get map container for mapId information\r\n        var mapContainer = $(this);\r\n\r\n        var systemId = config.systemIdPrefix + mapContainer.data('id') + '-' + data.id;\r\n\r\n        // check if system already exists\r\n        var system = document.getElementById( systemId );\r\n\r\n        var newPosX =  data.position.x + 'px';\r\n        var newPosY = data.position.y + 'px';\r\n\r\n        if(!system){\r\n\r\n            // set system name or alias\r\n            var systemName = data.name;\r\n\r\n            if(\r\n                data.alias &&\r\n                data.alias !== ''\r\n            ){\r\n                systemName = data.alias;\r\n            }\r\n\r\n            // get system info classes\r\n            var effectBasicClass = MapUtil.getEffectInfoForSystem('effect', 'class');\r\n            var effectName = MapUtil.getEffectInfoForSystem(data.effect, 'name');\r\n            var effectClass = MapUtil.getEffectInfoForSystem(data.effect, 'class');\r\n            var secClass = Util.getSecurityClassForSystem(data.security);\r\n\r\n            system = $('<div>', {\r\n                // system\r\n                id: systemId,\r\n                class: config.systemClass\r\n            }).append(\r\n                // system head\r\n                $('<div>', {\r\n                    class: config.systemHeadClass\r\n                }).append(\r\n                        // System name is editable\r\n                        $('<a>', {\r\n                            href: '#',\r\n                            class: config.systemHeadNameClass\r\n                        }).attr('data-value', systemName)\r\n                    ).append(\r\n                        // System locked status\r\n                        $('<i>', {\r\n                            class: ['fa', 'fa-lock', 'fa-fw'].join(' ')\r\n                        }).attr('title', 'locked')\r\n                    ).append(\r\n                        // System effect color\r\n                        $('<i>', {\r\n                            class: ['fa', 'fa-square ', 'fa-fw', effectBasicClass, effectClass].join(' ')\r\n                        }).attr('title', effectName)\r\n                    ).append(\r\n                        // expand option\r\n                        $('<i>', {\r\n                            class: ['fa', 'fa-angle-down ', config.systemHeadExpandClass].join(' ')\r\n                        })\r\n                    ).prepend(\r\n                        $('<span>', {\r\n                            class: [config.systemSec, secClass].join(' '),\r\n                            text: data.security\r\n                        })\r\n                    )\r\n            ).append(\r\n                // system body\r\n                $('<div>', {\r\n                    class: config.systemBodyClass\r\n                })\r\n            );\r\n\r\n            // set initial system position\r\n            system.css({\r\n                    'left': newPosX,\r\n                    'top': newPosY\r\n            });\r\n\r\n        }else{\r\n            system = $(system);\r\n\r\n            // set system position\r\n            var currentPosX = system.css('left');\r\n            var currentPosY = system.css('top');\r\n\r\n            if(\r\n                newPosX !== currentPosX ||\r\n                newPosY !== currentPosY\r\n            ){\r\n                // change position with animation\r\n                system.velocity(\r\n                    {\r\n                        left: newPosX,\r\n                        top: newPosY\r\n                    },{\r\n                        easing: 'linear',\r\n                        duration: Init.animationSpeed.mapMoveSystem,\r\n                        begin: function(system){\r\n                            // hide system tooltip\r\n                            $(system).toggleSystemTooltip('hide', {});\r\n\r\n                            // move them to the \"top\"\r\n                            $(system).updateSystemZIndex();\r\n                        },\r\n                        progress: function(){\r\n                            map.revalidate( systemId );\r\n                        },\r\n                        complete: function(system){\r\n                            // show tooltip\r\n                            $(system).toggleSystemTooltip('show', {show: true});\r\n\r\n                            map.revalidate( systemId );\r\n                        }\r\n                    }\r\n                );\r\n            }\r\n\r\n            // set system alias\r\n            var alias = system.getSystemInfo(['alias']);\r\n\r\n            if(alias !== data.alias){\r\n                // alias changed\r\n                system.find('.' + config.systemHeadNameClass).editable('setValue', data.alias);\r\n            }\r\n        }\r\n\r\n        // set system status\r\n        system.setSystemStatus(data.status.name);\r\n        system.data('id', parseInt(data.id));\r\n        system.data('systemId', parseInt(data.systemId));\r\n        system.data('name', data.name);\r\n        system.data('typeId', parseInt(data.type.id));\r\n        system.data('effect', data.effect);\r\n        system.data('security', data.security);\r\n        system.data('trueSec', parseFloat(data.trueSec));\r\n        system.data('regionId', parseInt(data.region.id));\r\n        system.data('region', data.region.name);\r\n        system.data('constellationId', parseInt(data.constellation.id));\r\n        system.data('constellation', data.constellation.name);\r\n        system.data('statics', data.statics);\r\n        system.data('updated', parseInt(data.updated.updated));\r\n        system.attr('data-mapid', parseInt(mapContainer.data('id')));\r\n\r\n        // locked system\r\n        if( Boolean( system.data( 'locked') ) !== data.locked ){\r\n            system.toggleLockSystem(false, {hideNotification: true, hideCounter: true, map: map});\r\n        }\r\n\r\n        // rally system\r\n        system.setSystemRally(data.rallyUpdated,  {\r\n            poke: data.rallyPoke || false,\r\n            hideNotification: true,\r\n            hideCounter: true,\r\n        });\r\n\r\n        return system;\r\n    };\r\n\r\n    /**\r\n     * draw a new map or update an existing map with all its systems and connections\r\n     * @param parentElement\r\n     * @param mapConfig\r\n     * @returns {*}\r\n     */\r\n    var updateMap = function(parentElement, mapConfig){\r\n\r\n        var mapContainer = mapConfig.map.getContainer();\r\n\r\n        var newSystems = 0;\r\n\r\n        if(mapContainer === undefined){\r\n            // add new map\r\n\r\n            // create map wrapper\r\n            var mapWrapper = $('<div>', {\r\n                class: config.mapWrapperClass\r\n            });\r\n\r\n            // create new map container\r\n            mapContainer = $('<div>', {\r\n                id: config.mapIdPrefix + mapConfig.config.id,\r\n                class: [config.mapClass].join(' ')\r\n            });\r\n\r\n            // add additional information\r\n            mapContainer.data('id', mapConfig.config.id);\r\n\r\n            mapWrapper.append(mapContainer);\r\n\r\n            // append mapWrapper to parent element (at the top)\r\n            $(parentElement).prepend(mapWrapper);\r\n\r\n            // set main Container for current map -> the container exists now in DOM !! very important\r\n            mapConfig.map.setContainer( config.mapIdPrefix + mapConfig.config.id );\r\n\r\n            // set map observer\r\n            setMapObserver(mapConfig.map);\r\n        }\r\n\r\n        mapContainer = $(mapContainer);\r\n\r\n        // add additional information for this map\r\n        if(mapContainer.data('updated') !== mapConfig.config.updated){\r\n            mapContainer.data('name', mapConfig.config.name);\r\n            mapContainer.data('scopeId', mapConfig.config.scope.id);\r\n            mapContainer.data('typeId', mapConfig.config.type.id);\r\n            mapContainer.data('icon', mapConfig.config.icon);\r\n            mapContainer.data('created', mapConfig.config.created);\r\n            mapContainer.data('updated', mapConfig.config.updated);\r\n        }\r\n\r\n\r\n        // get map data\r\n        var mapData = mapContainer.getMapDataFromClient({forceData: false});\r\n\r\n        if(mapData !== false){\r\n            // map data available -> map not locked by update counter :)\r\n\r\n            var currentSystemData = mapData.data.systems;\r\n            var currentConnectionData = mapData.data.connections;\r\n\r\n            // update systems ===========================================================\r\n            for(var i = 0; i < mapConfig.data.systems.length; i++){\r\n                var systemData = mapConfig.data.systems[i];\r\n\r\n                // add system\r\n                var addNewSystem = true;\r\n\r\n                for(var k = 0; k < currentSystemData.length; k++){\r\n                    if(currentSystemData[k].id === systemData.id){\r\n                        if( currentSystemData[k].updated.updated < systemData.updated.updated ){\r\n                            // system changed -> update\r\n                            mapContainer.getSystem(mapConfig.map, systemData);\r\n                        }\r\n\r\n                        addNewSystem = false;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if( addNewSystem === true){\r\n                    drawSystem(mapConfig.map, systemData);\r\n                    newSystems++;\r\n                }\r\n            }\r\n\r\n            // check for systems that are gone -> delete system\r\n            for(var a = 0; a < currentSystemData.length; a++){\r\n\r\n                var deleteThisSystem = true;\r\n\r\n                for(var b = 0; b < mapConfig.data.systems.length; b++){\r\n                    var deleteSystemData = mapConfig.data.systems[b];\r\n\r\n                    if(deleteSystemData.id === currentSystemData[a].id){\r\n                        deleteThisSystem = false;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if(deleteThisSystem === true){\r\n                    var deleteSystem = $('#' + config.systemIdPrefix + mapContainer.data('id') + '-' + currentSystemData[a].id);\r\n\r\n                    // system not found -> delete system\r\n                    System.removeSystems(mapConfig.map, deleteSystem);\r\n                }\r\n            }\r\n\r\n            // update connections =========================================================\r\n\r\n            // jsPlumb batch() is used, otherwise there are some \"strange\" visual bugs\r\n            // when switching maps (Endpoints are not displayed correctly)\r\n            mapConfig.map.batch(function() {\r\n\r\n                for(var j = 0; j < mapConfig.data.connections.length; j++){\r\n                    var connectionData = mapConfig.data.connections[j];\r\n\r\n                    // add connection\r\n                    var addNewConnection= true;\r\n\r\n                    for(var c = 0; c < currentConnectionData.length; c++){\r\n                        if(\r\n                            currentConnectionData[c].id === connectionData.id\r\n                        ){\r\n                            // connection already exists -> check for updates\r\n                            if(\r\n                                currentConnectionData[c].updated < connectionData.updated\r\n                            ){\r\n                                // connection changed -> update\r\n                                var tempConnection = $().getConnectionById(mapData.config.id, connectionData.id);\r\n                                updateConnection(tempConnection, currentConnectionData[c], connectionData);\r\n                            }\r\n\r\n                            addNewConnection = false;\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    if(addNewConnection === true){\r\n                        drawConnection(mapConfig.map, connectionData);\r\n                    }\r\n                }\r\n\r\n                // check for connections that are gone -> delete connection\r\n                for(var d = 0; d < currentConnectionData.length; d++){\r\n\r\n                    var deleteThisConnection = true;\r\n\r\n                    for(var e = 0; e < mapConfig.data.connections.length;e++){\r\n                        var deleteConnectionData = mapConfig.data.connections[e];\r\n\r\n                        if(deleteConnectionData.id === currentConnectionData[d].id){\r\n                            deleteThisConnection = false;\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    if(deleteThisConnection === true){\r\n                        // get connection from cache -> delete connection\r\n                        var deleteConnection = $().getConnectionById(mapData.config.id, currentConnectionData[d].id);\r\n\r\n                        if(deleteConnection){\r\n                            // check if \"source\" and \"target\" still exist before remove\r\n                            // this is NOT the case if the system was removed previous\r\n                            if(\r\n                                deleteConnection.source &&\r\n                                deleteConnection.target\r\n                            ){\r\n                                mapConfig.map.detach(deleteConnection, {fireEvent: false});\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            });\r\n\r\n            // update map \"magnetization\" when new systems where added\r\n            if(newSystems > 0){\r\n                MagnetizerWrapper.setElements(mapConfig.map);\r\n            }\r\n        }\r\n\r\n        return mapContainer;\r\n    };\r\n\r\n    /**\r\n     * update local connection cache\r\n     * @param mapId\r\n     * @param connection\r\n     */\r\n    var updateConnectionCache = function(mapId, connection){\r\n\r\n        if(\r\n            mapId > 0 &&\r\n            connection\r\n        ){\r\n            var connectionId = parseInt( connection.getParameter('connectionId') );\r\n\r\n            if(connectionId > 0){\r\n                connectionCache[mapId][connectionId] = connection;\r\n            }else{\r\n                console.warn('updateConnectionCache', 'connectionId missing');\r\n            }\r\n        }else{\r\n            console.warn('updateConnectionCache', 'missing data');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get a connection object from \"cache\" (this requires the \"connectionCache\" cache to be actual!\r\n     * @param mapId\r\n     * @param connectionId\r\n     * @returns {*}\r\n     */\r\n    $.fn.getConnectionById = function(mapId, connectionId){\r\n\r\n        var connection = null;\r\n\r\n        if(\r\n            connectionCache[mapId] &&\r\n            connectionCache[mapId][connectionId]\r\n        ){\r\n            connection = connectionCache[mapId][connectionId];\r\n        }\r\n\r\n        return connection;\r\n    };\r\n\r\n    /**\r\n     * make all systems appear visual on the map with its connections\r\n     * @param show\r\n     * @param callback\r\n     */\r\n    $.fn.visualizeMap = function(show, callback){\r\n        var mapElement = $(this);\r\n\r\n        // start map update counter -> prevent map updates during animations\r\n        mapElement.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n        var systemElements = mapElement.find('.' + config.systemClass);\r\n        var endpointElements =  mapElement.find('.jsplumb-endpoint');\r\n        var connectorElements = mapElement.find('.jsplumb-connector');\r\n        var overlayElements = mapElement.find('.jsplumb-overlay, .tooltip');\r\n\r\n        // if map empty (no systems), execute callback and return\r\n        // no visual effects on larger maps\r\n        if(\r\n            systemElements.length === 0 ||\r\n            systemElements.length > 20 ||\r\n            endpointElements.length === 0\r\n        ){\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        // show nice animation\r\n        if(show === 'show'){\r\n            // hide elements\r\n            systemElements.css('opacity', 0);\r\n            endpointElements.css('opacity', 0);\r\n            connectorElements.css('opacity', 0);\r\n            overlayElements.css('opacity', 0);\r\n\r\n            systemElements.velocity('transition.whirlIn', {\r\n                stagger: 30,\r\n                drag: true,\r\n                duration: 100,\r\n                //display: 'auto',\r\n                complete: function(){\r\n                    // show connections\r\n                    endpointElements.velocity('transition.fadeIn', {\r\n                        duration: 0\r\n                    });\r\n\r\n                    connectorElements.velocity('transition.fadeIn', {\r\n                        stagger: 30,\r\n                        duration: 120,\r\n                        complete: function(){\r\n                            callback();\r\n                        }\r\n                    });\r\n\r\n                    // show overlay elements (if some exist)\r\n                    if(overlayElements.length > 0){\r\n                        overlayElements.delay(500).velocity('transition.fadeIn', {\r\n                            stagger: 50,\r\n                            duration: 180,\r\n                            display: 'auto'\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        }else if(show === 'hide'){\r\n\r\n            $('.mCSB_container').velocity('callout.shake', {\r\n                stagger: 0,\r\n                drag: false,\r\n                duration: 180,\r\n                display: 'auto'\r\n            });\r\n\r\n            overlayElements.velocity('transition.fadeOut', {\r\n                stagger: 50,\r\n                drag: true,\r\n                duration: 180,\r\n                display: 'auto'\r\n            });\r\n\r\n            endpointElements.velocity('transition.fadeOut', {\r\n                duration: 0,\r\n                display: 'block',\r\n                complete: function(){\r\n                    // show connections\r\n                    connectorElements.velocity('transition.fadeOut', {\r\n                        stagger: 0,\r\n                        drag: true,\r\n                        duration: 20,\r\n                        display: 'block'\r\n                    });\r\n\r\n                    systemElements.delay(100).velocity('transition.slideUpOut', {\r\n                        stagger: 30,\r\n                        drag: true,\r\n                        duration: 180,\r\n                        display: 'block',\r\n                        complete: function(){\r\n                            callback();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * mark a system as source\r\n     * @param map\r\n     * @param system\r\n     */\r\n    var makeSource = function(map, system){\r\n\r\n        // get scope from map defaults\r\n        var sourceConfig = globalMapConfig.source;\r\n        sourceConfig.scope = map.Defaults.Scope;    // set all allowed connections for this scopes\r\n\r\n        // default connector for initial dragging a new connection\r\n        sourceConfig.connector = MapUtil.getScopeInfoForConnection('wh', 'connectorDefinition');\r\n\r\n        map.makeSource(system, sourceConfig);\r\n    };\r\n\r\n    /**\r\n     * mark a system as target\r\n     * @param map\r\n     * @param system\r\n     */\r\n    var makeTarget = function(map, system){\r\n\r\n        // get scope from map defaults\r\n        var targetConfig = globalMapConfig.target;\r\n        targetConfig.scope = map.Defaults.Scope;    // set all allowed connections for this scopes\r\n\r\n        map.makeTarget(system, targetConfig);\r\n    };\r\n\r\n    /**\r\n     * checks if json system data is valid\r\n     * @param systemData\r\n     * @returns {boolean}\r\n     */\r\n    var isValidSystem = function(systemData){\r\n\r\n        var isValid = true;\r\n\r\n        if(\r\n            ! systemData.hasOwnProperty('name') ||\r\n            systemData.name.length === 0\r\n        ){\r\n            return false;\r\n        }\r\n\r\n        return isValid;\r\n    };\r\n\r\n    /**\r\n     * draw a system with its data to a map\r\n     * @param map\r\n     * @param systemData\r\n     * @param connectedSystem\r\n     */\r\n    var drawSystem = function(map, systemData, connectedSystem){\r\n\r\n        // check if systemData is valid\r\n        if(isValidSystem(systemData)){\r\n            var mapContainer = $(map.getContainer());\r\n\r\n            // get System Element by data\r\n            var newSystem = mapContainer.getSystem(map, systemData);\r\n\r\n            // add new system to map\r\n            mapContainer.append(newSystem);\r\n\r\n            // make new system editable\r\n            makeEditable(newSystem);\r\n\r\n            // make target\r\n            makeTarget(map, newSystem);\r\n\r\n            // make source\r\n            makeSource(map, newSystem);\r\n\r\n            // set system observer\r\n            setSystemObserver(map, newSystem);\r\n\r\n            // connect new system (if connection data is given)\r\n            if(connectedSystem){\r\n\r\n                // hint: \"type\" will be auto detected by jump distance\r\n                var connectionData = {\r\n                    source: $(connectedSystem).data('id'),\r\n                    target: newSystem.data('id'),\r\n                    type: ['wh_fresh'] // default type.\r\n                };\r\n                var connection = drawConnection(map, connectionData);\r\n\r\n                // store connection\r\n                saveConnection(connection);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * make a system name/alias editable by x-editable\r\n     * @param system\r\n     */\r\n    var makeEditable = function(system){\r\n        system = $(system);\r\n        var headElement = $(system).find('.' + config.systemHeadNameClass);\r\n\r\n        headElement.editable({\r\n            mode: 'popup',\r\n            type: 'text',\r\n            name: 'alias',\r\n            emptytext: system.data('name'),\r\n            title: 'System alias',\r\n            placement: 'top',\r\n            onblur: 'submit',\r\n            container: 'body',\r\n            toggle: 'manual',       // is triggered manually on dblClick\r\n            showbuttons: false\r\n        });\r\n\r\n        headElement.on('save', function(e, params) {\r\n            // system alias changed -> mark system as updated\r\n            system.markAsChanged();\r\n        });\r\n    };\r\n\r\n    /**\r\n     * update z-index for a system (dragged systems should be always on top)\r\n     */\r\n    $.fn.updateSystemZIndex = function(){\r\n        return this.each(function(){\r\n            // increase global counter\r\n            var newZIndexSystem = config.zIndexCounter++;\r\n            $(this).css('z-index', newZIndexSystem);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * connect two systems\r\n     * @param map\r\n     * @param connectionData\r\n     * @returns new connection\r\n     */\r\n    var drawConnection = function(map, connectionData){\r\n        var mapContainer = $( map.getContainer() );\r\n        var mapId = mapContainer.data('id');\r\n        var connectionId = connectionData.id || 0;\r\n        var connection;\r\n        var sourceSystem = $('#' + config.systemIdPrefix + mapId + '-' + connectionData.source);\r\n        var targetSystem = $('#' + config.systemIdPrefix + mapId + '-' + connectionData.target);\r\n\r\n        // check if both systems exists\r\n        // (If not -> something went wrong e.g. DB-Foreign keys for \"ON DELETE\",...)\r\n        if(\r\n            sourceSystem.length &&\r\n            targetSystem.length\r\n        ){\r\n            connection = map.connect({\r\n                source: sourceSystem[0],\r\n                target: targetSystem[0],\r\n                /*\r\n                 parameters: {\r\n                 connectionId: connectionId,\r\n                 updated: connectionData.updated\r\n                 },\r\n                 */\r\n                type: null\r\n                /* experimental (straight connections)\r\n                 anchors: [\r\n                 [ \"Perimeter\", { shape: 'Rectangle' }],\r\n                 [ \"Perimeter\", { shape: 'Rectangle' }]\r\n                 ]\r\n                 */\r\n            });\r\n\r\n            // check if connection is valid (e.g. source/target exist\r\n            if( connection instanceof jsPlumb.Connection ){\r\n\r\n                // set connection parameters\r\n                // they should persist even through connection type change (e.g. wh -> stargate,..)\r\n                // therefore they should be part of the connection not of the connector\r\n                connection.setParameters({\r\n                    connectionId: connectionId,\r\n                    updated: connectionData.updated,\r\n                    eolUpdated: connectionData.eolUpdated\r\n                });\r\n\r\n                // add connection types -------------------------------------------------------------------------\r\n                if(connectionData.type){\r\n                    for(var i = 0; i < connectionData.type.length; i++){\r\n                        connection.addType(connectionData.type[i]);\r\n                    }\r\n                }\r\n\r\n                // add connection scope -------------------------------------------------------------------------\r\n                // connection have the default map Scope scope\r\n                var scope = map.Defaults.Scope;\r\n                if(connectionData.scope){\r\n                    scope = connectionData.scope;\r\n                }\r\n                setConnectionScope(connection, scope);\r\n            }\r\n\r\n            // set Observer for new Connection -> is automatically set\r\n        }else{\r\n            if( !sourceSystem.length ){\r\n                console.warn('drawConnection(): source system (id: ' + connectionData.source + ') not found');\r\n            }\r\n            if( !targetSystem.length ){\r\n                console.warn('drawConnection(): target system (id: ' + connectionData.target + ') not found');\r\n            }\r\n        }\r\n\r\n        return connection;\r\n    };\r\n\r\n    /**\r\n     * stores a connection in database\r\n     * @param connection\r\n     */\r\n    var saveConnection = function(connection){\r\n\r\n        if( connection instanceof jsPlumb.Connection ){\r\n\r\n            var map = connection._jsPlumb.instance;\r\n            var mapContainer = $( map.getContainer() );\r\n            mapContainer.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n            var mapId = mapContainer.data('id');\r\n            var connectionData = getDataByConnection(connection);\r\n\r\n            var requestData = {\r\n                mapData: {\r\n                    id: mapId\r\n                },\r\n                connectionData: connectionData\r\n            };\r\n\r\n            $.ajax({\r\n                type: 'POST',\r\n                url: Init.path.saveConnection,\r\n                data: requestData,\r\n                dataType: 'json',\r\n                //context: connection\r\n                context: {\r\n                    connection: connection,\r\n                    map: map,\r\n                    mapId: mapId\r\n                }\r\n            }).done(function(newConnectionData){\r\n\r\n                if( !$.isEmptyObject(newConnectionData) ){\r\n                    // update connection data e.g. \"scope\" has auto detected\r\n                    connection = updateConnection(this.connection, connectionData, newConnectionData);\r\n\r\n                    // new connection should be cached immediately!\r\n                    updateConnectionCache(this.mapId, connection);\r\n\r\n                    // connection scope\r\n                    var scope = MapUtil.getScopeInfoForConnection(newConnectionData.scope, 'label');\r\n\r\n                    var title = 'New connection established';\r\n                    if(connectionData.id > 0){\r\n                        title = 'Connection switched';\r\n                    }\r\n\r\n                    Util.showNotify({title: title, text: 'Scope: ' + scope, type: 'success'});\r\n                }else{\r\n                    // some save errors\r\n                    this.map.detach(this.connection, {fireEvent: false});\r\n                }\r\n\r\n            }).fail(function( jqXHR, status, error) {\r\n                // remove this connection from map\r\n                this.map.detach(this.connection, {fireEvent: false});\r\n\r\n                var reason = status + ' ' + error;\r\n                Util.showNotify({title: jqXHR.status + ': saveConnection', text: reason, type: 'warning'});\r\n                $(document).setProgramStatus('problem');\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * delete a connection and all related data\r\n     * @param connections\r\n     * @param callback\r\n     */\r\n    $.fn.deleteConnections = function(connections, callback){\r\n        if(connections.length > 0){\r\n\r\n            // remove connections from map\r\n            var removeConnections = function(tempConnections){\r\n                for(var i = 0; i < tempConnections.length; i++){\r\n                    // if a connection is manually (drag&drop) detached, the jsPlumb instance does not exist any more\r\n                    // connection is already deleted!\r\n                    if(tempConnections[i]._jsPlumb){\r\n                        tempConnections[i]._jsPlumb.instance.detach(tempConnections[i], {fireEvent: false});\r\n                    }\r\n                }\r\n            };\r\n\r\n            // prepare delete request\r\n            var map = connections[0]._jsPlumb.instance;\r\n            var mapContainer = $( map.getContainer() );\r\n            mapContainer.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n            var connectionIds = [];\r\n            // connectionIds for delete request\r\n            for(var i = 0; i < connections.length; i++){\r\n                var connectionId = connections[i].getParameter('connectionId');\r\n                // drag&drop a new connection does not have an id yet, if connection is not established correct\r\n                if(connectionId !== undefined){\r\n                    connectionIds[i] = connections[i].getParameter('connectionId');\r\n                }\r\n            }\r\n\r\n            if(connectionIds.length > 0){\r\n                var requestData = {\r\n                    connectionIds: connectionIds\r\n                };\r\n\r\n                $.ajax({\r\n                    type: 'POST',\r\n                    url: Init.path.deleteConnection,\r\n                    data: requestData,\r\n                    dataType: 'json',\r\n                    context: connections\r\n                }).done(function(data){\r\n\r\n                    // remove connections from map\r\n                    removeConnections(this);\r\n\r\n                    // optional callback\r\n                    if(callback){\r\n                        callback();\r\n                    }\r\n\r\n                }).fail(function( jqXHR, status, error) {\r\n                    var reason = status + ' ' + error;\r\n                    Util.showNotify({title: jqXHR.status + ': deleteSystem', text: reason, type: 'warning'});\r\n                    $(document).setProgramStatus('problem');\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * compares the current data and new data of a connection and updates status\r\n     * @param connection\r\n     * @param connectionData\r\n     * @param newConnectionData\r\n     * @returns {*}\r\n     */\r\n    var updateConnection = function(connection, connectionData, newConnectionData){\r\n\r\n        var map = connection._jsPlumb.instance;\r\n        var mapContainer = $( map.getContainer() );\r\n        var mapId = mapContainer.data('id');\r\n\r\n        // check id, IDs should never change but must be set after initial save\r\n        if(connection.getParameter('connectionId') !== newConnectionData.id){\r\n            connection.setParameter('connectionId', newConnectionData.id);\r\n        }\r\n\r\n        // check scope\r\n        if(connectionData.scope !== newConnectionData.scope){\r\n            setConnectionScope(connection, newConnectionData.scope);\r\n            // for some reason the observers are gone after scope change...\r\n            setConnectionObserver(map, connection);\r\n        }\r\n\r\n        var addType = newConnectionData.type.diff( connectionData.type );\r\n        var removeType = connectionData.type.diff( newConnectionData.type );\r\n\r\n        // check if source or target has changed\r\n        if(connectionData.source !== newConnectionData.source ){\r\n            map.setSource(connection, config.systemIdPrefix + mapId + '-' + newConnectionData.source);\r\n        }\r\n        if(connectionData.target !== newConnectionData.target ){\r\n            map.setTarget(connection, config.systemIdPrefix + mapId + '-' + newConnectionData.target);\r\n        }\r\n\r\n        // connection.targetId\r\n        // add types\r\n        for(var i = 0; i < addType.length; i++){\r\n            if(\r\n                addType[i].indexOf('fresh') !== -1 ||\r\n                addType[i].indexOf('reduced') !== -1 ||\r\n                addType[i].indexOf('critical') !== -1\r\n            ){\r\n                MapUtil.setConnectionWHStatus(connection, addType[i]);\r\n            }else if( connection.hasType(addType[i]) !== true ){\r\n                // additional types e.g. eol, frig, preserve mass\r\n                connection.addType(addType[i]);\r\n                setConnectionObserver(map, connection);\r\n            }\r\n        }\r\n\r\n        // remove types\r\n        for(var j = 0; j < removeType.length; j++){\r\n            if(\r\n                removeType[j] === 'wh_eol' ||\r\n                removeType[j] === 'frigate' ||\r\n                removeType[j] === 'preserve_mass'\r\n            ){\r\n                connection.removeType(removeType[j]);\r\n                setConnectionObserver(map, connection);\r\n            }\r\n        }\r\n\r\n        // set update date (important for update check)\r\n        // important: set parameters ONE-by-ONE!\r\n        // -> (setParameters() will overwrite all previous params)\r\n        connection.setParameter('updated', newConnectionData.updated);\r\n        connection.setParameter('eolUpdated', newConnectionData.eolUpdated);\r\n\r\n        return connection;\r\n    };\r\n\r\n    /**\r\n     * set/change connection scope\r\n     * @param connection\r\n     * @param scope\r\n     */\r\n    var setConnectionScope = function(connection, scope){\r\n        var map = connection._jsPlumb.instance;\r\n        var currentConnector = connection.getConnector();\r\n        var newConnector = MapUtil.getScopeInfoForConnection(scope, 'connectorDefinition');\r\n\r\n        if(currentConnector.type !== newConnector[0]){\r\n            // connector has changed\r\n\r\n            connection.setConnector( newConnector );\r\n\r\n            // remove all connection types\r\n            connection.clearTypes();\r\n\r\n            // set new new connection type\r\n            // if scope changed -> connection type == scope\r\n            connection.setType( MapUtil.getDefaultConnectionTypeByScope(scope) );\r\n\r\n            // change scope\r\n            connection.scope = scope;\r\n\r\n            // new observer is required after scope change\r\n            setConnectionObserver(map, connection);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * load context menu template for map\r\n     */\r\n    var initMapContextMenu = function(){\r\n\r\n        var moduleConfig = {\r\n            name: 'modules/contextmenu',\r\n            position: $('#' + config.dynamicElementWrapperId)\r\n        };\r\n\r\n        var moduleData = {\r\n            id: config.mapContextMenuId,\r\n            items: [\r\n                {icon: 'fa-info', action: 'info', text: 'info'},\r\n                {icon: 'fa-plus', action: 'add_system', text: 'add system'},\r\n                {icon: 'fa-object-ungroup', action: 'select_all', text: 'select all'},\r\n                {icon: 'fa-filter', action: 'filter_scope', text: 'filter scope', subitems: [\r\n                    {subIcon: '', subAction: 'filter_wh', subText: 'wormhole'},\r\n                    {subIcon: '', subAction: 'filter_stargate', subText: 'stargate'},\r\n                    {subIcon: '', subAction: 'filter_jumpbridge', subText: 'jumpbridge'}\r\n                ]},\r\n                {divider: true, action: 'delete_systems'},\r\n                {icon: 'fa-trash', action: 'delete_systems', text: 'delete systems'}\r\n            ]\r\n        };\r\n\r\n        Render.showModule(moduleConfig, moduleData);\r\n    };\r\n\r\n    /**\r\n     * load contextmenu template for connections\r\n     */\r\n    var initConnectionContextMenu = function(){\r\n\r\n        var moduleConfig = {\r\n            name: 'modules/contextmenu',\r\n            position: $('#' + config.dynamicElementWrapperId)\r\n        };\r\n\r\n        var moduleData = {\r\n            id: config.connectionContextMenuId,\r\n            items: [\r\n                {icon: 'fa-plane', action: 'frigate', text: 'frigate hole'},\r\n                {icon: 'fa-warning', action: 'preserve_mass', text: 'preserve mass'},\r\n                {icon: 'fa-crosshairs', action: 'change_scope', text: 'change scope', subitems: [\r\n                    {subIcon: 'fa-minus-circle', subIconClass: '', subAction: 'scope_wh', subText: 'wormhole'},\r\n                    {subIcon: 'fa-minus-circle', subIconClass: 'txt-color  txt-color-indigoDarkest', subAction: 'scope_stargate', subText: 'stargate'},\r\n                    {subIcon: 'fa-minus-circle', subIconClass: 'txt-color  txt-color-tealLighter', subAction: 'scope_jumpbridge', subText: 'jumpbridge'}\r\n\r\n                ]},\r\n                {icon: 'fa-reply fa-rotate-180', action: 'change_status', text: 'change status', subitems: [\r\n                    {subIcon: 'fa-clock-o', subAction: 'wh_eol', subText: 'toggle EOL'},\r\n                    {subDivider: true},\r\n                    {subIcon: 'fa-circle', subAction: 'status_fresh', subText: 'stage 1 (fresh)'},\r\n                    {subIcon: 'fa-adjust', subAction: 'status_reduced', subText: 'stage 2 (reduced)'},\r\n                    {subIcon: 'fa-circle-o', subAction: 'status_critical', subText: 'stage 3 (critical)'}\r\n\r\n                ]},\r\n                {divider: true, action: 'delete_connection'},\r\n                {icon: 'fa-trash', action: 'delete_connection', text: 'delete'}\r\n            ]\r\n        };\r\n\r\n        Render.showModule(moduleConfig, moduleData);\r\n\r\n    };\r\n\r\n    /**\r\n     * load contextmenu template for systems\r\n     */\r\n    var initSystemContextMenu = function(){\r\n\r\n        var systemStatus = [];\r\n        $.each(Init.systemStatus, function(status, statusData){\r\n            var tempStatus = {\r\n                subIcon: 'fa-tag',\r\n                subIconClass: statusData.class,\r\n                subAction: 'change_status_' + status,\r\n                subText: statusData.label\r\n            };\r\n            systemStatus.push(tempStatus);\r\n        });\r\n\r\n        var moduleConfig = {\r\n            name: 'modules/contextmenu',\r\n            position: $('#' + config.dynamicElementWrapperId)\r\n        };\r\n\r\n        var moduleData = {\r\n            id: config.systemContextMenuId,\r\n            items: [\r\n                {icon: 'fa-plus', action: 'add_system', text: 'add system'},\r\n                {icon: 'fa-lock', action: 'lock_system', text: 'lock system'},\r\n                {icon: 'fa-users', action: 'set_rally', text: 'set rally point'},\r\n                {icon: 'fa-tags', text: 'set status', subitems: systemStatus},\r\n                {icon: 'fa-reply fa-rotate-180', text: 'waypoints', subitems: [\r\n                    {subIcon: 'fa-flag-checkered', subAction: 'set_destination', subText: 'set destination'},\r\n                    {subDivider: true, action: ''},\r\n                    {subIcon: 'fa-step-backward', subAction: 'add_first_waypoint', subText: 'add new [start]'},\r\n                    {subIcon: 'fa-step-forward', subAction: 'add_last_waypoint', subText: 'add new [end]'}\r\n                ]},\r\n                {divider: true, action: 'delete_system'},\r\n                {icon: 'fa-trash', action: 'delete_system', text: 'delete system(s)'}\r\n            ]\r\n        };\r\n\r\n        Render.showModule(moduleConfig, moduleData);\r\n\r\n    };\r\n\r\n    /**\r\n     * set up all actions that can be preformed on a system\r\n     * @param map\r\n     * @param system\r\n     */\r\n    var setSystemObserver = function(map, system){\r\n        system = $(system);\r\n\r\n        // get map container\r\n        var mapContainer = $( map.getContainer() );\r\n        var systemHeadExpand = $( system.find('.' + config.systemHeadExpandClass) );\r\n        var systemBody = $( system.find('.' + config.systemBodyClass) );\r\n\r\n        // map overlay will be set on \"drag\" start\r\n        var mapOverlayTimer = null;\r\n\r\n        // make system draggable\r\n        map.draggable(system, {\r\n            containment: 'parent',\r\n            constrain: true,\r\n            //scroll: true,                                             // not working because of customized scrollbar\r\n            filter: '.' + config.systemHeadNameClass,                   // disable drag on \"system name\"\r\n            snapThreshold: MapUtil.config.mapSnapToGridDimension,       // distance for grid snapping \"magnet\" effect (optional)\r\n            start: function(params){\r\n                var dragSystem = $(params.el);\r\n\r\n                mapOverlayTimer = dragSystem.getMapOverlay('timer');\r\n\r\n                // start map update timer\r\n                mapOverlayTimer.startMapUpdateCounter();\r\n\r\n                // check if grid-snap is enable -> this enables napping for !CURRENT! Element\r\n                if( mapContainer.hasClass(MapUtil.config.mapGridClass) ){\r\n                    params.drag.params.grid = [MapUtil.config.mapSnapToGridDimension, MapUtil.config.mapSnapToGridDimension];\r\n                }else{\r\n                    delete( params.drag.params.grid );\r\n                }\r\n\r\n                // stop \"system click event\" right after drop event is finished\r\n                dragSystem.addClass('no-click');\r\n\r\n                // drag system is not always selected\r\n                var selectedSystems = mapContainer.getSelectedSystems().get();\r\n                selectedSystems = selectedSystems.concat( dragSystem.get() );\r\n                selectedSystems = $.unique( selectedSystems );\r\n\r\n                // hide tooltip\r\n                $(selectedSystems).toggleSystemTooltip('hide', {});\r\n\r\n                // move them to the \"top\"\r\n                $(selectedSystems).updateSystemZIndex();\r\n            },\r\n            drag: function(p){\r\n                // start map update timer\r\n                mapOverlayTimer.startMapUpdateCounter();\r\n\r\n                // update system positions for \"all\" systems that are effected by drag&drop\r\n                // this requires \"magnet\" feature to be active! (optional)\r\n                MagnetizerWrapper.executeAtEvent(map, p.e);\r\n            },\r\n            stop: function(params){\r\n                var dragSystem = $(params.el);\r\n\r\n                // start map update timer\r\n                mapOverlayTimer.startMapUpdateCounter();\r\n\r\n                setTimeout(function(){\r\n                    dragSystem.removeClass('no-click');\r\n                }, Init.timer.DBL_CLICK + 50);\r\n\r\n                // show tooltip\r\n                dragSystem.toggleSystemTooltip('show', {show: true});\r\n\r\n                // mark as \"changed\"\r\n                dragSystem.markAsChanged();\r\n\r\n                // set new position for popover edit field (system name)\r\n                var newPosition = dragSystem.position();\r\n\r\n                var placement = 'top';\r\n                if(newPosition.top < 100){\r\n                    placement = 'bottom';\r\n                }\r\n                if(newPosition.left < 100){\r\n                    placement = 'right';\r\n                }\r\n                dragSystem.find('.' + config.systemHeadNameClass).editable('option', 'placement', placement);\r\n\r\n                // drag system is not always selected\r\n                var selectedSystems = mapContainer.getSelectedSystems().get();\r\n                selectedSystems = selectedSystems.concat( dragSystem.get() );\r\n                selectedSystems = $.unique( selectedSystems );\r\n\r\n                for(var i = 0; i < selectedSystems.length; i++){\r\n                    var tempSystem = $(selectedSystems[i]);\r\n                    // repaint connections -> just in case something fails...\r\n                    map.revalidate( tempSystem.attr('id') );\r\n                }\r\n            }\r\n        });\r\n\r\n        if(system.data('locked') === true){\r\n            map.setDraggable(system, false);\r\n        }\r\n\r\n        // init system tooltips =============================================================================\r\n        var systemTooltipOptions = {\r\n            toggle: 'tooltip',\r\n            placement: 'right',\r\n            container: 'body',\r\n            viewport: system.id\r\n        };\r\n\r\n        system.find('.fa').tooltip(systemTooltipOptions);\r\n\r\n        // init system body expand ==========================================================================\r\n        systemHeadExpand.hoverIntent(function(e){\r\n            // hover in\r\n            var hoverSystem = $(this).parents('.' + config.systemClass);\r\n            var hoverSystemId = hoverSystem.attr('id');\r\n\r\n            // bring system in front (increase zIndex)\r\n            hoverSystem.updateSystemZIndex();\r\n\r\n            // get ship counter and calculate expand height\r\n            var userCount = parseInt( hoverSystem.data('userCount') );\r\n\r\n            var expandHeight = userCount * config.systemBodyItemHeight;\r\n\r\n            systemBody.velocity('stop').velocity(\r\n                {\r\n                    height: expandHeight + 'px',\r\n                    width: 150,\r\n                    'min-width': '150px'\r\n                },{\r\n                    easing: 'easeInOutQuart',\r\n                    duration: 150,\r\n                    progress: function(){\r\n                        // repaint connections of current system\r\n                        map.revalidate( hoverSystemId );\r\n                    },\r\n                    complete: function(){\r\n                        map.revalidate( hoverSystemId );\r\n\r\n                        // extend player name element\r\n                        $(this).find('.' + config.systemBodyItemNameClass).css({width: '80px'});\r\n\r\n                        $(this).find('.' + config.systemBodyRightClass).velocity('stop').velocity({\r\n                            opacity: 1\r\n                        },{\r\n                            duration: 150,\r\n                            display: 'auto'\r\n                        });\r\n                    }\r\n                }\r\n            );\r\n\r\n        }, function(e){\r\n            // hover out\r\n            var hoverSystem = $(this).parents('.' + config.systemClass);\r\n            var hoverSystemId = hoverSystem.attr('id');\r\n\r\n            // stop animation (prevent visual bug if user spams hover-icon [in - out])\r\n            systemBody.velocity('stop');\r\n\r\n            // reduce player name element back to \"normal\" size (css class width is used)\r\n            systemBody.find('.' + config.systemBodyItemNameClass).css({width: ''});\r\n\r\n            systemBody.find('.' + config.systemBodyRightClass).velocity('stop').velocity( {\r\n                opacity: 0,\r\n                'min-width': '0px'\r\n            },{\r\n                easing: 'easeInOutQuart',\r\n                duration: 150,\r\n                display: 'none',\r\n                complete: function(){\r\n                    systemBody.velocity('stop').velocity('reverse', {\r\n                        complete: function(){\r\n                            // overwrite \"complete\" function from first \"hover\"-open\r\n                            map.revalidate( hoverSystemId );\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n        });\r\n\r\n        // context menu =====================================================================================\r\n\r\n        // trigger context menu\r\n        system.off('contextmenu').on('contextmenu', function(e){\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            var systemElement = $(this);\r\n\r\n            // hide all map contextmenu options\r\n            var hideOptions = getHiddenContextMenuOptions(systemElement);\r\n\r\n            var activeOptions = getActiveContextMenuOptions(systemElement);\r\n\r\n            $(e.target).trigger('pf:openContextMenu', [e, this, hideOptions, activeOptions]);\r\n            return false;\r\n        });\r\n\r\n        // init context menu\r\n        system.contextMenu({\r\n            menuSelector: '#' + config.systemContextMenuId,\r\n            menuSelected: function (params) {\r\n\r\n                // click action\r\n                var action = params.selectedMenu.attr('data-action');\r\n\r\n                // current system\r\n                var currentSystem = $(params.component);\r\n\r\n                // system name\r\n                var currentSystemName = currentSystem.getSystemInfo( ['alias'] );\r\n\r\n                var systemData = {};\r\n\r\n                switch(action){\r\n                    case 'add_system':\r\n                        // add a new system\r\n                        showNewSystemDialog(map, {sourceSystem: currentSystem} );\r\n\r\n                        break;\r\n                    case 'lock_system':\r\n                        // lock system\r\n                        currentSystem.toggleLockSystem(true, {map: map});\r\n\r\n                        // repaint connections, -> system changed its size!\r\n                        map.repaint( currentSystem );\r\n\r\n                        currentSystem.markAsChanged();\r\n                        break;\r\n                    case 'set_rally':\r\n                        // toggle rally point\r\n                        if( !currentSystem.data( 'rallyUpdated' ) ){\r\n                            $.fn.showRallyPointDialog(currentSystem);\r\n                        }else{\r\n                            // remove rally point\r\n                            currentSystem.setSystemRally(0);\r\n                            currentSystem.markAsChanged();\r\n                        }\r\n                        break;\r\n                    case 'change_status_unknown':\r\n                    case 'change_status_friendly':\r\n                    case 'change_status_occupied':\r\n                    case 'change_status_hostile':\r\n                    case 'change_status_empty':\r\n                    case 'change_status_unscanned':\r\n                        // change system status\r\n                        currentSystem.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n                        var statusString = action.split('_');\r\n\r\n                        currentSystem.setSystemStatus(statusString[2]);\r\n\r\n                        currentSystem.markAsChanged();\r\n                        break;\r\n                    case 'delete_system':\r\n                        // delete this system AND delete selected systems as well\r\n                        var selectedSystems = mapContainer.getSelectedSystems();\r\n                        $.merge(selectedSystems, currentSystem);\r\n                        $.uniqueSort(selectedSystems);\r\n                        $.fn.showDeleteSystemDialog(map, selectedSystems);\r\n                        break;\r\n                    case 'set_destination':\r\n                    case 'add_first_waypoint':\r\n                    case 'add_last_waypoint':\r\n                        systemData = system.getSystemData();\r\n                        Util.setDestination(systemData, action);\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n\r\n        // system click events ==============================================================================\r\n        var double = function(e){\r\n            var system = $(this);\r\n            var headElement = $(system).find('.' + config.systemHeadNameClass);\r\n\r\n            // update z-index for system, editable field should be on top\r\n            // move them to the \"top\"\r\n            $(system).updateSystemZIndex();\r\n\r\n            // show \"set alias\" input (x-editable)\r\n            headElement.editable('show');\r\n        };\r\n\r\n        var single = function(e){\r\n\r\n            // check if click was performed on \"popover\" (x-editable)\r\n            var popoverClick = false;\r\n            if( $(e.target).parents('.popover').length ){\r\n                popoverClick = true;\r\n            }\r\n\r\n            // continue if click was *not* on a popover dialog of a system\r\n            if( !popoverClick ){\r\n                var system = $(this);\r\n\r\n                // check if system is locked for \"click\" events\r\n                if( !system.hasClass('no-click') ){\r\n                    // left mouse button\r\n                    if(e.which === 1){\r\n                        if(! system.hasClass('no-click')){\r\n                            if(e.ctrlKey === true){\r\n                                // select system\r\n                                system.toggleSelectSystem(map);\r\n                            }else{\r\n                                system.showSystemInfo(map);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n        };\r\n\r\n        system.singleDoubleClick(single, double);\r\n    };\r\n\r\n    /**\r\n     * mark a dom element (map, system, connection) as changed\r\n     */\r\n    $.fn.markAsChanged = function(){\r\n        return this.each(function(){\r\n            var element = $(this);\r\n\r\n            if( element.hasClass(config.systemClass) ){\r\n                // system element\r\n                element.data('updated', 0);\r\n            }else{\r\n                // connection element\r\n                this.setParameter('updated', 0);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * check if an dom element (system, connection) has changed\r\n     * @returns {boolean}\r\n     */\r\n    $.fn.hasChanged = function(){\r\n        var element = $(this);\r\n        var changed = false;\r\n\r\n        if( element.hasClass(config.systemClass) ){\r\n            // system element\r\n            changed = (element.data('updated') === 0);\r\n        }else{\r\n            // connection element\r\n            changed = (this[0].getParameter('updated') === 0);\r\n        }\r\n\r\n        return changed;\r\n    };\r\n\r\n    /**\r\n     * triggers the \"showSystemInfo\" event, that is responsible for initializing the \"map info\" panel\r\n     * @param map\r\n     */\r\n    $.fn.showSystemInfo = function(map){\r\n        var system = $(this);\r\n\r\n        // activate system\r\n        markSystemActive(map, system);\r\n\r\n        // get parent Tab Content and fire update event\r\n        var tabContentElement = MapUtil.getTabContentElementByMapElement( system );\r\n\r\n        // collect all required data from map module to update the info element\r\n        // store them global and assessable for each module\r\n        var currentSystemData = {\r\n            systemData: system.getSystemData(),\r\n            mapId: parseInt( system.attr('data-mapid') )\r\n        };\r\n\r\n        Util.setCurrentSystemData(currentSystemData);\r\n\r\n        $(tabContentElement).trigger('pf:drawSystemModules');\r\n    };\r\n\r\n    /**\r\n     * toggle selectable status of a system\r\n     */\r\n    $.fn.toggleSelectSystem = function(map){\r\n\r\n        return this.each(function(){\r\n            var system = $(this);\r\n\r\n            if( system.data('locked') !== true ){\r\n\r\n                if( system.hasClass( config.systemSelectedClass ) ){\r\n                    system.removeClass( config.systemSelectedClass );\r\n\r\n                    map.removeFromDragSelection(system);\r\n                }else{\r\n                    system.addClass( config.systemSelectedClass );\r\n                    map.addToDragSelection(system);\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * get all selected (NOT active) systems in a map\r\n     * @returns {*}\r\n     */\r\n    $.fn.getSelectedSystems = function(){\r\n        var mapElement = $(this);\r\n        return mapElement.find('.' + config.systemSelectedClass);\r\n    };\r\n\r\n    /**\r\n     * toggle log status of a system\r\n     * @param poke\r\n     * @param options\r\n     */\r\n    $.fn.toggleLockSystem = function(poke, options){\r\n\r\n        var system = $(this);\r\n\r\n        var map = options.map;\r\n\r\n        var hideNotification = false;\r\n        if(options.hideNotification === true){\r\n            hideNotification = true;\r\n        }\r\n\r\n        var hideCounter = false;\r\n        if(options.hideCounter === true){\r\n            hideCounter = true;\r\n        }\r\n\r\n        var systemName = system.getSystemInfo( ['alias'] );\r\n\r\n        if( system.data( 'locked' ) === true ){\r\n            system.data('locked', false);\r\n            system.removeClass( config.systemLockedClass );\r\n\r\n            // enable draggable\r\n            map.setDraggable(system, true);\r\n\r\n            if(! hideNotification){\r\n                Util.showNotify({title: 'System unlocked', text: systemName, type: 'unlock'});\r\n            }\r\n        }else{\r\n            system.data('locked', true);\r\n            system.addClass( config.systemLockedClass );\r\n\r\n            // enable draggable\r\n            map.setDraggable(system, false);\r\n\r\n            if(! hideNotification){\r\n                Util.showNotify({title: 'System locked', text: systemName,  type: 'lock'});\r\n            }\r\n        }\r\n\r\n        // repaint connections\r\n        map.revalidate( system.attr('id') );\r\n\r\n\r\n        if(! hideCounter){\r\n            $(system).getMapOverlay('timer').startMapUpdateCounter();\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n     * set observer for a map container\r\n     * @param map\r\n     */\r\n    var setMapObserver = function(map){\r\n\r\n        // get map container\r\n        var mapContainer = map.getContainer();\r\n\r\n        $(mapContainer).bind('contextmenu', function(e){\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            // make sure map is clicked and NOT a connection\r\n            if($(e.target).hasClass( config.mapClass )){\r\n                var mapElement = $(this);\r\n\r\n                var hideOptions = getHiddenContextMenuOptions(mapElement);\r\n\r\n                var activeOptions = getActiveContextMenuOptions(mapElement);\r\n\r\n                $(e.target).trigger('pf:openContextMenu', [e, mapElement, hideOptions, activeOptions]);\r\n            }\r\n\r\n            return false;\r\n        });\r\n\r\n        $(mapContainer).contextMenu({\r\n            menuSelector: '#' + config.mapContextMenuId,\r\n            menuSelected: function (params) {\r\n\r\n                // click action\r\n                var action = params.selectedMenu.attr('data-action');\r\n\r\n                // current map\r\n                var currentMapElement = $(params.component);\r\n\r\n                var currentMapId = parseInt( currentMapElement.data('id') );\r\n\r\n                // get map instance\r\n               var currentMap = getMapInstance(currentMapId);\r\n\r\n                // click position\r\n                var position = params.position;\r\n\r\n                switch(action){\r\n                    case 'add_system':\r\n                        // add new system dialog\r\n                        showNewSystemDialog(currentMap, {position: position});\r\n                        break;\r\n                    case 'select_all':\r\n\r\n                        var allSystems =  currentMapElement.find('.' + config.systemClass + ':not(.' + config.systemSelectedClass + ')');\r\n\r\n                        // filter non-locked systems\r\n                        allSystems = allSystems.filter(function(i, el){\r\n                            return ( $(el).data('locked') !== true );\r\n                        });\r\n\r\n                        allSystems.toggleSelectSystem(currentMap);\r\n\r\n                        Util.showNotify({title: allSystems.length + ' systems selected', type: 'success'});\r\n                        break;\r\n                    case 'filter_wh':\r\n                    case 'filter_stargate':\r\n                    case 'filter_jumpbridge':\r\n                        // filter (show/hide)\r\n                        var filterScope = action.split('_')[1];\r\n\r\n                        // scope label\r\n                        var filterScopeLabel = MapUtil.getScopeInfoForMap(filterScope, 'label');\r\n\r\n                        var showScope = true;\r\n                        if(\r\n                            currentMapElement.data('filter_scope') &&\r\n                            currentMapElement.data('filter_scope') === filterScope\r\n                        ){\r\n                            // remove scope filter\r\n                            currentMapElement.data('filter_scope', false);\r\n                            showScope = false;\r\n\r\n                            // hide map overlay filter info\r\n                            currentMapElement.getMapOverlay('info').updateOverlayIcon('filter', 'hide');\r\n                        }else{\r\n                            // set scope filter\r\n                            currentMapElement.data('filter_scope', filterScope);\r\n\r\n                            // show map overlay filter info\r\n                            currentMapElement.getMapOverlay('info').updateOverlayIcon('filter', 'show');\r\n                        }\r\n\r\n                        var filteredConnections = currentMap.getAllConnections(filterScope);\r\n\r\n                        for(var i = 0; i < filteredConnections.length; i++){\r\n                            var tempConnection = filteredConnections[i];\r\n\r\n                            var tempEndpoints = tempConnection.endpoints;\r\n                            var setVisible = true;\r\n\r\n                            if(\r\n                                showScope &&\r\n                                tempConnection.scope !== filterScope\r\n                            ){\r\n                                setVisible = false;\r\n                            }\r\n\r\n\r\n                            for(var j = 0; j < tempEndpoints.length; j++){\r\n                                tempEndpoints[j].setVisible( setVisible );\r\n                            }\r\n                        }\r\n\r\n                        Util.showNotify({title: 'Scope filter changed', text: filterScopeLabel, type: 'success'});\r\n\r\n                        break;\r\n                    case 'delete_systems':\r\n                        // delete all selected systems with its connections\r\n                        var selectedSystems = currentMapElement.getSelectedSystems();\r\n                        $.fn.showDeleteSystemDialog(currentMap, selectedSystems);\r\n                        break;\r\n                    case 'info':\r\n                        // open map info dialog\r\n                        $(document).triggerMenuEvent('ShowMapInfo');\r\n                        break;\r\n\r\n                }\r\n            }\r\n        });\r\n\r\n        // init drag-frame selection\r\n        $(mapContainer).dragToSelect({\r\n            selectOnMove: true,\r\n            selectables: '.' + config.systemClass,\r\n            onHide: function (selectBox, deselectedSystems) {\r\n                var selectedSystems = $(mapContainer).getSelectedSystems();\r\n\r\n                if(selectedSystems.length > 0){\r\n                    // make all selected systems draggable\r\n                    Util.showNotify({title: selectedSystems.length + ' systems selected', type: 'success'});\r\n\r\n                    // convert former group draggable systems so single draggable\r\n                    for(var i = 0; i < selectedSystems.length; i++){\r\n                        map.addToDragSelection( selectedSystems[i] );\r\n                    }\r\n                }\r\n\r\n                // convert former group draggable systems so single draggable\r\n                for(var j = 0; j < deselectedSystems.length; j++){\r\n                    map.removeFromDragSelection( deselectedSystems[j] );\r\n                }\r\n            },\r\n            onShow: function(){\r\n                $(document).trigger('pf:closeMenu', [{}]);\r\n            },\r\n            onRefresh: function(){\r\n            }\r\n        });\r\n\r\n        // catch events =========================================================\r\n\r\n        // toggle global map option (e.g. \"grid snap\", \"magnetization\")\r\n        $(mapContainer).on('pf:menuMapOption', function(e, mapOption){\r\n            var mapElement = $(this);\r\n\r\n            // get map menu config options\r\n            var data = MapUtil.mapOptions[mapOption.option];\r\n\r\n            var promiseStore = MapUtil.getLocaleData('map', mapElement.data('id') );\r\n            promiseStore.then(function(dataStore) {\r\n                var notificationText = 'disabled';\r\n                var button = $('#' + this.data.buttonId);\r\n                var dataExists = false;\r\n\r\n                if(\r\n                    dataStore &&\r\n                    dataStore[this.mapOption.option]\r\n                ){\r\n                    dataExists = true;\r\n                }\r\n\r\n                if(dataExists === mapOption.toggle){\r\n\r\n                    // toggle button class\r\n                    button.removeClass('active');\r\n\r\n                    // toggle map class (e.g. for grid)\r\n                    if(this.data.class){\r\n                        this.mapElement.removeClass( MapUtil.config[this.data.class] );\r\n                    }\r\n\r\n                    // call optional jQuery extension on mapElement\r\n                    if(this.data.onDisable){\r\n                        $.fn[ this.data.onDisable ].apply( this.mapElement );\r\n                    }\r\n\r\n                    // show map overlay info icon\r\n                    this.mapElement.getMapOverlay('info').updateOverlayIcon(this.mapOption.option, 'hide');\r\n\r\n                    // delete map option\r\n                    MapUtil.deleteLocalData('map', this.mapElement.data('id'), this.mapOption.option );\r\n                }else{\r\n\r\n                    // toggle button class\r\n                    button.addClass('active');\r\n\r\n                    // toggle map class (e.g. for grid)\r\n                    if(this.data.class){\r\n                        this.mapElement.addClass( MapUtil.config[this.data.class] );\r\n                    }\r\n\r\n                    // call optional jQuery extension on mapElement\r\n                    if(this.data.onEnable){\r\n                        $.fn[ this.data.onEnable ].apply( this.mapElement );\r\n                    }\r\n\r\n                    // hide map overlay info icon\r\n                    this.mapElement.getMapOverlay('info').updateOverlayIcon(this.mapOption.option, 'show');\r\n\r\n                    // store map option\r\n                    MapUtil.storeLocalData('map', this.mapElement.data('id'), this.mapOption.option, 1 );\r\n\r\n                    notificationText = 'enabled';\r\n                }\r\n\r\n                if(mapOption.toggle){\r\n                    Util.showNotify({title: this.data.description, text: notificationText, type: 'info'});\r\n                }\r\n            }.bind({\r\n                mapOption: mapOption,\r\n                data: data,\r\n                mapElement: mapElement\r\n            }));\r\n        });\r\n\r\n        // delete system event\r\n        // triggered from \"map info\" dialog scope\r\n        $(mapContainer).on('pf:deleteSystems', function(e, data){\r\n            System.deleteSystems(map, data.systems, data.callback);\r\n        });\r\n\r\n        $(mapContainer).on('pf:menuSelectSystem', function(e, data){\r\n            var tempMapContainer = $(this);\r\n            var systemId = config.systemIdPrefix + tempMapContainer.data('id') + '-' + data.systemId;\r\n            var system = $(this).find('#' + systemId);\r\n\r\n            if(system.length === 1){\r\n                // scroll to system\r\n                var tempMapWrapper = tempMapContainer.parents('.' + config.mapWrapperClass);\r\n                tempMapWrapper.mCustomScrollbar('scrollTo', system);\r\n\r\n                // select system\r\n                system.showSystemInfo(map);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * get hidden menu entry options for a context menu\r\n     * @param component\r\n     * @returns {Array}\r\n     */\r\n    var getHiddenContextMenuOptions = function(component){\r\n\r\n        var hiddenOptions = [];\r\n\r\n        if(component instanceof jsPlumb.Connection){\r\n            // disable connection menu entries\r\n\r\n            var scope = component.scope;\r\n\r\n            if(scope === 'stargate'){\r\n                hiddenOptions.push('frigate');\r\n                hiddenOptions.push('preserve_mass');\r\n                hiddenOptions.push('change_status');\r\n\r\n                hiddenOptions.push('scope_stargate');\r\n            }else if(scope === 'jumpbridge'){\r\n                hiddenOptions.push('frigate');\r\n                hiddenOptions.push('preserve_mass');\r\n                hiddenOptions.push('change_status');\r\n                hiddenOptions.push('scope_jumpbridge');\r\n            }else if(scope === 'wh'){\r\n                hiddenOptions.push('scope_wh');\r\n            }\r\n\r\n        }else if( component.hasClass(config.systemClass) ){\r\n            // disable system menu entries\r\n            if(component.data('locked') === true){\r\n                hiddenOptions.push('delete_system');\r\n            }\r\n        }\r\n\r\n        return hiddenOptions;\r\n    };\r\n\r\n    /**\r\n     * get active menu entry options for a context menu\r\n     * @param component\r\n     * @returns {Array}\r\n     */\r\n    var getActiveContextMenuOptions = function(component){\r\n\r\n        var activeOptions = [];\r\n\r\n        if(component instanceof jsPlumb.Connection){\r\n            var scope = component.scope;\r\n\r\n            if(component.hasType('wh_eol') === true){\r\n                activeOptions.push('wh_eol');\r\n            }\r\n\r\n            if(component.hasType('frigate') === true){\r\n                activeOptions.push('frigate');\r\n            }\r\n            if(component.hasType('preserve_mass') === true){\r\n                activeOptions.push('preserve_mass');\r\n            }\r\n            if(component.hasType('wh_reduced') === true){\r\n                activeOptions.push('status_reduced');\r\n            }else if(component.hasType('wh_critical') === true){\r\n                activeOptions.push('status_critical');\r\n            }else{\r\n                // not reduced is default\r\n                activeOptions.push('status_fresh');\r\n            }\r\n\r\n        }else if( component.hasClass(config.mapClass) ){\r\n\r\n            // active map menu entries\r\n            if(component.data('filter_scope') === 'wh'){\r\n                activeOptions.push('filter_wh');\r\n            }\r\n            if(component.data('filter_scope') === 'stargate'){\r\n                activeOptions.push('filter_stargate');\r\n            }\r\n            if(component.data('filter_scope') === 'jumpbridge'){\r\n                activeOptions.push('filter_jumpbridge');\r\n            }\r\n        }else if( component.hasClass(config.systemClass) ){\r\n            // active system menu entries\r\n            if(component.data('locked') === true){\r\n                activeOptions.push('lock_system');\r\n            }\r\n            if(component.data('rallyUpdated') > 0){\r\n                activeOptions.push('set_rally');\r\n            }\r\n        }\r\n\r\n        return activeOptions;\r\n    };\r\n\r\n    /**\r\n     * set observer for a given connection\r\n     * @param map\r\n     * @param connection\r\n     */\r\n    var setConnectionObserver = function(map, connection){\r\n\r\n        // get map container\r\n        var mapElement = $( map.getContainer() );\r\n\r\n        // if the connection already exists -> do not set it twice\r\n        connection.unbind('contextmenu').bind('contextmenu', function(component, e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            // trigger menu \"open\r\n\r\n            // get invisible menu entries\r\n            var hideOptions = getHiddenContextMenuOptions(component);\r\n            var activeOptions = getActiveContextMenuOptions(component);\r\n            $(e.target).trigger('pf:openContextMenu', [e, component, hideOptions, activeOptions]);\r\n\r\n            return false;\r\n        });\r\n\r\n        /**\r\n         *  init context menu for all connections\r\n         *  must be triggered manually on demand\r\n         */\r\n        $(connection.canvas).contextMenu({\r\n            menuSelector: '#' + config.connectionContextMenuId,\r\n            menuSelected: function (params){\r\n\r\n                var action = params.selectedMenu.attr('data-action');\r\n                var activeConnection = params.component;\r\n                var activeScope = activeConnection.scope;\r\n                var activeScopeName = MapUtil.getScopeInfoForConnection( activeScope, 'label');\r\n\r\n                switch(action){\r\n                    case 'delete_connection':\r\n                        // delete a single connection\r\n\r\n                        // confirm dialog\r\n                        bootbox.confirm('Is this connection really gone?', function(result) {\r\n                            if(result){\r\n                                $().deleteConnections([activeConnection]);\r\n                            }\r\n                        });\r\n                        break;\r\n                    case 'frigate':         // set as frigate hole\r\n                    case 'preserve_mass':   // set \"preserve mass\r\n                    case 'wh_eol':          // set \"end of life\"\r\n                        mapElement.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n                        activeConnection.toggleType( action );\r\n\r\n                        $(activeConnection).markAsChanged();\r\n                        break;\r\n                    case 'status_fresh':\r\n                    case 'status_reduced':\r\n                    case 'status_critical':\r\n                        var newStatus = action.split('_')[1];\r\n                        mapElement.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n                        MapUtil.setConnectionWHStatus(activeConnection, 'wh_' + newStatus);\r\n                        $(activeConnection).markAsChanged();\r\n                        break;\r\n                    case 'scope_wh':\r\n                    case 'scope_stargate':\r\n                    case 'scope_jumpbridge':\r\n                        var newScope = action.split('_')[1];\r\n                        var newScopeName =  MapUtil.getScopeInfoForConnection( newScope, 'label');\r\n\r\n                        bootbox.confirm('Change scope from ' + activeScopeName + ' to ' + newScopeName + '?', function(result) {\r\n                            if(result){\r\n\r\n                                mapElement.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n                                setConnectionScope(activeConnection, newScope);\r\n\r\n                                Util.showNotify({title: 'Connection scope changed', text: 'New scope: ' + newScopeName, type: 'success'});\r\n\r\n                                $(activeConnection).markAsChanged();\r\n                            }\r\n                        });\r\n                        break;\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * mark a system as active\r\n     * @param map\r\n     * @param system\r\n     */\r\n    var markSystemActive = function(map, system){\r\n\r\n        // deactivate all systems in map\r\n        var mapContainer = $( map.getContainer() );\r\n\r\n        mapContainer.find('.' + config.systemClass).removeClass(config.systemActiveClass);\r\n\r\n        // set current system active\r\n        system.addClass(config.systemActiveClass);\r\n    };\r\n\r\n    /**\r\n     * get system data out of its object\r\n     * @param info\r\n     * @returns {*}\r\n     */\r\n    $.fn.getSystemInfo = function(info){\r\n        var systemInfo = [];\r\n\r\n        for(var i = 0; i < info.length; i++){\r\n            switch(info[i]){\r\n                case 'alias':\r\n                    // get current system alias\r\n                    var systemHeadNameElement = $(this).find('.' + config.systemHeadNameClass);\r\n                    var alias = '';\r\n                    if( systemHeadNameElement.hasClass('editable') ){\r\n                        // xEditable is initiated\r\n                        alias = systemHeadNameElement.editable('getValue', true);\r\n                    }\r\n\r\n                    systemInfo.push(alias );\r\n                    break;\r\n                default:\r\n                    systemInfo.push('bad system query');\r\n            }\r\n\r\n        }\r\n\r\n        if(systemInfo.length === 1){\r\n            return systemInfo[0];\r\n        }else{\r\n            return systemInfo;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * open \"new system\" dialog and add the system to map\r\n     * optional the new system is connected to a \"sourceSystem\" (if available)\r\n     *\r\n     * @param map\r\n     * @param options\r\n     */\r\n    var showNewSystemDialog = function(map, options){\r\n        var mapContainer = $(map.getContainer());\r\n\r\n        // format system status for form select -------------------------------------------------------------\r\n        var systemStatus = {};\r\n        // \"default\" selection (id = 0) prevents status from being overwritten\r\n        // -> e.g. keep status information if system was just inactive (active = 0)\r\n        systemStatus[0] = 'default';\r\n\r\n        $.each(Init.systemStatus, function(status, statusData){\r\n            systemStatus[statusData.id] = statusData.label;\r\n        });\r\n\r\n        // default system status -> first status entry\r\n        var defaultSystemStatus = 0;\r\n\r\n        // get current map data -> disable systems that are already on it -----------------------------------\r\n        var mapData = mapContainer.getMapDataFromClient({forceData: true});\r\n        var mapSystems = mapData.data.systems;\r\n        var mapSystemIds = [];\r\n        for(let i = 0; i < mapSystems.length; i++ ){\r\n            mapSystemIds.push( mapSystems[i].systemId );\r\n        }\r\n\r\n        // dialog data --------------------------------------------------------------------------------------\r\n        var data = {\r\n            id: config.systemDialogId,\r\n            selectClass: config.systemDialogSelectClass\r\n        };\r\n\r\n        // set current position as \"default\" system to add --------------------------------------------------\r\n        var currentCharacterLog = Util.getCurrentCharacterLog();\r\n\r\n        if(\r\n            currentCharacterLog !== false &&\r\n            mapSystemIds.indexOf( currentCharacterLog.system.id ) === -1\r\n        ){\r\n            // current system is NOT already on this map\r\n            // set current position as \"default\" system to add\r\n            data.currentSystem = currentCharacterLog.system;\r\n        }\r\n\r\n        requirejs(['text!templates/dialog/system.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var systemDialog = bootbox.dialog({\r\n                title: 'Add new system',\r\n                message: content,\r\n                buttons: {\r\n                    close: {\r\n                        label: 'cancel',\r\n                        className: 'btn-default'\r\n                    },\r\n                    success: {\r\n                        label: '<i class=\"fa fa-fw fa-check\"></i> save',\r\n                        className: 'btn-success',\r\n                        callback: function (e) {\r\n                            // get form Values\r\n                            var form = $('#' + config.systemDialogId).find('form');\r\n\r\n                            var systemDialogData = $(form).getFormValues();\r\n\r\n                            // validate form\r\n                            form.validator('validate');\r\n\r\n                            // check whether the form is valid\r\n                            var formValid = form.isValidForm();\r\n\r\n                            if(formValid === false){\r\n                                // don't close dialog\r\n                                return false;\r\n                            }\r\n\r\n                            mapContainer.getMapOverlay('timer').startMapUpdateCounter();\r\n\r\n                            // calculate new system position ------------------------------------------------\r\n                            var newPosition = {\r\n                                x: 0,\r\n                                y: 0\r\n                            };\r\n\r\n                            var sourceSystem = null;\r\n\r\n                            // add new position\r\n                            if(options.sourceSystem !== undefined){\r\n\r\n                                sourceSystem = options.sourceSystem;\r\n\r\n                                // get new position\r\n                                newPosition = calculateNewSystemPosition(sourceSystem);\r\n                            }else{\r\n                                // check mouse cursor position (add system to map)\r\n                                newPosition = {\r\n                                    x: options.position.x,\r\n                                    y: options.position.y\r\n                                };\r\n                            }\r\n\r\n                            systemDialogData.position = newPosition;\r\n\r\n                            // ------------------------------------------------------------------------------\r\n\r\n                            var requestData = {\r\n                                systemData: systemDialogData,\r\n                                mapData: {\r\n                                    id: mapContainer.data('id')\r\n                                }\r\n                            };\r\n\r\n                            saveSystem(map, requestData, sourceSystem, function(){\r\n                                bootbox.hideAll();\r\n                            });\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            // init dialog\r\n            systemDialog.on('shown.bs.modal', function(e) {\r\n\r\n                var modalContent = $('#' + config.systemDialogId);\r\n\r\n                // init system select live search  - some delay until modal transition has finished\r\n                var selectElement = modalContent.find('.' + config.systemDialogSelectClass);\r\n                selectElement.delay(240).initSystemSelect({\r\n                    key: 'systemId',\r\n                    disabledOptions: mapSystemIds\r\n                });\r\n            });\r\n\r\n            // init system status select\r\n            var modalFields = $('.bootbox .modal-dialog').find('.pf-editable-system-status');\r\n\r\n            modalFields.editable({\r\n                mode: 'inline',\r\n                emptytext: 'unknown',\r\n                onblur: 'submit',\r\n                showbuttons: false,\r\n                source: systemStatus,\r\n                value: defaultSystemStatus,\r\n                inputclass: config.systemDialogSelectClass\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * save a new system and add it to the map\r\n     * @param map\r\n     * @param requestData\r\n     * @param sourceSystem\r\n     * @param callback\r\n     */\r\n    var saveSystem = function(map, requestData, sourceSystem, callback){\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.saveSystem,\r\n            data: requestData,\r\n            dataType: 'json',\r\n            context: {\r\n                map: map,\r\n                sourceSystem: sourceSystem\r\n            }\r\n        }).done(function(newSystemData){\r\n\r\n            // draw new system to map\r\n            drawSystem(this.map, newSystemData, this.sourceSystem);\r\n\r\n            Util.showNotify({title: 'New system', text: newSystemData.name, type: 'success'});\r\n\r\n            // re/arrange systems (prevent overlapping)\r\n            MagnetizerWrapper.setElements(this.map);\r\n\r\n            if(callback){\r\n                callback();\r\n            }\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            Util.showNotify({title: jqXHR.status + ': saveSystem', text: reason, type: 'warning'});\r\n            $(document).setProgramStatus('problem');\r\n        });\r\n    };\r\n\r\n    /**\r\n     * calculate the x/y coordinates for a new system - relativ to a source system\r\n     * @param sourceSystem\r\n     * @returns {{x: *, y: *}}\r\n     */\r\n    var calculateNewSystemPosition = function(sourceSystem){\r\n\r\n        // related system is available\r\n        var currentX = sourceSystem.css('left');\r\n        var currentY = sourceSystem.css('top');\r\n\r\n        // remove \"px\"\r\n        currentX = parseInt( currentX.substring(0, currentX.length - 2) );\r\n        currentY = parseInt( currentY.substring(0, currentY.length - 2) );\r\n\r\n        var newPosition = {\r\n            x: currentX + config.newSystemOffset.x,\r\n            y: currentY + config.newSystemOffset.y\r\n        };\r\n\r\n        return newPosition;\r\n    };\r\n\r\n    /**\r\n     * updates all systems on map with current user Data (all users on this map)\r\n     * update the Data of the user that is currently viewing the map (if available)\r\n     * @param userData\r\n     * @returns {boolean}\r\n     */\r\n    $.fn.updateUserData = function(userData){\r\n\r\n        var returnStatus = true;\r\n\r\n        // get new map instance or load existing\r\n        var map = getMapInstance(userData.config.id);\r\n\r\n        var mapElement = map.getContainer();\r\n\r\n        // container must exist! otherwise systems can not be updated\r\n        if(mapElement !== undefined){\r\n\r\n            mapElement = $(mapElement);\r\n\r\n            // get current character log data\r\n            var currentCharacterLog = Util.getCurrentCharacterLog();\r\n\r\n            // check if map is frozen\r\n            if(mapElement.data('frozen') === true){\r\n                return returnStatus;\r\n            }\r\n\r\n            // data for header update\r\n            var headerUpdateData = {\r\n                mapId: userData.config.id,\r\n                userCount: 0                        // active user in a map\r\n            };\r\n\r\n            // check if current user was found on the map\r\n            var currentUserOnMap = false;\r\n\r\n            // get all systems\r\n            var systems = mapElement.find('.' + config.systemClass);\r\n\r\n            for(var i = 0; i < systems.length; i++){\r\n                // get user Data for System\r\n\r\n                var system = $( systems[i] );\r\n\r\n                var systemId = $(system).data('systemId');\r\n\r\n                var tempUserData = null;\r\n\r\n                // check if user is currently in \"this\" system\r\n                var currentUserIsHere = false;\r\n\r\n                var j = userData.data.systems.length;\r\n\r\n                // search backwards to avoid decrement the counter after splice()\r\n                while (j--) {\r\n                    var systemData = userData.data.systems[j];\r\n\r\n                    // check if any user is in this system\r\n                    if (systemId === systemData.id) {\r\n                        tempUserData = systemData;\r\n\r\n                        // add  \"user count\" to \"total map user count\"\r\n                        headerUpdateData.userCount += tempUserData.user.length;\r\n\r\n                        // remove system from \"search\" array -> speed up loop\r\n                        userData.data.systems.splice(j, 1);\r\n                    }\r\n                }\r\n\r\n                // the current user can only be in a single system ------------------------------------------\r\n                if( !currentUserOnMap){\r\n\r\n                    if(\r\n                        currentCharacterLog &&\r\n                        currentCharacterLog.system &&\r\n                        currentCharacterLog.system.id === systemId\r\n                    ){\r\n                        currentUserIsHere = true;\r\n                        currentUserOnMap = true;\r\n\r\n                        // set current location data for header update\r\n                        headerUpdateData.currentSystemId =  $(system).data('id');\r\n                        headerUpdateData.currentSystemName = currentCharacterLog.system.name;\r\n                    }\r\n                }\r\n\r\n                system.updateSystemUserData(map, tempUserData, currentUserIsHere);\r\n            }\r\n\r\n            // trigger document event -> update header\r\n            $(document).trigger('pf:updateHeaderMapData', headerUpdateData);\r\n        }\r\n\r\n        return returnStatus;\r\n    };\r\n\r\n    /**\r\n     * collect all map data for export/save for a map\r\n     * this function returns the \"client\" data NOT the \"server\" data for a map\r\n     * @param options\r\n     * @returns {*}\r\n     */\r\n    $.fn.getMapDataFromClient = function(options){\r\n        var mapElement = $(this);\r\n\r\n        var map = getMapInstance( mapElement.data('id') );\r\n\r\n        var mapData = {};\r\n\r\n        // check if there is an active map counter that prevents collecting map data\r\n        var overlay = mapElement.getMapOverlay('timer');\r\n        var counterChart = overlay.getMapCounter();\r\n\r\n        var interval = counterChart.data('interval');\r\n\r\n        if(\r\n            ! interval ||\r\n            options.forceData === true\r\n        ){\r\n\r\n            // map config -----------------------------------------------------------------------------------\r\n            mapData.config = {\r\n                id: parseInt( mapElement.data('id') ),\r\n                name: mapElement.data('name'),\r\n                scope: {\r\n                    id: parseInt( mapElement.data('scopeId') )\r\n                },\r\n                icon: mapElement.data('icon'),\r\n                type: {\r\n                    id: parseInt( mapElement.data('typeId') )\r\n                },\r\n                created: parseInt( mapElement.data('created') ),\r\n                updated: parseInt( mapElement.data('updated') ),\r\n            };\r\n\r\n            // map data -------------------------------------------------------------------------------------\r\n            var data = {};\r\n\r\n            // systems data ---------------------------------------------------------------------------------\r\n            var systemsData = [];\r\n            var systems = mapElement.getSystems();\r\n\r\n            for(var i = 0; i < systems.length; i++){\r\n                var tempSystem = $(systems[i]);\r\n\r\n                // check if system data should be added\r\n                var addSystemData = true;\r\n                if(\r\n                    options.getAll !== true &&\r\n                    options.checkForChange === true &&\r\n                    !tempSystem.hasChanged()\r\n                ){\r\n                    addSystemData = false;\r\n                }\r\n\r\n                if(addSystemData){\r\n                    systemsData.push( tempSystem.getSystemData() );\r\n                }\r\n            }\r\n\r\n            data.systems = systemsData;\r\n\r\n            // connections ----------------------------------------------------------------------------------\r\n            var connections = map.getAllConnections();\r\n            var connectionsFormatted = [];\r\n\r\n            // new connections cache\r\n            var updatedConnectionCache = {};\r\n\r\n            // format connections\r\n            for(var j = 0; j < connections.length; j++){\r\n                var tempConnection = connections[j];\r\n\r\n                // check if connection data should be added\r\n                var addConnectionData = true;\r\n                if(\r\n                    options.getAll !== true &&\r\n                    options.checkForChange === true &&\r\n                    !$(tempConnection).hasChanged()\r\n                ){\r\n                    addConnectionData = false;\r\n                }\r\n\r\n                var connectionData = getDataByConnection(tempConnection);\r\n\r\n                if(addConnectionData){\r\n                    connectionsFormatted.push( connectionData );\r\n                }\r\n\r\n                // add to cache\r\n                updatedConnectionCache[connectionData.id] = tempConnection;\r\n            }\r\n\r\n            // overwrite connection cache\r\n            connectionCache[mapData.config.id] = updatedConnectionCache;\r\n\r\n            data.connections = connectionsFormatted;\r\n\r\n            mapData.data = data;\r\n        }else{\r\n            return false;\r\n        }\r\n\r\n        return mapData;\r\n    };\r\n\r\n    /**\r\n     * get all relevant data for a system object\r\n     * @returns {{}}\r\n     */\r\n    $.fn.getSystemData = function(){\r\n        var system = $(this);\r\n\r\n        var systemData = {};\r\n        systemData.id = parseInt( system.data('id') );\r\n        systemData.systemId = parseInt( system.data('systemId') );\r\n        systemData.name = system.data('name');\r\n        systemData.alias = system.getSystemInfo(['alias']);\r\n        systemData.effect = system.data('effect');\r\n        systemData.type = {\r\n            id: system.data('typeId')\r\n        };\r\n        systemData.security = system.data('security');\r\n        systemData.trueSec = system.data('trueSec');\r\n        systemData.region = {\r\n            id: system.data('regionId'),\r\n            name: system.data('region')\r\n        };\r\n        systemData.constellation = {\r\n            id: system.data('constellationId'),\r\n            name: system.data('constellation')\r\n        };\r\n        systemData.status = {\r\n            id: system.data('statusId')\r\n        };\r\n        systemData.locked = system.data('locked') ? 1 : 0;\r\n        systemData.rallyUpdated = system.data('rallyUpdated') || 0;\r\n        systemData.rallyPoke = system.data('rallyPoke') ? 1 : 0;\r\n        systemData.currentUser = system.data('currentUser'); // if user is currently in this system\r\n        systemData.statics = system.data('statics');\r\n        systemData.updated = {\r\n            updated: parseInt( system.data('updated') )\r\n        };\r\n        systemData.userCount = (system.data('userCount') ? parseInt( system.data('userCount') ) : 0);\r\n\r\n        // position -----------------------------------------------------------------------------------------\r\n        var positionData = {};\r\n        var currentX = system.css('left');\r\n        var currentY = system.css('top');\r\n\r\n        // remove 'px'\r\n        positionData.x = parseInt( currentX.substring(0, currentX.length - 2) );\r\n        positionData.y = parseInt( currentY.substring(0, currentY.length - 2) );\r\n\r\n        systemData.position = positionData;\r\n\r\n        return systemData;\r\n    };\r\n\r\n    /**\r\n     * get all relevant data for a connection object\r\n     * @param connection\r\n     * @returns {{id: Number, source: Number, sourceName: (*|T|JQuery|{}), target: Number, targetName: (*|T|JQuery), scope: *, type: *, updated: Number}}\r\n     */\r\n    var getDataByConnection = function(connection){\r\n\r\n        var source = $(connection.source);\r\n        var target = $(connection.target);\r\n\r\n        var id = connection.getParameter('connectionId');\r\n        var updated = connection.getParameter('updated');\r\n\r\n        var connectionTypes = connection.getType();\r\n\r\n        // normalize connection array\r\n        connectionTypes = $.grep(connectionTypes, function(n){\r\n            // 'default' is added by jsPlumb by default -_-\r\n            return ( n.length > 0 && n !== 'default');\r\n        });\r\n\r\n        var data = {\r\n            id: id ? id : 0,\r\n            source: parseInt( source.data('id') ),\r\n            sourceName: source.data('name'),\r\n            target: parseInt( target.data('id') ),\r\n            targetName: target.data('name'),\r\n            scope: connection.scope,\r\n            type: connectionTypes,\r\n            updated: updated ? updated : 0\r\n        };\r\n\r\n        return data;\r\n    };\r\n\r\n    /**\r\n     * removes a map instance from local cache\r\n     * @param mapId\r\n     */\r\n    var clearMapInstance = function(mapId){\r\n        if(typeof activeInstances[mapId] === 'object'){\r\n            delete activeInstances[mapId];\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get a new jsPlumb map instance or or get a cached one for update\r\n     * @param mapId\r\n     * @returns {*}\r\n     */\r\n    var getMapInstance = function(mapId){\r\n\r\n        if(typeof activeInstances[mapId] !== 'object'){\r\n            // create new instance\r\n            jsPlumb.Defaults.LogEnabled = true;\r\n\r\n            var newJsPlumbInstance =  jsPlumb.getInstance({\r\n                Anchor: 'Continuous',                                               // anchors on each site\r\n                Container: null,                                                    // will be set as soon as container is connected to DOM\r\n                PaintStyle: {\r\n                    lineWidth: 4,                                                   // width of a Connector's line. An integer.\r\n                    strokeStyle: 'red',                                             // color for a Connector\r\n                    outlineColor: 'red',                                            // color of the outline for an Endpoint or Connector. see fillStyle examples.\r\n                    outlineWidth: 2                                                 // width of the outline for an Endpoint or Connector. An integer.\r\n                },\r\n                Connector: [ 'Bezier', { curviness: 40 } ],                         // default connector style (this is not used!) all connections have their own style (by scope)\r\n                Endpoint: [ 'Dot', { radius: 5 } ],\r\n                ReattachConnections: false,                                         // re-attach connection if dragged with mouse to \"nowhere\"\r\n                Scope: Init.defaultMapScope,                                        // default map scope for connections\r\n                LogEnabled: true\r\n            });\r\n\r\n            // register all available connection types ------------------------------------------------------\r\n            newJsPlumbInstance.registerConnectionTypes(globalMapConfig.connectionTypes);\r\n\r\n            // event after a new connection is established --------------------------\r\n            newJsPlumbInstance.bind('connection', function(info, e) {\r\n                // set connection observer\r\n                setConnectionObserver(newJsPlumbInstance, info.connection);\r\n            });\r\n\r\n            // event after connection moved -----------------------------------------------------------------\r\n            newJsPlumbInstance.bind('connectionMoved', function(info, e) {\r\n\r\n            });\r\n\r\n            // event after DragStop a connection or new connection ------------------------------------------\r\n            newJsPlumbInstance.bind('beforeDrop', function(info) {\r\n                var connection = info.connection;\r\n\r\n                // lock the target system for \"click\" events\r\n                // to prevent loading system information\r\n                var sourceSystem = $('#' + info.sourceId);\r\n                var targetSystem = $('#' + info.targetId);\r\n                sourceSystem.addClass('no-click');\r\n                targetSystem.addClass('no-click');\r\n                setTimeout(function(){\r\n                    sourceSystem.removeClass('no-click');\r\n                    targetSystem.removeClass('no-click');\r\n                }, Init.timer.DBL_CLICK + 50);\r\n\r\n                // set \"default\" connection status only for NEW connections\r\n                if(!connection.suspendedElement){\r\n                    MapUtil.setConnectionWHStatus(connection, MapUtil.getDefaultConnectionTypeByScope(connection.scope) );\r\n                }\r\n\r\n                // prevent multiple connections between same systems\r\n                var connections = MapUtil.checkForConnection(newJsPlumbInstance, info.sourceId, info.targetId );\r\n\r\n                if(connections.length > 1){\r\n                    bootbox.confirm('Connection already exists. Do you really want to add an additional one?', function(result) {\r\n                        if(!result){\r\n                            connection._jsPlumb.instance.detach(connection);\r\n                        }\r\n                    });\r\n                }\r\n\r\n                // always save the new connection\r\n                saveConnection(connection);\r\n\r\n                return true;\r\n            });\r\n\r\n            // event before Detach connection ---------------------------------------------------------------\r\n            newJsPlumbInstance.bind('beforeDetach', function(info) {\r\n                return true;\r\n            });\r\n\r\n            newJsPlumbInstance.bind('connectionDetached', function(info, e){\r\n                // a connection is manually (drag&drop) detached! otherwise this event should not be send!\r\n                var connection = info.connection;\r\n                $().deleteConnections([connection]);\r\n            });\r\n\r\n            newJsPlumbInstance.bind('checkDropAllowed', function(params){\r\n                // connections can not be attached to foreign endpoints\r\n                // the only endpoint available is endpoint from where the connection was dragged away (re-attach)\r\n\r\n                return true;\r\n            });\r\n\r\n            activeInstances[mapId] = newJsPlumbInstance;\r\n        }\r\n\r\n        return activeInstances[mapId];\r\n    };\r\n\r\n    /**\r\n     * load OR updates system map\r\n     * @param mapConfig\r\n     * @param options\r\n     */\r\n    $.fn.loadMap = function(mapConfig, options){\r\n\r\n        // parent element where the map will be loaded\r\n        var parentElement = $(this);\r\n\r\n        // add context menus to dom (if not already\r\n        initMapContextMenu();\r\n        initConnectionContextMenu();\r\n        initSystemContextMenu();\r\n\r\n        // new map init\r\n        var newMap = false;\r\n\r\n        // init jsPlumb\r\n        jsPlumb.ready(function() {\r\n            // get new map instance or load existing\r\n            mapConfig.map = getMapInstance(mapConfig.config.id);\r\n\r\n            // check for map Container -> first time initialization\r\n            if(mapConfig.map.getContainer() === undefined){\r\n                // new map instance\r\n                newMap = true;\r\n            }\r\n\r\n            //  draw/update map initial map and set container\r\n            var mapContainer = updateMap(parentElement, mapConfig);\r\n\r\n            if(newMap){\r\n                // init custom scrollbars and add overlay\r\n                parentElement.initMapScrollbar();\r\n\r\n                // show static overlay actions\r\n                var mapElement = mapConfig.map.getContainer();\r\n                var mapOverlay = $(mapElement).getMapOverlay('info');\r\n                mapOverlay.updateOverlayIcon('systemRegion', 'show');\r\n\r\n                mapOverlay.updateOverlayIcon('systemConnectionTimer', 'show');\r\n            }\r\n\r\n            // callback function after tab switch\r\n            function switchTabCallback( mapName, mapContainer ){\r\n                Util.showNotify({title: 'Map initialized', text: mapName  + ' - loaded', type: 'success'});\r\n\r\n                var mapWrapper = mapContainer.parents('.' + config.mapWrapperClass);\r\n\r\n                // auto scroll map to previous position -----------------------------------------------------\r\n                var promiseStore = MapUtil.getLocaleData('map', mapContainer.data('id') );\r\n                promiseStore.then(function(data) {\r\n                    // This code runs once the value has been loaded\r\n                    // from the offline store.\r\n                    if(\r\n                        data &&\r\n                        data.offsetX\r\n                    ){\r\n                        mapWrapper.scrollToX(data.offsetX);\r\n                    }\r\n                });\r\n\r\n                // init magnetizer --------------------------------------------------------------------------\r\n                mapContainer.triggerMenuEvent('MapOption', {\r\n                    option: 'mapMagnetizer',\r\n                    toggle: false\r\n                });\r\n\r\n                // init grid snap ---------------------------------------------------------------------------\r\n                mapContainer.triggerMenuEvent('MapOption', {\r\n                    option: 'mapSnapToGrid',\r\n                    toggle: false\r\n                });\r\n\r\n                return false;\r\n            }\r\n\r\n            if(options.showAnimation){\r\n                // show nice visualization effect\r\n                mapContainer.visualizeMap('show', function(){\r\n                    switchTabCallback( mapConfig.config.name, mapContainer );\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * init scrollbar for Map element\r\n     */\r\n    $.fn.initMapScrollbar = function(){\r\n        // get Map Scrollbar\r\n        var scrollableElement = $(this).find('.' + config.mapWrapperClass);\r\n\r\n        scrollableElement.initCustomScrollbar({\r\n            callbacks: {\r\n                onScroll: function(){\r\n                    // scroll complete\r\n                    var mapElement = $(this).find('.' + config.mapClass);\r\n                    // store new map scrollOffset -> localDB\r\n                    MapUtil.storeLocalData('map', mapElement.data('id'), 'offsetX', Math.abs(this.mcs.left) );\r\n                },\r\n                onScrollStart: function(){\r\n                    // hide all open xEditable fields\r\n                    $(this).find('.editable').editable('hide');\r\n\r\n                    // hide all system head tooltips\r\n                    $(this).find('.' + config.systemHeadClass + ' .fa').tooltip('hide');\r\n                },\r\n                whileScrolling:function(){\r\n                    // update scroll position for drag-frame-selection\r\n                    var mapElement = $(scrollableElement).find('.' + config.mapClass);\r\n                    $(mapElement).data('scrollLeft', this.mcs.left);\r\n                    $(mapElement).data('scrollTop', this.mcs.top);\r\n                }\r\n            }\r\n        });\r\n\r\n        // --------------------------------------------------------------------------------------------------\r\n        // add map overlays after scrollbar is initialized\r\n        // because of its absolute position\r\n        scrollableElement.initMapOverlays();\r\n    };\r\n\r\n    return {\r\n        getMapInstance: getMapInstance,\r\n        clearMapInstance: clearMapInstance,\r\n\r\n        getDataByConnection: getDataByConnection\r\n    };\r\n\r\n});\n",
    "define('app/counter',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util'\r\n], function($, Init, Util) {\r\n    'use strict';\r\n\r\n    var config = {\r\n      counterDigitSmallClass: 'pf-digit-counter-small',\r\n      counterDigitLargeClass: 'pf-digit-counter-large'\r\n    };\r\n\r\n    /**\r\n     * update element with time information\r\n     * @param element\r\n     * @param tempDate\r\n     */\r\n    var updateDateDiff = function(element, tempDate){\r\n        var diff = Util.getTimeDiffParts(tempDate, new Date());\r\n        var days = diff.days;\r\n        var hrs = diff.hours;\r\n        var min = diff.min;\r\n        var leftSec = diff.sec;\r\n        var value = [];\r\n\r\n        if(\r\n            days > 0 ||\r\n            value.length > 0\r\n        ){\r\n            value.push('<span class=\"' + config.counterDigitLargeClass + '\">' + days + 'd' + '</span>');\r\n        }\r\n        if(\r\n            hrs > 0 ||\r\n            value.length > 0\r\n        ){\r\n            value.push('<span class=\"' + config.counterDigitSmallClass + '\">' + hrs + 'h' + '</span>');\r\n        }\r\n        if(\r\n            min > 0 ||\r\n            value.length > 0\r\n        ){\r\n            value.push('<span class=\"' + config.counterDigitSmallClass + '\">' + min + 'm' + '</span>');\r\n        }\r\n\r\n        if(\r\n            leftSec >= 0 ||\r\n            value.length > 0\r\n        ){\r\n            value.push('<span class=\"' + config.counterDigitSmallClass + '\">' + leftSec + 's' + '</span>');\r\n        }\r\n\r\n        element.html(value.join(' '));\r\n    };\r\n\r\n    /**\r\n     * init a live counter based on a unix timestamp\r\n     * @returns {*}\r\n     */\r\n    $.fn.initTimestampCounter = function(){\r\n        return this.each(function(){\r\n            var element = $(this);\r\n            var timestamp = parseInt( element.text() );\r\n\r\n            // do not init twice\r\n            if(timestamp > 0){\r\n                // mark as init\r\n                element.attr('data-counter', 'init');\r\n\r\n                var date = new Date( timestamp * 1000);\r\n\r\n                updateDateDiff(element, date);\r\n\r\n                var refreshIntervalId = window.setInterval(function(){\r\n\r\n                    // update element with current time\r\n                    if( !element.hasClass('stopCounter')){\r\n                        updateDateDiff(element, date);\r\n                    }else{\r\n                        clearInterval( element.data('interval') );\r\n                    }\r\n                }, 500);\r\n\r\n                element.data('interval', refreshIntervalId);\r\n            }\r\n        });\r\n    };\r\n});\r\n\n",
    "/**\r\n *  System info module\r\n */\r\n\r\ndefine('app/ui/system_info',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'app/map/util'\r\n], function($, Init, Util, Render, MapUtil) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // module info\r\n        moduleClass: 'pf-module',                                               // class for each module\r\n\r\n        // system info module\r\n        systemInfoModuleClass: 'pf-system-info-module',                         // module wrapper\r\n\r\n        // breadcrumb\r\n        constellationLinkClass: 'pf-system-info-constellation',                 // class for \"constellation\" name\r\n        regionLinkClass: 'pf-system-info-region',                               // class for \"region\" name\r\n        typeLinkClass: 'pf-system-info-type',                                   // class for \"type\" name\r\n\r\n        // info table\r\n        systemInfoTableClass: 'pf-system-info-table',                           // class for system info table\r\n        systemInfoNameInfoClass: 'pf-system-info-name',                         // class for \"name\" information element\r\n        systemInfoEffectInfoClass: 'pf-system-info-effect',                     // class for \"effect\" information element\r\n        systemInfoStatusLabelClass: 'pf-system-info-status-label',              // class for \"status\" information element\r\n        systemInfoStatusAttributeName: 'data-status',                           // attribute name for status label\r\n        systemInfoWormholeClass: 'pf-system-info-wormhole-',                    // class prefix for static wormhole element\r\n\r\n        // description field\r\n        descriptionArea: 'pf-system-info-description-area',                     // class for \"description\" area\r\n        addDescriptionButtonClass: 'pf-system-info-description-button',         // class for \"add description\" button\r\n        moduleElementToolbarClass: 'pf-table-tools',                            // class for \"module toolbar\" element\r\n        moduleToolbarActionId: 'pf-system-info-collapse-container',             // id for \"module toolbar action\" element\r\n        descriptionTextareaElementClass: 'pf-system-info-description',          // class for \"description\" textarea element (xEditable)\r\n        descriptionTextareaTooltipClass: 'pf-system-info-description-tooltip'   // class for \"description\" tooltip\r\n    };\r\n\r\n    // disable Module update temporary (until. some requests/animations) are finished\r\n    var disableModuleUpdate = true;\r\n\r\n    // animation speed values\r\n    var animationSpeedToolbarAction = 200;\r\n\r\n    /**\r\n     * set module observer and look for relevant system data to update\r\n     */\r\n    var setModuleObserver = function(moduleElement){\r\n        $(document).off('pf:updateSystemInfoModule').on('pf:updateSystemInfoModule', function(e, data){\r\n            if(data){\r\n                moduleElement.updateSystemInfoModule(data);\r\n            }\r\n\r\n        });\r\n    };\r\n\r\n\r\n    /**\r\n     * shows the tool action element by animation\r\n     */\r\n    var showToolsActionElement = function(){\r\n\r\n        // \"toolbar action\" element\r\n        var toolsActionElement = $('#' +  config.moduleToolbarActionId);\r\n\r\n        toolsActionElement.velocity('stop').velocity({\r\n            opacity: 1,\r\n            height: '75px'\r\n        },{\r\n            duration: animationSpeedToolbarAction,\r\n            display: 'block',\r\n            visibility: 'visible'\r\n        });\r\n    };\r\n\r\n    /**\r\n     * hides the tool action element by animation\r\n     */\r\n    var hideToolsActionElement = function(){\r\n\r\n        // \"toolbar action\" element\r\n        var toolsActionElement = $('#' +  config.moduleToolbarActionId);\r\n\r\n        toolsActionElement.velocity('stop').velocity('reverse', {\r\n            display: 'none',\r\n            visibility: 'hidden'\r\n        });\r\n    };\r\n\r\n    /**\r\n     * update trigger function for this module\r\n     * compare data and update module\r\n     * @param systemData\r\n     */\r\n    $.fn.updateSystemInfoModule = function(systemData){\r\n\r\n        // module update is disabled\r\n        if(disableModuleUpdate === true){\r\n            return;\r\n        }\r\n\r\n        var moduleElement = $(this);\r\n\r\n        var systemId = moduleElement.data('id');\r\n\r\n        if(systemId === systemData.id){\r\n            // update module\r\n\r\n            // system status =====================================================================================\r\n            var systemStatusLabelElement = moduleElement.find('.' + config.systemInfoStatusLabelClass);\r\n            var systemStatusId = parseInt( systemStatusLabelElement.attr( config.systemInfoStatusAttributeName ) );\r\n\r\n\r\n            if(systemStatusId !== systemData.status.id){\r\n                // status changed\r\n\r\n                var currentStatusClass = Util.getStatusInfoForSystem(systemStatusId, 'class');\r\n                var newStatusClass = Util.getStatusInfoForSystem(systemData.status.id, 'class');\r\n                var newStatusLabel = Util.getStatusInfoForSystem(systemData.status.id, 'label');\r\n\r\n                systemStatusLabelElement.removeClass(currentStatusClass).addClass(newStatusClass).text(newStatusLabel);\r\n\r\n                // set new status attribute\r\n                systemStatusLabelElement.attr( config.systemInfoStatusAttributeName, systemData.status.id);\r\n            }\r\n\r\n            // description textarea element ======================================================================\r\n            var descriptionTextareaElement =  moduleElement.find('.' + config.descriptionTextareaElementClass);\r\n\r\n            var description = descriptionTextareaElement.editable('getValue', true);\r\n\r\n            if(description !== systemData.description){\r\n                // description changed\r\n\r\n                // description button\r\n                var descriptionButton = moduleElement.find('.' + config.addDescriptionButtonClass);\r\n\r\n                // set new value\r\n                descriptionTextareaElement.editable('setValue', systemData.description);\r\n\r\n                if(systemData.description.length === 0){\r\n                    // show/activate description field\r\n\r\n                    // show button if value is empty\r\n                    descriptionButton.show();\r\n\r\n\r\n                    hideToolsActionElement();\r\n\r\n                }else{\r\n                    // hide/disable description field\r\n\r\n                    // hide tool button\r\n                    descriptionButton.hide();\r\n\r\n                    showToolsActionElement();\r\n                }\r\n            }\r\n\r\n            // created/updated tooltip ===========================================================================\r\n\r\n            var nameRowElement = $(moduleElement).find('.' + config.systemInfoNameInfoClass);\r\n\r\n            var tooltipData = {\r\n                created: systemData.created,\r\n                updated: systemData.updated\r\n            };\r\n\r\n            nameRowElement.addCharacterInfoTooltip( tooltipData );\r\n        }\r\n\r\n        $('.' + config.descriptionArea).hideLoadingAnimation();\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param parentElement\r\n     * @param mapId\r\n     * @param systemData\r\n     */\r\n    var drawModule = function(parentElement, mapId, systemData){\r\n\r\n        // create new module container\r\n        var moduleElement = $('<div>', {\r\n            class: [config.moduleClass, config.systemInfoModuleClass].join(' '),\r\n            css: {opacity: 0}\r\n        });\r\n\r\n        // store systemId -> module can be updated with the correct data\r\n        moduleElement.data('id', systemData.id);\r\n\r\n        parentElement.prepend(moduleElement);\r\n\r\n        // shattered wormhole info data\r\n        var shatteredWormholeInfo = false;\r\n\r\n        // add security class for statics\r\n        if(\r\n            systemData.statics &&\r\n            systemData.statics.length > 0\r\n        ){\r\n            for(var i = 0; i < systemData.statics.length; i++){\r\n                systemData.statics[i].class = Util.getSecurityClassForSystem( systemData.statics[i].security );\r\n            }\r\n        }else if(systemData.type.id === 1){\r\n            // system type \"wormhole\" but no statics => \"shattered wormhole\"\r\n            shatteredWormholeInfo = true;\r\n        }\r\n\r\n        var effectName = MapUtil.getEffectInfoForSystem(systemData.effect, 'name');\r\n        var effectClass = MapUtil.getEffectInfoForSystem(systemData.effect, 'class');\r\n\r\n        // systemInfo template config\r\n        var moduleConfig = {\r\n            name: 'modules/system_info',\r\n            position: moduleElement,\r\n            link: 'append',\r\n            functions: {\r\n                after: function(){\r\n                    // lock \"description\" field until first update\r\n                    $('.' + config.descriptionArea).showLoadingAnimation();\r\n\r\n\r\n                    var tempModuleElement = $('.' + config.systemInfoModuleClass);\r\n\r\n                    // \"add description\" button\r\n                    var descriptionButton = tempModuleElement.find('.' + config.addDescriptionButtonClass);\r\n\r\n                    // description textarea element\r\n                    var descriptionTextareaElement =  tempModuleElement.find('.' + config.descriptionTextareaElementClass);\r\n\r\n                    // init description textarea\r\n                    descriptionTextareaElement.editable({\r\n                        url: Init.path.saveSystem,\r\n                        dataType: 'json',\r\n                        pk: systemData.id,\r\n                        type: 'textarea',\r\n                        mode: 'inline',\r\n                        emptytext: '',\r\n                        onblur: 'cancel',\r\n                        showbuttons: true,\r\n                        value: '',  // value is set by trigger function updateSystemInfoModule()\r\n                        rows: 5,\r\n                        name: 'description',\r\n                        inputclass: config.descriptionTextareaElementClass,\r\n                        params: function(params){\r\n\r\n                            params.mapData = {\r\n                                id: mapId\r\n                            };\r\n\r\n                            params.systemData = {};\r\n                            params.systemData.id = params.pk;\r\n                            params.systemData[params.name] = params.value;\r\n\r\n                            // clear unnecessary data\r\n                            delete params.pk;\r\n                            delete params.name;\r\n                            delete params.value;\r\n\r\n                            return params;\r\n                        },\r\n                        validate: function(value){\r\n                            if(value.length > 0 && $.trim(value).length === 0) {\r\n                                return {newValue: ''};\r\n                            }\r\n                        },\r\n                        success: function(response, newValue){\r\n                            Util.showNotify({title: 'System updated', text: 'Name: ' + response.name, type: 'success'});\r\n                        },\r\n                        error: function(jqXHR, newValue){\r\n\r\n                            var reason = '';\r\n                            var status = '';\r\n                            if(jqXHR.name){\r\n                                // save error new sig (mass save)\r\n                                reason = jqXHR.name;\r\n                                status = 'Error';\r\n                            }else{\r\n                                reason = jqXHR.responseJSON.text;\r\n                                status = jqXHR.status;\r\n                            }\r\n\r\n                            Util.showNotify({title: status + ': save system information', text: reason, type: 'warning'});\r\n                            $(document).setProgramStatus('problem');\r\n                            return reason;\r\n                        }\r\n                    });\r\n\r\n                    // on xEditable open -------------------------------------------------------------------------\r\n                    descriptionTextareaElement.on('shown', function(e){\r\n                        // disable module update until description field is open\r\n                        disableModuleUpdate = true;\r\n\r\n                        // disable tooltip\r\n                        tempModuleElement.find('.' + config.descriptionTextareaTooltipClass).tooltip('disable');\r\n                    });\r\n\r\n                    // on xEditable close ------------------------------------------------------------------------\r\n                    descriptionTextareaElement.on('hidden', function(e){\r\n                        var value = $(this).editable('getValue', true);\r\n\r\n                        if(value.length === 0){\r\n\r\n                            // show button if value is empty\r\n                            hideToolsActionElement();\r\n\r\n                            descriptionButton.show();\r\n                        }else{\r\n                            // enable tooltip\r\n                            tempModuleElement.find('.' + config.descriptionTextareaTooltipClass).tooltip('enable');\r\n                        }\r\n\r\n                        // enable module update\r\n                        disableModuleUpdate = false;\r\n                    });\r\n\r\n                    // enable xEditable field on Button click ----------------------------------------------------\r\n                    descriptionButton.on('click', function(e){\r\n                        e.stopPropagation();\r\n\r\n                        // hide tool buttons\r\n                        descriptionButton.hide();\r\n\r\n                        // show field *before* showing the element\r\n                        descriptionTextareaElement.editable('show');\r\n\r\n                        showToolsActionElement();\r\n                    });\r\n\r\n\r\n                    // init tooltips -----------------------------------------------------------------------------\r\n                    var tooltipElements = $('.' + config.systemInfoModuleClass + ' [data-toggle=\"tooltip\"]');\r\n                    tooltipElements.tooltip();\r\n\r\n                    // init system effect popover ----------------------------------------------------------------\r\n                    var systemEffectData = Util.getSystemEffectData( systemData.security, systemData.effect);\r\n\r\n                    if(systemEffectData !== false){\r\n                        var infoEffectElement = $(moduleElement).find('.' + config.systemInfoEffectInfoClass);\r\n\r\n                        // transform data into table\r\n                        var systemEffectTable = Util.getSystemEffectTable( systemEffectData );\r\n\r\n                        infoEffectElement.popover({\r\n                            html: true,\r\n                            trigger: 'hover',\r\n                            placement: 'top',\r\n                            delay: 200,\r\n                            title: 'System effects',\r\n                            container: 'body',\r\n                            content: systemEffectTable\r\n                        });\r\n                    }\r\n\r\n                    // init static wormhole information ----------------------------------------------------------\r\n                    if(systemData.statics){\r\n                        for(var i = 0; i < systemData.statics.length; i++){\r\n                            var staticData = systemData.statics[i];\r\n                            var staticRowElement = tempModuleElement.find('.' + config.systemInfoWormholeClass + staticData.name);\r\n                            staticRowElement.addWormholeInfoTooltip(staticData);\r\n                        }\r\n                    }\r\n\r\n                    // constellation popover ---------------------------------------------------------------------\r\n                    tempModuleElement.find('a.popup-ajax').popover({\r\n                        html: true,\r\n                        trigger: 'hover',\r\n                        placement: 'top',\r\n                        delay: 200,\r\n                        container: 'body',\r\n                        content: function(){\r\n                            return details_in_popup(this);\r\n                        }\r\n                    });\r\n\r\n                    function details_in_popup(popoverElement){\r\n                        popoverElement = $(popoverElement);\r\n                        var popover = popoverElement.data('bs.popover');\r\n\r\n\r\n                        $.ajax({\r\n                            url: popoverElement.data('url'),\r\n                            success: function(data){\r\n                                var systemEffectTable = Util.getSystemsInfoTable( data.systemData );\r\n                                popover.options.content = systemEffectTable;\r\n                                // reopen popover (new content size)\r\n                                popover.show();\r\n                            }\r\n                        });\r\n                        return 'Loading...';\r\n                    }\r\n\r\n                    showModule(moduleElement);\r\n                }\r\n            }\r\n        };\r\n\r\n        var moduleData = {\r\n            system: systemData,\r\n            tableClass: config.systemInfoTableClass,\r\n            nameInfoClass: config.systemInfoNameInfoClass,\r\n            effectInfoClass: config.systemInfoEffectInfoClass,\r\n            wormholePrefixClass: config.systemInfoWormholeClass,\r\n            statusInfoClass: config.systemInfoStatusLabelClass,\r\n\r\n            systemTypeName: MapUtil.getSystemTypeInfo(systemData.type.id, 'name'),\r\n            systemStatusId: systemData.status.id,\r\n            systemStatusClass: Util.getStatusInfoForSystem(systemData.status.id, 'class'),\r\n            systemStatusLabel: Util.getStatusInfoForSystem(systemData.status.id, 'label'),\r\n            securityClass: Util.getSecurityClassForSystem( systemData.security ),\r\n            trueSec: systemData.trueSec.toFixed(1),\r\n            trueSecClass: Util.getTrueSecClassForSystem( systemData.trueSec ),\r\n            effectName: effectName,\r\n            effectClass: effectClass,\r\n            moduleToolbarClass: config.moduleElementToolbarClass,\r\n            descriptionButtonClass: config.addDescriptionButtonClass,\r\n            moduleToolbarActionId: config.moduleToolbarActionId,\r\n            descriptionTextareaClass: config.descriptionTextareaElementClass,\r\n            descriptionTooltipClass: config.descriptionTextareaTooltipClass,\r\n\r\n            shatteredWormholeInfo: shatteredWormholeInfo,\r\n\r\n            ajaxConstellationInfoUrl: Init.path.getConstellationData,\r\n\r\n            systemConstellationLinkClass: config.constellationLinkClass,\r\n            systemRegionLinkClass: config.regionLinkClass,\r\n            systemTypeLinkClass: config.typeLinkClass\r\n\r\n        };\r\n\r\n        Render.showModule(moduleConfig, moduleData);\r\n    };\r\n\r\n    /**\r\n     * show system info module with animation\r\n     * @param moduleElement\r\n     */\r\n    var showModule = function(moduleElement){\r\n        moduleElement.velocity('transition.slideDownIn', {\r\n            duration: Init.animationSpeed.mapModule,\r\n            delay: Init.animationSpeed.mapModule,\r\n            complete: function(){\r\n                // set module observer\r\n                setModuleObserver(moduleElement);\r\n\r\n                // enable auto update\r\n                disableModuleUpdate = false;\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * update system info module\r\n     * @param mapId\r\n     * @param systemData\r\n     */\r\n    $.fn.drawSystemInfoModule = function(mapId, systemData){\r\n\r\n        var parentElement = $(this);\r\n\r\n        // check if module already exists\r\n        var moduleElement = parentElement.find('.' + config.systemInfoModuleClass);\r\n\r\n        if(moduleElement.length > 0){\r\n            moduleElement.velocity('transition.slideDownOut', {\r\n                duration: Init.animationSpeed.mapModule,\r\n                complete: function(tempElement){\r\n                    $(tempElement).remove();\r\n\r\n                    drawModule(parentElement, mapId, systemData);\r\n                }\r\n            });\r\n        }else{\r\n            drawModule(parentElement, mapId, systemData);\r\n        }\r\n    };\r\n\r\n});\r\n\r\n\r\n\r\n\n",
    "// ┌────────────────────────────────────────────────────────────────────┐ \\\\\r\n// │ Raphaël 2.1.2 - JavaScript Vector Library                          │ \\\\\r\n// ├────────────────────────────────────────────────────────────────────┤ \\\\\r\n// │ Copyright © 2008-2012 Dmitry Baranovskiy (http://raphaeljs.com)    │ \\\\\r\n// │ Copyright © 2008-2012 Sencha Labs (http://sencha.com)              │ \\\\\r\n// ├────────────────────────────────────────────────────────────────────┤ \\\\\r\n// │ Licensed under the MIT (http://raphaeljs.com/license.html) license.│ \\\\\r\n// └────────────────────────────────────────────────────────────────────┘ \\\\\r\n!function(a){var b,c,d=\"0.4.2\",e=\"hasOwnProperty\",f=/[\\.\\/]/,g=\"*\",h=function(){},i=function(a,b){return a-b},j={n:{}},k=function(a,d){a=String(a);var e,f=c,g=Array.prototype.slice.call(arguments,2),h=k.listeners(a),j=0,l=[],m={},n=[],o=b;b=a,c=0;for(var p=0,q=h.length;q>p;p++)\"zIndex\"in h[p]&&(l.push(h[p].zIndex),h[p].zIndex<0&&(m[h[p].zIndex]=h[p]));for(l.sort(i);l[j]<0;)if(e=m[l[j++]],n.push(e.apply(d,g)),c)return c=f,n;for(p=0;q>p;p++)if(e=h[p],\"zIndex\"in e)if(e.zIndex==l[j]){if(n.push(e.apply(d,g)),c)break;do if(j++,e=m[l[j]],e&&n.push(e.apply(d,g)),c)break;while(e)}else m[e.zIndex]=e;else if(n.push(e.apply(d,g)),c)break;return c=f,b=o,n.length?n:null};k._events=j,k.listeners=function(a){var b,c,d,e,h,i,k,l,m=a.split(f),n=j,o=[n],p=[];for(e=0,h=m.length;h>e;e++){for(l=[],i=0,k=o.length;k>i;i++)for(n=o[i].n,c=[n[m[e]],n[g]],d=2;d--;)b=c[d],b&&(l.push(b),p=p.concat(b.f||[]));o=l}return p},k.on=function(a,b){if(a=String(a),\"function\"!=typeof b)return function(){};for(var c=a.split(f),d=j,e=0,g=c.length;g>e;e++)d=d.n,d=d.hasOwnProperty(c[e])&&d[c[e]]||(d[c[e]]={n:{}});for(d.f=d.f||[],e=0,g=d.f.length;g>e;e++)if(d.f[e]==b)return h;return d.f.push(b),function(a){+a==+a&&(b.zIndex=+a)}},k.f=function(a){var b=[].slice.call(arguments,1);return function(){k.apply(null,[a,null].concat(b).concat([].slice.call(arguments,0)))}},k.stop=function(){c=1},k.nt=function(a){return a?new RegExp(\"(?:\\\\.|\\\\/|^)\"+a+\"(?:\\\\.|\\\\/|$)\").test(b):b},k.nts=function(){return b.split(f)},k.off=k.unbind=function(a,b){if(!a)return void(k._events=j={n:{}});var c,d,h,i,l,m,n,o=a.split(f),p=[j];for(i=0,l=o.length;l>i;i++)for(m=0;m<p.length;m+=h.length-2){if(h=[m,1],c=p[m].n,o[i]!=g)c[o[i]]&&h.push(c[o[i]]);else for(d in c)c[e](d)&&h.push(c[d]);p.splice.apply(p,h)}for(i=0,l=p.length;l>i;i++)for(c=p[i];c.n;){if(b){if(c.f){for(m=0,n=c.f.length;n>m;m++)if(c.f[m]==b){c.f.splice(m,1);break}!c.f.length&&delete c.f}for(d in c.n)if(c.n[e](d)&&c.n[d].f){var q=c.n[d].f;for(m=0,n=q.length;n>m;m++)if(q[m]==b){q.splice(m,1);break}!q.length&&delete c.n[d].f}}else{delete c.f;for(d in c.n)c.n[e](d)&&c.n[d].f&&delete c.n[d].f}c=c.n}},k.once=function(a,b){var c=function(){return k.unbind(a,c),b.apply(this,arguments)};return k.on(a,c)},k.version=d,k.toString=function(){return\"You are running Eve \"+d},\"undefined\"!=typeof module&&module.exports?module.exports=k:\"undefined\"!=typeof define?define(\"eve\",[],function(){return k}):a.eve=k}(window||this),function(a,b){\"function\"==typeof define&&define.amd?define('raphael',[\"eve\"],function(c){return b(a,c)}):b(a,a.eve)}(this,function(a,b){function c(a){if(c.is(a,\"function\"))return u?a():b.on(\"raphael.DOMload\",a);if(c.is(a,V))return c._engine.create[D](c,a.splice(0,3+c.is(a[0],T))).add(a);var d=Array.prototype.slice.call(arguments,0);if(c.is(d[d.length-1],\"function\")){var e=d.pop();return u?e.call(c._engine.create[D](c,d)):b.on(\"raphael.DOMload\",function(){e.call(c._engine.create[D](c,d))})}return c._engine.create[D](c,arguments)}function d(a){if(\"function\"==typeof a||Object(a)!==a)return a;var b=new a.constructor;for(var c in a)a[z](c)&&(b[c]=d(a[c]));return b}function e(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}function f(a,b,c){function d(){var f=Array.prototype.slice.call(arguments,0),g=f.join(\"␀\"),h=d.cache=d.cache||{},i=d.count=d.count||[];return h[z](g)?(e(i,g),c?c(h[g]):h[g]):(i.length>=1e3&&delete h[i.shift()],i.push(g),h[g]=a[D](b,f),c?c(h[g]):h[g])}return d}function g(){return this.hex}function h(a,b){for(var c=[],d=0,e=a.length;e-2*!b>d;d+=2){var f=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?e-4==d?f[3]={x:+a[0],y:+a[1]}:e-2==d&&(f[2]={x:+a[0],y:+a[1]},f[3]={x:+a[2],y:+a[3]}):f[0]={x:+a[e-2],y:+a[e-1]}:e-4==d?f[3]=f[2]:d||(f[0]={x:+a[d],y:+a[d+1]}),c.push([\"C\",(-f[0].x+6*f[1].x+f[2].x)/6,(-f[0].y+6*f[1].y+f[2].y)/6,(f[1].x+6*f[2].x-f[3].x)/6,(f[1].y+6*f[2].y-f[3].y)/6,f[2].x,f[2].y])}return c}function i(a,b,c,d,e){var f=-3*b+9*c-9*d+3*e,g=a*f+6*b-12*c+6*d;return a*g-3*b+3*c}function j(a,b,c,d,e,f,g,h,j){null==j&&(j=1),j=j>1?1:0>j?0:j;for(var k=j/2,l=12,m=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],n=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],o=0,p=0;l>p;p++){var q=k*m[p]+k,r=i(q,a,c,e,g),s=i(q,b,d,f,h),t=r*r+s*s;o+=n[p]*N.sqrt(t)}return k*o}function k(a,b,c,d,e,f,g,h,i){if(!(0>i||j(a,b,c,d,e,f,g,h)<i)){var k,l=1,m=l/2,n=l-m,o=.01;for(k=j(a,b,c,d,e,f,g,h,n);Q(k-i)>o;)m/=2,n+=(i>k?1:-1)*m,k=j(a,b,c,d,e,f,g,h,n);return n}}function l(a,b,c,d,e,f,g,h){if(!(O(a,c)<P(e,g)||P(a,c)>O(e,g)||O(b,d)<P(f,h)||P(b,d)>O(f,h))){var i=(a*d-b*c)*(e-g)-(a-c)*(e*h-f*g),j=(a*d-b*c)*(f-h)-(b-d)*(e*h-f*g),k=(a-c)*(f-h)-(b-d)*(e-g);if(k){var l=i/k,m=j/k,n=+l.toFixed(2),o=+m.toFixed(2);if(!(n<+P(a,c).toFixed(2)||n>+O(a,c).toFixed(2)||n<+P(e,g).toFixed(2)||n>+O(e,g).toFixed(2)||o<+P(b,d).toFixed(2)||o>+O(b,d).toFixed(2)||o<+P(f,h).toFixed(2)||o>+O(f,h).toFixed(2)))return{x:l,y:m}}}}function m(a,b,d){var e=c.bezierBBox(a),f=c.bezierBBox(b);if(!c.isBBoxIntersect(e,f))return d?0:[];for(var g=j.apply(0,a),h=j.apply(0,b),i=O(~~(g/5),1),k=O(~~(h/5),1),m=[],n=[],o={},p=d?0:[],q=0;i+1>q;q++){var r=c.findDotsAtSegment.apply(c,a.concat(q/i));m.push({x:r.x,y:r.y,t:q/i})}for(q=0;k+1>q;q++)r=c.findDotsAtSegment.apply(c,b.concat(q/k)),n.push({x:r.x,y:r.y,t:q/k});for(q=0;i>q;q++)for(var s=0;k>s;s++){var t=m[q],u=m[q+1],v=n[s],w=n[s+1],x=Q(u.x-t.x)<.001?\"y\":\"x\",y=Q(w.x-v.x)<.001?\"y\":\"x\",z=l(t.x,t.y,u.x,u.y,v.x,v.y,w.x,w.y);if(z){if(o[z.x.toFixed(4)]==z.y.toFixed(4))continue;o[z.x.toFixed(4)]=z.y.toFixed(4);var A=t.t+Q((z[x]-t[x])/(u[x]-t[x]))*(u.t-t.t),B=v.t+Q((z[y]-v[y])/(w[y]-v[y]))*(w.t-v.t);A>=0&&1.001>=A&&B>=0&&1.001>=B&&(d?p++:p.push({x:z.x,y:z.y,t1:P(A,1),t2:P(B,1)}))}}return p}function n(a,b,d){a=c._path2curve(a),b=c._path2curve(b);for(var e,f,g,h,i,j,k,l,n,o,p=d?0:[],q=0,r=a.length;r>q;q++){var s=a[q];if(\"M\"==s[0])e=i=s[1],f=j=s[2];else{\"C\"==s[0]?(n=[e,f].concat(s.slice(1)),e=n[6],f=n[7]):(n=[e,f,e,f,i,j,i,j],e=i,f=j);for(var t=0,u=b.length;u>t;t++){var v=b[t];if(\"M\"==v[0])g=k=v[1],h=l=v[2];else{\"C\"==v[0]?(o=[g,h].concat(v.slice(1)),g=o[6],h=o[7]):(o=[g,h,g,h,k,l,k,l],g=k,h=l);var w=m(n,o,d);if(d)p+=w;else{for(var x=0,y=w.length;y>x;x++)w[x].segment1=q,w[x].segment2=t,w[x].bez1=n,w[x].bez2=o;p=p.concat(w)}}}}}return p}function o(a,b,c,d,e,f){null!=a?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+e,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function p(){return this.x+H+this.y+H+this.width+\" × \"+this.height}function q(a,b,c,d,e,f){function g(a){return((l*a+k)*a+j)*a}function h(a,b){var c=i(a,b);return((o*c+n)*c+m)*c}function i(a,b){var c,d,e,f,h,i;for(e=a,i=0;8>i;i++){if(f=g(e)-a,Q(f)<b)return e;if(h=(3*l*e+2*k)*e+j,Q(h)<1e-6)break;e-=f/h}if(c=0,d=1,e=a,c>e)return c;if(e>d)return d;for(;d>c;){if(f=g(e),Q(f-a)<b)return e;a>f?c=e:d=e,e=(d-c)/2+c}return e}var j=3*b,k=3*(d-b)-j,l=1-j-k,m=3*c,n=3*(e-c)-m,o=1-m-n;return h(a,1/(200*f))}function r(a,b){var c=[],d={};if(this.ms=b,this.times=1,a){for(var e in a)a[z](e)&&(d[_(e)]=a[e],c.push(_(e)));c.sort(lb)}this.anim=d,this.top=c[c.length-1],this.percents=c}function s(a,d,e,f,g,h){e=_(e);var i,j,k,l,m,n,p=a.ms,r={},s={},t={};if(f)for(v=0,x=ic.length;x>v;v++){var u=ic[v];if(u.el.id==d.id&&u.anim==a){u.percent!=e?(ic.splice(v,1),k=1):j=u,d.attr(u.totalOrigin);break}}else f=+s;for(var v=0,x=a.percents.length;x>v;v++){if(a.percents[v]==e||a.percents[v]>f*a.top){e=a.percents[v],m=a.percents[v-1]||0,p=p/a.top*(e-m),l=a.percents[v+1],i=a.anim[e];break}f&&d.attr(a.anim[a.percents[v]])}if(i){if(j)j.initstatus=f,j.start=new Date-j.ms*f;else{for(var y in i)if(i[z](y)&&(db[z](y)||d.paper.customAttributes[z](y)))switch(r[y]=d.attr(y),null==r[y]&&(r[y]=cb[y]),s[y]=i[y],db[y]){case T:t[y]=(s[y]-r[y])/p;break;case\"colour\":r[y]=c.getRGB(r[y]);var A=c.getRGB(s[y]);t[y]={r:(A.r-r[y].r)/p,g:(A.g-r[y].g)/p,b:(A.b-r[y].b)/p};break;case\"path\":var B=Kb(r[y],s[y]),C=B[1];for(r[y]=B[0],t[y]=[],v=0,x=r[y].length;x>v;v++){t[y][v]=[0];for(var D=1,F=r[y][v].length;F>D;D++)t[y][v][D]=(C[v][D]-r[y][v][D])/p}break;case\"transform\":var G=d._,H=Pb(G[y],s[y]);if(H)for(r[y]=H.from,s[y]=H.to,t[y]=[],t[y].real=!0,v=0,x=r[y].length;x>v;v++)for(t[y][v]=[r[y][v][0]],D=1,F=r[y][v].length;F>D;D++)t[y][v][D]=(s[y][v][D]-r[y][v][D])/p;else{var K=d.matrix||new o,L={_:{transform:G.transform},getBBox:function(){return d.getBBox(1)}};r[y]=[K.a,K.b,K.c,K.d,K.e,K.f],Nb(L,s[y]),s[y]=L._.transform,t[y]=[(L.matrix.a-K.a)/p,(L.matrix.b-K.b)/p,(L.matrix.c-K.c)/p,(L.matrix.d-K.d)/p,(L.matrix.e-K.e)/p,(L.matrix.f-K.f)/p]}break;case\"csv\":var M=I(i[y])[J](w),N=I(r[y])[J](w);if(\"clip-rect\"==y)for(r[y]=N,t[y]=[],v=N.length;v--;)t[y][v]=(M[v]-r[y][v])/p;s[y]=M;break;default:for(M=[][E](i[y]),N=[][E](r[y]),t[y]=[],v=d.paper.customAttributes[y].length;v--;)t[y][v]=((M[v]||0)-(N[v]||0))/p}var O=i.easing,P=c.easing_formulas[O];if(!P)if(P=I(O).match(Z),P&&5==P.length){var Q=P;P=function(a){return q(a,+Q[1],+Q[2],+Q[3],+Q[4],p)}}else P=nb;if(n=i.start||a.start||+new Date,u={anim:a,percent:e,timestamp:n,start:n+(a.del||0),status:0,initstatus:f||0,stop:!1,ms:p,easing:P,from:r,diff:t,to:s,el:d,callback:i.callback,prev:m,next:l,repeat:h||a.times,origin:d.attr(),totalOrigin:g},ic.push(u),f&&!j&&!k&&(u.stop=!0,u.start=new Date-p*f,1==ic.length))return kc();k&&(u.start=new Date-u.ms*f),1==ic.length&&jc(kc)}b(\"raphael.anim.start.\"+d.id,d,a)}}function t(a){for(var b=0;b<ic.length;b++)ic[b].el.paper==a&&ic.splice(b--,1)}c.version=\"2.1.2\",c.eve=b;var u,v,w=/[, ]+/,x={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},y=/\\{(\\d+)\\}/g,z=\"hasOwnProperty\",A={doc:document,win:a},B={was:Object.prototype[z].call(A.win,\"Raphael\"),is:A.win.Raphael},C=function(){this.ca=this.customAttributes={}},D=\"apply\",E=\"concat\",F=\"ontouchstart\"in A.win||A.win.DocumentTouch&&A.doc instanceof DocumentTouch,G=\"\",H=\" \",I=String,J=\"split\",K=\"click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel\"[J](H),L={mousedown:\"touchstart\",mousemove:\"touchmove\",mouseup:\"touchend\"},M=I.prototype.toLowerCase,N=Math,O=N.max,P=N.min,Q=N.abs,R=N.pow,S=N.PI,T=\"number\",U=\"string\",V=\"array\",W=Object.prototype.toString,X=(c._ISURL=/^url\\(['\"]?([^\\)]+?)['\"]?\\)$/i,/^\\s*((#[a-f\\d]{6})|(#[a-f\\d]{3})|rgba?\\(\\s*([\\d\\.]+%?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+%?(?:\\s*,\\s*[\\d\\.]+%?)?)\\s*\\)|hsba?\\(\\s*([\\d\\.]+(?:deg|\\xb0|%)?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+(?:%?\\s*,\\s*[\\d\\.]+)?)%?\\s*\\)|hsla?\\(\\s*([\\d\\.]+(?:deg|\\xb0|%)?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+(?:%?\\s*,\\s*[\\d\\.]+)?)%?\\s*\\))\\s*$/i),Y={NaN:1,Infinity:1,\"-Infinity\":1},Z=/^(?:cubic-)?bezier\\(([^,]+),([^,]+),([^,]+),([^\\)]+)\\)/,$=N.round,_=parseFloat,ab=parseInt,bb=I.prototype.toUpperCase,cb=c._availableAttrs={\"arrow-end\":\"none\",\"arrow-start\":\"none\",blur:0,\"clip-rect\":\"0 0 1e9 1e9\",cursor:\"default\",cx:0,cy:0,fill:\"#fff\",\"fill-opacity\":1,font:'10px \"Arial\"',\"font-family\":'\"Arial\"',\"font-size\":\"10\",\"font-style\":\"normal\",\"font-weight\":400,gradient:0,height:0,href:\"http://raphaeljs.com/\",\"letter-spacing\":0,opacity:1,path:\"M0,0\",r:0,rx:0,ry:0,src:\"\",stroke:\"#000\",\"stroke-dasharray\":\"\",\"stroke-linecap\":\"butt\",\"stroke-linejoin\":\"butt\",\"stroke-miterlimit\":0,\"stroke-opacity\":1,\"stroke-width\":1,target:\"_blank\",\"text-anchor\":\"middle\",title:\"Raphael\",transform:\"\",width:0,x:0,y:0},db=c._availableAnimAttrs={blur:T,\"clip-rect\":\"csv\",cx:T,cy:T,fill:\"colour\",\"fill-opacity\":T,\"font-size\":T,height:T,opacity:T,path:\"path\",r:T,rx:T,ry:T,stroke:\"colour\",\"stroke-opacity\":T,\"stroke-width\":T,transform:\"transform\",width:T,x:T,y:T},eb=/[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*/,fb={hs:1,rg:1},gb=/,?([achlmqrstvxz]),?/gi,hb=/([achlmrqstvz])[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029,]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*)+)/gi,ib=/([rstm])[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029,]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*)+)/gi,jb=/(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*/gi,kb=(c._radial_gradient=/^r(?:\\(([^,]+?)[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*([^\\)]+?)\\))?/,{}),lb=function(a,b){return _(a)-_(b)},mb=function(){},nb=function(a){return a},ob=c._rectPath=function(a,b,c,d,e){return e?[[\"M\",a+e,b],[\"l\",c-2*e,0],[\"a\",e,e,0,0,1,e,e],[\"l\",0,d-2*e],[\"a\",e,e,0,0,1,-e,e],[\"l\",2*e-c,0],[\"a\",e,e,0,0,1,-e,-e],[\"l\",0,2*e-d],[\"a\",e,e,0,0,1,e,-e],[\"z\"]]:[[\"M\",a,b],[\"l\",c,0],[\"l\",0,d],[\"l\",-c,0],[\"z\"]]},pb=function(a,b,c,d){return null==d&&(d=c),[[\"M\",a,b],[\"m\",0,-d],[\"a\",c,d,0,1,1,0,2*d],[\"a\",c,d,0,1,1,0,-2*d],[\"z\"]]},qb=c._getPath={path:function(a){return a.attr(\"path\")},circle:function(a){var b=a.attrs;return pb(b.cx,b.cy,b.r)},ellipse:function(a){var b=a.attrs;return pb(b.cx,b.cy,b.rx,b.ry)},rect:function(a){var b=a.attrs;return ob(b.x,b.y,b.width,b.height,b.r)},image:function(a){var b=a.attrs;return ob(b.x,b.y,b.width,b.height)},text:function(a){var b=a._getBBox();return ob(b.x,b.y,b.width,b.height)},set:function(a){var b=a._getBBox();return ob(b.x,b.y,b.width,b.height)}},rb=c.mapPath=function(a,b){if(!b)return a;var c,d,e,f,g,h,i;for(a=Kb(a),e=0,g=a.length;g>e;e++)for(i=a[e],f=1,h=i.length;h>f;f+=2)c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d;return a};if(c._g=A,c.type=A.win.SVGAngle||A.doc.implementation.hasFeature(\"http://www.w3.org/TR/SVG11/feature#BasicStructure\",\"1.1\")?\"SVG\":\"VML\",\"VML\"==c.type){var sb,tb=A.doc.createElement(\"div\");if(tb.innerHTML='<v:shape adj=\"1\"/>',sb=tb.firstChild,sb.style.behavior=\"url(#default#VML)\",!sb||\"object\"!=typeof sb.adj)return c.type=G;tb=null}c.svg=!(c.vml=\"VML\"==c.type),c._Paper=C,c.fn=v=C.prototype=c.prototype,c._id=0,c._oid=0,c.is=function(a,b){return b=M.call(b),\"finite\"==b?!Y[z](+a):\"array\"==b?a instanceof Array:\"null\"==b&&null===a||b==typeof a&&null!==a||\"object\"==b&&a===Object(a)||\"array\"==b&&Array.isArray&&Array.isArray(a)||W.call(a).slice(8,-1).toLowerCase()==b},c.angle=function(a,b,d,e,f,g){if(null==f){var h=a-d,i=b-e;return h||i?(180+180*N.atan2(-i,-h)/S+360)%360:0}return c.angle(a,b,f,g)-c.angle(d,e,f,g)},c.rad=function(a){return a%360*S/180},c.deg=function(a){return 180*a/S%360},c.snapTo=function(a,b,d){if(d=c.is(d,\"finite\")?d:10,c.is(a,V)){for(var e=a.length;e--;)if(Q(a[e]-b)<=d)return a[e]}else{a=+a;var f=b%a;if(d>f)return b-f;if(f>a-d)return b-f+a}return b};c.createUUID=function(a,b){return function(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(a,b).toUpperCase()}}(/[xy]/g,function(a){var b=16*N.random()|0,c=\"x\"==a?b:3&b|8;return c.toString(16)});c.setWindow=function(a){b(\"raphael.setWindow\",c,A.win,a),A.win=a,A.doc=A.win.document,c._engine.initWin&&c._engine.initWin(A.win)};var ub=function(a){if(c.vml){var b,d=/^\\s+|\\s+$/g;try{var e=new ActiveXObject(\"htmlfile\");e.write(\"<body>\"),e.close(),b=e.body}catch(g){b=createPopup().document.body}var h=b.createTextRange();ub=f(function(a){try{b.style.color=I(a).replace(d,G);var c=h.queryCommandValue(\"ForeColor\");return c=(255&c)<<16|65280&c|(16711680&c)>>>16,\"#\"+(\"000000\"+c.toString(16)).slice(-6)}catch(e){return\"none\"}})}else{var i=A.doc.createElement(\"i\");i.title=\"Raphaël Colour Picker\",i.style.display=\"none\",A.doc.body.appendChild(i),ub=f(function(a){return i.style.color=a,A.doc.defaultView.getComputedStyle(i,G).getPropertyValue(\"color\")})}return ub(a)},vb=function(){return\"hsb(\"+[this.h,this.s,this.b]+\")\"},wb=function(){return\"hsl(\"+[this.h,this.s,this.l]+\")\"},xb=function(){return this.hex},yb=function(a,b,d){if(null==b&&c.is(a,\"object\")&&\"r\"in a&&\"g\"in a&&\"b\"in a&&(d=a.b,b=a.g,a=a.r),null==b&&c.is(a,U)){var e=c.getRGB(a);a=e.r,b=e.g,d=e.b}return(a>1||b>1||d>1)&&(a/=255,b/=255,d/=255),[a,b,d]},zb=function(a,b,d,e){a*=255,b*=255,d*=255;var f={r:a,g:b,b:d,hex:c.rgb(a,b,d),toString:xb};return c.is(e,\"finite\")&&(f.opacity=e),f};c.color=function(a){var b;return c.is(a,\"object\")&&\"h\"in a&&\"s\"in a&&\"b\"in a?(b=c.hsb2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.hex=b.hex):c.is(a,\"object\")&&\"h\"in a&&\"s\"in a&&\"l\"in a?(b=c.hsl2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.hex=b.hex):(c.is(a,\"string\")&&(a=c.getRGB(a)),c.is(a,\"object\")&&\"r\"in a&&\"g\"in a&&\"b\"in a?(b=c.rgb2hsl(a),a.h=b.h,a.s=b.s,a.l=b.l,b=c.rgb2hsb(a),a.v=b.b):(a={hex:\"none\"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1)),a.toString=xb,a},c.hsb2rgb=function(a,b,c,d){this.is(a,\"object\")&&\"h\"in a&&\"s\"in a&&\"b\"in a&&(c=a.b,b=a.s,a=a.h,d=a.o),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-Q(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],zb(e,f,g,d)},c.hsl2rgb=function(a,b,c,d){this.is(a,\"object\")&&\"h\"in a&&\"s\"in a&&\"l\"in a&&(c=a.l,b=a.s,a=a.h),(a>1||b>1||c>1)&&(a/=360,b/=100,c/=100),a*=360;var e,f,g,h,i;return a=a%360/60,i=2*b*(.5>c?c:1-c),h=i*(1-Q(a%2-1)),e=f=g=c-i/2,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],zb(e,f,g,d)},c.rgb2hsb=function(a,b,c){c=yb(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g;return f=O(a,b,c),g=f-P(a,b,c),d=0==g?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4,d=(d+360)%6*60/360,e=0==g?0:g/f,{h:d,s:e,b:f,toString:vb}},c.rgb2hsl=function(a,b,c){c=yb(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g,h,i;return g=O(a,b,c),h=P(a,b,c),i=g-h,d=0==i?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4,d=(d+360)%6*60/360,f=(g+h)/2,e=0==i?0:.5>f?i/(2*f):i/(2-2*f),{h:d,s:e,l:f,toString:wb}},c._path2string=function(){return this.join(\",\").replace(gb,\"$1\")};c._preload=function(a,b){var c=A.doc.createElement(\"img\");c.style.cssText=\"position:absolute;left:-9999em;top:-9999em\",c.onload=function(){b.call(this),this.onload=null,A.doc.body.removeChild(this)},c.onerror=function(){A.doc.body.removeChild(this)},A.doc.body.appendChild(c),c.src=a};c.getRGB=f(function(a){if(!a||(a=I(a)).indexOf(\"-\")+1)return{r:-1,g:-1,b:-1,hex:\"none\",error:1,toString:g};if(\"none\"==a)return{r:-1,g:-1,b:-1,hex:\"none\",toString:g};!(fb[z](a.toLowerCase().substring(0,2))||\"#\"==a.charAt())&&(a=ub(a));var b,d,e,f,h,i,j=a.match(X);return j?(j[2]&&(e=ab(j[2].substring(5),16),d=ab(j[2].substring(3,5),16),b=ab(j[2].substring(1,3),16)),j[3]&&(e=ab((h=j[3].charAt(3))+h,16),d=ab((h=j[3].charAt(2))+h,16),b=ab((h=j[3].charAt(1))+h,16)),j[4]&&(i=j[4][J](eb),b=_(i[0]),\"%\"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),\"%\"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),\"%\"==i[2].slice(-1)&&(e*=2.55),\"rgba\"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&\"%\"==i[3].slice(-1)&&(f/=100)),j[5]?(i=j[5][J](eb),b=_(i[0]),\"%\"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),\"%\"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),\"%\"==i[2].slice(-1)&&(e*=2.55),(\"deg\"==i[0].slice(-3)||\"°\"==i[0].slice(-1))&&(b/=360),\"hsba\"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&\"%\"==i[3].slice(-1)&&(f/=100),c.hsb2rgb(b,d,e,f)):j[6]?(i=j[6][J](eb),b=_(i[0]),\"%\"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),\"%\"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),\"%\"==i[2].slice(-1)&&(e*=2.55),(\"deg\"==i[0].slice(-3)||\"°\"==i[0].slice(-1))&&(b/=360),\"hsla\"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&\"%\"==i[3].slice(-1)&&(f/=100),c.hsl2rgb(b,d,e,f)):(j={r:b,g:d,b:e,toString:g},j.hex=\"#\"+(16777216|e|d<<8|b<<16).toString(16).slice(1),c.is(f,\"finite\")&&(j.opacity=f),j)):{r:-1,g:-1,b:-1,hex:\"none\",error:1,toString:g}},c),c.hsb=f(function(a,b,d){return c.hsb2rgb(a,b,d).hex}),c.hsl=f(function(a,b,d){return c.hsl2rgb(a,b,d).hex}),c.rgb=f(function(a,b,c){return\"#\"+(16777216|c|b<<8|a<<16).toString(16).slice(1)}),c.getColor=function(a){var b=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||.75},c=this.hsb2rgb(b.h,b.s,b.b);return b.h+=.075,b.h>1&&(b.h=0,b.s-=.2,b.s<=0&&(this.getColor.start={h:0,s:1,b:b.b})),c.hex},c.getColor.reset=function(){delete this.start},c.parsePathString=function(a){if(!a)return null;var b=Ab(a);if(b.arr)return Cb(b.arr);var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[];return c.is(a,V)&&c.is(a[0],V)&&(e=Cb(a)),e.length||I(a).replace(hb,function(a,b,c){var f=[],g=b.toLowerCase();if(c.replace(jb,function(a,b){b&&f.push(+b)}),\"m\"==g&&f.length>2&&(e.push([b][E](f.splice(0,2))),g=\"l\",b=\"m\"==b?\"l\":\"L\"),\"r\"==g)e.push([b][E](f));else for(;f.length>=d[g]&&(e.push([b][E](f.splice(0,d[g]))),d[g]););}),e.toString=c._path2string,b.arr=Cb(e),e},c.parseTransformString=f(function(a){if(!a)return null;var b=[];return c.is(a,V)&&c.is(a[0],V)&&(b=Cb(a)),b.length||I(a).replace(ib,function(a,c,d){{var e=[];M.call(c)}d.replace(jb,function(a,b){b&&e.push(+b)}),b.push([c][E](e))}),b.toString=c._path2string,b});var Ab=function(a){var b=Ab.ps=Ab.ps||{};return b[a]?b[a].sleep=100:b[a]={sleep:100},setTimeout(function(){for(var c in b)b[z](c)&&c!=a&&(b[c].sleep--,!b[c].sleep&&delete b[c])}),b[a]};c.findDotsAtSegment=function(a,b,c,d,e,f,g,h,i){var j=1-i,k=R(j,3),l=R(j,2),m=i*i,n=m*i,o=k*a+3*l*i*c+3*j*i*i*e+n*g,p=k*b+3*l*i*d+3*j*i*i*f+n*h,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d),u=j*a+i*c,v=j*b+i*d,w=j*e+i*g,x=j*f+i*h,y=90-180*N.atan2(q-s,r-t)/S;return(q>s||t>r)&&(y+=180),{x:o,y:p,m:{x:q,y:r},n:{x:s,y:t},start:{x:u,y:v},end:{x:w,y:x},alpha:y}},c.bezierBBox=function(a,b,d,e,f,g,h,i){c.is(a,\"array\")||(a=[a,b,d,e,f,g,h,i]);var j=Jb.apply(null,a);return{x:j.min.x,y:j.min.y,x2:j.max.x,y2:j.max.y,width:j.max.x-j.min.x,height:j.max.y-j.min.y}},c.isPointInsideBBox=function(a,b,c){return b>=a.x&&b<=a.x2&&c>=a.y&&c<=a.y2},c.isBBoxIntersect=function(a,b){var d=c.isPointInsideBBox;return d(b,a.x,a.y)||d(b,a.x2,a.y)||d(b,a.x,a.y2)||d(b,a.x2,a.y2)||d(a,b.x,b.y)||d(a,b.x2,b.y)||d(a,b.x,b.y2)||d(a,b.x2,b.y2)||(a.x<b.x2&&a.x>b.x||b.x<a.x2&&b.x>a.x)&&(a.y<b.y2&&a.y>b.y||b.y<a.y2&&b.y>a.y)},c.pathIntersection=function(a,b){return n(a,b)},c.pathIntersectionNumber=function(a,b){return n(a,b,1)},c.isPointInsidePath=function(a,b,d){var e=c.pathBBox(a);return c.isPointInsideBBox(e,b,d)&&n(a,[[\"M\",b,d],[\"H\",e.x2+10]],1)%2==1},c._removedFactory=function(a){return function(){b(\"raphael.log\",null,\"Raphaël: you are calling to method “\"+a+\"” of removed object\",a)}};var Bb=c.pathBBox=function(a){var b=Ab(a);if(b.bbox)return d(b.bbox);if(!a)return{x:0,y:0,width:0,height:0,x2:0,y2:0};a=Kb(a);for(var c,e=0,f=0,g=[],h=[],i=0,j=a.length;j>i;i++)if(c=a[i],\"M\"==c[0])e=c[1],f=c[2],g.push(e),h.push(f);else{var k=Jb(e,f,c[1],c[2],c[3],c[4],c[5],c[6]);g=g[E](k.min.x,k.max.x),h=h[E](k.min.y,k.max.y),e=c[5],f=c[6]}var l=P[D](0,g),m=P[D](0,h),n=O[D](0,g),o=O[D](0,h),p=n-l,q=o-m,r={x:l,y:m,x2:n,y2:o,width:p,height:q,cx:l+p/2,cy:m+q/2};return b.bbox=d(r),r},Cb=function(a){var b=d(a);return b.toString=c._path2string,b},Db=c._pathToRelative=function(a){var b=Ab(a);if(b.rel)return Cb(b.rel);c.is(a,V)&&c.is(a&&a[0],V)||(a=c.parsePathString(a));var d=[],e=0,f=0,g=0,h=0,i=0;\"M\"==a[0][0]&&(e=a[0][1],f=a[0][2],g=e,h=f,i++,d.push([\"M\",e,f]));for(var j=i,k=a.length;k>j;j++){var l=d[j]=[],m=a[j];if(m[0]!=M.call(m[0]))switch(l[0]=M.call(m[0]),l[0]){case\"a\":l[1]=m[1],l[2]=m[2],l[3]=m[3],l[4]=m[4],l[5]=m[5],l[6]=+(m[6]-e).toFixed(3),l[7]=+(m[7]-f).toFixed(3);break;case\"v\":l[1]=+(m[1]-f).toFixed(3);break;case\"m\":g=m[1],h=m[2];default:for(var n=1,o=m.length;o>n;n++)l[n]=+(m[n]-(n%2?e:f)).toFixed(3)}else{l=d[j]=[],\"m\"==m[0]&&(g=m[1]+e,h=m[2]+f);for(var p=0,q=m.length;q>p;p++)d[j][p]=m[p]}var r=d[j].length;switch(d[j][0]){case\"z\":e=g,f=h;break;case\"h\":e+=+d[j][r-1];break;case\"v\":f+=+d[j][r-1];break;default:e+=+d[j][r-2],f+=+d[j][r-1]}}return d.toString=c._path2string,b.rel=Cb(d),d},Eb=c._pathToAbsolute=function(a){var b=Ab(a);if(b.abs)return Cb(b.abs);if(c.is(a,V)&&c.is(a&&a[0],V)||(a=c.parsePathString(a)),!a||!a.length)return[[\"M\",0,0]];var d=[],e=0,f=0,g=0,i=0,j=0;\"M\"==a[0][0]&&(e=+a[0][1],f=+a[0][2],g=e,i=f,j++,d[0]=[\"M\",e,f]);for(var k,l,m=3==a.length&&\"M\"==a[0][0]&&\"R\"==a[1][0].toUpperCase()&&\"Z\"==a[2][0].toUpperCase(),n=j,o=a.length;o>n;n++){if(d.push(k=[]),l=a[n],l[0]!=bb.call(l[0]))switch(k[0]=bb.call(l[0]),k[0]){case\"A\":k[1]=l[1],k[2]=l[2],k[3]=l[3],k[4]=l[4],k[5]=l[5],k[6]=+(l[6]+e),k[7]=+(l[7]+f);break;case\"V\":k[1]=+l[1]+f;break;case\"H\":k[1]=+l[1]+e;break;case\"R\":for(var p=[e,f][E](l.slice(1)),q=2,r=p.length;r>q;q++)p[q]=+p[q]+e,p[++q]=+p[q]+f;d.pop(),d=d[E](h(p,m));break;case\"M\":g=+l[1]+e,i=+l[2]+f;default:for(q=1,r=l.length;r>q;q++)k[q]=+l[q]+(q%2?e:f)}else if(\"R\"==l[0])p=[e,f][E](l.slice(1)),d.pop(),d=d[E](h(p,m)),k=[\"R\"][E](l.slice(-2));else for(var s=0,t=l.length;t>s;s++)k[s]=l[s];switch(k[0]){case\"Z\":e=g,f=i;break;case\"H\":e=k[1];break;case\"V\":f=k[1];break;case\"M\":g=k[k.length-2],i=k[k.length-1];default:e=k[k.length-2],f=k[k.length-1]}}return d.toString=c._path2string,b.abs=Cb(d),d},Fb=function(a,b,c,d){return[a,b,c,d,c,d]},Gb=function(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]},Hb=function(a,b,c,d,e,g,h,i,j,k){var l,m=120*S/180,n=S/180*(+e||0),o=[],p=f(function(a,b,c){var d=a*N.cos(c)-b*N.sin(c),e=a*N.sin(c)+b*N.cos(c);return{x:d,y:e}});if(k)y=k[0],z=k[1],w=k[2],x=k[3];else{l=p(a,b,-n),a=l.x,b=l.y,l=p(i,j,-n),i=l.x,j=l.y;var q=(N.cos(S/180*e),N.sin(S/180*e),(a-i)/2),r=(b-j)/2,s=q*q/(c*c)+r*r/(d*d);s>1&&(s=N.sqrt(s),c=s*c,d=s*d);var t=c*c,u=d*d,v=(g==h?-1:1)*N.sqrt(Q((t*u-t*r*r-u*q*q)/(t*r*r+u*q*q))),w=v*c*r/d+(a+i)/2,x=v*-d*q/c+(b+j)/2,y=N.asin(((b-x)/d).toFixed(9)),z=N.asin(((j-x)/d).toFixed(9));y=w>a?S-y:y,z=w>i?S-z:z,0>y&&(y=2*S+y),0>z&&(z=2*S+z),h&&y>z&&(y-=2*S),!h&&z>y&&(z-=2*S)}var A=z-y;if(Q(A)>m){var B=z,C=i,D=j;z=y+m*(h&&z>y?1:-1),i=w+c*N.cos(z),j=x+d*N.sin(z),o=Hb(i,j,c,d,e,0,h,C,D,[z,B,w,x])}A=z-y;var F=N.cos(y),G=N.sin(y),H=N.cos(z),I=N.sin(z),K=N.tan(A/4),L=4/3*c*K,M=4/3*d*K,O=[a,b],P=[a+L*G,b-M*F],R=[i+L*I,j-M*H],T=[i,j];if(P[0]=2*O[0]-P[0],P[1]=2*O[1]-P[1],k)return[P,R,T][E](o);o=[P,R,T][E](o).join()[J](\",\");for(var U=[],V=0,W=o.length;W>V;V++)U[V]=V%2?p(o[V-1],o[V],n).y:p(o[V],o[V+1],n).x;return U},Ib=function(a,b,c,d,e,f,g,h,i){var j=1-i;return{x:R(j,3)*a+3*R(j,2)*i*c+3*j*i*i*e+R(i,3)*g,y:R(j,3)*b+3*R(j,2)*i*d+3*j*i*i*f+R(i,3)*h}},Jb=f(function(a,b,c,d,e,f,g,h){var i,j=e-2*c+a-(g-2*e+c),k=2*(c-a)-2*(e-c),l=a-c,m=(-k+N.sqrt(k*k-4*j*l))/2/j,n=(-k-N.sqrt(k*k-4*j*l))/2/j,o=[b,h],p=[a,g];return Q(m)>\"1e12\"&&(m=.5),Q(n)>\"1e12\"&&(n=.5),m>0&&1>m&&(i=Ib(a,b,c,d,e,f,g,h,m),p.push(i.x),o.push(i.y)),n>0&&1>n&&(i=Ib(a,b,c,d,e,f,g,h,n),p.push(i.x),o.push(i.y)),j=f-2*d+b-(h-2*f+d),k=2*(d-b)-2*(f-d),l=b-d,m=(-k+N.sqrt(k*k-4*j*l))/2/j,n=(-k-N.sqrt(k*k-4*j*l))/2/j,Q(m)>\"1e12\"&&(m=.5),Q(n)>\"1e12\"&&(n=.5),m>0&&1>m&&(i=Ib(a,b,c,d,e,f,g,h,m),p.push(i.x),o.push(i.y)),n>0&&1>n&&(i=Ib(a,b,c,d,e,f,g,h,n),p.push(i.x),o.push(i.y)),{min:{x:P[D](0,p),y:P[D](0,o)},max:{x:O[D](0,p),y:O[D](0,o)}}}),Kb=c._path2curve=f(function(a,b){var c=!b&&Ab(a);if(!b&&c.curve)return Cb(c.curve);for(var d=Eb(a),e=b&&Eb(b),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h=(function(a,b,c){var d,e,f={T:1,Q:1};if(!a)return[\"C\",b.x,b.y,b.x,b.y,b.x,b.y];switch(!(a[0]in f)&&(b.qx=b.qy=null),a[0]){case\"M\":b.X=a[1],b.Y=a[2];break;case\"A\":a=[\"C\"][E](Hb[D](0,[b.x,b.y][E](a.slice(1))));break;case\"S\":\"C\"==c||\"S\"==c?(d=2*b.x-b.bx,e=2*b.y-b.by):(d=b.x,e=b.y),a=[\"C\",d,e][E](a.slice(1));break;case\"T\":\"Q\"==c||\"T\"==c?(b.qx=2*b.x-b.qx,b.qy=2*b.y-b.qy):(b.qx=b.x,b.qy=b.y),a=[\"C\"][E](Gb(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case\"Q\":b.qx=a[1],b.qy=a[2],a=[\"C\"][E](Gb(b.x,b.y,a[1],a[2],a[3],a[4]));break;case\"L\":a=[\"C\"][E](Fb(b.x,b.y,a[1],a[2]));break;case\"H\":a=[\"C\"][E](Fb(b.x,b.y,a[1],b.y));break;case\"V\":a=[\"C\"][E](Fb(b.x,b.y,b.x,a[1]));break;case\"Z\":a=[\"C\"][E](Fb(b.x,b.y,b.X,b.Y))}return a}),i=function(a,b){if(a[b].length>7){a[b].shift();for(var c=a[b];c.length;)a.splice(b++,0,[\"C\"][E](c.splice(0,6)));a.splice(b,1),l=O(d.length,e&&e.length||0)}},j=function(a,b,c,f,g){a&&b&&\"M\"==a[g][0]&&\"M\"!=b[g][0]&&(b.splice(g,0,[\"M\",f.x,f.y]),c.bx=0,c.by=0,c.x=a[g][1],c.y=a[g][2],l=O(d.length,e&&e.length||0))},k=0,l=O(d.length,e&&e.length||0);l>k;k++){d[k]=h(d[k],f),i(d,k),e&&(e[k]=h(e[k],g)),e&&i(e,k),j(d,e,f,g,k),j(e,d,g,f,k);var m=d[k],n=e&&e[k],o=m.length,p=e&&n.length;f.x=m[o-2],f.y=m[o-1],f.bx=_(m[o-4])||f.x,f.by=_(m[o-3])||f.y,g.bx=e&&(_(n[p-4])||g.x),g.by=e&&(_(n[p-3])||g.y),g.x=e&&n[p-2],g.y=e&&n[p-1]}return e||(c.curve=Cb(d)),e?[d,e]:d},null,Cb),Lb=(c._parseDots=f(function(a){for(var b=[],d=0,e=a.length;e>d;d++){var f={},g=a[d].match(/^([^:]*):?([\\d\\.]*)/);if(f.color=c.getRGB(g[1]),f.color.error)return null;f.color=f.color.hex,g[2]&&(f.offset=g[2]+\"%\"),b.push(f)}for(d=1,e=b.length-1;e>d;d++)if(!b[d].offset){for(var h=_(b[d-1].offset||0),i=0,j=d+1;e>j;j++)if(b[j].offset){i=b[j].offset;break}i||(i=100,j=e),i=_(i);for(var k=(i-h)/(j-d+1);j>d;d++)h+=k,b[d].offset=h+\"%\"}return b}),c._tear=function(a,b){a==b.top&&(b.top=a.prev),a==b.bottom&&(b.bottom=a.next),a.next&&(a.next.prev=a.prev),a.prev&&(a.prev.next=a.next)}),Mb=(c._tofront=function(a,b){b.top!==a&&(Lb(a,b),a.next=null,a.prev=b.top,b.top.next=a,b.top=a)},c._toback=function(a,b){b.bottom!==a&&(Lb(a,b),a.next=b.bottom,a.prev=null,b.bottom.prev=a,b.bottom=a)},c._insertafter=function(a,b,c){Lb(a,c),b==c.top&&(c.top=a),b.next&&(b.next.prev=a),a.next=b.next,a.prev=b,b.next=a},c._insertbefore=function(a,b,c){Lb(a,c),b==c.bottom&&(c.bottom=a),b.prev&&(b.prev.next=a),a.prev=b.prev,b.prev=a,a.next=b},c.toMatrix=function(a,b){var c=Bb(a),d={_:{transform:G},getBBox:function(){return c}};return Nb(d,b),d.matrix}),Nb=(c.transformPath=function(a,b){return rb(a,Mb(a,b))},c._extractTransform=function(a,b){if(null==b)return a._.transform;b=I(b).replace(/\\.{3}|\\u2026/g,a._.transform||G);var d=c.parseTransformString(b),e=0,f=0,g=0,h=1,i=1,j=a._,k=new o;if(j.transform=d||[],d)for(var l=0,m=d.length;m>l;l++){var n,p,q,r,s,t=d[l],u=t.length,v=I(t[0]).toLowerCase(),w=t[0]!=v,x=w?k.invert():0;\"t\"==v&&3==u?w?(n=x.x(0,0),p=x.y(0,0),q=x.x(t[1],t[2]),r=x.y(t[1],t[2]),k.translate(q-n,r-p)):k.translate(t[1],t[2]):\"r\"==v?2==u?(s=s||a.getBBox(1),k.rotate(t[1],s.x+s.width/2,s.y+s.height/2),e+=t[1]):4==u&&(w?(q=x.x(t[2],t[3]),r=x.y(t[2],t[3]),k.rotate(t[1],q,r)):k.rotate(t[1],t[2],t[3]),e+=t[1]):\"s\"==v?2==u||3==u?(s=s||a.getBBox(1),k.scale(t[1],t[u-1],s.x+s.width/2,s.y+s.height/2),h*=t[1],i*=t[u-1]):5==u&&(w?(q=x.x(t[3],t[4]),r=x.y(t[3],t[4]),k.scale(t[1],t[2],q,r)):k.scale(t[1],t[2],t[3],t[4]),h*=t[1],i*=t[2]):\"m\"==v&&7==u&&k.add(t[1],t[2],t[3],t[4],t[5],t[6]),j.dirtyT=1,a.matrix=k}a.matrix=k,j.sx=h,j.sy=i,j.deg=e,j.dx=f=k.e,j.dy=g=k.f,1==h&&1==i&&!e&&j.bbox?(j.bbox.x+=+f,j.bbox.y+=+g):j.dirtyT=1}),Ob=function(a){var b=a[0];switch(b.toLowerCase()){case\"t\":return[b,0,0];case\"m\":return[b,1,0,0,1,0,0];case\"r\":return 4==a.length?[b,0,a[2],a[3]]:[b,0];case\"s\":return 5==a.length?[b,1,1,a[3],a[4]]:3==a.length?[b,1,1]:[b,1]}},Pb=c._equaliseTransform=function(a,b){b=I(b).replace(/\\.{3}|\\u2026/g,a),a=c.parseTransformString(a)||[],b=c.parseTransformString(b)||[];for(var d,e,f,g,h=O(a.length,b.length),i=[],j=[],k=0;h>k;k++){if(f=a[k]||Ob(b[k]),g=b[k]||Ob(f),f[0]!=g[0]||\"r\"==f[0].toLowerCase()&&(f[2]!=g[2]||f[3]!=g[3])||\"s\"==f[0].toLowerCase()&&(f[3]!=g[3]||f[4]!=g[4]))return;for(i[k]=[],j[k]=[],d=0,e=O(f.length,g.length);e>d;d++)d in f&&(i[k][d]=f[d]),d in g&&(j[k][d]=g[d])\r\n}return{from:i,to:j}};c._getContainer=function(a,b,d,e){var f;return f=null!=e||c.is(a,\"object\")?a:A.doc.getElementById(a),null!=f?f.tagName?null==b?{container:f,width:f.style.pixelWidth||f.offsetWidth,height:f.style.pixelHeight||f.offsetHeight}:{container:f,width:b,height:d}:{container:1,x:a,y:b,width:d,height:e}:void 0},c.pathToRelative=Db,c._engine={},c.path2curve=Kb,c.matrix=function(a,b,c,d,e,f){return new o(a,b,c,d,e,f)},function(a){function b(a){return a[0]*a[0]+a[1]*a[1]}function d(a){var c=N.sqrt(b(a));a[0]&&(a[0]/=c),a[1]&&(a[1]/=c)}a.add=function(a,b,c,d,e,f){var g,h,i,j,k=[[],[],[]],l=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],m=[[a,c,e],[b,d,f],[0,0,1]];for(a&&a instanceof o&&(m=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]),g=0;3>g;g++)for(h=0;3>h;h++){for(j=0,i=0;3>i;i++)j+=l[g][i]*m[i][h];k[g][h]=j}this.a=k[0][0],this.b=k[1][0],this.c=k[0][1],this.d=k[1][1],this.e=k[0][2],this.f=k[1][2]},a.invert=function(){var a=this,b=a.a*a.d-a.b*a.c;return new o(a.d/b,-a.b/b,-a.c/b,a.a/b,(a.c*a.f-a.d*a.e)/b,(a.b*a.e-a.a*a.f)/b)},a.clone=function(){return new o(this.a,this.b,this.c,this.d,this.e,this.f)},a.translate=function(a,b){this.add(1,0,0,1,a,b)},a.scale=function(a,b,c,d){null==b&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d)},a.rotate=function(a,b,d){a=c.rad(a),b=b||0,d=d||0;var e=+N.cos(a).toFixed(9),f=+N.sin(a).toFixed(9);this.add(e,f,-f,e,b,d),this.add(1,0,0,1,-b,-d)},a.x=function(a,b){return a*this.a+b*this.c+this.e},a.y=function(a,b){return a*this.b+b*this.d+this.f},a.get=function(a){return+this[I.fromCharCode(97+a)].toFixed(4)},a.toString=function(){return c.svg?\"matrix(\"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+\")\":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},a.toFilter=function(){return\"progid:DXImageTransform.Microsoft.Matrix(M11=\"+this.get(0)+\", M12=\"+this.get(2)+\", M21=\"+this.get(1)+\", M22=\"+this.get(3)+\", Dx=\"+this.get(4)+\", Dy=\"+this.get(5)+\", sizingmethod='auto expand')\"},a.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},a.split=function(){var a={};a.dx=this.e,a.dy=this.f;var e=[[this.a,this.c],[this.b,this.d]];a.scalex=N.sqrt(b(e[0])),d(e[0]),a.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*a.shear,e[1][1]-e[0][1]*a.shear],a.scaley=N.sqrt(b(e[1])),d(e[1]),a.shear/=a.scaley;var f=-e[0][1],g=e[1][1];return 0>g?(a.rotate=c.deg(N.acos(g)),0>f&&(a.rotate=360-a.rotate)):a.rotate=c.deg(N.asin(f)),a.isSimple=!(+a.shear.toFixed(9)||a.scalex.toFixed(9)!=a.scaley.toFixed(9)&&a.rotate),a.isSuperSimple=!+a.shear.toFixed(9)&&a.scalex.toFixed(9)==a.scaley.toFixed(9)&&!a.rotate,a.noRotation=!+a.shear.toFixed(9)&&!a.rotate,a},a.toTransformString=function(a){var b=a||this[J]();return b.isSimple?(b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4),(b.dx||b.dy?\"t\"+[b.dx,b.dy]:G)+(1!=b.scalex||1!=b.scaley?\"s\"+[b.scalex,b.scaley,0,0]:G)+(b.rotate?\"r\"+[b.rotate,0,0]:G)):\"m\"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(o.prototype);var Qb=navigator.userAgent.match(/Version\\/(.*?)\\s/)||navigator.userAgent.match(/Chrome\\/(\\d+)/);v.safari=\"Apple Computer, Inc.\"==navigator.vendor&&(Qb&&Qb[1]<4||\"iP\"==navigator.platform.slice(0,2))||\"Google Inc.\"==navigator.vendor&&Qb&&Qb[1]<8?function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:\"none\"});setTimeout(function(){a.remove()})}:mb;for(var Rb=function(){this.returnValue=!1},Sb=function(){return this.originalEvent.preventDefault()},Tb=function(){this.cancelBubble=!0},Ub=function(){return this.originalEvent.stopPropagation()},Vb=function(a){var b=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,c=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft;return{x:a.clientX+c,y:a.clientY+b}},Wb=function(){return A.doc.addEventListener?function(a,b,c,d){var e=function(a){var b=Vb(a);return c.call(d,a,b.x,b.y)};if(a.addEventListener(b,e,!1),F&&L[b]){var f=function(b){for(var e=Vb(b),f=b,g=0,h=b.targetTouches&&b.targetTouches.length;h>g;g++)if(b.targetTouches[g].target==a){b=b.targetTouches[g],b.originalEvent=f,b.preventDefault=Sb,b.stopPropagation=Ub;break}return c.call(d,b,e.x,e.y)};a.addEventListener(L[b],f,!1)}return function(){return a.removeEventListener(b,e,!1),F&&L[b]&&a.removeEventListener(L[b],e,!1),!0}}:A.doc.attachEvent?function(a,b,c,d){var e=function(a){a=a||A.win.event;var b=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,e=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft,f=a.clientX+e,g=a.clientY+b;return a.preventDefault=a.preventDefault||Rb,a.stopPropagation=a.stopPropagation||Tb,c.call(d,a,f,g)};a.attachEvent(\"on\"+b,e);var f=function(){return a.detachEvent(\"on\"+b,e),!0};return f}:void 0}(),Xb=[],Yb=function(a){for(var c,d=a.clientX,e=a.clientY,f=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,g=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft,h=Xb.length;h--;){if(c=Xb[h],F&&a.touches){for(var i,j=a.touches.length;j--;)if(i=a.touches[j],i.identifier==c.el._drag.id){d=i.clientX,e=i.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();var k,l=c.el.node,m=l.nextSibling,n=l.parentNode,o=l.style.display;A.win.opera&&n.removeChild(l),l.style.display=\"none\",k=c.el.paper.getElementByPoint(d,e),l.style.display=o,A.win.opera&&(m?n.insertBefore(l,m):n.appendChild(l)),k&&b(\"raphael.drag.over.\"+c.el.id,c.el,k),d+=g,e+=f,b(\"raphael.drag.move.\"+c.el.id,c.move_scope||c.el,d-c.el._drag.x,e-c.el._drag.y,d,e,a)}},Zb=function(a){c.unmousemove(Yb).unmouseup(Zb);for(var d,e=Xb.length;e--;)d=Xb[e],d.el._drag={},b(\"raphael.drag.end.\"+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,a);Xb=[]},$b=c.el={},_b=K.length;_b--;)!function(a){c[a]=$b[a]=function(b,d){return c.is(b,\"function\")&&(this.events=this.events||[],this.events.push({name:a,f:b,unbind:Wb(this.shape||this.node||A.doc,a,b,d||this)})),this},c[\"un\"+a]=$b[\"un\"+a]=function(b){for(var d=this.events||[],e=d.length;e--;)d[e].name!=a||!c.is(b,\"undefined\")&&d[e].f!=b||(d[e].unbind(),d.splice(e,1),!d.length&&delete this.events);return this}}(K[_b]);$b.data=function(a,d){var e=kb[this.id]=kb[this.id]||{};if(0==arguments.length)return e;if(1==arguments.length){if(c.is(a,\"object\")){for(var f in a)a[z](f)&&this.data(f,a[f]);return this}return b(\"raphael.data.get.\"+this.id,this,e[a],a),e[a]}return e[a]=d,b(\"raphael.data.set.\"+this.id,this,d,a),this},$b.removeData=function(a){return null==a?kb[this.id]={}:kb[this.id]&&delete kb[this.id][a],this},$b.getData=function(){return d(kb[this.id]||{})},$b.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},$b.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var ac=[];$b.drag=function(a,d,e,f,g,h){function i(i){(i.originalEvent||i).preventDefault();var j=i.clientX,k=i.clientY,l=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,m=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft;if(this._drag.id=i.identifier,F&&i.touches)for(var n,o=i.touches.length;o--;)if(n=i.touches[o],this._drag.id=n.identifier,n.identifier==this._drag.id){j=n.clientX,k=n.clientY;break}this._drag.x=j+m,this._drag.y=k+l,!Xb.length&&c.mousemove(Yb).mouseup(Zb),Xb.push({el:this,move_scope:f,start_scope:g,end_scope:h}),d&&b.on(\"raphael.drag.start.\"+this.id,d),a&&b.on(\"raphael.drag.move.\"+this.id,a),e&&b.on(\"raphael.drag.end.\"+this.id,e),b(\"raphael.drag.start.\"+this.id,g||f||this,i.clientX+m,i.clientY+l,i)}return this._drag={},ac.push({el:this,start:i}),this.mousedown(i),this},$b.onDragOver=function(a){a?b.on(\"raphael.drag.over.\"+this.id,a):b.unbind(\"raphael.drag.over.\"+this.id)},$b.undrag=function(){for(var a=ac.length;a--;)ac[a].el==this&&(this.unmousedown(ac[a].start),ac.splice(a,1),b.unbind(\"raphael.drag.*.\"+this.id));!ac.length&&c.unmousemove(Yb).unmouseup(Zb),Xb=[]},v.circle=function(a,b,d){var e=c._engine.circle(this,a||0,b||0,d||0);return this.__set__&&this.__set__.push(e),e},v.rect=function(a,b,d,e,f){var g=c._engine.rect(this,a||0,b||0,d||0,e||0,f||0);return this.__set__&&this.__set__.push(g),g},v.ellipse=function(a,b,d,e){var f=c._engine.ellipse(this,a||0,b||0,d||0,e||0);return this.__set__&&this.__set__.push(f),f},v.path=function(a){a&&!c.is(a,U)&&!c.is(a[0],V)&&(a+=G);var b=c._engine.path(c.format[D](c,arguments),this);return this.__set__&&this.__set__.push(b),b},v.image=function(a,b,d,e,f){var g=c._engine.image(this,a||\"about:blank\",b||0,d||0,e||0,f||0);return this.__set__&&this.__set__.push(g),g},v.text=function(a,b,d){var e=c._engine.text(this,a||0,b||0,I(d));return this.__set__&&this.__set__.push(e),e},v.set=function(a){!c.is(a,\"array\")&&(a=Array.prototype.splice.call(arguments,0,arguments.length));var b=new mc(a);return this.__set__&&this.__set__.push(b),b.paper=this,b.type=\"set\",b},v.setStart=function(a){this.__set__=a||this.set()},v.setFinish=function(){var a=this.__set__;return delete this.__set__,a},v.setSize=function(a,b){return c._engine.setSize.call(this,a,b)},v.setViewBox=function(a,b,d,e,f){return c._engine.setViewBox.call(this,a,b,d,e,f)},v.top=v.bottom=null,v.raphael=c;var bc=function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,h=b.top+(A.win.pageYOffset||e.scrollTop||d.scrollTop)-f,i=b.left+(A.win.pageXOffset||e.scrollLeft||d.scrollLeft)-g;return{y:h,x:i}};v.getElementByPoint=function(a,b){var c=this,d=c.canvas,e=A.doc.elementFromPoint(a,b);if(A.win.opera&&\"svg\"==e.tagName){var f=bc(d),g=d.createSVGRect();g.x=a-f.x,g.y=b-f.y,g.width=g.height=1;var h=d.getIntersectionList(g,null);h.length&&(e=h[h.length-1])}if(!e)return null;for(;e.parentNode&&e!=d.parentNode&&!e.raphael;)e=e.parentNode;return e==c.canvas.parentNode&&(e=d),e=e&&e.raphael?c.getById(e.raphaelid):null},v.getElementsByBBox=function(a){var b=this.set();return this.forEach(function(d){c.isBBoxIntersect(d.getBBox(),a)&&b.push(d)}),b},v.getById=function(a){for(var b=this.bottom;b;){if(b.id==a)return b;b=b.next}return null},v.forEach=function(a,b){for(var c=this.bottom;c;){if(a.call(b,c)===!1)return this;c=c.next}return this},v.getElementsByPoint=function(a,b){var c=this.set();return this.forEach(function(d){d.isPointInside(a,b)&&c.push(d)}),c},$b.isPointInside=function(a,b){var d=this.realPath=qb[this.type](this);return this.attr(\"transform\")&&this.attr(\"transform\").length&&(d=c.transformPath(d,this.attr(\"transform\"))),c.isPointInsidePath(d,a,b)},$b.getBBox=function(a){if(this.removed)return{};var b=this._;return a?((b.dirty||!b.bboxwt)&&(this.realPath=qb[this.type](this),b.bboxwt=Bb(this.realPath),b.bboxwt.toString=p,b.dirty=0),b.bboxwt):((b.dirty||b.dirtyT||!b.bbox)&&((b.dirty||!this.realPath)&&(b.bboxwt=0,this.realPath=qb[this.type](this)),b.bbox=Bb(rb(this.realPath,this.matrix)),b.bbox.toString=p,b.dirty=b.dirtyT=0),b.bbox)},$b.clone=function(){if(this.removed)return null;var a=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(a),a},$b.glow=function(a){if(\"text\"==this.type)return null;a=a||{};var b={width:(a.width||10)+(+this.attr(\"stroke-width\")||1),fill:a.fill||!1,opacity:a.opacity||.5,offsetx:a.offsetx||0,offsety:a.offsety||0,color:a.color||\"#000\"},c=b.width/2,d=this.paper,e=d.set(),f=this.realPath||qb[this.type](this);f=this.matrix?rb(f,this.matrix):f;for(var g=1;c+1>g;g++)e.push(d.path(f).attr({stroke:b.color,fill:b.fill?b.color:\"none\",\"stroke-linejoin\":\"round\",\"stroke-linecap\":\"round\",\"stroke-width\":+(b.width/c*g).toFixed(3),opacity:+(b.opacity/c).toFixed(3)}));return e.insertBefore(this).translate(b.offsetx,b.offsety)};var cc=function(a,b,d,e,f,g,h,i,l){return null==l?j(a,b,d,e,f,g,h,i):c.findDotsAtSegment(a,b,d,e,f,g,h,i,k(a,b,d,e,f,g,h,i,l))},dc=function(a,b){return function(d,e,f){d=Kb(d);for(var g,h,i,j,k,l=\"\",m={},n=0,o=0,p=d.length;p>o;o++){if(i=d[o],\"M\"==i[0])g=+i[1],h=+i[2];else{if(j=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6]),n+j>e){if(b&&!m.start){if(k=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n),l+=[\"C\"+k.start.x,k.start.y,k.m.x,k.m.y,k.x,k.y],f)return l;m.start=l,l=[\"M\"+k.x,k.y+\"C\"+k.n.x,k.n.y,k.end.x,k.end.y,i[5],i[6]].join(),n+=j,g=+i[5],h=+i[6];continue}if(!a&&!b)return k=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n),{x:k.x,y:k.y,alpha:k.alpha}}n+=j,g=+i[5],h=+i[6]}l+=i.shift()+i}return m.end=l,k=a?n:b?m:c.findDotsAtSegment(g,h,i[0],i[1],i[2],i[3],i[4],i[5],1),k.alpha&&(k={x:k.x,y:k.y,alpha:k.alpha}),k}},ec=dc(1),fc=dc(),gc=dc(0,1);c.getTotalLength=ec,c.getPointAtLength=fc,c.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<1e-6)return gc(a,b).end;var d=gc(a,c,1);return b?gc(d,b).end:d},$b.getTotalLength=function(){var a=this.getPath();if(a)return this.node.getTotalLength?this.node.getTotalLength():ec(a)},$b.getPointAtLength=function(a){var b=this.getPath();if(b)return fc(b,a)},$b.getPath=function(){var a,b=c._getPath[this.type];if(\"text\"!=this.type&&\"set\"!=this.type)return b&&(a=b(this)),a},$b.getSubpath=function(a,b){var d=this.getPath();if(d)return c.getSubpath(d,a,b)};var hc=c.easing_formulas={linear:function(a){return a},\"<\":function(a){return R(a,1.7)},\">\":function(a){return R(a,.48)},\"<>\":function(a){var b=.48-a/1.04,c=N.sqrt(.1734+b*b),d=c-b,e=R(Q(d),1/3)*(0>d?-1:1),f=-c-b,g=R(Q(f),1/3)*(0>f?-1:1),h=e+g+.5;return 3*(1-h)*h*h+h*h*h},backIn:function(a){var b=1.70158;return a*a*((b+1)*a-b)},backOut:function(a){a-=1;var b=1.70158;return a*a*((b+1)*a+b)+1},elastic:function(a){return a==!!a?a:R(2,-10*a)*N.sin(2*(a-.075)*S/.3)+1},bounce:function(a){var b,c=7.5625,d=2.75;return 1/d>a?b=c*a*a:2/d>a?(a-=1.5/d,b=c*a*a+.75):2.5/d>a?(a-=2.25/d,b=c*a*a+.9375):(a-=2.625/d,b=c*a*a+.984375),b}};hc.easeIn=hc[\"ease-in\"]=hc[\"<\"],hc.easeOut=hc[\"ease-out\"]=hc[\">\"],hc.easeInOut=hc[\"ease-in-out\"]=hc[\"<>\"],hc[\"back-in\"]=hc.backIn,hc[\"back-out\"]=hc.backOut;var ic=[],jc=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){setTimeout(a,16)},kc=function(){for(var a=+new Date,d=0;d<ic.length;d++){var e=ic[d];if(!e.el.removed&&!e.paused){var f,g,h=a-e.start,i=e.ms,j=e.easing,k=e.from,l=e.diff,m=e.to,n=(e.t,e.el),o={},p={};if(e.initstatus?(h=(e.initstatus*e.anim.top-e.prev)/(e.percent-e.prev)*i,e.status=e.initstatus,delete e.initstatus,e.stop&&ic.splice(d--,1)):e.status=(e.prev+(e.percent-e.prev)*(h/i))/e.anim.top,!(0>h))if(i>h){var q=j(h/i);for(var r in k)if(k[z](r)){switch(db[r]){case T:f=+k[r]+q*i*l[r];break;case\"colour\":f=\"rgb(\"+[lc($(k[r].r+q*i*l[r].r)),lc($(k[r].g+q*i*l[r].g)),lc($(k[r].b+q*i*l[r].b))].join(\",\")+\")\";break;case\"path\":f=[];for(var t=0,u=k[r].length;u>t;t++){f[t]=[k[r][t][0]];for(var v=1,w=k[r][t].length;w>v;v++)f[t][v]=+k[r][t][v]+q*i*l[r][t][v];f[t]=f[t].join(H)}f=f.join(H);break;case\"transform\":if(l[r].real)for(f=[],t=0,u=k[r].length;u>t;t++)for(f[t]=[k[r][t][0]],v=1,w=k[r][t].length;w>v;v++)f[t][v]=k[r][t][v]+q*i*l[r][t][v];else{var x=function(a){return+k[r][a]+q*i*l[r][a]};f=[[\"m\",x(0),x(1),x(2),x(3),x(4),x(5)]]}break;case\"csv\":if(\"clip-rect\"==r)for(f=[],t=4;t--;)f[t]=+k[r][t]+q*i*l[r][t];break;default:var y=[][E](k[r]);for(f=[],t=n.paper.customAttributes[r].length;t--;)f[t]=+y[t]+q*i*l[r][t]}o[r]=f}n.attr(o),function(a,c,d){setTimeout(function(){b(\"raphael.anim.frame.\"+a,c,d)})}(n.id,n,e.anim)}else{if(function(a,d,e){setTimeout(function(){b(\"raphael.anim.frame.\"+d.id,d,e),b(\"raphael.anim.finish.\"+d.id,d,e),c.is(a,\"function\")&&a.call(d)})}(e.callback,n,e.anim),n.attr(m),ic.splice(d--,1),e.repeat>1&&!e.next){for(g in m)m[z](g)&&(p[g]=e.totalOrigin[g]);e.el.attr(p),s(e.anim,e.el,e.anim.percents[0],null,e.totalOrigin,e.repeat-1)}e.next&&!e.stop&&s(e.anim,e.el,e.next,null,e.totalOrigin,e.repeat)}}}c.svg&&n&&n.paper&&n.paper.safari(),ic.length&&jc(kc)},lc=function(a){return a>255?255:0>a?0:a};$b.animateWith=function(a,b,d,e,f,g){var h=this;if(h.removed)return g&&g.call(h),h;var i=d instanceof r?d:c.animation(d,e,f,g);s(i,h,i.percents[0],null,h.attr());for(var j=0,k=ic.length;k>j;j++)if(ic[j].anim==b&&ic[j].el==a){ic[k-1].start=ic[j].start;break}return h},$b.onAnimation=function(a){return a?b.on(\"raphael.anim.frame.\"+this.id,a):b.unbind(\"raphael.anim.frame.\"+this.id),this},r.prototype.delay=function(a){var b=new r(this.anim,this.ms);return b.times=this.times,b.del=+a||0,b},r.prototype.repeat=function(a){var b=new r(this.anim,this.ms);return b.del=this.del,b.times=N.floor(O(a,0))||1,b},c.animation=function(a,b,d,e){if(a instanceof r)return a;(c.is(d,\"function\")||!d)&&(e=e||d||null,d=null),a=Object(a),b=+b||0;var f,g,h={};for(g in a)a[z](g)&&_(g)!=g&&_(g)+\"%\"!=g&&(f=!0,h[g]=a[g]);return f?(d&&(h.easing=d),e&&(h.callback=e),new r({100:h},b)):new r(a,b)},$b.animate=function(a,b,d,e){var f=this;if(f.removed)return e&&e.call(f),f;var g=a instanceof r?a:c.animation(a,b,d,e);return s(g,f,g.percents[0],null,f.attr()),f},$b.setTime=function(a,b){return a&&null!=b&&this.status(a,P(b,a.ms)/a.ms),this},$b.status=function(a,b){var c,d,e=[],f=0;if(null!=b)return s(a,this,-1,P(b,1)),this;for(c=ic.length;c>f;f++)if(d=ic[f],d.el.id==this.id&&(!a||d.anim==a)){if(a)return d.status;e.push({anim:d.anim,status:d.status})}return a?0:e},$b.pause=function(a){for(var c=0;c<ic.length;c++)ic[c].el.id!=this.id||a&&ic[c].anim!=a||b(\"raphael.anim.pause.\"+this.id,this,ic[c].anim)!==!1&&(ic[c].paused=!0);return this},$b.resume=function(a){for(var c=0;c<ic.length;c++)if(ic[c].el.id==this.id&&(!a||ic[c].anim==a)){var d=ic[c];b(\"raphael.anim.resume.\"+this.id,this,d.anim)!==!1&&(delete d.paused,this.status(d.anim,d.status))}return this},$b.stop=function(a){for(var c=0;c<ic.length;c++)ic[c].el.id!=this.id||a&&ic[c].anim!=a||b(\"raphael.anim.stop.\"+this.id,this,ic[c].anim)!==!1&&ic.splice(c--,1);return this},b.on(\"raphael.remove\",t),b.on(\"raphael.clear\",t),$b.toString=function(){return\"Raphaël’s object\"};var mc=function(a){if(this.items=[],this.length=0,this.type=\"set\",a)for(var b=0,c=a.length;c>b;b++)!a[b]||a[b].constructor!=$b.constructor&&a[b].constructor!=mc||(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)},nc=mc.prototype;nc.push=function(){for(var a,b,c=0,d=arguments.length;d>c;c++)a=arguments[c],!a||a.constructor!=$b.constructor&&a.constructor!=mc||(b=this.items.length,this[b]=this.items[b]=a,this.length++);return this},nc.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},nc.forEach=function(a,b){for(var c=0,d=this.items.length;d>c;c++)if(a.call(b,this.items[c],c)===!1)return this;return this};for(var oc in $b)$b[z](oc)&&(nc[oc]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a][D](c,b)})}}(oc));return nc.attr=function(a,b){if(a&&c.is(a,V)&&c.is(a[0],\"object\"))for(var d=0,e=a.length;e>d;d++)this.items[d].attr(a[d]);else for(var f=0,g=this.items.length;g>f;f++)this.items[f].attr(a,b);return this},nc.clear=function(){for(;this.length;)this.pop()},nc.splice=function(a,b){a=0>a?O(this.length+a,0):a,b=O(0,P(this.length-a,b));var c,d=[],e=[],f=[];for(c=2;c<arguments.length;c++)f.push(arguments[c]);for(c=0;b>c;c++)e.push(this[a+c]);for(;c<this.length-a;c++)d.push(this[a+c]);var g=f.length;for(c=0;c<g+d.length;c++)this.items[a+c]=this[a+c]=g>c?f[c]:d[c-g];for(c=this.items.length=this.length-=b-g;this[c];)delete this[c++];return new mc(e)},nc.exclude=function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]==a)return this.splice(b,1),!0},nc.animate=function(a,b,d,e){(c.is(d,\"function\")||!d)&&(e=d||null);var f,g,h=this.items.length,i=h,j=this;if(!h)return this;e&&(g=function(){!--h&&e.call(j)}),d=c.is(d,U)?d:g;var k=c.animation(a,b,d,g);for(f=this.items[--i].animate(k);i--;)this.items[i]&&!this.items[i].removed&&this.items[i].animateWith(f,k,k),this.items[i]&&!this.items[i].removed||h--;return this},nc.insertAfter=function(a){for(var b=this.items.length;b--;)this.items[b].insertAfter(a);return this},nc.getBBox=function(){for(var a=[],b=[],c=[],d=[],e=this.items.length;e--;)if(!this.items[e].removed){var f=this.items[e].getBBox();a.push(f.x),b.push(f.y),c.push(f.x+f.width),d.push(f.y+f.height)}return a=P[D](0,a),b=P[D](0,b),c=O[D](0,c),d=O[D](0,d),{x:a,y:b,x2:c,y2:d,width:c-a,height:d-b}},nc.clone=function(a){a=this.paper.set();for(var b=0,c=this.items.length;c>b;b++)a.push(this.items[b].clone());return a},nc.toString=function(){return\"Raphaël‘s set\"},nc.glow=function(a){var b=this.paper.set();return this.forEach(function(c){var d=c.glow(a);null!=d&&d.forEach(function(a){b.push(a)})}),b},nc.isPointInside=function(a,b){var c=!1;return this.forEach(function(d){return d.isPointInside(a,b)?(c=!0,!1):void 0}),c},c.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var b={w:a.w,face:{},glyphs:{}},c=a.face[\"font-family\"];for(var d in a.face)a.face[z](d)&&(b.face[d]=a.face[d]);if(this.fonts[c]?this.fonts[c].push(b):this.fonts[c]=[b],!a.svg){b.face[\"units-per-em\"]=ab(a.face[\"units-per-em\"],10);for(var e in a.glyphs)if(a.glyphs[z](e)){var f=a.glyphs[e];if(b.glyphs[e]={w:f.w,k:{},d:f.d&&\"M\"+f.d.replace(/[mlcxtrv]/g,function(a){return{l:\"L\",c:\"C\",x:\"z\",t:\"m\",r:\"l\",v:\"c\"}[a]||\"M\"})+\"z\"},f.k)for(var g in f.k)f[z](g)&&(b.glyphs[e].k[g]=f.k[g])}}return a},v.getFont=function(a,b,d,e){if(e=e||\"normal\",d=d||\"normal\",b=+b||{normal:400,bold:700,lighter:300,bolder:800}[b]||400,c.fonts){var f=c.fonts[a];if(!f){var g=new RegExp(\"(^|\\\\s)\"+a.replace(/[^\\w\\d\\s+!~.:_-]/g,G)+\"(\\\\s|$)\",\"i\");for(var h in c.fonts)if(c.fonts[z](h)&&g.test(h)){f=c.fonts[h];break}}var i;if(f)for(var j=0,k=f.length;k>j&&(i=f[j],i.face[\"font-weight\"]!=b||i.face[\"font-style\"]!=d&&i.face[\"font-style\"]||i.face[\"font-stretch\"]!=e);j++);return i}},v.print=function(a,b,d,e,f,g,h,i){g=g||\"middle\",h=O(P(h||0,1),-1),i=O(P(i||1,3),1);var j,k=I(d)[J](G),l=0,m=0,n=G;if(c.is(e,\"string\")&&(e=this.getFont(e)),e){j=(f||16)/e.face[\"units-per-em\"];for(var o=e.face.bbox[J](w),p=+o[0],q=o[3]-o[1],r=0,s=+o[1]+(\"baseline\"==g?q+ +e.face.descent:q/2),t=0,u=k.length;u>t;t++){if(\"\\n\"==k[t])l=0,x=0,m=0,r+=q*i;else{var v=m&&e.glyphs[k[t-1]]||{},x=e.glyphs[k[t]];l+=m?(v.w||e.w)+(v.k&&v.k[k[t]]||0)+e.w*h:0,m=1}x&&x.d&&(n+=c.transformPath(x.d,[\"t\",l*j,r*j,\"s\",j,j,p,s,\"t\",(a-p)/j,(b-s)/j]))}}return this.path(n).attr({fill:\"#000\",stroke:\"none\"})},v.add=function(a){if(c.is(a,\"array\"))for(var b,d=this.set(),e=0,f=a.length;f>e;e++)b=a[e]||{},x[z](b.type)&&d.push(this[b.type]().attr(b));return d},c.format=function(a,b){var d=c.is(b,V)?[0][E](b):arguments;return a&&c.is(a,U)&&d.length-1&&(a=a.replace(y,function(a,b){return null==d[++b]?G:d[b]})),a||G},c.fullfill=function(){var a=/\\{([^\\}]+)\\}/g,b=/(?:(?:^|\\.)(.+?)(?=\\[|\\.|$|\\()|\\[('|\")(.+?)\\2\\])(\\(\\))?/g,c=function(a,c,d){var e=d;return c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),\"function\"==typeof e&&f&&(e=e()))}),e=(null==e||e==d?a:e)+\"\"};return function(b,d){return String(b).replace(a,function(a,b){return c(a,b,d)})}}(),c.ninja=function(){return B.was?A.win.Raphael=B.is:delete Raphael,c},c.st=nc,function(a,b,d){function e(){/in/.test(a.readyState)?setTimeout(e,9):c.eve(\"raphael.DOMload\")}null==a.readyState&&a.addEventListener&&(a.addEventListener(b,d=function(){a.removeEventListener(b,d,!1),a.readyState=\"complete\"},!1),a.readyState=\"loading\"),e()}(document,\"DOMContentLoaded\"),b.on(\"raphael.DOMload\",function(){u=!0}),function(){if(c.svg){var a=\"hasOwnProperty\",b=String,d=parseFloat,e=parseInt,f=Math,g=f.max,h=f.abs,i=f.pow,j=/[, ]+/,k=c.eve,l=\"\",m=\" \",n=\"http://www.w3.org/1999/xlink\",o={block:\"M5,0 0,2.5 5,5z\",classic:\"M5,0 0,2.5 5,5 3.5,3 3.5,2z\",diamond:\"M2.5,0 5,2.5 2.5,5 0,2.5z\",open:\"M6,1 1,3.5 6,6\",oval:\"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z\"},p={};c.toString=function(){return\"Your browser supports SVG.\\nYou are running Raphaël \"+this.version};var q=function(d,e){if(e){\"string\"==typeof d&&(d=q(d));for(var f in e)e[a](f)&&(\"xlink:\"==f.substring(0,6)?d.setAttributeNS(n,f.substring(6),b(e[f])):d.setAttribute(f,b(e[f])))}else d=c._g.doc.createElementNS(\"http://www.w3.org/2000/svg\",d),d.style&&(d.style.webkitTapHighlightColor=\"rgba(0,0,0,0)\");return d},r=function(a,e){var j=\"linear\",k=a.id+e,m=.5,n=.5,o=a.node,p=a.paper,r=o.style,s=c._g.doc.getElementById(k);if(!s){if(e=b(e).replace(c._radial_gradient,function(a,b,c){if(j=\"radial\",b&&c){m=d(b),n=d(c);var e=2*(n>.5)-1;i(m-.5,2)+i(n-.5,2)>.25&&(n=f.sqrt(.25-i(m-.5,2))*e+.5)&&.5!=n&&(n=n.toFixed(5)-1e-5*e)}return l}),e=e.split(/\\s*\\-\\s*/),\"linear\"==j){var t=e.shift();if(t=-d(t),isNaN(t))return null;var u=[0,0,f.cos(c.rad(t)),f.sin(c.rad(t))],v=1/(g(h(u[2]),h(u[3]))||1);u[2]*=v,u[3]*=v,u[2]<0&&(u[0]=-u[2],u[2]=0),u[3]<0&&(u[1]=-u[3],u[3]=0)}var w=c._parseDots(e);if(!w)return null;if(k=k.replace(/[\\(\\)\\s,\\xb0#]/g,\"_\"),a.gradient&&k!=a.gradient.id&&(p.defs.removeChild(a.gradient),delete a.gradient),!a.gradient){s=q(j+\"Gradient\",{id:k}),a.gradient=s,q(s,\"radial\"==j?{fx:m,fy:n}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientTransform:a.matrix.invert()}),p.defs.appendChild(s);for(var x=0,y=w.length;y>x;x++)s.appendChild(q(\"stop\",{offset:w[x].offset?w[x].offset:x?\"100%\":\"0%\",\"stop-color\":w[x].color||\"#fff\"}))}}return q(o,{fill:\"url(#\"+k+\")\",opacity:1,\"fill-opacity\":1}),r.fill=l,r.opacity=1,r.fillOpacity=1,1},s=function(a){var b=a.getBBox(1);q(a.pattern,{patternTransform:a.matrix.invert()+\" translate(\"+b.x+\",\"+b.y+\")\"})},t=function(d,e,f){if(\"path\"==d.type){for(var g,h,i,j,k,m=b(e).toLowerCase().split(\"-\"),n=d.paper,r=f?\"end\":\"start\",s=d.node,t=d.attrs,u=t[\"stroke-width\"],v=m.length,w=\"classic\",x=3,y=3,z=5;v--;)switch(m[v]){case\"block\":case\"classic\":case\"oval\":case\"diamond\":case\"open\":case\"none\":w=m[v];break;case\"wide\":y=5;break;case\"narrow\":y=2;break;case\"long\":x=5;break;case\"short\":x=2}if(\"open\"==w?(x+=2,y+=2,z+=2,i=1,j=f?4:1,k={fill:\"none\",stroke:t.stroke}):(j=i=x/2,k={fill:t.stroke,stroke:\"none\"}),d._.arrows?f?(d._.arrows.endPath&&p[d._.arrows.endPath]--,d._.arrows.endMarker&&p[d._.arrows.endMarker]--):(d._.arrows.startPath&&p[d._.arrows.startPath]--,d._.arrows.startMarker&&p[d._.arrows.startMarker]--):d._.arrows={},\"none\"!=w){var A=\"raphael-marker-\"+w,B=\"raphael-marker-\"+r+w+x+y;c._g.doc.getElementById(A)?p[A]++:(n.defs.appendChild(q(q(\"path\"),{\"stroke-linecap\":\"round\",d:o[w],id:A})),p[A]=1);var C,D=c._g.doc.getElementById(B);D?(p[B]++,C=D.getElementsByTagName(\"use\")[0]):(D=q(q(\"marker\"),{id:B,markerHeight:y,markerWidth:x,orient:\"auto\",refX:j,refY:y/2}),C=q(q(\"use\"),{\"xlink:href\":\"#\"+A,transform:(f?\"rotate(180 \"+x/2+\" \"+y/2+\") \":l)+\"scale(\"+x/z+\",\"+y/z+\")\",\"stroke-width\":(1/((x/z+y/z)/2)).toFixed(4)}),D.appendChild(C),n.defs.appendChild(D),p[B]=1),q(C,k);var E=i*(\"diamond\"!=w&&\"oval\"!=w);f?(g=d._.arrows.startdx*u||0,h=c.getTotalLength(t.path)-E*u):(g=E*u,h=c.getTotalLength(t.path)-(d._.arrows.enddx*u||0)),k={},k[\"marker-\"+r]=\"url(#\"+B+\")\",(h||g)&&(k.d=c.getSubpath(t.path,g,h)),q(s,k),d._.arrows[r+\"Path\"]=A,d._.arrows[r+\"Marker\"]=B,d._.arrows[r+\"dx\"]=E,d._.arrows[r+\"Type\"]=w,d._.arrows[r+\"String\"]=e}else f?(g=d._.arrows.startdx*u||0,h=c.getTotalLength(t.path)-g):(g=0,h=c.getTotalLength(t.path)-(d._.arrows.enddx*u||0)),d._.arrows[r+\"Path\"]&&q(s,{d:c.getSubpath(t.path,g,h)}),delete d._.arrows[r+\"Path\"],delete d._.arrows[r+\"Marker\"],delete d._.arrows[r+\"dx\"],delete d._.arrows[r+\"Type\"],delete d._.arrows[r+\"String\"];for(k in p)if(p[a](k)&&!p[k]){var F=c._g.doc.getElementById(k);F&&F.parentNode.removeChild(F)}}},u={\"\":[0],none:[0],\"-\":[3,1],\".\":[1,1],\"-.\":[3,1,1,1],\"-..\":[3,1,1,1,1,1],\". \":[1,3],\"- \":[4,3],\"--\":[8,3],\"- .\":[4,3,1,3],\"--.\":[8,3,1,3],\"--..\":[8,3,1,3,1,3]},v=function(a,c,d){if(c=u[b(c).toLowerCase()]){for(var e=a.attrs[\"stroke-width\"]||\"1\",f={round:e,square:e,butt:0}[a.attrs[\"stroke-linecap\"]||d[\"stroke-linecap\"]]||0,g=[],h=c.length;h--;)g[h]=c[h]*e+(h%2?1:-1)*f;q(a.node,{\"stroke-dasharray\":g.join(\",\")})}},w=function(d,f){var i=d.node,k=d.attrs,m=i.style.visibility;i.style.visibility=\"hidden\";for(var o in f)if(f[a](o)){if(!c._availableAttrs[a](o))continue;var p=f[o];switch(k[o]=p,o){case\"blur\":d.blur(p);break;case\"title\":var u=i.getElementsByTagName(\"title\");if(u.length&&(u=u[0]))u.firstChild.nodeValue=p;else{u=q(\"title\");var w=c._g.doc.createTextNode(p);u.appendChild(w),i.appendChild(u)}break;case\"href\":case\"target\":var x=i.parentNode;if(\"a\"!=x.tagName.toLowerCase()){var z=q(\"a\");x.insertBefore(z,i),z.appendChild(i),x=z}\"target\"==o?x.setAttributeNS(n,\"show\",\"blank\"==p?\"new\":p):x.setAttributeNS(n,o,p);break;case\"cursor\":i.style.cursor=p;break;case\"transform\":d.transform(p);break;case\"arrow-start\":t(d,p);break;case\"arrow-end\":t(d,p,1);break;case\"clip-rect\":var A=b(p).split(j);if(4==A.length){d.clip&&d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);var B=q(\"clipPath\"),C=q(\"rect\");B.id=c.createUUID(),q(C,{x:A[0],y:A[1],width:A[2],height:A[3]}),B.appendChild(C),d.paper.defs.appendChild(B),q(i,{\"clip-path\":\"url(#\"+B.id+\")\"}),d.clip=C}if(!p){var D=i.getAttribute(\"clip-path\");if(D){var E=c._g.doc.getElementById(D.replace(/(^url\\(#|\\)$)/g,l));E&&E.parentNode.removeChild(E),q(i,{\"clip-path\":l}),delete d.clip}}break;case\"path\":\"path\"==d.type&&(q(i,{d:p?k.path=c._pathToAbsolute(p):\"M0,0\"}),d._.dirty=1,d._.arrows&&(\"startString\"in d._.arrows&&t(d,d._.arrows.startString),\"endString\"in d._.arrows&&t(d,d._.arrows.endString,1)));break;case\"width\":if(i.setAttribute(o,p),d._.dirty=1,!k.fx)break;o=\"x\",p=k.x;case\"x\":k.fx&&(p=-k.x-(k.width||0));case\"rx\":if(\"rx\"==o&&\"rect\"==d.type)break;case\"cx\":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case\"height\":if(i.setAttribute(o,p),d._.dirty=1,!k.fy)break;o=\"y\",p=k.y;case\"y\":k.fy&&(p=-k.y-(k.height||0));case\"ry\":if(\"ry\"==o&&\"rect\"==d.type)break;case\"cy\":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case\"r\":\"rect\"==d.type?q(i,{rx:p,ry:p}):i.setAttribute(o,p),d._.dirty=1;break;case\"src\":\"image\"==d.type&&i.setAttributeNS(n,\"href\",p);break;case\"stroke-width\":(1!=d._.sx||1!=d._.sy)&&(p/=g(h(d._.sx),h(d._.sy))||1),d.paper._vbSize&&(p*=d.paper._vbSize),i.setAttribute(o,p),k[\"stroke-dasharray\"]&&v(d,k[\"stroke-dasharray\"],f),d._.arrows&&(\"startString\"in d._.arrows&&t(d,d._.arrows.startString),\"endString\"in d._.arrows&&t(d,d._.arrows.endString,1));break;case\"stroke-dasharray\":v(d,p,f);break;case\"fill\":var F=b(p).match(c._ISURL);if(F){B=q(\"pattern\");var G=q(\"image\");B.id=c.createUUID(),q(B,{x:0,y:0,patternUnits:\"userSpaceOnUse\",height:1,width:1}),q(G,{x:0,y:0,\"xlink:href\":F[1]}),B.appendChild(G),function(a){c._preload(F[1],function(){var b=this.offsetWidth,c=this.offsetHeight;q(a,{width:b,height:c}),q(G,{width:b,height:c}),d.paper.safari()})}(B),d.paper.defs.appendChild(B),q(i,{fill:\"url(#\"+B.id+\")\"}),d.pattern=B,d.pattern&&s(d);break}var H=c.getRGB(p);if(H.error){if((\"circle\"==d.type||\"ellipse\"==d.type||\"r\"!=b(p).charAt())&&r(d,p)){if(\"opacity\"in k||\"fill-opacity\"in k){var I=c._g.doc.getElementById(i.getAttribute(\"fill\").replace(/^url\\(#|\\)$/g,l));if(I){var J=I.getElementsByTagName(\"stop\");q(J[J.length-1],{\"stop-opacity\":(\"opacity\"in k?k.opacity:1)*(\"fill-opacity\"in k?k[\"fill-opacity\"]:1)})}}k.gradient=p,k.fill=\"none\";break}}else delete f.gradient,delete k.gradient,!c.is(k.opacity,\"undefined\")&&c.is(f.opacity,\"undefined\")&&q(i,{opacity:k.opacity}),!c.is(k[\"fill-opacity\"],\"undefined\")&&c.is(f[\"fill-opacity\"],\"undefined\")&&q(i,{\"fill-opacity\":k[\"fill-opacity\"]});H[a](\"opacity\")&&q(i,{\"fill-opacity\":H.opacity>1?H.opacity/100:H.opacity});case\"stroke\":H=c.getRGB(p),i.setAttribute(o,H.hex),\"stroke\"==o&&H[a](\"opacity\")&&q(i,{\"stroke-opacity\":H.opacity>1?H.opacity/100:H.opacity}),\"stroke\"==o&&d._.arrows&&(\"startString\"in d._.arrows&&t(d,d._.arrows.startString),\"endString\"in d._.arrows&&t(d,d._.arrows.endString,1));break;case\"gradient\":(\"circle\"==d.type||\"ellipse\"==d.type||\"r\"!=b(p).charAt())&&r(d,p);break;case\"opacity\":k.gradient&&!k[a](\"stroke-opacity\")&&q(i,{\"stroke-opacity\":p>1?p/100:p});case\"fill-opacity\":if(k.gradient){I=c._g.doc.getElementById(i.getAttribute(\"fill\").replace(/^url\\(#|\\)$/g,l)),I&&(J=I.getElementsByTagName(\"stop\"),q(J[J.length-1],{\"stop-opacity\":p}));break}default:\"font-size\"==o&&(p=e(p,10)+\"px\");var K=o.replace(/(\\-.)/g,function(a){return a.substring(1).toUpperCase()});i.style[K]=p,d._.dirty=1,i.setAttribute(o,p)}}y(d,f),i.style.visibility=m},x=1.2,y=function(d,f){if(\"text\"==d.type&&(f[a](\"text\")||f[a](\"font\")||f[a](\"font-size\")||f[a](\"x\")||f[a](\"y\"))){var g=d.attrs,h=d.node,i=h.firstChild?e(c._g.doc.defaultView.getComputedStyle(h.firstChild,l).getPropertyValue(\"font-size\"),10):10;\r\nif(f[a](\"text\")){for(g.text=f.text;h.firstChild;)h.removeChild(h.firstChild);for(var j,k=b(f.text).split(\"\\n\"),m=[],n=0,o=k.length;o>n;n++)j=q(\"tspan\"),n&&q(j,{dy:i*x,x:g.x}),j.appendChild(c._g.doc.createTextNode(k[n])),h.appendChild(j),m[n]=j}else for(m=h.getElementsByTagName(\"tspan\"),n=0,o=m.length;o>n;n++)n?q(m[n],{dy:i*x,x:g.x}):q(m[0],{dy:0});q(h,{x:g.x,y:g.y}),d._.dirty=1;var p=d._getBBox(),r=g.y-(p.y+p.height/2);r&&c.is(r,\"finite\")&&q(m[0],{dy:r})}},z=function(a,b){this[0]=this.node=a,a.raphael=!0,this.id=c._oid++,a.raphaelid=this.id,this.matrix=c.matrix(),this.realPath=null,this.paper=b,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!b.bottom&&(b.bottom=this),this.prev=b.top,b.top&&(b.top.next=this),b.top=this,this.next=null},A=c.el;z.prototype=A,A.constructor=z,c._engine.path=function(a,b){var c=q(\"path\");b.canvas&&b.canvas.appendChild(c);var d=new z(c,b);return d.type=\"path\",w(d,{fill:\"none\",stroke:\"#000\",path:a}),d},A.rotate=function(a,c,e){if(this.removed)return this;if(a=b(a).split(j),a.length-1&&(c=d(a[1]),e=d(a[2])),a=d(a[0]),null==e&&(c=e),null==c||null==e){var f=this.getBBox(1);c=f.x+f.width/2,e=f.y+f.height/2}return this.transform(this._.transform.concat([[\"r\",a,c,e]])),this},A.scale=function(a,c,e,f){if(this.removed)return this;if(a=b(a).split(j),a.length-1&&(c=d(a[1]),e=d(a[2]),f=d(a[3])),a=d(a[0]),null==c&&(c=a),null==f&&(e=f),null==e||null==f)var g=this.getBBox(1);return e=null==e?g.x+g.width/2:e,f=null==f?g.y+g.height/2:f,this.transform(this._.transform.concat([[\"s\",a,c,e,f]])),this},A.translate=function(a,c){return this.removed?this:(a=b(a).split(j),a.length-1&&(c=d(a[1])),a=d(a[0])||0,c=+c||0,this.transform(this._.transform.concat([[\"t\",a,c]])),this)},A.transform=function(b){var d=this._;if(null==b)return d.transform;if(c._extractTransform(this,b),this.clip&&q(this.clip,{transform:this.matrix.invert()}),this.pattern&&s(this),this.node&&q(this.node,{transform:this.matrix}),1!=d.sx||1!=d.sy){var e=this.attrs[a](\"stroke-width\")?this.attrs[\"stroke-width\"]:1;this.attr({\"stroke-width\":e})}return this},A.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display=\"none\"),this},A.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=\"\"),this},A.remove=function(){if(!this.removed&&this.node.parentNode){var a=this.paper;a.__set__&&a.__set__.exclude(this),k.unbind(\"raphael.*.*.\"+this.id),this.gradient&&a.defs.removeChild(this.gradient),c._tear(this,a),\"a\"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var b in this)this[b]=\"function\"==typeof this[b]?c._removedFactory(b):null;this.removed=!0}},A._getBBox=function(){if(\"none\"==this.node.style.display){this.show();var a=!0}var b={};try{b=this.node.getBBox()}catch(c){}finally{b=b||{}}return a&&this.hide(),b},A.attr=function(b,d){if(this.removed)return this;if(null==b){var e={};for(var f in this.attrs)this.attrs[a](f)&&(e[f]=this.attrs[f]);return e.gradient&&\"none\"==e.fill&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(null==d&&c.is(b,\"string\")){if(\"fill\"==b&&\"none\"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if(\"transform\"==b)return this._.transform;for(var g=b.split(j),h={},i=0,l=g.length;l>i;i++)b=g[i],h[b]=b in this.attrs?this.attrs[b]:c.is(this.paper.customAttributes[b],\"function\")?this.paper.customAttributes[b].def:c._availableAttrs[b];return l-1?h:h[g[0]]}if(null==d&&c.is(b,\"array\")){for(h={},i=0,l=b.length;l>i;i++)h[b[i]]=this.attr(b[i]);return h}if(null!=d){var m={};m[b]=d}else null!=b&&c.is(b,\"object\")&&(m=b);for(var n in m)k(\"raphael.attr.\"+n+\".\"+this.id,this,m[n]);for(n in this.paper.customAttributes)if(this.paper.customAttributes[a](n)&&m[a](n)&&c.is(this.paper.customAttributes[n],\"function\")){var o=this.paper.customAttributes[n].apply(this,[].concat(m[n]));this.attrs[n]=m[n];for(var p in o)o[a](p)&&(m[p]=o[p])}return w(this,m),this},A.toFront=function(){if(this.removed)return this;\"a\"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var a=this.paper;return a.top!=this&&c._tofront(this,a),this},A.toBack=function(){if(this.removed)return this;var a=this.node.parentNode;\"a\"==a.tagName.toLowerCase()?a.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):a.firstChild!=this.node&&a.insertBefore(this.node,this.node.parentNode.firstChild),c._toback(this,this.paper);this.paper;return this},A.insertAfter=function(a){if(this.removed)return this;var b=a.node||a[a.length-1].node;return b.nextSibling?b.parentNode.insertBefore(this.node,b.nextSibling):b.parentNode.appendChild(this.node),c._insertafter(this,a,this.paper),this},A.insertBefore=function(a){if(this.removed)return this;var b=a.node||a[0].node;return b.parentNode.insertBefore(this.node,b),c._insertbefore(this,a,this.paper),this},A.blur=function(a){var b=this;if(0!==+a){var d=q(\"filter\"),e=q(\"feGaussianBlur\");b.attrs.blur=a,d.id=c.createUUID(),q(e,{stdDeviation:+a||1.5}),d.appendChild(e),b.paper.defs.appendChild(d),b._blur=d,q(b.node,{filter:\"url(#\"+d.id+\")\"})}else b._blur&&(b._blur.parentNode.removeChild(b._blur),delete b._blur,delete b.attrs.blur),b.node.removeAttribute(\"filter\");return b},c._engine.circle=function(a,b,c,d){var e=q(\"circle\");a.canvas&&a.canvas.appendChild(e);var f=new z(e,a);return f.attrs={cx:b,cy:c,r:d,fill:\"none\",stroke:\"#000\"},f.type=\"circle\",q(e,f.attrs),f},c._engine.rect=function(a,b,c,d,e,f){var g=q(\"rect\");a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);return h.attrs={x:b,y:c,width:d,height:e,r:f||0,rx:f||0,ry:f||0,fill:\"none\",stroke:\"#000\"},h.type=\"rect\",q(g,h.attrs),h},c._engine.ellipse=function(a,b,c,d,e){var f=q(\"ellipse\");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);return g.attrs={cx:b,cy:c,rx:d,ry:e,fill:\"none\",stroke:\"#000\"},g.type=\"ellipse\",q(f,g.attrs),g},c._engine.image=function(a,b,c,d,e,f){var g=q(\"image\");q(g,{x:c,y:d,width:e,height:f,preserveAspectRatio:\"none\"}),g.setAttributeNS(n,\"href\",b),a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);return h.attrs={x:c,y:d,width:e,height:f,src:b},h.type=\"image\",h},c._engine.text=function(a,b,d,e){var f=q(\"text\");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);return g.attrs={x:b,y:d,\"text-anchor\":\"middle\",text:e,font:c._availableAttrs.font,stroke:\"none\",fill:\"#000\"},g.type=\"text\",w(g,g.attrs),g},c._engine.setSize=function(a,b){return this.width=a||this.width,this.height=b||this.height,this.canvas.setAttribute(\"width\",this.width),this.canvas.setAttribute(\"height\",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},c._engine.create=function(){var a=c._getContainer.apply(0,arguments),b=a&&a.container,d=a.x,e=a.y,f=a.width,g=a.height;if(!b)throw new Error(\"SVG container not found.\");var h,i=q(\"svg\"),j=\"overflow:hidden;\";return d=d||0,e=e||0,f=f||512,g=g||342,q(i,{height:g,version:1.1,width:f,xmlns:\"http://www.w3.org/2000/svg\"}),1==b?(i.style.cssText=j+\"position:absolute;left:\"+d+\"px;top:\"+e+\"px\",c._g.doc.body.appendChild(i),h=1):(i.style.cssText=j+\"position:relative\",b.firstChild?b.insertBefore(i,b.firstChild):b.appendChild(i)),b=new c._Paper,b.width=f,b.height=g,b.canvas=i,b.clear(),b._left=b._top=0,h&&(b.renderfix=function(){}),b.renderfix(),b},c._engine.setViewBox=function(a,b,c,d,e){k(\"raphael.setViewBox\",this,this._viewBox,[a,b,c,d,e]);var f,h,i=g(c/this.width,d/this.height),j=this.top,l=e?\"xMidYMid meet\":\"xMinYMin\";for(null==a?(this._vbSize&&(i=1),delete this._vbSize,f=\"0 0 \"+this.width+m+this.height):(this._vbSize=i,f=a+m+b+m+c+m+d),q(this.canvas,{viewBox:f,preserveAspectRatio:l});i&&j;)h=\"stroke-width\"in j.attrs?j.attrs[\"stroke-width\"]:1,j.attr({\"stroke-width\":h}),j._.dirty=1,j._.dirtyT=1,j=j.prev;return this._viewBox=[a,b,c,d,!!e],this},c.prototype.renderfix=function(){var a,b=this.canvas,c=b.style;try{a=b.getScreenCTM()||b.createSVGMatrix()}catch(d){a=b.createSVGMatrix()}var e=-a.e%1,f=-a.f%1;(e||f)&&(e&&(this._left=(this._left+e)%1,c.left=this._left+\"px\"),f&&(this._top=(this._top+f)%1,c.top=this._top+\"px\"))},c.prototype.clear=function(){c.eve(\"raphael.clear\",this);for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null,(this.desc=q(\"desc\")).appendChild(c._g.doc.createTextNode(\"Created with Raphaël \"+c.version)),a.appendChild(this.desc),a.appendChild(this.defs=q(\"defs\"))},c.prototype.remove=function(){k(\"raphael.remove\",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=\"function\"==typeof this[a]?c._removedFactory(a):null};var B=c.st;for(var C in A)A[a](C)&&!B[a](C)&&(B[C]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(C))}}(),function(){if(c.vml){var a=\"hasOwnProperty\",b=String,d=parseFloat,e=Math,f=e.round,g=e.max,h=e.min,i=e.abs,j=\"fill\",k=/[, ]+/,l=c.eve,m=\" progid:DXImageTransform.Microsoft\",n=\" \",o=\"\",p={M:\"m\",L:\"l\",C:\"c\",Z:\"x\",m:\"t\",l:\"r\",c:\"v\",z:\"x\"},q=/([clmz]),?([^clmz]*)/gi,r=/ progid:\\S+Blur\\([^\\)]+\\)/g,s=/-?[^,\\s-]+/g,t=\"position:absolute;left:0;top:0;width:1px;height:1px\",u=21600,v={path:1,rect:1,image:1},w={circle:1,ellipse:1},x=function(a){var d=/[ahqstv]/gi,e=c._pathToAbsolute;if(b(a).match(d)&&(e=c._path2curve),d=/[clmz]/g,e==c._pathToAbsolute&&!b(a).match(d)){var g=b(a).replace(q,function(a,b,c){var d=[],e=\"m\"==b.toLowerCase(),g=p[b];return c.replace(s,function(a){e&&2==d.length&&(g+=d+p[\"m\"==b?\"l\":\"L\"],d=[]),d.push(f(a*u))}),g+d});return g}var h,i,j=e(a);g=[];for(var k=0,l=j.length;l>k;k++){h=j[k],i=j[k][0].toLowerCase(),\"z\"==i&&(i=\"x\");for(var m=1,r=h.length;r>m;m++)i+=f(h[m]*u)+(m!=r-1?\",\":o);g.push(i)}return g.join(n)},y=function(a,b,d){var e=c.matrix();return e.rotate(-a,.5,.5),{dx:e.x(b,d),dy:e.y(b,d)}},z=function(a,b,c,d,e,f){var g=a._,h=a.matrix,k=g.fillpos,l=a.node,m=l.style,o=1,p=\"\",q=u/b,r=u/c;if(m.visibility=\"hidden\",b&&c){if(l.coordsize=i(q)+n+i(r),m.rotation=f*(0>b*c?-1:1),f){var s=y(f,d,e);d=s.dx,e=s.dy}if(0>b&&(p+=\"x\"),0>c&&(p+=\" y\")&&(o=-1),m.flip=p,l.coordorigin=d*-q+n+e*-r,k||g.fillsize){var t=l.getElementsByTagName(j);t=t&&t[0],l.removeChild(t),k&&(s=y(f,h.x(k[0],k[1]),h.y(k[0],k[1])),t.position=s.dx*o+n+s.dy*o),g.fillsize&&(t.size=g.fillsize[0]*i(b)+n+g.fillsize[1]*i(c)),l.appendChild(t)}m.visibility=\"visible\"}};c.toString=function(){return\"Your browser doesn’t support SVG. Falling down to VML.\\nYou are running Raphaël \"+this.version};var A=function(a,c,d){for(var e=b(c).toLowerCase().split(\"-\"),f=d?\"end\":\"start\",g=e.length,h=\"classic\",i=\"medium\",j=\"medium\";g--;)switch(e[g]){case\"block\":case\"classic\":case\"oval\":case\"diamond\":case\"open\":case\"none\":h=e[g];break;case\"wide\":case\"narrow\":j=e[g];break;case\"long\":case\"short\":i=e[g]}var k=a.node.getElementsByTagName(\"stroke\")[0];k[f+\"arrow\"]=h,k[f+\"arrowlength\"]=i,k[f+\"arrowwidth\"]=j},B=function(e,i){e.attrs=e.attrs||{};var l=e.node,m=e.attrs,p=l.style,q=v[e.type]&&(i.x!=m.x||i.y!=m.y||i.width!=m.width||i.height!=m.height||i.cx!=m.cx||i.cy!=m.cy||i.rx!=m.rx||i.ry!=m.ry||i.r!=m.r),r=w[e.type]&&(m.cx!=i.cx||m.cy!=i.cy||m.r!=i.r||m.rx!=i.rx||m.ry!=i.ry),s=e;for(var t in i)i[a](t)&&(m[t]=i[t]);if(q&&(m.path=c._getPath[e.type](e),e._.dirty=1),i.href&&(l.href=i.href),i.title&&(l.title=i.title),i.target&&(l.target=i.target),i.cursor&&(p.cursor=i.cursor),\"blur\"in i&&e.blur(i.blur),(i.path&&\"path\"==e.type||q)&&(l.path=x(~b(m.path).toLowerCase().indexOf(\"r\")?c._pathToAbsolute(m.path):m.path),\"image\"==e.type&&(e._.fillpos=[m.x,m.y],e._.fillsize=[m.width,m.height],z(e,1,1,0,0,0))),\"transform\"in i&&e.transform(i.transform),r){var y=+m.cx,B=+m.cy,D=+m.rx||+m.r||0,E=+m.ry||+m.r||0;l.path=c.format(\"ar{0},{1},{2},{3},{4},{1},{4},{1}x\",f((y-D)*u),f((B-E)*u),f((y+D)*u),f((B+E)*u),f(y*u)),e._.dirty=1}if(\"clip-rect\"in i){var G=b(i[\"clip-rect\"]).split(k);if(4==G.length){G[2]=+G[2]+ +G[0],G[3]=+G[3]+ +G[1];var H=l.clipRect||c._g.doc.createElement(\"div\"),I=H.style;I.clip=c.format(\"rect({1}px {2}px {3}px {0}px)\",G),l.clipRect||(I.position=\"absolute\",I.top=0,I.left=0,I.width=e.paper.width+\"px\",I.height=e.paper.height+\"px\",l.parentNode.insertBefore(H,l),H.appendChild(l),l.clipRect=H)}i[\"clip-rect\"]||l.clipRect&&(l.clipRect.style.clip=\"auto\")}if(e.textpath){var J=e.textpath.style;i.font&&(J.font=i.font),i[\"font-family\"]&&(J.fontFamily='\"'+i[\"font-family\"].split(\",\")[0].replace(/^['\"]+|['\"]+$/g,o)+'\"'),i[\"font-size\"]&&(J.fontSize=i[\"font-size\"]),i[\"font-weight\"]&&(J.fontWeight=i[\"font-weight\"]),i[\"font-style\"]&&(J.fontStyle=i[\"font-style\"])}if(\"arrow-start\"in i&&A(s,i[\"arrow-start\"]),\"arrow-end\"in i&&A(s,i[\"arrow-end\"],1),null!=i.opacity||null!=i[\"stroke-width\"]||null!=i.fill||null!=i.src||null!=i.stroke||null!=i[\"stroke-width\"]||null!=i[\"stroke-opacity\"]||null!=i[\"fill-opacity\"]||null!=i[\"stroke-dasharray\"]||null!=i[\"stroke-miterlimit\"]||null!=i[\"stroke-linejoin\"]||null!=i[\"stroke-linecap\"]){var K=l.getElementsByTagName(j),L=!1;if(K=K&&K[0],!K&&(L=K=F(j)),\"image\"==e.type&&i.src&&(K.src=i.src),i.fill&&(K.on=!0),(null==K.on||\"none\"==i.fill||null===i.fill)&&(K.on=!1),K.on&&i.fill){var M=b(i.fill).match(c._ISURL);if(M){K.parentNode==l&&l.removeChild(K),K.rotate=!0,K.src=M[1],K.type=\"tile\";var N=e.getBBox(1);K.position=N.x+n+N.y,e._.fillpos=[N.x,N.y],c._preload(M[1],function(){e._.fillsize=[this.offsetWidth,this.offsetHeight]})}else K.color=c.getRGB(i.fill).hex,K.src=o,K.type=\"solid\",c.getRGB(i.fill).error&&(s.type in{circle:1,ellipse:1}||\"r\"!=b(i.fill).charAt())&&C(s,i.fill,K)&&(m.fill=\"none\",m.gradient=i.fill,K.rotate=!1)}if(\"fill-opacity\"in i||\"opacity\"in i){var O=((+m[\"fill-opacity\"]+1||2)-1)*((+m.opacity+1||2)-1)*((+c.getRGB(i.fill).o+1||2)-1);O=h(g(O,0),1),K.opacity=O,K.src&&(K.color=\"none\")}l.appendChild(K);var P=l.getElementsByTagName(\"stroke\")&&l.getElementsByTagName(\"stroke\")[0],Q=!1;!P&&(Q=P=F(\"stroke\")),(i.stroke&&\"none\"!=i.stroke||i[\"stroke-width\"]||null!=i[\"stroke-opacity\"]||i[\"stroke-dasharray\"]||i[\"stroke-miterlimit\"]||i[\"stroke-linejoin\"]||i[\"stroke-linecap\"])&&(P.on=!0),(\"none\"==i.stroke||null===i.stroke||null==P.on||0==i.stroke||0==i[\"stroke-width\"])&&(P.on=!1);var R=c.getRGB(i.stroke);P.on&&i.stroke&&(P.color=R.hex),O=((+m[\"stroke-opacity\"]+1||2)-1)*((+m.opacity+1||2)-1)*((+R.o+1||2)-1);var S=.75*(d(i[\"stroke-width\"])||1);if(O=h(g(O,0),1),null==i[\"stroke-width\"]&&(S=m[\"stroke-width\"]),i[\"stroke-width\"]&&(P.weight=S),S&&1>S&&(O*=S)&&(P.weight=1),P.opacity=O,i[\"stroke-linejoin\"]&&(P.joinstyle=i[\"stroke-linejoin\"]||\"miter\"),P.miterlimit=i[\"stroke-miterlimit\"]||8,i[\"stroke-linecap\"]&&(P.endcap=\"butt\"==i[\"stroke-linecap\"]?\"flat\":\"square\"==i[\"stroke-linecap\"]?\"square\":\"round\"),\"stroke-dasharray\"in i){var T={\"-\":\"shortdash\",\".\":\"shortdot\",\"-.\":\"shortdashdot\",\"-..\":\"shortdashdotdot\",\". \":\"dot\",\"- \":\"dash\",\"--\":\"longdash\",\"- .\":\"dashdot\",\"--.\":\"longdashdot\",\"--..\":\"longdashdotdot\"};P.dashstyle=T[a](i[\"stroke-dasharray\"])?T[i[\"stroke-dasharray\"]]:o}Q&&l.appendChild(P)}if(\"text\"==s.type){s.paper.canvas.style.display=o;var U=s.paper.span,V=100,W=m.font&&m.font.match(/\\d+(?:\\.\\d*)?(?=px)/);p=U.style,m.font&&(p.font=m.font),m[\"font-family\"]&&(p.fontFamily=m[\"font-family\"]),m[\"font-weight\"]&&(p.fontWeight=m[\"font-weight\"]),m[\"font-style\"]&&(p.fontStyle=m[\"font-style\"]),W=d(m[\"font-size\"]||W&&W[0])||10,p.fontSize=W*V+\"px\",s.textpath.string&&(U.innerHTML=b(s.textpath.string).replace(/</g,\"&#60;\").replace(/&/g,\"&#38;\").replace(/\\n/g,\"<br>\"));var X=U.getBoundingClientRect();s.W=m.w=(X.right-X.left)/V,s.H=m.h=(X.bottom-X.top)/V,s.X=m.x,s.Y=m.y+s.H/2,(\"x\"in i||\"y\"in i)&&(s.path.v=c.format(\"m{0},{1}l{2},{1}\",f(m.x*u),f(m.y*u),f(m.x*u)+1));for(var Y=[\"x\",\"y\",\"text\",\"font\",\"font-family\",\"font-weight\",\"font-style\",\"font-size\"],Z=0,$=Y.length;$>Z;Z++)if(Y[Z]in i){s._.dirty=1;break}switch(m[\"text-anchor\"]){case\"start\":s.textpath.style[\"v-text-align\"]=\"left\",s.bbx=s.W/2;break;case\"end\":s.textpath.style[\"v-text-align\"]=\"right\",s.bbx=-s.W/2;break;default:s.textpath.style[\"v-text-align\"]=\"center\",s.bbx=0}s.textpath.style[\"v-text-kern\"]=!0}},C=function(a,f,g){a.attrs=a.attrs||{};var h=(a.attrs,Math.pow),i=\"linear\",j=\".5 .5\";if(a.attrs.gradient=f,f=b(f).replace(c._radial_gradient,function(a,b,c){return i=\"radial\",b&&c&&(b=d(b),c=d(c),h(b-.5,2)+h(c-.5,2)>.25&&(c=e.sqrt(.25-h(b-.5,2))*(2*(c>.5)-1)+.5),j=b+n+c),o}),f=f.split(/\\s*\\-\\s*/),\"linear\"==i){var k=f.shift();if(k=-d(k),isNaN(k))return null}var l=c._parseDots(f);if(!l)return null;if(a=a.shape||a.node,l.length){a.removeChild(g),g.on=!0,g.method=\"none\",g.color=l[0].color,g.color2=l[l.length-1].color;for(var m=[],p=0,q=l.length;q>p;p++)l[p].offset&&m.push(l[p].offset+n+l[p].color);g.colors=m.length?m.join():\"0% \"+g.color,\"radial\"==i?(g.type=\"gradientTitle\",g.focus=\"100%\",g.focussize=\"0 0\",g.focusposition=j,g.angle=0):(g.type=\"gradient\",g.angle=(270-k)%360),a.appendChild(g)}return 1},D=function(a,b){this[0]=this.node=a,a.raphael=!0,this.id=c._oid++,a.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=b,this.matrix=c.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!b.bottom&&(b.bottom=this),this.prev=b.top,b.top&&(b.top.next=this),b.top=this,this.next=null},E=c.el;D.prototype=E,E.constructor=D,E.transform=function(a){if(null==a)return this._.transform;var d,e=this.paper._viewBoxShift,f=e?\"s\"+[e.scale,e.scale]+\"-1-1t\"+[e.dx,e.dy]:o;e&&(d=a=b(a).replace(/\\.{3}|\\u2026/g,this._.transform||o)),c._extractTransform(this,f+a);var g,h=this.matrix.clone(),i=this.skew,j=this.node,k=~b(this.attrs.fill).indexOf(\"-\"),l=!b(this.attrs.fill).indexOf(\"url(\");if(h.translate(1,1),l||k||\"image\"==this.type)if(i.matrix=\"1 0 0 1\",i.offset=\"0 0\",g=h.split(),k&&g.noRotation||!g.isSimple){j.style.filter=h.toFilter();var m=this.getBBox(),p=this.getBBox(1),q=m.x-p.x,r=m.y-p.y;j.coordorigin=q*-u+n+r*-u,z(this,1,1,q,r,0)}else j.style.filter=o,z(this,g.scalex,g.scaley,g.dx,g.dy,g.rotate);else j.style.filter=o,i.matrix=b(h),i.offset=h.offset();return d&&(this._.transform=d),this},E.rotate=function(a,c,e){if(this.removed)return this;if(null!=a){if(a=b(a).split(k),a.length-1&&(c=d(a[1]),e=d(a[2])),a=d(a[0]),null==e&&(c=e),null==c||null==e){var f=this.getBBox(1);c=f.x+f.width/2,e=f.y+f.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([[\"r\",a,c,e]])),this}},E.translate=function(a,c){return this.removed?this:(a=b(a).split(k),a.length-1&&(c=d(a[1])),a=d(a[0])||0,c=+c||0,this._.bbox&&(this._.bbox.x+=a,this._.bbox.y+=c),this.transform(this._.transform.concat([[\"t\",a,c]])),this)},E.scale=function(a,c,e,f){if(this.removed)return this;if(a=b(a).split(k),a.length-1&&(c=d(a[1]),e=d(a[2]),f=d(a[3]),isNaN(e)&&(e=null),isNaN(f)&&(f=null)),a=d(a[0]),null==c&&(c=a),null==f&&(e=f),null==e||null==f)var g=this.getBBox(1);return e=null==e?g.x+g.width/2:e,f=null==f?g.y+g.height/2:f,this.transform(this._.transform.concat([[\"s\",a,c,e,f]])),this._.dirtyT=1,this},E.hide=function(){return!this.removed&&(this.node.style.display=\"none\"),this},E.show=function(){return!this.removed&&(this.node.style.display=o),this},E._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},E.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),c.eve.unbind(\"raphael.*.*.\"+this.id),c._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)this[a]=\"function\"==typeof this[a]?c._removedFactory(a):null;this.removed=!0}},E.attr=function(b,d){if(this.removed)return this;if(null==b){var e={};for(var f in this.attrs)this.attrs[a](f)&&(e[f]=this.attrs[f]);return e.gradient&&\"none\"==e.fill&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(null==d&&c.is(b,\"string\")){if(b==j&&\"none\"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var g=b.split(k),h={},i=0,m=g.length;m>i;i++)b=g[i],h[b]=b in this.attrs?this.attrs[b]:c.is(this.paper.customAttributes[b],\"function\")?this.paper.customAttributes[b].def:c._availableAttrs[b];return m-1?h:h[g[0]]}if(this.attrs&&null==d&&c.is(b,\"array\")){for(h={},i=0,m=b.length;m>i;i++)h[b[i]]=this.attr(b[i]);return h}var n;null!=d&&(n={},n[b]=d),null==d&&c.is(b,\"object\")&&(n=b);for(var o in n)l(\"raphael.attr.\"+o+\".\"+this.id,this,n[o]);if(n){for(o in this.paper.customAttributes)if(this.paper.customAttributes[a](o)&&n[a](o)&&c.is(this.paper.customAttributes[o],\"function\")){var p=this.paper.customAttributes[o].apply(this,[].concat(n[o]));this.attrs[o]=n[o];for(var q in p)p[a](q)&&(n[q]=p[q])}n.text&&\"text\"==this.type&&(this.textpath.string=n.text),B(this,n)}return this},E.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&c._tofront(this,this.paper),this},E.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),c._toback(this,this.paper)),this)},E.insertAfter=function(a){return this.removed?this:(a.constructor==c.st.constructor&&(a=a[a.length-1]),a.node.nextSibling?a.node.parentNode.insertBefore(this.node,a.node.nextSibling):a.node.parentNode.appendChild(this.node),c._insertafter(this,a,this.paper),this)},E.insertBefore=function(a){return this.removed?this:(a.constructor==c.st.constructor&&(a=a[0]),a.node.parentNode.insertBefore(this.node,a.node),c._insertbefore(this,a,this.paper),this)},E.blur=function(a){var b=this.node.runtimeStyle,d=b.filter;return d=d.replace(r,o),0!==+a?(this.attrs.blur=a,b.filter=d+n+m+\".Blur(pixelradius=\"+(+a||1.5)+\")\",b.margin=c.format(\"-{0}px 0 0 -{0}px\",f(+a||1.5))):(b.filter=d,b.margin=0,delete this.attrs.blur),this},c._engine.path=function(a,b){var c=F(\"shape\");c.style.cssText=t,c.coordsize=u+n+u,c.coordorigin=b.coordorigin;var d=new D(c,b),e={fill:\"none\",stroke:\"#000\"};a&&(e.path=a),d.type=\"path\",d.path=[],d.Path=o,B(d,e),b.canvas.appendChild(c);var f=F(\"skew\");return f.on=!0,c.appendChild(f),d.skew=f,d.transform(o),d},c._engine.rect=function(a,b,d,e,f,g){var h=c._rectPath(b,d,e,f,g),i=a.path(h),j=i.attrs;return i.X=j.x=b,i.Y=j.y=d,i.W=j.width=e,i.H=j.height=f,j.r=g,j.path=h,i.type=\"rect\",i},c._engine.ellipse=function(a,b,c,d,e){{var f=a.path();f.attrs}return f.X=b-d,f.Y=c-e,f.W=2*d,f.H=2*e,f.type=\"ellipse\",B(f,{cx:b,cy:c,rx:d,ry:e}),f},c._engine.circle=function(a,b,c,d){{var e=a.path();e.attrs}return e.X=b-d,e.Y=c-d,e.W=e.H=2*d,e.type=\"circle\",B(e,{cx:b,cy:c,r:d}),e},c._engine.image=function(a,b,d,e,f,g){var h=c._rectPath(d,e,f,g),i=a.path(h).attr({stroke:\"none\"}),k=i.attrs,l=i.node,m=l.getElementsByTagName(j)[0];return k.src=b,i.X=k.x=d,i.Y=k.y=e,i.W=k.width=f,i.H=k.height=g,k.path=h,i.type=\"image\",m.parentNode==l&&l.removeChild(m),m.rotate=!0,m.src=b,m.type=\"tile\",i._.fillpos=[d,e],i._.fillsize=[f,g],l.appendChild(m),z(i,1,1,0,0,0),i},c._engine.text=function(a,d,e,g){var h=F(\"shape\"),i=F(\"path\"),j=F(\"textpath\");d=d||0,e=e||0,g=g||\"\",i.v=c.format(\"m{0},{1}l{2},{1}\",f(d*u),f(e*u),f(d*u)+1),i.textpathok=!0,j.string=b(g),j.on=!0,h.style.cssText=t,h.coordsize=u+n+u,h.coordorigin=\"0 0\";var k=new D(h,a),l={fill:\"#000\",stroke:\"none\",font:c._availableAttrs.font,text:g};k.shape=h,k.path=i,k.textpath=j,k.type=\"text\",k.attrs.text=b(g),k.attrs.x=d,k.attrs.y=e,k.attrs.w=1,k.attrs.h=1,B(k,l),h.appendChild(j),h.appendChild(i),a.canvas.appendChild(h);var m=F(\"skew\");return m.on=!0,h.appendChild(m),k.skew=m,k.transform(o),k},c._engine.setSize=function(a,b){var d=this.canvas.style;return this.width=a,this.height=b,a==+a&&(a+=\"px\"),b==+b&&(b+=\"px\"),d.width=a,d.height=b,d.clip=\"rect(0 \"+a+\" \"+b+\" 0)\",this._viewBox&&c._engine.setViewBox.apply(this,this._viewBox),this},c._engine.setViewBox=function(a,b,d,e,f){c.eve(\"raphael.setViewBox\",this,this._viewBox,[a,b,d,e,f]);var h,i,j=this.width,k=this.height,l=1/g(d/j,e/k);return f&&(h=k/e,i=j/d,j>d*h&&(a-=(j-d*h)/2/h),k>e*i&&(b-=(k-e*i)/2/i)),this._viewBox=[a,b,d,e,!!f],this._viewBoxShift={dx:-a,dy:-b,scale:l},this.forEach(function(a){a.transform(\"...\")}),this};var F;c._engine.initWin=function(a){var b=a.document;b.createStyleSheet().addRule(\".rvml\",\"behavior:url(#default#VML)\");try{!b.namespaces.rvml&&b.namespaces.add(\"rvml\",\"urn:schemas-microsoft-com:vml\"),F=function(a){return b.createElement(\"<rvml:\"+a+' class=\"rvml\">')}}catch(c){F=function(a){return b.createElement(\"<\"+a+' xmlns=\"urn:schemas-microsoft.com:vml\" class=\"rvml\">')}}},c._engine.initWin(c._g.win),c._engine.create=function(){var a=c._getContainer.apply(0,arguments),b=a.container,d=a.height,e=a.width,f=a.x,g=a.y;if(!b)throw new Error(\"VML container not found.\");var h=new c._Paper,i=h.canvas=c._g.doc.createElement(\"div\"),j=i.style;return f=f||0,g=g||0,e=e||512,d=d||342,h.width=e,h.height=d,e==+e&&(e+=\"px\"),d==+d&&(d+=\"px\"),h.coordsize=1e3*u+n+1e3*u,h.coordorigin=\"0 0\",h.span=c._g.doc.createElement(\"span\"),h.span.style.cssText=\"position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;\",i.appendChild(h.span),j.cssText=c.format(\"top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden\",e,d),1==b?(c._g.doc.body.appendChild(i),j.left=f+\"px\",j.top=g+\"px\",j.position=\"absolute\"):b.firstChild?b.insertBefore(i,b.firstChild):b.appendChild(i),h.renderfix=function(){},h},c.prototype.clear=function(){c.eve(\"raphael.clear\",this),this.canvas.innerHTML=o,this.span=c._g.doc.createElement(\"span\"),this.span.style.cssText=\"position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;\",this.canvas.appendChild(this.span),this.bottom=this.top=null},c.prototype.remove=function(){c.eve(\"raphael.remove\",this),this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=\"function\"==typeof this[a]?c._removedFactory(a):null;return!0};var G=c.st;for(var H in E)E[a](H)&&!G[a](H)&&(G[H]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(H))}}(),B.was?A.win.Raphael=c:Raphael=c,c});\n",
    "/* @license\r\nmorris.js v0.5.0\r\nCopyright 2014 Olly Smith All rights reserved.\r\nLicensed under the BSD-2-Clause License.\r\n*/\r\n(function(){var a,b,c,d,e=[].slice,f=function(a,b){return function(){return a.apply(b,arguments)}},g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b=window.Morris={},a=jQuery,b.EventEmitter=function(){function a(){}return a.prototype.on=function(a,b){return null==this.handlers&&(this.handlers={}),null==this.handlers[a]&&(this.handlers[a]=[]),this.handlers[a].push(b),this},a.prototype.fire=function(){var a,b,c,d,f,g,h;if(c=arguments[0],a=2<=arguments.length?e.call(arguments,1):[],null!=this.handlers&&null!=this.handlers[c]){for(g=this.handlers[c],h=[],d=0,f=g.length;f>d;d++)b=g[d],h.push(b.apply(null,a));return h}},a}(),b.commas=function(a){var b,c,d,e;return null!=a?(d=0>a?\"-\":\"\",b=Math.abs(a),c=Math.floor(b).toFixed(0),d+=c.replace(/(?=(?:\\d{3})+$)(?!^)/g,\",\"),e=b.toString(),e.length>c.length&&(d+=e.slice(c.length)),d):\"-\"},b.pad2=function(a){return(10>a?\"0\":\"\")+a},b.Grid=function(c){function d(b){this.resizeHandler=f(this.resizeHandler,this);var c=this;if(this.el=\"string\"==typeof b.element?a(document.getElementById(b.element)):a(b.element),null==this.el||0===this.el.length)throw new Error(\"Graph container element not found\");\"static\"===this.el.css(\"position\")&&this.el.css(\"position\",\"relative\"),this.options=a.extend({},this.gridDefaults,this.defaults||{},b),\"string\"==typeof this.options.units&&(this.options.postUnits=b.units),this.raphael=new Raphael(this.el[0]),this.elementWidth=null,this.elementHeight=null,this.dirty=!1,this.selectFrom=null,this.init&&this.init(),this.setData(this.options.data),this.el.bind(\"mousemove\",function(a){var b,d,e,f,g;return d=c.el.offset(),g=a.pageX-d.left,c.selectFrom?(b=c.data[c.hitTest(Math.min(g,c.selectFrom))]._x,e=c.data[c.hitTest(Math.max(g,c.selectFrom))]._x,f=e-b,c.selectionRect.attr({x:b,width:f})):c.fire(\"hovermove\",g,a.pageY-d.top)}),this.el.bind(\"mouseleave\",function(){return c.selectFrom&&(c.selectionRect.hide(),c.selectFrom=null),c.fire(\"hoverout\")}),this.el.bind(\"touchstart touchmove touchend\",function(a){var b,d;return d=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0],b=c.el.offset(),c.fire(\"hovermove\",d.pageX-b.left,d.pageY-b.top)}),this.el.bind(\"click\",function(a){var b;return b=c.el.offset(),c.fire(\"gridclick\",a.pageX-b.left,a.pageY-b.top)}),this.options.rangeSelect&&(this.selectionRect=this.raphael.rect(0,0,0,this.el.innerHeight()).attr({fill:this.options.rangeSelectColor,stroke:!1}).toBack().hide(),this.el.bind(\"mousedown\",function(a){var b;return b=c.el.offset(),c.startRange(a.pageX-b.left)}),this.el.bind(\"mouseup\",function(a){var b;return b=c.el.offset(),c.endRange(a.pageX-b.left),c.fire(\"hovermove\",a.pageX-b.left,a.pageY-b.top)})),this.options.resize&&a(window).bind(\"resize\",function(){return null!=c.timeoutId&&window.clearTimeout(c.timeoutId),c.timeoutId=window.setTimeout(c.resizeHandler,100)}),this.el.css(\"-webkit-tap-highlight-color\",\"rgba(0,0,0,0)\"),this.postInit&&this.postInit()}return h(d,c),d.prototype.gridDefaults={dateFormat:null,axes:!0,grid:!0,gridLineColor:\"#aaa\",gridStrokeWidth:.5,gridTextColor:\"#888\",gridTextSize:12,gridTextFamily:\"sans-serif\",gridTextWeight:\"normal\",hideHover:!1,yLabelFormat:null,xLabelAngle:0,numLines:5,padding:25,parseTime:!0,postUnits:\"\",preUnits:\"\",ymax:\"auto\",ymin:\"auto 0\",goals:[],goalStrokeWidth:1,goalLineColors:[\"#666633\",\"#999966\",\"#cc6666\",\"#663333\"],events:[],eventStrokeWidth:1,eventLineColors:[\"#005a04\",\"#ccffbb\",\"#3a5f0b\",\"#005502\"],rangeSelect:null,rangeSelectColor:\"#eef\",resize:!1},d.prototype.setData=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;return null==c&&(c=!0),this.options.data=a,null==a||0===a.length?(this.data=[],this.raphael.clear(),null!=this.hover&&this.hover.hide(),void 0):(o=this.cumulative?0:null,p=this.cumulative?0:null,this.options.goals.length>0&&(h=Math.min.apply(Math,this.options.goals),g=Math.max.apply(Math,this.options.goals),p=null!=p?Math.min(p,h):h,o=null!=o?Math.max(o,g):g),this.data=function(){var c,d,g;for(g=[],f=c=0,d=a.length;d>c;f=++c)j=a[f],i={src:j},i.label=j[this.options.xkey],this.options.parseTime?(i.x=b.parseDate(i.label),this.options.dateFormat?i.label=this.options.dateFormat(i.x):\"number\"==typeof i.label&&(i.label=new Date(i.label).toString())):(i.x=f,this.options.xLabelFormat&&(i.label=this.options.xLabelFormat(i))),l=0,i.y=function(){var a,b,c,d;for(c=this.options.ykeys,d=[],e=a=0,b=c.length;b>a;e=++a)n=c[e],q=j[n],\"string\"==typeof q&&(q=parseFloat(q)),null!=q&&\"number\"!=typeof q&&(q=null),null!=q&&(this.cumulative?l+=q:null!=o?(o=Math.max(q,o),p=Math.min(q,p)):o=p=q),this.cumulative&&null!=l&&(o=Math.max(l,o),p=Math.min(l,p)),d.push(q);return d}.call(this),g.push(i);return g}.call(this),this.options.parseTime&&(this.data=this.data.sort(function(a,b){return(a.x>b.x)-(b.x>a.x)})),this.xmin=this.data[0].x,this.xmax=this.data[this.data.length-1].x,this.events=[],this.options.events.length>0&&(this.events=this.options.parseTime?function(){var a,c,e,f;for(e=this.options.events,f=[],a=0,c=e.length;c>a;a++)d=e[a],f.push(b.parseDate(d));return f}.call(this):this.options.events,this.xmax=Math.max(this.xmax,Math.max.apply(Math,this.events)),this.xmin=Math.min(this.xmin,Math.min.apply(Math,this.events))),this.xmin===this.xmax&&(this.xmin-=1,this.xmax+=1),this.ymin=this.yboundary(\"min\",p),this.ymax=this.yboundary(\"max\",o),this.ymin===this.ymax&&(p&&(this.ymin-=1),this.ymax+=1),((r=this.options.axes)===!0||\"both\"===r||\"y\"===r||this.options.grid===!0)&&(this.options.ymax===this.gridDefaults.ymax&&this.options.ymin===this.gridDefaults.ymin?(this.grid=this.autoGridLines(this.ymin,this.ymax,this.options.numLines),this.ymin=Math.min(this.ymin,this.grid[0]),this.ymax=Math.max(this.ymax,this.grid[this.grid.length-1])):(k=(this.ymax-this.ymin)/(this.options.numLines-1),this.grid=function(){var a,b,c,d;for(d=[],m=a=b=this.ymin,c=this.ymax;k>0?c>=a:a>=c;m=a+=k)d.push(m);return d}.call(this))),this.dirty=!0,c?this.redraw():void 0)},d.prototype.yboundary=function(a,b){var c,d;return c=this.options[\"y\"+a],\"string\"==typeof c?\"auto\"===c.slice(0,4)?c.length>5?(d=parseInt(c.slice(5),10),null==b?d:Math[a](b,d)):null!=b?b:0:parseInt(c,10):c},d.prototype.autoGridLines=function(a,b,c){var d,e,f,g,h,i,j,k,l;return h=b-a,l=Math.floor(Math.log(h)/Math.log(10)),j=Math.pow(10,l),e=Math.floor(a/j)*j,d=Math.ceil(b/j)*j,i=(d-e)/(c-1),1===j&&i>1&&Math.ceil(i)!==i&&(i=Math.ceil(i),d=e+i*(c-1)),0>e&&d>0&&(e=Math.floor(a/i)*i,d=Math.ceil(b/i)*i),1>i?(g=Math.floor(Math.log(i)/Math.log(10)),f=function(){var a,b;for(b=[],k=a=e;i>0?d>=a:a>=d;k=a+=i)b.push(parseFloat(k.toFixed(1-g)));return b}()):f=function(){var a,b;for(b=[],k=a=e;i>0?d>=a:a>=d;k=a+=i)b.push(k);return b}(),f},d.prototype._calc=function(){var a,b,c,d,e,f,g,h;return e=this.el.width(),c=this.el.height(),(this.elementWidth!==e||this.elementHeight!==c||this.dirty)&&(this.elementWidth=e,this.elementHeight=c,this.dirty=!1,this.left=this.options.padding,this.right=this.elementWidth-this.options.padding,this.top=this.options.padding,this.bottom=this.elementHeight-this.options.padding,((g=this.options.axes)===!0||\"both\"===g||\"y\"===g)&&(f=function(){var a,c,d,e;for(d=this.grid,e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(this.measureText(this.yAxisFormat(b)).width);return e}.call(this),this.left+=Math.max.apply(Math,f)),((h=this.options.axes)===!0||\"both\"===h||\"x\"===h)&&(a=function(){var a,b,c;for(c=[],d=a=0,b=this.data.length;b>=0?b>a:a>b;d=b>=0?++a:--a)c.push(this.measureText(this.data[d].text,-this.options.xLabelAngle).height);return c}.call(this),this.bottom-=Math.max.apply(Math,a)),this.width=Math.max(1,this.right-this.left),this.height=Math.max(1,this.bottom-this.top),this.dx=this.width/(this.xmax-this.xmin),this.dy=this.height/(this.ymax-this.ymin),this.calc)?this.calc():void 0},d.prototype.transY=function(a){return this.bottom-(a-this.ymin)*this.dy},d.prototype.transX=function(a){return 1===this.data.length?(this.left+this.right)/2:this.left+(a-this.xmin)*this.dx},d.prototype.redraw=function(){return this.raphael.clear(),this._calc(),this.drawGrid(),this.drawGoals(),this.drawEvents(),this.draw?this.draw():void 0},d.prototype.measureText=function(a,b){var c,d;return null==b&&(b=0),d=this.raphael.text(100,100,a).attr(\"font-size\",this.options.gridTextSize).attr(\"font-family\",this.options.gridTextFamily).attr(\"font-weight\",this.options.gridTextWeight).rotate(b),c=d.getBBox(),d.remove(),c},d.prototype.yAxisFormat=function(a){return this.yLabelFormat(a)},d.prototype.yLabelFormat=function(a){return\"function\"==typeof this.options.yLabelFormat?this.options.yLabelFormat(a):\"\"+this.options.preUnits+b.commas(a)+this.options.postUnits},d.prototype.drawGrid=function(){var a,b,c,d,e,f,g,h;if(this.options.grid!==!1||(e=this.options.axes)===!0||\"both\"===e||\"y\"===e){for(f=this.grid,h=[],c=0,d=f.length;d>c;c++)a=f[c],b=this.transY(a),((g=this.options.axes)===!0||\"both\"===g||\"y\"===g)&&this.drawYAxisLabel(this.left-this.options.padding/2,b,this.yAxisFormat(a)),this.options.grid?h.push(this.drawGridLine(\"M\"+this.left+\",\"+b+\"H\"+(this.left+this.width))):h.push(void 0);return h}},d.prototype.drawGoals=function(){var a,b,c,d,e,f,g;for(f=this.options.goals,g=[],c=d=0,e=f.length;e>d;c=++d)b=f[c],a=this.options.goalLineColors[c%this.options.goalLineColors.length],g.push(this.drawGoal(b,a));return g},d.prototype.drawEvents=function(){var a,b,c,d,e,f,g;for(f=this.events,g=[],c=d=0,e=f.length;e>d;c=++d)b=f[c],a=this.options.eventLineColors[c%this.options.eventLineColors.length],g.push(this.drawEvent(b,a));return g},d.prototype.drawGoal=function(a,b){return this.raphael.path(\"M\"+this.left+\",\"+this.transY(a)+\"H\"+this.right).attr(\"stroke\",b).attr(\"stroke-width\",this.options.goalStrokeWidth)},d.prototype.drawEvent=function(a,b){return this.raphael.path(\"M\"+this.transX(a)+\",\"+this.bottom+\"V\"+this.top).attr(\"stroke\",b).attr(\"stroke-width\",this.options.eventStrokeWidth)},d.prototype.drawYAxisLabel=function(a,b,c){return this.raphael.text(a,b,c).attr(\"font-size\",this.options.gridTextSize).attr(\"font-family\",this.options.gridTextFamily).attr(\"font-weight\",this.options.gridTextWeight).attr(\"fill\",this.options.gridTextColor).attr(\"text-anchor\",\"end\")},d.prototype.drawGridLine=function(a){return this.raphael.path(a).attr(\"stroke\",this.options.gridLineColor).attr(\"stroke-width\",this.options.gridStrokeWidth)},d.prototype.startRange=function(a){return this.hover.hide(),this.selectFrom=a,this.selectionRect.attr({x:a,width:0}).show()},d.prototype.endRange=function(a){var b,c;return this.selectFrom?(c=Math.min(this.selectFrom,a),b=Math.max(this.selectFrom,a),this.options.rangeSelect.call(this.el,{start:this.data[this.hitTest(c)].x,end:this.data[this.hitTest(b)].x}),this.selectFrom=null):void 0},d.prototype.resizeHandler=function(){return this.timeoutId=null,this.raphael.setSize(this.el.width(),this.el.height()),this.redraw()},d}(b.EventEmitter),b.parseDate=function(a){var b,c,d,e,f,g,h,i,j,k,l;return\"number\"==typeof a?a:(c=a.match(/^(\\d+) Q(\\d)$/),e=a.match(/^(\\d+)-(\\d+)$/),f=a.match(/^(\\d+)-(\\d+)-(\\d+)$/),h=a.match(/^(\\d+) W(\\d+)$/),i=a.match(/^(\\d+)-(\\d+)-(\\d+)[ T](\\d+):(\\d+)(Z|([+-])(\\d\\d):?(\\d\\d))?$/),j=a.match(/^(\\d+)-(\\d+)-(\\d+)[ T](\\d+):(\\d+):(\\d+(\\.\\d+)?)(Z|([+-])(\\d\\d):?(\\d\\d))?$/),c?new Date(parseInt(c[1],10),3*parseInt(c[2],10)-1,1).getTime():e?new Date(parseInt(e[1],10),parseInt(e[2],10)-1,1).getTime():f?new Date(parseInt(f[1],10),parseInt(f[2],10)-1,parseInt(f[3],10)).getTime():h?(k=new Date(parseInt(h[1],10),0,1),4!==k.getDay()&&k.setMonth(0,1+(4-k.getDay()+7)%7),k.getTime()+6048e5*parseInt(h[2],10)):i?i[6]?(g=0,\"Z\"!==i[6]&&(g=60*parseInt(i[8],10)+parseInt(i[9],10),\"+\"===i[7]&&(g=0-g)),Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)+g)):new Date(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)).getTime():j?(l=parseFloat(j[6]),b=Math.floor(l),d=Math.round(1e3*(l-b)),j[8]?(g=0,\"Z\"!==j[8]&&(g=60*parseInt(j[10],10)+parseInt(j[11],10),\"+\"===j[9]&&(g=0-g)),Date.UTC(parseInt(j[1],10),parseInt(j[2],10)-1,parseInt(j[3],10),parseInt(j[4],10),parseInt(j[5],10)+g,b,d)):new Date(parseInt(j[1],10),parseInt(j[2],10)-1,parseInt(j[3],10),parseInt(j[4],10),parseInt(j[5],10),b,d).getTime()):new Date(parseInt(a,10),0,1).getTime())},b.Hover=function(){function c(c){null==c&&(c={}),this.options=a.extend({},b.Hover.defaults,c),this.el=a(\"<div class='\"+this.options[\"class\"]+\"'></div>\"),this.el.hide(),this.options.parent.append(this.el)}return c.defaults={\"class\":\"morris-hover morris-default-style\"},c.prototype.update=function(a,b,c){return a?(this.html(a),this.show(),this.moveTo(b,c)):this.hide()},c.prototype.html=function(a){return this.el.html(a)},c.prototype.moveTo=function(a,b){var c,d,e,f,g,h;return g=this.options.parent.innerWidth(),f=this.options.parent.innerHeight(),d=this.el.outerWidth(),c=this.el.outerHeight(),e=Math.min(Math.max(0,a-d/2),g-d),null!=b?(h=b-c-10,0>h&&(h=b+10,h+c>f&&(h=f/2-c/2))):h=f/2-c/2,this.el.css({left:e+\"px\",top:parseInt(h)+\"px\"})},c.prototype.show=function(){return this.el.show()},c.prototype.hide=function(){return this.el.hide()},c}(),b.Line=function(a){function c(a){return this.hilight=f(this.hilight,this),this.onHoverOut=f(this.onHoverOut,this),this.onHoverMove=f(this.onHoverMove,this),this.onGridClick=f(this.onGridClick,this),this instanceof b.Line?(c.__super__.constructor.call(this,a),void 0):new b.Line(a)}return h(c,a),c.prototype.init=function(){return\"always\"!==this.options.hideHover?(this.hover=new b.Hover({parent:this.el}),this.on(\"hovermove\",this.onHoverMove),this.on(\"hoverout\",this.onHoverOut),this.on(\"gridclick\",this.onGridClick)):void 0},c.prototype.defaults={lineWidth:3,pointSize:4,lineColors:[\"#0b62a4\",\"#7A92A3\",\"#4da74d\",\"#afd8f8\",\"#edc240\",\"#cb4b4b\",\"#9440ed\"],pointStrokeWidths:[1],pointStrokeColors:[\"#ffffff\"],pointFillColors:[],smooth:!0,xLabels:\"auto\",xLabelFormat:null,xLabelMargin:24,hideHover:!1},c.prototype.calc=function(){return this.calcPoints(),this.generatePaths()},c.prototype.calcPoints=function(){var a,b,c,d,e,f;for(e=this.data,f=[],c=0,d=e.length;d>c;c++)a=e[c],a._x=this.transX(a.x),a._y=function(){var c,d,e,f;for(e=a.y,f=[],c=0,d=e.length;d>c;c++)b=e[c],null!=b?f.push(this.transY(b)):f.push(b);return f}.call(this),f.push(a._ymax=Math.min.apply(Math,[this.bottom].concat(function(){var c,d,e,f;for(e=a._y,f=[],c=0,d=e.length;d>c;c++)b=e[c],null!=b&&f.push(b);return f}())));return f},c.prototype.hitTest=function(a){var b,c,d,e,f;if(0===this.data.length)return null;for(f=this.data.slice(1),b=d=0,e=f.length;e>d&&(c=f[b],!(a<(c._x+this.data[b]._x)/2));b=++d);return b},c.prototype.onGridClick=function(a,b){var c;return c=this.hitTest(a),this.fire(\"click\",c,this.data[c].src,a,b)},c.prototype.onHoverMove=function(a){var b;return b=this.hitTest(a),this.displayHoverForRow(b)},c.prototype.onHoverOut=function(){return this.options.hideHover!==!1?this.displayHoverForRow(null):void 0},c.prototype.displayHoverForRow=function(a){var b;return null!=a?((b=this.hover).update.apply(b,this.hoverContentForRow(a)),this.hilight(a)):(this.hover.hide(),this.hilight())},c.prototype.hoverContentForRow=function(a){var b,c,d,e,f,g,h;for(d=this.data[a],b=\"<div class='morris-hover-row-label'>\"+d.label+\"</div>\",h=d.y,c=f=0,g=h.length;g>f;c=++f)e=h[c],b+=\"<div class='morris-hover-point' style='color: \"+this.colorFor(d,c,\"label\")+\"'>\\n  \"+this.options.labels[c]+\":\\n  \"+this.yLabelFormat(e)+\"\\n</div>\";return\"function\"==typeof this.options.hoverCallback&&(b=this.options.hoverCallback(a,this.options,b,d.src)),[b,d._x,d._ymax]},c.prototype.generatePaths=function(){var a,c,d,e;return this.paths=function(){var f,g,h,j;for(j=[],c=f=0,g=this.options.ykeys.length;g>=0?g>f:f>g;c=g>=0?++f:--f)e=\"boolean\"==typeof this.options.smooth?this.options.smooth:(h=this.options.ykeys[c],i.call(this.options.smooth,h)>=0),a=function(){var a,b,e,f;for(e=this.data,f=[],a=0,b=e.length;b>a;a++)d=e[a],void 0!==d._y[c]&&f.push({x:d._x,y:d._y[c]});return f}.call(this),a.length>1?j.push(b.Line.createPath(a,e,this.bottom)):j.push(null);return j}.call(this)},c.prototype.draw=function(){var a;return((a=this.options.axes)===!0||\"both\"===a||\"x\"===a)&&this.drawXAxis(),this.drawSeries(),this.options.hideHover===!1?this.displayHoverForRow(this.data.length-1):void 0},c.prototype.drawXAxis=function(){var a,c,d,e,f,g,h,i,j,k,l=this;for(h=this.bottom+this.options.padding/2,f=null,e=null,a=function(a,b){var c,d,g,i,j;return c=l.drawXAxisLabel(l.transX(b),h,a),j=c.getBBox(),c.transform(\"r\"+-l.options.xLabelAngle),d=c.getBBox(),c.transform(\"t0,\"+d.height/2+\"...\"),0!==l.options.xLabelAngle&&(i=-.5*j.width*Math.cos(l.options.xLabelAngle*Math.PI/180),c.transform(\"t\"+i+\",0...\")),d=c.getBBox(),(null==f||f>=d.x+d.width||null!=e&&e>=d.x)&&d.x>=0&&d.x+d.width<l.el.width()?(0!==l.options.xLabelAngle&&(g=1.25*l.options.gridTextSize/Math.sin(l.options.xLabelAngle*Math.PI/180),e=d.x-g),f=d.x-l.options.xLabelMargin):c.remove()},d=this.options.parseTime?1===this.data.length&&\"auto\"===this.options.xLabels?[[this.data[0].label,this.data[0].x]]:b.labelSeries(this.xmin,this.xmax,this.width,this.options.xLabels,this.options.xLabelFormat):function(){var a,b,c,d;for(c=this.data,d=[],a=0,b=c.length;b>a;a++)g=c[a],d.push([g.label,g.x]);return d}.call(this),d.reverse(),k=[],i=0,j=d.length;j>i;i++)c=d[i],k.push(a(c[0],c[1]));return k},c.prototype.drawSeries=function(){var a,b,c,d,e,f;for(this.seriesPoints=[],a=b=d=this.options.ykeys.length-1;0>=d?0>=b:b>=0;a=0>=d?++b:--b)this._drawLineFor(a);for(f=[],a=c=e=this.options.ykeys.length-1;0>=e?0>=c:c>=0;a=0>=e?++c:--c)f.push(this._drawPointFor(a));return f},c.prototype._drawPointFor=function(a){var b,c,d,e,f,g;for(this.seriesPoints[a]=[],f=this.data,g=[],d=0,e=f.length;e>d;d++)c=f[d],b=null,null!=c._y[a]&&(b=this.drawLinePoint(c._x,c._y[a],this.colorFor(c,a,\"point\"),a)),g.push(this.seriesPoints[a].push(b));return g},c.prototype._drawLineFor=function(a){var b;return b=this.paths[a],null!==b?this.drawLinePath(b,this.colorFor(null,a,\"line\"),a):void 0},c.createPath=function(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(k=\"\",c&&(g=b.Line.gradients(a)),l={y:null},h=q=0,r=a.length;r>q;h=++q)e=a[h],null!=e.y&&(null!=l.y?c?(f=g[h],j=g[h-1],i=(e.x-l.x)/4,m=l.x+i,o=Math.min(d,l.y+i*j),n=e.x-i,p=Math.min(d,e.y-i*f),k+=\"C\"+m+\",\"+o+\",\"+n+\",\"+p+\",\"+e.x+\",\"+e.y):k+=\"L\"+e.x+\",\"+e.y:c&&null==g[h]||(k+=\"M\"+e.x+\",\"+e.y)),l=e;return k},c.gradients=function(a){var b,c,d,e,f,g,h,i;for(c=function(a,b){return(a.y-b.y)/(a.x-b.x)},i=[],d=g=0,h=a.length;h>g;d=++g)b=a[d],null!=b.y?(e=a[d+1]||{y:null},f=a[d-1]||{y:null},null!=f.y&&null!=e.y?i.push(c(f,e)):null!=f.y?i.push(c(f,b)):null!=e.y?i.push(c(b,e)):i.push(null)):i.push(null);return i},c.prototype.hilight=function(a){var b,c,d,e,f;if(null!==this.prevHilight&&this.prevHilight!==a)for(b=c=0,e=this.seriesPoints.length-1;e>=0?e>=c:c>=e;b=e>=0?++c:--c)this.seriesPoints[b][this.prevHilight]&&this.seriesPoints[b][this.prevHilight].animate(this.pointShrinkSeries(b));if(null!==a&&this.prevHilight!==a)for(b=d=0,f=this.seriesPoints.length-1;f>=0?f>=d:d>=f;b=f>=0?++d:--d)this.seriesPoints[b][a]&&this.seriesPoints[b][a].animate(this.pointGrowSeries(b));return this.prevHilight=a},c.prototype.colorFor=function(a,b,c){return\"function\"==typeof this.options.lineColors?this.options.lineColors.call(this,a,b,c):\"point\"===c?this.options.pointFillColors[b%this.options.pointFillColors.length]||this.options.lineColors[b%this.options.lineColors.length]:this.options.lineColors[b%this.options.lineColors.length]},c.prototype.drawXAxisLabel=function(a,b,c){return this.raphael.text(a,b,c).attr(\"font-size\",this.options.gridTextSize).attr(\"font-family\",this.options.gridTextFamily).attr(\"font-weight\",this.options.gridTextWeight).attr(\"fill\",this.options.gridTextColor)},c.prototype.drawLinePath=function(a,b,c){return this.raphael.path(a).attr(\"stroke\",b).attr(\"stroke-width\",this.lineWidthForSeries(c))},c.prototype.drawLinePoint=function(a,b,c,d){return this.raphael.circle(a,b,this.pointSizeForSeries(d)).attr(\"fill\",c).attr(\"stroke-width\",this.pointStrokeWidthForSeries(d)).attr(\"stroke\",this.pointStrokeColorForSeries(d))},c.prototype.pointStrokeWidthForSeries=function(a){return this.options.pointStrokeWidths[a%this.options.pointStrokeWidths.length]},c.prototype.pointStrokeColorForSeries=function(a){return this.options.pointStrokeColors[a%this.options.pointStrokeColors.length]},c.prototype.lineWidthForSeries=function(a){return this.options.lineWidth instanceof Array?this.options.lineWidth[a%this.options.lineWidth.length]:this.options.lineWidth},c.prototype.pointSizeForSeries=function(a){return this.options.pointSize instanceof Array?this.options.pointSize[a%this.options.pointSize.length]:this.options.pointSize},c.prototype.pointGrowSeries=function(a){return Raphael.animation({r:this.pointSizeForSeries(a)+3},25,\"linear\")},c.prototype.pointShrinkSeries=function(a){return Raphael.animation({r:this.pointSizeForSeries(a)},25,\"linear\")},c}(b.Grid),b.labelSeries=function(c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;if(j=200*(d-c)/e,i=new Date(c),n=b.LABEL_SPECS[f],void 0===n)for(r=b.AUTO_LABEL_ORDER,p=0,q=r.length;q>p;p++)if(k=r[p],m=b.LABEL_SPECS[k],j>=m.span){n=m;break}for(void 0===n&&(n=b.LABEL_SPECS.second),g&&(n=a.extend({},n,{fmt:g})),h=n.start(i),l=[];(o=h.getTime())<=d;)o>=c&&l.push([n.fmt(h),o]),n.incr(h);return l},c=function(a){return{span:60*a*1e3,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours())},fmt:function(a){return\"\"+b.pad2(a.getHours())+\":\"+b.pad2(a.getMinutes())},incr:function(b){return b.setUTCMinutes(b.getUTCMinutes()+a)}}},d=function(a){return{span:1e3*a,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes())},fmt:function(a){return\"\"+b.pad2(a.getHours())+\":\"+b.pad2(a.getMinutes())+\":\"+b.pad2(a.getSeconds())},incr:function(b){return b.setUTCSeconds(b.getUTCSeconds()+a)}}},b.LABEL_SPECS={decade:{span:1728e8,start:function(a){return new Date(a.getFullYear()-a.getFullYear()%10,0,1)},fmt:function(a){return\"\"+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+10)}},year:{span:1728e7,start:function(a){return new Date(a.getFullYear(),0,1)},fmt:function(a){return\"\"+a.getFullYear()},incr:function(a){return a.setFullYear(a.getFullYear()+1)}},month:{span:24192e5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},fmt:function(a){return\"\"+a.getFullYear()+\"-\"+b.pad2(a.getMonth()+1)},incr:function(a){return a.setMonth(a.getMonth()+1)}},week:{span:6048e5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(a){return\"\"+a.getFullYear()+\"-\"+b.pad2(a.getMonth()+1)+\"-\"+b.pad2(a.getDate())},incr:function(a){return a.setDate(a.getDate()+7)}},day:{span:864e5,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(a){return\"\"+a.getFullYear()+\"-\"+b.pad2(a.getMonth()+1)+\"-\"+b.pad2(a.getDate())},incr:function(a){return a.setDate(a.getDate()+1)}},hour:c(60),\"30min\":c(30),\"15min\":c(15),\"10min\":c(10),\"5min\":c(5),minute:c(1),\"30sec\":d(30),\"15sec\":d(15),\"10sec\":d(10),\"5sec\":d(5),second:d(1)},b.AUTO_LABEL_ORDER=[\"decade\",\"year\",\"month\",\"week\",\"day\",\"hour\",\"30min\",\"15min\",\"10min\",\"5min\",\"minute\",\"30sec\",\"15sec\",\"10sec\",\"5sec\",\"second\"],b.Area=function(c){function d(c){var f;return this instanceof b.Area?(f=a.extend({},e,c),this.cumulative=!f.behaveLikeLine,\"auto\"===f.fillOpacity&&(f.fillOpacity=f.behaveLikeLine?.8:1),d.__super__.constructor.call(this,f),void 0):new b.Area(c)}var e;return h(d,c),e={fillOpacity:\"auto\",behaveLikeLine:!1},d.prototype.calcPoints=function(){var a,b,c,d,e,f,g;for(f=this.data,g=[],d=0,e=f.length;e>d;d++)a=f[d],a._x=this.transX(a.x),b=0,a._y=function(){var d,e,f,g;for(f=a.y,g=[],d=0,e=f.length;e>d;d++)c=f[d],this.options.behaveLikeLine?g.push(this.transY(c)):(b+=c||0,g.push(this.transY(b)));return g}.call(this),g.push(a._ymax=Math.max.apply(Math,a._y));return g},d.prototype.drawSeries=function(){var a,b,c,d,e,f,g,h;for(this.seriesPoints=[],b=this.options.behaveLikeLine?function(){f=[];for(var a=0,b=this.options.ykeys.length-1;b>=0?b>=a:a>=b;b>=0?a++:a--)f.push(a);return f}.apply(this):function(){g=[];for(var a=e=this.options.ykeys.length-1;0>=e?0>=a:a>=0;0>=e?a++:a--)g.push(a);return g}.apply(this),h=[],c=0,d=b.length;d>c;c++)a=b[c],this._drawFillFor(a),this._drawLineFor(a),h.push(this._drawPointFor(a));return h},d.prototype._drawFillFor=function(a){var b;return b=this.paths[a],null!==b?(b+=\"L\"+this.transX(this.xmax)+\",\"+this.bottom+\"L\"+this.transX(this.xmin)+\",\"+this.bottom+\"Z\",this.drawFilledPath(b,this.fillForSeries(a))):void 0},d.prototype.fillForSeries=function(a){var b;return b=Raphael.rgb2hsl(this.colorFor(this.data[a],a,\"line\")),Raphael.hsl(b.h,this.options.behaveLikeLine?.9*b.s:.75*b.s,Math.min(.98,this.options.behaveLikeLine?1.2*b.l:1.25*b.l))},d.prototype.drawFilledPath=function(a,b){return this.raphael.path(a).attr(\"fill\",b).attr(\"fill-opacity\",this.options.fillOpacity).attr(\"stroke\",\"none\")},d}(b.Line),b.Bar=function(c){function d(c){return this.onHoverOut=f(this.onHoverOut,this),this.onHoverMove=f(this.onHoverMove,this),this.onGridClick=f(this.onGridClick,this),this instanceof b.Bar?(d.__super__.constructor.call(this,a.extend({},c,{parseTime:!1})),void 0):new b.Bar(c)}return h(d,c),d.prototype.init=function(){return this.cumulative=this.options.stacked,\"always\"!==this.options.hideHover?(this.hover=new b.Hover({parent:this.el}),this.on(\"hovermove\",this.onHoverMove),this.on(\"hoverout\",this.onHoverOut),this.on(\"gridclick\",this.onGridClick)):void 0},d.prototype.defaults={barSizeRatio:.75,barGap:3,barColors:[\"#0b62a4\",\"#7a92a3\",\"#4da74d\",\"#afd8f8\",\"#edc240\",\"#cb4b4b\",\"#9440ed\"],barOpacity:1,barRadius:[0,0,0,0],xLabelMargin:50},d.prototype.calc=function(){var a;return this.calcBars(),this.options.hideHover===!1?(a=this.hover).update.apply(a,this.hoverContentForRow(this.data.length-1)):void 0},d.prototype.calcBars=function(){var a,b,c,d,e,f,g;for(f=this.data,g=[],a=d=0,e=f.length;e>d;a=++d)b=f[a],b._x=this.left+this.width*(a+.5)/this.data.length,g.push(b._y=function(){var a,d,e,f;for(e=b.y,f=[],a=0,d=e.length;d>a;a++)c=e[a],null!=c?f.push(this.transY(c)):f.push(null);return f}.call(this));return g},d.prototype.draw=function(){var a;return((a=this.options.axes)===!0||\"both\"===a||\"x\"===a)&&this.drawXAxis(),this.drawSeries()},d.prototype.drawXAxis=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;for(j=this.bottom+(this.options.xAxisLabelTopPadding||this.options.padding/2),g=null,f=null,m=[],a=k=0,l=this.data.length;l>=0?l>k:k>l;a=l>=0?++k:--k)h=this.data[this.data.length-1-a],b=this.drawXAxisLabel(h._x,j,h.label),i=b.getBBox(),b.transform(\"r\"+-this.options.xLabelAngle),c=b.getBBox(),b.transform(\"t0,\"+c.height/2+\"...\"),0!==this.options.xLabelAngle&&(e=-.5*i.width*Math.cos(this.options.xLabelAngle*Math.PI/180),b.transform(\"t\"+e+\",0...\")),(null==g||g>=c.x+c.width||null!=f&&f>=c.x)&&c.x>=0&&c.x+c.width<this.el.width()?(0!==this.options.xLabelAngle&&(d=1.25*this.options.gridTextSize/Math.sin(this.options.xLabelAngle*Math.PI/180),f=c.x-d),m.push(g=c.x-this.options.xLabelMargin)):m.push(b.remove());return m},d.prototype.drawSeries=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;return c=this.width/this.options.data.length,h=this.options.stacked?1:this.options.ykeys.length,a=(c*this.options.barSizeRatio-this.options.barGap*(h-1))/h,this.options.barSize&&(a=Math.min(a,this.options.barSize)),l=c-a*h-this.options.barGap*(h-1),g=l/2,o=this.ymin<=0&&this.ymax>=0?this.transY(0):null,this.bars=function(){var h,l,p,q;for(p=this.data,q=[],d=h=0,l=p.length;l>h;d=++h)i=p[d],e=0,q.push(function(){var h,l,p,q;for(p=i._y,q=[],j=h=0,l=p.length;l>h;j=++h)n=p[j],null!==n?(o?(m=Math.min(n,o),b=Math.max(n,o)):(m=n,b=this.bottom),f=this.left+d*c+g,this.options.stacked||(f+=j*(a+this.options.barGap)),k=b-m,this.options.verticalGridCondition&&this.options.verticalGridCondition(i.x)&&this.drawBar(this.left+d*c,this.top,c,Math.abs(this.top-this.bottom),this.options.verticalGridColor,this.options.verticalGridOpacity,this.options.barRadius),this.options.stacked&&(m-=e),this.drawBar(f,m,a,k,this.colorFor(i,j,\"bar\"),this.options.barOpacity,this.options.barRadius),q.push(e+=k)):q.push(null);return q}.call(this));return q}.call(this)},d.prototype.colorFor=function(a,b,c){var d,e;return\"function\"==typeof this.options.barColors?(d={x:a.x,y:a.y[b],label:a.label},e={index:b,key:this.options.ykeys[b],label:this.options.labels[b]},this.options.barColors.call(this,d,e,c)):this.options.barColors[b%this.options.barColors.length]},d.prototype.hitTest=function(a){return 0===this.data.length?null:(a=Math.max(Math.min(a,this.right),this.left),Math.min(this.data.length-1,Math.floor((a-this.left)/(this.width/this.data.length))))},d.prototype.onGridClick=function(a,b){var c;return c=this.hitTest(a),this.fire(\"click\",c,this.data[c].src,a,b)},d.prototype.onHoverMove=function(a){var b,c;return b=this.hitTest(a),(c=this.hover).update.apply(c,this.hoverContentForRow(b))},d.prototype.onHoverOut=function(){return this.options.hideHover!==!1?this.hover.hide():void 0},d.prototype.hoverContentForRow=function(a){var b,c,d,e,f,g,h,i;for(d=this.data[a],b=\"<div class='morris-hover-row-label'>\"+d.label+\"</div>\",i=d.y,c=g=0,h=i.length;h>g;c=++g)f=i[c],b+=\"<div class='morris-hover-point' style='color: \"+this.colorFor(d,c,\"label\")+\"'>\\n  \"+this.options.labels[c]+\":\\n  \"+this.yLabelFormat(f)+\"\\n</div>\";return\"function\"==typeof this.options.hoverCallback&&(b=this.options.hoverCallback(a,this.options,b,d.src)),e=this.left+(a+.5)*this.width/this.data.length,[b,e]},d.prototype.drawXAxisLabel=function(a,b,c){var d;return d=this.raphael.text(a,b,c).attr(\"font-size\",this.options.gridTextSize).attr(\"font-family\",this.options.gridTextFamily).attr(\"font-weight\",this.options.gridTextWeight).attr(\"fill\",this.options.gridTextColor)},d.prototype.drawBar=function(a,b,c,d,e,f,g){var h,i;return h=Math.max.apply(Math,g),i=0===h||h>d?this.raphael.rect(a,b,c,d):this.raphael.path(this.roundedRect(a,b,c,d,g)),i.attr(\"fill\",e).attr(\"fill-opacity\",f).attr(\"stroke\",\"none\")},d.prototype.roundedRect=function(a,b,c,d,e){return null==e&&(e=[0,0,0,0]),[\"M\",a,e[0]+b,\"Q\",a,b,a+e[0],b,\"L\",a+c-e[1],b,\"Q\",a+c,b,a+c,b+e[1],\"L\",a+c,b+d-e[2],\"Q\",a+c,b+d,a+c-e[2],b+d,\"L\",a+e[3],b+d,\"Q\",a,b+d,a,b+d-e[3],\"Z\"]},d}(b.Grid),b.Donut=function(c){function d(c){this.resizeHandler=f(this.resizeHandler,this),this.select=f(this.select,this),this.click=f(this.click,this);var d=this;if(!(this instanceof b.Donut))return new b.Donut(c);if(this.options=a.extend({},this.defaults,c),this.el=\"string\"==typeof c.element?a(document.getElementById(c.element)):a(c.element),null===this.el||0===this.el.length)throw new Error(\"Graph placeholder not found.\");void 0!==c.data&&0!==c.data.length&&(this.raphael=new Raphael(this.el[0]),this.options.resize&&a(window).bind(\"resize\",function(){return null!=d.timeoutId&&window.clearTimeout(d.timeoutId),d.timeoutId=window.setTimeout(d.resizeHandler,100)}),this.setData(c.data))}return h(d,c),d.prototype.defaults={colors:[\"#0B62A4\",\"#3980B5\",\"#679DC6\",\"#95BBD7\",\"#B0CCE1\",\"#095791\",\"#095085\",\"#083E67\",\"#052C48\",\"#042135\"],backgroundColor:\"#FFFFFF\",labelColor:\"#000000\",formatter:b.commas,resize:!1},d.prototype.redraw=function(){var a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;for(this.raphael.clear(),c=this.el.width()/2,d=this.el.height()/2,n=(Math.min(c,d)-10)/3,l=0,u=this.values,o=0,r=u.length;r>o;o++)m=u[o],l+=m;for(i=5/(2*n),a=1.9999*Math.PI-i*this.data.length,g=0,f=0,this.segments=[],v=this.values,e=p=0,s=v.length;s>p;e=++p)m=v[e],j=g+i+a*(m/l),k=new b.DonutSegment(c,d,2*n,n,g,j,this.data[e].color||this.options.colors[f%this.options.colors.length],this.options.backgroundColor,f,this.raphael),k.render(),this.segments.push(k),k.on(\"hover\",this.select),k.on(\"click\",this.click),g=j,f+=1;for(this.text1=this.drawEmptyDonutLabel(c,d-10,this.options.labelColor,15,800),this.text2=this.drawEmptyDonutLabel(c,d+10,this.options.labelColor,14),h=Math.max.apply(Math,this.values),f=0,w=this.values,x=[],q=0,t=w.length;t>q;q++){if(m=w[q],m===h){this.select(f);\r\nbreak}x.push(f+=1)}return x},d.prototype.setData=function(a){var b;return this.data=a,this.values=function(){var a,c,d,e;for(d=this.data,e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(parseFloat(b.value));return e}.call(this),this.redraw()},d.prototype.click=function(a){return this.fire(\"click\",a,this.data[a])},d.prototype.select=function(a){var b,c,d,e,f,g;for(g=this.segments,e=0,f=g.length;f>e;e++)c=g[e],c.deselect();return d=this.segments[a],d.select(),b=this.data[a],this.setLabels(b.label,this.options.formatter(b.value,b))},d.prototype.setLabels=function(a,b){var c,d,e,f,g,h,i,j;return c=2*(Math.min(this.el.width()/2,this.el.height()/2)-10)/3,f=1.8*c,e=c/2,d=c/3,this.text1.attr({text:a,transform:\"\"}),g=this.text1.getBBox(),h=Math.min(f/g.width,e/g.height),this.text1.attr({transform:\"S\"+h+\",\"+h+\",\"+(g.x+g.width/2)+\",\"+(g.y+g.height)}),this.text2.attr({text:b,transform:\"\"}),i=this.text2.getBBox(),j=Math.min(f/i.width,d/i.height),this.text2.attr({transform:\"S\"+j+\",\"+j+\",\"+(i.x+i.width/2)+\",\"+i.y})},d.prototype.drawEmptyDonutLabel=function(a,b,c,d,e){var f;return f=this.raphael.text(a,b,\"\").attr(\"font-size\",d).attr(\"fill\",c),null!=e&&f.attr(\"font-weight\",e),f},d.prototype.resizeHandler=function(){return this.timeoutId=null,this.raphael.setSize(this.el.width(),this.el.height()),this.redraw()},d}(b.EventEmitter),b.DonutSegment=function(a){function b(a,b,c,d,e,g,h,i,j,k){this.cx=a,this.cy=b,this.inner=c,this.outer=d,this.color=h,this.backgroundColor=i,this.index=j,this.raphael=k,this.deselect=f(this.deselect,this),this.select=f(this.select,this),this.sin_p0=Math.sin(e),this.cos_p0=Math.cos(e),this.sin_p1=Math.sin(g),this.cos_p1=Math.cos(g),this.is_long=g-e>Math.PI?1:0,this.path=this.calcSegment(this.inner+3,this.inner+this.outer-5),this.selectedPath=this.calcSegment(this.inner+3,this.inner+this.outer),this.hilight=this.calcArc(this.inner)}return h(b,a),b.prototype.calcArcPoints=function(a){return[this.cx+a*this.sin_p0,this.cy+a*this.cos_p0,this.cx+a*this.sin_p1,this.cy+a*this.cos_p1]},b.prototype.calcSegment=function(a,b){var c,d,e,f,g,h,i,j,k,l;return k=this.calcArcPoints(a),c=k[0],e=k[1],d=k[2],f=k[3],l=this.calcArcPoints(b),g=l[0],i=l[1],h=l[2],j=l[3],\"M\"+c+\",\"+e+(\"A\"+a+\",\"+a+\",0,\"+this.is_long+\",0,\"+d+\",\"+f)+(\"L\"+h+\",\"+j)+(\"A\"+b+\",\"+b+\",0,\"+this.is_long+\",1,\"+g+\",\"+i)+\"Z\"},b.prototype.calcArc=function(a){var b,c,d,e,f;return f=this.calcArcPoints(a),b=f[0],d=f[1],c=f[2],e=f[3],\"M\"+b+\",\"+d+(\"A\"+a+\",\"+a+\",0,\"+this.is_long+\",0,\"+c+\",\"+e)},b.prototype.render=function(){var a=this;return this.arc=this.drawDonutArc(this.hilight,this.color),this.seg=this.drawDonutSegment(this.path,this.color,this.backgroundColor,function(){return a.fire(\"hover\",a.index)},function(){return a.fire(\"click\",a.index)})},b.prototype.drawDonutArc=function(a,b){return this.raphael.path(a).attr({stroke:b,\"stroke-width\":2,opacity:0})},b.prototype.drawDonutSegment=function(a,b,c,d,e){return this.raphael.path(a).attr({fill:b,stroke:c,\"stroke-width\":3}).hover(d).click(e)},b.prototype.select=function(){return this.selected?void 0:(this.seg.animate({path:this.selectedPath},150,\"<>\"),this.arc.animate({opacity:1},150,\"<>\"),this.selected=!0)},b.prototype.deselect=function(){return this.selected?(this.seg.animate({path:this.path},150,\"<>\"),this.arc.animate({opacity:0},150,\"<>\"),this.selected=!1):void 0},b}(b.EventEmitter)}).call(this);\ndefine(\"morris\", [\"jquery\",\"raphael\"], (function (global) {\n    return function () {\n        var ret, fn;\n        return ret || global.Morris;\n    };\n}(this)));\n\n",
    "/**\r\n * System graph module\r\n */\r\n\r\ndefine('app/ui/system_graph',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'morris'\r\n], function($, Init, Util, Morris) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // module info\r\n        moduleClass: 'pf-module',                                               // class for each module\r\n\r\n        // system graph module\r\n        systemGraphModuleClass: 'pf-system-graph-module',                       // class  for this module\r\n        systemGraphClass: 'pf-system-graph',                                    // class for each graph\r\n\r\n        // system graph labels\r\n        systemGraphLabels: {\r\n            jumps: {\r\n                headline: 'Jumps',\r\n                units: 'jumps',\r\n                ykeys: ['y'],\r\n                labels: ['jumps'],\r\n                lineColors: ['#375959'],\r\n                pointFillColors: ['#477372']\r\n            },\r\n            shipKills: {\r\n                headline: 'Ship/POD Kills',\r\n                units: 'kills',\r\n                ykeys: ['y', 'z'],\r\n                labels: ['Ship kills', 'POD kills'],\r\n                lineColors: ['#375959', '#477372'],\r\n                pointFillColors: ['#477372', '#568a89']\r\n            },\r\n            factionKills: {\r\n                headline: 'NPC Kills',\r\n                units: 'kills',\r\n                ykeys: ['y'],\r\n                labels: ['kills'],\r\n                lineColors: ['#375959'],\r\n                pointFillColors: ['#477372']\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get info for a given graph key\r\n     * @param graphKey\r\n     * @param option\r\n     * @returns {string}\r\n     */\r\n    var getInfoForGraph = function(graphKey, option){\r\n        var info = '';\r\n\r\n        if(config.systemGraphLabels.hasOwnProperty(graphKey)){\r\n            info = config.systemGraphLabels[graphKey][option];\r\n        }\r\n\r\n        return info;\r\n    };\r\n\r\n    /**\r\n     * init Morris Graph\r\n     * @param graphElement\r\n     * @param graphKey\r\n     * @param graphData\r\n     */\r\n    var initGraph = function(graphElement, graphKey, graphData, eventLine){\r\n\r\n        if(graphData.length > 0){\r\n            var labelYFormat = function(y){\r\n                return Math.round(y);\r\n            };\r\n\r\n            var graphConfig = {\r\n                element: graphElement,\r\n                data: graphData,\r\n                xkey: 'x',\r\n                ykeys: getInfoForGraph(graphKey, 'ykeys'),\r\n                labels: getInfoForGraph(graphKey, 'labels'),\r\n                parseTime: false,\r\n                ymin: 0,\r\n                yLabelFormat: labelYFormat,\r\n                padding: 10,\r\n                hideHover: true,\r\n                pointSize: 3,\r\n                lineColors: getInfoForGraph(graphKey, 'lineColors'),\r\n                pointFillColors: getInfoForGraph(graphKey, 'pointFillColors'),\r\n                pointStrokeColors: ['#141413'],\r\n                lineWidth: 2,\r\n                grid: true,\r\n                gridStrokeWidth: 0.3,\r\n                gridTextSize: 9,\r\n                gridTextFamily: 'Oxygen Bold',\r\n                gridTextColor: '#63676a',\r\n                behaveLikeLine: false,\r\n                goals: [],\r\n                goalLineColors: ['#5cb85c'],\r\n                smooth: true,\r\n                fillOpacity: 0.2,\r\n                resize: true,\r\n                redraw: true,\r\n                eventStrokeWidth: 2,\r\n                eventLineColors: ['#5CB85C']\r\n            };\r\n\r\n            if(eventLine >= 0){\r\n                graphConfig.events = [eventLine];\r\n            }\r\n\r\n            Morris.Area(graphConfig);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * draw graph module\r\n     * @param parentElement\r\n     * @param systemData\r\n     */\r\n    var drawModule = function(parentElement, systemData){\r\n\r\n        // graph data is available for k-space systems\r\n        if(systemData.type.id === 2){\r\n            var requestData = {\r\n                systemIds: [systemData.systemId]\r\n            };\r\n\r\n            // calculate time offset until system created\r\n            var serverData = Util.getServerTime();\r\n\r\n            var timestampNow = Math.floor(serverData.getTime() / 1000);\r\n            var timeSinceUpdate = timestampNow - systemData.updated;\r\n\r\n            var timeInHours = Math.floor(timeSinceUpdate / 3600);\r\n            var timeInMinutes = Math.floor((timeSinceUpdate % 3600) / 60);\r\n            var timeInMinutesPercent = ( timeInMinutes / 60 ).toFixed(2);\r\n            var eventLine = timeInHours + timeInMinutesPercent;\r\n\r\n            // graph is from right to left -> convert event line\r\n            eventLine = 23 - eventLine;\r\n\r\n            $.ajax({\r\n                type: 'POST',\r\n                url: Init.path.getSystemGraphData,\r\n                data: requestData,\r\n                dataType: 'json'\r\n            }).done(function(systemGraphsData){\r\n\r\n                if( Object.keys(systemGraphsData).length > 0 ){\r\n                    // create new (hidden) module container\r\n                    var moduleElement = $('<div>', {\r\n                        class: [config.moduleClass, config.systemGraphModuleClass].join(' '),\r\n                        css: {opacity: 0}\r\n                    });\r\n\r\n                    // insert at the correct position\r\n                    if($(parentElement).children().length === 1){\r\n                        $(parentElement).append(moduleElement);\r\n                    }else{\r\n                        $(parentElement).find('>:first-child').after(moduleElement);\r\n                    }\r\n\r\n                    // row element\r\n                    var rowElement = $('<div>', {\r\n                        class: 'row'\r\n                    });\r\n                    moduleElement.append(rowElement);\r\n\r\n                    $.each(systemGraphsData, function(systemId, graphsData){\r\n                        $.each(graphsData, function(graphKey, graphData){\r\n\r\n                            var colElement = $('<div>', {\r\n                                class: ['col-xs-12', 'col-sm-6', 'col-md-4'].join(' ')\r\n                            });\r\n\r\n                            var headlineElement = $('<h5>').text( getInfoForGraph(graphKey, 'headline') );\r\n\r\n                            colElement.append(headlineElement);\r\n\r\n                            var graphElement = $('<div>', {\r\n                                class: config.systemGraphClass\r\n                            });\r\n\r\n                            colElement.append(graphElement);\r\n\r\n                            rowElement.append(colElement);\r\n                            initGraph(graphElement, graphKey, graphData, eventLine);\r\n                        });\r\n                    });\r\n\r\n                    moduleElement.append($('<div>', {\r\n                        css: {'clear': 'both'}\r\n                    }));\r\n\r\n                    // show module\r\n                    moduleElement.velocity('transition.slideDownIn', {\r\n                        duration: Init.animationSpeed.mapModule,\r\n                        delay: Init.animationSpeed.mapModule\r\n                    });\r\n                }\r\n            }).fail(function( jqXHR, status, error) {\r\n                var reason = status + ' ' + error;\r\n                Util.showNotify({title: jqXHR.status + ': System graph data', text: reason, type: 'warning'});\r\n                $(document).setProgramStatus('problem');\r\n            });\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * main module load function\r\n     * @param systemData\r\n     */\r\n    $.fn.drawSystemGraphModule = function(systemData){\r\n\r\n        var parentElement = $(this);\r\n\r\n        // check if module already exists\r\n        var moduleElement = parentElement.find('.' + config.systemGraphModuleClass);\r\n\r\n        if(moduleElement.length > 0){\r\n            moduleElement.velocity('transition.slideDownOut', {\r\n                duration: Init.animationSpeed.mapModule,\r\n                complete: function(tempElement){\r\n                    $(tempElement).remove();\r\n                    drawModule(parentElement, systemData);\r\n                }\r\n            });\r\n        }else{\r\n            drawModule(parentElement, systemData);\r\n        }\r\n    };\r\n\r\n\r\n\r\n});\r\n\n",
    "/**\r\n *  System signature module\r\n */\r\n\r\ndefine('app/ui/system_signature',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'bootbox'\r\n], function($, Init, Util, Render, bootbox) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // module info\r\n        moduleClass: 'pf-module',                                               // class for each module\r\n\r\n        // system signature module\r\n        systemSigModuleClass: 'pf-sig-table-module',                            // module wrapper\r\n\r\n        // tables\r\n        tableToolsClass: 'pf-table-tools',                                      // class for table toolbar\r\n        tableToolsActionClass: 'pf-table-tools-action',                         // class for table toolbar action\r\n\r\n        // dialogs\r\n        signatureReaderDialogId: 'pf-signature-reader-dialog',                  // id for signature reader dialog\r\n\r\n        // signature progress bar\r\n        signatureScannedProgressBarClass: 'pf-system-progress-scanned',         // class for signature progress bar\r\n\r\n        // toolbar\r\n        sigTableClearButtonClass: 'pf-sig-table-clear-button',                  // class for \"clear\" signatures button\r\n\r\n        // signature table\r\n        sigTableClass: 'pf-sig-table',                                          // Table class for all Signature Tables\r\n        sigTablePrimaryClass: 'pf-sig-table-primary',                           // class for primary sig table\r\n        sigTableSecondaryClass: 'pf-sig-table-secondary',                       // class for secondary sig table\r\n        sigTableRowIdPrefix: 'pf-sig-table-row-',                               // id prefix for a table row <tr>\r\n        sigTableEditText: 'pf-sig-table-edit-text',                             // class for editable fields (text)\r\n        sigTableEditSigNameInput: 'pf-sig-table-edit-name-input',               // class for editable fields (input)\r\n        sigTableEditSigGroupSelect: 'pf-sig-table-edit-group-select',           // class for editable fields (sig group)\r\n        sigTableEditSigTypeSelect: 'pf-sig-table-edit-type-select',             // class for editable fields (sig type)\r\n        sigTableEditSigDescriptionTextarea: 'pf-sig-table-edit-desc-text',      // class for editable fields (sig description)\r\n        sigTableCreatedCellClass: 'pf-sig-table-created',                       // class for \"created\" cells\r\n        sigTableUpdatedCellClass: 'pf-sig-table-updated',                       // class for \"updated\" cells\r\n\r\n        sigTableCounterClass: 'pf-table-counter-cell',                          // class for \"counter\" cells\r\n        sigTableActionCellClass: 'pf-table-action-cell',                        // class for \"action\" cells\r\n\r\n        // xEditable\r\n        moduleIcon: 'pf-module-icon-button',                                    // class for \"filter\" - icons\r\n        editableDescriptionInputClass: 'pf-editable-description',               // class for \"description\" textarea\r\n        editableFilterInputClass: 'pf-editable-filter'                          // class for \"filter\" selects\r\n    };\r\n\r\n    // lock Signature Table update temporary (until. some requests/animations) are finished\r\n    var disableTableUpdate = true;\r\n\r\n    // disable \"copy&paste\" from clipboard (until  request finished)\r\n    var disableCopyFromClipboard = false;\r\n\r\n    // cache for dataTable object\r\n    var signatureTable = null;\r\n\r\n    // empty signatureData object -> for \"add row\" table\r\n    var emptySignatureData = {\r\n        id: 0,\r\n        name: '',\r\n        groupId: 0,\r\n        typeId: 0,\r\n        description: '',\r\n        created: {\r\n            created: null\r\n        },\r\n        updated: {\r\n            updated: null\r\n        }\r\n    };\r\n\r\n    var fullSignatureOptions = {\r\n        action: 'delete',\r\n        actionClass: ['fa-close', 'txt-color', 'txt-color-redDarker'].join(' ')\r\n    };\r\n\r\n    // empty signatureData row Options\r\n    var emptySignatureOptions = {\r\n        action: 'add',\r\n        actionClass: ['fa-plus'].join(' ')\r\n    };\r\n\r\n    var sigNameCache = {};                                                      // cache signature names\r\n\r\n    var validSignatureNames = [                                                 // allowed signature type/names\r\n        'Cosmic Anomaly',\r\n        'Cosmic Signature',\r\n        'Космическая аномалия',                                                 // == \"Cosmic Anomaly\"\r\n        'Источники сигналов'                                                    // == \"Cosmic Signature\"\r\n    ];\r\n\r\n    // some static signature data\r\n    var signatureGroupsLabels   = Util.getSignatureGroupInfo('label');\r\n    var signatureGroupsNames    = Util.getSignatureGroupInfo('name');\r\n\r\n    /**\r\n     * collect all data of all editable fields in a signature table\r\n     * @returns {Array}\r\n     */\r\n    var getSignatureTableData = function(){\r\n\r\n        var signatureTableApi = signatureTable.api();\r\n\r\n        var tableData = [];\r\n\r\n        signatureTableApi.rows().eq(0).each(function(idx){\r\n\r\n            var row = signatureTableApi.row(idx);\r\n            // default row data\r\n            var defaultRowData = row.data();\r\n            var rowElement = row.nodes().to$();\r\n\r\n            if(defaultRowData.id > 0){\r\n                // get all editable fields per row\r\n                var editableFields = rowElement.find('.editable');\r\n\r\n                if(editableFields.length > 0){\r\n                    var values = $(editableFields).editable('getValue');\r\n\r\n                    // convert to lower for better compare options\r\n                    values.name = values.name.toLowerCase();\r\n\r\n                    // add pk for this row\r\n                    values.id = defaultRowData.id;\r\n\r\n                    // add updated for this row\r\n                    values.updated = defaultRowData.updated;\r\n\r\n                    // add row index\r\n                    values.index = idx;\r\n\r\n                    tableData.push( values );\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        return tableData;\r\n    };\r\n\r\n    /**\r\n     * updates a single cell with new data (e.g. \"updated\" cell)\r\n     * @param rowElement\r\n     * @param cellIndex\r\n     * @param data\r\n     */\r\n    var updateSignatureCell = function(rowElement, cellIndex, data){\r\n\r\n        var signatureTableApi = signatureTable.api();\r\n        var rowIndex = signatureTableApi.row( rowElement ).index();\r\n\r\n        var updateCell = signatureTableApi.cell( rowIndex, cellIndex );\r\n        var updateCellElement = updateCell.nodes().to$();\r\n\r\n        if(cellIndex === 6){\r\n            // clear existing counter interval\r\n            clearInterval( updateCellElement.data('interval') );\r\n        }\r\n\r\n        // set new value\r\n        updateCell.data( data ).draw();\r\n\r\n        if(cellIndex === 6){\r\n            updateCellElement.initTimestampCounter();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Updates a signature table, changes all signatures where name matches\r\n     * add all new signatures as a row\r\n     *\r\n     * @param signatureDataOrig\r\n     * @param deleteOutdatedSignatures -> set to \"true\" if signatures should be deleted that are not included in \"signatureData\"\r\n     */\r\n    $.fn.updateSignatureTable = function(signatureDataOrig, deleteOutdatedSignatures){\r\n\r\n        // check if table update is allowed\r\n        if(disableTableUpdate === true){\r\n            return;\r\n        }\r\n\r\n        // clone signature array because of further manipulation\r\n        var signatureData = $.extend([], signatureDataOrig);\r\n\r\n        // disable update until function is ready;\r\n        lockSignatureTable();\r\n\r\n        var moduleElement = $(this);\r\n\r\n        // get signature table API\r\n        var signatureTableApi = signatureTable.api();\r\n\r\n        // get current system data\r\n        var currentSystemData = Util.getCurrentSystemData();\r\n\r\n\r\n        var tableData = getSignatureTableData();\r\n\r\n        var notificationCounter = {\r\n            added: 0,\r\n            changed: 0,\r\n            deleted: 0\r\n        };\r\n\r\n        for(var i = 0; i < signatureData.length; i++){\r\n            for(var j = 0; j < tableData.length; j++){\r\n                if(signatureData[i].id === tableData[j].id){\r\n\r\n                    // check if row was updated\r\n                    if(signatureData[i].updated.updated > tableData[j].updated.updated){\r\n\r\n                        // row element to remove\r\n                        var currentRowElement = signatureTableApi.row(tableData[j].index).nodes().to$();\r\n\r\n                        // hide open editable fields on the row before removing them\r\n                        currentRowElement.find('.editable').editable('destroy');\r\n\r\n                        // remove \"old\" row\r\n                        signatureTableApi.row(currentRowElement).remove().draw();\r\n\r\n                        // and add \"new\" row\r\n                        var changedRowElement = addSignatureRow(currentSystemData.systemData, signatureData[i], false);\r\n\r\n                        // highlight\r\n                        changedRowElement.pulseTableRow('changed');\r\n\r\n                        notificationCounter.changed++;\r\n                    }\r\n\r\n                    // remove signature data -> all left signatures will be added\r\n                    signatureData.splice(i, 1);\r\n                    i--;\r\n\r\n                    // remove signature data -> all left signatures will be deleted\r\n                    tableData.splice(j, 1);\r\n                    j--;\r\n\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        // delete signatures ------------------------------------------------------------------------------------------\r\n        if(deleteOutdatedSignatures === true){\r\n\r\n            // callback function after row deleted\r\n            var toggleTableRowCallback = function(tempRowElement){\r\n                // hide open editable fields on the row before removing them\r\n                tempRowElement.find('.editable').editable('destroy');\r\n\r\n                // delete signature row\r\n                signatureTableApi.row(tempRowElement).remove().draw();\r\n            };\r\n\r\n            for(var l = 0; l < tableData.length; l++){\r\n                var rowElement = signatureTableApi.row(tableData[l].index).nodes().to$();\r\n                rowElement.toggleTableRow(toggleTableRowCallback);\r\n                notificationCounter.deleted++;\r\n            }\r\n        }\r\n\r\n        // add new signatures -----------------------------------------------------------------------------------------\r\n        for(var k = 0; k < signatureData.length; k++){\r\n            // and add \"new\" row\r\n            var newRowElement = addSignatureRow(currentSystemData.systemData, signatureData[k], false);\r\n\r\n            // highlight\r\n            newRowElement.pulseTableRow('added');\r\n\r\n            notificationCounter.added++;\r\n        }\r\n\r\n\r\n        // show notification ------------------------------------------------------------------------------------------\r\n        if(\r\n            notificationCounter.added > 0 ||\r\n            notificationCounter.changed > 0 ||\r\n            notificationCounter.deleted > 0\r\n        ){\r\n            // update signature bar\r\n            moduleElement.updateScannedSignaturesBar({showNotice: true});\r\n\r\n            // show Notification\r\n            var notification = notificationCounter.added + ' added<br>';\r\n            notification += notificationCounter.changed + ' changed<br>';\r\n            notification += notificationCounter.deleted + ' deleted<br>';\r\n            Util.showNotify({title: 'Signatures updated', text: notification, type: 'success'});\r\n\r\n            // wait until add/remove animations are finished before enable table for auto update again\r\n            unlockSignatureTable(false);\r\n        }else{\r\n            // enable table for next update\r\n            unlockSignatureTable(true);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * lock system signature table for\r\n     */\r\n    var lockSignatureTable = function(){\r\n        disableTableUpdate = true;\r\n    };\r\n\r\n    /**\r\n     * unlock system signature table from been locked\r\n     * -> make table \"update-able\" again\r\n     * @param instant\r\n     */\r\n    var unlockSignatureTable = function(instant){\r\n        if(disableTableUpdate === true){\r\n            if(instant === true){\r\n                disableTableUpdate = false;\r\n            }else{\r\n                // wait until add/remove animations are finished before enable table for auto update again\r\n                setTimeout(function(){ disableTableUpdate = false; }, 2000);\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    /**\r\n     * update Progressbar for all scanned signatures in a system\r\n     * @param options\r\n     */\r\n    $.fn.updateScannedSignaturesBar = function(options){\r\n\r\n        var moduleElement = $(this);\r\n\r\n        // get progress bar\r\n        var progressBarWrapper = moduleElement.find('.' + config.signatureScannedProgressBarClass);\r\n        var progressBar = $(progressBarWrapper).find('.progress-bar');\r\n        var progressBarLabel = $(progressBarWrapper).find('.progress-label-right');\r\n\r\n        var tableData = getSignatureTableData();\r\n\r\n        var percent = 0;\r\n        var progressBarType = 'progress-bar-danger';\r\n\r\n        if(tableData){\r\n            var sigCount = tableData.length;\r\n            var sigIncompleteCount = 0;\r\n            // check for  signatures without \"groupId\" -> these are un scanned signatures\r\n\r\n            for(var i = 0; i < tableData.length; i++){\r\n                var groupId = parseInt(tableData[i].groupId);\r\n                if(groupId === 0){\r\n                    sigIncompleteCount++;\r\n                }\r\n            }\r\n\r\n            if(sigCount > 0){\r\n                percent = 100 - Math.round( 100 / sigCount * sigIncompleteCount );\r\n            }\r\n\r\n            if(percent < 30){\r\n                progressBarType = 'progress-bar-danger' ;\r\n            }else if(percent < 100){\r\n                progressBarType = 'progress-bar-warning';\r\n            }else{\r\n                progressBarType = 'progress-bar-success';\r\n            }\r\n        }\r\n\r\n        setTimeout(\r\n            function() {\r\n                progressBarLabel.text(percent + '%');\r\n                progressBar.removeClass().addClass('progress-bar').addClass(progressBarType);\r\n                progressBar.attr('aria-valuenow', percent);\r\n                progressBar.css({width: percent + '%'});\r\n\r\n                var notification = (sigCount - sigIncompleteCount) + ' / ' + sigCount + ' (' + percent + '%) signatures scanned';\r\n\r\n                // show notifications\r\n                if(options.showNotice !== false){\r\n                    if(percent < 100){\r\n                        Util.showNotify({title: 'Unscanned signatures', text: notification, type: 'info'});\r\n                    }else{\r\n                        Util.showNotify({title: 'System is scanned', text: notification, type: 'success'});\r\n                    }\r\n                }\r\n\r\n            }, 100);\r\n\r\n    };\r\n\r\n    /**\r\n     * open \"signature reader\" dialog for signature table\r\n     * @param systemData\r\n     */\r\n    $.fn.showSignatureReaderDialog = function(systemData){\r\n\r\n        var moduleElement = $(this);\r\n\r\n        var data = {\r\n            id: config.signatureReaderDialogId\r\n        };\r\n\r\n        requirejs(['text!templates/dialog/signature_reader.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var signatureReaderDialog = bootbox.dialog({\r\n                title: 'Signature reader',\r\n                message: content,\r\n                buttons: {\r\n                    close: {\r\n                        label: 'cancel',\r\n                        className: 'btn-default',\r\n                        callback: function(){\r\n                            $(signatureReaderDialog).modal('hide');\r\n                        }\r\n                    },\r\n                    success: {\r\n                        label: '<i class=\"fa fa-clipboard fa-fw\"></i>&nbsp;update signatures',\r\n                        className: 'btn-success',\r\n                        callback: function () {\r\n                            // get form Values\r\n                            var form = $('#' + config.signatureReaderDialogId).find('form');\r\n                            var formData = $(form).getFormValues();\r\n\r\n                            var signatureOptions = {\r\n                                deleteOld: (formData.deleteOld) ? 1 : 0\r\n                            };\r\n                            moduleElement.updateSignatureTableByClipboard(systemData, formData.clipboard, signatureOptions);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            // dialog shown event\r\n            signatureReaderDialog.on('shown.bs.modal', function(e) {\r\n                signatureReaderDialog.initTooltips();\r\n\r\n                // set focus on sig-input textarea\r\n                signatureReaderDialog.find('textarea').focus();\r\n            });\r\n\r\n\r\n        });\r\n    };\r\n\r\n    /**\r\n     * updates the signature table with all signatures pasted into the \"signature reader\" dialog\r\n     * -> Hint: copy&paste signature data (without any open dialog) will add signatures as well\r\n     * @param systemData\r\n     * @param clipboard data stream\r\n     * @param options\r\n     */\r\n    $.fn.updateSignatureTableByClipboard = function(systemData, clipboard, options){\r\n\r\n        // check if copy&paste is enabled\r\n        if( !disableCopyFromClipboard ){\r\n            var moduleElement = $(this);\r\n\r\n            // parse input stream\r\n            var signatureData = parseSignatureString(systemData, clipboard);\r\n\r\n            if(signatureData.length > 0){\r\n                // save signature data\r\n\r\n                // lock update function until request is finished\r\n                lockSignatureTable();\r\n\r\n                // lock copy during request (prevent spamming (ctrl + c )\r\n                disableCopyFromClipboard = true;\r\n\r\n                var requestData = {\r\n                    signatures: signatureData,\r\n                    deleteOld: (options.deleteOld) ? 1 : 0,\r\n                    systemId: parseInt(systemData.id)\r\n                };\r\n\r\n                $.ajax({\r\n                    type: 'POST',\r\n                    url: Init.path.saveSignatureData,\r\n                    data: requestData,\r\n                    dataType: 'json'\r\n                }).done(function(responseData){\r\n                    unlockSignatureTable(true);\r\n\r\n                    // updates table with new/updated signature information\r\n                    moduleElement.updateSignatureTable(responseData.signatures, false);\r\n                }).fail(function( jqXHR, status, error) {\r\n                    var reason = status + ' ' + error;\r\n                    Util.showNotify({title: jqXHR.status + ': Update signatures', text: reason, type: 'warning'});\r\n                    $(document).setProgramStatus('problem');\r\n                }).always(function() {\r\n                    unlockSignatureTable(true);\r\n                    disableCopyFromClipboard = false;\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * parses a copy&paste string from ingame scanning window and parses it\r\n     * @param systemData\r\n     * @param clipboard\r\n     * @returns {Array}\r\n     */\r\n    var parseSignatureString = function(systemData, clipboard){\r\n        var signatureData = [];\r\n\r\n        if(clipboard.length){\r\n            var signatureRows = clipboard.split(/\\r\\n|\\r|\\n/g);\r\n            var signatureGroupOptions = signatureGroupsNames;\r\n            var invalidSignatures = 0;\r\n\r\n            for(var i = 0; i < signatureRows.length; i++){\r\n                var rowData = signatureRows[i].split(/\\t/g);\r\n\r\n                if(rowData.length === 6){\r\n\r\n                    // check if sig Type = anomaly or combat site\r\n                    if(validSignatureNames.indexOf( rowData[1] ) !== -1){\r\n\r\n                        var sigGroup = $.trim(rowData[2]).toLowerCase();\r\n                        var sigDescription = $.trim(rowData[3]);\r\n                        var sigGroupId = 0;\r\n                        var typeId = 0;\r\n\r\n                        // get groupId by groupName\r\n                        for (var prop in signatureGroupOptions) {\r\n                            if(signatureGroupOptions.hasOwnProperty(prop)){\r\n                                if(signatureGroupOptions[prop] === sigGroup){\r\n                                    sigGroupId = parseInt( prop );\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        // wormhole type cant be extracted from signature string -> skip function call\r\n                        if(sigGroupId !== 5){\r\n                            // try to get \"typeId\" by description string\r\n                            typeId = Util.getSignatureTypeIdByName( systemData, sigGroupId, sigDescription );\r\n\r\n                            // set signature name as \"description\" if signature matching failed\r\n                            sigDescription = (typeId === 0) ? sigDescription : '';\r\n                        }else{\r\n                            sigDescription = '';\r\n                        }\r\n\r\n                        // map array values to signature Object\r\n                        var signatureObj = {\r\n                            systemId: systemData.id,\r\n                            name: $.trim( rowData[0].substr(0, 3) ).toLowerCase(),\r\n                            groupId: sigGroupId,\r\n                            typeId: typeId,\r\n                            description: sigDescription\r\n                        };\r\n\r\n                        signatureData.push(signatureObj);\r\n                    }else{\r\n                        invalidSignatures++;\r\n                    }\r\n                }else{\r\n                    invalidSignatures++;\r\n                }\r\n            }\r\n\r\n            if(invalidSignatures > 0){\r\n                var notification = invalidSignatures + ' / ' + signatureRows.length + ' signatures invalid';\r\n                Util.showNotify({title: 'Invalid signature(s)', text: notification, type: 'warning'});\r\n            }\r\n        }\r\n\r\n        return signatureData;\r\n    };\r\n\r\n    /**\r\n     * get a labeled button\r\n     * @param options\r\n     * @returns {*|jQuery}\r\n     */\r\n    var getLabledButton = function(options){\r\n\r\n        var buttonClasses = ['btn', 'btn-sm', 'btn-labeled'];\r\n\r\n        switch(options.type){\r\n            case 'default':\r\n                buttonClasses.push('btn-default');\r\n                break;\r\n            case 'primary':\r\n                buttonClasses.push('btn-primary');\r\n                break;\r\n            case 'danger':\r\n                buttonClasses.push('btn-danger');\r\n                break;\r\n        }\r\n\r\n        // add optional classes\r\n        if(options.classes){\r\n            buttonClasses = buttonClasses.concat(options.classes);\r\n        }\r\n\r\n\r\n        var buttonElement = $('<button>', {\r\n            class: buttonClasses.join(' '),\r\n            type: 'button',\r\n            html: '&nbsp;' + options.label + '&nbsp;&nbsp;'\r\n        }).on('click', function(e){\r\n            options.onClick(e);\r\n        }).prepend(\r\n            $('<span>', {\r\n                class: 'btn-label'\r\n            }).prepend(\r\n                $('<i>', {\r\n                    class: ['fa', options.icon, 'fa-fw'].join(' ')\r\n                })\r\n            )\r\n        );\r\n\r\n        // add optional badge\r\n        if(options.badge){\r\n            buttonElement.append(\r\n                $('<span>', {\r\n                    class: ['badge'].join(' '),\r\n                    text: options.badge.label\r\n                })\r\n            );\r\n        }\r\n\r\n        return buttonElement;\r\n    };\r\n\r\n    /**\r\n     * draw signature table toolbar (add signature button, scan progress bar\r\n     * @param systemData\r\n     */\r\n    $.fn.drawSignatureTableToolbar = function(systemData){\r\n\r\n        var moduleElement = $(this);\r\n\r\n        // add toolbar buttons for table ------------------------------------------------------------------------------\r\n        var tableToolbar = $('<div>', {\r\n            class: config.tableToolsClass\r\n        }).append(\r\n            getLabledButton({\r\n                type: 'primary',\r\n                label: 'add',\r\n                icon: 'fa-plus',\r\n                onClick: function(e){\r\n                    // show \"add sig\" div\r\n                    var toolsElement = $(e.target).parents('.' + config.moduleClass).find('.' + config.tableToolsActionClass);\r\n\r\n                    // set toggle animation\r\n                    if(toolsElement.is(':visible')){\r\n                        toolsElement.velocity('stop').velocity('reverse');\r\n                    }else{\r\n                        toolsElement.velocity('stop').velocity({\r\n                            opacity: 1,\r\n                            height: '75px'\r\n                        },{\r\n                            duration: 150,\r\n                            display: 'block',\r\n                            visibility: 'visible'\r\n                        });\r\n                    }\r\n                }\r\n            })\r\n        ).append(\r\n            getLabledButton({\r\n                type: 'primary',\r\n                label: 'signature reader',\r\n                icon: 'fa-clipboard',\r\n                onClick: function(){\r\n                    moduleElement.showSignatureReaderDialog(systemData);\r\n                }\r\n            })\r\n        ).append(\r\n            getLabledButton({\r\n                type: 'default',\r\n                label: 'select all',\r\n                icon: 'fa-check-square',\r\n                onClick: function(){\r\n                    var allRows = getRows(signatureTable);\r\n                    var selectedRows = getSelectedRows(signatureTable);\r\n                    var allRowElements = allRows.nodes().to$();\r\n\r\n                    if(allRows.data().length === selectedRows.data().length){\r\n                        allRowElements.removeClass('selected');\r\n                    }else{\r\n                        allRowElements.addClass('selected');\r\n                    }\r\n\r\n                    // check delete button\r\n                    checkDeleteSignaturesButton();\r\n                }\r\n            })\r\n        ).append(\r\n            getLabledButton({\r\n                type: 'danger',\r\n                classes: [config.sigTableClearButtonClass, 'pull-right'],\r\n                label: 'delete',\r\n                icon: 'fa-close',\r\n                badge: {\r\n                    label: '0'\r\n                },\r\n                onClick: function(){\r\n                    // delete all rows\r\n\r\n                    var selectedRows = getSelectedRows(signatureTable);\r\n\r\n                    bootbox.confirm('Delete ' + selectedRows.data().length + ' signature?', function(result) {\r\n                        if(result){\r\n                            deleteSignatures(selectedRows);\r\n                        }\r\n                    });\r\n                }\r\n            })\r\n        );\r\n\r\n        moduleElement.append(tableToolbar);\r\n\r\n        // add toolbar action for table -------------------------------------------------------------------------------\r\n        var tableToolbarAction = $('<div>', {\r\n            class: config.tableToolsActionClass\r\n        });\r\n\r\n        // create \"empty table for new signature\r\n        var table = $('<table>', {\r\n            class: ['display', 'compact', 'nowrap', config.sigTableClass, config.sigTableSecondaryClass].join(' ')\r\n        });\r\n\r\n        tableToolbarAction.append(table);\r\n\r\n        tableToolbar.after(tableToolbarAction);\r\n\r\n        var signatureData = formatSignatureData(systemData, [emptySignatureData], emptySignatureOptions);\r\n        table.dataTable( {\r\n            data: signatureData,\r\n            paging: false,\r\n            ordering: false,\r\n            info: false,\r\n            searching: false\r\n        } );\r\n\r\n        table.makeEditable(systemData);\r\n\r\n        // scanned signatures progress bar ----------------------------------------------------------------------------\r\n        var moduleConfig = {\r\n            name: 'form/progress',\r\n            position: tableToolbar,\r\n            link: 'before'\r\n        };\r\n\r\n        var moduleData = {\r\n            label: true,\r\n            wrapperClass: config.signatureScannedProgressBarClass,\r\n            class: ['progress-bar-success'].join(' '),\r\n            percent: 0,\r\n            headline: 'System scanned',\r\n            headlineRight: ' ' // will be updated by js\r\n        };\r\n\r\n        Render.showModule(moduleConfig, moduleData);\r\n\r\n        // event listener for global \"paste\" signatures into the page -------------------------------------------------\r\n        $(document).off('paste').on('paste', function(e){\r\n\r\n            // do not read clipboard if pasting into form elements\r\n            if(\r\n                $(e.target).prop('tagName').toLowerCase() !== 'input' &&\r\n                $(e.target).prop('tagName').toLowerCase() !== 'textarea'\r\n            ){\r\n                var clipboard = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                moduleElement.updateSignatureTableByClipboard(systemData, clipboard, {});\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * make a table or row editable\r\n     * @param systemData\r\n     */\r\n    $.fn.makeEditable = function(systemData){\r\n\r\n        // table element OR row element\r\n        var tableElement = $(this);\r\n\r\n        // find editable fields\r\n        var sigNameFields = tableElement.find('.' + config.sigTableEditSigNameInput);\r\n        var sigGroupFields = tableElement.find('.' + config.sigTableEditSigGroupSelect);\r\n        var sigTypeFields = tableElement.find('.' + config.sigTableEditSigTypeSelect);\r\n        var sigDescriptionFields = tableElement.find('.' + config.sigTableEditSigDescriptionTextarea);\r\n\r\n        // jump to \"next\" editable field on save\r\n        var openNextEditDialogOnSave = function(fields){\r\n            fields.on('save', function(e, a){\r\n\r\n                var currentField = $(this);\r\n\r\n                setTimeout(function() {\r\n                    var nextField = getNextEditableField(currentField);\r\n                    nextField.editable('show');\r\n\r\n                    // update scanning progressbar if sig \"type\" has changed AND\r\n                    // the current field is in the \"primary\" table (not the \"add\" new sig row)\r\n                    if(\r\n                        $(e.target).hasClass(config.sigTableEditSigGroupSelect) &&\r\n                        tableElement.hasClass(config.sigTablePrimaryClass)\r\n                    ){\r\n                        currentField.parents('.' + config.moduleClass).updateScannedSignaturesBar({showNotice: true});\r\n                    }\r\n                }, 200);\r\n            });\r\n        };\r\n\r\n        // helper function - get the next editable field in next table column\r\n        var getNextEditableField = function(field){\r\n            var nextEditableField = $(field).closest('td').next().find('.editable');\r\n            return $(nextEditableField);\r\n        };\r\n\r\n        /**\r\n         * add map/system specific data for each editable field in the sig-table\r\n         * @param params\r\n         * @returns {*}\r\n         */\r\n        var modifyFieldParamsOnSend = function(params){\r\n            params.systemId = systemData.id;\r\n\r\n            return params;\r\n        };\r\n\r\n        // set global xEditable options for all table fields\r\n        $.extend($.fn.editable.defaults, {\r\n            url: Init.path.saveSignatureData,\r\n            dataType: 'json',\r\n            mode: 'popup',\r\n            container: 'body',\r\n            error: function(jqXHR, newValue){\r\n                var reason = '';\r\n                var status = '';\r\n                if(jqXHR.name){\r\n                    // save error new sig (mass save)\r\n                    reason = jqXHR.name;\r\n                    status = 'Error';\r\n                }else{\r\n                    reason = jqXHR.responseJSON.text;\r\n                    status = jqXHR.status;\r\n                }\r\n\r\n                Util.showNotify({title: status + ': save signature', text: reason, type: 'error'});\r\n                $(document).setProgramStatus('problem');\r\n                return reason;\r\n            }\r\n        });\r\n\r\n\r\n        // Input sig name ---------------------------------------------------------------------------------------------\r\n        sigNameFields.editable({\r\n            type: 'text',\r\n            title: 'signature id',\r\n            name: 'name',\r\n            emptytext: '? ? ?',\r\n            validate: function(value) {\r\n                if($.trim(value).length < 3) {\r\n                    return 'Id is less than min of \"3\"';\r\n                }else if($.trim(value).length > 10){\r\n                    return 'Id is more than max of \"10\"';\r\n                }\r\n            },\r\n            params: modifyFieldParamsOnSend,\r\n            success: function(response, newValue){\r\n                if(response){\r\n                    var signatureTypeField = $(this);\r\n                    var rowElement = signatureTypeField.parents('tr');\r\n                    var newRowData = response.signatures[0];\r\n\r\n                    // update \"updated\" cell\r\n                    updateSignatureCell(rowElement, 6, newRowData.updated);\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        // Select sig group (master) ----------------------------------------------------------------------------------\r\n        sigGroupFields.editable({\r\n            type: 'select',\r\n            title: 'group',\r\n            name: 'groupId',\r\n            emptytext: 'unknown',\r\n            onblur: 'submit',\r\n            showbuttons: false,\r\n            params: modifyFieldParamsOnSend,\r\n            source: function(){\r\n\r\n                var signatureGroupField = $(this);\r\n                var systemTypeId = parseInt( signatureGroupField.attr('data-systemTypeId') );\r\n\r\n                // get all available Signature Types\r\n                var availableTypes = signatureGroupsLabels;\r\n\r\n                // add empty option\r\n                availableTypes[0] = '';\r\n\r\n                return availableTypes;\r\n            },\r\n            success: function(response, newValue){\r\n                var signatureTypeField = $(this);\r\n                var rowElement = signatureTypeField.parents('tr');\r\n                newValue = parseInt(newValue);\r\n\r\n                if(response){\r\n                    var newRowData = response.signatures[0];\r\n\r\n                    // update \"updated\" cell\r\n                    updateSignatureCell(rowElement, 6, newRowData.updated);\r\n                }\r\n\r\n                // find related \"type\" select (same row) and change options\r\n                var typeSelect = getNextEditableField(signatureTypeField);\r\n\r\n                var systemTypeId = parseInt( signatureTypeField.attr('data-systemTypeId') );\r\n                var areaId = parseInt( signatureTypeField.attr('data-areaid') );\r\n\r\n                var newSelectOptions = getAllSignatureNames(systemData, systemTypeId, areaId, newValue);\r\n                typeSelect.editable('option', 'source', newSelectOptions);\r\n                typeSelect.editable('setValue', null);\r\n\r\n                if(\r\n                    newValue > 0 &&\r\n                    newSelectOptions.length > 0\r\n                ){\r\n                    typeSelect.editable('enable');\r\n                }else{\r\n                    typeSelect.editable('disable');\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        // Select sig type (slave: depends on sig type) ---------------------------------------------------------------\r\n        sigTypeFields.on('init', function(e, editable) {\r\n            // check if there are initial options available\r\n            var options = editable.input.options.source.bind(e.target)();\r\n            if(options.length <= 0){\r\n                editable.disable();\r\n            }\r\n        });\r\n\r\n        sigTypeFields.editable({\r\n            type: 'select',\r\n            title: 'type',\r\n            name: 'typeId',\r\n            emptytext: 'unknown',\r\n            onblur: 'submit',\r\n            showbuttons: false,\r\n            params: modifyFieldParamsOnSend,\r\n            source: function(){\r\n                var signatureTypeField = $(this);\r\n\r\n                var systemTypeId = parseInt( signatureTypeField.attr('data-systemTypeId') );\r\n                var areaId = parseInt( signatureTypeField.attr('data-areaid') );\r\n                var groupId = parseInt( signatureTypeField.attr('data-groupId') );\r\n                var availableSigs = getAllSignatureNames(systemData, systemTypeId, areaId, groupId);\r\n\r\n                return availableSigs;\r\n            },\r\n            success: function(response, newValue){\r\n                if(response){\r\n                    var signatureTypeField = $(this);\r\n                    var rowElement = signatureTypeField.parents('tr');\r\n                    var newRowData = response.signatures[0];\r\n\r\n                    // update \"updated\" cell\r\n                    updateSignatureCell(rowElement, 6, newRowData.updated);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Textarea sig description -----------------------------------------------------------------------------------\r\n        sigDescriptionFields.editable({\r\n            type: 'textarea',\r\n            title: 'description',\r\n            name: 'description',\r\n            emptytext: '<i class=\"fa fa-fw fa-lg fa-pencil\"></i>',\r\n            onblur: 'submit',\r\n            mode: 'inline',\r\n            showbuttons: false,\r\n            inputclass: config.editableDescriptionInputClass,\r\n            params: modifyFieldParamsOnSend,\r\n            success: function(response, newValue){\r\n                if(response){\r\n                    var signatureTypeField = $(this);\r\n                    var rowElement = signatureTypeField.parents('tr');\r\n                    var newRowData = response.signatures[0];\r\n\r\n                    // update \"updated\" cell\r\n                    updateSignatureCell(rowElement, 6, newRowData.updated);\r\n                }\r\n            }\r\n        });\r\n\r\n        // open even\r\n        sigDescriptionFields.on('shown', function(e, editable) {\r\n            // enlarge the tools-action container because the tables gets bigger\r\n            tableElement.parents('.' + config.tableToolsActionClass).css( 'height', '+=35px' );\r\n        });\r\n\r\n        // close event\r\n        sigDescriptionFields.on('hidden', function(e, editable) {\r\n            // enlarge the tools-action container because the tables gets bigger\r\n            tableElement.parents('.' + config.tableToolsActionClass).css( 'height', '-=35px' );\r\n        });\r\n\r\n        // open next field dialog -------------------------------------------------------------------------------------\r\n        openNextEditDialogOnSave(sigNameFields);\r\n        openNextEditDialogOnSave(sigGroupFields);\r\n    };\r\n\r\n    /**\r\n     * get all signatures that can exist for a given system\r\n     * @param systemData\r\n     * @param systemTypeId\r\n     * @param areaId\r\n     * @param groupId\r\n     * @returns {Array}\r\n     */\r\n    var getAllSignatureNames = function(systemData, systemTypeId, areaId, groupId){\r\n        var newSelectOptions = [];\r\n        var cacheKey = [systemTypeId, areaId, groupId].join('_');\r\n        var newSelectOptionsCount = 0;\r\n\r\n        // check for cached signature names\r\n        if(sigNameCache.hasOwnProperty( cacheKey )){\r\n            // cached signatures do not include static WHs!\r\n            newSelectOptions =  sigNameCache[cacheKey].slice(0);\r\n            newSelectOptionsCount = sumSignaturesRecursive('children', newSelectOptions);\r\n        }else{\r\n            // get new Options ----------\r\n            // get all possible \"static\" signature names by the selected groupId\r\n            var tempSelectOptions = Util.getAllSignatureNames(systemTypeId, areaId, groupId);\r\n\r\n            // format options into array with objects advantages: keep order, add more options (whs), use optgroup\r\n            if(tempSelectOptions){\r\n                var fixSelectOptions = [];\r\n                for (var key in tempSelectOptions) {\r\n                    if (\r\n                        key > 0 &&\r\n                        tempSelectOptions.hasOwnProperty(key)\r\n                    ) {\r\n                        newSelectOptionsCount++;\r\n                        fixSelectOptions.push( {value: key, text: tempSelectOptions[key] } );\r\n                    }\r\n                }\r\n\r\n                if(newSelectOptionsCount > 0){\r\n                    if(groupId === 5){\r\n                        // \"wormhole\" selected => multiple <optgroup> available\r\n                        newSelectOptions.push({ text: 'Wandering WHs', children: fixSelectOptions});\r\n                    }else{\r\n                        newSelectOptions = fixSelectOptions;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // wormhole (cached signatures)\r\n            if( groupId === 5 ){\r\n\r\n                // add possible frigate holes\r\n                var frigateHoles = getFrigateHolesBySystem(areaId);\r\n                var frigateWHData = [];\r\n                for(var frigKey in frigateHoles){\r\n                    if (\r\n                        frigKey > 0 &&\r\n                        frigateHoles.hasOwnProperty(frigKey)\r\n                    ) {\r\n                        newSelectOptionsCount++;\r\n                        frigateWHData.push( {value: newSelectOptionsCount, text: frigateHoles[frigKey]} );\r\n                    }\r\n                }\r\n\r\n                if(frigateWHData.length > 0){\r\n                    newSelectOptions.push({ text: 'Frigate WHs', children: frigateWHData});\r\n                }\r\n\r\n                // add possible incoming holes\r\n                var incomingWHData = [];\r\n                for(var incomingKey in Init.incomingWormholes){\r\n                    if (\r\n                        incomingKey > 0 &&\r\n                        Init.incomingWormholes.hasOwnProperty(incomingKey)\r\n                    ) {\r\n                        newSelectOptionsCount++;\r\n                        incomingWHData.push( {value: newSelectOptionsCount, text: Init.incomingWormholes[incomingKey]} );\r\n                    }\r\n                }\r\n\r\n                if(incomingWHData.length > 0){\r\n                    newSelectOptions.push({ text: 'Incoming WHs', children: incomingWHData});\r\n                }\r\n            }else{\r\n                // groups without \"children\" (optgroup) should be sorted by \"value\"\r\n                // this is completely optional and not necessary!\r\n                newSelectOptions = newSelectOptions.sortBy('text');\r\n            }\r\n\r\n            // update cache (clone array) -> further manipulation to this array, should not be cached\r\n            sigNameCache[cacheKey] = newSelectOptions.slice(0);\r\n        }\r\n\r\n        // static wormholes (DO NOT CACHE) (not all C2 WHs have the same statics,...\r\n        if( groupId === 5 ){\r\n            // add static WH(s) for this system\r\n            if(systemData.statics){\r\n                var staticWHData = [];\r\n                for(var i = 0; i < systemData.statics.length; i++){\r\n                    var staticWHName = systemData.statics[i].name + ' - ' + systemData.statics[i].security;\r\n\r\n                    newSelectOptionsCount++;\r\n                    staticWHData.push( {value: newSelectOptionsCount, text: staticWHName} );\r\n                }\r\n\r\n                if(staticWHData.length > 0){\r\n                    newSelectOptions.unshift({ text: 'Static WHs', children: staticWHData});\r\n                }\r\n            }\r\n        }\r\n\r\n        // if selectOptions available -> add \"empty\" option as well\r\n        if(newSelectOptionsCount > 0){\r\n            newSelectOptions.unshift({ value: '0', text: ''});\r\n        }\r\n\r\n        return newSelectOptions;\r\n    };\r\n\r\n    /**\r\n     * recursive sum array.length for a given object key\r\n     * -> e.g.\r\n     * {\r\n     *     first: {\r\n     *         count = [4, 2, 1]\r\n     *         test = { ... }\r\n     *     },\r\n     *     second: {\r\n     *         count = [12, 13]\r\n     *         test = { ... }\r\n     *     }\r\n     * }\r\n     * -> sumSignaturesRecursive('count', obj) => 5;\r\n     * @param key\r\n     * @param obj\r\n     * @returns {number}\r\n     */\r\n    var sumSignaturesRecursive = function(key, obj){\r\n        var sum = 0;\r\n\r\n        for (var prop in obj) {\r\n            if (obj.hasOwnProperty(prop) && key === prop) {\r\n                sum += obj[prop].length;\r\n            }\r\n            else if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\r\n                sum += sumSignaturesRecursive(key, obj[prop]);\r\n            }\r\n        }\r\n\r\n        return sum;\r\n    };\r\n\r\n    /**\r\n     * get possible frig holes that could spawn in a system\r\n     * filtered by \"systemTypeId\"\r\n     * @param systemTypeId\r\n     * @returns {{}}\r\n     */\r\n    var getFrigateHolesBySystem = function(systemTypeId){\r\n        var signatureNames = {};\r\n\r\n        if(Init.frigateWormholes[systemTypeId]){\r\n            signatureNames =  Init.frigateWormholes[systemTypeId];\r\n        }\r\n\r\n        return signatureNames;\r\n    };\r\n\r\n    /**\r\n     * deletes signature rows from signature table\r\n     * @param rows\r\n     */\r\n    var deleteSignatures = function(rows){\r\n\r\n        var deletedSignatures = 0;\r\n\r\n        var moduleElement = $('.' + config.systemSigModuleClass);\r\n        var data = rows.data();\r\n        var signatureTableApi = signatureTable.api();\r\n        var rowElements = rows.nodes().to$();\r\n        var signatureCount = data.length;\r\n\r\n        var signatureIds = [];\r\n        for(var i = 0; i < data.length; i++){\r\n            signatureIds.push(data[i].id);\r\n        }\r\n\r\n        var requestData = {\r\n            signatureIds: signatureIds\r\n        };\r\n\r\n        // animation callback function\r\n        var removeCallback = function(rowElement){\r\n            // delete signature row\r\n            signatureTableApi.row(rowElement).remove().draw();\r\n\r\n            deletedSignatures++;\r\n\r\n            if(deletedSignatures === signatureCount){\r\n                // all animations finished\r\n\r\n                // update signature bar\r\n                moduleElement.updateScannedSignaturesBar({showNotice: false});\r\n\r\n                Util.showNotify({title: 'Signature deleted', text: signatureCount + ' signatures deleted', type: 'success'});\r\n            }\r\n        };\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.deleteSignatureData,\r\n            data: requestData,\r\n            dataType: 'json'\r\n        }).done(function(data){\r\n\r\n            for(var j = 0; j < rowElements.length; j++){\r\n                // removeRow\r\n                $(rowElements[j]).toggleTableRow(removeCallback);\r\n            }\r\n\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            Util.showNotify({title: jqXHR.status + ': Delete signature', text: reason, type: 'warning'});\r\n            $(document).setProgramStatus('problem');\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * adds a new row to signature Table\r\n     * @param systemData\r\n     * @param signatureData\r\n     * @param animate\r\n     * @returns {*}\r\n     */\r\n    var addSignatureRow = function(systemData, signatureData, animate){\r\n\r\n        var newSignatureData = formatSignatureData(systemData, [signatureData], fullSignatureOptions);\r\n\r\n        // insert new row in main signature table\r\n        var tablePrimaryElement = $('.' + config.sigTablePrimaryClass);\r\n        var dataTablePrimary = tablePrimaryElement.DataTable();\r\n        var newRowNode = dataTablePrimary.row.add(newSignatureData.shift()).draw().nodes();\r\n        var newRowElement = newRowNode.to$();\r\n\r\n        if(animate === true){\r\n            newRowElement.hide();\r\n\r\n            newRowElement.toggleTableRow(function(newRowElement){\r\n                // make new row editable\r\n\r\n                newRowElement.makeEditable(systemData);\r\n\r\n                // update scan progress bar\r\n                newRowElement.parents('.' + config.moduleClass).updateScannedSignaturesBar({showNotice: true});\r\n            });\r\n        }else{\r\n            newRowElement.makeEditable(systemData);\r\n        }\r\n\r\n        return newRowElement;\r\n    };\r\n\r\n    /**\r\n     * show/hides a table <tr> tag\r\n     * @param callback\r\n     */\r\n    $.fn.toggleTableRow = function(callback){\r\n        var rowElement = $(this);\r\n        var cellElements = rowElement.children('td');\r\n\r\n        var duration = 100;\r\n        var tdCounter = 0;\r\n\r\n\r\n        // wrap each <td> into a container (for better animation performance)\r\n        // slideUp new wrapper divs\r\n        if(rowElement.is(':visible')){\r\n            // hide row\r\n\r\n            // stop sig counter by adding a stopClass to each <td>, remove padding\r\n            cellElements.addClass('stopCounter')\r\n                .velocity({\r\n                    paddingTop: 0,\r\n                    paddingBottom: 0\r\n                },{\r\n                    duration: duration\r\n                }).wrapInner('<div>')\r\n                .children()\r\n                .css({\r\n                    'willChange': 'height'\r\n                }).velocity('slideUp', {\r\n                    duration: duration,\r\n                    complete: function(animationElements){\r\n                        tdCounter++;\r\n                        // execute callback when last <td> animation finished\r\n                        if(tdCounter === animationElements.length){\r\n                            // remove wrapper\r\n                            $(animationElements).children().unwrap();\r\n\r\n                            if(callback !== undefined){\r\n                                callback(rowElement);\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n        }else{\r\n            // show row\r\n\r\n            // remove padding on \"hidden\" cells for smother animation\r\n            cellElements.css({\r\n                'padding-top': 0,\r\n                'padding-bottom': 0,\r\n                'willChange': 'padding-top, padding-top, height'\r\n            });\r\n\r\n            // add hidden wrapper for ea\r\n            cellElements.wrapInner($('<div>').hide());\r\n\r\n            // show row for padding animation\r\n            rowElement.show();\r\n\r\n            cellElements.velocity({\r\n                paddingTop: '4px',\r\n                paddingBottom: '4px'\r\n            },{\r\n                duration: duration,\r\n                queue: false,\r\n                complete: function(){\r\n                    // animate <td> wrapper\r\n                    cellElements.children()\r\n                        .css({\r\n                            'willChange': 'height'\r\n                        }).velocity('slideDown', {\r\n                            duration: duration,\r\n                            complete: function(animationElements){\r\n                                tdCounter++;\r\n                                // execute callback when last <td> animation finished\r\n                                if(tdCounter === animationElements.length){\r\n\r\n                                    // remove wrapper\r\n                                    var wrapperElements = cellElements.children();\r\n                                    for(var i = 0; i < wrapperElements.length; i++){\r\n                                        var currentWrapper = $(wrapperElements[i]);\r\n                                        if(currentWrapper.children().length > 0){\r\n                                            currentWrapper.children().unwrap();\r\n                                        }else{\r\n                                            currentWrapper.parent().html( currentWrapper.html() );\r\n                                        }\r\n                                    }\r\n\r\n                                    if(callback !== undefined){\r\n                                        callback(rowElement);\r\n                                    }\r\n\r\n                                }\r\n                            }\r\n                        });\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * draw a signature table with data\r\n     * @param signatureData\r\n     * @param systemData\r\n     * @returns {*}\r\n     */\r\n    $.fn.drawSignatureTable = function(signatureData, systemData){\r\n\r\n        var moduleElement = $(this);\r\n\r\n        // create new signature table ---------------------------------------------------------------------------------\r\n        var table = $('<table>', {\r\n            class: ['display', 'compact', 'nowrap', config.sigTableClass, config.sigTablePrimaryClass].join(' ')\r\n        });\r\n\r\n        // create table footer ----------------------------------------------------------------------------------------\r\n        // get column count from default dataTable config\r\n        var columnCount = $.fn.dataTable.defaults.columnDefs.length;\r\n        var footerHtml = '<tfoot><tr>';\r\n        for(let i = 0; i < columnCount; i++){\r\n            footerHtml += '<td></td>';\r\n        }\r\n        footerHtml += '</tr></tfoot>';\r\n        table.append(footerHtml);\r\n\r\n        moduleElement.append(table);\r\n\r\n        var dataTableOptions = {\r\n            data: signatureData,\r\n            initComplete: function (settings, json){\r\n                // setup filter select in footer\r\n                // column indexes that need a filter select\r\n                var filterColumnIndexes = [2];\r\n\r\n                this.api().columns(filterColumnIndexes).every(function(){\r\n                    var column = this;\r\n                    var headerLabel = $(column.header()).text();\r\n                    var selectField = $('<a class=\"pf-editable ' +\r\n                        config.moduleIcon + ' ' +\r\n                        config.editableFilterInputClass +\r\n                        '\" href=\"#\" data-type=\"select\" data-name=\"' + headerLabel + '\"></a>');\r\n\r\n                    // get all available options from column\r\n                    var source = {};\r\n                    column.data().unique().sort(function(a,b){\r\n                        // sort alphabetically\r\n                        var valA = a.filter.toLowerCase();\r\n                        var valB = b.filter.toLowerCase();\r\n\r\n                        if(valA < valB) return -1;\r\n                        if(valA > valB) return 1;\r\n                        return 0;\r\n                    }).each(function(callData){\r\n                        if(callData.filter){\r\n                            source[callData.filter] = callData.filter;\r\n                        }\r\n                    });\r\n\r\n                    // add empty option\r\n                    source[0] = '';\r\n\r\n                    // add field to footer\r\n                    selectField.appendTo( $(column.footer()).empty() );\r\n\r\n                    selectField.editable({\r\n                        emptytext: '<i class=\"fa fa-filter fa-fw\"></i>',\r\n                        onblur: 'submit',\r\n                        title: 'filter',\r\n                        showbuttons: false,\r\n                        source: source,\r\n                        value: 0\r\n                    });\r\n\r\n                    selectField.on('save', { column: column }, function(e, params) {\r\n                        var val = $.fn.dataTable.util.escapeRegex( params.newValue );\r\n                        e.data.column.search( val !== '0' ? '^' + val + '$' : '', true, false ).draw();\r\n                    });\r\n                });\r\n            }\r\n        };\r\n\r\n        // create signature table and store the jquery object global for this module\r\n        signatureTable = table.dataTable(dataTableOptions);\r\n\r\n        // make Table editable\r\n        signatureTable.makeEditable(systemData);\r\n\r\n        moduleElement.updateScannedSignaturesBar({showNotice: true});\r\n\r\n        return signatureTable;\r\n    };\r\n\r\n    /**\r\n     * format signature data array into dataTable structure\r\n     * @param systemData\r\n     * @param signatureData\r\n     * @param options\r\n     * @returns {Array}\r\n     */\r\n    var formatSignatureData = function(systemData, signatureData, options){\r\n\r\n        var formattedData = [];\r\n\r\n        // security check\r\n        if(\r\n            systemData &&\r\n            systemData.id &&\r\n            systemData.id > 0\r\n        ){\r\n            var systemTypeId = systemData.type.id;\r\n\r\n            // areaId is required as a key for signature names\r\n            // if areaId is 0, no signature data is available for this system\r\n            var areaId = Util.getAreaIdBySecurity(systemData.security);\r\n\r\n            for(var i = 0; i < signatureData.length; i++){\r\n                var data = signatureData[i];\r\n\r\n                var tempData = {};\r\n\r\n                // set id ---------------------------------------------------------------------------------------------\r\n                var sigId = 0;\r\n                if(data.id > 0){\r\n                    sigId = data.id;\r\n                }\r\n                tempData.id = sigId;\r\n\r\n                // set status -----------------------------------------------------------------------------------------\r\n                var statusClass = '';\r\n                if(data.updated.character !== undefined){\r\n                    statusClass = Util.getStatusInfoForCharacter(data.updated.character, 'class');\r\n                }\r\n                var status = '<i class=\"fa fa-fw fa-circle pf-user-status ' + statusClass + '\"></i>';\r\n\r\n                tempData.status = {\r\n                    status: status,\r\n                    status_sort: statusClass\r\n                };\r\n\r\n                // set name -------------------------------------------------------------------------------------------\r\n                var sigName = '<a href=\"#\" class=\"' + config.sigTableEditSigNameInput + '\" ';\r\n                if(data.id > 0){\r\n                    sigName += 'data-pk=\"' + data.id + '\" ';\r\n                }\r\n                sigName += '>' + data.name + '</a>';\r\n\r\n                tempData.name = sigName;\r\n\r\n                // set group id ---------------------------------------------------------------------------------------\r\n                var sigGroup = '<a href=\"#\" class=\"' + config.sigTableEditSigGroupSelect + '\" ';\r\n                if(data.id > 0){\r\n                    sigGroup += 'data-pk=\"' + data.id + '\" ';\r\n                }\r\n                sigGroup += 'data-systemTypeId=\"' + systemTypeId + '\" ';\r\n                sigGroup += 'data-areaId=\"' + areaId + '\" ';\r\n                sigGroup += 'data-value=\"' + data.groupId + '\" ';\r\n                sigGroup += '></a>';\r\n\r\n                tempData.group = {\r\n                    group: sigGroup,\r\n                    sort: signatureGroupsLabels[data.groupId],\r\n                    filter: signatureGroupsLabels[data.groupId]\r\n                };\r\n\r\n                // set type id ----------------------------------------------------------------------------------------\r\n                var sigType = '<a href=\"#\" class=\"' + config.sigTableEditSigTypeSelect + '\" ';\r\n                if(data.id > 0){\r\n                    sigType += 'data-pk=\"' + data.id + '\" ';\r\n                }\r\n\r\n                // set disabled if sig type is not selected\r\n                if(data.groupId < 1){\r\n                    sigType += 'data-disabled=\"1\" ';\r\n                }\r\n\r\n                sigType += 'data-systemTypeId=\"' + systemTypeId + '\" ';\r\n                sigType += 'data-areaId=\"' + areaId + '\" ';\r\n                sigType += 'data-groupId=\"' + data.groupId + '\" ';\r\n                sigType += 'data-value=\"' + data.typeId + '\" ';\r\n                sigType += '></a>';\r\n\r\n                tempData.type = sigType;\r\n\r\n                // set description ------------------------------------------------------------------------------------\r\n                var sigDescription = '<a href=\"#\" class=\"' + config.sigTableEditSigDescriptionTextarea + '\" ';\r\n                if(data.id > 0){\r\n                    sigDescription += 'data-pk=\"' + data.id + '\" ';\r\n                }\r\n                sigDescription += '>' + data.description + '</a>';\r\n\r\n                tempData.description = sigDescription;\r\n\r\n                // set created ----------------------------------------------------------------------------------------\r\n                tempData.created = data.created;\r\n\r\n                // set updated ----------------------------------------------------------------------------------------\r\n                tempData.updated = data.updated;\r\n\r\n                // info icon ------------------------------------------------------------------------------------------\r\n                var infoButton = '';\r\n                if(data.id > 0){\r\n                    infoButton = '<i class=\"fa fa-fw fa-question-circle\"></i>';\r\n                }\r\n                tempData.info = infoButton;\r\n\r\n                // action icon ----------------------------------------------------------------------------------------\r\n\r\n                var actionButton = '<i class=\"fa ' + options.actionClass + '\"></i>';\r\n                tempData.action = {\r\n                    action: options.action,\r\n                    button: actionButton\r\n                };\r\n\r\n                formattedData.push(tempData);\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return formattedData;\r\n    };\r\n\r\n    /**\r\n     * setup dataTable options for all signatureTables\r\n     * @param systemData\r\n     */\r\n    var initSignatureDataTable = function(systemData){\r\n\r\n        $.extend( true, $.fn.dataTable.defaults, {\r\n            pageLength: -1,\r\n            lengthMenu: [[5, 10, 25, 50, -1], [5, 10, 25, 50, 'All']],\r\n            order: [1, 'asc'],\r\n            autoWidth: false,\r\n            responsive: {\r\n                details: false\r\n            },\r\n            language: {\r\n                emptyTable:  'No signatures added',\r\n                zeroRecords: 'No signatures found',\r\n                lengthMenu:  'Show _MENU_ signatures',\r\n                info:        'Showing _START_ to _END_ of _TOTAL_ signatures'\r\n            },\r\n            columnDefs: [\r\n                {\r\n                    targets: 0,\r\n                    orderable: true,\r\n                    searchable: false,\r\n                    title: '',\r\n                    width: '10px',\r\n                    class: ['text-center', 'min-tablet-l'].join(' '),\r\n                    data: 'status',\r\n                    type: 'html',\r\n                    render: {\r\n                        _: 'status',\r\n                        sort: 'status_sort'\r\n                    }\r\n                },{\r\n                    targets: 1,\r\n                    orderable: true,\r\n                    searchable: true,\r\n                    title: 'id',\r\n                    type: 'html',\r\n                    width: '30px',\r\n                    data: 'name'\r\n                },{\r\n                    targets: 2,\r\n                    orderable: true,\r\n                    searchable: true,\r\n                    title: 'group',\r\n                    type: 'html',\r\n                    width: '50px',\r\n                    data: 'group',\r\n                    render: {\r\n                        _: 'group',\r\n                        sort: 'sort',\r\n                        filter: 'filter'\r\n                    }\r\n                },{\r\n                    targets: 3,\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    title: 'type',\r\n                    type: 'html',\r\n                    width: '180px',\r\n                    data: 'type'\r\n                },{\r\n                    targets: 4,\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    title: 'description',\r\n                    type: 'html',\r\n                    data: 'description'\r\n                },{\r\n                    targets: 5,\r\n                    title: 'created',\r\n                    width: '90px',\r\n                    searchable: false,\r\n                    className: ['text-right', config.sigTableCounterClass, config.sigTableCreatedCellClass, 'min-tablet-l'].join(' '),\r\n                    data: 'created',\r\n                    render: {\r\n                        _: 'created',\r\n                        sort: 'created'\r\n                    },\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n                        $(cell).initTimestampCounter();\r\n                    }\r\n                },{\r\n                    targets: 6,\r\n                    title: 'updated',\r\n                    width: '90px',\r\n                    searchable: false,\r\n                    className: ['text-right', config.sigTableCounterClass, config.sigTableUpdatedCellClass, 'min-tablet-l'].join(' '),\r\n                    data: 'updated',\r\n                    render: {\r\n                        _: 'updated',\r\n                        sort: 'updated'\r\n                    },\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n                        $(cell).initTimestampCounter();\r\n\r\n                        // highlight cell\r\n                        var diff = Math.floor((new Date()).getTime()) - cellData.updated * 1000;\r\n\r\n                        // age > 1 day\r\n                        if( diff > 86400000){\r\n                            $(cell).addClass('txt-color txt-color-warning');\r\n                        }\r\n                    }\r\n                },{\r\n                    targets: 7,\r\n                    title: '',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: '10px',\r\n                    class: 'pf-help text-center',\r\n                    data: 'info',\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n\r\n                        if(rowData.id > 0){\r\n\r\n                            // add row tooltip\r\n                            var tooltipData = {\r\n                                created: rowData.created,\r\n                                updated: rowData.updated\r\n                            };\r\n\r\n                            $(cell).addCharacterInfoTooltip( tooltipData );\r\n                        }\r\n                    }\r\n                },{\r\n                    targets: 8,\r\n                    title: '',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: '10px',\r\n                    class: ['text-center', config.sigTableActionCellClass].join(' '),\r\n                    data: 'action',\r\n                    render: {\r\n                        _: 'button',\r\n                        sort: 'action'\r\n                    },\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n                        var tempTableElement = this;\r\n                        var rowElement = $(cell).parents('tr');\r\n\r\n                        switch(cellData.action){\r\n                            case 'add':\r\n                                // add new signature ------------------------------------------------------------------\r\n                                $(cell).on('click', function(e) {\r\n                                    // submit all fields within a table row\r\n                                    var formFields = rowElement.find('.editable');\r\n\r\n                                    // the \"hide\" makes sure to take care about open editable fields (e.g. description)\r\n                                    // otherwise, changes would not be submitted in this field (not necessary)\r\n                                    formFields.editable('hide');\r\n\r\n                                    // submit all xEditable fields\r\n                                    formFields.editable('submit', {\r\n                                        url: Init.path.saveSignatureData,\r\n                                        ajaxOptions: {\r\n                                            dataType: 'json', //assuming json response\r\n                                            beforeSend: function( xhr, settings ){\r\n                                                lockSignatureTable();\r\n                                            }\r\n                                        },\r\n                                        data: {\r\n                                            systemId: systemData.id, // additional data to submit\r\n                                            pk: 0 // new data no primary key\r\n                                        },\r\n                                        error: $.fn.editable.defaults.error, // user default xEditable error function\r\n                                        success: function (data, editableConfig) {\r\n                                            unlockSignatureTable(false);\r\n\r\n                                            var newRowElement = addSignatureRow(systemData, data.signatures[0], true);\r\n\r\n                                            // highlight\r\n                                            newRowElement.pulseTableRow('added');\r\n\r\n                                            // prepare \"add signature\" table for new entry -> reset -------------------\r\n                                            var signatureData = formatSignatureData(systemData, [emptySignatureData], emptySignatureOptions);\r\n\r\n                                            var dataSecondaryElement = $('.' + config.sigTableSecondaryClass);\r\n                                            var dataTableSecondary = dataSecondaryElement.DataTable();\r\n                                            var newAddRowElement = dataTableSecondary.clear().row.add(signatureData.shift()).draw().nodes();\r\n\r\n                                            newAddRowElement.to$().makeEditable(systemData);\r\n\r\n                                            Util.showNotify({\r\n                                                title: 'Signature added',\r\n                                                text: 'Name: ' + data.name,\r\n                                                type: 'success'\r\n                                            });\r\n                                        }\r\n                                    });\r\n                                });\r\n                                break;\r\n                            case 'delete':\r\n                                // delete signature -------------------------------------------------------------------\r\n                                var confirmationSettings = {\r\n                                    container: 'body',\r\n                                    placement: 'left',\r\n                                    btnCancelClass: 'btn btn-sm btn-default',\r\n                                    btnCancelLabel: 'cancel',\r\n                                    btnCancelIcon: 'fa fa-fw fa-ban',\r\n                                    title: 'delete signature',\r\n                                    btnOkClass: 'btn btn-sm btn-danger',\r\n                                    btnOkLabel: 'delete',\r\n                                    btnOkIcon: 'fa fa-fw fa-close',\r\n                                    onConfirm : function(e, target){\r\n                                        var deleteRowElement = $(target).parents('tr');\r\n                                        var row = tempTableElement.DataTable().rows(deleteRowElement);\r\n                                        deleteSignatures(row);\r\n                                    }\r\n                                };\r\n\r\n                                // init confirmation dialog\r\n                                $(cell).confirmation(confirmationSettings);\r\n\r\n\r\n                                break;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    };\r\n\r\n    /**\r\n     * set module observer and look for relevant signature data to update\r\n     * @param moduleElement\r\n     */\r\n    var setModuleObserver = function(moduleElement){\r\n        var tablePrimaryElement = $('.' + config.sigTablePrimaryClass);\r\n        var dataTablePrimary = signatureTable.DataTable();\r\n        var signatureTableApi = signatureTable.api();\r\n\r\n        $(document).off('pf:updateSystemSignatureModule').on('pf:updateSystemSignatureModule', function(e, data){\r\n            if(data.signatures){\r\n                moduleElement.updateSignatureTable(data.signatures, true);\r\n            }\r\n\r\n        });\r\n\r\n        // set multi row select ---------------------------------------------------------------------------------------\r\n        tablePrimaryElement.on('click', 'tr', function(e){\r\n            if(e.ctrlKey) {\r\n                $(this).toggleClass('selected');\r\n\r\n                // check delete button\r\n                checkDeleteSignaturesButton();\r\n            }\r\n        });\r\n\r\n        // draw event for signature table -----------------------------------------------------------------------------\r\n        signatureTableApi.on('draw.dt', function(){\r\n            // check delete button\r\n            checkDeleteSignaturesButton();\r\n        });\r\n    };\r\n\r\n    /**\r\n     * check the \"delete signature\" button. show/hide the button if a signature is selected\r\n     */\r\n    var checkDeleteSignaturesButton = function(){\r\n\r\n        var selectedRows = getSelectedRows(signatureTable);\r\n        var selectedRowCount = selectedRows.data().length;\r\n        var clearButton = $('.' + config.sigTableClearButtonClass);\r\n\r\n        if(selectedRowCount > 0){\r\n            var allRows = getRows(signatureTable);\r\n            var rowCount = allRows.data().length;\r\n\r\n            var badgetText = selectedRowCount;\r\n            if(selectedRowCount >= rowCount){\r\n                badgetText = 'all';\r\n            }\r\n            clearButton.find('.badge').text( badgetText );\r\n\r\n            // update clear signatures button text\r\n            clearButton.velocity('stop');\r\n\r\n            if( clearButton.is(':hidden') ){\r\n                // show button\r\n                clearButton.velocity('transition.bounceIn', {\r\n                    duration: 180\r\n                });\r\n            }else{\r\n                // highlight button\r\n                clearButton.velocity('callout.pulse', {\r\n                    duration: 240\r\n                });\r\n            }\r\n        }else{\r\n            // hide button\r\n            clearButton.velocity('transition.bounceOut', {\r\n                duration: 180\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * get all rows of a table\r\n     * @param table\r\n     * @returns {*}\r\n     */\r\n    var getRows = function(table){\r\n        var tableApi = table.api();\r\n        var rows = tableApi.rows();\r\n\r\n        return rows;\r\n    };\r\n\r\n    /**\r\n     * get all selected rows of a table\r\n     * @param table\r\n     * @returns {*}\r\n     */\r\n    var getSelectedRows = function(table){\r\n        var tableApi = table.api();\r\n\r\n        var selectedRows = tableApi.rows('.selected');\r\n\r\n        return selectedRows;\r\n    };\r\n\r\n    /**\r\n     * get module element\r\n     * @param parentElement\r\n     * @param systemData\r\n     * @returns {*|HTMLElement}\r\n     */\r\n    var getModule = function(parentElement, systemData){\r\n\r\n        // create new module container\r\n        var moduleElement = $('<div>', {\r\n            class: [config.moduleClass, config.systemSigModuleClass].join(' '),\r\n            css: {opacity: 0}\r\n        });\r\n\r\n        // headline\r\n        var headline = $('<h5>', {\r\n            text: 'Signatures'\r\n        });\r\n\r\n        moduleElement.append(headline);\r\n\r\n        $(parentElement).append(moduleElement);\r\n\r\n        // init dataTables\r\n        initSignatureDataTable(systemData);\r\n\r\n        // draw \"new signature\" add table -----------------------------------------------------------------------------\r\n\r\n        moduleElement.drawSignatureTableToolbar(systemData);\r\n\r\n        // request signature data for system --------------------------------------------------------------------------\r\n\r\n        var requestData = {\r\n            systemIds: [systemData.id]\r\n        };\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.getSignatures,\r\n            data: requestData,\r\n            dataType: 'json'\r\n        }).done(function(signatureData){\r\n\r\n            var signatureTableData = formatSignatureData(systemData, signatureData, fullSignatureOptions);\r\n\r\n            // draw signature table\r\n            moduleElement.drawSignatureTable(signatureTableData, systemData);\r\n\r\n            // set module observer\r\n            setModuleObserver(moduleElement);\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + error;\r\n            Util.showNotify({title: jqXHR.status + ': Get signatures', text: reason, type: 'warning'});\r\n            $(document).setProgramStatus('problem');\r\n        });\r\n\r\n        return moduleElement;\r\n    };\r\n\r\n    /**\r\n     * main module load function\r\n     * @param systemData\r\n     */\r\n    $.fn.drawSignatureTableModule = function(systemData){\r\n\r\n        var parentElement = $(this);\r\n\r\n        // show module\r\n        var showModule = function(moduleElement){\r\n            if(moduleElement){\r\n                moduleElement.velocity('transition.slideDownIn', {\r\n                    duration: Init.animationSpeed.mapModule,\r\n                    delay: Init.animationSpeed.mapModule,\r\n                    complete: function(){\r\n                        unlockSignatureTable(true);\r\n                    }\r\n                });\r\n\r\n            }\r\n        };\r\n\r\n        // some custom array functions\r\n        var initArrayFunctions = function(){\r\n            /**\r\n             * sort array of objects by property name\r\n             * @param p\r\n             * @returns {Array.<T>}\r\n             */\r\n            Array.prototype.sortBy = function(p) {\r\n                return this.slice(0).sort(function(a,b) {\r\n                    return (a[p] > b[p]) ? 1 : (a[p] < b[p]) ? -1 : 0;\r\n                });\r\n            };\r\n        };\r\n\r\n        // check if module already exists\r\n        var moduleElement = parentElement.find('.' + config.systemSigModuleClass);\r\n\r\n        if(moduleElement.length > 0){\r\n            // disable update\r\n            lockSignatureTable();\r\n\r\n            moduleElement.velocity('transition.slideDownOut', {\r\n                duration: Init.animationSpeed.mapModule,\r\n                complete: function(tempElement){\r\n                     // Destroying the data tables throws\r\n                     // save remove of all dataTables\r\n                     signatureTable.api().destroy();\r\n\r\n                    $(tempElement).remove();\r\n\r\n                    moduleElement = getModule(parentElement, systemData);\r\n                    // make modules appear \"nice\"\r\n                    moduleElement.delay(150);\r\n                    showModule(moduleElement);\r\n                }\r\n            });\r\n        }else{\r\n            // init array prototype functions\r\n            initArrayFunctions();\r\n\r\n            moduleElement = getModule(parentElement, systemData);\r\n            showModule(moduleElement);\r\n        }\r\n    };\r\n\r\n});\n",
    "/**\r\n * system route module\r\n */\r\n\r\ndefine('app/ui/system_route',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'bootbox',\r\n    'app/map/util'\r\n], function($, Init, Util, bootbox, MapUtil) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // module info\r\n        moduleClass: 'pf-module',                                               // class for each module\r\n\r\n        routeCacheTTL: 10,                                                      // route cache timer (client) in seconds\r\n\r\n        // system route module\r\n        systemRouteModuleClass: 'pf-system-route-module',                       // class  for this module\r\n\r\n        // headline toolbar\r\n        systemModuleHeadlineIcon: 'pf-module-icon-button',                      // class for toolbar icons in the head\r\n        systemModuleHeadlineIconSearch: 'pf-module-icon-button-search',         // class for \"search\" icon\r\n        systemModuleHeadlineIconSettings: 'pf-module-icon-button-settings',     // class for \"settings\" icon\r\n        systemModuleHeadlineIconRefresh: 'pf-module-icon-button-refresh',       // class for \"refresh\" icon\r\n\r\n        systemSecurityClassPrefix: 'pf-system-security-',                       // prefix class for system security level (color)\r\n\r\n        // dialog\r\n        routeSettingsDialogId: 'pf-route-settings-dialog',                      // id for route \"settings\" dialog\r\n        routeDialogId: 'pf-route-dialog',                                       // id for route \"search\" dialog\r\n        systemDialogSelectClass: 'pf-system-dialog-select',                     // class for system select Element\r\n        systemInfoRoutesTableClass: 'pf-system-route-table',                    // class for route tables\r\n        mapSelectId: 'pf-route-dialog-map-select',                              // id for \"map\" select\r\n\r\n        dataTableActionCellClass: 'pf-table-action-cell'                       // class for \"action\" cells\r\n    };\r\n\r\n    // cache for system routes\r\n    var cache = {\r\n        systemRoutes: {}                                                        // jump information between solar systems\r\n    };\r\n\r\n    /**\r\n     * callback function, adds new row to a dataTable with jump information for a route\r\n     * @param context\r\n     * @param routesData\r\n     */\r\n    var callbackAddRouteRow = function(context, routesData){\r\n\r\n        if(routesData.length > 0){\r\n            for(var i = 0; i < routesData.length; i++){\r\n                var routeData = routesData[i];\r\n\r\n                // format routeData\r\n                var rowData = formatRouteData(routeData);\r\n\r\n                if(rowData.route){\r\n                    var cacheKey = routeData.systemFromData.name.toLowerCase() +\r\n                        '_' + routeData.systemToData.name.toLowerCase();\r\n\r\n                    // update route cache\r\n                    cache.systemRoutes[cacheKey] = {\r\n                        data: rowData,\r\n                        updated: Util.getServerTime().getTime() / 1000\r\n                    };\r\n\r\n                    var rowElement = addRow(context, rowData);\r\n\r\n                    rowElement.initTooltips({\r\n                        container: 'body'\r\n                    });\r\n                }\r\n            }\r\n\r\n            // redraw dataTable\r\n            context.dataTable.draw();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * add a new dataTable row to the routes table\r\n     * @param context\r\n     * @param rowData\r\n     * @returns {*}\r\n     */\r\n    var addRow = function(context, rowData){\r\n        var dataTable = context.dataTable;\r\n        var rowElement = null;\r\n        var row = null;\r\n        var animationStatus = 'changed';\r\n\r\n        // search for an existing row (e.g. on mass \"table refresh\" [all routes])\r\n        // get rowIndex where column 0 (equals to \"systemToData.name\") matches rowData.systemToData.name\r\n        var indexes = dataTable.rows().eq(0).filter( function (rowIdx) {\r\n            return (dataTable.cell(rowIdx, 0 ).data().name === rowData.systemToData.name);\r\n        });\r\n\r\n        if(indexes.length > 0){\r\n            // update row with FIRST index\r\n            // -> systemFrom should be unique!\r\n            row = dataTable.row( parseInt(indexes[0]) );\r\n            // update row data\r\n            row.data(rowData);\r\n        }else{\r\n            // no existing route found -> add new row\r\n            row = dataTable.row.add( rowData );\r\n\r\n            animationStatus = 'added';\r\n        }\r\n\r\n        if(row.length > 0){\r\n            rowElement = row.nodes().to$();\r\n\r\n            if(animationStatus !== null){\r\n                rowElement.data('animationStatus', animationStatus);\r\n            }\r\n        }\r\n\r\n        return rowElement;\r\n    };\r\n\r\n    /**\r\n     * update complete routes table (refresh all)\r\n     * @param moduleElement\r\n     * @param dataTable\r\n     */\r\n    var updateRoutesTable = function(moduleElement, dataTable){\r\n        var context = {\r\n            moduleElement: moduleElement,\r\n            dataTable: dataTable\r\n        };\r\n        var routeData = [];\r\n\r\n        dataTable.rows().every( function() {\r\n            routeData.push( getRouteRequestDataFromRowData( this.data() ));\r\n        });\r\n\r\n        getRouteData({routeData: routeData}, context, callbackAddRouteRow);\r\n    };\r\n\r\n    /**\r\n     * format rowData for route search/update request\r\n     * @param {Object} rowData\r\n     * @returns {Object}\r\n     */\r\n    var getRouteRequestDataFromRowData = function(rowData){\r\n        return {\r\n            mapIds: (rowData.hasOwnProperty('mapIds')) ? rowData.mapIds : [],\r\n            systemFromData: (rowData.hasOwnProperty('systemFromData')) ? rowData.systemFromData : {},\r\n            systemToData: (rowData.hasOwnProperty('systemToData')) ? rowData.systemToData : {},\r\n            stargates: (rowData.hasOwnProperty('stargates')) ? rowData.stargates | 0 : 1,\r\n            jumpbridges: (rowData.hasOwnProperty('jumpbridges')) ? rowData.jumpbridges | 0 : 1,\r\n            wormholes: (rowData.hasOwnProperty('wormholes')) ? rowData.wormholes | 0 : 1,\r\n            wormholesReduced: (rowData.hasOwnProperty('wormholesReduced')) ? rowData.wormholesReduced | 0 : 1,\r\n            wormholesCritical: (rowData.hasOwnProperty('wormholesCritical')) ? rowData.wormholesCritical | 0 : 1,\r\n            wormholesEOL: (rowData.hasOwnProperty('wormholesEOL')) ? rowData.wormholesEOL | 0 : 1\r\n        };\r\n    };\r\n\r\n    /**\r\n     * show route dialog. User can search for systems and jump-info for each system is added to a data table\r\n     * @param dialogData\r\n     */\r\n    var showFindRouteDialog = function(dialogData){\r\n\r\n        var mapSelectOptions = [];\r\n        var currentMapData = Util.getCurrentMapData();\r\n        if(currentMapData !== false){\r\n            for(var i = 0; i < currentMapData.length; i++){\r\n                mapSelectOptions.push({\r\n                    id: currentMapData[i].config.id,\r\n                    name: currentMapData[i].config.name,\r\n                    selected: (dialogData.mapId === currentMapData[i].config.id)\r\n                });\r\n            }\r\n        }\r\n        var data = {\r\n            id: config.routeDialogId,\r\n            selectClass: config.systemDialogSelectClass,\r\n            mapSelectId: config.mapSelectId,\r\n            systemFromData: dialogData.systemFromData,\r\n            mapSelectOptions: mapSelectOptions\r\n        };\r\n\r\n        requirejs(['text!templates/dialog/route.html', 'mustache'], function(template, Mustache) {\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            var findRouteDialog = bootbox.dialog({\r\n                title: 'Route finder',\r\n                message: content,\r\n                show: false,\r\n                buttons: {\r\n                    close: {\r\n                        label: 'cancel',\r\n                        className: 'btn-default'\r\n                    },\r\n                    success: {\r\n                        label: '<i class=\"fa fa-fw fa-search\"></i>&nbsp;search route',\r\n                        className: 'btn-primary',\r\n                        callback: function () {\r\n                            // add new route to route table\r\n\r\n                            // get form Values\r\n                            var form = $('#' + config.routeDialogId).find('form');\r\n\r\n                            var routeDialogData = $(form).getFormValues();\r\n\r\n                            // validate form\r\n                            form.validator('validate');\r\n\r\n                            // check whether the form is valid\r\n                            var formValid = form.isValidForm();\r\n\r\n                            if(formValid === false){\r\n                                // don't close dialog\r\n                                return false;\r\n                            }\r\n\r\n                            // get all system data from select2\r\n                            var systemSelectData = form.find('.' + config.systemDialogSelectClass).select2('data');\r\n\r\n                            if(\r\n                                systemSelectData &&\r\n                                systemSelectData.length === 1\r\n                            ){\r\n                                var context = {\r\n                                    moduleElement: dialogData.moduleElement,\r\n                                    dataTable: dialogData.dataTable\r\n                                };\r\n\r\n                                var requestData = {\r\n                                    routeData: [{\r\n                                        mapIds: routeDialogData.mapIds,\r\n                                        systemFromData: dialogData.systemFromData,\r\n                                        systemToData: {\r\n                                            systemId:  systemSelectData[0].systemId,\r\n                                            name: systemSelectData[0].text\r\n                                        },\r\n                                        stargates: routeDialogData.hasOwnProperty('stargates') ? parseInt( routeDialogData.stargates ) : 0,\r\n                                        jumpbridges: routeDialogData.hasOwnProperty('jumpbridges') ? parseInt( routeDialogData.jumpbridges ) : 0,\r\n                                        wormholes: routeDialogData.hasOwnProperty('wormholes') ? parseInt( routeDialogData.wormholes ) : 0,\r\n                                        wormholesReduced: routeDialogData.hasOwnProperty('wormholesReduced') ? parseInt( routeDialogData.wormholesReduced ) : 0,\r\n                                        wormholesCritical: routeDialogData.hasOwnProperty('wormholesCritical') ? parseInt( routeDialogData.wormholesCritical ) : 0,\r\n                                        wormholesEOL: routeDialogData.hasOwnProperty('wormholesEOL') ? parseInt( routeDialogData.wormholesEOL ) : 0\r\n                                    }]\r\n                                };\r\n\r\n                                getRouteData(requestData, context, callbackAddRouteRow);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            findRouteDialog.on('show.bs.modal', function(e) {\r\n                findRouteDialog.initTooltips();\r\n\r\n                // init some dialog/form observer\r\n                setDialogObserver( $(this) );\r\n\r\n                // init map select ----------------------------------------------------------------\r\n                var mapSelect = $(this).find('#' + config.mapSelectId);\r\n                mapSelect.initMapSelect();\r\n            });\r\n\r\n\r\n            findRouteDialog.on('shown.bs.modal', function(e) {\r\n\r\n                // init system select live  search ------------------------------------------------\r\n                // -> add some delay until modal transition has finished\r\n                var systemTargetSelect = $(this).find('.' + config.systemDialogSelectClass);\r\n                systemTargetSelect.delay(240).initSystemSelect({key: 'name'});\r\n            });\r\n\r\n            // show dialog\r\n            findRouteDialog.modal('show');\r\n        });\r\n    };\r\n\r\n    /**\r\n     * show route settings dialog\r\n     * @param dialogData\r\n     * @param moduleElement\r\n     * @param systemFromData\r\n     * @param routesTable\r\n     */\r\n    var showSettingsDialog = function(dialogData, moduleElement, systemFromData, routesTable){\r\n\r\n        var promiseStore = MapUtil.getLocaleData('map', dialogData.mapId);\r\n        promiseStore.then(function(dataStore) {\r\n            // selected systems (if already stored)\r\n            var systemSelectOptions = [];\r\n            if(\r\n                dataStore &&\r\n                dataStore.routes\r\n            ){\r\n                systemSelectOptions = dataStore.routes;\r\n            }\r\n\r\n            var maxSelectionLength = 4;\r\n\r\n            var data = {\r\n                id: config.routeSettingsDialogId,\r\n                selectClass: config.systemDialogSelectClass,\r\n                systemSelectOptions: systemSelectOptions,\r\n                maxSelectionLength: maxSelectionLength\r\n            };\r\n\r\n            requirejs(['text!templates/dialog/route_settings.html', 'mustache'], function(template, Mustache) {\r\n                var content = Mustache.render(template, data);\r\n\r\n                var settingsDialog = bootbox.dialog({\r\n                    title: 'Route settings',\r\n                    message: content,\r\n                    show: false,\r\n                    buttons: {\r\n                        close: {\r\n                            label: 'cancel',\r\n                            className: 'btn-default'\r\n                        },\r\n                        success: {\r\n                            label: '<i class=\"fa fa-fw fa-check\"></i>&nbsp;save',\r\n                            className: 'btn-success',\r\n                            callback: function () {\r\n                                var form = this.find('form');\r\n                                // get all system data from select2\r\n                                var systemSelectData = form.find('.' + config.systemDialogSelectClass).select2('data');\r\n                                var systemsTo = [];\r\n\r\n                                if( systemSelectData.length > 0 ){\r\n                                    systemsTo = formSystemSelectData(systemSelectData);\r\n                                    MapUtil.storeLocalData('map', dialogData.mapId, 'routes', systemsTo);\r\n                                }else{\r\n                                    MapUtil.deleteLocalData('map', dialogData.mapId, 'routes');\r\n                                }\r\n\r\n                                Util.showNotify({title: 'Route settings stored', type: 'success'});\r\n\r\n                                // (re) draw table\r\n                                drawRouteTable(dialogData.mapId, moduleElement, systemFromData, routesTable, systemsTo);\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                settingsDialog.on('shown.bs.modal', function(e) {\r\n\r\n                    // init default system select -----------------------------------------------------\r\n                    // -> add some delay until modal transition has finished\r\n                    var systemTargetSelect = $(this).find('.' + config.systemDialogSelectClass);\r\n                    systemTargetSelect.delay(240).initSystemSelect({key: 'name', maxSelectionLength: maxSelectionLength});\r\n                });\r\n\r\n                // show dialog\r\n                settingsDialog.modal('show');\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * format select2 system data\r\n     * @param {Array} data\r\n     * @returns {Array}\r\n     */\r\n    var formSystemSelectData = function(data){\r\n        var formattedData = [];\r\n        for(let i = 0; i < data.length; i++){\r\n            var tmpData = data[i];\r\n\r\n            formattedData.push({\r\n                name: tmpData.id,\r\n                systemId: parseInt( tmpData.hasOwnProperty('systemId') ? tmpData.systemId : tmpData.element.getAttribute('data-systemid') )\r\n            });\r\n        }\r\n\r\n        return formattedData;\r\n    };\r\n\r\n    /**\r\n     * set event observer for route finder dialog\r\n     * @param routeDialog\r\n     */\r\n    var setDialogObserver = function(routeDialog){\r\n        var wormholeCheckbox = routeDialog.find('input[type=\"checkbox\"][name=\"wormholes\"]');\r\n        var wormholeReducedCheckbox = routeDialog.find('input[type=\"checkbox\"][name=\"wormholesReduced\"]');\r\n        var wormholeCriticalCheckbox = routeDialog.find('input[type=\"checkbox\"][name=\"wormholesCritical\"]');\r\n        var wormholeEolCheckbox = routeDialog.find('input[type=\"checkbox\"][name=\"wormholesEOL\"]');\r\n\r\n        // store current \"checked\" state for each box ---------------------------------------------\r\n        var storeCheckboxStatus = function(){\r\n            wormholeReducedCheckbox.data('selectState', wormholeReducedCheckbox.prop('checked'));\r\n            wormholeCriticalCheckbox.data('selectState', wormholeCriticalCheckbox.prop('checked'));\r\n            wormholeEolCheckbox.data('selectState', wormholeEolCheckbox.prop('checked'));\r\n        };\r\n\r\n        // on wormhole checkbox change ------------------------------------------------------------\r\n        var onWormholeCheckboxChange = function(){\r\n\r\n            if( $(this).is(':checked') ){\r\n                wormholeReducedCheckbox.prop('disabled', false);\r\n                wormholeCriticalCheckbox.prop('disabled', false);\r\n                wormholeEolCheckbox.prop('disabled', false);\r\n\r\n                wormholeReducedCheckbox.prop('checked', wormholeReducedCheckbox.data('selectState'));\r\n                wormholeCriticalCheckbox.prop('checked', wormholeCriticalCheckbox.data('selectState'));\r\n                wormholeEolCheckbox.prop('checked', wormholeEolCheckbox.data('selectState'));\r\n            }else{\r\n                storeCheckboxStatus();\r\n\r\n                wormholeReducedCheckbox.prop('checked', false);\r\n                wormholeReducedCheckbox.prop('disabled', true);\r\n                wormholeCriticalCheckbox.prop('checked', false);\r\n                wormholeCriticalCheckbox.prop('disabled', true);\r\n                wormholeEolCheckbox.prop('checked', false);\r\n                wormholeEolCheckbox.prop('disabled', true);\r\n            }\r\n        }.bind(wormholeCheckbox);\r\n\r\n        wormholeCheckbox.on('change', onWormholeCheckboxChange);\r\n\r\n        // initial checkbox check\r\n        storeCheckboxStatus();\r\n        onWormholeCheckboxChange();\r\n    };\r\n\r\n    /**\r\n     * requests route data from eveCentral API and execute callback\r\n     * @param requestData\r\n     * @param context\r\n     * @param callback\r\n     */\r\n    var getRouteData = function(requestData, context, callback){\r\n\r\n        context.moduleElement.showLoadingAnimation();\r\n\r\n        $.ajax({\r\n            url: Init.path.searchRoute,\r\n            type: 'POST',\r\n            dataType: 'json',\r\n            data: requestData,\r\n            context: context\r\n        }).done(function(routesData){\r\n            this.moduleElement.hideLoadingAnimation();\r\n\r\n            // execute callback\r\n            callback(this, routesData.routesData);\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * format route data from API request into dataTable row format\r\n     * @param routeData\r\n     * @returns {{}}\r\n     */\r\n    var formatRouteData = function(routeData){\r\n\r\n        var reloadButton = '<i class=\"fa ' + ['fa-refresh'].join(' ') + '\"></i>';\r\n        var deleteButton = '<i class=\"fa ' + ['fa-close', 'txt-color', 'txt-color-redDarker'].join(' ') + '\"></i>';\r\n\r\n        // default row data (e.g. no route found)\r\n        var tableRowData = {\r\n            systemFromData:  routeData.systemFromData,\r\n            systemToData:  routeData.systemToData,\r\n            jumps: {\r\n                value: 0,\r\n                formatted: '---'\r\n            },\r\n            avgTrueSec: {\r\n                value: '',\r\n                formatted: ''\r\n            },\r\n            route: 'not found',\r\n            stargates: routeData.stargates,\r\n            jumpbridges: routeData.jumpbridges,\r\n            wormholes: routeData.wormholes,\r\n            wormholesReduced: routeData.wormholesReduced,\r\n            wormholesCritical: routeData.wormholesCritical,\r\n            wormholesEOL: routeData.wormholesEOL,\r\n            reload: {\r\n                button: reloadButton\r\n            },\r\n            clear: {\r\n                button: deleteButton\r\n            },\r\n            maps: routeData.maps,\r\n            mapIds: routeData.mapIds //map data (mapIds is \"redundant\")\r\n        };\r\n\r\n        if(\r\n            routeData.routePossible === true &&\r\n            routeData.route.length > 0\r\n        ){\r\n            // route data available\r\n\r\n            // add route Data\r\n            var jumpData = [];\r\n            var avgSecTemp = 0;\r\n\r\n            // loop all systems on this route\r\n            for(var i = 0; i < routeData.route.length; i++){\r\n                var routeNodeData = routeData.route[i];\r\n                // format system name (camelCase)\r\n                var systemName = routeNodeData.system.charAt(0).toUpperCase() + routeNodeData.system.slice(1).toLowerCase();\r\n\r\n                var systemSec = Number(routeNodeData.security).toFixed(1).toString();\r\n                var tempSystemSec = systemSec;\r\n\r\n                if(tempSystemSec <= 0){\r\n                    tempSystemSec = '0-0';\r\n                }\r\n\r\n                var systemSecClass = config.systemSecurityClassPrefix + tempSystemSec.replace('.', '-');\r\n\r\n                var system = '<i class=\"fa fa-square ' + systemSecClass + '\" ';\r\n                system += 'data-toggle=\"tooltip\" data-placement=\"bottom\" data-container=\"body\" ';\r\n                system += 'title=\"' + systemName + ' [' + systemSec + '] \"></i>';\r\n                jumpData.push( system );\r\n\r\n                // \"source\" system is not relevant for average security\r\n                if(i > 0){\r\n                    avgSecTemp += Number(routeNodeData.security);\r\n                }\r\n            }\r\n\r\n            var avgSec = ( avgSecTemp /  (routeData.route.length - 1)).toFixed(2);\r\n            var avgSecForClass = Number(avgSec).toFixed(1);\r\n\r\n            if(avgSecForClass <= 0){\r\n                avgSecForClass = '0.0';\r\n            }\r\n\r\n            var avgSecClass = config.systemSecurityClassPrefix + avgSecForClass.toString().replace('.', '-');\r\n\r\n            tableRowData.jumps = {\r\n                value: routeData.routeJumps,\r\n                formatted: routeData.routeJumps\r\n            };\r\n\r\n            tableRowData.avgTrueSec = {\r\n                value: avgSec,\r\n                formatted: '<span class=\"' + avgSecClass + '\">' + avgSec + '</span>'\r\n            };\r\n            tableRowData.route = jumpData.join(' ');\r\n        }\r\n\r\n        return tableRowData;\r\n    };\r\n\r\n    /**\r\n     * get the route finder moduleElement\r\n     * @returns {*}\r\n     */\r\n    var getModule = function(){\r\n\r\n        // create new module container\r\n        var moduleElement = $('<div>', {\r\n            class: [config.moduleClass, config.systemRouteModuleClass].join(' ')\r\n        });\r\n\r\n        // headline toolbar icons\r\n        var headlineToolbar  = $('<h5>', {\r\n            class: 'pull-right'\r\n        }).append(\r\n            $('<i>', {\r\n                class: ['fa', 'fa-fw', 'fa-search', config.systemModuleHeadlineIcon, config.systemModuleHeadlineIconSearch].join(' '),\r\n                title: 'find&nbsp;route'\r\n            }).attr('data-html', 'true').attr('data-toggle', 'tooltip'),\r\n            $('<i>', {\r\n                class: ['fa', 'fa-fw', 'fa-sliders', config.systemModuleHeadlineIcon, config.systemModuleHeadlineIconSettings].join(' '),\r\n                title: 'settings'\r\n            }).attr('data-html', 'true').attr('data-toggle', 'tooltip'),\r\n            $('<i>', {\r\n                class: ['fa', 'fa-fw', 'fa-refresh', config.systemModuleHeadlineIcon, config.systemModuleHeadlineIconRefresh].join(' '),\r\n                title: 'refresh&nbsp;all'\r\n            }).attr('data-html', 'true').attr('data-toggle', 'tooltip')\r\n        );\r\n\r\n        moduleElement.append(headlineToolbar);\r\n\r\n        // headline\r\n        var headline = $('<h5>', {\r\n            class: 'pull-left',\r\n            text: 'Routes'\r\n        });\r\n\r\n        moduleElement.append(headline);\r\n\r\n        // crate new route table\r\n        var table = $('<table>', {\r\n            class: ['compact', 'stripe', 'order-column', 'row-border', config.systemInfoRoutesTableClass].join(' ')\r\n        });\r\n\r\n        moduleElement.append( $(table) );\r\n\r\n        // init empty table\r\n        var routesTable = table.DataTable( {\r\n            paging: false,\r\n            ordering: true,\r\n            order: [ 1, 'asc' ],\r\n            info: false,\r\n            searching: false,\r\n            hover: false,\r\n            autoWidth: false,\r\n            rowId: 'systemTo',\r\n            language: {\r\n                emptyTable:  'No routes added'\r\n            },\r\n            columnDefs: [\r\n                {\r\n                    targets: 0,\r\n                    orderable: true,\r\n                    title: 'system&nbsp;&nbsp;&nbsp;',\r\n                    class: Util.config.popoverTriggerClass,\r\n                    data: 'systemToData',\r\n                    render: {\r\n                        _: 'name',\r\n                        sort: 'name'\r\n                    },\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex) {\r\n                        // init context menu\r\n                        $(cell).initSystemPopover({\r\n                            systemToData: rowData.systemToData\r\n                        });\r\n                    }\r\n                },{\r\n                    targets: 1,\r\n                    orderable: true,\r\n                    title: '<span title=\"jumps\" data-toggle=\"tooltip\"><i class=\"fa fa-arrows-h\"></i>&nbsp;&nbsp;</span>',\r\n                    width: '18px',\r\n                    class: 'text-right',\r\n                    data: 'jumps',\r\n                    render: {\r\n                        _: 'formatted',\r\n                        sort: 'value'\r\n                    }\r\n                },{\r\n                    targets: 2,\r\n                    orderable: true,\r\n                    title: '<span title=\"average security\" data-toggle=\"tooltip\">&#216;&nbsp;&nbsp;</span>',\r\n                    width: '15px',\r\n                    class: 'text-right',\r\n                    data: 'avgTrueSec',\r\n                    render: {\r\n                        _: 'formatted',\r\n                        sort: 'value'\r\n                    }\r\n                },{\r\n                    targets: 3,\r\n                    orderable: false,\r\n                    title: 'route',\r\n                    data: 'route'\r\n                },{\r\n                    targets: 4,\r\n                    title: '',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: '10px',\r\n                    class: ['text-center', config.dataTableActionCellClass].join(' '),\r\n                    data: 'reload',\r\n                    render: {\r\n                        _: 'button'\r\n                    },\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n                        var tempTableApi = this.api();\r\n\r\n                        $(cell).on('click', function(e) {\r\n                            // get current row data (important!)\r\n                            // -> \"rowData\" param is not current state, values are \"on createCell()\" state\r\n                            rowData = tempTableApi.row( $(cell).parents('tr')).data();\r\n\r\n                            var context = {\r\n                                moduleElement: moduleElement,\r\n                                dataTable: tempTableApi\r\n                            };\r\n\r\n                            var requestData = {\r\n                                routeData: [{\r\n                                    mapIds: rowData.mapIds,\r\n                                    systemFromData: rowData.systemFromData,\r\n                                    systemToData: rowData.systemToData,\r\n                                    stargates: rowData.stargates ? 1 : 0,\r\n                                    jumpbridges: rowData.jumpbridges ? 1 : 0,\r\n                                    wormholes: rowData.wormholes ? 1 : 0,\r\n                                    wormholesReduced: rowData.wormholesReduced ? 1 : 0,\r\n                                    wormholesCritical: rowData.wormholesCritical ? 1 : 0,\r\n                                    wormholesEOL: rowData.wormholesEOL ? 1 : 0\r\n                                }]\r\n                            };\r\n\r\n                            getRouteData(requestData, context, callbackAddRouteRow);\r\n                        });\r\n                    }\r\n                },{\r\n                    targets: 5,\r\n                    title: '',\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    width: '10px',\r\n                    class: ['text-center', config.dataTableActionCellClass].join(' '),\r\n                    data: 'clear',\r\n                    render: {\r\n                        _: 'button'\r\n                    },\r\n                    createdCell: function(cell, cellData, rowData, rowIndex, colIndex){\r\n                        var tempTableElement = this;\r\n\r\n                        var confirmationSettings = {\r\n                            container: 'body',\r\n                            placement: 'left',\r\n                            btnCancelClass: 'btn btn-sm btn-default',\r\n                            btnCancelLabel: 'cancel',\r\n                            btnCancelIcon: 'fa fa-fw fa-ban',\r\n                            title: 'delete route',\r\n                            btnOkClass: 'btn btn-sm btn-danger',\r\n                            btnOkLabel: 'delete',\r\n                            btnOkIcon: 'fa fa-fw fa-close',\r\n                            onConfirm : function(e, target){\r\n                                var deleteRowElement = $(cell).parents('tr');\r\n                                tempTableElement.api().rows(deleteRowElement).remove().draw();\r\n                            }\r\n                        };\r\n\r\n                        // init confirmation dialog\r\n                        $(cell).confirmation(confirmationSettings);\r\n                    }\r\n                }\r\n            ],\r\n            drawCallback: function(settings){\r\n\r\n                var animationRows = this.api().rows().nodes().to$().filter(function() {\r\n                    return (\r\n                        $(this).data('animationStatus') ||\r\n                        $(this).data('animationTimer')\r\n                    );\r\n                });\r\n\r\n                for(var i = 0; i < animationRows.length; i++){\r\n                    $(animationRows[i]).pulseTableRow($(animationRows[i]).data('animationStatus'));\r\n                    $(animationRows[i]).removeData('animationStatus');\r\n                }\r\n\r\n            },\r\n            data: [] // will be added dynamic\r\n        });\r\n\r\n        // init tooltips for this module\r\n        var tooltipElements = moduleElement.find('[data-toggle=\"tooltip\"]');\r\n        tooltipElements.tooltip({\r\n            container: 'body'\r\n        });\r\n\r\n        return moduleElement;\r\n    };\r\n\r\n\r\n    /**\r\n     * init system popover (e.g. for setWaypoints)\r\n     * @param options\r\n     */\r\n    $.fn.initSystemPopover = function(options){\r\n        var elements = $(this);\r\n        var eventNamespace = 'hideSystemPopup';\r\n        var systemToData = options.systemToData;\r\n\r\n        requirejs(['text!templates/tooltip/system_popover.html', 'mustache'], function (template, Mustache) {\r\n            var data = {\r\n                systemToData: systemToData\r\n            };\r\n\r\n            var content = Mustache.render(template, data);\r\n\r\n            elements.each(function() {\r\n                var element = $(this);\r\n                // destroy \"popover\" and remove \"click\" event for animation\r\n                element.popover('destroy').off();\r\n\r\n                // init popover and add specific class to it (for styling)\r\n                element.popover({\r\n                    html: true,\r\n                    title: systemToData.name,\r\n                    trigger: 'manual',\r\n                    placement: 'top',\r\n                    container: 'body',\r\n                    content: content\r\n                }).data('bs.popover').tip().addClass('pf-popover');\r\n            });\r\n\r\n            // set popup \"close\" observer\r\n            elements.initPopoverClose(eventNamespace);\r\n\r\n            // set \"open\" trigger on \"right click\"\r\n            // -> this is not supported by the \"trigger\" param in .popover();\r\n            // -> therefore we need to set it up manually\r\n            elements.on('contextmenu', function(e){\r\n                e.preventDefault();\r\n               $(this).popover('show');\r\n            });\r\n\r\n            // set link observer \"on shown\" event\r\n            elements.on('shown.bs.popover', function () {\r\n                var popoverRoot = $(this);\r\n\r\n                popoverRoot.data('bs.popover').tip().find('a').on('click', function(){\r\n                    // hint: \"data\" attributes should be in lower case!\r\n                    var systemData = {\r\n                        name: $(this).data('name'),\r\n                        systemId: $(this).data('systemid')\r\n                    };\r\n                    Util.setDestination(systemData, 'set_destination');\r\n\r\n                    // close popover\r\n                    popoverRoot.popover('hide');\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * init route module\r\n     * -> request route path fore \"default\" trade hub systems\r\n     * @param moduleElement\r\n     * @param mapId\r\n     * @param systemData\r\n     */\r\n    var initModule = function(moduleElement, mapId, systemData){\r\n\r\n        var systemFromData = {\r\n            name: systemData.name,\r\n            systemId: systemData.systemId\r\n        };\r\n\r\n        var routesTableElement =  moduleElement.find('.' + config.systemInfoRoutesTableClass);\r\n\r\n        var routesTable = routesTableElement.DataTable();\r\n\r\n        // init refresh routes --------------------------------------------------------------------\r\n        moduleElement.find('.' + config.systemModuleHeadlineIconRefresh).on('click', function(e){\r\n            updateRoutesTable(moduleElement, routesTable);\r\n        });\r\n\r\n        // init search routes dialog --------------------------------------------------------------\r\n        moduleElement.find('.' + config.systemModuleHeadlineIconSearch).on('click', function(e){\r\n            var dialogData = {\r\n                moduleElement: moduleElement,\r\n                mapId: mapId,\r\n                systemFromData: systemFromData,\r\n                dataTable: routesTable\r\n            };\r\n\r\n            showFindRouteDialog(dialogData);\r\n        });\r\n\r\n        // init settings dialog -------------------------------------------------------------------\r\n        moduleElement.find('.' + config.systemModuleHeadlineIconSettings).on('click', function(e){\r\n            var dialogData = {\r\n                mapId: mapId\r\n            };\r\n\r\n            showSettingsDialog(dialogData, moduleElement, systemFromData, routesTable);\r\n        });\r\n\r\n        // fill routesTable with data -------------------------------------------------------------\r\n        var promiseStore = MapUtil.getLocaleData('map', mapId);\r\n        promiseStore.then(function(dataStore) {\r\n            // selected systems (if already stored)\r\n            var systemsTo = [{\r\n                name: 'Jita',\r\n                systemId: 30000142\r\n            }];\r\n\r\n            if(\r\n                dataStore &&\r\n                dataStore.routes\r\n            ){\r\n                systemsTo = dataStore.routes;\r\n            }\r\n\r\n            drawRouteTable(mapId, moduleElement, systemFromData, routesTable, systemsTo);\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * draw route table\r\n     * @param  mapId\r\n     * @param moduleElement\r\n     * @param systemFromData\r\n     * @param routesTable\r\n     * @param systemsTo\r\n     */\r\n    var drawRouteTable = function(mapId, moduleElement, systemFromData, routesTable, systemsTo){\r\n        var requestRouteData = [];\r\n        var currentTimestamp = Util.getServerTime().getTime();\r\n\r\n        for(var i = 0; i < systemsTo.length; i++){\r\n            var systemToData = systemsTo[i];\r\n\r\n            if(systemFromData.name !== systemToData.name){\r\n                var cacheKey = 'route_' + mapId + '_' + systemFromData.name.toUpperCase() + '_' + systemToData.name.toUpperCase();\r\n\r\n                if(\r\n                    cache.systemRoutes.hasOwnProperty(cacheKey) &&\r\n                    Math.round(\r\n                        ( currentTimestamp - (new Date( cache.systemRoutes[cacheKey].updated * 1000).getTime())) / 1000\r\n                    ) <= config.routeCacheTTL\r\n                ){\r\n                    // route data is cached (client side)\r\n                    var context = {\r\n                        dataTable: routesTable\r\n                    };\r\n\r\n                    addRow(context, cache.systemRoutes[cacheKey].data);\r\n                }else{\r\n                    // get route data\r\n                    var searchData = {\r\n                        mapIds: [mapId],\r\n                        systemFromData: systemFromData,\r\n                        systemToData: systemToData\r\n                    };\r\n\r\n                    requestRouteData.push( getRouteRequestDataFromRowData( searchData ));\r\n                }\r\n            }\r\n        }\r\n\r\n        // check if routes data is not cached and is requested\r\n        if(requestRouteData.length > 0){\r\n            var contextData = {\r\n                moduleElement: moduleElement,\r\n                dataTable: routesTable\r\n            };\r\n\r\n            var requestData = {\r\n                routeData: requestRouteData\r\n            };\r\n\r\n            getRouteData(requestData, contextData, callbackAddRouteRow);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * updates an dom element with the system route module\r\n     * @param mapId\r\n     * @param systemData\r\n     */\r\n    $.fn.drawSystemRouteModule = function(mapId, systemData){\r\n\r\n        var parentElement = $(this);\r\n\r\n        // show route module\r\n        var showModule = function(moduleElement){\r\n            if(moduleElement){\r\n                moduleElement.css({ opacity: 0 });\r\n                parentElement.append(moduleElement);\r\n\r\n                moduleElement.velocity('transition.slideDownIn', {\r\n                    duration: Init.animationSpeed.mapModule,\r\n                    delay: Init.animationSpeed.mapModule,\r\n                    complete: function(){\r\n                        initModule(moduleElement, mapId, systemData);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // check if module already exists\r\n        var moduleElement = parentElement.find('.' + config.systemRouteModuleClass);\r\n\r\n        if(moduleElement.length > 0){\r\n            moduleElement.velocity('transition.slideDownOut', {\r\n                duration: Init.animationSpeed.mapModule,\r\n                complete: function(tempElement){\r\n                    $(tempElement).remove();\r\n\r\n                    moduleElement = getModule();\r\n                    showModule(moduleElement);\r\n                }\r\n            });\r\n        }else{\r\n            moduleElement = getModule();\r\n            showModule(moduleElement);\r\n        }\r\n\r\n    };\r\n\r\n});\n",
    "define('app/ui/system_killboard',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'morris'\r\n], function($, Init, Util, Morris) {\r\n    'use strict';\r\n\r\n    var config = {\r\n        // module info\r\n        moduleClass: 'pf-module',                                               // class for each module\r\n\r\n        // headline toolbar\r\n        systemModuleHeadlineIcon: 'pf-module-icon-button',                      // class for toolbar icons in the head\r\n\r\n        // system killboard module\r\n        systemKillboardModuleClass: 'pf-system-killboard-module',               // module wrapper\r\n        systemKillboardGraphKillsClass: 'pf-system-killboard-graph-kills',      // class for system kill graph\r\n\r\n        // system killboard list\r\n        systemKillboardListClass: 'pf-system-killboard-list',                   // class for a list with kill entries\r\n        systemKillboardListEntryClass: 'pf-system-killboard-list-entry',        // class for a list entry\r\n        systemKillboardListImgShip: 'pf-system-killboard-img-ship',             // class for all ship images\r\n        systemKillboardListImgAlly: 'pf-system-killboard-img-ally',             // class for all alliance logos\r\n        systemKillboardListImgCorp: 'pf-system-killboard-img-corp'              // class for all corp logos\r\n\r\n    };\r\n\r\n    var cache = {\r\n        systemKillsGraphData: {} // data for system kills info graph\r\n    };\r\n\r\n    /**\r\n     * get label element with given content\r\n     * @param text\r\n     * @returns {*|XMLList}\r\n     */\r\n    var getLabel = function(text, options){\r\n        var label = $('<span>', {\r\n            class: ['label', options.type, options.align].join(' ')\r\n        }).text( text );\r\n\r\n        return label;\r\n    };\r\n\r\n\r\n    var showKillmails = function(moduleElement, killboardData){\r\n\r\n        // show number of killMails\r\n        var killMailCounterMax = 20;\r\n        var killMailCounter = 0;\r\n\r\n        // change order (show right to left)\r\n        killboardData.tableData.reverse();\r\n\r\n        for(var i = 0; i < killboardData.tableData.length; i++){\r\n\r\n            // check if killMails exist in this hour\r\n            if(killboardData.tableData[i].killmails){\r\n\r\n                if(killMailCounter >= killMailCounterMax){\r\n                    break;\r\n                }\r\n\r\n                moduleElement.append( $('<h5>').text(i + 'h ago'));\r\n\r\n                var killMailData = killboardData.tableData[i].killmails;\r\n\r\n                var listeElement = $('<ul>', {\r\n                    class: ['media-list', config.systemKillboardListClass].join(' ')\r\n                });\r\n\r\n                for(var j = 0; j < killMailData.length; j++){\r\n                    killMailCounter++;\r\n                    if(killMailCounter >= killMailCounterMax){\r\n                        break;\r\n                    }\r\n\r\n                    var killData = killMailData[j];\r\n\r\n                    var linkUrl = 'https://zkillboard.com/kill/' + killData.killID + '/';\r\n                    var victimImageUrl = 'https://image.eveonline.com/Type/' + killData.victim.shipTypeID + '_64.png';\r\n                    var killDate = getDateObjectByTimeString(killData.killTime);\r\n                    var killDateString = Util.convertDateToString(killDate);\r\n                    var killLossValue = Util.formatPrice( killData.zkb.totalValue );\r\n\r\n                    // check for ally\r\n                    var victimAllyLogoUrl = '';\r\n                    var displayAlly = 'none';\r\n                    if(killData.victim.allianceID > 0){\r\n                        victimAllyLogoUrl = 'https://image.eveonline.com/Alliance/' + killData.victim.allianceID + '_32.png';\r\n                        displayAlly = 'block';\r\n                    }\r\n\r\n                    // check for corp\r\n                    var victimCorpLogoUrl = '';\r\n                    var displayCorp = 'none';\r\n                    if(killData.victim.corporationID > 0){\r\n                        victimCorpLogoUrl = 'https://image.eveonline.com/Corporation/' + killData.victim.corporationID + '_32.png';\r\n                        displayCorp = 'inline';\r\n                    }\r\n\r\n                    var liElement = $('<li>', {\r\n                        class: ['media', config.systemKillboardListEntryClass].join(' ')\r\n                    }).append(\r\n                            $('<a>', {\r\n                                href: linkUrl,\r\n                                target: '_blank'\r\n                            }).append(\r\n                                    $('<img>', {\r\n                                        src: victimImageUrl,\r\n                                        class: ['media-object', 'pull-left', config.systemKillboardListImgShip].join(' ')\r\n                                    })\r\n                                ).append(\r\n                                    $('<img>', {\r\n                                        src: victimAllyLogoUrl,\r\n                                        title: killData.victim.allianceName,\r\n                                        class: ['pull-right', config.systemKillboardListImgAlly].join(' '),\r\n                                        css: {display: displayAlly}\r\n                                    }).attr('data-placement', 'left')\r\n                                ).append(\r\n                                    $('<div>', {\r\n                                        class: 'media-body'\r\n                                    }).append(\r\n                                            $('<h5>', {\r\n                                                class: 'media-heading',\r\n                                                text: killData.victim.characterName\r\n                                            }).prepend(\r\n                                                    $('<small>', {\r\n                                                        text: killDateString + ' - '\r\n                                                    })\r\n                                                ).prepend(\r\n                                                    $('<img>', {\r\n                                                        src: victimCorpLogoUrl,\r\n                                                        title: killData.victim.corporationName,\r\n                                                        class: [config.systemKillboardListImgCorp].join(' '),\r\n                                                        css: {display: displayCorp}\r\n                                                    })\r\n                                                )\r\n                                        ).append(\r\n                                            $('<h3>', {\r\n                                                class: ['media-heading'].join(' ')\r\n                                            }).append(\r\n                                                    $('<small>', {\r\n                                                        class: ['txt-color', 'txt-color-green', 'pull-right'].join(' '),\r\n                                                        text: killLossValue\r\n                                                    })\r\n                                                )\r\n                                        )\r\n                                )\r\n                        );\r\n\r\n                    listeElement.append(liElement);\r\n\r\n                }\r\n\r\n                moduleElement.append(listeElement);\r\n\r\n            }\r\n        }\r\n\r\n\r\n        // animate kill li-elements\r\n        $('.' + config.systemKillboardListEntryClass).velocity('transition.expandIn', {\r\n            stagger: 50,\r\n            complete: function(){\r\n                // init tooltips\r\n                moduleElement.find('[title]').tooltip({\r\n                    container: 'body'\r\n                });\r\n\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * updates the system info graph\r\n     * @param systemData\r\n     */\r\n    $.fn.updateSystemInfoGraphs = function(systemData){\r\n\r\n        var moduleElement = $(this);\r\n\r\n\r\n        // headline toolbar icons\r\n        var headlineToolbar  = $('<h5>', {\r\n            class: 'pull-right'\r\n        }).append(\r\n                $('<i>', {\r\n                    class: ['fa', 'fa-fw', 'fa-external-link ', config.systemModuleHeadlineIcon].join(' '),\r\n                    title: 'zkillboard.com'\r\n                }).on('click', function(e){\r\n                    window.open(\r\n                        'https://zkillboard.com/system/' + systemData.systemId,\r\n                        '_blank'\r\n                    );\r\n                }).attr('data-toggle', 'tooltip')\r\n            );\r\n\r\n        moduleElement.append(headlineToolbar);\r\n\r\n        // headline\r\n        var headline = $('<h5>', {\r\n            text: 'Killboard'\r\n        });\r\n\r\n        moduleElement.append(headline);\r\n\r\n        var killboardGraphElement = $('<div>', {\r\n            class: config.systemKillboardGraphKillsClass\r\n        });\r\n\r\n        moduleElement.append(killboardGraphElement);\r\n\r\n        var showHours = 24;\r\n        var maxKillmailCount = 200; // limited by API\r\n\r\n        var labelOptions = {\r\n            align: 'center-block'\r\n        };\r\n        var label = '';\r\n\r\n        // private function draws a \"system kills\" graph\r\n        var drawGraph = function(data){\r\n\r\n            var tableData = data.tableData;\r\n\r\n            // change order (show right to left)\r\n            tableData.reverse();\r\n\r\n\r\n\r\n             if(data.count === 0){\r\n                 labelOptions.type = 'label-success';\r\n                 label = getLabel( 'No kills found within the last 24h', labelOptions );\r\n                 killboardGraphElement.append( label );\r\n\r\n                 minifyKillboardGraphElement(killboardGraphElement);\r\n                 return;\r\n             }\r\n\r\n            var labelYFormat = function(y){\r\n                return Math.round(y);\r\n            };\r\n\r\n            // draw chart\r\n            Morris.Bar({\r\n                element: killboardGraphElement,\r\n                resize: true,\r\n                grid: true,\r\n                gridStrokeWidth: 0.3,\r\n                gridTextSize: 9,\r\n                gridTextColor: '#63676a',\r\n                gridTextFamily: 'Oxygen Bold',\r\n                hideHover: true,\r\n                data: tableData,\r\n                xkey: 'label',\r\n                ykeys: ['kills'],\r\n                labels: ['Kills'],\r\n                yLabelFormat: labelYFormat,\r\n                xLabelMargin: 10,\r\n                padding: 10,\r\n                parseTime: false,\r\n                barOpacity: 0.8,\r\n                barRadius: [2, 2, 0, 0],\r\n                barSizeRatio: 0.5,\r\n                barGap: 3,\r\n                barColors: function (row, series, type) {\r\n                    if (type === 'bar') {\r\n                        // highlight last row -> recent kills found\r\n                        if(this.xmax === row.x){\r\n                            return '#c2760c';\r\n                        }\r\n                    }\r\n\r\n                    return '#375959';\r\n                }\r\n            });\r\n\r\n            // show hint for recent kills\r\n            if(tableData[tableData.length - 1].kills > 0){\r\n                labelOptions.type = 'label-warning';\r\n                label = getLabel( tableData[tableData.length - 1].kills + ' kills within the last hour', labelOptions );\r\n                killboardGraphElement.prepend( label );\r\n            }\r\n        };\r\n\r\n        // get recent KB stats (last 24h))\r\n        var localDate = new Date();\r\n\r\n        // cache result for 5min\r\n        var cacheKey = systemData.systemId + '_' + localDate.getHours() + '_' + ( Math.ceil( localDate.getMinutes() / 5 ) * 5);\r\n\r\n        if(cache.systemKillsGraphData.hasOwnProperty(cacheKey) ){\r\n            // cached results\r\n\r\n            drawGraph( cache.systemKillsGraphData[cacheKey] );\r\n\r\n            // show killmail information\r\n            showKillmails(moduleElement, cache.systemKillsGraphData[cacheKey]);\r\n        }else{\r\n\r\n            // chart data\r\n            var chartData = [];\r\n\r\n            for(var i = 0; i < showHours; i++){\r\n                var tempData = {\r\n                    label: i + 'h',\r\n                    kills: 0\r\n                };\r\n\r\n                chartData.push(tempData);\r\n            }\r\n\r\n            // get kills within the last 24h\r\n            var timeFrameInSeconds = 60 * 60 * 24;\r\n\r\n            // get current server time\r\n            var serverDate= Util.getServerTime();\r\n\r\n            // if system is w-space system -> add link modifier\r\n            var wSpaceLinkModifier = '';\r\n            if(systemData.type.id === 1){\r\n                wSpaceLinkModifier = 'w-space/';\r\n            }\r\n\r\n            var url = Init.url.zKillboard;\r\n            url += 'no-items/' + wSpaceLinkModifier + 'no-attackers/solarSystemID/' + systemData.systemId + '/pastSeconds/' + timeFrameInSeconds + '/';\r\n\r\n            killboardGraphElement.showLoadingAnimation();\r\n\r\n            $.ajax({\r\n                url: url,\r\n                type: 'GET',\r\n                dataType: 'json'\r\n            }).done(function(kbData) {\r\n\r\n                // the API wont return more than 200KMs ! - remember last bar block with complete KM information\r\n                var lastCompleteDiffHourData = 0;\r\n\r\n\r\n                // loop kills and count kills by hour\r\n                for (var i = 0; i < kbData.length; i++) {\r\n                    var killmailData = kbData[i];\r\n\r\n                    var killDate = getDateObjectByTimeString(killmailData.killTime);\r\n\r\n                    // get time diff\r\n                    var timeDiffMin = Math.round(( serverDate - killDate ) / 1000 / 60);\r\n                    var timeDiffHour = Math.round(timeDiffMin / 60);\r\n\r\n                    // update chart data\r\n                    if (chartData[timeDiffHour]) {\r\n                        chartData[timeDiffHour].kills++;\r\n\r\n                        // add kill mail data\r\n                        if (chartData[timeDiffHour].killmails === undefined) {\r\n                            chartData[timeDiffHour].killmails = [];\r\n                        }\r\n                        chartData[timeDiffHour].killmails.push(killmailData);\r\n\r\n                        if (timeDiffHour > lastCompleteDiffHourData) {\r\n                            lastCompleteDiffHourData = timeDiffHour;\r\n                        }\r\n                    }\r\n\r\n                }\r\n\r\n                // remove empty chart Data\r\n                if (kbData.length >= maxKillmailCount) {\r\n                    chartData = chartData.splice(0, lastCompleteDiffHourData + 1);\r\n                }\r\n\r\n                // fill cache\r\n                cache.systemKillsGraphData[cacheKey] = {};\r\n                cache.systemKillsGraphData[cacheKey].tableData = chartData;\r\n                cache.systemKillsGraphData[cacheKey].count = kbData.length;\r\n\r\n                // draw table\r\n                drawGraph(cache.systemKillsGraphData[cacheKey]);\r\n\r\n                // show killmail information\r\n                showKillmails(moduleElement, cache.systemKillsGraphData[cacheKey]);\r\n\r\n                killboardGraphElement.hideLoadingAnimation();\r\n            }).fail(function(e){\r\n\r\n                labelOptions.type = 'label-danger';\r\n                label = getLabel(  'zKillboard is not responding', labelOptions );\r\n                killboardGraphElement.prepend( label );\r\n\r\n                killboardGraphElement.hideLoadingAnimation();\r\n\r\n                minifyKillboardGraphElement(killboardGraphElement);\r\n\r\n                Util.showNotify({title: e.status + ': Get system kills', text: 'Loading failed', type: 'error'});\r\n            });\r\n        }\r\n\r\n\r\n\r\n        // init tooltips\r\n        var tooltipElements = moduleElement.find('[data-toggle=\"tooltip\"]');\r\n        tooltipElements.tooltip({\r\n            container: 'body'\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * minify the killboard graph element e.g. if no kills where found, or on error\r\n     * @param killboardGraphElement\r\n     */\r\n    var minifyKillboardGraphElement = function(killboardGraphElement){\r\n        killboardGraphElement.velocity({\r\n            height: '20px',\r\n            marginBottom: '0px'\r\n        },{\r\n            duration: Init.animationSpeed.mapModule\r\n        });\r\n    };\r\n\r\n    /**\r\n     * transform timestring\r\n     * @param timeString\r\n     * @returns {Date}\r\n     */\r\n    var getDateObjectByTimeString = function(timeString){\r\n        var match = timeString.match(/^(\\d+)-(\\d+)-(\\d+) (\\d+)\\:(\\d+)\\:(\\d+)$/);\r\n        var date = new Date(match[1], match[2] - 1, match[3], match[4], match[5], match[6]);\r\n\r\n        return date;\r\n    };\r\n\r\n    /**\r\n     * get module element\r\n     * @param systemData\r\n     * @returns {*|HTMLElement}\r\n     */\r\n    var getModule = function(parentElement, systemData){\r\n\r\n        // create new module container\r\n        var moduleElement = $('<div>', {\r\n            class: [config.moduleClass, config.systemKillboardModuleClass].join(' '),\r\n            css: {opacity: 0}\r\n        });\r\n\r\n        parentElement.append(moduleElement);\r\n\r\n        // update graph\r\n        moduleElement.updateSystemInfoGraphs(systemData);\r\n\r\n        return moduleElement;\r\n    };\r\n\r\n\r\n    /**\r\n     * main module load function\r\n     * @param systemData\r\n     */\r\n    $.fn.drawSystemKillboardModule = function(systemData){\r\n\r\n        var parentElement = $(this);\r\n\r\n        // show route module\r\n        var showModule = function(moduleElement){\r\n            if(moduleElement){\r\n                moduleElement.velocity('transition.slideDownIn', {\r\n                    duration: Init.animationSpeed.mapModule,\r\n                    delay: Init.animationSpeed.mapModule\r\n                });\r\n            }\r\n        };\r\n\r\n        // check if module already exists\r\n        var moduleElement = parentElement.find('.' + config.systemKillboardModuleClass);\r\n\r\n        if(moduleElement.length > 0){\r\n            moduleElement.velocity('transition.slideDownOut', {\r\n                duration: Init.animationSpeed.mapModule,\r\n                complete: function(tempElement){\r\n                    $(tempElement).remove();\r\n\r\n                    moduleElement = getModule(parentElement, systemData);\r\n                    showModule(moduleElement);\r\n                }\r\n            });\r\n        }else{\r\n            moduleElement = getModule(parentElement, systemData);\r\n            showModule(moduleElement);\r\n        }\r\n\r\n    };\r\n});\n",
    "/*!\r\n DataTables 1.10.12\r\n ©2008-2015 SpryMedia Ltd - datatables.net/license\r\n*/\r\n(function(h){\"function\"===typeof define&&define.amd?define('datatables.net',[\"jquery\"],function(D){return h(D,window,document)}):\"object\"===typeof exports?module.exports=function(D,I){D||(D=window);I||(I=\"undefined\"!==typeof window?require(\"jquery\"):require(\"jquery\")(D));return h(I,D,D.document)}:h(jQuery,window,document)})(function(h,D,I,k){function X(a){var b,c,d={};h.each(a,function(e){if((b=e.match(/^([^A-Z]+?)([A-Z])/))&&-1!==\"a aa ai ao as b fn i m o s \".indexOf(b[1]+\" \"))c=e.replace(b[0],b[2].toLowerCase()),\r\nd[c]=e,\"o\"===b[1]&&X(a[e])});a._hungarianMap=d}function K(a,b,c){a._hungarianMap||X(a);var d;h.each(b,function(e){d=a._hungarianMap[e];if(d!==k&&(c||b[d]===k))\"o\"===d.charAt(0)?(b[d]||(b[d]={}),h.extend(!0,b[d],b[e]),K(a[d],b[d],c)):b[d]=b[e]})}function Da(a){var b=m.defaults.oLanguage,c=a.sZeroRecords;!a.sEmptyTable&&(c&&\"No data available in table\"===b.sEmptyTable)&&E(a,a,\"sZeroRecords\",\"sEmptyTable\");!a.sLoadingRecords&&(c&&\"Loading...\"===b.sLoadingRecords)&&E(a,a,\"sZeroRecords\",\"sLoadingRecords\");\r\na.sInfoThousands&&(a.sThousands=a.sInfoThousands);(a=a.sDecimal)&&db(a)}function eb(a){A(a,\"ordering\",\"bSort\");A(a,\"orderMulti\",\"bSortMulti\");A(a,\"orderClasses\",\"bSortClasses\");A(a,\"orderCellsTop\",\"bSortCellsTop\");A(a,\"order\",\"aaSorting\");A(a,\"orderFixed\",\"aaSortingFixed\");A(a,\"paging\",\"bPaginate\");A(a,\"pagingType\",\"sPaginationType\");A(a,\"pageLength\",\"iDisplayLength\");A(a,\"searching\",\"bFilter\");\"boolean\"===typeof a.sScrollX&&(a.sScrollX=a.sScrollX?\"100%\":\"\");\"boolean\"===typeof a.scrollX&&(a.scrollX=\r\na.scrollX?\"100%\":\"\");if(a=a.aoSearchCols)for(var b=0,c=a.length;b<c;b++)a[b]&&K(m.models.oSearch,a[b])}function fb(a){A(a,\"orderable\",\"bSortable\");A(a,\"orderData\",\"aDataSort\");A(a,\"orderSequence\",\"asSorting\");A(a,\"orderDataType\",\"sortDataType\");var b=a.aDataSort;b&&!h.isArray(b)&&(a.aDataSort=[b])}function gb(a){if(!m.__browser){var b={};m.__browser=b;var c=h(\"<div/>\").css({position:\"fixed\",top:0,left:0,height:1,width:1,overflow:\"hidden\"}).append(h(\"<div/>\").css({position:\"absolute\",top:1,left:1,\r\nwidth:100,overflow:\"scroll\"}).append(h(\"<div/>\").css({width:\"100%\",height:10}))).appendTo(\"body\"),d=c.children(),e=d.children();b.barWidth=d[0].offsetWidth-d[0].clientWidth;b.bScrollOversize=100===e[0].offsetWidth&&100!==d[0].clientWidth;b.bScrollbarLeft=1!==Math.round(e.offset().left);b.bBounding=c[0].getBoundingClientRect().width?!0:!1;c.remove()}h.extend(a.oBrowser,m.__browser);a.oScroll.iBarWidth=m.__browser.barWidth}function hb(a,b,c,d,e,f){var g,j=!1;c!==k&&(g=c,j=!0);for(;d!==e;)a.hasOwnProperty(d)&&\r\n(g=j?b(g,a[d],d,a):a[d],j=!0,d+=f);return g}function Ea(a,b){var c=m.defaults.column,d=a.aoColumns.length,c=h.extend({},m.models.oColumn,c,{nTh:b?b:I.createElement(\"th\"),sTitle:c.sTitle?c.sTitle:b?b.innerHTML:\"\",aDataSort:c.aDataSort?c.aDataSort:[d],mData:c.mData?c.mData:d,idx:d});a.aoColumns.push(c);c=a.aoPreSearchCols;c[d]=h.extend({},m.models.oSearch,c[d]);ja(a,d,h(b).data())}function ja(a,b,c){var b=a.aoColumns[b],d=a.oClasses,e=h(b.nTh);if(!b.sWidthOrig){b.sWidthOrig=e.attr(\"width\")||null;var f=\r\n(e.attr(\"style\")||\"\").match(/width:\\s*(\\d+[pxem%]+)/);f&&(b.sWidthOrig=f[1])}c!==k&&null!==c&&(fb(c),K(m.defaults.column,c),c.mDataProp!==k&&!c.mData&&(c.mData=c.mDataProp),c.sType&&(b._sManualType=c.sType),c.className&&!c.sClass&&(c.sClass=c.className),h.extend(b,c),E(b,c,\"sWidth\",\"sWidthOrig\"),c.iDataSort!==k&&(b.aDataSort=[c.iDataSort]),E(b,c,\"aDataSort\"));var g=b.mData,j=Q(g),i=b.mRender?Q(b.mRender):null,c=function(a){return\"string\"===typeof a&&-1!==a.indexOf(\"@\")};b._bAttrSrc=h.isPlainObject(g)&&\r\n(c(g.sort)||c(g.type)||c(g.filter));b._setter=null;b.fnGetData=function(a,b,c){var d=j(a,b,k,c);return i&&b?i(d,b,a,c):d};b.fnSetData=function(a,b,c){return R(g)(a,b,c)};\"number\"!==typeof g&&(a._rowReadObject=!0);a.oFeatures.bSort||(b.bSortable=!1,e.addClass(d.sSortableNone));a=-1!==h.inArray(\"asc\",b.asSorting);c=-1!==h.inArray(\"desc\",b.asSorting);!b.bSortable||!a&&!c?(b.sSortingClass=d.sSortableNone,b.sSortingClassJUI=\"\"):a&&!c?(b.sSortingClass=d.sSortableAsc,b.sSortingClassJUI=d.sSortJUIAscAllowed):\r\n!a&&c?(b.sSortingClass=d.sSortableDesc,b.sSortingClassJUI=d.sSortJUIDescAllowed):(b.sSortingClass=d.sSortable,b.sSortingClassJUI=d.sSortJUI)}function Y(a){if(!1!==a.oFeatures.bAutoWidth){var b=a.aoColumns;Fa(a);for(var c=0,d=b.length;c<d;c++)b[c].nTh.style.width=b[c].sWidth}b=a.oScroll;(\"\"!==b.sY||\"\"!==b.sX)&&ka(a);u(a,null,\"column-sizing\",[a])}function Z(a,b){var c=la(a,\"bVisible\");return\"number\"===typeof c[b]?c[b]:null}function $(a,b){var c=la(a,\"bVisible\"),c=h.inArray(b,c);return-1!==c?c:null}\r\nfunction aa(a){var b=0;h.each(a.aoColumns,function(a,d){d.bVisible&&\"none\"!==h(d.nTh).css(\"display\")&&b++});return b}function la(a,b){var c=[];h.map(a.aoColumns,function(a,e){a[b]&&c.push(e)});return c}function Ga(a){var b=a.aoColumns,c=a.aoData,d=m.ext.type.detect,e,f,g,j,i,h,l,q,t;e=0;for(f=b.length;e<f;e++)if(l=b[e],t=[],!l.sType&&l._sManualType)l.sType=l._sManualType;else if(!l.sType){g=0;for(j=d.length;g<j;g++){i=0;for(h=c.length;i<h;i++){t[i]===k&&(t[i]=B(a,i,e,\"type\"));q=d[g](t[i],a);if(!q&&\r\ng!==d.length-1)break;if(\"html\"===q)break}if(q){l.sType=q;break}}l.sType||(l.sType=\"string\")}}function ib(a,b,c,d){var e,f,g,j,i,n,l=a.aoColumns;if(b)for(e=b.length-1;0<=e;e--){n=b[e];var q=n.targets!==k?n.targets:n.aTargets;h.isArray(q)||(q=[q]);f=0;for(g=q.length;f<g;f++)if(\"number\"===typeof q[f]&&0<=q[f]){for(;l.length<=q[f];)Ea(a);d(q[f],n)}else if(\"number\"===typeof q[f]&&0>q[f])d(l.length+q[f],n);else if(\"string\"===typeof q[f]){j=0;for(i=l.length;j<i;j++)(\"_all\"==q[f]||h(l[j].nTh).hasClass(q[f]))&&\r\nd(j,n)}}if(c){e=0;for(a=c.length;e<a;e++)d(e,c[e])}}function N(a,b,c,d){var e=a.aoData.length,f=h.extend(!0,{},m.models.oRow,{src:c?\"dom\":\"data\",idx:e});f._aData=b;a.aoData.push(f);for(var g=a.aoColumns,j=0,i=g.length;j<i;j++)g[j].sType=null;a.aiDisplayMaster.push(e);b=a.rowIdFn(b);b!==k&&(a.aIds[b]=f);(c||!a.oFeatures.bDeferRender)&&Ha(a,e,c,d);return e}function ma(a,b){var c;b instanceof h||(b=h(b));return b.map(function(b,e){c=Ia(a,e);return N(a,c.data,e,c.cells)})}function B(a,b,c,d){var e=a.iDraw,\r\nf=a.aoColumns[c],g=a.aoData[b]._aData,j=f.sDefaultContent,i=f.fnGetData(g,d,{settings:a,row:b,col:c});if(i===k)return a.iDrawError!=e&&null===j&&(L(a,0,\"Requested unknown parameter \"+(\"function\"==typeof f.mData?\"{function}\":\"'\"+f.mData+\"'\")+\" for row \"+b+\", column \"+c,4),a.iDrawError=e),j;if((i===g||null===i)&&null!==j&&d!==k)i=j;else if(\"function\"===typeof i)return i.call(g);return null===i&&\"display\"==d?\"\":i}function jb(a,b,c,d){a.aoColumns[c].fnSetData(a.aoData[b]._aData,d,{settings:a,row:b,col:c})}\r\nfunction Ja(a){return h.map(a.match(/(\\\\.|[^\\.])+/g)||[\"\"],function(a){return a.replace(/\\\\./g,\".\")})}function Q(a){if(h.isPlainObject(a)){var b={};h.each(a,function(a,c){c&&(b[a]=Q(c))});return function(a,c,f,g){var j=b[c]||b._;return j!==k?j(a,c,f,g):a}}if(null===a)return function(a){return a};if(\"function\"===typeof a)return function(b,c,f,g){return a(b,c,f,g)};if(\"string\"===typeof a&&(-1!==a.indexOf(\".\")||-1!==a.indexOf(\"[\")||-1!==a.indexOf(\"(\"))){var c=function(a,b,f){var g,j;if(\"\"!==f){j=Ja(f);\r\nfor(var i=0,n=j.length;i<n;i++){f=j[i].match(ba);g=j[i].match(U);if(f){j[i]=j[i].replace(ba,\"\");\"\"!==j[i]&&(a=a[j[i]]);g=[];j.splice(0,i+1);j=j.join(\".\");if(h.isArray(a)){i=0;for(n=a.length;i<n;i++)g.push(c(a[i],b,j))}a=f[0].substring(1,f[0].length-1);a=\"\"===a?g:g.join(a);break}else if(g){j[i]=j[i].replace(U,\"\");a=a[j[i]]();continue}if(null===a||a[j[i]]===k)return k;a=a[j[i]]}}return a};return function(b,e){return c(b,e,a)}}return function(b){return b[a]}}function R(a){if(h.isPlainObject(a))return R(a._);\r\nif(null===a)return function(){};if(\"function\"===typeof a)return function(b,d,e){a(b,\"set\",d,e)};if(\"string\"===typeof a&&(-1!==a.indexOf(\".\")||-1!==a.indexOf(\"[\")||-1!==a.indexOf(\"(\"))){var b=function(a,d,e){var e=Ja(e),f;f=e[e.length-1];for(var g,j,i=0,n=e.length-1;i<n;i++){g=e[i].match(ba);j=e[i].match(U);if(g){e[i]=e[i].replace(ba,\"\");a[e[i]]=[];f=e.slice();f.splice(0,i+1);g=f.join(\".\");if(h.isArray(d)){j=0;for(n=d.length;j<n;j++)f={},b(f,d[j],g),a[e[i]].push(f)}else a[e[i]]=d;return}j&&(e[i]=e[i].replace(U,\r\n\"\"),a=a[e[i]](d));if(null===a[e[i]]||a[e[i]]===k)a[e[i]]={};a=a[e[i]]}if(f.match(U))a[f.replace(U,\"\")](d);else a[f.replace(ba,\"\")]=d};return function(c,d){return b(c,d,a)}}return function(b,d){b[a]=d}}function Ka(a){return G(a.aoData,\"_aData\")}function na(a){a.aoData.length=0;a.aiDisplayMaster.length=0;a.aiDisplay.length=0;a.aIds={}}function oa(a,b,c){for(var d=-1,e=0,f=a.length;e<f;e++)a[e]==b?d=e:a[e]>b&&a[e]--; -1!=d&&c===k&&a.splice(d,1)}function ca(a,b,c,d){var e=a.aoData[b],f,g=function(c,d){for(;c.childNodes.length;)c.removeChild(c.firstChild);\r\nc.innerHTML=B(a,b,d,\"display\")};if(\"dom\"===c||(!c||\"auto\"===c)&&\"dom\"===e.src)e._aData=Ia(a,e,d,d===k?k:e._aData).data;else{var j=e.anCells;if(j)if(d!==k)g(j[d],d);else{c=0;for(f=j.length;c<f;c++)g(j[c],c)}}e._aSortData=null;e._aFilterData=null;g=a.aoColumns;if(d!==k)g[d].sType=null;else{c=0;for(f=g.length;c<f;c++)g[c].sType=null;La(a,e)}}function Ia(a,b,c,d){var e=[],f=b.firstChild,g,j,i=0,n,l=a.aoColumns,q=a._rowReadObject,d=d!==k?d:q?{}:[],t=function(a,b){if(\"string\"===typeof a){var c=a.indexOf(\"@\");\r\n-1!==c&&(c=a.substring(c+1),R(a)(d,b.getAttribute(c)))}},S=function(a){if(c===k||c===i)j=l[i],n=h.trim(a.innerHTML),j&&j._bAttrSrc?(R(j.mData._)(d,n),t(j.mData.sort,a),t(j.mData.type,a),t(j.mData.filter,a)):q?(j._setter||(j._setter=R(j.mData)),j._setter(d,n)):d[i]=n;i++};if(f)for(;f;){g=f.nodeName.toUpperCase();if(\"TD\"==g||\"TH\"==g)S(f),e.push(f);f=f.nextSibling}else{e=b.anCells;f=0;for(g=e.length;f<g;f++)S(e[f])}if(b=b.firstChild?b:b.nTr)(b=b.getAttribute(\"id\"))&&R(a.rowId)(d,b);return{data:d,cells:e}}\r\nfunction Ha(a,b,c,d){var e=a.aoData[b],f=e._aData,g=[],j,i,n,l,q;if(null===e.nTr){j=c||I.createElement(\"tr\");e.nTr=j;e.anCells=g;j._DT_RowIndex=b;La(a,e);l=0;for(q=a.aoColumns.length;l<q;l++){n=a.aoColumns[l];i=c?d[l]:I.createElement(n.sCellType);i._DT_CellIndex={row:b,column:l};g.push(i);if((!c||n.mRender||n.mData!==l)&&(!h.isPlainObject(n.mData)||n.mData._!==l+\".display\"))i.innerHTML=B(a,b,l,\"display\");n.sClass&&(i.className+=\" \"+n.sClass);n.bVisible&&!c?j.appendChild(i):!n.bVisible&&c&&i.parentNode.removeChild(i);\r\nn.fnCreatedCell&&n.fnCreatedCell.call(a.oInstance,i,B(a,b,l),f,b,l)}u(a,\"aoRowCreatedCallback\",null,[j,f,b])}e.nTr.setAttribute(\"role\",\"row\")}function La(a,b){var c=b.nTr,d=b._aData;if(c){var e=a.rowIdFn(d);e&&(c.id=e);d.DT_RowClass&&(e=d.DT_RowClass.split(\" \"),b.__rowc=b.__rowc?pa(b.__rowc.concat(e)):e,h(c).removeClass(b.__rowc.join(\" \")).addClass(d.DT_RowClass));d.DT_RowAttr&&h(c).attr(d.DT_RowAttr);d.DT_RowData&&h(c).data(d.DT_RowData)}}function kb(a){var b,c,d,e,f,g=a.nTHead,j=a.nTFoot,i=0===\r\nh(\"th, td\",g).length,n=a.oClasses,l=a.aoColumns;i&&(e=h(\"<tr/>\").appendTo(g));b=0;for(c=l.length;b<c;b++)f=l[b],d=h(f.nTh).addClass(f.sClass),i&&d.appendTo(e),a.oFeatures.bSort&&(d.addClass(f.sSortingClass),!1!==f.bSortable&&(d.attr(\"tabindex\",a.iTabIndex).attr(\"aria-controls\",a.sTableId),Ma(a,f.nTh,b))),f.sTitle!=d[0].innerHTML&&d.html(f.sTitle),Na(a,\"header\")(a,d,f,n);i&&da(a.aoHeader,g);h(g).find(\">tr\").attr(\"role\",\"row\");h(g).find(\">tr>th, >tr>td\").addClass(n.sHeaderTH);h(j).find(\">tr>th, >tr>td\").addClass(n.sFooterTH);\r\nif(null!==j){a=a.aoFooter[0];b=0;for(c=a.length;b<c;b++)f=l[b],f.nTf=a[b].cell,f.sClass&&h(f.nTf).addClass(f.sClass)}}function ea(a,b,c){var d,e,f,g=[],j=[],i=a.aoColumns.length,n;if(b){c===k&&(c=!1);d=0;for(e=b.length;d<e;d++){g[d]=b[d].slice();g[d].nTr=b[d].nTr;for(f=i-1;0<=f;f--)!a.aoColumns[f].bVisible&&!c&&g[d].splice(f,1);j.push([])}d=0;for(e=g.length;d<e;d++){if(a=g[d].nTr)for(;f=a.firstChild;)a.removeChild(f);f=0;for(b=g[d].length;f<b;f++)if(n=i=1,j[d][f]===k){a.appendChild(g[d][f].cell);\r\nfor(j[d][f]=1;g[d+i]!==k&&g[d][f].cell==g[d+i][f].cell;)j[d+i][f]=1,i++;for(;g[d][f+n]!==k&&g[d][f].cell==g[d][f+n].cell;){for(c=0;c<i;c++)j[d+c][f+n]=1;n++}h(g[d][f].cell).attr(\"rowspan\",i).attr(\"colspan\",n)}}}}function O(a){var b=u(a,\"aoPreDrawCallback\",\"preDraw\",[a]);if(-1!==h.inArray(!1,b))C(a,!1);else{var b=[],c=0,d=a.asStripeClasses,e=d.length,f=a.oLanguage,g=a.iInitDisplayStart,j=\"ssp\"==y(a),i=a.aiDisplay;a.bDrawing=!0;g!==k&&-1!==g&&(a._iDisplayStart=j?g:g>=a.fnRecordsDisplay()?0:g,a.iInitDisplayStart=\r\n-1);var g=a._iDisplayStart,n=a.fnDisplayEnd();if(a.bDeferLoading)a.bDeferLoading=!1,a.iDraw++,C(a,!1);else if(j){if(!a.bDestroying&&!lb(a))return}else a.iDraw++;if(0!==i.length){f=j?a.aoData.length:n;for(j=j?0:g;j<f;j++){var l=i[j],q=a.aoData[l];null===q.nTr&&Ha(a,l);l=q.nTr;if(0!==e){var t=d[c%e];q._sRowStripe!=t&&(h(l).removeClass(q._sRowStripe).addClass(t),q._sRowStripe=t)}u(a,\"aoRowCallback\",null,[l,q._aData,c,j]);b.push(l);c++}}else c=f.sZeroRecords,1==a.iDraw&&\"ajax\"==y(a)?c=f.sLoadingRecords:\r\nf.sEmptyTable&&0===a.fnRecordsTotal()&&(c=f.sEmptyTable),b[0]=h(\"<tr/>\",{\"class\":e?d[0]:\"\"}).append(h(\"<td />\",{valign:\"top\",colSpan:aa(a),\"class\":a.oClasses.sRowEmpty}).html(c))[0];u(a,\"aoHeaderCallback\",\"header\",[h(a.nTHead).children(\"tr\")[0],Ka(a),g,n,i]);u(a,\"aoFooterCallback\",\"footer\",[h(a.nTFoot).children(\"tr\")[0],Ka(a),g,n,i]);d=h(a.nTBody);d.children().detach();d.append(h(b));u(a,\"aoDrawCallback\",\"draw\",[a]);a.bSorted=!1;a.bFiltered=!1;a.bDrawing=!1}}function T(a,b){var c=a.oFeatures,d=c.bFilter;\r\nc.bSort&&mb(a);d?fa(a,a.oPreviousSearch):a.aiDisplay=a.aiDisplayMaster.slice();!0!==b&&(a._iDisplayStart=0);a._drawHold=b;O(a);a._drawHold=!1}function nb(a){var b=a.oClasses,c=h(a.nTable),c=h(\"<div/>\").insertBefore(c),d=a.oFeatures,e=h(\"<div/>\",{id:a.sTableId+\"_wrapper\",\"class\":b.sWrapper+(a.nTFoot?\"\":\" \"+b.sNoFooter)});a.nHolding=c[0];a.nTableWrapper=e[0];a.nTableReinsertBefore=a.nTable.nextSibling;for(var f=a.sDom.split(\"\"),g,j,i,n,l,q,t=0;t<f.length;t++){g=null;j=f[t];if(\"<\"==j){i=h(\"<div/>\")[0];\r\nn=f[t+1];if(\"'\"==n||'\"'==n){l=\"\";for(q=2;f[t+q]!=n;)l+=f[t+q],q++;\"H\"==l?l=b.sJUIHeader:\"F\"==l&&(l=b.sJUIFooter);-1!=l.indexOf(\".\")?(n=l.split(\".\"),i.id=n[0].substr(1,n[0].length-1),i.className=n[1]):\"#\"==l.charAt(0)?i.id=l.substr(1,l.length-1):i.className=l;t+=q}e.append(i);e=h(i)}else if(\">\"==j)e=e.parent();else if(\"l\"==j&&d.bPaginate&&d.bLengthChange)g=ob(a);else if(\"f\"==j&&d.bFilter)g=pb(a);else if(\"r\"==j&&d.bProcessing)g=qb(a);else if(\"t\"==j)g=rb(a);else if(\"i\"==j&&d.bInfo)g=sb(a);else if(\"p\"==\r\nj&&d.bPaginate)g=tb(a);else if(0!==m.ext.feature.length){i=m.ext.feature;q=0;for(n=i.length;q<n;q++)if(j==i[q].cFeature){g=i[q].fnInit(a);break}}g&&(i=a.aanFeatures,i[j]||(i[j]=[]),i[j].push(g),e.append(g))}c.replaceWith(e);a.nHolding=null}function da(a,b){var c=h(b).children(\"tr\"),d,e,f,g,j,i,n,l,q,t;a.splice(0,a.length);f=0;for(i=c.length;f<i;f++)a.push([]);f=0;for(i=c.length;f<i;f++){d=c[f];for(e=d.firstChild;e;){if(\"TD\"==e.nodeName.toUpperCase()||\"TH\"==e.nodeName.toUpperCase()){l=1*e.getAttribute(\"colspan\");\r\nq=1*e.getAttribute(\"rowspan\");l=!l||0===l||1===l?1:l;q=!q||0===q||1===q?1:q;g=0;for(j=a[f];j[g];)g++;n=g;t=1===l?!0:!1;for(j=0;j<l;j++)for(g=0;g<q;g++)a[f+g][n+j]={cell:e,unique:t},a[f+g].nTr=d}e=e.nextSibling}}}function qa(a,b,c){var d=[];c||(c=a.aoHeader,b&&(c=[],da(c,b)));for(var b=0,e=c.length;b<e;b++)for(var f=0,g=c[b].length;f<g;f++)if(c[b][f].unique&&(!d[f]||!a.bSortCellsTop))d[f]=c[b][f].cell;return d}function ra(a,b,c){u(a,\"aoServerParams\",\"serverParams\",[b]);if(b&&h.isArray(b)){var d={},\r\ne=/(.*?)\\[\\]$/;h.each(b,function(a,b){var c=b.name.match(e);c?(c=c[0],d[c]||(d[c]=[]),d[c].push(b.value)):d[b.name]=b.value});b=d}var f,g=a.ajax,j=a.oInstance,i=function(b){u(a,null,\"xhr\",[a,b,a.jqXHR]);c(b)};if(h.isPlainObject(g)&&g.data){f=g.data;var n=h.isFunction(f)?f(b,a):f,b=h.isFunction(f)&&n?n:h.extend(!0,b,n);delete g.data}n={data:b,success:function(b){var c=b.error||b.sError;c&&L(a,0,c);a.json=b;i(b)},dataType:\"json\",cache:!1,type:a.sServerMethod,error:function(b,c){var d=u(a,null,\"xhr\",\r\n[a,null,a.jqXHR]);-1===h.inArray(!0,d)&&(\"parsererror\"==c?L(a,0,\"Invalid JSON response\",1):4===b.readyState&&L(a,0,\"Ajax error\",7));C(a,!1)}};a.oAjaxData=b;u(a,null,\"preXhr\",[a,b]);a.fnServerData?a.fnServerData.call(j,a.sAjaxSource,h.map(b,function(a,b){return{name:b,value:a}}),i,a):a.sAjaxSource||\"string\"===typeof g?a.jqXHR=h.ajax(h.extend(n,{url:g||a.sAjaxSource})):h.isFunction(g)?a.jqXHR=g.call(j,b,i,a):(a.jqXHR=h.ajax(h.extend(n,g)),g.data=f)}function lb(a){return a.bAjaxDataGet?(a.iDraw++,C(a,\r\n!0),ra(a,ub(a),function(b){vb(a,b)}),!1):!0}function ub(a){var b=a.aoColumns,c=b.length,d=a.oFeatures,e=a.oPreviousSearch,f=a.aoPreSearchCols,g,j=[],i,n,l,q=V(a);g=a._iDisplayStart;i=!1!==d.bPaginate?a._iDisplayLength:-1;var k=function(a,b){j.push({name:a,value:b})};k(\"sEcho\",a.iDraw);k(\"iColumns\",c);k(\"sColumns\",G(b,\"sName\").join(\",\"));k(\"iDisplayStart\",g);k(\"iDisplayLength\",i);var S={draw:a.iDraw,columns:[],order:[],start:g,length:i,search:{value:e.sSearch,regex:e.bRegex}};for(g=0;g<c;g++)n=b[g],\r\nl=f[g],i=\"function\"==typeof n.mData?\"function\":n.mData,S.columns.push({data:i,name:n.sName,searchable:n.bSearchable,orderable:n.bSortable,search:{value:l.sSearch,regex:l.bRegex}}),k(\"mDataProp_\"+g,i),d.bFilter&&(k(\"sSearch_\"+g,l.sSearch),k(\"bRegex_\"+g,l.bRegex),k(\"bSearchable_\"+g,n.bSearchable)),d.bSort&&k(\"bSortable_\"+g,n.bSortable);d.bFilter&&(k(\"sSearch\",e.sSearch),k(\"bRegex\",e.bRegex));d.bSort&&(h.each(q,function(a,b){S.order.push({column:b.col,dir:b.dir});k(\"iSortCol_\"+a,b.col);k(\"sSortDir_\"+\r\na,b.dir)}),k(\"iSortingCols\",q.length));b=m.ext.legacy.ajax;return null===b?a.sAjaxSource?j:S:b?j:S}function vb(a,b){var c=sa(a,b),d=b.sEcho!==k?b.sEcho:b.draw,e=b.iTotalRecords!==k?b.iTotalRecords:b.recordsTotal,f=b.iTotalDisplayRecords!==k?b.iTotalDisplayRecords:b.recordsFiltered;if(d){if(1*d<a.iDraw)return;a.iDraw=1*d}na(a);a._iRecordsTotal=parseInt(e,10);a._iRecordsDisplay=parseInt(f,10);d=0;for(e=c.length;d<e;d++)N(a,c[d]);a.aiDisplay=a.aiDisplayMaster.slice();a.bAjaxDataGet=!1;O(a);a._bInitComplete||\r\nta(a,b);a.bAjaxDataGet=!0;C(a,!1)}function sa(a,b){var c=h.isPlainObject(a.ajax)&&a.ajax.dataSrc!==k?a.ajax.dataSrc:a.sAjaxDataProp;return\"data\"===c?b.aaData||b[c]:\"\"!==c?Q(c)(b):b}function pb(a){var b=a.oClasses,c=a.sTableId,d=a.oLanguage,e=a.oPreviousSearch,f=a.aanFeatures,g='<input type=\"search\" class=\"'+b.sFilterInput+'\"/>',j=d.sSearch,j=j.match(/_INPUT_/)?j.replace(\"_INPUT_\",g):j+g,b=h(\"<div/>\",{id:!f.f?c+\"_filter\":null,\"class\":b.sFilter}).append(h(\"<label/>\").append(j)),f=function(){var b=!this.value?\r\n\"\":this.value;b!=e.sSearch&&(fa(a,{sSearch:b,bRegex:e.bRegex,bSmart:e.bSmart,bCaseInsensitive:e.bCaseInsensitive}),a._iDisplayStart=0,O(a))},g=null!==a.searchDelay?a.searchDelay:\"ssp\"===y(a)?400:0,i=h(\"input\",b).val(e.sSearch).attr(\"placeholder\",d.sSearchPlaceholder).bind(\"keyup.DT search.DT input.DT paste.DT cut.DT\",g?Oa(f,g):f).bind(\"keypress.DT\",function(a){if(13==a.keyCode)return!1}).attr(\"aria-controls\",c);h(a.nTable).on(\"search.dt.DT\",function(b,c){if(a===c)try{i[0]!==I.activeElement&&i.val(e.sSearch)}catch(d){}});\r\nreturn b[0]}function fa(a,b,c){var d=a.oPreviousSearch,e=a.aoPreSearchCols,f=function(a){d.sSearch=a.sSearch;d.bRegex=a.bRegex;d.bSmart=a.bSmart;d.bCaseInsensitive=a.bCaseInsensitive};Ga(a);if(\"ssp\"!=y(a)){wb(a,b.sSearch,c,b.bEscapeRegex!==k?!b.bEscapeRegex:b.bRegex,b.bSmart,b.bCaseInsensitive);f(b);for(b=0;b<e.length;b++)xb(a,e[b].sSearch,b,e[b].bEscapeRegex!==k?!e[b].bEscapeRegex:e[b].bRegex,e[b].bSmart,e[b].bCaseInsensitive);yb(a)}else f(b);a.bFiltered=!0;u(a,null,\"search\",[a])}function yb(a){for(var b=\r\nm.ext.search,c=a.aiDisplay,d,e,f=0,g=b.length;f<g;f++){for(var j=[],i=0,n=c.length;i<n;i++)e=c[i],d=a.aoData[e],b[f](a,d._aFilterData,e,d._aData,i)&&j.push(e);c.length=0;h.merge(c,j)}}function xb(a,b,c,d,e,f){if(\"\"!==b)for(var g=a.aiDisplay,d=Pa(b,d,e,f),e=g.length-1;0<=e;e--)b=a.aoData[g[e]]._aFilterData[c],d.test(b)||g.splice(e,1)}function wb(a,b,c,d,e,f){var d=Pa(b,d,e,f),e=a.oPreviousSearch.sSearch,f=a.aiDisplayMaster,g;0!==m.ext.search.length&&(c=!0);g=zb(a);if(0>=b.length)a.aiDisplay=f.slice();\r\nelse{if(g||c||e.length>b.length||0!==b.indexOf(e)||a.bSorted)a.aiDisplay=f.slice();b=a.aiDisplay;for(c=b.length-1;0<=c;c--)d.test(a.aoData[b[c]]._sFilterRow)||b.splice(c,1)}}function Pa(a,b,c,d){a=b?a:Qa(a);c&&(a=\"^(?=.*?\"+h.map(a.match(/\"[^\"]+\"|[^ ]+/g)||[\"\"],function(a){if('\"'===a.charAt(0))var b=a.match(/^\"(.*)\"$/),a=b?b[1]:a;return a.replace('\"',\"\")}).join(\")(?=.*?\")+\").*$\");return RegExp(a,d?\"i\":\"\")}function zb(a){var b=a.aoColumns,c,d,e,f,g,j,i,h,l=m.ext.type.search;c=!1;d=0;for(f=a.aoData.length;d<\r\nf;d++)if(h=a.aoData[d],!h._aFilterData){j=[];e=0;for(g=b.length;e<g;e++)c=b[e],c.bSearchable?(i=B(a,d,e,\"filter\"),l[c.sType]&&(i=l[c.sType](i)),null===i&&(i=\"\"),\"string\"!==typeof i&&i.toString&&(i=i.toString())):i=\"\",i.indexOf&&-1!==i.indexOf(\"&\")&&(ua.innerHTML=i,i=Zb?ua.textContent:ua.innerText),i.replace&&(i=i.replace(/[\\r\\n]/g,\"\")),j.push(i);h._aFilterData=j;h._sFilterRow=j.join(\"  \");c=!0}return c}function Ab(a){return{search:a.sSearch,smart:a.bSmart,regex:a.bRegex,caseInsensitive:a.bCaseInsensitive}}\r\nfunction Bb(a){return{sSearch:a.search,bSmart:a.smart,bRegex:a.regex,bCaseInsensitive:a.caseInsensitive}}function sb(a){var b=a.sTableId,c=a.aanFeatures.i,d=h(\"<div/>\",{\"class\":a.oClasses.sInfo,id:!c?b+\"_info\":null});c||(a.aoDrawCallback.push({fn:Cb,sName:\"information\"}),d.attr(\"role\",\"status\").attr(\"aria-live\",\"polite\"),h(a.nTable).attr(\"aria-describedby\",b+\"_info\"));return d[0]}function Cb(a){var b=a.aanFeatures.i;if(0!==b.length){var c=a.oLanguage,d=a._iDisplayStart+1,e=a.fnDisplayEnd(),f=a.fnRecordsTotal(),\r\ng=a.fnRecordsDisplay(),j=g?c.sInfo:c.sInfoEmpty;g!==f&&(j+=\" \"+c.sInfoFiltered);j+=c.sInfoPostFix;j=Db(a,j);c=c.fnInfoCallback;null!==c&&(j=c.call(a.oInstance,a,d,e,f,g,j));h(b).html(j)}}function Db(a,b){var c=a.fnFormatNumber,d=a._iDisplayStart+1,e=a._iDisplayLength,f=a.fnRecordsDisplay(),g=-1===e;return b.replace(/_START_/g,c.call(a,d)).replace(/_END_/g,c.call(a,a.fnDisplayEnd())).replace(/_MAX_/g,c.call(a,a.fnRecordsTotal())).replace(/_TOTAL_/g,c.call(a,f)).replace(/_PAGE_/g,c.call(a,g?1:Math.ceil(d/\r\ne))).replace(/_PAGES_/g,c.call(a,g?1:Math.ceil(f/e)))}function ga(a){var b,c,d=a.iInitDisplayStart,e=a.aoColumns,f;c=a.oFeatures;var g=a.bDeferLoading;if(a.bInitialised){nb(a);kb(a);ea(a,a.aoHeader);ea(a,a.aoFooter);C(a,!0);c.bAutoWidth&&Fa(a);b=0;for(c=e.length;b<c;b++)f=e[b],f.sWidth&&(f.nTh.style.width=x(f.sWidth));u(a,null,\"preInit\",[a]);T(a);e=y(a);if(\"ssp\"!=e||g)\"ajax\"==e?ra(a,[],function(c){var f=sa(a,c);for(b=0;b<f.length;b++)N(a,f[b]);a.iInitDisplayStart=d;T(a);C(a,!1);ta(a,c)},a):(C(a,!1),\r\nta(a))}else setTimeout(function(){ga(a)},200)}function ta(a,b){a._bInitComplete=!0;(b||a.oInit.aaData)&&Y(a);u(a,null,\"plugin-init\",[a,b]);u(a,\"aoInitComplete\",\"init\",[a,b])}function Ra(a,b){var c=parseInt(b,10);a._iDisplayLength=c;Sa(a);u(a,null,\"length\",[a,c])}function ob(a){for(var b=a.oClasses,c=a.sTableId,d=a.aLengthMenu,e=h.isArray(d[0]),f=e?d[0]:d,d=e?d[1]:d,e=h(\"<select/>\",{name:c+\"_length\",\"aria-controls\":c,\"class\":b.sLengthSelect}),g=0,j=f.length;g<j;g++)e[0][g]=new Option(d[g],f[g]);var i=\r\nh(\"<div><label/></div>\").addClass(b.sLength);a.aanFeatures.l||(i[0].id=c+\"_length\");i.children().append(a.oLanguage.sLengthMenu.replace(\"_MENU_\",e[0].outerHTML));h(\"select\",i).val(a._iDisplayLength).bind(\"change.DT\",function(){Ra(a,h(this).val());O(a)});h(a.nTable).bind(\"length.dt.DT\",function(b,c,d){a===c&&h(\"select\",i).val(d)});return i[0]}function tb(a){var b=a.sPaginationType,c=m.ext.pager[b],d=\"function\"===typeof c,e=function(a){O(a)},b=h(\"<div/>\").addClass(a.oClasses.sPaging+b)[0],f=a.aanFeatures;\r\nd||c.fnInit(a,b,e);f.p||(b.id=a.sTableId+\"_paginate\",a.aoDrawCallback.push({fn:function(a){if(d){var b=a._iDisplayStart,i=a._iDisplayLength,h=a.fnRecordsDisplay(),l=-1===i,b=l?0:Math.ceil(b/i),i=l?1:Math.ceil(h/i),h=c(b,i),k,l=0;for(k=f.p.length;l<k;l++)Na(a,\"pageButton\")(a,f.p[l],l,h,b,i)}else c.fnUpdate(a,e)},sName:\"pagination\"}));return b}function Ta(a,b,c){var d=a._iDisplayStart,e=a._iDisplayLength,f=a.fnRecordsDisplay();0===f||-1===e?d=0:\"number\"===typeof b?(d=b*e,d>f&&(d=0)):\"first\"==b?d=0:\r\n\"previous\"==b?(d=0<=e?d-e:0,0>d&&(d=0)):\"next\"==b?d+e<f&&(d+=e):\"last\"==b?d=Math.floor((f-1)/e)*e:L(a,0,\"Unknown paging action: \"+b,5);b=a._iDisplayStart!==d;a._iDisplayStart=d;b&&(u(a,null,\"page\",[a]),c&&O(a));return b}function qb(a){return h(\"<div/>\",{id:!a.aanFeatures.r?a.sTableId+\"_processing\":null,\"class\":a.oClasses.sProcessing}).html(a.oLanguage.sProcessing).insertBefore(a.nTable)[0]}function C(a,b){a.oFeatures.bProcessing&&h(a.aanFeatures.r).css(\"display\",b?\"block\":\"none\");u(a,null,\"processing\",\r\n[a,b])}function rb(a){var b=h(a.nTable);b.attr(\"role\",\"grid\");var c=a.oScroll;if(\"\"===c.sX&&\"\"===c.sY)return a.nTable;var d=c.sX,e=c.sY,f=a.oClasses,g=b.children(\"caption\"),j=g.length?g[0]._captionSide:null,i=h(b[0].cloneNode(!1)),n=h(b[0].cloneNode(!1)),l=b.children(\"tfoot\");l.length||(l=null);i=h(\"<div/>\",{\"class\":f.sScrollWrapper}).append(h(\"<div/>\",{\"class\":f.sScrollHead}).css({overflow:\"hidden\",position:\"relative\",border:0,width:d?!d?null:x(d):\"100%\"}).append(h(\"<div/>\",{\"class\":f.sScrollHeadInner}).css({\"box-sizing\":\"content-box\",\r\nwidth:c.sXInner||\"100%\"}).append(i.removeAttr(\"id\").css(\"margin-left\",0).append(\"top\"===j?g:null).append(b.children(\"thead\"))))).append(h(\"<div/>\",{\"class\":f.sScrollBody}).css({position:\"relative\",overflow:\"auto\",width:!d?null:x(d)}).append(b));l&&i.append(h(\"<div/>\",{\"class\":f.sScrollFoot}).css({overflow:\"hidden\",border:0,width:d?!d?null:x(d):\"100%\"}).append(h(\"<div/>\",{\"class\":f.sScrollFootInner}).append(n.removeAttr(\"id\").css(\"margin-left\",0).append(\"bottom\"===j?g:null).append(b.children(\"tfoot\")))));\r\nvar b=i.children(),k=b[0],f=b[1],t=l?b[2]:null;if(d)h(f).on(\"scroll.DT\",function(){var a=this.scrollLeft;k.scrollLeft=a;l&&(t.scrollLeft=a)});h(f).css(e&&c.bCollapse?\"max-height\":\"height\",e);a.nScrollHead=k;a.nScrollBody=f;a.nScrollFoot=t;a.aoDrawCallback.push({fn:ka,sName:\"scrolling\"});return i[0]}function ka(a){var b=a.oScroll,c=b.sX,d=b.sXInner,e=b.sY,b=b.iBarWidth,f=h(a.nScrollHead),g=f[0].style,j=f.children(\"div\"),i=j[0].style,n=j.children(\"table\"),j=a.nScrollBody,l=h(j),q=j.style,t=h(a.nScrollFoot).children(\"div\"),\r\nm=t.children(\"table\"),o=h(a.nTHead),F=h(a.nTable),p=F[0],r=p.style,u=a.nTFoot?h(a.nTFoot):null,Eb=a.oBrowser,Ua=Eb.bScrollOversize,s=G(a.aoColumns,\"nTh\"),P,v,w,y,z=[],A=[],B=[],C=[],D,E=function(a){a=a.style;a.paddingTop=\"0\";a.paddingBottom=\"0\";a.borderTopWidth=\"0\";a.borderBottomWidth=\"0\";a.height=0};v=j.scrollHeight>j.clientHeight;if(a.scrollBarVis!==v&&a.scrollBarVis!==k)a.scrollBarVis=v,Y(a);else{a.scrollBarVis=v;F.children(\"thead, tfoot\").remove();u&&(w=u.clone().prependTo(F),P=u.find(\"tr\"),w=\r\nw.find(\"tr\"));y=o.clone().prependTo(F);o=o.find(\"tr\");v=y.find(\"tr\");y.find(\"th, td\").removeAttr(\"tabindex\");c||(q.width=\"100%\",f[0].style.width=\"100%\");h.each(qa(a,y),function(b,c){D=Z(a,b);c.style.width=a.aoColumns[D].sWidth});u&&J(function(a){a.style.width=\"\"},w);f=F.outerWidth();if(\"\"===c){r.width=\"100%\";if(Ua&&(F.find(\"tbody\").height()>j.offsetHeight||\"scroll\"==l.css(\"overflow-y\")))r.width=x(F.outerWidth()-b);f=F.outerWidth()}else\"\"!==d&&(r.width=x(d),f=F.outerWidth());J(E,v);J(function(a){B.push(a.innerHTML);\r\nz.push(x(h(a).css(\"width\")))},v);J(function(a,b){if(h.inArray(a,s)!==-1)a.style.width=z[b]},o);h(v).height(0);u&&(J(E,w),J(function(a){C.push(a.innerHTML);A.push(x(h(a).css(\"width\")))},w),J(function(a,b){a.style.width=A[b]},P),h(w).height(0));J(function(a,b){a.innerHTML='<div class=\"dataTables_sizing\" style=\"height:0;overflow:hidden;\">'+B[b]+\"</div>\";a.style.width=z[b]},v);u&&J(function(a,b){a.innerHTML='<div class=\"dataTables_sizing\" style=\"height:0;overflow:hidden;\">'+C[b]+\"</div>\";a.style.width=\r\nA[b]},w);if(F.outerWidth()<f){P=j.scrollHeight>j.offsetHeight||\"scroll\"==l.css(\"overflow-y\")?f+b:f;if(Ua&&(j.scrollHeight>j.offsetHeight||\"scroll\"==l.css(\"overflow-y\")))r.width=x(P-b);(\"\"===c||\"\"!==d)&&L(a,1,\"Possible column misalignment\",6)}else P=\"100%\";q.width=x(P);g.width=x(P);u&&(a.nScrollFoot.style.width=x(P));!e&&Ua&&(q.height=x(p.offsetHeight+b));c=F.outerWidth();n[0].style.width=x(c);i.width=x(c);d=F.height()>j.clientHeight||\"scroll\"==l.css(\"overflow-y\");e=\"padding\"+(Eb.bScrollbarLeft?\"Left\":\r\n\"Right\");i[e]=d?b+\"px\":\"0px\";u&&(m[0].style.width=x(c),t[0].style.width=x(c),t[0].style[e]=d?b+\"px\":\"0px\");F.children(\"colgroup\").insertBefore(F.children(\"thead\"));l.scroll();if((a.bSorted||a.bFiltered)&&!a._drawHold)j.scrollTop=0}}function J(a,b,c){for(var d=0,e=0,f=b.length,g,j;e<f;){g=b[e].firstChild;for(j=c?c[e].firstChild:null;g;)1===g.nodeType&&(c?a(g,j,d):a(g,d),d++),g=g.nextSibling,j=c?j.nextSibling:null;e++}}function Fa(a){var b=a.nTable,c=a.aoColumns,d=a.oScroll,e=d.sY,f=d.sX,g=d.sXInner,\r\nj=c.length,i=la(a,\"bVisible\"),n=h(\"th\",a.nTHead),l=b.getAttribute(\"width\"),k=b.parentNode,t=!1,m,o,p=a.oBrowser,d=p.bScrollOversize;(m=b.style.width)&&-1!==m.indexOf(\"%\")&&(l=m);for(m=0;m<i.length;m++)o=c[i[m]],null!==o.sWidth&&(o.sWidth=Fb(o.sWidthOrig,k),t=!0);if(d||!t&&!f&&!e&&j==aa(a)&&j==n.length)for(m=0;m<j;m++)i=Z(a,m),null!==i&&(c[i].sWidth=x(n.eq(m).width()));else{j=h(b).clone().css(\"visibility\",\"hidden\").removeAttr(\"id\");j.find(\"tbody tr\").remove();var r=h(\"<tr/>\").appendTo(j.find(\"tbody\"));\r\nj.find(\"thead, tfoot\").remove();j.append(h(a.nTHead).clone()).append(h(a.nTFoot).clone());j.find(\"tfoot th, tfoot td\").css(\"width\",\"\");n=qa(a,j.find(\"thead\")[0]);for(m=0;m<i.length;m++)o=c[i[m]],n[m].style.width=null!==o.sWidthOrig&&\"\"!==o.sWidthOrig?x(o.sWidthOrig):\"\",o.sWidthOrig&&f&&h(n[m]).append(h(\"<div/>\").css({width:o.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(a.aoData.length)for(m=0;m<i.length;m++)t=i[m],o=c[t],h(Gb(a,t)).clone(!1).append(o.sContentPadding).appendTo(r);h(\"[name]\",\r\nj).removeAttr(\"name\");o=h(\"<div/>\").css(f||e?{position:\"absolute\",top:0,left:0,height:1,right:0,overflow:\"hidden\"}:{}).append(j).appendTo(k);f&&g?j.width(g):f?(j.css(\"width\",\"auto\"),j.removeAttr(\"width\"),j.width()<k.clientWidth&&l&&j.width(k.clientWidth)):e?j.width(k.clientWidth):l&&j.width(l);for(m=e=0;m<i.length;m++)k=h(n[m]),g=k.outerWidth()-k.width(),k=p.bBounding?Math.ceil(n[m].getBoundingClientRect().width):k.outerWidth(),e+=k,c[i[m]].sWidth=x(k-g);b.style.width=x(e);o.remove()}l&&(b.style.width=\r\nx(l));if((l||f)&&!a._reszEvt)b=function(){h(D).bind(\"resize.DT-\"+a.sInstance,Oa(function(){Y(a)}))},d?setTimeout(b,1E3):b(),a._reszEvt=!0}function Fb(a,b){if(!a)return 0;var c=h(\"<div/>\").css(\"width\",x(a)).appendTo(b||I.body),d=c[0].offsetWidth;c.remove();return d}function Gb(a,b){var c=Hb(a,b);if(0>c)return null;var d=a.aoData[c];return!d.nTr?h(\"<td/>\").html(B(a,c,b,\"display\"))[0]:d.anCells[b]}function Hb(a,b){for(var c,d=-1,e=-1,f=0,g=a.aoData.length;f<g;f++)c=B(a,f,b,\"display\")+\"\",c=c.replace($b,\r\n\"\"),c=c.replace(/&nbsp;/g,\" \"),c.length>d&&(d=c.length,e=f);return e}function x(a){return null===a?\"0px\":\"number\"==typeof a?0>a?\"0px\":a+\"px\":a.match(/\\d$/)?a+\"px\":a}function V(a){var b,c,d=[],e=a.aoColumns,f,g,j,i;b=a.aaSortingFixed;c=h.isPlainObject(b);var n=[];f=function(a){a.length&&!h.isArray(a[0])?n.push(a):h.merge(n,a)};h.isArray(b)&&f(b);c&&b.pre&&f(b.pre);f(a.aaSorting);c&&b.post&&f(b.post);for(a=0;a<n.length;a++){i=n[a][0];f=e[i].aDataSort;b=0;for(c=f.length;b<c;b++)g=f[b],j=e[g].sType||\r\n\"string\",n[a]._idx===k&&(n[a]._idx=h.inArray(n[a][1],e[g].asSorting)),d.push({src:i,col:g,dir:n[a][1],index:n[a]._idx,type:j,formatter:m.ext.type.order[j+\"-pre\"]})}return d}function mb(a){var b,c,d=[],e=m.ext.type.order,f=a.aoData,g=0,j,i=a.aiDisplayMaster,h;Ga(a);h=V(a);b=0;for(c=h.length;b<c;b++)j=h[b],j.formatter&&g++,Ib(a,j.col);if(\"ssp\"!=y(a)&&0!==h.length){b=0;for(c=i.length;b<c;b++)d[i[b]]=b;g===h.length?i.sort(function(a,b){var c,e,g,j,i=h.length,k=f[a]._aSortData,m=f[b]._aSortData;for(g=\r\n0;g<i;g++)if(j=h[g],c=k[j.col],e=m[j.col],c=c<e?-1:c>e?1:0,0!==c)return\"asc\"===j.dir?c:-c;c=d[a];e=d[b];return c<e?-1:c>e?1:0}):i.sort(function(a,b){var c,g,j,i,k=h.length,m=f[a]._aSortData,p=f[b]._aSortData;for(j=0;j<k;j++)if(i=h[j],c=m[i.col],g=p[i.col],i=e[i.type+\"-\"+i.dir]||e[\"string-\"+i.dir],c=i(c,g),0!==c)return c;c=d[a];g=d[b];return c<g?-1:c>g?1:0})}a.bSorted=!0}function Jb(a){for(var b,c,d=a.aoColumns,e=V(a),a=a.oLanguage.oAria,f=0,g=d.length;f<g;f++){c=d[f];var j=c.asSorting;b=c.sTitle.replace(/<.*?>/g,\r\n\"\");var i=c.nTh;i.removeAttribute(\"aria-sort\");c.bSortable&&(0<e.length&&e[0].col==f?(i.setAttribute(\"aria-sort\",\"asc\"==e[0].dir?\"ascending\":\"descending\"),c=j[e[0].index+1]||j[0]):c=j[0],b+=\"asc\"===c?a.sSortAscending:a.sSortDescending);i.setAttribute(\"aria-label\",b)}}function Va(a,b,c,d){var e=a.aaSorting,f=a.aoColumns[b].asSorting,g=function(a,b){var c=a._idx;c===k&&(c=h.inArray(a[1],f));return c+1<f.length?c+1:b?null:0};\"number\"===typeof e[0]&&(e=a.aaSorting=[e]);c&&a.oFeatures.bSortMulti?(c=h.inArray(b,\r\nG(e,\"0\")),-1!==c?(b=g(e[c],!0),null===b&&1===e.length&&(b=0),null===b?e.splice(c,1):(e[c][1]=f[b],e[c]._idx=b)):(e.push([b,f[0],0]),e[e.length-1]._idx=0)):e.length&&e[0][0]==b?(b=g(e[0]),e.length=1,e[0][1]=f[b],e[0]._idx=b):(e.length=0,e.push([b,f[0]]),e[0]._idx=0);T(a);\"function\"==typeof d&&d(a)}function Ma(a,b,c,d){var e=a.aoColumns[c];Wa(b,{},function(b){!1!==e.bSortable&&(a.oFeatures.bProcessing?(C(a,!0),setTimeout(function(){Va(a,c,b.shiftKey,d);\"ssp\"!==y(a)&&C(a,!1)},0)):Va(a,c,b.shiftKey,d))})}\r\nfunction va(a){var b=a.aLastSort,c=a.oClasses.sSortColumn,d=V(a),e=a.oFeatures,f,g;if(e.bSort&&e.bSortClasses){e=0;for(f=b.length;e<f;e++)g=b[e].src,h(G(a.aoData,\"anCells\",g)).removeClass(c+(2>e?e+1:3));e=0;for(f=d.length;e<f;e++)g=d[e].src,h(G(a.aoData,\"anCells\",g)).addClass(c+(2>e?e+1:3))}a.aLastSort=d}function Ib(a,b){var c=a.aoColumns[b],d=m.ext.order[c.sSortDataType],e;d&&(e=d.call(a.oInstance,a,b,$(a,b)));for(var f,g=m.ext.type.order[c.sType+\"-pre\"],j=0,i=a.aoData.length;j<i;j++)if(c=a.aoData[j],\r\nc._aSortData||(c._aSortData=[]),!c._aSortData[b]||d)f=d?e[j]:B(a,j,b,\"sort\"),c._aSortData[b]=g?g(f):f}function wa(a){if(a.oFeatures.bStateSave&&!a.bDestroying){var b={time:+new Date,start:a._iDisplayStart,length:a._iDisplayLength,order:h.extend(!0,[],a.aaSorting),search:Ab(a.oPreviousSearch),columns:h.map(a.aoColumns,function(b,d){return{visible:b.bVisible,search:Ab(a.aoPreSearchCols[d])}})};u(a,\"aoStateSaveParams\",\"stateSaveParams\",[a,b]);a.oSavedState=b;a.fnStateSaveCallback.call(a.oInstance,a,\r\nb)}}function Kb(a){var b,c,d=a.aoColumns;if(a.oFeatures.bStateSave){var e=a.fnStateLoadCallback.call(a.oInstance,a);if(e&&e.time&&(b=u(a,\"aoStateLoadParams\",\"stateLoadParams\",[a,e]),-1===h.inArray(!1,b)&&(b=a.iStateDuration,!(0<b&&e.time<+new Date-1E3*b)&&d.length===e.columns.length))){a.oLoadedState=h.extend(!0,{},e);e.start!==k&&(a._iDisplayStart=e.start,a.iInitDisplayStart=e.start);e.length!==k&&(a._iDisplayLength=e.length);e.order!==k&&(a.aaSorting=[],h.each(e.order,function(b,c){a.aaSorting.push(c[0]>=\r\nd.length?[0,c[1]]:c)}));e.search!==k&&h.extend(a.oPreviousSearch,Bb(e.search));b=0;for(c=e.columns.length;b<c;b++){var f=e.columns[b];f.visible!==k&&(d[b].bVisible=f.visible);f.search!==k&&h.extend(a.aoPreSearchCols[b],Bb(f.search))}u(a,\"aoStateLoaded\",\"stateLoaded\",[a,e])}}}function xa(a){var b=m.settings,a=h.inArray(a,G(b,\"nTable\"));return-1!==a?b[a]:null}function L(a,b,c,d){c=\"DataTables warning: \"+(a?\"table id=\"+a.sTableId+\" - \":\"\")+c;d&&(c+=\". For more information about this error, please see http://datatables.net/tn/\"+\r\nd);if(b)D.console&&console.log&&console.log(c);else if(b=m.ext,b=b.sErrMode||b.errMode,a&&u(a,null,\"error\",[a,d,c]),\"alert\"==b)alert(c);else{if(\"throw\"==b)throw Error(c);\"function\"==typeof b&&b(a,d,c)}}function E(a,b,c,d){h.isArray(c)?h.each(c,function(c,d){h.isArray(d)?E(a,b,d[0],d[1]):E(a,b,d)}):(d===k&&(d=c),b[c]!==k&&(a[d]=b[c]))}function Lb(a,b,c){var d,e;for(e in b)b.hasOwnProperty(e)&&(d=b[e],h.isPlainObject(d)?(h.isPlainObject(a[e])||(a[e]={}),h.extend(!0,a[e],d)):a[e]=c&&\"data\"!==e&&\"aaData\"!==\r\ne&&h.isArray(d)?d.slice():d);return a}function Wa(a,b,c){h(a).bind(\"click.DT\",b,function(b){a.blur();c(b)}).bind(\"keypress.DT\",b,function(a){13===a.which&&(a.preventDefault(),c(a))}).bind(\"selectstart.DT\",function(){return!1})}function z(a,b,c,d){c&&a[b].push({fn:c,sName:d})}function u(a,b,c,d){var e=[];b&&(e=h.map(a[b].slice().reverse(),function(b){return b.fn.apply(a.oInstance,d)}));null!==c&&(b=h.Event(c+\".dt\"),h(a.nTable).trigger(b,d),e.push(b.result));return e}function Sa(a){var b=a._iDisplayStart,\r\nc=a.fnDisplayEnd(),d=a._iDisplayLength;b>=c&&(b=c-d);b-=b%d;if(-1===d||0>b)b=0;a._iDisplayStart=b}function Na(a,b){var c=a.renderer,d=m.ext.renderer[b];return h.isPlainObject(c)&&c[b]?d[c[b]]||d._:\"string\"===typeof c?d[c]||d._:d._}function y(a){return a.oFeatures.bServerSide?\"ssp\":a.ajax||a.sAjaxSource?\"ajax\":\"dom\"}function ya(a,b){var c=[],c=Mb.numbers_length,d=Math.floor(c/2);b<=c?c=W(0,b):a<=d?(c=W(0,c-2),c.push(\"ellipsis\"),c.push(b-1)):(a>=b-1-d?c=W(b-(c-2),b):(c=W(a-d+2,a+d-1),c.push(\"ellipsis\"),\r\nc.push(b-1)),c.splice(0,0,\"ellipsis\"),c.splice(0,0,0));c.DT_el=\"span\";return c}function db(a){h.each({num:function(b){return za(b,a)},\"num-fmt\":function(b){return za(b,a,Xa)},\"html-num\":function(b){return za(b,a,Aa)},\"html-num-fmt\":function(b){return za(b,a,Aa,Xa)}},function(b,c){v.type.order[b+a+\"-pre\"]=c;b.match(/^html\\-/)&&(v.type.search[b+a]=v.type.search.html)})}function Nb(a){return function(){var b=[xa(this[m.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return m.ext.internal[a].apply(this,\r\nb)}}var m=function(a){this.$=function(a,b){return this.api(!0).$(a,b)};this._=function(a,b){return this.api(!0).rows(a,b).data()};this.api=function(a){return a?new r(xa(this[v.iApiIndex])):new r(this)};this.fnAddData=function(a,b){var c=this.api(!0),d=h.isArray(a)&&(h.isArray(a[0])||h.isPlainObject(a[0]))?c.rows.add(a):c.row.add(a);(b===k||b)&&c.draw();return d.flatten().toArray()};this.fnAdjustColumnSizing=function(a){var b=this.api(!0).columns.adjust(),c=b.settings()[0],d=c.oScroll;a===k||a?b.draw(!1):\r\n(\"\"!==d.sX||\"\"!==d.sY)&&ka(c)};this.fnClearTable=function(a){var b=this.api(!0).clear();(a===k||a)&&b.draw()};this.fnClose=function(a){this.api(!0).row(a).child.hide()};this.fnDeleteRow=function(a,b,c){var d=this.api(!0),a=d.rows(a),e=a.settings()[0],h=e.aoData[a[0][0]];a.remove();b&&b.call(this,e,h);(c===k||c)&&d.draw();return h};this.fnDestroy=function(a){this.api(!0).destroy(a)};this.fnDraw=function(a){this.api(!0).draw(a)};this.fnFilter=function(a,b,c,d,e,h){e=this.api(!0);null===b||b===k?e.search(a,\r\nc,d,h):e.column(b).search(a,c,d,h);e.draw()};this.fnGetData=function(a,b){var c=this.api(!0);if(a!==k){var d=a.nodeName?a.nodeName.toLowerCase():\"\";return b!==k||\"td\"==d||\"th\"==d?c.cell(a,b).data():c.row(a).data()||null}return c.data().toArray()};this.fnGetNodes=function(a){var b=this.api(!0);return a!==k?b.row(a).node():b.rows().nodes().flatten().toArray()};this.fnGetPosition=function(a){var b=this.api(!0),c=a.nodeName.toUpperCase();return\"TR\"==c?b.row(a).index():\"TD\"==c||\"TH\"==c?(a=b.cell(a).index(),\r\n[a.row,a.columnVisible,a.column]):null};this.fnIsOpen=function(a){return this.api(!0).row(a).child.isShown()};this.fnOpen=function(a,b,c){return this.api(!0).row(a).child(b,c).show().child()[0]};this.fnPageChange=function(a,b){var c=this.api(!0).page(a);(b===k||b)&&c.draw(!1)};this.fnSetColumnVis=function(a,b,c){a=this.api(!0).column(a).visible(b);(c===k||c)&&a.columns.adjust().draw()};this.fnSettings=function(){return xa(this[v.iApiIndex])};this.fnSort=function(a){this.api(!0).order(a).draw()};this.fnSortListener=\r\nfunction(a,b,c){this.api(!0).order.listener(a,b,c)};this.fnUpdate=function(a,b,c,d,e){var h=this.api(!0);c===k||null===c?h.row(b).data(a):h.cell(b,c).data(a);(e===k||e)&&h.columns.adjust();(d===k||d)&&h.draw();return 0};this.fnVersionCheck=v.fnVersionCheck;var b=this,c=a===k,d=this.length;c&&(a={});this.oApi=this.internal=v.internal;for(var e in m.ext.internal)e&&(this[e]=Nb(e));this.each(function(){var e={},e=1<d?Lb(e,a,!0):a,g=0,j,i=this.getAttribute(\"id\"),n=!1,l=m.defaults,q=h(this);if(\"table\"!=\r\nthis.nodeName.toLowerCase())L(null,0,\"Non-table node initialisation (\"+this.nodeName+\")\",2);else{eb(l);fb(l.column);K(l,l,!0);K(l.column,l.column,!0);K(l,h.extend(e,q.data()));var t=m.settings,g=0;for(j=t.length;g<j;g++){var p=t[g];if(p.nTable==this||p.nTHead.parentNode==this||p.nTFoot&&p.nTFoot.parentNode==this){g=e.bRetrieve!==k?e.bRetrieve:l.bRetrieve;if(c||g)return p.oInstance;if(e.bDestroy!==k?e.bDestroy:l.bDestroy){p.oInstance.fnDestroy();break}else{L(p,0,\"Cannot reinitialise DataTable\",3);\r\nreturn}}if(p.sTableId==this.id){t.splice(g,1);break}}if(null===i||\"\"===i)this.id=i=\"DataTables_Table_\"+m.ext._unique++;var o=h.extend(!0,{},m.models.oSettings,{sDestroyWidth:q[0].style.width,sInstance:i,sTableId:i});o.nTable=this;o.oApi=b.internal;o.oInit=e;t.push(o);o.oInstance=1===b.length?b:q.dataTable();eb(e);e.oLanguage&&Da(e.oLanguage);e.aLengthMenu&&!e.iDisplayLength&&(e.iDisplayLength=h.isArray(e.aLengthMenu[0])?e.aLengthMenu[0][0]:e.aLengthMenu[0]);e=Lb(h.extend(!0,{},l),e);E(o.oFeatures,\r\ne,\"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender\".split(\" \"));E(o,e,[\"asStripeClasses\",\"ajax\",\"fnServerData\",\"fnFormatNumber\",\"sServerMethod\",\"aaSorting\",\"aaSortingFixed\",\"aLengthMenu\",\"sPaginationType\",\"sAjaxSource\",\"sAjaxDataProp\",\"iStateDuration\",\"sDom\",\"bSortCellsTop\",\"iTabIndex\",\"fnStateLoadCallback\",\"fnStateSaveCallback\",\"renderer\",\"searchDelay\",\"rowId\",[\"iCookieDuration\",\"iStateDuration\"],[\"oSearch\",\"oPreviousSearch\"],[\"aoSearchCols\",\r\n\"aoPreSearchCols\"],[\"iDisplayLength\",\"_iDisplayLength\"],[\"bJQueryUI\",\"bJUI\"]]);E(o.oScroll,e,[[\"sScrollX\",\"sX\"],[\"sScrollXInner\",\"sXInner\"],[\"sScrollY\",\"sY\"],[\"bScrollCollapse\",\"bCollapse\"]]);E(o.oLanguage,e,\"fnInfoCallback\");z(o,\"aoDrawCallback\",e.fnDrawCallback,\"user\");z(o,\"aoServerParams\",e.fnServerParams,\"user\");z(o,\"aoStateSaveParams\",e.fnStateSaveParams,\"user\");z(o,\"aoStateLoadParams\",e.fnStateLoadParams,\"user\");z(o,\"aoStateLoaded\",e.fnStateLoaded,\"user\");z(o,\"aoRowCallback\",e.fnRowCallback,\r\n\"user\");z(o,\"aoRowCreatedCallback\",e.fnCreatedRow,\"user\");z(o,\"aoHeaderCallback\",e.fnHeaderCallback,\"user\");z(o,\"aoFooterCallback\",e.fnFooterCallback,\"user\");z(o,\"aoInitComplete\",e.fnInitComplete,\"user\");z(o,\"aoPreDrawCallback\",e.fnPreDrawCallback,\"user\");o.rowIdFn=Q(e.rowId);gb(o);i=o.oClasses;e.bJQueryUI?(h.extend(i,m.ext.oJUIClasses,e.oClasses),e.sDom===l.sDom&&\"lfrtip\"===l.sDom&&(o.sDom='<\"H\"lfr>t<\"F\"ip>'),o.renderer)?h.isPlainObject(o.renderer)&&!o.renderer.header&&(o.renderer.header=\"jqueryui\"):\r\no.renderer=\"jqueryui\":h.extend(i,m.ext.classes,e.oClasses);q.addClass(i.sTable);o.iInitDisplayStart===k&&(o.iInitDisplayStart=e.iDisplayStart,o._iDisplayStart=e.iDisplayStart);null!==e.iDeferLoading&&(o.bDeferLoading=!0,g=h.isArray(e.iDeferLoading),o._iRecordsDisplay=g?e.iDeferLoading[0]:e.iDeferLoading,o._iRecordsTotal=g?e.iDeferLoading[1]:e.iDeferLoading);var r=o.oLanguage;h.extend(!0,r,e.oLanguage);\"\"!==r.sUrl&&(h.ajax({dataType:\"json\",url:r.sUrl,success:function(a){Da(a);K(l.oLanguage,a);h.extend(true,\r\nr,a);ga(o)},error:function(){ga(o)}}),n=!0);null===e.asStripeClasses&&(o.asStripeClasses=[i.sStripeOdd,i.sStripeEven]);var g=o.asStripeClasses,v=q.children(\"tbody\").find(\"tr\").eq(0);-1!==h.inArray(!0,h.map(g,function(a){return v.hasClass(a)}))&&(h(\"tbody tr\",this).removeClass(g.join(\" \")),o.asDestroyStripes=g.slice());t=[];g=this.getElementsByTagName(\"thead\");0!==g.length&&(da(o.aoHeader,g[0]),t=qa(o));if(null===e.aoColumns){p=[];g=0;for(j=t.length;g<j;g++)p.push(null)}else p=e.aoColumns;g=0;for(j=\r\np.length;g<j;g++)Ea(o,t?t[g]:null);ib(o,e.aoColumnDefs,p,function(a,b){ja(o,a,b)});if(v.length){var s=function(a,b){return a.getAttribute(\"data-\"+b)!==null?b:null};h(v[0]).children(\"th, td\").each(function(a,b){var c=o.aoColumns[a];if(c.mData===a){var d=s(b,\"sort\")||s(b,\"order\"),e=s(b,\"filter\")||s(b,\"search\");if(d!==null||e!==null){c.mData={_:a+\".display\",sort:d!==null?a+\".@data-\"+d:k,type:d!==null?a+\".@data-\"+d:k,filter:e!==null?a+\".@data-\"+e:k};ja(o,a)}}})}var w=o.oFeatures;e.bStateSave&&(w.bStateSave=\r\n!0,Kb(o,e),z(o,\"aoDrawCallback\",wa,\"state_save\"));if(e.aaSorting===k){t=o.aaSorting;g=0;for(j=t.length;g<j;g++)t[g][1]=o.aoColumns[g].asSorting[0]}va(o);w.bSort&&z(o,\"aoDrawCallback\",function(){if(o.bSorted){var a=V(o),b={};h.each(a,function(a,c){b[c.src]=c.dir});u(o,null,\"order\",[o,a,b]);Jb(o)}});z(o,\"aoDrawCallback\",function(){(o.bSorted||y(o)===\"ssp\"||w.bDeferRender)&&va(o)},\"sc\");g=q.children(\"caption\").each(function(){this._captionSide=q.css(\"caption-side\")});j=q.children(\"thead\");0===j.length&&\r\n(j=h(\"<thead/>\").appendTo(this));o.nTHead=j[0];j=q.children(\"tbody\");0===j.length&&(j=h(\"<tbody/>\").appendTo(this));o.nTBody=j[0];j=q.children(\"tfoot\");if(0===j.length&&0<g.length&&(\"\"!==o.oScroll.sX||\"\"!==o.oScroll.sY))j=h(\"<tfoot/>\").appendTo(this);0===j.length||0===j.children().length?q.addClass(i.sNoFooter):0<j.length&&(o.nTFoot=j[0],da(o.aoFooter,o.nTFoot));if(e.aaData)for(g=0;g<e.aaData.length;g++)N(o,e.aaData[g]);else(o.bDeferLoading||\"dom\"==y(o))&&ma(o,h(o.nTBody).children(\"tr\"));o.aiDisplay=\r\no.aiDisplayMaster.slice();o.bInitialised=!0;!1===n&&ga(o)}});b=null;return this},v,r,p,s,Ya={},Ob=/[\\r\\n]/g,Aa=/<.*?>/g,ac=/^[\\w\\+\\-]/,bc=/[\\w\\+\\-]$/,cc=RegExp(\"(\\\\/|\\\\.|\\\\*|\\\\+|\\\\?|\\\\||\\\\(|\\\\)|\\\\[|\\\\]|\\\\{|\\\\}|\\\\\\\\|\\\\$|\\\\^|\\\\-)\",\"g\"),Xa=/[',$£€¥%\\u2009\\u202F\\u20BD\\u20a9\\u20BArfk]/gi,M=function(a){return!a||!0===a||\"-\"===a?!0:!1},Pb=function(a){var b=parseInt(a,10);return!isNaN(b)&&isFinite(a)?b:null},Qb=function(a,b){Ya[b]||(Ya[b]=RegExp(Qa(b),\"g\"));return\"string\"===typeof a&&\".\"!==b?a.replace(/\\./g,\r\n\"\").replace(Ya[b],\".\"):a},Za=function(a,b,c){var d=\"string\"===typeof a;if(M(a))return!0;b&&d&&(a=Qb(a,b));c&&d&&(a=a.replace(Xa,\"\"));return!isNaN(parseFloat(a))&&isFinite(a)},Rb=function(a,b,c){return M(a)?!0:!(M(a)||\"string\"===typeof a)?null:Za(a.replace(Aa,\"\"),b,c)?!0:null},G=function(a,b,c){var d=[],e=0,f=a.length;if(c!==k)for(;e<f;e++)a[e]&&a[e][b]&&d.push(a[e][b][c]);else for(;e<f;e++)a[e]&&d.push(a[e][b]);return d},ha=function(a,b,c,d){var e=[],f=0,g=b.length;if(d!==k)for(;f<g;f++)a[b[f]][c]&&\r\ne.push(a[b[f]][c][d]);else for(;f<g;f++)e.push(a[b[f]][c]);return e},W=function(a,b){var c=[],d;b===k?(b=0,d=a):(d=b,b=a);for(var e=b;e<d;e++)c.push(e);return c},Sb=function(a){for(var b=[],c=0,d=a.length;c<d;c++)a[c]&&b.push(a[c]);return b},pa=function(a){var b=[],c,d,e=a.length,f,g=0;d=0;a:for(;d<e;d++){c=a[d];for(f=0;f<g;f++)if(b[f]===c)continue a;b.push(c);g++}return b};m.util={throttle:function(a,b){var c=b!==k?b:200,d,e;return function(){var b=this,g=+new Date,h=arguments;d&&g<d+c?(clearTimeout(e),\r\ne=setTimeout(function(){d=k;a.apply(b,h)},c)):(d=g,a.apply(b,h))}},escapeRegex:function(a){return a.replace(cc,\"\\\\$1\")}};var A=function(a,b,c){a[b]!==k&&(a[c]=a[b])},ba=/\\[.*?\\]$/,U=/\\(\\)$/,Qa=m.util.escapeRegex,ua=h(\"<div>\")[0],Zb=ua.textContent!==k,$b=/<.*?>/g,Oa=m.util.throttle,Tb=[],w=Array.prototype,dc=function(a){var b,c,d=m.settings,e=h.map(d,function(a){return a.nTable});if(a){if(a.nTable&&a.oApi)return[a];if(a.nodeName&&\"table\"===a.nodeName.toLowerCase())return b=h.inArray(a,e),-1!==b?[d[b]]:\r\nnull;if(a&&\"function\"===typeof a.settings)return a.settings().toArray();\"string\"===typeof a?c=h(a):a instanceof h&&(c=a)}else return[];if(c)return c.map(function(){b=h.inArray(this,e);return-1!==b?d[b]:null}).toArray()};r=function(a,b){if(!(this instanceof r))return new r(a,b);var c=[],d=function(a){(a=dc(a))&&(c=c.concat(a))};if(h.isArray(a))for(var e=0,f=a.length;e<f;e++)d(a[e]);else d(a);this.context=pa(c);b&&h.merge(this,b);this.selector={rows:null,cols:null,opts:null};r.extend(this,this,Tb)};\r\nm.Api=r;h.extend(r.prototype,{any:function(){return 0!==this.count()},concat:w.concat,context:[],count:function(){return this.flatten().length},each:function(a){for(var b=0,c=this.length;b<c;b++)a.call(this,this[b],b,this);return this},eq:function(a){var b=this.context;return b.length>a?new r(b[a],this[a]):null},filter:function(a){var b=[];if(w.filter)b=w.filter.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)a.call(this,this[c],c,this)&&b.push(this[c]);return new r(this.context,b)},flatten:function(){var a=\r\n[];return new r(this.context,a.concat.apply(a,this.toArray()))},join:w.join,indexOf:w.indexOf||function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1},iterator:function(a,b,c,d){var e=[],f,g,h,i,n,l=this.context,m,t,p=this.selector;\"string\"===typeof a&&(d=c,c=b,b=a,a=!1);g=0;for(h=l.length;g<h;g++){var o=new r(l[g]);if(\"table\"===b)f=c.call(o,l[g],g),f!==k&&e.push(f);else if(\"columns\"===b||\"rows\"===b)f=c.call(o,l[g],this[g],g),f!==k&&e.push(f);else if(\"column\"===b||\"column-rows\"===\r\nb||\"row\"===b||\"cell\"===b){t=this[g];\"column-rows\"===b&&(m=Ba(l[g],p.opts));i=0;for(n=t.length;i<n;i++)f=t[i],f=\"cell\"===b?c.call(o,l[g],f.row,f.column,g,i):c.call(o,l[g],f,g,i,m),f!==k&&e.push(f)}}return e.length||d?(a=new r(l,a?e.concat.apply([],e):e),b=a.selector,b.rows=p.rows,b.cols=p.cols,b.opts=p.opts,a):this},lastIndexOf:w.lastIndexOf||function(a,b){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(a){var b=[];if(w.map)b=w.map.call(this,a,this);else for(var c=\r\n0,d=this.length;c<d;c++)b.push(a.call(this,this[c],c));return new r(this.context,b)},pluck:function(a){return this.map(function(b){return b[a]})},pop:w.pop,push:w.push,reduce:w.reduce||function(a,b){return hb(this,a,b,0,this.length,1)},reduceRight:w.reduceRight||function(a,b){return hb(this,a,b,this.length-1,-1,-1)},reverse:w.reverse,selector:null,shift:w.shift,sort:w.sort,splice:w.splice,toArray:function(){return w.slice.call(this)},to$:function(){return h(this)},toJQuery:function(){return h(this)},\r\nunique:function(){return new r(this.context,pa(this))},unshift:w.unshift});r.extend=function(a,b,c){if(c.length&&b&&(b instanceof r||b.__dt_wrapper)){var d,e,f,g=function(a,b,c){return function(){var d=b.apply(a,arguments);r.extend(d,d,c.methodExt);return d}};d=0;for(e=c.length;d<e;d++)f=c[d],b[f.name]=\"function\"===typeof f.val?g(a,f.val,f):h.isPlainObject(f.val)?{}:f.val,b[f.name].__dt_wrapper=!0,r.extend(a,b[f.name],f.propExt)}};r.register=p=function(a,b){if(h.isArray(a))for(var c=0,d=a.length;c<\r\nd;c++)r.register(a[c],b);else for(var e=a.split(\".\"),f=Tb,g,j,c=0,d=e.length;c<d;c++){g=(j=-1!==e[c].indexOf(\"()\"))?e[c].replace(\"()\",\"\"):e[c];var i;a:{i=0;for(var n=f.length;i<n;i++)if(f[i].name===g){i=f[i];break a}i=null}i||(i={name:g,val:{},methodExt:[],propExt:[]},f.push(i));c===d-1?i.val=b:f=j?i.methodExt:i.propExt}};r.registerPlural=s=function(a,b,c){r.register(a,c);r.register(b,function(){var a=c.apply(this,arguments);return a===this?this:a instanceof r?a.length?h.isArray(a[0])?new r(a.context,\r\na[0]):a[0]:k:a})};p(\"tables()\",function(a){var b;if(a){b=r;var c=this.context;if(\"number\"===typeof a)a=[c[a]];else var d=h.map(c,function(a){return a.nTable}),a=h(d).filter(a).map(function(){var a=h.inArray(this,d);return c[a]}).toArray();b=new b(a)}else b=this;return b});p(\"table()\",function(a){var a=this.tables(a),b=a.context;return b.length?new r(b[0]):a});s(\"tables().nodes()\",\"table().node()\",function(){return this.iterator(\"table\",function(a){return a.nTable},1)});s(\"tables().body()\",\"table().body()\",\r\nfunction(){return this.iterator(\"table\",function(a){return a.nTBody},1)});s(\"tables().header()\",\"table().header()\",function(){return this.iterator(\"table\",function(a){return a.nTHead},1)});s(\"tables().footer()\",\"table().footer()\",function(){return this.iterator(\"table\",function(a){return a.nTFoot},1)});s(\"tables().containers()\",\"table().container()\",function(){return this.iterator(\"table\",function(a){return a.nTableWrapper},1)});p(\"draw()\",function(a){return this.iterator(\"table\",function(b){\"page\"===\r\na?O(b):(\"string\"===typeof a&&(a=\"full-hold\"===a?!1:!0),T(b,!1===a))})});p(\"page()\",function(a){return a===k?this.page.info().page:this.iterator(\"table\",function(b){Ta(b,a)})});p(\"page.info()\",function(){if(0===this.context.length)return k;var a=this.context[0],b=a._iDisplayStart,c=a.oFeatures.bPaginate?a._iDisplayLength:-1,d=a.fnRecordsDisplay(),e=-1===c;return{page:e?0:Math.floor(b/c),pages:e?1:Math.ceil(d/c),start:b,end:a.fnDisplayEnd(),length:c,recordsTotal:a.fnRecordsTotal(),recordsDisplay:d,\r\nserverSide:\"ssp\"===y(a)}});p(\"page.len()\",function(a){return a===k?0!==this.context.length?this.context[0]._iDisplayLength:k:this.iterator(\"table\",function(b){Ra(b,a)})});var Ub=function(a,b,c){if(c){var d=new r(a);d.one(\"draw\",function(){c(d.ajax.json())})}if(\"ssp\"==y(a))T(a,b);else{C(a,!0);var e=a.jqXHR;e&&4!==e.readyState&&e.abort();ra(a,[],function(c){na(a);for(var c=sa(a,c),d=0,e=c.length;d<e;d++)N(a,c[d]);T(a,b);C(a,!1)})}};p(\"ajax.json()\",function(){var a=this.context;if(0<a.length)return a[0].json});\r\np(\"ajax.params()\",function(){var a=this.context;if(0<a.length)return a[0].oAjaxData});p(\"ajax.reload()\",function(a,b){return this.iterator(\"table\",function(c){Ub(c,!1===b,a)})});p(\"ajax.url()\",function(a){var b=this.context;if(a===k){if(0===b.length)return k;b=b[0];return b.ajax?h.isPlainObject(b.ajax)?b.ajax.url:b.ajax:b.sAjaxSource}return this.iterator(\"table\",function(b){h.isPlainObject(b.ajax)?b.ajax.url=a:b.ajax=a})});p(\"ajax.url().load()\",function(a,b){return this.iterator(\"table\",function(c){Ub(c,\r\n!1===b,a)})});var $a=function(a,b,c,d,e){var f=[],g,j,i,n,l,m;i=typeof b;if(!b||\"string\"===i||\"function\"===i||b.length===k)b=[b];i=0;for(n=b.length;i<n;i++){j=b[i]&&b[i].split?b[i].split(\",\"):[b[i]];l=0;for(m=j.length;l<m;l++)(g=c(\"string\"===typeof j[l]?h.trim(j[l]):j[l]))&&g.length&&(f=f.concat(g))}a=v.selector[a];if(a.length){i=0;for(n=a.length;i<n;i++)f=a[i](d,e,f)}return pa(f)},ab=function(a){a||(a={});a.filter&&a.search===k&&(a.search=a.filter);return h.extend({search:\"none\",order:\"current\",\r\npage:\"all\"},a)},bb=function(a){for(var b=0,c=a.length;b<c;b++)if(0<a[b].length)return a[0]=a[b],a[0].length=1,a.length=1,a.context=[a.context[b]],a;a.length=0;return a},Ba=function(a,b){var c,d,e,f=[],g=a.aiDisplay;c=a.aiDisplayMaster;var j=b.search;d=b.order;e=b.page;if(\"ssp\"==y(a))return\"removed\"===j?[]:W(0,c.length);if(\"current\"==e){c=a._iDisplayStart;for(d=a.fnDisplayEnd();c<d;c++)f.push(g[c])}else if(\"current\"==d||\"applied\"==d)f=\"none\"==j?c.slice():\"applied\"==j?g.slice():h.map(c,function(a){return-1===\r\nh.inArray(a,g)?a:null});else if(\"index\"==d||\"original\"==d){c=0;for(d=a.aoData.length;c<d;c++)\"none\"==j?f.push(c):(e=h.inArray(c,g),(-1===e&&\"removed\"==j||0<=e&&\"applied\"==j)&&f.push(c))}return f};p(\"rows()\",function(a,b){a===k?a=\"\":h.isPlainObject(a)&&(b=a,a=\"\");var b=ab(b),c=this.iterator(\"table\",function(c){var e=b;return $a(\"row\",a,function(a){var b=Pb(a);if(b!==null&&!e)return[b];var j=Ba(c,e);if(b!==null&&h.inArray(b,j)!==-1)return[b];if(!a)return j;if(typeof a===\"function\")return h.map(j,function(b){var e=\r\nc.aoData[b];return a(b,e._aData,e.nTr)?b:null});b=Sb(ha(c.aoData,j,\"nTr\"));if(a.nodeName){if(a._DT_RowIndex!==k)return[a._DT_RowIndex];if(a._DT_CellIndex)return[a._DT_CellIndex.row];b=h(a).closest(\"*[data-dt-row]\");return b.length?[b.data(\"dt-row\")]:[]}if(typeof a===\"string\"&&a.charAt(0)===\"#\"){j=c.aIds[a.replace(/^#/,\"\")];if(j!==k)return[j.idx]}return h(b).filter(a).map(function(){return this._DT_RowIndex}).toArray()},c,e)},1);c.selector.rows=a;c.selector.opts=b;return c});p(\"rows().nodes()\",function(){return this.iterator(\"row\",\r\nfunction(a,b){return a.aoData[b].nTr||k},1)});p(\"rows().data()\",function(){return this.iterator(!0,\"rows\",function(a,b){return ha(a.aoData,b,\"_aData\")},1)});s(\"rows().cache()\",\"row().cache()\",function(a){return this.iterator(\"row\",function(b,c){var d=b.aoData[c];return\"search\"===a?d._aFilterData:d._aSortData},1)});s(\"rows().invalidate()\",\"row().invalidate()\",function(a){return this.iterator(\"row\",function(b,c){ca(b,c,a)})});s(\"rows().indexes()\",\"row().index()\",function(){return this.iterator(\"row\",\r\nfunction(a,b){return b},1)});s(\"rows().ids()\",\"row().id()\",function(a){for(var b=[],c=this.context,d=0,e=c.length;d<e;d++)for(var f=0,g=this[d].length;f<g;f++){var h=c[d].rowIdFn(c[d].aoData[this[d][f]]._aData);b.push((!0===a?\"#\":\"\")+h)}return new r(c,b)});s(\"rows().remove()\",\"row().remove()\",function(){var a=this;this.iterator(\"row\",function(b,c,d){var e=b.aoData,f=e[c],g,h,i,n,l;e.splice(c,1);g=0;for(h=e.length;g<h;g++)if(i=e[g],l=i.anCells,null!==i.nTr&&(i.nTr._DT_RowIndex=g),null!==l){i=0;for(n=\r\nl.length;i<n;i++)l[i]._DT_CellIndex.row=g}oa(b.aiDisplayMaster,c);oa(b.aiDisplay,c);oa(a[d],c,!1);Sa(b);c=b.rowIdFn(f._aData);c!==k&&delete b.aIds[c]});this.iterator(\"table\",function(a){for(var c=0,d=a.aoData.length;c<d;c++)a.aoData[c].idx=c});return this});p(\"rows.add()\",function(a){var b=this.iterator(\"table\",function(b){var c,f,g,h=[];f=0;for(g=a.length;f<g;f++)c=a[f],c.nodeName&&\"TR\"===c.nodeName.toUpperCase()?h.push(ma(b,c)[0]):h.push(N(b,c));return h},1),c=this.rows(-1);c.pop();h.merge(c,b);\r\nreturn c});p(\"row()\",function(a,b){return bb(this.rows(a,b))});p(\"row().data()\",function(a){var b=this.context;if(a===k)return b.length&&this.length?b[0].aoData[this[0]]._aData:k;b[0].aoData[this[0]]._aData=a;ca(b[0],this[0],\"data\");return this});p(\"row().node()\",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]].nTr||null:null});p(\"row.add()\",function(a){a instanceof h&&a.length&&(a=a[0]);var b=this.iterator(\"table\",function(b){return a.nodeName&&\"TR\"===a.nodeName.toUpperCase()?\r\nma(b,a)[0]:N(b,a)});return this.row(b[0])});var cb=function(a,b){var c=a.context;if(c.length&&(c=c[0].aoData[b!==k?b:a[0]])&&c._details)c._details.remove(),c._detailsShow=k,c._details=k},Vb=function(a,b){var c=a.context;if(c.length&&a.length){var d=c[0].aoData[a[0]];if(d._details){(d._detailsShow=b)?d._details.insertAfter(d.nTr):d._details.detach();var e=c[0],f=new r(e),g=e.aoData;f.off(\"draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details\");0<G(g,\"_details\").length&&(f.on(\"draw.dt.DT_details\",\r\nfunction(a,b){e===b&&f.rows({page:\"current\"}).eq(0).each(function(a){a=g[a];a._detailsShow&&a._details.insertAfter(a.nTr)})}),f.on(\"column-visibility.dt.DT_details\",function(a,b){if(e===b)for(var c,d=aa(b),f=0,h=g.length;f<h;f++)c=g[f],c._details&&c._details.children(\"td[colspan]\").attr(\"colspan\",d)}),f.on(\"destroy.dt.DT_details\",function(a,b){if(e===b)for(var c=0,d=g.length;c<d;c++)g[c]._details&&cb(f,c)}))}}};p(\"row().child()\",function(a,b){var c=this.context;if(a===k)return c.length&&this.length?\r\nc[0].aoData[this[0]]._details:k;if(!0===a)this.child.show();else if(!1===a)cb(this);else if(c.length&&this.length){var d=c[0],c=c[0].aoData[this[0]],e=[],f=function(a,b){if(h.isArray(a)||a instanceof h)for(var c=0,k=a.length;c<k;c++)f(a[c],b);else a.nodeName&&\"tr\"===a.nodeName.toLowerCase()?e.push(a):(c=h(\"<tr><td/></tr>\").addClass(b),h(\"td\",c).addClass(b).html(a)[0].colSpan=aa(d),e.push(c[0]))};f(a,b);c._details&&c._details.remove();c._details=h(e);c._detailsShow&&c._details.insertAfter(c.nTr)}return this});\r\np([\"row().child.show()\",\"row().child().show()\"],function(){Vb(this,!0);return this});p([\"row().child.hide()\",\"row().child().hide()\"],function(){Vb(this,!1);return this});p([\"row().child.remove()\",\"row().child().remove()\"],function(){cb(this);return this});p(\"row().child.isShown()\",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]]._detailsShow||!1:!1});var ec=/^(.+):(name|visIdx|visible)$/,Wb=function(a,b,c,d,e){for(var c=[],d=0,f=e.length;d<f;d++)c.push(B(a,e[d],b));\r\nreturn c};p(\"columns()\",function(a,b){a===k?a=\"\":h.isPlainObject(a)&&(b=a,a=\"\");var b=ab(b),c=this.iterator(\"table\",function(c){var e=a,f=b,g=c.aoColumns,j=G(g,\"sName\"),i=G(g,\"nTh\");return $a(\"column\",e,function(a){var b=Pb(a);if(a===\"\")return W(g.length);if(b!==null)return[b>=0?b:g.length+b];if(typeof a===\"function\"){var e=Ba(c,f);return h.map(g,function(b,f){return a(f,Wb(c,f,0,0,e),i[f])?f:null})}var k=typeof a===\"string\"?a.match(ec):\"\";if(k)switch(k[2]){case \"visIdx\":case \"visible\":b=parseInt(k[1],\r\n10);if(b<0){var m=h.map(g,function(a,b){return a.bVisible?b:null});return[m[m.length+b]]}return[Z(c,b)];case \"name\":return h.map(j,function(a,b){return a===k[1]?b:null});default:return[]}if(a.nodeName&&a._DT_CellIndex)return[a._DT_CellIndex.column];b=h(i).filter(a).map(function(){return h.inArray(this,i)}).toArray();if(b.length||!a.nodeName)return b;b=h(a).closest(\"*[data-dt-column]\");return b.length?[b.data(\"dt-column\")]:[]},c,f)},1);c.selector.cols=a;c.selector.opts=b;return c});s(\"columns().header()\",\r\n\"column().header()\",function(){return this.iterator(\"column\",function(a,b){return a.aoColumns[b].nTh},1)});s(\"columns().footer()\",\"column().footer()\",function(){return this.iterator(\"column\",function(a,b){return a.aoColumns[b].nTf},1)});s(\"columns().data()\",\"column().data()\",function(){return this.iterator(\"column-rows\",Wb,1)});s(\"columns().dataSrc()\",\"column().dataSrc()\",function(){return this.iterator(\"column\",function(a,b){return a.aoColumns[b].mData},1)});s(\"columns().cache()\",\"column().cache()\",\r\nfunction(a){return this.iterator(\"column-rows\",function(b,c,d,e,f){return ha(b.aoData,f,\"search\"===a?\"_aFilterData\":\"_aSortData\",c)},1)});s(\"columns().nodes()\",\"column().nodes()\",function(){return this.iterator(\"column-rows\",function(a,b,c,d,e){return ha(a.aoData,e,\"anCells\",b)},1)});s(\"columns().visible()\",\"column().visible()\",function(a,b){var c=this.iterator(\"column\",function(b,c){if(a===k)return b.aoColumns[c].bVisible;var f=b.aoColumns,g=f[c],j=b.aoData,i,n,l;if(a!==k&&g.bVisible!==a){if(a){var m=\r\nh.inArray(!0,G(f,\"bVisible\"),c+1);i=0;for(n=j.length;i<n;i++)l=j[i].nTr,f=j[i].anCells,l&&l.insertBefore(f[c],f[m]||null)}else h(G(b.aoData,\"anCells\",c)).detach();g.bVisible=a;ea(b,b.aoHeader);ea(b,b.aoFooter);wa(b)}});a!==k&&(this.iterator(\"column\",function(c,e){u(c,null,\"column-visibility\",[c,e,a,b])}),(b===k||b)&&this.columns.adjust());return c});s(\"columns().indexes()\",\"column().index()\",function(a){return this.iterator(\"column\",function(b,c){return\"visible\"===a?$(b,c):c},1)});p(\"columns.adjust()\",\r\nfunction(){return this.iterator(\"table\",function(a){Y(a)},1)});p(\"column.index()\",function(a,b){if(0!==this.context.length){var c=this.context[0];if(\"fromVisible\"===a||\"toData\"===a)return Z(c,b);if(\"fromData\"===a||\"toVisible\"===a)return $(c,b)}});p(\"column()\",function(a,b){return bb(this.columns(a,b))});p(\"cells()\",function(a,b,c){h.isPlainObject(a)&&(a.row===k?(c=a,a=null):(c=b,b=null));h.isPlainObject(b)&&(c=b,b=null);if(null===b||b===k)return this.iterator(\"table\",function(b){var d=a,e=ab(c),f=\r\nb.aoData,g=Ba(b,e),j=Sb(ha(f,g,\"anCells\")),i=h([].concat.apply([],j)),l,n=b.aoColumns.length,m,p,r,u,v,s;return $a(\"cell\",d,function(a){var c=typeof a===\"function\";if(a===null||a===k||c){m=[];p=0;for(r=g.length;p<r;p++){l=g[p];for(u=0;u<n;u++){v={row:l,column:u};if(c){s=f[l];a(v,B(b,l,u),s.anCells?s.anCells[u]:null)&&m.push(v)}else m.push(v)}}return m}if(h.isPlainObject(a))return[a];c=i.filter(a).map(function(a,b){return{row:b._DT_CellIndex.row,column:b._DT_CellIndex.column}}).toArray();if(c.length||\r\n!a.nodeName)return c;s=h(a).closest(\"*[data-dt-row]\");return s.length?[{row:s.data(\"dt-row\"),column:s.data(\"dt-column\")}]:[]},b,e)});var d=this.columns(b,c),e=this.rows(a,c),f,g,j,i,n,l=this.iterator(\"table\",function(a,b){f=[];g=0;for(j=e[b].length;g<j;g++){i=0;for(n=d[b].length;i<n;i++)f.push({row:e[b][g],column:d[b][i]})}return f},1);h.extend(l.selector,{cols:b,rows:a,opts:c});return l});s(\"cells().nodes()\",\"cell().node()\",function(){return this.iterator(\"cell\",function(a,b,c){return(a=a.aoData[b])&&\r\na.anCells?a.anCells[c]:k},1)});p(\"cells().data()\",function(){return this.iterator(\"cell\",function(a,b,c){return B(a,b,c)},1)});s(\"cells().cache()\",\"cell().cache()\",function(a){a=\"search\"===a?\"_aFilterData\":\"_aSortData\";return this.iterator(\"cell\",function(b,c,d){return b.aoData[c][a][d]},1)});s(\"cells().render()\",\"cell().render()\",function(a){return this.iterator(\"cell\",function(b,c,d){return B(b,c,d,a)},1)});s(\"cells().indexes()\",\"cell().index()\",function(){return this.iterator(\"cell\",function(a,\r\nb,c){return{row:b,column:c,columnVisible:$(a,c)}},1)});s(\"cells().invalidate()\",\"cell().invalidate()\",function(a){return this.iterator(\"cell\",function(b,c,d){ca(b,c,a,d)})});p(\"cell()\",function(a,b,c){return bb(this.cells(a,b,c))});p(\"cell().data()\",function(a){var b=this.context,c=this[0];if(a===k)return b.length&&c.length?B(b[0],c[0].row,c[0].column):k;jb(b[0],c[0].row,c[0].column,a);ca(b[0],c[0].row,\"data\",c[0].column);return this});p(\"order()\",function(a,b){var c=this.context;if(a===k)return 0!==\r\nc.length?c[0].aaSorting:k;\"number\"===typeof a?a=[[a,b]]:a.length&&!h.isArray(a[0])&&(a=Array.prototype.slice.call(arguments));return this.iterator(\"table\",function(b){b.aaSorting=a.slice()})});p(\"order.listener()\",function(a,b,c){return this.iterator(\"table\",function(d){Ma(d,a,b,c)})});p(\"order.fixed()\",function(a){if(!a){var b=this.context,b=b.length?b[0].aaSortingFixed:k;return h.isArray(b)?{pre:b}:b}return this.iterator(\"table\",function(b){b.aaSortingFixed=h.extend(!0,{},a)})});p([\"columns().order()\",\r\n\"column().order()\"],function(a){var b=this;return this.iterator(\"table\",function(c,d){var e=[];h.each(b[d],function(b,c){e.push([c,a])});c.aaSorting=e})});p(\"search()\",function(a,b,c,d){var e=this.context;return a===k?0!==e.length?e[0].oPreviousSearch.sSearch:k:this.iterator(\"table\",function(e){e.oFeatures.bFilter&&fa(e,h.extend({},e.oPreviousSearch,{sSearch:a+\"\",bRegex:null===b?!1:b,bSmart:null===c?!0:c,bCaseInsensitive:null===d?!0:d}),1)})});s(\"columns().search()\",\"column().search()\",function(a,\r\nb,c,d){return this.iterator(\"column\",function(e,f){var g=e.aoPreSearchCols;if(a===k)return g[f].sSearch;e.oFeatures.bFilter&&(h.extend(g[f],{sSearch:a+\"\",bRegex:null===b?!1:b,bSmart:null===c?!0:c,bCaseInsensitive:null===d?!0:d}),fa(e,e.oPreviousSearch,1))})});p(\"state()\",function(){return this.context.length?this.context[0].oSavedState:null});p(\"state.clear()\",function(){return this.iterator(\"table\",function(a){a.fnStateSaveCallback.call(a.oInstance,a,{})})});p(\"state.loaded()\",function(){return this.context.length?\r\nthis.context[0].oLoadedState:null});p(\"state.save()\",function(){return this.iterator(\"table\",function(a){wa(a)})});m.versionCheck=m.fnVersionCheck=function(a){for(var b=m.version.split(\".\"),a=a.split(\".\"),c,d,e=0,f=a.length;e<f;e++)if(c=parseInt(b[e],10)||0,d=parseInt(a[e],10)||0,c!==d)return c>d;return!0};m.isDataTable=m.fnIsDataTable=function(a){var b=h(a).get(0),c=!1;h.each(m.settings,function(a,e){var f=e.nScrollHead?h(\"table\",e.nScrollHead)[0]:null,g=e.nScrollFoot?h(\"table\",e.nScrollFoot)[0]:\r\nnull;if(e.nTable===b||f===b||g===b)c=!0});return c};m.tables=m.fnTables=function(a){var b=!1;h.isPlainObject(a)&&(b=a.api,a=a.visible);var c=h.map(m.settings,function(b){if(!a||a&&h(b.nTable).is(\":visible\"))return b.nTable});return b?new r(c):c};m.camelToHungarian=K;p(\"$()\",function(a,b){var c=this.rows(b).nodes(),c=h(c);return h([].concat(c.filter(a).toArray(),c.find(a).toArray()))});h.each([\"on\",\"one\",\"off\"],function(a,b){p(b+\"()\",function(){var a=Array.prototype.slice.call(arguments);a[0].match(/\\.dt\\b/)||\r\n(a[0]+=\".dt\");var d=h(this.tables().nodes());d[b].apply(d,a);return this})});p(\"clear()\",function(){return this.iterator(\"table\",function(a){na(a)})});p(\"settings()\",function(){return new r(this.context,this.context)});p(\"init()\",function(){var a=this.context;return a.length?a[0].oInit:null});p(\"data()\",function(){return this.iterator(\"table\",function(a){return G(a.aoData,\"_aData\")}).flatten()});p(\"destroy()\",function(a){a=a||!1;return this.iterator(\"table\",function(b){var c=b.nTableWrapper.parentNode,\r\nd=b.oClasses,e=b.nTable,f=b.nTBody,g=b.nTHead,j=b.nTFoot,i=h(e),f=h(f),k=h(b.nTableWrapper),l=h.map(b.aoData,function(a){return a.nTr}),p;b.bDestroying=!0;u(b,\"aoDestroyCallback\",\"destroy\",[b]);a||(new r(b)).columns().visible(!0);k.unbind(\".DT\").find(\":not(tbody *)\").unbind(\".DT\");h(D).unbind(\".DT-\"+b.sInstance);e!=g.parentNode&&(i.children(\"thead\").detach(),i.append(g));j&&e!=j.parentNode&&(i.children(\"tfoot\").detach(),i.append(j));b.aaSorting=[];b.aaSortingFixed=[];va(b);h(l).removeClass(b.asStripeClasses.join(\" \"));\r\nh(\"th, td\",g).removeClass(d.sSortable+\" \"+d.sSortableAsc+\" \"+d.sSortableDesc+\" \"+d.sSortableNone);b.bJUI&&(h(\"th span.\"+d.sSortIcon+\", td span.\"+d.sSortIcon,g).detach(),h(\"th, td\",g).each(function(){var a=h(\"div.\"+d.sSortJUIWrapper,this);h(this).append(a.contents());a.detach()}));f.children().detach();f.append(l);g=a?\"remove\":\"detach\";i[g]();k[g]();!a&&c&&(c.insertBefore(e,b.nTableReinsertBefore),i.css(\"width\",b.sDestroyWidth).removeClass(d.sTable),(p=b.asDestroyStripes.length)&&f.children().each(function(a){h(this).addClass(b.asDestroyStripes[a%\r\np])}));c=h.inArray(b,m.settings);-1!==c&&m.settings.splice(c,1)})});h.each([\"column\",\"row\",\"cell\"],function(a,b){p(b+\"s().every()\",function(a){var d=this.selector.opts,e=this;return this.iterator(b,function(f,g,h,i,n){a.call(e[b](g,\"cell\"===b?h:d,\"cell\"===b?d:k),g,h,i,n)})})});p(\"i18n()\",function(a,b,c){var d=this.context[0],a=Q(a)(d.oLanguage);a===k&&(a=b);c!==k&&h.isPlainObject(a)&&(a=a[c]!==k?a[c]:a._);return a.replace(\"%d\",c)});m.version=\"1.10.12\";m.settings=[];m.models={};m.models.oSearch={bCaseInsensitive:!0,\r\nsSearch:\"\",bRegex:!1,bSmart:!0};m.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:\"\",src:null,idx:-1};m.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:\"std\",sSortingClass:null,sSortingClassJUI:null,\r\nsTitle:null,sType:null,sWidth:null,sWidthOrig:null};m.defaults={aaData:null,aaSorting:[[0,\"asc\"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,\r\nfnFormatNumber:function(a){return a.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(a){try{return JSON.parse((-1===a.iStateDuration?sessionStorage:localStorage).getItem(\"DataTables_\"+a.sInstance+\"_\"+location.pathname))}catch(b){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(a,b){try{(-1===\r\na.iStateDuration?sessionStorage:localStorage).setItem(\"DataTables_\"+a.sInstance+\"_\"+location.pathname,JSON.stringify(b))}catch(c){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:\": activate to sort column ascending\",sSortDescending:\": activate to sort column descending\"},oPaginate:{sFirst:\"First\",sLast:\"Last\",sNext:\"Next\",sPrevious:\"Previous\"},sEmptyTable:\"No data available in table\",sInfo:\"Showing _START_ to _END_ of _TOTAL_ entries\",\r\nsInfoEmpty:\"Showing 0 to 0 of 0 entries\",sInfoFiltered:\"(filtered from _MAX_ total entries)\",sInfoPostFix:\"\",sDecimal:\"\",sThousands:\",\",sLengthMenu:\"Show _MENU_ entries\",sLoadingRecords:\"Loading...\",sProcessing:\"Processing...\",sSearch:\"Search:\",sSearchPlaceholder:\"\",sUrl:\"\",sZeroRecords:\"No matching records found\"},oSearch:h.extend({},m.models.oSearch),sAjaxDataProp:\"data\",sAjaxSource:null,sDom:\"lfrtip\",searchDelay:null,sPaginationType:\"simple_numbers\",sScrollX:\"\",sScrollXInner:\"\",sScrollY:\"\",sServerMethod:\"GET\",\r\nrenderer:null,rowId:\"DT_RowId\"};X(m.defaults);m.defaults.column={aDataSort:null,iDataSort:-1,asSorting:[\"asc\",\"desc\"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:\"td\",sClass:\"\",sContentPadding:\"\",sDefaultContent:null,sName:\"\",sSortDataType:\"std\",sTitle:null,sType:null,sWidth:null};X(m.defaults.column);m.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,\r\nbSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],\r\naoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:\"\",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:\"two_button\",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:k,oAjaxData:k,\r\nfnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return\"ssp\"==y(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return\"ssp\"==y(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var a=\r\nthis._iDisplayLength,b=this._iDisplayStart,c=b+a,d=this.aiDisplay.length,e=this.oFeatures,f=e.bPaginate;return e.bServerSide?!1===f||-1===a?b+d:Math.min(b+a,this._iRecordsDisplay):!f||c>d||-1===a?d:c},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null};m.ext=v={buttons:{},classes:{},builder:\"-source-\",errMode:\"alert\",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},\r\nheader:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:m.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:m.version};h.extend(v,{afnFiltering:v.search,aTypes:v.type.detect,ofnSearch:v.type.search,oSort:v.type.order,afnSortData:v.order,aoFeatures:v.feature,oApi:v.internal,oStdClasses:v.classes,oPagination:v.pager});h.extend(m.ext.classes,{sTable:\"dataTable\",sNoFooter:\"no-footer\",sPageButton:\"paginate_button\",sPageButtonActive:\"current\",sPageButtonDisabled:\"disabled\",sStripeOdd:\"odd\",\r\nsStripeEven:\"even\",sRowEmpty:\"dataTables_empty\",sWrapper:\"dataTables_wrapper\",sFilter:\"dataTables_filter\",sInfo:\"dataTables_info\",sPaging:\"dataTables_paginate paging_\",sLength:\"dataTables_length\",sProcessing:\"dataTables_processing\",sSortAsc:\"sorting_asc\",sSortDesc:\"sorting_desc\",sSortable:\"sorting\",sSortableAsc:\"sorting_asc_disabled\",sSortableDesc:\"sorting_desc_disabled\",sSortableNone:\"sorting_disabled\",sSortColumn:\"sorting_\",sFilterInput:\"\",sLengthSelect:\"\",sScrollWrapper:\"dataTables_scroll\",sScrollHead:\"dataTables_scrollHead\",\r\nsScrollHeadInner:\"dataTables_scrollHeadInner\",sScrollBody:\"dataTables_scrollBody\",sScrollFoot:\"dataTables_scrollFoot\",sScrollFootInner:\"dataTables_scrollFootInner\",sHeaderTH:\"\",sFooterTH:\"\",sSortJUIAsc:\"\",sSortJUIDesc:\"\",sSortJUI:\"\",sSortJUIAscAllowed:\"\",sSortJUIDescAllowed:\"\",sSortJUIWrapper:\"\",sSortIcon:\"\",sJUIHeader:\"\",sJUIFooter:\"\"});var Ca=\"\",Ca=\"\",H=Ca+\"ui-state-default\",ia=Ca+\"css_right ui-icon ui-icon-\",Xb=Ca+\"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix\";h.extend(m.ext.oJUIClasses,\r\nm.ext.classes,{sPageButton:\"fg-button ui-button \"+H,sPageButtonActive:\"ui-state-disabled\",sPageButtonDisabled:\"ui-state-disabled\",sPaging:\"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_\",sSortAsc:H+\" sorting_asc\",sSortDesc:H+\" sorting_desc\",sSortable:H+\" sorting\",sSortableAsc:H+\" sorting_asc_disabled\",sSortableDesc:H+\" sorting_desc_disabled\",sSortableNone:H+\" sorting_disabled\",sSortJUIAsc:ia+\"triangle-1-n\",sSortJUIDesc:ia+\"triangle-1-s\",sSortJUI:ia+\"carat-2-n-s\",\r\nsSortJUIAscAllowed:ia+\"carat-1-n\",sSortJUIDescAllowed:ia+\"carat-1-s\",sSortJUIWrapper:\"DataTables_sort_wrapper\",sSortIcon:\"DataTables_sort_icon\",sScrollHead:\"dataTables_scrollHead \"+H,sScrollFoot:\"dataTables_scrollFoot \"+H,sHeaderTH:H,sFooterTH:H,sJUIHeader:Xb+\" ui-corner-tl ui-corner-tr\",sJUIFooter:Xb+\" ui-corner-bl ui-corner-br\"});var Mb=m.ext.pager;h.extend(Mb,{simple:function(){return[\"previous\",\"next\"]},full:function(){return[\"first\",\"previous\",\"next\",\"last\"]},numbers:function(a,b){return[ya(a,\r\nb)]},simple_numbers:function(a,b){return[\"previous\",ya(a,b),\"next\"]},full_numbers:function(a,b){return[\"first\",\"previous\",ya(a,b),\"next\",\"last\"]},_numbers:ya,numbers_length:7});h.extend(!0,m.ext.renderer,{pageButton:{_:function(a,b,c,d,e,f){var g=a.oClasses,j=a.oLanguage.oPaginate,i=a.oLanguage.oAria.paginate||{},k,l,m=0,p=function(b,d){var o,r,u,s,v=function(b){Ta(a,b.data.action,true)};o=0;for(r=d.length;o<r;o++){s=d[o];if(h.isArray(s)){u=h(\"<\"+(s.DT_el||\"div\")+\"/>\").appendTo(b);p(u,s)}else{k=null;\r\nl=\"\";switch(s){case \"ellipsis\":b.append('<span class=\"ellipsis\">&#x2026;</span>');break;case \"first\":k=j.sFirst;l=s+(e>0?\"\":\" \"+g.sPageButtonDisabled);break;case \"previous\":k=j.sPrevious;l=s+(e>0?\"\":\" \"+g.sPageButtonDisabled);break;case \"next\":k=j.sNext;l=s+(e<f-1?\"\":\" \"+g.sPageButtonDisabled);break;case \"last\":k=j.sLast;l=s+(e<f-1?\"\":\" \"+g.sPageButtonDisabled);break;default:k=s+1;l=e===s?g.sPageButtonActive:\"\"}if(k!==null){u=h(\"<a>\",{\"class\":g.sPageButton+\" \"+l,\"aria-controls\":a.sTableId,\"aria-label\":i[s],\r\n\"data-dt-idx\":m,tabindex:a.iTabIndex,id:c===0&&typeof s===\"string\"?a.sTableId+\"_\"+s:null}).html(k).appendTo(b);Wa(u,{action:s},v);m++}}}},r;try{r=h(b).find(I.activeElement).data(\"dt-idx\")}catch(o){}p(h(b).empty(),d);r&&h(b).find(\"[data-dt-idx=\"+r+\"]\").focus()}}});h.extend(m.ext.type.detect,[function(a,b){var c=b.oLanguage.sDecimal;return Za(a,c)?\"num\"+c:null},function(a){if(a&&!(a instanceof Date)&&(!ac.test(a)||!bc.test(a)))return null;var b=Date.parse(a);return null!==b&&!isNaN(b)||M(a)?\"date\":\r\nnull},function(a,b){var c=b.oLanguage.sDecimal;return Za(a,c,!0)?\"num-fmt\"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Rb(a,c)?\"html-num\"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Rb(a,c,!0)?\"html-num-fmt\"+c:null},function(a){return M(a)||\"string\"===typeof a&&-1!==a.indexOf(\"<\")?\"html\":null}]);h.extend(m.ext.type.search,{html:function(a){return M(a)?a:\"string\"===typeof a?a.replace(Ob,\" \").replace(Aa,\"\"):\"\"},string:function(a){return M(a)?a:\"string\"===typeof a?a.replace(Ob,\r\n\" \"):a}});var za=function(a,b,c,d){if(0!==a&&(!a||\"-\"===a))return-Infinity;b&&(a=Qb(a,b));a.replace&&(c&&(a=a.replace(c,\"\")),d&&(a=a.replace(d,\"\")));return 1*a};h.extend(v.type.order,{\"date-pre\":function(a){return Date.parse(a)||0},\"html-pre\":function(a){return M(a)?\"\":a.replace?a.replace(/<.*?>/g,\"\").toLowerCase():a+\"\"},\"string-pre\":function(a){return M(a)?\"\":\"string\"===typeof a?a.toLowerCase():!a.toString?\"\":a.toString()},\"string-asc\":function(a,b){return a<b?-1:a>b?1:0},\"string-desc\":function(a,\r\nb){return a<b?1:a>b?-1:0}});db(\"\");h.extend(!0,m.ext.renderer,{header:{_:function(a,b,c,d){h(a.nTable).on(\"order.dt.DT\",function(e,f,g,h){if(a===f){e=c.idx;b.removeClass(c.sSortingClass+\" \"+d.sSortAsc+\" \"+d.sSortDesc).addClass(h[e]==\"asc\"?d.sSortAsc:h[e]==\"desc\"?d.sSortDesc:c.sSortingClass)}})},jqueryui:function(a,b,c,d){h(\"<div/>\").addClass(d.sSortJUIWrapper).append(b.contents()).append(h(\"<span/>\").addClass(d.sSortIcon+\" \"+c.sSortingClassJUI)).appendTo(b);h(a.nTable).on(\"order.dt.DT\",function(e,\r\nf,g,h){if(a===f){e=c.idx;b.removeClass(d.sSortAsc+\" \"+d.sSortDesc).addClass(h[e]==\"asc\"?d.sSortAsc:h[e]==\"desc\"?d.sSortDesc:c.sSortingClass);b.find(\"span.\"+d.sSortIcon).removeClass(d.sSortJUIAsc+\" \"+d.sSortJUIDesc+\" \"+d.sSortJUI+\" \"+d.sSortJUIAscAllowed+\" \"+d.sSortJUIDescAllowed).addClass(h[e]==\"asc\"?d.sSortJUIAsc:h[e]==\"desc\"?d.sSortJUIDesc:c.sSortingClassJUI)}})}}});var Yb=function(a){return\"string\"===typeof a?a.replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\"):a};m.render={number:function(a,\r\nb,c,d,e){return{display:function(f){if(\"number\"!==typeof f&&\"string\"!==typeof f)return f;var g=0>f?\"-\":\"\",h=parseFloat(f);if(isNaN(h))return Yb(f);f=Math.abs(h);h=parseInt(f,10);f=c?b+(f-h).toFixed(c).substring(2):\"\";return g+(d||\"\")+h.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,a)+f+(e||\"\")}}},text:function(){return{display:Yb}}};h.extend(m.ext.internal,{_fnExternApiFunc:Nb,_fnBuildAjax:ra,_fnAjaxUpdate:lb,_fnAjaxParameters:ub,_fnAjaxUpdateDraw:vb,_fnAjaxDataSrc:sa,_fnAddColumn:Ea,_fnColumnOptions:ja,\r\n_fnAdjustColumnSizing:Y,_fnVisibleToColumnIndex:Z,_fnColumnIndexToVisible:$,_fnVisbleColumns:aa,_fnGetColumns:la,_fnColumnTypes:Ga,_fnApplyColumnDefs:ib,_fnHungarianMap:X,_fnCamelToHungarian:K,_fnLanguageCompat:Da,_fnBrowserDetect:gb,_fnAddData:N,_fnAddTr:ma,_fnNodeToDataIndex:function(a,b){return b._DT_RowIndex!==k?b._DT_RowIndex:null},_fnNodeToColumnIndex:function(a,b,c){return h.inArray(c,a.aoData[b].anCells)},_fnGetCellData:B,_fnSetCellData:jb,_fnSplitObjNotation:Ja,_fnGetObjectDataFn:Q,_fnSetObjectDataFn:R,\r\n_fnGetDataMaster:Ka,_fnClearTable:na,_fnDeleteIndex:oa,_fnInvalidate:ca,_fnGetRowElements:Ia,_fnCreateTr:Ha,_fnBuildHead:kb,_fnDrawHead:ea,_fnDraw:O,_fnReDraw:T,_fnAddOptionsHtml:nb,_fnDetectHeader:da,_fnGetUniqueThs:qa,_fnFeatureHtmlFilter:pb,_fnFilterComplete:fa,_fnFilterCustom:yb,_fnFilterColumn:xb,_fnFilter:wb,_fnFilterCreateSearch:Pa,_fnEscapeRegex:Qa,_fnFilterData:zb,_fnFeatureHtmlInfo:sb,_fnUpdateInfo:Cb,_fnInfoMacros:Db,_fnInitialise:ga,_fnInitComplete:ta,_fnLengthChange:Ra,_fnFeatureHtmlLength:ob,\r\n_fnFeatureHtmlPaginate:tb,_fnPageChange:Ta,_fnFeatureHtmlProcessing:qb,_fnProcessingDisplay:C,_fnFeatureHtmlTable:rb,_fnScrollDraw:ka,_fnApplyToChildren:J,_fnCalculateColumnWidths:Fa,_fnThrottle:Oa,_fnConvertToWidth:Fb,_fnGetWidestNode:Gb,_fnGetMaxLenString:Hb,_fnStringToCss:x,_fnSortFlatten:V,_fnSort:mb,_fnSortAria:Jb,_fnSortListener:Va,_fnSortAttachListener:Ma,_fnSortingClasses:va,_fnSortData:Ib,_fnSaveState:wa,_fnLoadState:Kb,_fnSettingsFromNode:xa,_fnLog:L,_fnMap:E,_fnBindAction:Wa,_fnCallbackReg:z,\r\n_fnCallbackFire:u,_fnLengthOverflow:Sa,_fnRenderer:Na,_fnDataSource:y,_fnRowAttributes:La,_fnCalculateEnd:function(){}});h.fn.dataTable=m;m.$=h;h.fn.dataTableSettings=m.settings;h.fn.dataTableExt=m.ext;h.fn.DataTable=function(a){return h(this).dataTable(a).api()};h.each(m,function(a,b){h.fn.DataTable[a]=b});return h.fn.dataTable});\r\n\n",
    "/*!\r\n Buttons for DataTables 1.2.1\r\n ©2016 SpryMedia Ltd - datatables.net/license\r\n*/\r\n(function(d){\"function\"===typeof define&&define.amd?define('datatables.net-buttons',[\"jquery\",\"datatables.net\"],function(o){return d(o,window,document)}):\"object\"===typeof exports?module.exports=function(o,n){o||(o=window);if(!n||!n.fn.dataTable)n=require(\"datatables.net\")(o,n).$;return d(n,o,o.document)}:d(jQuery,window,document)})(function(d,o,n,l){var i=d.fn.dataTable,u=0,v=0,k=i.ext.buttons,m=function(a,b){!0===b&&(b={});d.isArray(b)&&(b={buttons:b});this.c=d.extend(!0,{},m.defaults,b);b.buttons&&(this.c.buttons=b.buttons);\r\nthis.s={dt:new i.Api(a),buttons:[],listenKeys:\"\",namespace:\"dtb\"+u++};this.dom={container:d(\"<\"+this.c.dom.container.tag+\"/>\").addClass(this.c.dom.container.className)};this._constructor()};d.extend(m.prototype,{action:function(a,b){var c=this._nodeToButton(a);if(b===l)return c.conf.action;c.conf.action=b;return this},active:function(a,b){var c=this._nodeToButton(a),e=this.c.dom.button.active,c=d(c.node);if(b===l)return c.hasClass(e);c.toggleClass(e,b===l?!0:b);return this},add:function(a,b){var c=\r\nthis.s.buttons;if(\"string\"===typeof b){for(var e=b.split(\"-\"),c=this.s,d=0,h=e.length-1;d<h;d++)c=c.buttons[1*e[d]];c=c.buttons;b=1*e[e.length-1]}this._expandButton(c,a,!1,b);this._draw();return this},container:function(){return this.dom.container},disable:function(a){a=this._nodeToButton(a);d(a.node).addClass(this.c.dom.button.disabled);return this},destroy:function(){d(\"body\").off(\"keyup.\"+this.s.namespace);var a=this.s.buttons.slice(),b,c;b=0;for(c=a.length;b<c;b++)this.remove(a[b].node);this.dom.container.remove();\r\na=this.s.dt.settings()[0];b=0;for(c=a.length;b<c;b++)if(a.inst===this){a.splice(b,1);break}return this},enable:function(a,b){if(!1===b)return this.disable(a);var c=this._nodeToButton(a);d(c.node).removeClass(this.c.dom.button.disabled);return this},name:function(){return this.c.name},node:function(a){a=this._nodeToButton(a);return d(a.node)},remove:function(a){var b=this._nodeToButton(a),c=this._nodeToHost(a),e=this.s.dt;if(b.buttons.length)for(var g=b.buttons.length-1;0<=g;g--)this.remove(b.buttons[g].node);\r\nb.conf.destroy&&b.conf.destroy.call(e.button(a),e,d(a),b.conf);this._removeKey(b.conf);d(b.node).remove();a=d.inArray(b,c);c.splice(a,1);return this},text:function(a,b){var c=this._nodeToButton(a),e=this.c.dom.collection.buttonLiner,e=c.inCollection&&e&&e.tag?e.tag:this.c.dom.buttonLiner.tag,g=this.s.dt,h=d(c.node),f=function(a){return\"function\"===typeof a?a(g,h,c.conf):a};if(b===l)return f(c.conf.text);c.conf.text=b;e?h.children(e).html(f(b)):h.html(f(b));return this},_constructor:function(){var a=\r\nthis,b=this.s.dt,c=b.settings()[0],e=this.c.buttons;c._buttons||(c._buttons=[]);c._buttons.push({inst:this,name:this.c.name});for(var c=0,g=e.length;c<g;c++)this.add(e[c]);b.on(\"destroy\",function(){a.destroy()});d(\"body\").on(\"keyup.\"+this.s.namespace,function(b){if(!n.activeElement||n.activeElement===n.body){var c=String.fromCharCode(b.keyCode).toLowerCase();a.s.listenKeys.toLowerCase().indexOf(c)!==-1&&a._keypress(c,b)}})},_addKey:function(a){a.key&&(this.s.listenKeys+=d.isPlainObject(a.key)?a.key.key:\r\na.key)},_draw:function(a,b){a||(a=this.dom.container,b=this.s.buttons);a.children().detach();for(var c=0,d=b.length;c<d;c++)a.append(b[c].inserter),b[c].buttons&&b[c].buttons.length&&this._draw(b[c].collection,b[c].buttons)},_expandButton:function(a,b,c,e){for(var g=this.s.dt,h=0,b=!d.isArray(b)?[b]:b,f=0,q=b.length;f<q;f++){var j=this._resolveExtends(b[f]);if(j)if(d.isArray(j))this._expandButton(a,j,c,e);else{var p=this._buildButton(j,c);if(p){e!==l?(a.splice(e,0,p),e++):a.push(p);if(p.conf.buttons){var s=\r\nthis.c.dom.collection;p.collection=d(\"<\"+s.tag+\"/>\").addClass(s.className);p.conf._collection=p.collection;this._expandButton(p.buttons,p.conf.buttons,!0,e)}j.init&&j.init.call(g.button(p.node),g,d(p.node),j);h++}}}},_buildButton:function(a,b){var c=this.c.dom.button,e=this.c.dom.buttonLiner,g=this.c.dom.collection,h=this.s.dt,f=function(b){return\"function\"===typeof b?b(h,j,a):b};b&&g.button&&(c=g.button);b&&g.buttonLiner&&(e=g.buttonLiner);if(a.available&&!a.available(h,a))return!1;var q=function(a,\r\nb,c,e){e.action.call(b.button(c),a,b,c,e);d(b.table().node()).triggerHandler(\"buttons-action.dt\",[b.button(c),b,c,e])},j=d(\"<\"+c.tag+\"/>\").addClass(c.className).attr(\"tabindex\",this.s.dt.settings()[0].iTabIndex).attr(\"aria-controls\",this.s.dt.table().node().id).on(\"click.dtb\",function(b){b.preventDefault();!j.hasClass(c.disabled)&&a.action&&q(b,h,j,a);j.blur()}).on(\"keyup.dtb\",function(b){b.keyCode===13&&!j.hasClass(c.disabled)&&a.action&&q(b,h,j,a)});\"a\"===c.tag.toLowerCase()&&j.attr(\"href\",\"#\");\r\ne.tag?(g=d(\"<\"+e.tag+\"/>\").html(f(a.text)).addClass(e.className),\"a\"===e.tag.toLowerCase()&&g.attr(\"href\",\"#\"),j.append(g)):j.html(f(a.text));!1===a.enabled&&j.addClass(c.disabled);a.className&&j.addClass(a.className);a.titleAttr&&j.attr(\"title\",a.titleAttr);a.namespace||(a.namespace=\".dt-button-\"+v++);e=(e=this.c.dom.buttonContainer)&&e.tag?d(\"<\"+e.tag+\"/>\").addClass(e.className).append(j):j;this._addKey(a);return{conf:a,node:j.get(0),inserter:e,buttons:[],inCollection:b,collection:null}},_nodeToButton:function(a,\r\nb){b||(b=this.s.buttons);for(var c=0,d=b.length;c<d;c++){if(b[c].node===a)return b[c];if(b[c].buttons.length){var g=this._nodeToButton(a,b[c].buttons);if(g)return g}}},_nodeToHost:function(a,b){b||(b=this.s.buttons);for(var c=0,d=b.length;c<d;c++){if(b[c].node===a)return b;if(b[c].buttons.length){var g=this._nodeToHost(a,b[c].buttons);if(g)return g}}},_keypress:function(a,b){var c=function(e){for(var g=0,h=e.length;g<h;g++){var f=e[g].conf,q=e[g].node;if(f.key)if(f.key===a)d(q).click();else if(d.isPlainObject(f.key)&&\r\nf.key.key===a&&(!f.key.shiftKey||b.shiftKey))if(!f.key.altKey||b.altKey)if(!f.key.ctrlKey||b.ctrlKey)(!f.key.metaKey||b.metaKey)&&d(q).click();e[g].buttons.length&&c(e[g].buttons)}};c(this.s.buttons)},_removeKey:function(a){if(a.key){var b=d.isPlainObject(a.key)?a.key.key:a.key,a=this.s.listenKeys.split(\"\"),b=d.inArray(b,a);a.splice(b,1);this.s.listenKeys=a.join(\"\")}},_resolveExtends:function(a){for(var b=this.s.dt,c,e,g=function(c){for(var e=0;!d.isPlainObject(c)&&!d.isArray(c);){if(c===l)return;\r\nif(\"function\"===typeof c){if(c=c(b,a),!c)return!1}else if(\"string\"===typeof c){if(!k[c])throw\"Unknown button type: \"+c;c=k[c]}e++;if(30<e)throw\"Buttons: Too many iterations\";}return d.isArray(c)?c:d.extend({},c)},a=g(a);a&&a.extend;){if(!k[a.extend])throw\"Cannot extend unknown button type: \"+a.extend;var h=g(k[a.extend]);if(d.isArray(h))return h;if(!h)return!1;c=h.className;a=d.extend({},h,a);c&&a.className!==c&&(a.className=c+\" \"+a.className);var f=a.postfixButtons;if(f){a.buttons||(a.buttons=[]);\r\nc=0;for(e=f.length;c<e;c++)a.buttons.push(f[c]);a.postfixButtons=null}if(f=a.prefixButtons){a.buttons||(a.buttons=[]);c=0;for(e=f.length;c<e;c++)a.buttons.splice(c,0,f[c]);a.prefixButtons=null}a.extend=h.extend}return a}});m.background=function(a,b,c){c===l&&(c=400);a?d(\"<div/>\").addClass(b).css(\"display\",\"none\").appendTo(\"body\").fadeIn(c):d(\"body > div.\"+b).fadeOut(c,function(){d(this).remove()})};m.instanceSelector=function(a,b){if(!a)return d.map(b,function(a){return a.inst});var c=[],e=d.map(b,\r\nfunction(a){return a.name}),g=function(a){if(d.isArray(a))for(var f=0,q=a.length;f<q;f++)g(a[f]);else\"string\"===typeof a?-1!==a.indexOf(\",\")?g(a.split(\",\")):(a=d.inArray(d.trim(a),e),-1!==a&&c.push(b[a].inst)):\"number\"===typeof a&&c.push(b[a].inst)};g(a);return c};m.buttonSelector=function(a,b){for(var c=[],e=function(a,b,c){for(var d,g,f=0,h=b.length;f<h;f++)if(d=b[f])g=c!==l?c+f:f+\"\",a.push({node:d.node,name:d.conf.name,idx:g}),d.buttons&&e(a,d.buttons,g+\"-\")},g=function(a,b){var f,h,i=[];e(i,b.s.buttons);\r\nf=d.map(i,function(a){return a.node});if(d.isArray(a)||a instanceof d){f=0;for(h=a.length;f<h;f++)g(a[f],b)}else if(null===a||a===l||\"*\"===a){f=0;for(h=i.length;f<h;f++)c.push({inst:b,node:i[f].node})}else if(\"number\"===typeof a)c.push({inst:b,node:b.s.buttons[a].node});else if(\"string\"===typeof a)if(-1!==a.indexOf(\",\")){i=a.split(\",\");f=0;for(h=i.length;f<h;f++)g(d.trim(i[f]),b)}else if(a.match(/^\\d+(\\-\\d+)*$/))f=d.map(i,function(a){return a.idx}),c.push({inst:b,node:i[d.inArray(a,f)].node});else if(-1!==\r\na.indexOf(\":name\")){var k=a.replace(\":name\",\"\");f=0;for(h=i.length;f<h;f++)i[f].name===k&&c.push({inst:b,node:i[f].node})}else d(f).filter(a).each(function(){c.push({inst:b,node:this})});else\"object\"===typeof a&&a.nodeName&&(i=d.inArray(a,f),-1!==i&&c.push({inst:b,node:f[i]}))},h=0,f=a.length;h<f;h++)g(b,a[h]);return c};m.defaults={buttons:[\"copy\",\"excel\",\"csv\",\"pdf\",\"print\"],name:\"main\",tabIndex:0,dom:{container:{tag:\"div\",className:\"dt-buttons\"},collection:{tag:\"div\",className:\"dt-button-collection\"},\r\nbutton:{tag:\"a\",className:\"dt-button\",active:\"active\",disabled:\"disabled\"},buttonLiner:{tag:\"span\",className:\"\"}}};m.version=\"1.2.1\";d.extend(k,{collection:{text:function(a){return a.i18n(\"buttons.collection\",\"Collection\")},className:\"buttons-collection\",action:function(a,b,c,e){var a=c.offset(),g=d(b.table().container()),h=!1;d(\"div.dt-button-background\").length&&(h=d(\"div.dt-button-collection\").offset(),d(\"body\").trigger(\"click.dtb-collection\"));e._collection.addClass(e.collectionLayout).css(\"display\",\r\n\"none\").appendTo(\"body\").fadeIn(e.fade);var f=e._collection.css(\"position\");h&&\"absolute\"===f?e._collection.css({top:h.top+5,left:h.left+5}):\"absolute\"===f?(e._collection.css({top:a.top+c.outerHeight(),left:a.left}),c=a.left+e._collection.outerWidth(),g=g.offset().left+g.width(),c>g&&e._collection.css(\"left\",a.left-(c-g))):(a=e._collection.height()/2,a>d(o).height()/2&&(a=d(o).height()/2),e._collection.css(\"marginTop\",-1*a));e.background&&m.background(!0,e.backgroundClassName,e.fade);setTimeout(function(){d(\"div.dt-button-background\").on(\"click.dtb-collection\",\r\nfunction(){});d(\"body\").on(\"click.dtb-collection\",function(a){if(!d(a.target).parents().andSelf().filter(e._collection).length){e._collection.fadeOut(e.fade,function(){e._collection.detach()});d(\"div.dt-button-background\").off(\"click.dtb-collection\");m.background(false,e.backgroundClassName,e.fade);d(\"body\").off(\"click.dtb-collection\");b.off(\"buttons-action.b-internal\")}})},10);if(e.autoClose)b.on(\"buttons-action.b-internal\",function(){d(\"div.dt-button-background\").click()})},background:!0,collectionLayout:\"\",\r\nbackgroundClassName:\"dt-button-background\",autoClose:!1,fade:400},copy:function(a,b){if(k.copyHtml5)return\"copyHtml5\";if(k.copyFlash&&k.copyFlash.available(a,b))return\"copyFlash\"},csv:function(a,b){if(k.csvHtml5&&k.csvHtml5.available(a,b))return\"csvHtml5\";if(k.csvFlash&&k.csvFlash.available(a,b))return\"csvFlash\"},excel:function(a,b){if(k.excelHtml5&&k.excelHtml5.available(a,b))return\"excelHtml5\";if(k.excelFlash&&k.excelFlash.available(a,b))return\"excelFlash\"},pdf:function(a,b){if(k.pdfHtml5&&k.pdfHtml5.available(a,\r\nb))return\"pdfHtml5\";if(k.pdfFlash&&k.pdfFlash.available(a,b))return\"pdfFlash\"},pageLength:function(a){var a=a.settings()[0].aLengthMenu,b=d.isArray(a[0])?a[0]:a,c=d.isArray(a[0])?a[1]:a,e=function(a){return a.i18n(\"buttons.pageLength\",{\"-1\":\"Show all rows\",_:\"Show %d rows\"},a.page.len())};return{extend:\"collection\",text:e,className:\"buttons-page-length\",autoClose:!0,buttons:d.map(b,function(a,b){return{text:c[b],action:function(b,c){c.page.len(a).draw()},init:function(b,c,d){var e=this,c=function(){e.active(b.page.len()===\r\na)};b.on(\"length.dt\"+d.namespace,c);c()},destroy:function(a,b,c){a.off(\"length.dt\"+c.namespace)}}}),init:function(a,b,c){var d=this;a.on(\"length.dt\"+c.namespace,function(){d.text(e(a))})},destroy:function(a,b,c){a.off(\"length.dt\"+c.namespace)}}}});i.Api.register(\"buttons()\",function(a,b){b===l&&(b=a,a=l);return this.iterator(!0,\"table\",function(c){if(c._buttons)return m.buttonSelector(m.instanceSelector(a,c._buttons),b)},!0)});i.Api.register(\"button()\",function(a,b){var c=this.buttons(a,b);1<c.length&&\r\nc.splice(1,c.length);return c});i.Api.registerPlural(\"buttons().active()\",\"button().active()\",function(a){return a===l?this.map(function(a){return a.inst.active(a.node)}):this.each(function(b){b.inst.active(b.node,a)})});i.Api.registerPlural(\"buttons().action()\",\"button().action()\",function(a){return a===l?this.map(function(a){return a.inst.action(a.node)}):this.each(function(b){b.inst.action(b.node,a)})});i.Api.register([\"buttons().enable()\",\"button().enable()\"],function(a){return this.each(function(b){b.inst.enable(b.node,\r\na)})});i.Api.register([\"buttons().disable()\",\"button().disable()\"],function(){return this.each(function(a){a.inst.disable(a.node)})});i.Api.registerPlural(\"buttons().nodes()\",\"button().node()\",function(){var a=d();d(this.each(function(b){a=a.add(b.inst.node(b.node))}));return a});i.Api.registerPlural(\"buttons().text()\",\"button().text()\",function(a){return a===l?this.map(function(a){return a.inst.text(a.node)}):this.each(function(b){b.inst.text(b.node,a)})});i.Api.registerPlural(\"buttons().trigger()\",\r\n\"button().trigger()\",function(){return this.each(function(a){a.inst.node(a.node).trigger(\"click\")})});i.Api.registerPlural(\"buttons().containers()\",\"buttons().container()\",function(){var a=d();d(this.each(function(b){a=a.add(b.inst.container())}));return a});i.Api.register(\"button().add()\",function(a,b){1===this.length&&this[0].inst.add(b,a);return this.button(a)});i.Api.register(\"buttons().destroy()\",function(){this.pluck(\"inst\").unique().each(function(a){a.destroy()});return this});i.Api.registerPlural(\"buttons().remove()\",\r\n\"buttons().remove()\",function(){this.each(function(a){a.inst.remove(a.node)});return this});var r;i.Api.register(\"buttons.info()\",function(a,b,c){var e=this;if(!1===a)return d(\"#datatables_buttons_info\").fadeOut(function(){d(this).remove()}),clearTimeout(r),r=null,this;r&&clearTimeout(r);d(\"#datatables_buttons_info\").length&&d(\"#datatables_buttons_info\").remove();d('<div id=\"datatables_buttons_info\" class=\"dt-button-info\"/>').html(a?\"<h2>\"+a+\"</h2>\":\"\").append(d(\"<div/>\")[\"string\"===typeof b?\"html\":\r\n\"append\"](b)).css(\"display\",\"none\").appendTo(\"body\").fadeIn();c!==l&&0!==c&&(r=setTimeout(function(){e.buttons.info(!1)},c));return this});i.Api.register(\"buttons.exportData()\",function(a){if(this.context.length){for(var b=new i.Api(this.context[0]),c=d.extend(!0,{},{rows:null,columns:\"\",modifier:{search:\"applied\",order:\"applied\"},orthogonal:\"display\",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,trim:!0,format:{header:function(a){return e(a)},footer:function(a){return e(a)},body:function(a){return e(a)}}},\r\na),e=function(a){if(\"string\"!==typeof a)return a;c.stripHtml&&(a=a.replace(/<[^>]*>/g,\"\"));c.trim&&(a=a.replace(/^\\s+|\\s+$/g,\"\"));c.stripNewlines&&(a=a.replace(/\\n/g,\" \"));c.decodeEntities&&(t.innerHTML=a,a=t.value);return a},a=b.columns(c.columns).indexes().map(function(a){return c.format.header(b.column(a).header().innerHTML,a)}).toArray(),g=b.table().footer()?b.columns(c.columns).indexes().map(function(a){var d=b.column(a).footer();return c.format.footer(d?d.innerHTML:\"\",a)}).toArray():null,h=\r\nb.rows(c.rows,c.modifier).indexes().toArray(),h=b.cells(h,c.columns).render(c.orthogonal).toArray(),f=a.length,k=0<f?h.length/f:0,j=Array(k),m=0,l=0;l<k;l++){for(var o=Array(f),n=0;n<f;n++)o[n]=c.format.body(h[m],n,l),m++;j[l]=o}return{header:a,footer:g,body:j}}});var t=d(\"<textarea/>\")[0];d.fn.dataTable.Buttons=m;d.fn.DataTable.Buttons=m;d(n).on(\"init.dt plugin-init.dt\",function(a,b){if(\"dt\"===a.namespace){var c=b.oInit.buttons||i.defaults.buttons;c&&!b._buttons&&(new m(b,c)).container()}});i.ext.feature.push({fnInit:function(a){var a=\r\nnew i.Api(a),b=a.init().buttons||i.defaults.buttons;return(new m(a,b)).container()},cFeature:\"B\"});return m});\r\n\n",
    "(function(g){\"function\"===typeof define&&define.amd?define('datatables.net-buttons-html',[\"jquery\",\"datatables.net\",\"datatables.net-buttons\"],function(j){return g(j,window,document)}):\"object\"===typeof exports?module.exports=function(j,i,q,r){j||(j=window);if(!i||!i.fn.dataTable)i=require(\"datatables.net\")(j,i).$;i.fn.dataTable.Buttons||require(\"datatables.net-buttons\")(j,i);return g(i,j,j.document,q,r)}:g(jQuery,window,document)})(function(g,j,i,q,r,m){function E(a,b){v===m&&(v=-1===y.serializeToString(g.parseXML(F[\"xl/worksheets/sheet1.xml\"])).indexOf(\"xmlns:r\"));\r\ng.each(b,function(b,c){if(g.isPlainObject(c)){var e=a.folder(b);E(e,c)}else{if(v){var e=c.childNodes[0],f,h,n=[];for(f=e.attributes.length-1;0<=f;f--){h=e.attributes[f].nodeName;var k=e.attributes[f].nodeValue;-1!==h.indexOf(\":\")&&(n.push({name:h,value:k}),e.removeAttribute(h))}f=0;for(h=n.length;f<h;f++)k=c.createAttribute(n[f].name.replace(\":\",\"_dt_b_namespace_token_\")),k.value=n[f].value,e.setAttributeNode(k)}e=y.serializeToString(c);v&&(-1===e.indexOf(\"<?xml\")&&(e='<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\r\ne),e=e.replace(/_dt_b_namespace_token_/g,\":\"));e=e.replace(/<row xmlns=\"\" /g,\"<row \").replace(/<cols xmlns=\"\">/g,\"<cols>\");a.file(b,e)}})}function o(a,b,d){var c=a.createElement(b);d&&(d.attr&&g(c).attr(d.attr),d.children&&g.each(d.children,function(a,b){c.appendChild(b)}),d.text&&c.appendChild(a.createTextNode(d.text)));return c}function N(a,b){var d=a.header[b].length,c;a.footer&&a.footer[b].length>d&&(d=a.footer[b].length);for(var e=0,f=a.body.length;e<f&&!(c=a.body[e][b].toString().length,c>d&&\r\n(d=c),40<d);e++);return 5<d?d:5}var s=g.fn.dataTable;q===m&&(q=j.JSZip);r===m&&(r=j.pdfMake);var p;var h=\"undefined\"!==typeof self&&self||\"undefined\"!==typeof j&&j||this.content;if(\"undefined\"!==typeof navigator&&/MSIE [1-9]\\./.test(navigator.userAgent))p=void 0;else{var w=h.document.createElementNS(\"http://www.w3.org/1999/xhtml\",\"a\"),O=\"download\"in w,G=/Version\\/[\\d\\.]+.*Safari/.test(navigator.userAgent),z=h.webkitRequestFileSystem,H=h.requestFileSystem||z||h.mozRequestFileSystem,P=function(a){(h.setImmediate||\r\nh.setTimeout)(function(){throw a;},0)},A=0,B=function(a){setTimeout(function(){typeof a===\"string\"?(h.URL||h.webkitURL||h).revokeObjectURL(a):a.remove()},4E4)},C=function(a,b,d){for(var b=[].concat(b),c=b.length;c--;){var e=a[\"on\"+b[c]];if(typeof e===\"function\")try{e.call(a,d||a)}catch(f){P(f)}}},I=function(a){return/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"﻿\",a],{type:a.type}):a},J=function(a,b,d){d||(a=I(a));var c=this,d=a.type,e=false,\r\nf,g,n=function(){C(c,[\"writestart\",\"progress\",\"write\",\"writeend\"])},k=function(){if(g&&G&&typeof FileReader!==\"undefined\"){var b=new FileReader;b.onloadend=function(){var a=b.result;g.location.href=\"data:attachment/file\"+a.slice(a.search(/[,;]/));c.readyState=c.DONE;n()};b.readAsDataURL(a);c.readyState=c.INIT}else{if(e||!f)f=(h.URL||h.webkitURL||h).createObjectURL(a);if(g)g.location.href=f;else if(h.open(f,\"_blank\")===m&&G)h.location.href=f;c.readyState=c.DONE;n();B(f)}},t=function(a){return function(){if(c.readyState!==\r\nc.DONE)return a.apply(this,arguments)}},j={create:true,exclusive:false},u;c.readyState=c.INIT;b||(b=\"download\");if(O){f=(h.URL||h.webkitURL||h).createObjectURL(a);setTimeout(function(){w.href=f;w.download=b;var a=new MouseEvent(\"click\");w.dispatchEvent(a);n();B(f);c.readyState=c.DONE})}else{if(h.chrome&&d&&d!==\"application/octet-stream\"){u=a.slice||a.webkitSlice;a=u.call(a,0,a.size,\"application/octet-stream\");e=true}z&&b!==\"download\"&&(b=b+\".download\");if(d===\"application/octet-stream\"||z)g=h;if(H){A=\r\nA+a.size;H(h.TEMPORARY,A,t(function(d){d.root.getDirectory(\"saved\",j,t(function(d){var f=function(){d.getFile(b,j,t(function(b){b.createWriter(t(function(d){d.onwriteend=function(a){g.location.href=b.toURL();c.readyState=c.DONE;C(c,\"writeend\",a);B(b)};d.onerror=function(){var a=d.error;a.code!==a.ABORT_ERR&&k()};[\"writestart\",\"progress\",\"write\",\"abort\"].forEach(function(a){d[\"on\"+a]=c[\"on\"+a]});d.write(a);c.abort=function(){d.abort();c.readyState=c.DONE};c.readyState=c.WRITING}),k)}),k)};d.getFile(b,\r\n{create:false},t(function(a){a.remove();f()}),t(function(a){a.code===a.NOT_FOUND_ERR?f():k()}))}),k)}),k)}else k()}},l=J.prototype;\"undefined\"!==typeof navigator&&navigator.msSaveOrOpenBlob?p=function(a,b,d){d||(a=I(a));return navigator.msSaveOrOpenBlob(a,b||\"download\")}:(l.abort=function(){this.readyState=this.DONE;C(this,\"abort\")},l.readyState=l.INIT=0,l.WRITING=1,l.DONE=2,l.error=l.onwritestart=l.onprogress=l.onwrite=l.onabort=l.onerror=l.onwriteend=null,p=function(a,b,d){return new J(a,b,d)})}s.fileSave=\r\np;var x=function(a,b){var d=a.filename===\"*\"&&a.title!==\"*\"&&a.title!==m?a.title:a.filename;typeof d===\"function\"&&(d=d());d.indexOf(\"*\")!==-1&&(d=g.trim(d.replace(\"*\",g(\"title\").text())));d=d.replace(/[^a-zA-Z0-9_\\u00A1-\\uFFFF\\.,\\-_ !\\(\\)]/g,\"\");return b===m||b===true?d+a.extension:d},Q=function(a){var b=\"Sheet1\";a.sheetName&&(b=a.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g,\"\"));return b},R=function(a){a=a.title;typeof a===\"function\"&&(a=a());return a.indexOf(\"*\")!==-1?a.replace(\"*\",g(\"title\").text()||\r\n\"Exported data\"):a},K=function(a){return a.newline?a.newline:navigator.userAgent.match(/Windows/)?\"\\r\\n\":\"\\n\"},L=function(a,b){for(var d=K(b),c=a.buttons.exportData(b.exportOptions),e=b.fieldBoundary,f=b.fieldSeparator,g=RegExp(e,\"g\"),h=b.escapeChar!==m?b.escapeChar:\"\\\\\",k=function(a){for(var b=\"\",c=0,d=a.length;c<d;c++){c>0&&(b=b+f);b=b+(e?e+(\"\"+a[c]).replace(g,h+e)+e:a[c])}return b},j=b.header?k(c.header)+d:\"\",i=b.footer&&c.footer?d+k(c.footer):\"\",u=[],D=0,l=c.body.length;D<l;D++)u.push(k(c.body[D]));\r\nreturn{str:j+u.join(d)+i,rows:u.length}},M=function(){return navigator.userAgent.indexOf(\"Safari\")!==-1&&navigator.userAgent.indexOf(\"Chrome\")===-1&&navigator.userAgent.indexOf(\"Opera\")===-1};try{var y=new XMLSerializer,v}catch(S){}var F={\"_rels/.rels\":'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"><Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/></Relationships>',\r\n\"xl/_rels/workbook.xml.rels\":'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"><Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/><Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/></Relationships>',\"[Content_Types].xml\":'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\"><Default Extension=\"xml\" ContentType=\"application/xml\" /><Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" /><Default Extension=\"jpeg\" ContentType=\"image/jpeg\" /><Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" /><Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" /><Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" /></Types>',\r\n\"xl/workbook.xml\":'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"><fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/><workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/><bookViews><workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/></bookViews><sheets><sheet name=\"\" sheetId=\"1\" r:id=\"rId1\"/></sheets></workbook>',\r\n\"xl/worksheets/sheet1.xml\":'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\"><sheetData/></worksheet>',\"xl/styles.xml\":'<?xml version=\"1.0\" encoding=\"UTF-8\"?><styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\"><fonts count=\"5\" x14ac:knownFonts=\"1\"><font><sz val=\"11\" /><name val=\"Calibri\" /></font><font><sz val=\"11\" /><name val=\"Calibri\" /><color rgb=\"FFFFFFFF\" /></font><font><sz val=\"11\" /><name val=\"Calibri\" /><b /></font><font><sz val=\"11\" /><name val=\"Calibri\" /><i /></font><font><sz val=\"11\" /><name val=\"Calibri\" /><u /></font></fonts><fills count=\"6\"><fill><patternFill patternType=\"none\" /></fill><fill/><fill><patternFill patternType=\"solid\"><fgColor rgb=\"FFD9D9D9\" /><bgColor indexed=\"64\" /></patternFill></fill><fill><patternFill patternType=\"solid\"><fgColor rgb=\"FFD99795\" /><bgColor indexed=\"64\" /></patternFill></fill><fill><patternFill patternType=\"solid\"><fgColor rgb=\"ffc6efce\" /><bgColor indexed=\"64\" /></patternFill></fill><fill><patternFill patternType=\"solid\"><fgColor rgb=\"ffc6cfef\" /><bgColor indexed=\"64\" /></patternFill></fill></fills><borders count=\"2\"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp=\"false\" diagonalDown=\"false\"><left style=\"thin\"><color auto=\"1\" /></left><right style=\"thin\"><color auto=\"1\" /></right><top style=\"thin\"><color auto=\"1\" /></top><bottom style=\"thin\"><color auto=\"1\" /></bottom><diagonal /></border></borders><cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" /></cellStyleXfs><cellXfs count=\"2\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/><xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/></cellXfs><cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" /></cellStyles><dxfs count=\"0\" /><tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" /></styleSheet>'};\r\ns.ext.buttons.copyHtml5={className:\"buttons-copy buttons-html5\",text:function(a){return a.i18n(\"buttons.copy\",\"Copy\")},action:function(a,b,d,c){var a=L(b,c),e=a.str,d=g(\"<div/>\").css({height:1,width:1,overflow:\"hidden\",position:\"fixed\",top:0,left:0});c.customize&&(e=c.customize(e,c));c=g(\"<textarea readonly/>\").val(e).appendTo(d);if(i.queryCommandSupported(\"copy\")){d.appendTo(b.table().container());c[0].focus();c[0].select();try{i.execCommand(\"copy\");d.remove();b.buttons.info(b.i18n(\"buttons.copyTitle\",\r\n\"Copy to clipboard\"),b.i18n(\"buttons.copySuccess\",{1:\"Copied one row to clipboard\",_:\"Copied %d rows to clipboard\"},a.rows),2E3);return}catch(f){}}a=g(\"<span>\"+b.i18n(\"buttons.copyKeys\",\"Press <i>ctrl</i> or <i>⌘</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.\")+\"</span>\").append(d);b.buttons.info(b.i18n(\"buttons.copyTitle\",\"Copy to clipboard\"),a,0);c[0].focus();c[0].select();var h=g(a).closest(\".dt-button-info\"),j=function(){h.off(\"click.buttons-copy\");\r\ng(i).off(\".buttons-copy\");b.buttons.info(false)};h.on(\"click.buttons-copy\",j);g(i).on(\"keydown.buttons-copy\",function(a){a.keyCode===27&&j()}).on(\"copy.buttons-copy cut.buttons-copy\",function(){j()})},exportOptions:{},fieldSeparator:\"\\t\",fieldBoundary:\"\",header:!0,footer:!1};s.ext.buttons.csvHtml5={className:\"buttons-csv buttons-html5\",available:function(){return j.FileReader!==m&&j.Blob},text:function(a){return a.i18n(\"buttons.csv\",\"CSV\")},action:function(a,b,d,c){a=L(b,c).str;b=c.charset;c.customize&&\r\n(a=c.customize(a,c));if(b!==false){b||(b=i.characterSet||i.charset);b&&(b=\";charset=\"+b)}else b=\"\";p(new Blob([a],{type:\"text/csv\"+b}),x(c))},filename:\"*\",extension:\".csv\",exportOptions:{},fieldSeparator:\",\",fieldBoundary:'\"',escapeChar:'\"',charset:null,header:!0,footer:!1};s.ext.buttons.excelHtml5={className:\"buttons-excel buttons-html5\",available:function(){return j.FileReader!==m&&q!==m&&!M()&&y},text:function(a){return a.i18n(\"buttons.excel\",\"Excel\")},action:function(a,b,d,c){var e=0,a=function(a){return g.parseXML(F[a])},\r\nf=a(\"xl/worksheets/sheet1.xml\"),h=f.getElementsByTagName(\"sheetData\")[0],a={_rels:{\".rels\":a(\"_rels/.rels\")},xl:{_rels:{\"workbook.xml.rels\":a(\"xl/_rels/workbook.xml.rels\")},\"workbook.xml\":a(\"xl/workbook.xml\"),\"styles.xml\":a(\"xl/styles.xml\"),worksheets:{\"sheet1.xml\":f}},\"[Content_Types].xml\":a(\"[Content_Types].xml\")},b=b.buttons.exportData(c.exportOptions),j,k,d=function(a){j=e+1;k=o(f,\"row\",{attr:{r:j}});for(var b=0,c=a.length;b<c;b++){for(var d=b,i=\"\";d>=0;){i=String.fromCharCode(d%26+65)+i;d=Math.floor(d/\r\n26)-1}d=i+\"\"+j;if(a[b]===null||a[b]===m)a[b]=\"\";if(typeof a[b]===\"number\"||a[b].match&&g.trim(a[b]).match(/^-?\\d+(\\.\\d+)?$/)&&!g.trim(a[b]).match(/^0\\d+/))d=o(f,\"c\",{attr:{t:\"n\",r:d},children:[o(f,\"v\",{text:a[b]})]});else{i=!a[b].replace?a[b]:a[b].replace(/&(?!amp;)/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g,\"\");d=o(f,\"c\",{attr:{t:\"inlineStr\",r:d},children:{row:o(f,\"is\",{children:{row:o(f,\"t\",{text:i})}})}})}k.appendChild(d)}h.appendChild(k);\r\ne++};g(\"sheets sheet\",a.xl[\"workbook.xml\"]).attr(\"name\",Q(c));c.customizeData&&c.customizeData(b);if(c.header){d(b.header,e);g(\"row c\",f).attr(\"s\",\"2\")}for(var i=0,l=b.body.length;i<l;i++)d(b.body[i],e);if(c.footer&&b.footer){d(b.footer,e);g(\"row:last c\",f).attr(\"s\",\"2\")}d=o(f,\"cols\");g(\"worksheet\",f).prepend(d);i=0;for(l=b.header.length;i<l;i++)d.appendChild(o(f,\"col\",{attr:{min:i+1,max:i+1,width:N(b,i),customWidth:1}}));c.customize&&c.customize(a);b=new q;d={type:\"blob\",mimeType:\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"};\r\nE(b,a);b.generateAsync?b.generateAsync(d).then(function(a){p(a,x(c))}):p(b.generate(d),x(c))},filename:\"*\",extension:\".xlsx\",exportOptions:{},header:!0,footer:!1};s.ext.buttons.pdfHtml5={className:\"buttons-pdf buttons-html5\",available:function(){return j.FileReader!==m&&r},text:function(a){return a.i18n(\"buttons.pdf\",\"PDF\")},action:function(a,b,d,c){K(c);a=b.buttons.exportData(c.exportOptions);b=[];c.header&&b.push(g.map(a.header,function(a){return{text:typeof a===\"string\"?a:a+\"\",style:\"tableHeader\"}}));\r\nfor(var e=0,d=a.body.length;e<d;e++)b.push(g.map(a.body[e],function(a){return{text:typeof a===\"string\"?a:a+\"\",style:e%2?\"tableBodyEven\":\"tableBodyOdd\"}}));c.footer&&a.footer&&b.push(g.map(a.footer,function(a){return{text:typeof a===\"string\"?a:a+\"\",style:\"tableFooter\"}}));a={pageSize:c.pageSize,pageOrientation:c.orientation,content:[{table:{headerRows:1,body:b},layout:\"noBorders\"}],styles:{tableHeader:{bold:true,fontSize:11,color:\"white\",fillColor:\"#2d4154\",alignment:\"center\"},tableBodyEven:{},tableBodyOdd:{fillColor:\"#f3f3f3\"},\r\ntableFooter:{bold:true,fontSize:11,color:\"white\",fillColor:\"#2d4154\"},title:{alignment:\"center\",fontSize:15},message:{}},defaultStyle:{fontSize:10}};c.message&&a.content.unshift({text:c.message,style:\"message\",margin:[0,0,0,12]});c.title&&a.content.unshift({text:R(c,false),style:\"title\",margin:[0,0,0,12]});c.customize&&c.customize(a,c);a=r.createPdf(a);c.download===\"open\"&&!M()?a.open():a.getBuffer(function(a){a=new Blob([a],{type:\"application/pdf\"});p(a,x(c))})},title:\"*\",filename:\"*\",extension:\".pdf\",\r\nexportOptions:{},orientation:\"portrait\",pageSize:\"A4\",header:!0,footer:!1,message:null,customize:null,download:\"download\"};return s.Buttons});\r\n\n",
    "/*!\r\n Responsive 2.1.0\r\n 2014-2016 SpryMedia Ltd - datatables.net/license\r\n*/\r\n(function(c){\"function\"===typeof define&&define.amd?define('datatables.net-responsive',[\"jquery\",\"datatables.net\"],function(l){return c(l,window,document)}):\"object\"===typeof exports?module.exports=function(l,k){l||(l=window);if(!k||!k.fn.dataTable)k=require(\"datatables.net\")(l,k).$;return c(k,l,l.document)}:c(jQuery,window,document)})(function(c,l,k,p){var m=c.fn.dataTable,j=function(a,b){if(!m.versionCheck||!m.versionCheck(\"1.10.3\"))throw\"DataTables Responsive requires DataTables 1.10.3 or newer\";this.s={dt:new m.Api(a),columns:[],\r\ncurrent:[]};this.s.dt.settings()[0].responsive||(b&&\"string\"===typeof b.details?b.details={type:b.details}:b&&!1===b.details?b.details={type:!1}:b&&!0===b.details&&(b.details={type:\"inline\"}),this.c=c.extend(!0,{},j.defaults,m.defaults.responsive,b),a.responsive=this,this._constructor())};c.extend(j.prototype,{_constructor:function(){var a=this,b=this.s.dt,d=b.settings()[0],e=c(l).width();b.settings()[0]._responsive=this;c(l).on(\"resize.dtr orientationchange.dtr\",m.util.throttle(function(){var b=\r\nc(l).width();b!==e&&(a._resize(),e=b)}));d.oApi._fnCallbackReg(d,\"aoRowCreatedCallback\",function(e){-1!==c.inArray(!1,a.s.current)&&c(\"td, th\",e).each(function(e){e=b.column.index(\"toData\",e);!1===a.s.current[e]&&c(this).css(\"display\",\"none\")})});b.on(\"destroy.dtr\",function(){b.off(\".dtr\");c(b.table().body()).off(\".dtr\");c(l).off(\"resize.dtr orientationchange.dtr\");c.each(a.s.current,function(b,e){!1===e&&a._setColumnVis(b,!0)})});this.c.breakpoints.sort(function(a,b){return a.width<b.width?1:a.width>\r\nb.width?-1:0});this._classLogic();this._resizeAuto();d=this.c.details;!1!==d.type&&(a._detailsInit(),b.on(\"column-visibility.dtr\",function(){a._classLogic();a._resizeAuto();a._resize()}),b.on(\"draw.dtr\",function(){a._redrawChildren()}),c(b.table().node()).addClass(\"dtr-\"+d.type));b.on(\"column-reorder.dtr\",function(){a._classLogic();a._resizeAuto();a._resize()});b.on(\"column-sizing.dtr\",function(){a._resizeAuto();a._resize()});b.on(\"init.dtr\",function(){a._resizeAuto();a._resize();c.inArray(false,\r\na.s.current)&&b.columns.adjust()});this._resize()},_columnsVisiblity:function(a){var b=this.s.dt,d=this.s.columns,e,f,g=d.map(function(a,b){return{columnIdx:b,priority:a.priority}}).sort(function(a,b){return a.priority!==b.priority?a.priority-b.priority:a.columnIdx-b.columnIdx}),h=c.map(d,function(b){return b.auto&&null===b.minWidth?!1:!0===b.auto?\"-\":-1!==c.inArray(a,b.includeIn)}),n=0;e=0;for(f=h.length;e<f;e++)!0===h[e]&&(n+=d[e].minWidth);e=b.settings()[0].oScroll;e=e.sY||e.sX?e.iBarWidth:0;b=\r\nb.table().container().offsetWidth-e-n;e=0;for(f=h.length;e<f;e++)d[e].control&&(b-=d[e].minWidth);n=!1;e=0;for(f=g.length;e<f;e++){var i=g[e].columnIdx;\"-\"===h[i]&&(!d[i].control&&d[i].minWidth)&&(n||0>b-d[i].minWidth?(n=!0,h[i]=!1):h[i]=!0,b-=d[i].minWidth)}g=!1;e=0;for(f=d.length;e<f;e++)if(!d[e].control&&!d[e].never&&!h[e]){g=!0;break}e=0;for(f=d.length;e<f;e++)d[e].control&&(h[e]=g);-1===c.inArray(!0,h)&&(h[0]=!0);return h},_classLogic:function(){var a=this,b=this.c.breakpoints,d=this.s.dt,e=\r\nd.columns().eq(0).map(function(a){var b=this.column(a),e=b.header().className,a=d.settings()[0].aoColumns[a].responsivePriority;a===p&&(b=c(b.header()).data(\"priority\"),a=b!==p?1*b:1E4);return{className:e,includeIn:[],auto:!1,control:!1,never:e.match(/\\bnever\\b/)?!0:!1,priority:a}}),f=function(a,b){var d=e[a].includeIn;-1===c.inArray(b,d)&&d.push(b)},g=function(c,d,i,g){if(i)if(\"max-\"===i){g=a._find(d).width;d=0;for(i=b.length;d<i;d++)b[d].width<=g&&f(c,b[d].name)}else if(\"min-\"===i){g=a._find(d).width;\r\nd=0;for(i=b.length;d<i;d++)b[d].width>=g&&f(c,b[d].name)}else{if(\"not-\"===i){d=0;for(i=b.length;d<i;d++)-1===b[d].name.indexOf(g)&&f(c,b[d].name)}}else e[c].includeIn.push(d)};e.each(function(a,e){for(var d=a.className.split(\" \"),f=!1,j=0,l=d.length;j<l;j++){var k=c.trim(d[j]);if(\"all\"===k){f=!0;a.includeIn=c.map(b,function(a){return a.name});return}if(\"none\"===k||a.never){f=!0;return}if(\"control\"===k){f=!0;a.control=!0;return}c.each(b,function(a,b){var d=b.name.split(\"-\"),c=k.match(RegExp(\"(min\\\\-|max\\\\-|not\\\\-)?(\"+\r\nd[0]+\")(\\\\-[_a-zA-Z0-9])?\"));c&&(f=!0,c[2]===d[0]&&c[3]===\"-\"+d[1]?g(e,b.name,c[1],c[2]+c[3]):c[2]===d[0]&&!c[3]&&g(e,b.name,c[1],c[2]))})}f||(a.auto=!0)});this.s.columns=e},_detailsDisplay:function(a,b){var d=this,e=this.s.dt,f=this.c.details;if(f&&!1!==f.type){var g=f.display(a,b,function(){return f.renderer(e,a[0],d._detailsObj(a[0]))});(!0===g||!1===g)&&c(e.table().node()).triggerHandler(\"responsive-display.dt\",[e,a,g,b])}},_detailsInit:function(){var a=this,b=this.s.dt,d=this.c.details;\"inline\"===\r\nd.type&&(d.target=\"td:first-child, th:first-child\");b.on(\"draw.dtr\",function(){a._tabIndexes()});a._tabIndexes();c(b.table().body()).on(\"keyup.dtr\",\"td, th\",function(a){a.keyCode===13&&c(this).data(\"dtr-keyboard\")&&c(this).click()});var e=d.target;c(b.table().body()).on(\"click.dtr mousedown.dtr mouseup.dtr\",\"string\"===typeof e?e:\"td, th\",function(d){if(c(b.table().node()).hasClass(\"collapsed\")&&b.row(c(this).closest(\"tr\")).length){if(typeof e===\"number\"){var g=e<0?b.columns().eq(0).length+e:e;if(b.cell(this).index().column!==\r\ng)return}g=b.row(c(this).closest(\"tr\"));d.type===\"click\"?a._detailsDisplay(g,false):d.type===\"mousedown\"?c(this).css(\"outline\",\"none\"):d.type===\"mouseup\"&&c(this).blur().css(\"outline\",\"\")}})},_detailsObj:function(a){var b=this,d=this.s.dt;return c.map(this.s.columns,function(e,c){if(!e.never&&!e.control)return{title:d.settings()[0].aoColumns[c].sTitle,data:d.cell(a,c).render(b.c.orthogonal),hidden:d.column(c).visible()&&!b.s.current[c],columnIndex:c,rowIndex:a}})},_find:function(a){for(var b=this.c.breakpoints,\r\nd=0,c=b.length;d<c;d++)if(b[d].name===a)return b[d]},_redrawChildren:function(){var a=this,b=this.s.dt;b.rows({page:\"current\"}).iterator(\"row\",function(c,e){b.row(e);a._detailsDisplay(b.row(e),!0)})},_resize:function(){var a=this,b=this.s.dt,d=c(l).width(),e=this.c.breakpoints,f=e[0].name,g=this.s.columns,h,j=this.s.current.slice();for(h=e.length-1;0<=h;h--)if(d<=e[h].width){f=e[h].name;break}var i=this._columnsVisiblity(f);this.s.current=i;e=!1;h=0;for(d=g.length;h<d;h++)if(!1===i[h]&&!g[h].never&&\r\n!g[h].control){e=!0;break}c(b.table().node()).toggleClass(\"collapsed\",e);var k=!1;b.columns().eq(0).each(function(b,c){i[c]!==j[c]&&(k=!0,a._setColumnVis(b,i[c]))});k&&(this._redrawChildren(),c(b.table().node()).trigger(\"responsive-resize.dt\",[b,this.s.current]))},_resizeAuto:function(){var a=this.s.dt,b=this.s.columns;if(this.c.auto&&-1!==c.inArray(!0,c.map(b,function(a){return a.auto}))){a.table().node();var d=a.table().node().cloneNode(!1),e=c(a.table().header().cloneNode(!1)).appendTo(d),f=c(a.table().body()).clone(!1,\r\n!1).empty().appendTo(d),g=a.columns().header().filter(function(b){return a.column(b).visible()}).to$().clone(!1).css(\"display\",\"table-cell\");c(f).append(c(a.rows({page:\"current\"}).nodes()).clone(!1)).find(\"th, td\").css(\"display\",\"\");if(f=a.table().footer()){var f=c(f.cloneNode(!1)).appendTo(d),h=a.columns().footer().filter(function(b){return a.column(b).visible()}).to$().clone(!1).css(\"display\",\"table-cell\");c(\"<tr/>\").append(h).appendTo(f)}c(\"<tr/>\").append(g).appendTo(e);\"inline\"===this.c.details.type&&\r\nc(d).addClass(\"dtr-inline collapsed\");c(d).find(\"[name]\").removeAttr(\"name\");d=c(\"<div/>\").css({width:1,height:1,overflow:\"hidden\"}).append(d);d.insertBefore(a.table().node());g.each(function(c){c=a.column.index(\"fromVisible\",c);b[c].minWidth=this.offsetWidth||0});d.remove()}},_setColumnVis:function(a,b){var d=this.s.dt,e=b?\"\":\"none\";c(d.column(a).header()).css(\"display\",e);c(d.column(a).footer()).css(\"display\",e);d.column(a).nodes().to$().css(\"display\",e)},_tabIndexes:function(){var a=this.s.dt,\r\nb=a.cells({page:\"current\"}).nodes().to$(),d=a.settings()[0],e=this.c.details.target;b.filter(\"[data-dtr-keyboard]\").removeData(\"[data-dtr-keyboard]\");c(\"number\"===typeof e?\":eq(\"+e+\")\":e,a.rows({page:\"current\"}).nodes()).attr(\"tabIndex\",d.iTabIndex).data(\"dtr-keyboard\",1)}});j.breakpoints=[{name:\"desktop\",width:Infinity},{name:\"tablet-l\",width:1024},{name:\"tablet-p\",width:768},{name:\"mobile-l\",width:480},{name:\"mobile-p\",width:320}];j.display={childRow:function(a,b,d){if(b){if(c(a.node()).hasClass(\"parent\"))return a.child(d(),\r\n\"child\").show(),!0}else{if(a.child.isShown())return a.child(!1),c(a.node()).removeClass(\"parent\"),!1;a.child(d(),\"child\").show();c(a.node()).addClass(\"parent\");return!0}},childRowImmediate:function(a,b,d){if(!b&&a.child.isShown()||!a.responsive.hasHidden())return a.child(!1),c(a.node()).removeClass(\"parent\"),!1;a.child(d(),\"child\").show();c(a.node()).addClass(\"parent\");return!0},modal:function(a){return function(b,d,e){if(d)c(\"div.dtr-modal-content\").empty().append(e());else{var f=function(){g.remove();\r\nc(k).off(\"keypress.dtr\")},g=c('<div class=\"dtr-modal\"/>').append(c('<div class=\"dtr-modal-display\"/>').append(c('<div class=\"dtr-modal-content\"/>').append(e())).append(c('<div class=\"dtr-modal-close\">&times;</div>').click(function(){f()}))).append(c('<div class=\"dtr-modal-background\"/>').click(function(){f()})).appendTo(\"body\");c(k).on(\"keyup.dtr\",function(a){27===a.keyCode&&(a.stopPropagation(),f())})}a&&a.header&&c(\"div.dtr-modal-content\").prepend(\"<h2>\"+a.header(b)+\"</h2>\")}}};j.renderer={listHidden:function(){return function(a,\r\nb,d){return(a=c.map(d,function(a){return a.hidden?'<li data-dtr-index=\"'+a.columnIndex+'\" data-dt-row=\"'+a.rowIndex+'\" data-dt-column=\"'+a.columnIndex+'\"><span class=\"dtr-title\">'+a.title+'</span> <span class=\"dtr-data\">'+a.data+\"</span></li>\":\"\"}).join(\"\"))?c('<ul data-dtr-index=\"'+b+'\"/>').append(a):!1}},tableAll:function(a){a=c.extend({tableClass:\"\"},a);return function(b,d,e){b=c.map(e,function(a){return'<tr data-dt-row=\"'+a.rowIndex+'\" data-dt-column=\"'+a.columnIndex+'\"><td>'+a.title+\":</td> <td>\"+\r\na.data+\"</td></tr>\"}).join(\"\");return c('<table class=\"'+a.tableClass+'\" width=\"100%\"/>').append(b)}}};j.defaults={breakpoints:j.breakpoints,auto:!0,details:{display:j.display.childRow,renderer:j.renderer.listHidden(),target:0,type:\"inline\"},orthogonal:\"display\"};var o=c.fn.dataTable.Api;o.register(\"responsive()\",function(){return this});o.register(\"responsive.index()\",function(a){a=c(a);return{column:a.data(\"dtr-index\"),row:a.parent().data(\"dtr-index\")}});o.register(\"responsive.rebuild()\",function(){return this.iterator(\"table\",\r\nfunction(a){a._responsive&&a._responsive._classLogic()})});o.register(\"responsive.recalc()\",function(){return this.iterator(\"table\",function(a){a._responsive&&(a._responsive._resizeAuto(),a._responsive._resize())})});o.register(\"responsive.hasHidden()\",function(){var a=this.context[0];return a._responsive?-1!==c.inArray(!1,a._responsive.s.current):!1});j.version=\"2.1.0\";c.fn.dataTable.Responsive=j;c.fn.DataTable.Responsive=j;c(k).on(\"preInit.dt.dtr\",function(a,b){if(\"dt\"===a.namespace&&(c(b.nTable).hasClass(\"responsive\")||\r\nc(b.nTable).hasClass(\"dt-responsive\")||b.oInit.responsive||m.defaults.responsive)){var d=b.oInit.responsive;!1!==d&&new j(b,c.isPlainObject(d)?d:{})}});return j});\r\n\n",
    "/*!\r\n Select for DataTables 1.2.0\r\n 2015-2016 SpryMedia Ltd - datatables.net/license/mit\r\n*/\r\n(function(e){\"function\"===typeof define&&define.amd?define('datatables.net-select',[\"jquery\",\"datatables.net\"],function(i){return e(i,window,document)}):\"object\"===typeof exports?module.exports=function(i,l){i||(i=window);if(!l||!l.fn.dataTable)l=require(\"datatables.net\")(i,l).$;return e(l,i,i.document)}:e(jQuery,window,document)})(function(e,i,l,h){function t(b,a,c){var d;d=function(c,a){if(c>a)var d=a,a=c,c=d;var f=!1;return b.columns(\":visible\").indexes().filter(function(b){b===c&&(f=!0);return b===a?(f=!1,!0):f})};var f=\r\nfunction(c,a){var d=b.rows({search:\"applied\"}).indexes();if(d.indexOf(c)>d.indexOf(a))var f=a,a=c,c=f;var e=!1;return d.filter(function(b){b===c&&(e=!0);return b===a?(e=!1,!0):e})};!b.cells({selected:!0}).any()&&!c?(d=d(0,a.column),c=f(0,a.row)):(d=d(c.column,a.column),c=f(c.row,a.row));c=b.cells(c,d).flatten();b.cells(a,{selected:!0}).any()?b.cells(c).deselect():b.cells(c).select()}function r(b){var a=b.settings()[0]._select.selector;e(b.table().body()).off(\"mousedown.dtSelect\",a).off(\"mouseup.dtSelect\",\r\na).off(\"click.dtSelect\",a);e(\"body\").off(\"click.dtSelect\")}function v(b){var a=e(b.table().body()),c=b.settings()[0],d=c._select.selector;a.on(\"mousedown.dtSelect\",d,function(c){if(c.shiftKey||c.metaKey||c.ctrlKey)a.css(\"-moz-user-select\",\"none\").one(\"selectstart.dtSelect\",d,function(){return!1})}).on(\"mouseup.dtSelect\",d,function(){a.css(\"-moz-user-select\",\"\")}).on(\"click.dtSelect\",d,function(c){var a=b.select.items();if(!i.getSelection||!i.getSelection().toString()){var d=b.settings()[0];if(e(c.target).closest(\"div.dataTables_wrapper\")[0]==\r\nb.table().container()){var g=b.cell(e(c.target).closest(\"td, th\"));if(g.any()){var h=e.Event(\"user-select.dt\");k(b,h,[a,g,c]);h.isDefaultPrevented()||(h=g.index(),\"row\"===a?(a=h.row,s(c,b,d,\"row\",a)):\"column\"===a?(a=g.index().column,s(c,b,d,\"column\",a)):\"cell\"===a&&(a=g.index(),s(c,b,d,\"cell\",a)),d._select_lastCell=h)}}}});e(\"body\").on(\"click.dtSelect\",function(a){c._select.blurable&&!e(a.target).parents().filter(b.table().container()).length&&(e(a.target).parents(\"div.DTE\").length||p(c,!0))})}function k(b,\r\na,c,d){if(!d||b.flatten().length)\"string\"===typeof a&&(a+=\".dt\"),c.unshift(b),e(b.table().node()).triggerHandler(a,c)}function w(b){var a=b.settings()[0];if(a._select.info&&a.aanFeatures.i){var c=e('<span class=\"select-info\"/>'),d=function(a,d){c.append(e('<span class=\"select-item\"/>').append(b.i18n(\"select.\"+a+\"s\",{_:\"%d \"+a+\"s selected\",\"0\":\"\",1:\"1 \"+a+\" selected\"},d)))};d(\"row\",b.rows({selected:!0}).flatten().length);d(\"column\",b.columns({selected:!0}).flatten().length);d(\"cell\",b.cells({selected:!0}).flatten().length);\r\ne.each(a.aanFeatures.i,function(a,b){var b=e(b),d=b.children(\"span.select-info\");d.length&&d.remove();\"\"!==c.text()&&b.append(c)})}}function x(b,a,c,d){var f=b[a+\"s\"]({search:\"applied\"}).indexes(),d=e.inArray(d,f),m=e.inArray(c,f);if(!b[a+\"s\"]({selected:!0}).any()&&-1===d)f.splice(e.inArray(c,f)+1,f.length);else{if(d>m)var j=m,m=d,d=j;f.splice(m+1,f.length);f.splice(0,d)}b[a](c,{selected:!0}).any()?(f.splice(e.inArray(c,f),1),b[a+\"s\"](f).deselect()):b[a+\"s\"](f).select()}function p(b,a){if(a||\"single\"===\r\nb._select.style){var c=new g.Api(b);c.rows({selected:!0}).deselect();c.columns({selected:!0}).deselect();c.cells({selected:!0}).deselect()}}function s(b,a,c,d,f){var e=a.select.style(),j=a[d](f,{selected:!0}).any();\"os\"===e?b.ctrlKey||b.metaKey?a[d](f).select(!j):b.shiftKey?\"cell\"===d?t(a,f,c._select_lastCell||null):x(a,d,f,c._select_lastCell?c._select_lastCell[d]:null):(b=a[d+\"s\"]({selected:!0}),j&&1===b.flatten().length?a[d](f).deselect():(b.deselect(),a[d](f).select())):\"multi+shift\"==e?b.shiftKey?\r\n\"cell\"===d?t(a,f,c._select_lastCell||null):x(a,d,f,c._select_lastCell?c._select_lastCell[d]:null):a[d](f).select(!j):a[d](f).select(!j)}function q(b,a){return function(c){return c.i18n(\"buttons.\"+b,a)}}var g=e.fn.dataTable;g.select={};g.select.version=\"1.2.0\";g.select.init=function(b){var a=b.settings()[0],c=a.oInit.select,d=g.defaults.select,c=c===h?d:c,d=\"row\",f=\"api\",m=!1,j=!0,u=\"td, th\",i=\"selected\";a._select={};if(!0===c)f=\"os\";else if(\"string\"===typeof c)f=c;else if(e.isPlainObject(c)&&(c.blurable!==\r\nh&&(m=c.blurable),c.info!==h&&(j=c.info),c.items!==h&&(d=c.items),c.style!==h&&(f=c.style),c.selector!==h&&(u=c.selector),c.className!==h))i=c.className;b.select.selector(u);b.select.items(d);b.select.style(f);b.select.blurable(m);b.select.info(j);a._select.className=i;e.fn.dataTable.ext.order[\"select-checkbox\"]=function(a,c){return this.api().column(c,{order:\"index\"}).nodes().map(function(c){return\"row\"===a._select.items?e(c).parent().hasClass(a._select.className):\"cell\"===a._select.items?e(c).hasClass(a._select.className):\r\n!1})};e(b.table().node()).hasClass(\"selectable\")&&b.select.style(\"os\")};e.each([{type:\"row\",prop:\"aoData\"},{type:\"column\",prop:\"aoColumns\"}],function(b,a){g.ext.selector[a.type].push(function(c,b,f){var b=b.selected,e,j=[];if(b===h)return f;for(var g=0,i=f.length;g<i;g++)e=c[a.prop][f[g]],(!0===b&&!0===e._select_selected||!1===b&&!e._select_selected)&&j.push(f[g]);return j})});g.ext.selector.cell.push(function(b,a,c){var a=a.selected,d,f=[];if(a===h)return c;for(var e=0,g=c.length;e<g;e++)d=b.aoData[c[e].row],\r\n(!0===a&&d._selected_cells&&!0===d._selected_cells[c[e].column]||!1===a&&(!d._selected_cells||!d._selected_cells[c[e].column]))&&f.push(c[e]);return f});var n=g.Api.register,o=g.Api.registerPlural;n(\"select()\",function(){return this.iterator(\"table\",function(b){g.select.init(new g.Api(b))})});n(\"select.blurable()\",function(b){return b===h?this.context[0]._select.blurable:this.iterator(\"table\",function(a){a._select.blurable=b})});n(\"select.info()\",function(b){return w===h?this.context[0]._select.info:\r\nthis.iterator(\"table\",function(a){a._select.info=b})});n(\"select.items()\",function(b){return b===h?this.context[0]._select.items:this.iterator(\"table\",function(a){a._select.items=b;k(new g.Api(a),\"selectItems\",[b])})});n(\"select.style()\",function(b){return b===h?this.context[0]._select.style:this.iterator(\"table\",function(a){a._select.style=b;if(!a._select_init){var c=new g.Api(a);a.aoRowCreatedCallback.push({fn:function(c,b,d){b=a.aoData[d];b._select_selected&&e(c).addClass(a._select.className);\r\nc=0;for(d=a.aoColumns.length;c<d;c++)(a.aoColumns[c]._select_selected||b._selected_cells&&b._selected_cells[c])&&e(b.anCells[c]).addClass(a._select.className)},sName:\"select-deferRender\"});c.on(\"preXhr.dt.dtSelect\",function(){var a=c.rows({selected:!0}).ids(!0).filter(function(c){return c!==h}),b=c.cells({selected:!0}).eq(0).map(function(a){var b=c.row(a.row).id(!0);return b?{row:b,column:a.column}:h}).filter(function(c){return c!==h});c.one(\"draw.dt.dtSelect\",function(){c.rows(a).select();b.any()&&\r\nb.each(function(a){c.cells(a.row,a.column).select()})})});c.on(\"draw.dtSelect.dt select.dtSelect.dt deselect.dtSelect.dt info.dt\",function(){w(c)});c.on(\"destroy.dtSelect\",function(){r(c);c.off(\".dtSelect\")})}var d=new g.Api(a);r(d);\"api\"!==b&&v(d);k(new g.Api(a),\"selectStyle\",[b])})});n(\"select.selector()\",function(b){return b===h?this.context[0]._select.selector:this.iterator(\"table\",function(a){r(new g.Api(a));a._select.selector=b;\"api\"!==a._select.style&&v(new g.Api(a))})});o(\"rows().select()\",\r\n\"row().select()\",function(b){var a=this;if(!1===b)return this.deselect();this.iterator(\"row\",function(c,a){p(c);c.aoData[a]._select_selected=!0;e(c.aoData[a].nTr).addClass(c._select.className)});this.iterator(\"table\",function(c,b){k(a,\"select\",[\"row\",a[b]],!0)});return this});o(\"columns().select()\",\"column().select()\",function(b){var a=this;if(!1===b)return this.deselect();this.iterator(\"column\",function(a,b){p(a);a.aoColumns[b]._select_selected=!0;var f=(new g.Api(a)).column(b);e(f.header()).addClass(a._select.className);\r\ne(f.footer()).addClass(a._select.className);f.nodes().to$().addClass(a._select.className)});this.iterator(\"table\",function(c,b){k(a,\"select\",[\"column\",a[b]],!0)});return this});o(\"cells().select()\",\"cell().select()\",function(b){var a=this;if(!1===b)return this.deselect();this.iterator(\"cell\",function(a,b,f){p(a);b=a.aoData[b];b._selected_cells===h&&(b._selected_cells=[]);b._selected_cells[f]=!0;b.anCells&&e(b.anCells[f]).addClass(a._select.className)});this.iterator(\"table\",function(b,d){k(a,\"select\",\r\n[\"cell\",a[d]],!0)});return this});o(\"rows().deselect()\",\"row().deselect()\",function(){var b=this;this.iterator(\"row\",function(a,b){a.aoData[b]._select_selected=!1;e(a.aoData[b].nTr).removeClass(a._select.className)});this.iterator(\"table\",function(a,c){k(b,\"deselect\",[\"row\",b[c]],!0)});return this});o(\"columns().deselect()\",\"column().deselect()\",function(){var b=this;this.iterator(\"column\",function(a,b){a.aoColumns[b]._select_selected=!1;var d=new g.Api(a),f=d.column(b);e(f.header()).removeClass(a._select.className);\r\ne(f.footer()).removeClass(a._select.className);d.cells(null,b).indexes().each(function(b){var c=a.aoData[b.row],d=c._selected_cells;c.anCells&&(!d||!d[b.column])&&e(c.anCells[b.column]).removeClass(a._select.className)})});this.iterator(\"table\",function(a,c){k(b,\"deselect\",[\"column\",b[c]],!0)});return this});o(\"cells().deselect()\",\"cell().deselect()\",function(){var b=this;this.iterator(\"cell\",function(a,b,d){b=a.aoData[b];b._selected_cells[d]=!1;b.anCells&&!a.aoColumns[d]._select_selected&&e(b.anCells[d]).removeClass(a._select.className)});\r\nthis.iterator(\"table\",function(a,c){k(b,\"deselect\",[\"cell\",b[c]],!0)});return this});e.extend(g.ext.buttons,{selected:{text:q(\"selected\",\"Selected\"),className:\"buttons-selected\",init:function(b){var a=this;b.on(\"draw.dt.DT select.dt.DT deselect.dt.DT\",function(){var b=a.rows({selected:!0}).any()||a.columns({selected:!0}).any()||a.cells({selected:!0}).any();a.enable(b)});this.disable()}},selectedSingle:{text:q(\"selectedSingle\",\"Selected single\"),className:\"buttons-selected-single\",init:function(b){var a=\r\nthis;b.on(\"draw.dt.DT select.dt.DT deselect.dt.DT\",function(){var c=b.rows({selected:!0}).flatten().length+b.columns({selected:!0}).flatten().length+b.cells({selected:!0}).flatten().length;a.enable(1===c)});this.disable()}},selectAll:{text:q(\"selectAll\",\"Select all\"),className:\"buttons-select-all\",action:function(){this[this.select.items()+\"s\"]().select()}},selectNone:{text:q(\"selectNone\",\"Deselect all\"),className:\"buttons-select-none\",action:function(){p(this.settings()[0],!0)},init:function(b){var a=\r\nthis;b.on(\"draw.dt.DT select.dt.DT deselect.dt.DT\",function(){var c=b.rows({selected:!0}).flatten().length+b.columns({selected:!0}).flatten().length+b.cells({selected:!0}).flatten().length;a.enable(0<c)});this.disable()}}});e.each([\"Row\",\"Column\",\"Cell\"],function(b,a){var c=a.toLowerCase();g.ext.buttons[\"select\"+a+\"s\"]={text:q(\"select\"+a+\"s\",\"Select \"+c+\"s\"),className:\"buttons-select-\"+c+\"s\",action:function(){this.select.items(c)},init:function(a){var b=this;a.on(\"selectItems.dt.DT\",function(a,d,\r\ne){b.active(e===c)})}}});e(l).on(\"preInit.dt.dtSelect\",function(b,a){\"dt\"===b.namespace&&g.select.init(new g.Api(a))});return g.select});\r\n\n",
    "define('app/module_map',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/map/map',\r\n    'app/map/util',\r\n    'app/counter',\r\n    'app/ui/system_info',\r\n    'app/ui/system_graph',\r\n    'app/ui/system_signature',\r\n    'app/ui/system_route',\r\n    'app/ui/system_killboard',\r\n    'datatables.net',\r\n    'datatables.net-buttons',\r\n    'datatables.net-buttons-html',\r\n    'datatables.net-responsive',\r\n    'datatables.net-select'\r\n], function($, Init, Util, Map, MapUtil) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n        dynamicElementWrapperId: 'pf-dialog-wrapper',                           // parent Element for dynamic content (dialogs,..)\r\n        mapTabElementId: 'pf-map-tab-element',                                  // id for map tab element (tabs + content)\r\n        mapTabBarId: 'pf-map-tabs',                                             // id for map tab bar\r\n        mapTabIdPrefix: 'pf-map-tab-',                                          // id prefix for a map tab\r\n        mapTabClass: 'pf-map-tab',                                              // class for a map tab\r\n        mapTabLinkTextClass: 'nav-tabs-link',                                   // class for span elements in a tab\r\n        mapTabIconClass: 'pf-map-tab-icon',                                     // class for map icon\r\n        mapTabSharedIconClass: 'pf-map-tab-shared-icon',                        // class for map shared icon\r\n        mapTabContentClass: 'pf-map-tab-content',                               // class for tab content container\r\n        mapTabContentSystemInfoClass: 'pf-map-tab-content-system',\r\n        mapWrapperClass: 'pf-map-wrapper',                                      // scrollable\r\n        mapClass: 'pf-map',                                                     // class for each map\r\n\r\n        // TabContentStructure\r\n        mapTabContentRow: 'pf-map-content-row',                                 // main row for Tab content (grid)\r\n        mapTabContentCell: 'pf-map-content-col',                                // column\r\n        mapTabContentCellFirst: 'pf-map-content-col-first',                     // first column\r\n        mapTabContentCellSecond: 'pf-map-content-col-second',                   // second column\r\n\r\n        // module\r\n        moduleClass: 'pf-module',                                               // class for a module\r\n        moduleClosedClass: 'pf-module-closed'                                   // class for a closed module\r\n\r\n    };\r\n\r\n    var mapTabChangeBlocked = false;                                            // flag for preventing map tab switch\r\n\r\n    /**\r\n     * get all maps for a maps module\r\n     * @returns {*}\r\n     */\r\n    $.fn.getMaps = function(){\r\n        var maps = $(this).find('.' + config.mapClass);\r\n        return maps;\r\n    };\r\n\r\n    /**\r\n     * get the current active map for\r\n     * @returns {*}\r\n     */\r\n    $.fn.getActiveMap = function(){\r\n\r\n        var map = $(this).find('.active.' + config.mapTabContentClass + ' .' + config.mapClass);\r\n\r\n        if(map.length === 0){\r\n            map = false;\r\n        }\r\n\r\n        return map;\r\n    };\r\n\r\n    /**\r\n     * set Tab Observer, events are triggered within map.js\r\n     */\r\n    $.fn.setTabContentObserver = function(){\r\n        return this.each(function(){\r\n            // update Tab Content with system data information\r\n            $(this).on('pf:drawSystemModules', function(e){\r\n                drawSystemModules($( e.target ));\r\n            });\r\n\r\n            $(this).on('pf:removeSystemModules', function(e){\r\n                removeSystemModules($( e.target ));\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * clear all system info modules and remove them\r\n     * @param tabContentElement\r\n     * @param callback\r\n     */\r\n    var removeSystemModules = function(tabContentElement, callback){\r\n        tabContentElement.find('.' + config.moduleClass).velocity('transition.slideDownOut', {\r\n            duration: Init.animationSpeed.mapModule,\r\n            complete: function(tempElement){\r\n                $(tempElement).remove();\r\n\r\n                if(callback){\r\n                    callback();\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * clears and updates the system info element (signature table, system info,...)\r\n     * @param tabContentElement\r\n     */\r\n    var drawSystemModules = function(tabContentElement){\r\n        var currentSystemData = Util.getCurrentSystemData();\r\n\r\n        // get Table cell for system Info\r\n        var firstCell = $(tabContentElement).find('.' + config.mapTabContentCellFirst);\r\n        var secondCell = $(tabContentElement).find('.' + config.mapTabContentCellSecond);\r\n\r\n        // draw system info module\r\n        firstCell.drawSystemInfoModule(currentSystemData.mapId, currentSystemData.systemData);\r\n\r\n        // draw system graph module\r\n        firstCell.drawSystemGraphModule(currentSystemData.systemData);\r\n\r\n        // draw signature table module\r\n        firstCell.drawSignatureTableModule(currentSystemData.systemData);\r\n\r\n        // draw system routes module\r\n        secondCell.drawSystemRouteModule(currentSystemData.mapId, currentSystemData.systemData);\r\n\r\n        // draw system killboard module\r\n        secondCell.drawSystemKillboardModule(currentSystemData.systemData);\r\n\r\n        // set Module Observer\r\n        setModuleObserver();\r\n    };\r\n\r\n    /**\r\n     * set observer for each module\r\n     */\r\n    var setModuleObserver = function(){\r\n\r\n        // toggle height for a module\r\n        $(document).off('click.toggleModuleHeight').on('click.toggleModuleHeight', '.' + config.moduleClass, function(e){\r\n            var moduleElement = $(this);\r\n            // get click position\r\n            var posX = moduleElement.offset().left;\r\n            var posY = moduleElement.offset().top;\r\n            var clickX = e.pageX - posX;\r\n            var clickY = e.pageY - posY;\r\n\r\n            // check for top-left click\r\n            if(clickX <= 8 && clickY <= 8){\r\n\r\n                // remember height\r\n                if(! moduleElement.data('origHeight')){\r\n\r\n                    moduleElement.data('origHeight', moduleElement.outerHeight());\r\n                }\r\n\r\n                if(moduleElement.hasClass( config.moduleClosedClass )){\r\n                    var moduleHeight = moduleElement.data('origHeight');\r\n                    moduleElement.velocity('finish').velocity({\r\n                        height: [ moduleHeight + 'px', [ 400, 15 ] ]\r\n                    },{\r\n                        duration: 400,\r\n                        easing: 'easeInSine',\r\n                        complete: function(){\r\n                            moduleElement.removeClass( config.moduleClosedClass );\r\n                            moduleElement.removeData();\r\n                        }\r\n                    });\r\n                }else{\r\n                    moduleElement.velocity('finish').velocity({\r\n                        height: [ '36px', [ 400, 15 ] ]\r\n                    },{\r\n                        duration: 400,\r\n                        easing: 'easeInSine',\r\n                        complete: function(){\r\n                            moduleElement.addClass( config.moduleClosedClass );\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n\r\n    /**\r\n     * updates only visible/active map module\r\n     * @returns {boolean}\r\n     */\r\n    $.fn.updateMapModuleData = function(){\r\n        var mapModule = $(this);\r\n\r\n        // get all active map elements for module\r\n        var mapElement = mapModule.getActiveMap();\r\n\r\n        if(mapElement !== false){\r\n            var mapId = mapElement.data('id');\r\n\r\n            var currentMapUserData = Util.getCurrentMapUserData(mapId);\r\n\r\n            // update map with current user data\r\n            if(currentMapUserData){\r\n                mapElement.updateUserData(currentMapUserData);\r\n            }\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * update system info panels (below map)\r\n     * @param systemData\r\n     */\r\n    $.fn.updateSystemModuleData = function(systemData){\r\n        var mapModule = $(this);\r\n\r\n        if(systemData){\r\n            // check if current open system is still the requested info system\r\n            var currentSystemData = Util.getCurrentSystemData();\r\n\r\n            if(currentSystemData){\r\n                if(systemData.id === currentSystemData.systemData.id){\r\n                    // trigger system update events\r\n                    $(document).triggerHandler('pf:updateSystemInfoModule', [systemData]);\r\n                    $(document).triggerHandler('pf:updateSystemSignatureModule', [systemData]);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * load all structure elements into a TabsContent div (tab body)\r\n     */\r\n    $.fn.initContentStructure = function(){\r\n        return this.each(function(){\r\n            // init bootstrap Grid\r\n            var contentStructure = $('<div>', {\r\n                class: ['row', config.mapTabContentRow].join(' ')\r\n            }).append(\r\n                    $('<div>', {\r\n                        class: ['col-xs-12', 'col-md-8', config.mapTabContentCellFirst, config.mapTabContentCell].join(' ')\r\n                    })\r\n                ).append(\r\n                    $('<div>', {\r\n                        class: ['col-xs-12', 'col-md-4', config.mapTabContentCellSecond, config.mapTabContentCell].join(' ')\r\n                    })\r\n                );\r\n\r\n            // append grid structure\r\n            $(this).append(contentStructure);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * get a fresh tab element\r\n     * @param options\r\n     * @returns {*|jQuery|HTMLElement}\r\n     */\r\n    var getTabElement = function(options){\r\n        var tabElement = $('<div>', {\r\n            id: config.mapTabElementId\r\n        });\r\n\r\n        var tabBar = $('<ul>', {\r\n            class: ['nav', 'nav-tabs'].join(' '),\r\n            id: options.barId\r\n        }).attr('role', 'tablist');\r\n\r\n        var tabContent = $('<div>', {\r\n            class: 'tab-content'\r\n        }).attr('data-map-tabs', options.barId);\r\n\r\n        tabElement.append(tabBar);\r\n        tabElement.append(tabContent);\r\n\r\n        return tabElement;\r\n    };\r\n\r\n    /**\r\n     * set data for a map tab, or update an existing map tab with new data\r\n     * @param options\r\n     */\r\n    $.fn.updateTabData = function(options){\r\n        var tabElement = $(this);\r\n\r\n        // set \"main\" data\r\n        tabElement.data('map-id', options.id).data('updated', options.updated);\r\n\r\n        // change \"tab\" link\r\n        tabElement.attr('href', '#' + config.mapTabIdPrefix + options.id);\r\n\r\n        // change \"map\" icon\r\n        var mapIconElement = tabElement.find('.' + config.mapTabIconClass);\r\n        mapIconElement.removeClass().addClass([config.mapTabIconClass, 'fa', 'fa-fw', options.icon].join(' '));\r\n\r\n        // change \"shared\" icon\r\n        var mapSharedIconElement = tabElement.find('.' + config.mapTabSharedIconClass);\r\n        mapSharedIconElement.hide();\r\n\r\n        // check if the map is a \"shared\" map\r\n        if(options.access){\r\n            if(\r\n                options.access.user.length > 1 ||\r\n                options.access.corporation.length > 1 ||\r\n                options.access.alliance.length > 1\r\n            ){\r\n                mapSharedIconElement.show();\r\n            }\r\n        }\r\n\r\n        // change map name label\r\n        var tabLinkTextElement = tabElement.find('.' + config.mapTabLinkTextClass);\r\n        tabLinkTextElement.text(options.name);\r\n\r\n        // change tabClass\r\n        var listElement = tabElement.parent();\r\n\r\n        // new tab classes\r\n        var tabClasses = [config.mapTabClass, options.type.classTab ];\r\n\r\n        // check if tab was \"active\" before\r\n        if( listElement.hasClass('active') ){\r\n            tabClasses.push('active');\r\n        }\r\n        listElement.removeClass().addClass( tabClasses.join(' ') );\r\n\r\n        // set title for tooltip\r\n        if(options.type.name !== undefined){\r\n            tabLinkTextElement.attr('title', options.type.name + ' map');\r\n        }\r\n\r\n        var mapTooltipOptions = {\r\n            placement: 'bottom',\r\n            container: 'body',\r\n            trigger: 'hover',\r\n            delay: 150\r\n        };\r\n\r\n        listElement.find('[title]').tooltip(mapTooltipOptions).tooltip('fixTitle');\r\n\r\n        if(options.right === true){\r\n            listElement.addClass('pull-right');\r\n        }\r\n    };\r\n\r\n\r\n    /**\r\n     * add a new tab to tab-map-module end returns the new objects\r\n     * @param options\r\n     * @returns {{listElement: (*|void), contentElement: (*|HTMLElement)}}\r\n     */\r\n    $.fn.addTab = function(options){\r\n        var tabElement = $(this);\r\n        var tabBar = tabElement.find('ul.nav-tabs');\r\n        var tabContent = tabElement.find('div.tab-content');\r\n\r\n        var listElement = $('<li>').attr('role', 'presentation');\r\n\r\n        if(options.right === true){\r\n            listElement.addClass('pull-right');\r\n        }\r\n\r\n        // link element\r\n        var linkElement = $('<a>').attr('role', 'tab');\r\n\r\n        // map icon element\r\n        var mapIconElement = $('<i>', {\r\n            class: config.mapTabIconClass\r\n        });\r\n\r\n        // map shared icon element\r\n        var mapSharedIconElement = $('<i>', {\r\n            class: [config.mapTabSharedIconClass, 'fa', 'fa-fw', 'fa-share-alt'].join(' '),\r\n            title: 'shared map'\r\n        });\r\n\r\n        // text element\r\n        var textElement = $('<span>', {\r\n            class: config.mapTabLinkTextClass\r\n        });\r\n\r\n        var newListElement = listElement.append(\r\n            linkElement.append(mapIconElement).append(textElement).append(mapSharedIconElement)\r\n        );\r\n\r\n        tabBar.append( newListElement );\r\n\r\n        // update Tab element -> set data\r\n        linkElement.updateTabData(options);\r\n\r\n        // tabs content =======================================================\r\n        var contentElement = $('<div>', {\r\n            id: config.mapTabIdPrefix + parseInt( options.id ),\r\n            class: [config.mapTabContentClass].join(' ')\r\n        });\r\n\r\n        contentElement.addClass('tab-pane');\r\n\r\n        tabContent.append(contentElement);\r\n\r\n        // init tab ===========================================================\r\n        linkElement.on('click', function(e){\r\n            e.preventDefault();\r\n\r\n            // callback function after tab switch\r\n            function switchTabCallback(mapElement, tabLinkElement){\r\n                tabLinkElement.tab('show');\r\n                // unfreeze map\r\n                mapElement.data('frozen', false);\r\n                return false;\r\n            }\r\n\r\n            if(mapTabChangeBlocked === false){\r\n                var tabLinkElement = $(this);\r\n                var mapId = tabLinkElement.data('map-id');\r\n\r\n                // ignore \"add\" tab. no need for map change\r\n                if(mapId > 0){\r\n                    var mapElement = $('#' + config.mapTabElementId).getActiveMap();\r\n\r\n                    if(mapId !== mapElement.data('id')){\r\n                        // block tabs until switch is done\r\n                        mapTabChangeBlocked = true;\r\n\r\n                        // freeze active map -> no user data update while map switch\r\n                        mapElement.data('frozen', true);\r\n\r\n                        // hide current map with animation\r\n                        mapElement.visualizeMap('hide', function(){\r\n                            // un-block map tabs\r\n                            mapTabChangeBlocked = switchTabCallback(mapElement, tabLinkElement);\r\n                        });\r\n                    }\r\n                }else{\r\n                    tabLinkElement.tab('show');\r\n                }\r\n            }\r\n        });\r\n\r\n        return {\r\n            listElement: newListElement,\r\n            contentElement: contentElement\r\n        };\r\n    };\r\n\r\n    /**\r\n     * deletes a map tab for a given map id\r\n     * @param mapId\r\n     */\r\n    $.fn.deleteTab = function(mapId){\r\n        var tabElement = $(this);\r\n        var linkElement = tabElement.find('a[href=\"#' + config.mapTabIdPrefix + mapId + '\"]');\r\n        var deletedTabName = '';\r\n\r\n        if(linkElement.length > 0){\r\n            deletedTabName = linkElement.find('.' + config.mapTabLinkTextClass).text();\r\n\r\n            var liElement = linkElement.parent();\r\n            var contentElement = tabElement.find('div[id=\"' + config.mapTabIdPrefix + mapId + '\"]');\r\n\r\n            var findNewActiveTab = false;\r\n            // check if liElement was active\r\n            if(liElement.hasClass('active')){\r\n                // search any remaining li element and set active\r\n                findNewActiveTab = true;\r\n            }\r\n\r\n            liElement.remove();\r\n            contentElement.remove();\r\n\r\n            // remove map instance from local cache\r\n            Map.clearMapInstance(mapId);\r\n\r\n            if(findNewActiveTab === true){\r\n                tabElement.find('.' + config.mapTabClass + ':not(.pull-right):first a').tab('show');\r\n            }\r\n        }\r\n\r\n        return deletedTabName;\r\n    };\r\n\r\n    /**\r\n     * clear all active maps\r\n     */\r\n    $.fn.clearMapModule = function(){\r\n        var mapModuleElement = $(this);\r\n        var tabMapElement = $('#' + config.mapTabElementId);\r\n\r\n        if(tabMapElement.length > 0){\r\n            var tabElements = mapModuleElement.getMapTabElements();\r\n\r\n            for(var i = 0; i < tabElements.length; i++){\r\n                var tabElement = $(tabElements[i]);\r\n                var mapId = tabElement.data('map-id');\r\n\r\n                if(mapId > 0){\r\n                    tabMapElement.deleteTab(mapId);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * load/update map module into element (all maps)\r\n     * @param mapData\r\n     * @returns {boolean}\r\n     */\r\n    $.fn.updateMapModule = function(mapData){\r\n        if(mapData.length === 0){\r\n            return true;\r\n        }\r\n\r\n        // store current map data global (cache)\r\n        // temp store current map data to prevent data-change while function execution!\r\n        var tempMapData = Util.setCurrentMapData(mapData);\r\n\r\n        var mapModuleElement = $(this);\r\n\r\n        // check if tabs module is already loaded\r\n        var tabMapElement = $('#' + config.mapTabElementId);\r\n\r\n        // check if tabs have changed\r\n        var tabsChanged = false;\r\n\r\n        if(tabMapElement.length > 0){\r\n            // tab element already exists\r\n            var tabElements = mapModuleElement.getMapTabElements();\r\n\r\n            // map ID that is currently active\r\n            var activeMapId = 0;\r\n\r\n            // mapIds that are currently active\r\n            var activeMapIds = [];\r\n\r\n            // check whether a tab/map is still active\r\n            for(var i = 0; i < tabElements.length; i++){\r\n                var tabElement = $(tabElements[i]);\r\n                var mapId = tabElement.data('map-id');\r\n\r\n                if(mapId > 0){\r\n                    var tabMapData = Util.getCurrentMapData(mapId);\r\n\r\n                    if(tabMapData !== false){\r\n                        // map data available ->\r\n                        activeMapIds.push(mapId);\r\n\r\n                        // check for map data change and update tab\r\n                        if(tabMapData.config.updated !== tabElement.data('updated')){\r\n                            tabElement.updateTabData(tabMapData.config);\r\n                        }\r\n                    }else{\r\n                        // map data not available -> remove tab\r\n                        var deletedTabName = tabMapElement.deleteTab(mapId);\r\n\r\n                        tabsChanged = true;\r\n\r\n                        if(deletedTabName.length > 0){\r\n                            Util.showNotify({title: 'Map removed', text: deletedTabName + ' deleted', type: 'warning'});\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // add new tabs for new maps\r\n            $.each(tempMapData, function(i, data){\r\n                if( activeMapIds.indexOf( data.config.id ) === -1 ){\r\n                    // add new map tab\r\n\r\n                    var newTabElements = tabMapElement.addTab(data.config);\r\n\r\n                    // check if there is any active map yet (this is not the case\r\n                    // when ALL maps are removed AND new maps are added in one call\r\n                    // e.g. character switch)\r\n                    if(tabMapElement.find('.' + config.mapTabClass + '.active:not(.pull-right)').length === 0){\r\n                        tabMapElement.find('.' + config.mapTabClass + ':not(.pull-right):first a').tab('show');\r\n\r\n                        activeMapId = data.config.id;\r\n                    }\r\n\r\n                    // set observer for manually triggered map events\r\n                    newTabElements.contentElement.setTabContentObserver();\r\n\r\n                    // load all the structure elements for the new tab\r\n                    newTabElements.contentElement.initContentStructure();\r\n\r\n                    tabsChanged = true;\r\n\r\n                    Util.showNotify({title: 'Map added', text: data.config.name + ' added', type: 'success'});\r\n                }\r\n            });\r\n\r\n            // get current active map\r\n            if(activeMapId === 0){\r\n                activeMapId = Util.getMapModule().getActiveMap().data('id');\r\n            }\r\n            var activeMapData = Util.getCurrentMapData(activeMapId);\r\n\r\n            if(activeMapData !== false){\r\n                // update active map with new mapData\r\n                var currentTabContentElement = $('#' + config.mapTabIdPrefix + activeMapId);\r\n\r\n                $( currentTabContentElement).loadMap( activeMapData, {} );\r\n            }\r\n        }else{\r\n            // create Tab Element\r\n            tabsChanged = true;\r\n\r\n            var options = {\r\n                barId: config.mapTabBarId\r\n            };\r\n\r\n            tabMapElement = getTabElement(options);\r\n\r\n            // add new tab for each map\r\n            for(var j = 0; j < tempMapData.length; j++){\r\n\r\n                var data = tempMapData[j];\r\n                tabMapElement.addTab(data.config);\r\n            }\r\n\r\n            // add \"add\" button\r\n            var tabAddOptions = {\r\n                id: 0,\r\n                type: {\r\n                    classTab: MapUtil.getInfoForMap( 'standard', 'classTab')\r\n                },\r\n                icon: 'fa-plus',\r\n                name: 'add',\r\n                right: true\r\n            };\r\n\r\n            tabMapElement.addTab(tabAddOptions);\r\n\r\n            mapModuleElement.prepend(tabMapElement);\r\n\r\n            var currentUserData = Util.getCurrentUserData();\r\n            var promiseStore = MapUtil.getLocaleData('character', currentUserData.character.id);\r\n\r\n            promiseStore.then(function(data) {\r\n                // array key where map data is available (0 == first map found)\r\n                var mapDataIndex = 0;\r\n                // tab dom selector\r\n                var mapKeyTabSelector = 'first';\r\n\r\n                if(\r\n                    data &&\r\n                    data.defaultMapId\r\n                ){\r\n                    mapDataIndex = Util.getCurrentMapDataIndex(data.defaultMapId);\r\n                    mapKeyTabSelector = 'nth-child(' + ( mapDataIndex + 1 ) + ')';\r\n                }\r\n\r\n                // ==============================================================\r\n\r\n                // this new created module\r\n                var tabContentElements = tabMapElement.find('.' + config.mapTabContentClass);\r\n\r\n                // set observer for manually triggered map events\r\n                tabContentElements.setTabContentObserver();\r\n\r\n                // load all the structure elements for ALL Tab Content Body\r\n                tabContentElements.initContentStructure();\r\n\r\n                // set first Tab active\r\n                tabMapElement.find('.' + config.mapTabClass + ':' + mapKeyTabSelector + ' a').tab('show');\r\n            });\r\n\r\n        }\r\n\r\n        if(tabsChanged === true){\r\n\r\n            // remove previous event handlers\r\n            var allTabElements = mapModuleElement.getMapTabElements();\r\n            allTabElements.off('show.bs.tab');\r\n            allTabElements.off('shown.bs.tab');\r\n            allTabElements.off('hide.bs.tab');\r\n\r\n\r\n            // check for \"new map\" action before tap-change\r\n            allTabElements.on('show.bs.tab', function (e) {\r\n                var mapId = $(e.target).data('map-id');\r\n\r\n                if(mapId > 0){\r\n                    // save mapId as new \"default\" (local storage)\r\n                    var userData = MapUtil.storeDefaultMapId(mapId);\r\n                }else{\r\n                    // add new Tab selected\r\n                    $(document).trigger('pf:menuShowMapSettings', {tab: 'new'});\r\n                    e.preventDefault();\r\n                }\r\n            });\r\n\r\n            // load new map right after tab-change\r\n            allTabElements.on('shown.bs.tab', function (e) {\r\n                var mapId = $(e.target).data('map-id');\r\n                var tabMapData = Util.getCurrentMapData(mapId);\r\n\r\n                if(tabMapData !== false){\r\n                    // load map\r\n                    var currentTabContentElement = $('#' + config.mapTabIdPrefix + mapId);\r\n\r\n                    $( currentTabContentElement).loadMap( tabMapData, {showAnimation: true} );\r\n\r\n                    // \"wake up\" scrollbar for map and get previous state back\r\n                    var scrollableElement = currentTabContentElement.find('.' + config.mapWrapperClass);\r\n                    $(scrollableElement).mCustomScrollbar( 'update');\r\n                }else{\r\n                    // no map data found -> remove tab\r\n                    tabMapElement.deleteTab(mapId);\r\n                }\r\n            });\r\n\r\n            allTabElements.on('hide.bs.tab', function (e) {\r\n                var newMapId = $(e.relatedTarget).data('map-id');\r\n                var oldMapId = $(e.target).data('map-id');\r\n\r\n                // skip \"add button\"\r\n                if(newMapId > 0){\r\n                    var currentTabContentElement = $('#' + config.mapTabIdPrefix + oldMapId);\r\n\r\n                    // disable scrollbar for map that will be hidden. \"freeze\" current state\r\n                    var scrollableElement = currentTabContentElement.find('.' + config.mapWrapperClass);\r\n                    $(scrollableElement).mCustomScrollbar( 'disable' );\r\n                }\r\n            });\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * collect all data (systems/connections) for export/save from each active map in the map module\r\n     * if no change detected -> do not attach map data to return array\r\n     * @returns {Array}\r\n     */\r\n    $.fn.getMapModuleDataForUpdate = function(){\r\n\r\n        // get all active map elements for module\r\n        var mapElements = $(this).getMaps();\r\n\r\n        var data = [];\r\n        for(var i = 0; i < mapElements.length; i++){\r\n            // get all changed (system / connection) data from this map\r\n            var mapData = $(mapElements[i]).getMapDataFromClient({forceData: false, checkForChange: true});\r\n\r\n            if(mapData !== false){\r\n\r\n                if(\r\n                    mapData.data.systems.length > 0 ||\r\n                    mapData.data.connections.length > 0\r\n                ){\r\n                    data.push(mapData);\r\n                }\r\n            }\r\n        }\r\n\r\n        return data;\r\n    };\r\n\r\n});\n",
    "/**\r\n * page structure\r\n */\r\n\r\ndefine('app/page',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/logging',\r\n    'mustache',\r\n    'text!img/logo.svg!strip',\r\n    'text!templates/modules/header.html',\r\n    'text!templates/modules/footer.html',\r\n    'dialog/notification',\r\n    'dialog/stats',\r\n    'dialog/map_info',\r\n    'dialog/account_settings',\r\n    'dialog/manual',\r\n    'dialog/map_settings',\r\n    'dialog/system_effects',\r\n    'dialog/jump_info',\r\n    'dialog/delete_account',\r\n    'dialog/credit',\r\n    'slidebars',\r\n    'app/module_map'\r\n], function($, Init, Util, Logging, Mustache, TplLogo, TplHead, TplFooter) {\r\n\r\n    'use strict';\r\n\r\n    var config = {\r\n        // page structure slidebars-menu classes\r\n        pageId: 'sb-site',\r\n        pageSlidebarClass: 'sb-slidebar',\r\n        pageSlidebarLeftClass: 'sb-left',                                       // class for left menu\r\n        pageSlidebarRightClass: 'sb-right',                                     // class for right menu\r\n        pageSlideLeftWidth: '150px',                                            // slide distance left menu\r\n        pageSlideRightWidth: '150px',                                           // slide distance right menu\r\n        fullScreenClass: 'pf-fullscreen',                                       // class for the \"full screen\" element\r\n\r\n        // page structure\r\n        pageClass: 'pf-site',\r\n\r\n        // header\r\n        pageHeaderId: 'pf-head',                                                // id for page head\r\n        headClass: 'pf-head',                                                   // class for page head\r\n        headMenuClass: 'pf-head-menu',                                          // class for page head menu button (left)\r\n        headMapClass: 'pf-head-map',                                            // class for page head map button (right)\r\n        headUserCharacterClass: 'pf-head-user-character',                       // class for \"user settings\" link\r\n        userCharacterImageClass: 'pf-head-user-character-image',                // class for \"current user image\"\r\n\r\n        headUserShipClass: 'pf-head-user-ship',                                 // class for \"user settings\" link\r\n        userShipImageClass: 'pf-head-user-ship-image',                          // class for \"current user ship image\"\r\n        headActiveUserClass: 'pf-head-active-user',                             // class for \"active user\" link\r\n        headCurrentLocationClass: 'pf-head-current-location',                   // class for \"show current location\" link\r\n        headProgramStatusClass: 'pf-head-program-status',                       // class for \"program status\" notification\r\n        headMapTrackingId: 'pf-head-map-tracking',                              // id for \"map tracking\" toggle (checkbox)\r\n\r\n        // footer\r\n        pageFooterId: 'pf-footer',                                              // id for page footer\r\n        footerLicenceLinkClass: 'pf-footer-licence',                            // class for \"licence\" link\r\n\r\n        // menu\r\n        menuHeadMenuLogoClass: 'pf-head-menu-logo',                             // class for main menu logo\r\n\r\n        // helper element\r\n        dynamicElementWrapperId: 'pf-dialog-wrapper'\r\n    };\r\n\r\n    var programStatusCounter = 0;                                               // current count down in s until next status change is possible\r\n    var programStatusInterval = false;                                          // interval timer until next status change is possible\r\n\r\n\r\n    /**\r\n     * load main page structure elements and navigation container into body\r\n     */\r\n    $.fn.loadPageStructure = function(){\r\n\r\n        // menu left\r\n        $(this).prepend(\r\n            $('<div>', {\r\n                class: [config.pageSlidebarClass, config.pageSlidebarLeftClass, 'sb-style-push', 'sb-width-custom'].join(' ')\r\n            }).attr('data-sb-width', config.pageSlideLeftWidth)\r\n        );\r\n\r\n        // menu right\r\n        $(this).prepend(\r\n            $('<div>', {\r\n                class: [config.pageSlidebarClass, config.pageSlidebarRightClass, 'sb-style-push', 'sb-width-custom'].join(' ')\r\n            }).attr('data-sb-width', config.pageSlideRightWidth)\r\n        );\r\n\r\n        // main page\r\n        $(this).prepend(\r\n            $('<div>', {\r\n                id: config.pageId,\r\n                class: config.pageClass\r\n            }).append(\r\n                    Util.getMapModule()\r\n                ).append(\r\n                    $('<div>', {\r\n                        id: config.dynamicElementWrapperId\r\n                    })\r\n                )\r\n        );\r\n\r\n        // load header / footer\r\n        $('.' + config.pageClass).loadHeader().loadFooter();\r\n\r\n        // load left menu\r\n        $('.' + config.pageSlidebarLeftClass).loadLeftMenu();\r\n\r\n        // load right menu\r\n        $('.' + config.pageSlidebarRightClass).loadRightMenu();\r\n\r\n        // set document observer for global events\r\n        setDocumentObserver();\r\n    };\r\n\r\n    /**\r\n     * get main menu title element\r\n     * @param title\r\n     * @returns {JQuery|*|jQuery}\r\n     */\r\n    var getMenuHeadline = function(title){\r\n        return $('<div>', {\r\n            class: 'panel-heading'\r\n        }).prepend(\r\n            $('<h2>',{\r\n                class: 'panel-title',\r\n                text: title\r\n            })\r\n        );\r\n    };\r\n\r\n    /**\r\n     * load left menu content options\r\n     */\r\n    $.fn.loadLeftMenu = function(){\r\n\r\n        $(this).append(\r\n            $('<div>', {\r\n                class: 'list-group'\r\n            }).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item',\r\n                    href: '/'\r\n                }).html('&nbsp;&nbsp;Home').prepend(\r\n                        $('<i>',{\r\n                            class: 'fa fa-home fa-fw'\r\n                        })\r\n                    )\r\n            ).append(\r\n                getMenuHeadline('Information')\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item list-group-item-info',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Statistics').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-line-chart fa-fw'\r\n                    })\r\n                ).append(\r\n                    $('<span>',{\r\n                        class: 'badge bg-color bg-color-gray txt-color txt-color-warning',\r\n                        text: 'beta'\r\n                    })\r\n                ).on('click', function(){\r\n                    $(document).triggerMenuEvent('ShowStatsDialog');\r\n                })\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item list-group-item-info',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Effect info').prepend(\r\n                        $('<i>',{\r\n                            class: 'fa fa-crosshairs fa-fw'\r\n                        })\r\n                    ).on('click', function(){\r\n                        $(document).triggerMenuEvent('ShowSystemEffectInfo');\r\n                    })\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item list-group-item-info',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Jump info').prepend(\r\n                        $('<i>',{\r\n                            class: 'fa fa-space-shuttle fa-fw'\r\n                        })\r\n                    ).on('click', function(){\r\n                        $(document).triggerMenuEvent('ShowJumpInfo');\r\n                    })\r\n            ).append(\r\n                getMenuHeadline('Settings')\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Account').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-sliders fa-fw'\r\n                    })\r\n                ).on('click', function(){\r\n                    $(document).triggerMenuEvent('ShowSettingsDialog');\r\n                })\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item hide',                      // trigger by js\r\n                    id: Util.config.menuButtonFullScreenId,\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Full screen').prepend(\r\n                        $('<i>',{\r\n                            class: 'glyphicon glyphicon-fullscreen',\r\n                            css: {width: '1.23em'}\r\n                        })\r\n                    ).on('click', function(){\r\n                        var fullScreenElement = $('body');\r\n                        requirejs(['jquery', 'fullScreen'], function($) {\r\n\r\n                            if($.fullscreen.isFullScreen()){\r\n                                $.fullscreen.exit();\r\n                            }else{\r\n                                fullScreenElement.fullscreen({overflow: 'scroll', toggleClass: config.fullScreenClass});\r\n                            }\r\n                        });\r\n                    })\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Notification test').prepend(\r\n                        $('<i>',{\r\n                            class: 'fa fa-volume-up fa-fw'\r\n                        })\r\n                    ).on('click', function(){\r\n                        $(document).triggerMenuEvent('NotificationTest');\r\n                    })\r\n            ).append(\r\n                getMenuHeadline('Danger zone')\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item list-group-item-danger',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Delete account').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-user-times fa-fw'\r\n                    })\r\n                ).on('click', function(){\r\n                        $(document).triggerMenuEvent('DeleteAccount');\r\n                    })\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item list-group-item-warning',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Logout').prepend(\r\n                        $('<i>',{\r\n                            class: 'fa fa-sign-in fa-fw'\r\n                        })\r\n                    ).on('click', function(){\r\n                        $(document).triggerMenuEvent('Logout', {clearCookies: 1});\r\n                    })\r\n            )\r\n        );\r\n\r\n        requirejs(['fullScreen'], function() {\r\n            if($.fullscreen.isNativelySupported() === true){\r\n                $('#' + Util.config.menuButtonFullScreenId).removeClass('hide');\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * load right content options\r\n     */\r\n    $.fn.loadRightMenu = function(){\r\n        $(this).append(\r\n            $('<div>', {\r\n                class: 'list-group'\r\n            }).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Status').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-info fa-fw'\r\n                    })\r\n                ).on('click', function(){\r\n                    $(document).triggerMenuEvent('ShowMapInfo');\r\n                })\r\n            ).append(\r\n                getMenuHeadline('Settings')\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Map config').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-gears fa-fw'\r\n                    })\r\n                ).on('click', function(){\r\n                    $(document).triggerMenuEvent('ShowMapSettings', {tab: 'settings'});\r\n                })\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item',\r\n                    id: Util.config.menuButtonGridId,\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;&nbsp;Grid snapping').prepend(\r\n                    $('<i>',{\r\n                        class: 'glyphicon glyphicon-th'\r\n                    })\r\n                ).on('click', function(){\r\n                    Util.getMapModule().getActiveMap().triggerMenuEvent('MapOption', {\r\n                        option: 'mapSnapToGrid',\r\n                        toggle: true\r\n                    });\r\n                })\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item',\r\n                    id: Util.config.menuButtonMagnetizerId,\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;&nbsp;Magnetizing').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-magnet fa-fw'\r\n                    })\r\n                ).on('click', function(){\r\n                    Util.getMapModule().getActiveMap().triggerMenuEvent('MapOption', {\r\n                        option: 'mapMagnetizer',\r\n                        toggle: true\r\n                    });\r\n                })\r\n            ).append(\r\n                getMenuHeadline('Help')\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item list-group-item-info',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Manual').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-book fa-fw'\r\n                    })\r\n                ).on('click', function(){\r\n                        $(document).triggerMenuEvent('Manual');\r\n                    })\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item list-group-item-info',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Task-Manager').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-tasks fa-fw'\r\n                    })\r\n                ).on('click', function(){\r\n                    $(document).triggerMenuEvent('ShowTaskManager');\r\n                })\r\n            ).append(\r\n                getMenuHeadline('Danger zone')\r\n            ).append(\r\n                $('<a>', {\r\n                    class: 'list-group-item list-group-item-danger',\r\n                    href: '#'\r\n                }).html('&nbsp;&nbsp;Delete map').prepend(\r\n                    $('<i>',{\r\n                        class: 'fa fa-trash fa-fw'\r\n                    })\r\n                ).on('click', function(){\r\n                        $(document).triggerMenuEvent('DeleteMap');\r\n                    })\r\n            )\r\n        );\r\n    };\r\n\r\n    /**\r\n     * trigger menu event\r\n     * @param event\r\n     * @param data\r\n     */\r\n    $.fn.triggerMenuEvent = function(event, data){\r\n        if(data === undefined){\r\n            data = {};\r\n        }\r\n\r\n        $(this).trigger('pf:menu' + event, [data]);\r\n    };\r\n\r\n    /**\r\n     * load page header\r\n     */\r\n    $.fn.loadHeader = function(){\r\n\r\n        var pageElement = $(this);\r\n\r\n        var moduleData = {\r\n            id: config.pageHeaderId,\r\n            logo: function(){\r\n                // render svg logo\r\n                return Mustache.render(TplLogo, {});\r\n            },\r\n            brandLogo: config.menuHeadMenuLogoClass,\r\n            popoverTriggerClass: Util.config.popoverTriggerClass,\r\n            userCharacterClass: config.headUserCharacterClass,\r\n            userCharacterImageClass: config.userCharacterImageClass,\r\n            userShipClass: config.headUserShipClass,\r\n            userShipImageClass: config.userShipImageClass,\r\n            mapTrackingId: config.headMapTrackingId\r\n        };\r\n\r\n        var headRendered = Mustache.render(TplHead, moduleData);\r\n\r\n        pageElement.prepend(headRendered);\r\n\r\n        // init header =====================================================================\r\n\r\n        // init slide menus\r\n        var slideMenu = new $.slidebars({\r\n            scrollLock: false\r\n        });\r\n\r\n        // main menus\r\n        $('.' + config.headMenuClass).on('click', function() {\r\n            slideMenu.slidebars.toggle('left');\r\n        });\r\n\r\n        $('.' + config.headMapClass).on('click', function() {\r\n            slideMenu.slidebars.toggle('right');\r\n        });\r\n\r\n        // active pilots\r\n        $('.' + config.headActiveUserClass).find('a').on('click', function(){\r\n            $(document).triggerMenuEvent('ShowMapInfo');\r\n        });\r\n\r\n        // current location\r\n        $('.' + config.headCurrentLocationClass).find('a').on('click', function(){\r\n            Util.getMapModule().getActiveMap().triggerMenuEvent('SelectSystem', {systemId: $(this).data('systemId') });\r\n        });\r\n\r\n        // program status\r\n        $('.' + config.headProgramStatusClass).on('click', function(){\r\n            $(document).triggerMenuEvent('ShowTaskManager');\r\n        });\r\n\r\n        // close menu\r\n        $(document).on('pf:closeMenu', function(e){\r\n            // close all menus\r\n            slideMenu.slidebars.close();\r\n        });\r\n\r\n        // tracking toggle\r\n        var mapTrackingCheckbox = $('#' + config.headMapTrackingId);\r\n        mapTrackingCheckbox.bootstrapToggle({\r\n            size: 'mini',\r\n            on: 'on',\r\n            off: 'off',\r\n            onstyle: 'success',\r\n            offstyle: 'default',\r\n            width: 38,\r\n            height: 19\r\n        });\r\n\r\n        // set default values for map tracking checkbox\r\n        // -> always \"enable\"\r\n        mapTrackingCheckbox.bootstrapToggle('on');\r\n\r\n        mapTrackingCheckbox.on('change', function(e) {\r\n            var value = $(this).is(':checked');\r\n            var tracking = 'off';\r\n            var trackingText = 'Your current location will not actually be added';\r\n            var trackingType = 'info';\r\n            if(value){\r\n                tracking = 'on';\r\n                trackingText = 'New connections will actually be added';\r\n                trackingType = 'success';\r\n            }\r\n\r\n            Util.showNotify({title: 'Map tracking: ' + tracking, text: trackingText, type: trackingType}, false);\r\n        });\r\n\r\n\r\n        // init all tooltips\r\n        var tooltipElements = $('#' + config.pageHeaderId).find('[title]');\r\n        tooltipElements.tooltip({\r\n            placement: 'bottom',\r\n            delay: {\r\n                show: 500,\r\n                hide: 0\r\n            }\r\n        });\r\n\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * load page footer\r\n     */\r\n    $.fn.loadFooter = function(){\r\n\r\n        var pageElement = $(this);\r\n\r\n        var moduleData = {\r\n            id: config.pageFooterId,\r\n            footerLicenceLinkClass: config.footerLicenceLinkClass,\r\n            currentYear: new Date().getFullYear()\r\n        };\r\n\r\n        var headRendered = Mustache.render(TplFooter, moduleData);\r\n\r\n        pageElement.prepend(headRendered);\r\n\r\n        // init footer ==================================================\r\n\r\n        pageElement.find('.' + config.footerLicenceLinkClass).on('click', function(){\r\n            //show credits info dialog\r\n            $.fn.showCreditsDialog();\r\n        });\r\n\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * catch all global document events\r\n     */\r\n    var setDocumentObserver = function(){\r\n\r\n        // on \"full-screen\" change event\r\n        $(document).on('fscreenchange', function(e, state, elem){\r\n\r\n            var menuButton = $('#' + Util.config.menuButtonFullScreenId);\r\n\r\n            if(state === true){\r\n                // full screen active\r\n\r\n                // close all menus\r\n                $(this).trigger('pf:closeMenu', [{}]);\r\n\r\n                menuButton.addClass('active');\r\n            }else{\r\n                menuButton.removeClass('active');\r\n            }\r\n        });\r\n\r\n        $(document).on('pf:menuShowStatsDialog', function(e){\r\n            // show user activity stats dialog\r\n            $.fn.showStatsDialog();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuShowSystemEffectInfo', function(e){\r\n            // show system effects dialog\r\n            $.fn.showSystemEffectInfoDialog();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuShowJumpInfo', function(e){\r\n            // show system effects info box\r\n            $.fn.showJumpInfoDialog();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuNotificationTest', function(e){\r\n            // show system effects info box\r\n            notificationTest();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuDeleteAccount', function(e){\r\n            // show \"delete account\" dialog\r\n            $.fn.showDeleteAccountDialog();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuManual', function(e){\r\n            // show map manual\r\n            $.fn.showMapManual();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuShowSettingsDialog', function(e){\r\n            // show character select dialog\r\n            $.fn.showSettingsDialog();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuShowMapInfo', function(e){\r\n            // show map information dialog\r\n            $.fn.showMapInfoDialog();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuShowMapSettings', function(e, data){\r\n            // show map edit dialog or edit map\r\n            var mapData = false;\r\n\r\n            var activeMap = Util.getMapModule().getActiveMap();\r\n\r\n            if(activeMap){\r\n                mapData = Util.getCurrentMapData( activeMap.data('id') );\r\n            }\r\n\r\n            $.fn.showMapSettingsDialog(mapData, data);\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuDeleteMap', function(e){\r\n            // delete current active map\r\n            var mapData = false;\r\n\r\n            var activeMap = Util.getMapModule().getActiveMap();\r\n\r\n            if(activeMap){\r\n                mapData = activeMap.getMapDataFromClient({forceData: true});\r\n            }\r\n\r\n            $.fn.showDeleteMapDialog(mapData);\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuShowTaskManager', function(e, data){\r\n            // show log dialog\r\n            Logging.showDialog();\r\n            return false;\r\n        });\r\n\r\n        $(document).on('pf:menuLogout', function(e, data){\r\n\r\n            var clearCookies = false;\r\n            if(\r\n                typeof data === 'object' &&\r\n                data.hasOwnProperty('clearCookies')\r\n            ){\r\n                clearCookies = data.clearCookies;\r\n            }\r\n\r\n            // logout\r\n            Util.logout({\r\n                ajaxData: {\r\n                    clearCookies: clearCookies\r\n                }\r\n            });\r\n            return false;\r\n        });\r\n\r\n        // END menu events =============================================================================\r\n\r\n\r\n        // update header links with current map data\r\n        $(document).on('pf:updateHeaderMapData', function(e, data){\r\n            var activeMap = Util.getMapModule().getActiveMap();\r\n\r\n            var userCount = 0;\r\n            var currentLocationData = {};\r\n\r\n            // show active user just for the current active map\r\n            if(\r\n                activeMap &&\r\n                activeMap.data('id') === data.mapId\r\n            ){\r\n                userCount = data.userCount;\r\n                currentLocationData = data;\r\n            }\r\n            updateHeaderActiveUserCount(userCount);\r\n            updateHeaderCurrentLocation(currentLocationData);\r\n        });\r\n\r\n        // shutdown the program -> show dialog\r\n        $(document).on('pf:shutdown', function(e, data){\r\n            // show shutdown dialog\r\n            var options = {\r\n                buttons: {\r\n                    logout: {\r\n                        label: '<i class=\"fa fa-fw fa-refresh\"></i> restart',\r\n                        className: ['btn-primary'].join(' '),\r\n                        callback: function(){\r\n                            // check if error was 5xx -> reload page\r\n                            // -> else try to logout -> ajax request\r\n                            if(data.status >= 500 && data.status < 600){\r\n                                // redirect to login\r\n                                window.location = '../';\r\n                            }else{\r\n                                $(document).trigger('pf:menuLogout');\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                content: {\r\n                    icon: 'fa-bolt',\r\n                    class: 'txt-color-danger',\r\n                    title: 'Application error',\r\n                    headline: 'Logged out',\r\n                    text: [\r\n                        data.reason\r\n                    ],\r\n                    textSmaller: []\r\n                }\r\n            };\r\n\r\n            // add error information (if available)\r\n            if(\r\n                data.error &&\r\n                data.error.length\r\n            ){\r\n                for(let i = 0; i < data.error.length; i++){\r\n                    options.content.textSmaller.push(data.error[i].message);\r\n                }\r\n            }\r\n\r\n            $.fn.showNotificationDialog(options);\r\n\r\n            $(document).setProgramStatus('offline');\r\n\r\n            Util.showNotify({title: 'Logged out', text: data.reason, type: 'error'}, false);\r\n\r\n            // remove map -------------------------------------------------------\r\n            Util.getMapModule().velocity('fadeOut', {\r\n                duration: 300,\r\n                complete: function(){\r\n                    $(this).remove();\r\n                }\r\n            });\r\n\r\n            return false;\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * updates the header with current user data\r\n     */\r\n    $.fn.updateHeaderUserData = function(){\r\n\r\n        var userData = Util.getCurrentUserData();\r\n\r\n        var userInfoElement = $('.' + config.headUserCharacterClass);\r\n        var currentCharacterId = userInfoElement.data('characterId');\r\n        var currentCharactersOptionIds = userInfoElement.data('characterOptionIds') ? userInfoElement.data('characterOptionIds') : [];\r\n        var newCharacterId = 0;\r\n        var newCharacterName = '';\r\n\r\n        var userShipElement = $('.' + config.headUserShipClass);\r\n        var currentShipId = userShipElement.data('shipId');\r\n        var newShipId = 0;\r\n        var newShipName = '';\r\n\r\n        // function for header element toggle animation\r\n        var animateHeaderElement = function(element, callback, triggerShow){\r\n\r\n            element.show().velocity('stop').velocity({\r\n                opacity: 0\r\n            },{\r\n                visibility : 'hidden',\r\n                duration: 500,\r\n                complete: function(){\r\n                    // callback\r\n                    callback();\r\n\r\n                    // show element\r\n                    if(triggerShow === true){\r\n                        element.velocity({\r\n                            opacity: 1\r\n                        }, {\r\n                            visibility : 'visible',\r\n                            duration: 500\r\n                        });\r\n                    }else{\r\n                        // hide element\r\n                        element.hide();\r\n                    }\r\n\r\n                }\r\n            });\r\n\r\n        };\r\n\r\n        // check for changes\r\n        if(\r\n            userData &&\r\n            userData.character\r\n        ){\r\n            newCharacterId = userData.character.id;\r\n            newCharacterName = userData.character.name;\r\n\r\n            if(userData.character.log){\r\n                newShipId = userData.character.log.ship.typeId;\r\n                newShipName = userData.character.log.ship.typeName;\r\n            }\r\n        }\r\n\r\n        var newCharactersOptionIds = userData.characters.map(function(data){\r\n            return data.id;\r\n        });\r\n\r\n        // update user character data ---------------------------------------------------\r\n        if(currentCharactersOptionIds.toString() !== newCharactersOptionIds.toString()){\r\n\r\n            var  currentCharacterChanged = false;\r\n            if(currentCharacterId !== newCharacterId){\r\n                currentCharacterChanged = true;\r\n            }\r\n\r\n            // toggle element\r\n            animateHeaderElement(userInfoElement, function(){\r\n                if(currentCharacterChanged){\r\n                    userInfoElement.find('span').text( newCharacterName );\r\n                    userInfoElement.find('img').attr('src', Init.url.ccpImageServer + 'Character/' + newCharacterId + '_32.jpg' );\r\n                }\r\n                // init \"character switch\" popover\r\n                userInfoElement.initCharacterSwitchPopover(userData);\r\n            }, true);\r\n\r\n            // store new id(s) for next check\r\n            userInfoElement.data('characterId', newCharacterId);\r\n            userInfoElement.data('characterOptionIds', newCharactersOptionIds);\r\n        }\r\n\r\n        // update user ship data --------------------------------------------------------\r\n        if(currentShipId !== newShipId){\r\n\r\n            var showShipElement = true;\r\n            if(newShipId === 0){\r\n                showShipElement = false;\r\n            }\r\n\r\n            // toggle element\r\n            animateHeaderElement(userShipElement, function(){\r\n                userShipElement.find('span').text( newShipName );\r\n                userShipElement.find('img').attr('src', Init.url.ccpImageServer + 'Render/' + newShipId + '_32.png' );\r\n            }, showShipElement);\r\n\r\n            // set new id for next check\r\n            userShipElement.data('shipId', newShipId);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * delete active character log for the current user\r\n     */\r\n    var deleteLog = function(){\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: Init.path.deleteLog,\r\n            data: {},\r\n            dataType: 'json'\r\n        }).done(function(data){\r\n\r\n        });\r\n    };\r\n\r\n    /**\r\n     * update the \"active user\" badge in header\r\n     * @param userCount\r\n     */\r\n    var updateHeaderActiveUserCount = function(userCount){\r\n        var activeUserElement = $('.' + config.headActiveUserClass);\r\n        var badge = activeUserElement.find('.badge');\r\n\r\n        if(badge.data('userCount') !== userCount){\r\n            badge.data('userCount', userCount);\r\n\r\n            badge.text(userCount);\r\n\r\n            badge.toggleClass('txt-color-greenLight', (userCount > 0) );\r\n            badge.toggleClass('txt-color-red', (userCount === 0) );\r\n\r\n            if(! activeUserElement.is(':visible')){\r\n                activeUserElement.velocity('fadeIn', {duration: Init.animationSpeed.headerLink});\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * update the \"current location\" element in head\r\n     * @param locationData\r\n     */\r\n    var updateHeaderCurrentLocation = function(locationData){\r\n        var currentLocationElement = $('.' + config.headCurrentLocationClass);\r\n        var linkElement = currentLocationElement.find('a');\r\n        var textElement = linkElement.find('span');\r\n\r\n        if( linkElement.data('systemName') !== locationData.currentSystemName ){\r\n            var tempSystemName = locationData.currentSystemName;\r\n            var tempSystemId = locationData.currentSystemId;\r\n\r\n            if(\r\n                tempSystemName === undefined ||\r\n                tempSystemId === undefined\r\n            ){\r\n                tempSystemName = false;\r\n                tempSystemId = false;\r\n            }\r\n\r\n            linkElement.data('systemName', tempSystemName);\r\n            linkElement.data('systemId', tempSystemId);\r\n\r\n            if(\r\n                tempSystemName !== false &&\r\n                tempSystemId !== false\r\n            ){\r\n                textElement.text(locationData.currentSystemName);\r\n                currentLocationElement.velocity('fadeIn', {duration: Init.animationSpeed.headerLink});\r\n            }else{\r\n                if(currentLocationElement.is(':visible')){\r\n                    currentLocationElement.velocity('fadeOut', {duration: Init.animationSpeed.headerLink});\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    /**\r\n     * shows a test notification for desktop messages\r\n     */\r\n    var notificationTest = function(){\r\n        Util.showNotify({\r\n            title: 'Test Notification',\r\n            text: 'Accept browser security question'},\r\n            {\r\n                desktop: true,\r\n                stack: 'barBottom'\r\n            }\r\n        );\r\n    };\r\n\r\n    /**\r\n     *  set event listener if the program tab is active or not\r\n     *  this is used to lower the update ping cycle to reduce server load\r\n     */\r\n    var initTabChangeObserver = function(){\r\n\r\n        // increase the timer if a user is inactive\r\n        var increaseTimer = 10000;\r\n\r\n        // timer keys\r\n        var mapUpdateKey = 'UPDATE_SERVER_MAP';\r\n        var mapUserUpdateKey = 'UPDATE_SERVER_USER_DATA';\r\n\r\n        // Set the name of the hidden property and the change event for visibility\r\n        var hidden, visibilityChange;\r\n        if (typeof document.hidden !== 'undefined') { // Opera 12.10 and Firefox 18 and later support\r\n            hidden = 'hidden';\r\n            visibilityChange = 'visibilitychange';\r\n        } else if (typeof document.mozHidden !== 'undefined') {\r\n            hidden = 'mozHidden';\r\n            visibilityChange = 'mozvisibilitychange';\r\n        } else if (typeof document.msHidden !== 'undefined') {\r\n            hidden = 'msHidden';\r\n            visibilityChange = 'msvisibilitychange';\r\n        } else if (typeof document.webkitHidden !== 'undefined') {\r\n            hidden = 'webkitHidden';\r\n            visibilityChange = 'webkitvisibilitychange';\r\n        }\r\n\r\n        // function is called if the tab becomes active/inactive\r\n        function handleVisibilityChange() {\r\n            if (document[hidden]) {\r\n                // tab is invisible\r\n                // globally store current visibility status\r\n                window.isVisible = false;\r\n\r\n                Util.getCurrentTriggerDelay( mapUpdateKey, increaseTimer );\r\n                Util.getCurrentTriggerDelay( mapUserUpdateKey, increaseTimer );\r\n            } else {\r\n                // tab is visible\r\n                // globally store current visibility status\r\n                window.isVisible = true;\r\n\r\n                Util.getCurrentTriggerDelay( mapUpdateKey, -increaseTimer );\r\n                Util.getCurrentTriggerDelay( mapUserUpdateKey, -increaseTimer );\r\n\r\n                // stop blinking tab from previous notifications\r\n                Util.stopTabBlink();\r\n            }\r\n        }\r\n\r\n        if (\r\n            typeof document.addEventListener !== 'undefined' &&\r\n            typeof document[hidden] !== 'undefined'\r\n        ){\r\n            // the current browser supports this feature\r\n            // Handle page visibility change\r\n\r\n            // check once initial -> in case the tab is hidden on page load\r\n            handleVisibilityChange();\r\n\r\n            document.addEventListener(visibilityChange, handleVisibilityChange, false);\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n     * trigger \"program status\" in head\r\n     * @param status\r\n     */\r\n    $.fn.setProgramStatus = function(status){\r\n        var statusElement = $('.' + config.headProgramStatusClass);\r\n        var icon = statusElement.find('i');\r\n        var textElement = statusElement.find('span');\r\n\r\n        var iconClass = false;\r\n        var textClass = false;\r\n        var text = '';\r\n\r\n        switch(status){\r\n            case 'online':\r\n                if( ! statusElement.hasClass('txt-color-green')){\r\n                    iconClass = 'fa-wifi';\r\n                    textClass = 'txt-color-green';\r\n                    text = 'online';\r\n                }\r\n                break;\r\n            case 'problem':\r\n                if( ! statusElement.hasClass('txt-color-orange')){\r\n                    iconClass = 'fa-warning';\r\n                    textClass = 'txt-color-orange';\r\n                    text = 'problem';\r\n                }\r\n                break;\r\n            case 'offline':\r\n                if( ! statusElement.hasClass('txt-color-red')){\r\n                    iconClass = 'fa-bolt';\r\n                    textClass = 'txt-color-red';\r\n                    text = 'offline';\r\n                }\r\n                break;\r\n        }\r\n\r\n        // change status, on status changed\r\n        if(iconClass !== false){\r\n\r\n            // \"problem\" and \"offline\" always have priority -> ignore/clear interval\r\n            if(\r\n                status === 'problem' ||\r\n                status === 'offline'\r\n            ){\r\n                clearInterval(programStatusInterval);\r\n                programStatusInterval = false;\r\n            }\r\n\r\n            if(! statusElement.hasClass(textClass) ){\r\n\r\n                if(! programStatusInterval){\r\n\r\n                    var timer = function(){\r\n\r\n                        // change status on first timer iteration\r\n                        if(programStatusCounter === Init.timer.PROGRAM_STATUS_VISIBLE){\r\n\r\n                            statusElement.velocity('stop').velocity('fadeOut', {\r\n                                duration: Init.animationSpeed.headerLink,\r\n                                complete: function(){\r\n                                    statusElement.removeClass('txt-color-green txt-color-orange txt-color-red');\r\n                                    icon.removeClass('fa-wifi fa-warning fa-bolt');\r\n                                    statusElement.addClass(textClass);\r\n                                    icon.addClass(iconClass);\r\n                                    textElement.text(text);\r\n                                }\r\n                            }).velocity('fadeIn', {\r\n                                duration: Init.animationSpeed.headerLink\r\n                            });\r\n                        }\r\n\r\n                        // decrement counter\r\n                        programStatusCounter -= 1000;\r\n\r\n                        if(programStatusCounter <= 0){\r\n                            clearInterval(programStatusInterval);\r\n                            programStatusInterval = false;\r\n                        }\r\n                    };\r\n\r\n                    if(! programStatusInterval){\r\n                        programStatusCounter = Init.timer.PROGRAM_STATUS_VISIBLE;\r\n                        programStatusInterval = setInterval(timer, 1000);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    return {\r\n        initTabChangeObserver: initTabChangeObserver\r\n    };\r\n\r\n\r\n});\n",
    "/**\r\n * form elements\r\n */\r\n\r\ndefine('app/ui/form_element',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/map/util'\r\n], function($, Init, Util, MapUtil) {\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * init a select element as \"select2\" for map selection\r\n     */\r\n    $.fn.initMapSelect = function(){\r\n        var selectElement = $(this);\r\n\r\n        $.when(\r\n            selectElement.select2({\r\n                dropdownParent: selectElement.parents('.modal-body'),\r\n                theme: 'pathfinder',\r\n                maximumSelectionLength: 5\r\n            })\r\n        );\r\n    };\r\n\r\n    /**\r\n     * init a select element as an ajax based \"select2\" object for system search\r\n     * @param options\r\n     */\r\n    $.fn.initSystemSelect = function(options){\r\n        var selectElement = $(this);\r\n\r\n        var config = {\r\n            maxSelectionLength: 1\r\n        };\r\n        options = $.extend({}, config, options);\r\n\r\n        // format result data\r\n        function formatResultData (data) {\r\n\r\n            if (data.loading){\r\n                return data.text;\r\n            }\r\n\r\n            // show effect info just for wormholes\r\n            var hideEffectClass = '';\r\n            if(data.effect === ''){\r\n                hideEffectClass = 'hide';\r\n            }\r\n\r\n            var markup = '<div class=\"clearfix\">';\r\n            markup += '<div class=\"col-sm-5 pf-select-item-anchor\">' + data.text + '</div>';\r\n            markup += '<div class=\"col-sm-2 text-right ' + data.effectClass + '\">';\r\n            markup += '<i class=\"fa fa-fw fa-square ' + hideEffectClass + '\"></i>';\r\n            markup += '</div>';\r\n            markup += '<div class=\"col-sm-2 text-right ' + data.secClass + '\">' + data.security + '</div>';\r\n            markup += '<div class=\"col-sm-3 text-right ' + data.trueSecClass + '\">' + data.trueSec + '</div></div>';\r\n\r\n            return markup;\r\n        }\r\n\r\n        $.when(\r\n            selectElement.select2({\r\n                ajax: {\r\n                    url: function(params){\r\n                        // add params to URL\r\n                        return   Init.path.searchSystem + '/' + params.term.trim();\r\n                    },\r\n                    dataType: 'json',\r\n                    delay: 250,\r\n                    timeout: 5000,\r\n                    cache: true,\r\n                    data: function(params) {\r\n                        // no url params here\r\n                        return;\r\n                    },\r\n                    processResults: function(data) {\r\n                        // parse the results into the format expected by Select2.\r\n                        return {\r\n                            results: data.map( function(item){\r\n\r\n                                // \"systemId\" or \"name\"\r\n                                var id = item[options.key];\r\n                                var disabled = false;\r\n                                var trueSec = parseFloat(item.trueSec);\r\n                                var secClass = Util.getSecurityClassForSystem(item.security);\r\n                                var trueSecClass = Util.getTrueSecClassForSystem( trueSec );\r\n                                var effectClass = MapUtil.getEffectInfoForSystem(item.effect, 'class');\r\n\r\n                                // check if system is dialed\r\n                                if(\r\n                                    options.disabledOptions &&\r\n                                    options.disabledOptions.indexOf(parseInt(id, 10)) !== -1\r\n                                ){\r\n                                    disabled = true;\r\n                                }\r\n\r\n                                // \"fix\" security level\r\n                                if(\r\n                                    trueSec > 0 &&\r\n                                    trueSec < 0.1\r\n                                ){\r\n                                    trueSec = 0.1;\r\n                                }else{\r\n                                    trueSec = Math.round(trueSec * 10) / 10;\r\n                                }\r\n\r\n                                return {\r\n                                    id: id,\r\n                                    text: item.name,\r\n                                    systemId: parseInt(item.systemId),\r\n                                    security: item.security,\r\n                                    secClass: secClass,\r\n                                    trueSec: trueSec.toFixed(1),\r\n                                    trueSecClass: trueSecClass,\r\n                                    effect: item.effect,\r\n                                    effectClass: effectClass,\r\n                                    disabled: disabled\r\n                                };\r\n                            })\r\n                        };\r\n                    },\r\n                    error: function (jqXHR, status, error) {\r\n                        if( !Util.isXHRAborted(jqXHR) ){\r\n\r\n                            var reason = status + ' ' + jqXHR.status + ': ' + error;\r\n                            Util.showNotify({title: 'System select warning', text: reason + ' deleted', type: 'warning'});\r\n                        }\r\n\r\n                    }\r\n                },\r\n                dropdownParent: selectElement.parents('.modal-body'),\r\n                theme: 'pathfinder',\r\n                minimumInputLength: 2,\r\n                templateResult: formatResultData,\r\n                placeholder: 'System name',\r\n                allowClear: true,\r\n                maximumSelectionLength: options.maxSelectionLength,\r\n                escapeMarkup: function (markup) {\r\n                    // let our custom formatter work\r\n                    return markup;\r\n                }\r\n            }).on('change', function(e){\r\n                // select changed\r\n            })\r\n        ).done(function(){\r\n            // open select\r\n            selectElement.select2('open');\r\n        });\r\n    };\r\n\r\n    /**\r\n     * init a select element as an ajax based \"select2\" object for Access resources\r\n     * character (private map), corporation (corp map), alliance (ally map)\r\n     * @param options\r\n     */\r\n    $.fn.initAccessSelect = function(options){\r\n\r\n        return this.each(function(){\r\n\r\n            var selectElement = $(this);\r\n\r\n            // format result data\r\n            function formatResultData (data) {\r\n\r\n                if (data.loading){\r\n                    return data.text;\r\n                }\r\n\r\n                // check if an option is already selected\r\n                // do not show the same result twice\r\n                var currentValues = selectElement.val();\r\n\r\n                if(\r\n                    currentValues &&\r\n                    currentValues.indexOf( data.id.toString() ) !== -1\r\n                ){\r\n                    return ;\r\n                }\r\n\r\n                var imagePath = '';\r\n                var previewContent = '';\r\n\r\n                switch(options.type){\r\n                    case 'character':\r\n                        imagePath = Init.url.ccpImageServer + 'Character/' + data.id + '_32.jpg';\r\n                        previewContent = '<img src=\"' + imagePath + '\" style=\"max-width: 100%\" />';\r\n                        break;\r\n                    case 'corporation':\r\n                        imagePath = Init.url.ccpImageServer + 'Corporation/' + data.id + '_32.png';\r\n                        previewContent = '<img src=\"' + imagePath + '\" style=\"max-width: 100%\" />';\r\n                        break;\r\n                    case 'alliance':\r\n                        imagePath = Init.url.ccpImageServer + 'Alliance/' + data.id + '_32.png';\r\n                        previewContent = '<img src=\"' + imagePath + '\" style=\"max-width: 100%\" />';\r\n                        break;\r\n                }\r\n\r\n                var markup = '<div class=\"clearfix\">';\r\n                markup += '<div class=\"col-sm-2\">' + previewContent + '</div>';\r\n                markup += '<div class=\"col-sm-10\">' + data.text + '</div></div>';\r\n\r\n                return markup;\r\n            }\r\n\r\n            // format selection data\r\n            function formatSelectionData (data){\r\n\r\n                if (data.loading){\r\n                    return data.text;\r\n                }\r\n\r\n                var markup = '<div class=\"clearfix\">';\r\n                markup += '<div class=\"col-sm-10\">' + data.text + '</div></div>';\r\n\r\n                return markup;\r\n            }\r\n\r\n            $.when(\r\n                selectElement.select2({\r\n                    ajax: {\r\n                        url: function(params){\r\n                            // add params to URL\r\n                            return Init.path.searchAccess + '/' + options.type + '/' + params.term;\r\n                        },\r\n                        dataType: 'json',\r\n                        delay: 250,\r\n                        timeout: 5000,\r\n                        cache: true,\r\n                        data: function(params) {\r\n                            // no url params here\r\n                            return;\r\n                        },\r\n                        processResults: function(data, page) {\r\n                            // parse the results into the format expected by Select2.\r\n                            return {\r\n                                results: data.map( function(item){\r\n                                    return {\r\n                                        id: item.id,\r\n                                        text: item.name\r\n                                    };\r\n                                })\r\n                            };\r\n                        },\r\n                        error: function (jqXHR, status, error) {\r\n                            if( !Util.isXHRAborted(jqXHR) ){\r\n\r\n                                var reason = status + ' ' + jqXHR.status + ': ' + error;\r\n                                Util.showNotify({title: 'Access select warning', text: reason + ' deleted', type: 'warning'});\r\n                            }\r\n\r\n                        }\r\n                    },\r\n                    dropdownParent: selectElement.parents('.modal-body'),\r\n                    theme: 'pathfinder',\r\n                    minimumInputLength: 3,\r\n                    placeholder: '',\r\n                    allowClear: false,\r\n                    maximumSelectionLength: options.maxSelectionLength,\r\n                    templateResult: formatResultData,\r\n                    templateSelection: formatSelectionData,\r\n                    escapeMarkup: function (markup) {\r\n                        // let our custom formatter work\r\n                        return markup;\r\n                    }\r\n                }).on('change', function(e){\r\n                    // select changed\r\n\r\n                })\r\n            ).done(function(){\r\n                // after init finish\r\n            });\r\n        });\r\n\r\n    };\r\n\r\n});\r\n\n",
    "/**\r\n * Main map application\r\n */\r\n\r\ndefine('mappage',[\r\n    'jquery',\r\n    'app/init',\r\n    'app/util',\r\n    'app/render',\r\n    'app/logging',\r\n    'app/page',\r\n    'app/ui/form_element',\r\n    'app/module_map'\r\n], function($, Init, Util, Render, Logging, Page) {\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * main init \"map\" page\r\n     */\r\n    $(function(){\r\n        Util.initPrototypes();\r\n\r\n        // set default AJAX config\r\n        Util.ajaxSetup();\r\n\r\n        // set default dialog config\r\n        Util.initDefaultBootboxConfig();\r\n\r\n        // load page\r\n        $('body').loadPageStructure();\r\n\r\n        // show app information in browser console\r\n        Util.showVersionInfo();\r\n\r\n        // init logging\r\n        Logging.init();\r\n\r\n        var mapModule = $('#' + Util.config.mapModuleId);\r\n\r\n        // map init load static data =======================================================\r\n        $.getJSON( Init.path.initMap, function( initData ) {\r\n\r\n\r\n            if( initData.error.length > 0 ){\r\n                for(var i = 0; i < initData.error.length; i++){\r\n                    Util.showNotify({\r\n                        title: initData.error[i].title,\r\n                        text: initData.error[i].message,\r\n                        type: initData.error[i].type\r\n                    });\r\n                }\r\n            }\r\n\r\n            Init.timer              = initData.timer;\r\n            Init.mapTypes           = initData.mapTypes;\r\n            Init.mapScopes          = initData.mapScopes;\r\n            Init.connectionScopes   = initData.connectionScopes;\r\n            Init.systemStatus       = initData.systemStatus;\r\n            Init.systemType         = initData.systemType;\r\n            Init.characterStatus    = initData.characterStatus;\r\n            Init.maxSharedCount     = initData.maxSharedCount;\r\n            Init.routes             = initData.routes;\r\n            Init.notificationStatus = initData.notificationStatus;\r\n            Init.activityLogging    = initData.activityLogging;\r\n\r\n            // init tab change observer, Once the timers are available\r\n            Page.initTabChangeObserver();\r\n\r\n            // init map module\r\n            mapModule.initMapModule();\r\n\r\n        }).fail(function( jqXHR, status, error) {\r\n            var reason = status + ' ' + jqXHR.status + ': ' + error;\r\n\r\n            $(document).trigger('pf:shutdown', {status: jqXHR.status, reason: reason});\r\n        });\r\n\r\n        /**\r\n         * main function for init all map relevant trigger calls\r\n         */\r\n        $.fn.initMapModule = function(){\r\n\r\n            var mapModule = $(this);\r\n\r\n            // log keys ------------------------------------------------------------------------\r\n\r\n            // ajax request update map data\r\n            var logKeyServerMapData = 'UPDATE_SERVER_MAP';\r\n\r\n            // update client map data\r\n            var logKeyClientMapData = 'UPDATE_CLIENT_MAP';\r\n\r\n            // ajax request update map user data\r\n            var logKeyServerUserData = 'UPDATE_SERVER_USER_DATA';\r\n\r\n            // update client map user data\r\n            var logKeyClientUserData = 'UPDATE_CLIENT_USER_DATA';\r\n\r\n            // main update intervals/trigger (heartbeat)\r\n            var updateTimeouts = {\r\n                mapUpdate: 0,\r\n                userUpdate: 0\r\n            };\r\n\r\n            var locationToggle = $('#' + Util.config.headMapTrackingId);\r\n\r\n            // ping for main map update ========================================================\r\n            var triggerMapUpdatePing = function(){\r\n\r\n                // check each execution time if map module  is still available\r\n                var check = $('#' + mapModule.attr('id')).length;\r\n\r\n                if(check === 0){\r\n                    // program crash stop any update\r\n                    return;\r\n                }\r\n\r\n                // get updated map data\r\n                var updatedMapData = {\r\n                    mapData: mapModule.getMapModuleDataForUpdate(),\r\n                    getUserData: ( Util.getCurrentUserData() ) ? 0 : 1\r\n                };\r\n\r\n                // start log\r\n                Util.timeStart(logKeyServerMapData);\r\n\r\n                // store updatedMapData\r\n                $.ajax({\r\n                    type: 'POST',\r\n                    url: Init.path.updateMapData,\r\n                    data: updatedMapData,\r\n                    dataType: 'json'\r\n                }).done(function(data){\r\n\r\n                    // log request time\r\n                    var duration = Util.timeStop(logKeyServerMapData);\r\n                    Util.log(logKeyServerMapData, {duration: duration, type: 'server', description: 'request map data'});\r\n\r\n                    if(\r\n                        data.error &&\r\n                        data.error.length > 0\r\n                    ){\r\n                        // any error in the main trigger functions result in a user log-off\r\n                        $(document).trigger('pf:menuLogout');\r\n                    }else{\r\n                        $(document).setProgramStatus('online');\r\n\r\n                        if(data.userData !== undefined) {\r\n                            // store current user data global (cache)\r\n                            Util.setCurrentUserData(data.userData);\r\n                        }\r\n\r\n                        if(data.mapData.length === 0){\r\n                            // clear all existing maps\r\n                            mapModule.clearMapModule();\r\n\r\n                            // no map data available -> show \"new map\" dialog\r\n                            $(document).trigger('pf:menuShowMapSettings', {tab: 'new'});\r\n                        }else{\r\n                            // map data found\r\n\r\n                            // start log\r\n                            Util.timeStart(logKeyClientMapData);\r\n\r\n                            // load/update main map module\r\n                            mapModule.updateMapModule(data.mapData);\r\n\r\n                            // log client map update time\r\n                            duration = Util.timeStop(logKeyClientMapData);\r\n                            Util.log(logKeyClientMapData, {duration: duration, type: 'client', description: 'update map'});\r\n                        }\r\n\r\n                        // get the current update delay (this can change if a user is inactive)\r\n                        var mapUpdateDelay = Util.getCurrentTriggerDelay( logKeyServerMapData, 0 );\r\n\r\n                        // init new trigger\r\n                        updateTimeouts.mapUpdate = setTimeout(function(){\r\n                            triggerMapUpdatePing();\r\n                        }, mapUpdateDelay);\r\n\r\n                        // initial start for the userUpdate trigger\r\n                        // this should only be called at the first time!\r\n                        if(updateTimeouts.userUpdate === 0){\r\n\r\n                            // start user update trigger after map loaded\r\n                            updateTimeouts.userUpdate = setTimeout(function(){\r\n                                 triggerUserUpdatePing();\r\n                            }, 3000);\r\n                        }\r\n                    }\r\n\r\n                }).fail(handleAjaxErrorResponse);\r\n            };\r\n\r\n            // ping for user data update =======================================================\r\n            var triggerUserUpdatePing = function(){\r\n\r\n                // IMPORTANT: Get user data for ONE map that is currently visible\r\n                // On later releases this can be easy changed to \"full update\" all maps for a user\r\n                //\r\n                var mapIds = [];\r\n                var activeMap = Util.getMapModule().getActiveMap();\r\n                if(activeMap){\r\n                    mapIds = [ activeMap.data('id') ];\r\n                }\r\n\r\n                var updatedUserData = {\r\n                    mapIds: mapIds,\r\n                    systemData: Util.getCurrentSystemData(),\r\n                    characterMapData: {\r\n                        mapTracking: (locationToggle.is(':checked') ? 1 : 0) // location tracking\r\n                    }\r\n                };\r\n\r\n                Util.timeStart(logKeyServerUserData);\r\n\r\n                $.ajax({\r\n                    type: 'POST',\r\n                    url: Init.path.updateUserData,\r\n                    data: updatedUserData,\r\n                    dataType: 'json'\r\n                }).done(function(data){\r\n\r\n                    // log request time\r\n                    var duration = Util.timeStop(logKeyServerUserData);\r\n                    Util.log(logKeyServerUserData, {duration: duration, type: 'server', description:'request user data'});\r\n\r\n                    if(data.error.length > 0){\r\n                        // any error in the main trigger functions result in a user log-off\r\n                        $(document).trigger('pf:menuLogout');\r\n                    }else{\r\n\r\n                        $(document).setProgramStatus('online');\r\n\r\n                        if(data.userData !== undefined){\r\n                            // store current user data global (cache)\r\n                            var userData = Util.setCurrentUserData(data.userData);\r\n\r\n                            // store current map user data (cache)\r\n                            if(data.mapUserData !== undefined){\r\n                                Util.setCurrentMapUserData(data.mapUserData);\r\n                            }\r\n\r\n                            // start log\r\n                            Util.timeStart(logKeyClientUserData);\r\n\r\n                            // active character data found\r\n                            mapModule.updateMapModuleData();\r\n\r\n                            // log client user data update time\r\n                            duration = Util.timeStop(logKeyClientUserData);\r\n                            Util.log(logKeyClientUserData, {duration: duration, type: 'client', description:'update users'});\r\n\r\n                            // update system info panels\r\n                            if(data.system){\r\n                                mapModule.updateSystemModuleData(data.system);\r\n                            }\r\n\r\n                            // get the current update delay (this can change if a user is inactive)\r\n                            var mapUserUpdateDelay = Util.getCurrentTriggerDelay( logKeyServerUserData, 0 );\r\n\r\n                            // init new trigger\r\n                            updateTimeouts.userUpdate = setTimeout(function(){\r\n                                triggerUserUpdatePing();\r\n                            }, mapUserUpdateDelay);\r\n\r\n                        }\r\n                    }\r\n\r\n                }).fail(handleAjaxErrorResponse);\r\n\r\n            };\r\n\r\n            /**\r\n             * Ajax error response handler function for main-ping functions\r\n             * @param jqXHR\r\n             * @param status\r\n             * @param error\r\n             */\r\n            var handleAjaxErrorResponse = function(jqXHR, status, error){\r\n                // clear both main update request trigger timer\r\n                clearUpdateTimeouts();\r\n\r\n                var reason = status + ' ' + jqXHR.status + ': ' + error;\r\n                var errorData = [];\r\n\r\n                if(jqXHR.responseJSON){\r\n                    // handle JSON\r\n                    var errorObj = $.parseJSON(jqXHR.responseText);\r\n\r\n                    if(\r\n                        errorObj.error &&\r\n                        errorObj.error.length > 0\r\n                    ){\r\n                        errorData = errorObj.error;\r\n                    }\r\n                }else{\r\n                    // handle HTML\r\n                    errorData.push({\r\n                        type: 'error',\r\n                        message: 'Please restart and reload this page'\r\n                    });\r\n                }\r\n\r\n                $(document).trigger('pf:shutdown', {status: jqXHR.status, reason: reason, error: errorData});\r\n\r\n            };\r\n\r\n            /**\r\n             * clear both main update timeouts\r\n             * -> stop program from working -> shutdown\r\n             */\r\n            var clearUpdateTimeouts = function(){\r\n                for(var intervalKey in updateTimeouts) {\r\n\r\n                    if(updateTimeouts.hasOwnProperty(intervalKey)){\r\n                        clearTimeout( updateTimeouts[intervalKey] );\r\n                    }\r\n                }\r\n            };\r\n\r\n            // initial start of the  map update function\r\n            triggerMapUpdatePing();\r\n\r\n        };\r\n\r\n    });\r\n\r\n});\n"
  ]
}